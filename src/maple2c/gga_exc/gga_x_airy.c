/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_airy.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t39, t40;
  double t42, t43, t46, t48, t50, t51, t53, t54;
  double t56, t60, t61, t62, t63, t64, t65, t67;
  double t68, t69, t70, t72, t74, t75, t77, t78;
  double t81, t83, t85, t86, t88, t89, t91, t95;
  double tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = pow(t39, 0.2626712e1);
  t42 = 0.1e1 + 0.13471619689594796103e-3 * t40;
  t43 = pow(t42, -0.657946e0);
  t46 = pow(t39, 0.3217063e1);
  t48 = pow(t39, 0.3223476e1);
  t50 = 0.1e1 - 0.45212413010769857073e-1 * t46 + 0.45402221956620378581e-1 * t48;
  t51 = pow(t39, 0.3473804e1);
  t53 = 0.1e1 + 0.47702180224903349918e-3 * t51;
  t54 = 0.1e1 / t53;
  t56 = 0.60146019220211109872e-4 * t40 * t43 + t50 * t54;
  t60 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t56);
  t61 = rho[1] <= p->dens_threshold;
  t62 = my_piecewise5(t14, t11, t10, t15, -t17);
  t63 = 0.1e1 + t62;
  t64 = t63 <= p->zeta_threshold;
  t65 = POW_1_3(t63);
  t67 = my_piecewise3(t64, t22, t65 * t63);
  t68 = t67 * t26;
  t69 = sqrt(sigma[2]);
  t70 = POW_1_3(rho[1]);
  t72 = 0.1e1 / t70 / rho[1];
  t74 = t33 * t69 * t72;
  t75 = pow(t74, 0.2626712e1);
  t77 = 0.1e1 + 0.13471619689594796103e-3 * t75;
  t78 = pow(t77, -0.657946e0);
  t81 = pow(t74, 0.3217063e1);
  t83 = pow(t74, 0.3223476e1);
  t85 = 0.1e1 - 0.45212413010769857073e-1 * t81 + 0.45402221956620378581e-1 * t83;
  t86 = pow(t74, 0.3473804e1);
  t88 = 0.1e1 + 0.47702180224903349918e-3 * t86;
  t89 = 0.1e1 / t88;
  t91 = 0.60146019220211109872e-4 * t75 * t78 + t85 * t89;
  t95 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t91);
  tzk0 = t60 + t95;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t39, t40;
  double t42, t43, t46, t48, t50, t51, t53, t54;
  double t56, t60, t61, t62, t63, t64, t65, t67;
  double t68, t69, t70, t72, t74, t75, t77, t78;
  double t81, t83, t85, t86, t88, t89, t91, t95;
  double tzk0;

  double t96, t97, t98, t99, t100, t103, t104, t108;
  double t109, t110, t113, t114, t116, t117, t118, t120;
  double t121, t124, t125, t127, t130, t131, t134, t135;
  double t138, t140, t141, t142, t143, t144, t146, t149;
  double t154, t156, t159, t160, t164, t167, t169, tvrho0;
  double t172, t173, t176, t177, t182, t184, t187, t188;
  double t192, t194, t195, t196, t198, t199, t202, t203;
  double t205, t208, t209, t212, t213, t216, t218, t219;
  double t220, t221, t222, t224, t227, t232, tvrho1, t235;
  double t236, t237, t246, t249, t252, t256, tvsigma0, tvsigma1;
  double t257, t258, t259, t268, t271, t274, t278, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = pow(t39, 0.2626712e1);
  t42 = 0.1e1 + 0.13471619689594796103e-3 * t40;
  t43 = pow(t42, -0.657946e0);
  t46 = pow(t39, 0.3217063e1);
  t48 = pow(t39, 0.3223476e1);
  t50 = 0.1e1 - 0.45212413010769857073e-1 * t46 + 0.45402221956620378581e-1 * t48;
  t51 = pow(t39, 0.3473804e1);
  t53 = 0.1e1 + 0.47702180224903349918e-3 * t51;
  t54 = 0.1e1 / t53;
  t56 = 0.60146019220211109872e-4 * t40 * t43 + t50 * t54;
  t60 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t56);
  t61 = rho[1] <= p->dens_threshold;
  t62 = my_piecewise5(t14, t11, t10, t15, -t17);
  t63 = 0.1e1 + t62;
  t64 = t63 <= p->zeta_threshold;
  t65 = POW_1_3(t63);
  t67 = my_piecewise3(t64, t22, t65 * t63);
  t68 = t67 * t26;
  t69 = sqrt(sigma[2]);
  t70 = POW_1_3(rho[1]);
  t72 = 0.1e1 / t70 / rho[1];
  t74 = t33 * t69 * t72;
  t75 = pow(t74, 0.2626712e1);
  t77 = 0.1e1 + 0.13471619689594796103e-3 * t75;
  t78 = pow(t77, -0.657946e0);
  t81 = pow(t74, 0.3217063e1);
  t83 = pow(t74, 0.3223476e1);
  t85 = 0.1e1 - 0.45212413010769857073e-1 * t81 + 0.45402221956620378581e-1 * t83;
  t86 = pow(t74, 0.3473804e1);
  t88 = 0.1e1 + 0.47702180224903349918e-3 * t86;
  t89 = 0.1e1 / t88;
  t91 = 0.60146019220211109872e-4 * t75 * t78 + t85 * t89;
  t95 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t91);
  tzk0 = t60 + t95;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t96 = t6 * t6;
  t97 = 0.1e1 / t96;
  t98 = t16 * t97;
  t99 = t7 - t98;
  t100 = my_piecewise5(t10, 0, t14, 0, t99);
  t103 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t100);
  t104 = t103 * t26;
  t108 = t26 * t26;
  t109 = 0.1e1 / t108;
  t110 = t25 * t109;
  t113 = t5 * t110 * t56 / 0.8e1;
  t114 = pow(t39, 0.1626712e1);
  t116 = t114 * t43 * t29;
  t117 = t32 * t34;
  t118 = rho[0] * rho[0];
  t120 = 0.1e1 / t35 / t118;
  t121 = t117 * t120;
  t124 = pow(t39, 0.4253424e1);
  t125 = pow(t42, -0.1657946e1);
  t127 = t124 * t125 * t29;
  t130 = pow(t39, 0.2217063e1);
  t131 = t130 * t29;
  t134 = pow(t39, 0.2223476e1);
  t135 = t134 * t29;
  t138 = 0.19393490805022174494e0 * t131 * t121 - 0.19513729709845177529e0 * t135 * t121;
  t140 = t53 * t53;
  t141 = 0.1e1 / t140;
  t142 = t50 * t141;
  t143 = pow(t39, 0.2473804e1);
  t144 = t142 * t143;
  t146 = t33 * t34 * t120;
  t149 = -0.21064836058394555311e-3 * t116 * t121 + 0.18671024483029835192e-7 * t127 * t121 + t138 * t54 + 0.22094403263198687541e-2 * t144 * t146;
  t154 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t104 * t56 - t113 - 0.3e1 / 0.8e1 * t5 * t27 * t149);
  t156 = my_piecewise5(t14, 0, t10, 0, -t99);
  t159 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t156);
  t160 = t159 * t26;
  t164 = t67 * t109;
  t167 = t5 * t164 * t91 / 0.8e1;
  t169 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t160 * t91 - t167);
  tvrho0 = t60 + t95 + t6 * (t154 + t169);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t172 = -t7 - t98;
  t173 = my_piecewise5(t10, 0, t14, 0, t172);
  t176 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t173);
  t177 = t176 * t26;
  t182 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t177 * t56 - t113);
  t184 = my_piecewise5(t14, 0, t10, 0, -t172);
  t187 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t184);
  t188 = t187 * t26;
  t192 = pow(t74, 0.1626712e1);
  t194 = t192 * t78 * t29;
  t195 = t32 * t69;
  t196 = rho[1] * rho[1];
  t198 = 0.1e1 / t70 / t196;
  t199 = t195 * t198;
  t202 = pow(t74, 0.4253424e1);
  t203 = pow(t77, -0.1657946e1);
  t205 = t202 * t203 * t29;
  t208 = pow(t74, 0.2217063e1);
  t209 = t208 * t29;
  t212 = pow(t74, 0.2223476e1);
  t213 = t212 * t29;
  t216 = 0.19393490805022174494e0 * t209 * t199 - 0.19513729709845177529e0 * t213 * t199;
  t218 = t88 * t88;
  t219 = 0.1e1 / t218;
  t220 = t85 * t219;
  t221 = pow(t74, 0.2473804e1);
  t222 = t220 * t221;
  t224 = t33 * t69 * t198;
  t227 = -0.21064836058394555311e-3 * t194 * t199 + 0.18671024483029835192e-7 * t205 * t199 + t216 * t89 + 0.22094403263198687541e-2 * t222 * t224;
  t232 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t188 * t91 - t167 - 0.3e1 / 0.8e1 * t5 * t68 * t227);
  tvrho1 = t60 + t95 + t6 * (t182 + t232);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t235 = 0.1e1 / t34;
  t236 = t32 * t235;
  t237 = t236 * t37;
  t246 = -0.72725590518833154352e-1 * t131 * t237 + 0.73176486411919415733e-1 * t135 * t237;
  t249 = t33 * t235 * t37;
  t252 = 0.78993135218979582417e-4 * t116 * t237 - 0.7001634181136188197e-8 * t127 * t237 + t246 * t54 - 0.82854012236995078279e-3 * t144 * t249;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t252);
  tvsigma0 = t6 * t256;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t257 = 0.1e1 / t69;
  t258 = t32 * t257;
  t259 = t258 * t72;
  t268 = -0.72725590518833154352e-1 * t209 * t259 + 0.73176486411919415733e-1 * t213 * t259;
  t271 = t33 * t257 * t72;
  t274 = 0.78993135218979582417e-4 * t194 * t259 - 0.7001634181136188197e-8 * t205 * t259 + t268 * t89 - 0.82854012236995078279e-3 * t222 * t271;
  t278 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t274);
  tvsigma2 = t6 * t278;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t39, t40;
  double t42, t43, t46, t48, t50, t51, t53, t54;
  double t56, t60, t61, t62, t63, t64, t65, t67;
  double t68, t69, t70, t72, t74, t75, t77, t78;
  double t81, t83, t85, t86, t88, t89, t91, t95;
  double tzk0;

  double t96, t97, t98, t99, t100, t103, t104, t108;
  double t109, t110, t113, t114, t116, t117, t118, t120;
  double t121, t124, t125, t127, t130, t131, t134, t135;
  double t138, t140, t141, t142, t143, t144, t146, t149;
  double t154, t156, t159, t160, t164, t167, t169, tvrho0;
  double t172, t173, t176, t177, t182, t184, t187, t188;
  double t192, t194, t195, t196, t198, t199, t202, t203;
  double t205, t208, t209, t212, t213, t216, t218, t219;
  double t220, t221, t222, t224, t227, t232, tvrho1, t235;
  double t236, t237, t246, t249, t252, t256, tvsigma0, tvsigma1;
  double t257, t258, t259, t268, t271, t274, t278, tvsigma2;

  double t281, t282, t283, t286, t287, t288, t290, t291;
  double t295, t296, t300, t302, t308, t309, t312, t314;
  double t316, t317, t318, t319, t320, t321, t322, t323;
  double t325, t326, t329, t330, t331, t334, t336, t337;
  double t340, t341, t342, t343, t348, t349, t354, t355;
  double t360, t362, t363, t367, t368, t369, t370, t371;
  double t373, t376, t377, t381, t384, t389, t390, t391;
  double t392, t396, t400, t401, t405, t407, t409, t412;
  double t414, tv2rho20, t417, t420, t421, t425, t426, t430;
  double t432, t440, t441, t444, t448, t449, t453, t455;
  double t462, t465, tv2rho21, t470, t474, t475, t479, t480;
  double t486, t487, t491, t495, t496, t505, t506, t507;
  double t508, t509, t510, t512, t513, t516, t517, t518;
  double t521, t523, t524, t527, t528, t529, t530, t535;
  double t536, t541, t542, t547, t549, t550, t554, t555;
  double t556, t557, t559, t562, t563, t567, t570, t575;
  double tv2rho22, t583, t585, t586, t591, t598, t607, t609;
  double t610, t620, t623, t628, tv2rhosigma0, tv2rhosigma1, t635, t637;
  double tv2rhosigma2, t643, tv2rhosigma3, tv2rhosigma4, t649, t650, t655, t662;
  double t671, t673, t674, t684, t687, t692, tv2rhosigma5, t694;
  double t695, t697, t698, t703, t704, t705, t706, t721;
  double t726, t732, t735, t739, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t740, t741, t743, t744, t749, t750, t751;
  double t752, t767, t772, t778, t781, t785, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = pow(t39, 0.2626712e1);
  t42 = 0.1e1 + 0.13471619689594796103e-3 * t40;
  t43 = pow(t42, -0.657946e0);
  t46 = pow(t39, 0.3217063e1);
  t48 = pow(t39, 0.3223476e1);
  t50 = 0.1e1 - 0.45212413010769857073e-1 * t46 + 0.45402221956620378581e-1 * t48;
  t51 = pow(t39, 0.3473804e1);
  t53 = 0.1e1 + 0.47702180224903349918e-3 * t51;
  t54 = 0.1e1 / t53;
  t56 = 0.60146019220211109872e-4 * t40 * t43 + t50 * t54;
  t60 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t56);
  t61 = rho[1] <= p->dens_threshold;
  t62 = my_piecewise5(t14, t11, t10, t15, -t17);
  t63 = 0.1e1 + t62;
  t64 = t63 <= p->zeta_threshold;
  t65 = POW_1_3(t63);
  t67 = my_piecewise3(t64, t22, t65 * t63);
  t68 = t67 * t26;
  t69 = sqrt(sigma[2]);
  t70 = POW_1_3(rho[1]);
  t72 = 0.1e1 / t70 / rho[1];
  t74 = t33 * t69 * t72;
  t75 = pow(t74, 0.2626712e1);
  t77 = 0.1e1 + 0.13471619689594796103e-3 * t75;
  t78 = pow(t77, -0.657946e0);
  t81 = pow(t74, 0.3217063e1);
  t83 = pow(t74, 0.3223476e1);
  t85 = 0.1e1 - 0.45212413010769857073e-1 * t81 + 0.45402221956620378581e-1 * t83;
  t86 = pow(t74, 0.3473804e1);
  t88 = 0.1e1 + 0.47702180224903349918e-3 * t86;
  t89 = 0.1e1 / t88;
  t91 = 0.60146019220211109872e-4 * t75 * t78 + t85 * t89;
  t95 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t91);
  tzk0 = t60 + t95;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t96 = t6 * t6;
  t97 = 0.1e1 / t96;
  t98 = t16 * t97;
  t99 = t7 - t98;
  t100 = my_piecewise5(t10, 0, t14, 0, t99);
  t103 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t100);
  t104 = t103 * t26;
  t108 = t26 * t26;
  t109 = 0.1e1 / t108;
  t110 = t25 * t109;
  t113 = t5 * t110 * t56 / 0.8e1;
  t114 = pow(t39, 0.1626712e1);
  t116 = t114 * t43 * t29;
  t117 = t32 * t34;
  t118 = rho[0] * rho[0];
  t120 = 0.1e1 / t35 / t118;
  t121 = t117 * t120;
  t124 = pow(t39, 0.4253424e1);
  t125 = pow(t42, -0.1657946e1);
  t127 = t124 * t125 * t29;
  t130 = pow(t39, 0.2217063e1);
  t131 = t130 * t29;
  t134 = pow(t39, 0.2223476e1);
  t135 = t134 * t29;
  t138 = 0.19393490805022174494e0 * t131 * t121 - 0.19513729709845177529e0 * t135 * t121;
  t140 = t53 * t53;
  t141 = 0.1e1 / t140;
  t142 = t50 * t141;
  t143 = pow(t39, 0.2473804e1);
  t144 = t142 * t143;
  t146 = t33 * t34 * t120;
  t149 = -0.21064836058394555311e-3 * t116 * t121 + 0.18671024483029835192e-7 * t127 * t121 + t138 * t54 + 0.22094403263198687541e-2 * t144 * t146;
  t154 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t104 * t56 - t113 - 0.3e1 / 0.8e1 * t5 * t27 * t149);
  t156 = my_piecewise5(t14, 0, t10, 0, -t99);
  t159 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t156);
  t160 = t159 * t26;
  t164 = t67 * t109;
  t167 = t5 * t164 * t91 / 0.8e1;
  t169 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t160 * t91 - t167);
  tvrho0 = t60 + t95 + t6 * (t154 + t169);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t172 = -t7 - t98;
  t173 = my_piecewise5(t10, 0, t14, 0, t172);
  t176 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t173);
  t177 = t176 * t26;
  t182 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t177 * t56 - t113);
  t184 = my_piecewise5(t14, 0, t10, 0, -t172);
  t187 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t184);
  t188 = t187 * t26;
  t192 = pow(t74, 0.1626712e1);
  t194 = t192 * t78 * t29;
  t195 = t32 * t69;
  t196 = rho[1] * rho[1];
  t198 = 0.1e1 / t70 / t196;
  t199 = t195 * t198;
  t202 = pow(t74, 0.4253424e1);
  t203 = pow(t77, -0.1657946e1);
  t205 = t202 * t203 * t29;
  t208 = pow(t74, 0.2217063e1);
  t209 = t208 * t29;
  t212 = pow(t74, 0.2223476e1);
  t213 = t212 * t29;
  t216 = 0.19393490805022174494e0 * t209 * t199 - 0.19513729709845177529e0 * t213 * t199;
  t218 = t88 * t88;
  t219 = 0.1e1 / t218;
  t220 = t85 * t219;
  t221 = pow(t74, 0.2473804e1);
  t222 = t220 * t221;
  t224 = t33 * t69 * t198;
  t227 = -0.21064836058394555311e-3 * t194 * t199 + 0.18671024483029835192e-7 * t205 * t199 + t216 * t89 + 0.22094403263198687541e-2 * t222 * t224;
  t232 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t188 * t91 - t167 - 0.3e1 / 0.8e1 * t5 * t68 * t227);
  tvrho1 = t60 + t95 + t6 * (t182 + t232);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t235 = 0.1e1 / t34;
  t236 = t32 * t235;
  t237 = t236 * t37;
  t246 = -0.72725590518833154352e-1 * t131 * t237 + 0.73176486411919415733e-1 * t135 * t237;
  t249 = t33 * t235 * t37;
  t252 = 0.78993135218979582417e-4 * t116 * t237 - 0.7001634181136188197e-8 * t127 * t237 + t246 * t54 - 0.82854012236995078279e-3 * t144 * t249;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t252);
  tvsigma0 = t6 * t256;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t257 = 0.1e1 / t69;
  t258 = t32 * t257;
  t259 = t258 * t72;
  t268 = -0.72725590518833154352e-1 * t209 * t259 + 0.73176486411919415733e-1 * t213 * t259;
  t271 = t33 * t257 * t72;
  t274 = 0.78993135218979582417e-4 * t194 * t259 - 0.7001634181136188197e-8 * t205 * t259 + t268 * t89 - 0.82854012236995078279e-3 * t222 * t271;
  t278 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t274);
  tvsigma2 = t6 * t278;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t281 = t23 * t23;
  t282 = 0.1e1 / t281;
  t283 = t100 * t100;
  t286 = t96 * t6;
  t287 = 0.1e1 / t286;
  t288 = t16 * t287;
  t290 = -0.2e1 * t97 + 0.2e1 * t288;
  t291 = my_piecewise5(t10, 0, t14, 0, t290);
  t295 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t282 * t283 + 0.4e1 / 0.3e1 * t23 * t291);
  t296 = t295 * t26;
  t300 = t103 * t109;
  t302 = t5 * t300 * t56;
  t308 = 0.1e1 / t108 / t6;
  t309 = t25 * t308;
  t312 = t5 * t309 * t56 / 0.12e2;
  t314 = t5 * t110 * t149;
  t316 = pow(t39, 0.626712e0);
  t317 = t316 * t43;
  t318 = t317 * t28;
  t319 = t31 * t31;
  t320 = 0.1e1 / t319;
  t321 = t320 * sigma[0];
  t322 = t118 * t118;
  t323 = t35 * t35;
  t325 = 0.1e1 / t323 / t322;
  t326 = t321 * t325;
  t329 = pow(t39, 0.3253424e1);
  t330 = t329 * t125;
  t331 = t330 * t28;
  t334 = t118 * rho[0];
  t336 = 0.1e1 / t35 / t334;
  t337 = t117 * t336;
  t340 = pow(t39, 0.5880136e1);
  t341 = pow(t42, -0.2657946e1);
  t342 = t340 * t341;
  t343 = t342 * t28;
  t348 = pow(t39, 0.1217063e1);
  t349 = t348 * t28;
  t354 = pow(t39, 0.1223476e1);
  t355 = t354 * t28;
  t360 = -0.343972727237239018e1 * t349 * t326 - 0.45251478545051740486e0 * t131 * t337 + 0.34710647744262172761e1 * t355 * t326 + 0.45532035989638747568e0 * t135 * t337;
  t362 = t138 * t141;
  t363 = t362 * t143;
  t367 = 0.1e1 / t140 / t53;
  t368 = t50 * t367;
  t369 = pow(t39, 0.4947608e1);
  t370 = t368 * t369;
  t371 = t28 * t320;
  t373 = t371 * sigma[0] * t325;
  t376 = pow(t39, 0.1473804e1);
  t377 = t142 * t376;
  t381 = t33 * t34 * t336;
  t384 = 0.27413137275378499087e-2 * t318 * t326 - 0.10276735016205996654e-5 * t331 * t326 + 0.49151284136253962392e-3 * t116 * t337 + 0.87631609607945203792e-10 * t343 * t326 - 0.43565723793736282115e-7 * t127 * t337 + t360 * t54 + 0.44188806526397375082e-2 * t363 * t146 + 0.58579518666821377499e-4 * t370 * t373 - 0.43725778536091172827e-1 * t377 * t373 - 0.51553607614130270929e-2 * t144 * t381;
  t389 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t296 * t56 - t302 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t104 * t149 + t312 - t314 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t384);
  t390 = t65 * t65;
  t391 = 0.1e1 / t390;
  t392 = t156 * t156;
  t396 = my_piecewise5(t14, 0, t10, 0, -t290);
  t400 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t391 * t392 + 0.4e1 / 0.3e1 * t65 * t396);
  t401 = t400 * t26;
  t405 = t159 * t109;
  t407 = t5 * t405 * t91;
  t409 = t67 * t308;
  t412 = t5 * t409 * t91 / 0.12e2;
  t414 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t401 * t91 - t407 / 0.4e1 + t412);
  tv2rho20 = 0.2e1 * t154 + 0.2e1 * t169 + t6 * (t389 + t414);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t417 = t282 * t173;
  t420 = 0.2e1 * t288;
  t421 = my_piecewise5(t10, 0, t14, 0, t420);
  t425 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t417 * t100 + 0.4e1 / 0.3e1 * t23 * t421);
  t426 = t425 * t26;
  t430 = t176 * t109;
  t432 = t5 * t430 * t56;
  t440 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t426 * t56 - t432 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t177 * t149 - t302 / 0.8e1 + t312 - t314 / 0.8e1);
  t441 = t391 * t184;
  t444 = my_piecewise5(t14, 0, t10, 0, -t420);
  t448 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t441 * t156 + 0.4e1 / 0.3e1 * t65 * t444);
  t449 = t448 * t26;
  t453 = t187 * t109;
  t455 = t5 * t453 * t91;
  t462 = t5 * t164 * t227;
  t465 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t449 * t91 - t455 / 0.8e1 - t407 / 0.8e1 + t412 - 0.3e1 / 0.8e1 * t5 * t160 * t227 - t462 / 0.8e1);
  tv2rho21 = t154 + t169 + t182 + t232 + t6 * (t440 + t465);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t470 = t173 * t173;
  t474 = 0.2e1 * t97 + 0.2e1 * t288;
  t475 = my_piecewise5(t10, 0, t14, 0, t474);
  t479 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t282 * t470 + 0.4e1 / 0.3e1 * t23 * t475);
  t480 = t479 * t26;
  t486 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t480 * t56 - t432 / 0.4e1 + t312);
  t487 = t184 * t184;
  t491 = my_piecewise5(t14, 0, t10, 0, -t474);
  t495 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t391 * t487 + 0.4e1 / 0.3e1 * t65 * t491);
  t496 = t495 * t26;
  t505 = pow(t74, 0.626712e0);
  t506 = t505 * t78;
  t507 = t506 * t28;
  t508 = t320 * sigma[2];
  t509 = t196 * t196;
  t510 = t70 * t70;
  t512 = 0.1e1 / t510 / t509;
  t513 = t508 * t512;
  t516 = pow(t74, 0.3253424e1);
  t517 = t516 * t203;
  t518 = t517 * t28;
  t521 = t196 * rho[1];
  t523 = 0.1e1 / t70 / t521;
  t524 = t195 * t523;
  t527 = pow(t74, 0.5880136e1);
  t528 = pow(t77, -0.2657946e1);
  t529 = t527 * t528;
  t530 = t529 * t28;
  t535 = pow(t74, 0.1217063e1);
  t536 = t535 * t28;
  t541 = pow(t74, 0.1223476e1);
  t542 = t541 * t28;
  t547 = -0.343972727237239018e1 * t536 * t513 - 0.45251478545051740486e0 * t209 * t524 + 0.34710647744262172761e1 * t542 * t513 + 0.45532035989638747568e0 * t213 * t524;
  t549 = t216 * t219;
  t550 = t549 * t221;
  t554 = 0.1e1 / t218 / t88;
  t555 = t85 * t554;
  t556 = pow(t74, 0.4947608e1);
  t557 = t555 * t556;
  t559 = t371 * sigma[2] * t512;
  t562 = pow(t74, 0.1473804e1);
  t563 = t220 * t562;
  t567 = t33 * t69 * t523;
  t570 = 0.27413137275378499087e-2 * t507 * t513 - 0.10276735016205996654e-5 * t518 * t513 + 0.49151284136253962392e-3 * t194 * t524 + 0.87631609607945203792e-10 * t530 * t513 - 0.43565723793736282115e-7 * t205 * t524 + t547 * t89 + 0.44188806526397375082e-2 * t550 * t224 + 0.58579518666821377499e-4 * t557 * t559 - 0.43725778536091172827e-1 * t563 * t559 - 0.51553607614130270929e-2 * t222 * t567;
  t575 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t496 * t91 - t455 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t188 * t227 + t412 - t462 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t68 * t570);
  tv2rho22 = 0.2e1 * t182 + 0.2e1 * t232 + t6 * (t486 + t575);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t583 = t5 * t110 * t252 / 0.8e1;
  t585 = 0.1e1 / t323 / t334;
  t586 = t371 * t585;
  t591 = t236 * t120;
  t598 = t320 * t585;
  t607 = 0.12898977271396463175e1 * t349 * t598 + 0.96967454025110872469e-1 * t131 * t591 - 0.13016492904098314785e1 * t355 * t598 - 0.97568648549225887644e-1 * t135 * t591;
  t609 = t246 * t141;
  t610 = t609 * t143;
  t620 = t33 * t235 * t120;
  t623 = -0.10279926478266937158e-2 * t317 * t586 + 0.38537756310772487454e-6 * t330 * t586 - 0.10532418029197277656e-3 * t116 * t591 - 0.32861853602979451422e-10 * t342 * t586 + 0.9335512241514917596e-8 * t127 * t591 + t607 * t54 + 0.22094403263198687541e-2 * t610 * t146 - 0.82854012236995078279e-3 * t363 * t249 - 0.21967319500058016562e-4 * t370 * t586 + 0.1639716695103418981e-1 * t377 * t586 + 0.11047201631599343771e-2 * t144 * t620;
  t628 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t104 * t252 - t583 - 0.3e1 / 0.8e1 * t5 * t27 * t623);
  tv2rhosigma0 = t6 * t628 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t635 = t5 * t164 * t274 / 0.8e1;
  t637 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t160 * t274 - t635);
  tv2rhosigma2 = t6 * t637 + t278;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t643 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t177 * t252 - t583);
  tv2rhosigma3 = t6 * t643 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t649 = 0.1e1 / t510 / t521;
  t650 = t371 * t649;
  t655 = t258 * t198;
  t662 = t320 * t649;
  t671 = 0.12898977271396463175e1 * t536 * t662 + 0.96967454025110872469e-1 * t209 * t655 - 0.13016492904098314785e1 * t542 * t662 - 0.97568648549225887644e-1 * t213 * t655;
  t673 = t268 * t219;
  t674 = t673 * t221;
  t684 = t33 * t257 * t198;
  t687 = -0.10279926478266937158e-2 * t506 * t650 + 0.38537756310772487454e-6 * t517 * t650 - 0.10532418029197277656e-3 * t194 * t655 - 0.32861853602979451422e-10 * t529 * t650 + 0.9335512241514917596e-8 * t205 * t655 + t671 * t89 + 0.22094403263198687541e-2 * t674 * t224 - 0.82854012236995078279e-3 * t550 * t271 - 0.21967319500058016562e-4 * t557 * t650 + 0.1639716695103418981e-1 * t563 * t650 + 0.11047201631599343771e-2 * t222 * t684;
  t692 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t188 * t274 - t635 - 0.3e1 / 0.8e1 * t5 * t68 * t687);
  tv2rhosigma5 = t6 * t692 + t278;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t694 = 0.1e1 / sigma[0];
  t695 = t320 * t694;
  t697 = 0.1e1 / t323 / t118;
  t698 = t695 * t697;
  t703 = t34 * sigma[0];
  t704 = 0.1e1 / t703;
  t705 = t32 * t704;
  t706 = t705 * t37;
  t721 = -0.48371164767736736906e0 * t349 * t698 + 0.36362795259416577176e-1 * t131 * t706 + 0.48811848390368680445e0 * t355 * t698 - 0.36588243205959707866e-1 * t135 * t706;
  t726 = t371 * t694 * t697;
  t732 = t33 * t704 * t37;
  t735 = 0.38549724293501014342e-3 * t318 * t698 - 0.14451658616539682796e-6 * t331 * t698 - 0.39496567609489791208e-4 * t116 * t706 + 0.12323195101117294284e-10 * t343 * t698 + 0.35008170905680940985e-8 * t127 * t706 + t721 * t54 - 0.16570802447399015656e-2 * t610 * t249 + 0.82377448125217562105e-5 * t370 * t726 - 0.61489376066378211788e-2 * t377 * t726 + 0.4142700611849753914e-3 * t144 * t732;
  t739 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t735);
  tv2sigma20 = t6 * t739;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t740 = 0.1e1 / sigma[2];
  t741 = t320 * t740;
  t743 = 0.1e1 / t510 / t196;
  t744 = t741 * t743;
  t749 = t69 * sigma[2];
  t750 = 0.1e1 / t749;
  t751 = t32 * t750;
  t752 = t751 * t72;
  t767 = -0.48371164767736736906e0 * t536 * t744 + 0.36362795259416577176e-1 * t209 * t752 + 0.48811848390368680445e0 * t542 * t744 - 0.36588243205959707866e-1 * t213 * t752;
  t772 = t371 * t740 * t743;
  t778 = t33 * t750 * t72;
  t781 = 0.38549724293501014342e-3 * t507 * t744 - 0.14451658616539682796e-6 * t518 * t744 - 0.39496567609489791208e-4 * t194 * t752 + 0.12323195101117294284e-10 * t530 * t744 + 0.35008170905680940985e-8 * t205 * t752 + t767 * t89 - 0.16570802447399015656e-2 * t674 * t271 + 0.82377448125217562105e-5 * t557 * t772 - 0.61489376066378211788e-2 * t563 * t772 + 0.4142700611849753914e-3 * t222 * t778;
  t785 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t781);
  tv2sigma25 = t6 * t785;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t39, t40;
  double t42, t43, t46, t48, t50, t51, t53, t54;
  double t56, t60, t61, t62, t63, t64, t65, t67;
  double t68, t69, t70, t72, t74, t75, t77, t78;
  double t81, t83, t85, t86, t88, t89, t91, t95;
  double tzk0;

  double t96, t97, t98, t99, t100, t103, t104, t108;
  double t109, t110, t113, t114, t116, t117, t118, t120;
  double t121, t124, t125, t127, t130, t131, t134, t135;
  double t138, t140, t141, t142, t143, t144, t146, t149;
  double t154, t156, t159, t160, t164, t167, t169, tvrho0;
  double t172, t173, t176, t177, t182, t184, t187, t188;
  double t192, t194, t195, t196, t198, t199, t202, t203;
  double t205, t208, t209, t212, t213, t216, t218, t219;
  double t220, t221, t222, t224, t227, t232, tvrho1, t235;
  double t236, t237, t246, t249, t252, t256, tvsigma0, tvsigma1;
  double t257, t258, t259, t268, t271, t274, t278, tvsigma2;

  double t281, t282, t283, t286, t287, t288, t290, t291;
  double t295, t296, t300, t302, t308, t309, t312, t314;
  double t316, t317, t318, t319, t320, t321, t322, t323;
  double t325, t326, t329, t330, t331, t334, t336, t337;
  double t340, t341, t342, t343, t348, t349, t354, t355;
  double t360, t362, t363, t367, t368, t369, t370, t371;
  double t373, t376, t377, t381, t384, t389, t390, t391;
  double t392, t396, t400, t401, t405, t407, t409, t412;
  double t414, tv2rho20, t417, t420, t421, t425, t426, t430;
  double t432, t440, t441, t444, t448, t449, t453, t455;
  double t462, t465, tv2rho21, t470, t474, t475, t479, t480;
  double t486, t487, t491, t495, t496, t505, t506, t507;
  double t508, t509, t510, t512, t513, t516, t517, t518;
  double t521, t523, t524, t527, t528, t529, t530, t535;
  double t536, t541, t542, t547, t549, t550, t554, t555;
  double t556, t557, t559, t562, t563, t567, t570, t575;
  double tv2rho22, t583, t585, t586, t591, t598, t607, t609;
  double t610, t620, t623, t628, tv2rhosigma0, tv2rhosigma1, t635, t637;
  double tv2rhosigma2, t643, tv2rhosigma3, tv2rhosigma4, t649, t650, t655, t662;
  double t671, t673, t674, t684, t687, t692, tv2rhosigma5, t694;
  double t695, t697, t698, t703, t704, t705, t706, t721;
  double t726, t732, t735, t739, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t740, t741, t743, t744, t749, t750, t751;
  double t752, t767, t772, t778, t781, t785, tv2sigma25;

  double t789, t790, t793, t796, t797, t798, t800, t801;
  double t805, t806, t810, t812, t817, t819, t822, t828;
  double t829, t832, t834, t837, t841, t843, t845, t851;
  double t853, t856, t857, t858, t859, t860, t861, t864;
  double t867, t870, t871, t878, t880, t881, t882, t883;
  double t884, t885, t888, t889, t890, t893, t894, t895;
  double t896, t899, t900, t903, t904, t907, t910, t911;
  double t912, t917, t918, t921, t922, t925, t940, t941;
  double t942, t945, t946, t951, t953, t954, t957, t961;
  double t965, t966, t970, t972, t974, t976, t978, t981;
  double t983, tv3rho30, t986, t987, t988, t991, t996, t997;
  double t998, t999, t1003, t1004, t1008, t1011, t1015, t1017;
  double t1021, t1030, t1031, t1032, t1035, t1041, t1045, t1046;
  double t1050, t1053, t1054, t1056, t1065, t1067, t1070, tv3rho31;
  double t1073, t1078, t1081, t1082, t1086, t1087, t1091, t1093;
  double t1102, t1103, t1108, t1112, t1116, t1117, t1121, t1123;
  double t1130, t1138, t1140, t1141, tv3rho32, t1146, t1152, t1153;
  double t1157, t1158, t1165, t1166, t1172, t1176, t1177, t1192;
  double t1193, t1194, t1195, t1196, t1197, t1200, t1201, t1204;
  double t1205, t1208, t1209, t1210, t1211, t1212, t1213, t1216;
  double t1217, t1220, t1221, t1224, t1225, t1228, t1232, t1233;
  double t1236, t1238, t1239, t1244, t1245, t1246, t1249, t1250;
  double t1257, t1258, t1259, t1266, t1267, t1274, t1280, t1281;
  double t1282, t1286, t1292, t1297, t1298, t1303, tv3rho33, t1311;
  double t1318, t1320, t1322, t1323, t1324, t1327, t1330, t1339;
  double t1343, t1344, t1348, t1355, t1356, t1359, t1363, t1367;
  double t1371, t1378, t1379, t1408, t1409, t1414, tv3rho2sigma0, tv3rho2sigma1;
  double t1421, t1425, t1427, tv3rho2sigma2, t1433, t1441, tv3rho2sigma3, tv3rho2sigma4;
  double t1447, t1454, t1457, tv3rho2sigma5, t1465, tv3rho2sigma6, tv3rho2sigma7, t1476;
  double t1477, t1478, t1481, t1484, t1493, t1495, t1496, t1499;
  double t1500, t1503, t1509, t1517, t1521, t1525, t1532, t1533;
  double t1562, t1563, t1568, tv3rho2sigma8, t1575, t1576, t1577, t1580;
  double t1583, t1592, t1594, t1595, t1607, t1613, t1618, t1619;
  double t1622, t1623, t1626, t1627, t1630, t1659, t1660, t1665;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1672, t1674, tv3rhosigma25;
  double t1680, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1685, t1686;
  double t1689, t1692, t1701, t1711, t1712, t1716, t1722, t1727;
  double t1728, t1731, t1732, t1735, t1736, t1739, t1768, t1769;
  double t1774, tv3rhosigma211, t1776, t1777, t1778, t1783, t1784, t1787;
  double t1788, t1797, t1800, t1801, t1802, t1803, t1807, t1808;
  double t1809, t1818, t1826, t1846, t1852, t1855, t1856, t1860;
  double tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37;
  double tv3sigma38, t1861, t1862, t1863, t1866, t1867, t1874, t1875;
  double t1876, t1877, t1881, t1882, t1883, t1895, t1898, t1902;
  double t1905, t1918, t1920, t1921, t1940, t1941, t1945, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = pow(t39, 0.2626712e1);
  t42 = 0.1e1 + 0.13471619689594796103e-3 * t40;
  t43 = pow(t42, -0.657946e0);
  t46 = pow(t39, 0.3217063e1);
  t48 = pow(t39, 0.3223476e1);
  t50 = 0.1e1 - 0.45212413010769857073e-1 * t46 + 0.45402221956620378581e-1 * t48;
  t51 = pow(t39, 0.3473804e1);
  t53 = 0.1e1 + 0.47702180224903349918e-3 * t51;
  t54 = 0.1e1 / t53;
  t56 = 0.60146019220211109872e-4 * t40 * t43 + t50 * t54;
  t60 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t56);
  t61 = rho[1] <= p->dens_threshold;
  t62 = my_piecewise5(t14, t11, t10, t15, -t17);
  t63 = 0.1e1 + t62;
  t64 = t63 <= p->zeta_threshold;
  t65 = POW_1_3(t63);
  t67 = my_piecewise3(t64, t22, t65 * t63);
  t68 = t67 * t26;
  t69 = sqrt(sigma[2]);
  t70 = POW_1_3(rho[1]);
  t72 = 0.1e1 / t70 / rho[1];
  t74 = t33 * t69 * t72;
  t75 = pow(t74, 0.2626712e1);
  t77 = 0.1e1 + 0.13471619689594796103e-3 * t75;
  t78 = pow(t77, -0.657946e0);
  t81 = pow(t74, 0.3217063e1);
  t83 = pow(t74, 0.3223476e1);
  t85 = 0.1e1 - 0.45212413010769857073e-1 * t81 + 0.45402221956620378581e-1 * t83;
  t86 = pow(t74, 0.3473804e1);
  t88 = 0.1e1 + 0.47702180224903349918e-3 * t86;
  t89 = 0.1e1 / t88;
  t91 = 0.60146019220211109872e-4 * t75 * t78 + t85 * t89;
  t95 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t91);
  tzk0 = t60 + t95;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t96 = t6 * t6;
  t97 = 0.1e1 / t96;
  t98 = t16 * t97;
  t99 = t7 - t98;
  t100 = my_piecewise5(t10, 0, t14, 0, t99);
  t103 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t100);
  t104 = t103 * t26;
  t108 = t26 * t26;
  t109 = 0.1e1 / t108;
  t110 = t25 * t109;
  t113 = t5 * t110 * t56 / 0.8e1;
  t114 = pow(t39, 0.1626712e1);
  t116 = t114 * t43 * t29;
  t117 = t32 * t34;
  t118 = rho[0] * rho[0];
  t120 = 0.1e1 / t35 / t118;
  t121 = t117 * t120;
  t124 = pow(t39, 0.4253424e1);
  t125 = pow(t42, -0.1657946e1);
  t127 = t124 * t125 * t29;
  t130 = pow(t39, 0.2217063e1);
  t131 = t130 * t29;
  t134 = pow(t39, 0.2223476e1);
  t135 = t134 * t29;
  t138 = 0.19393490805022174494e0 * t131 * t121 - 0.19513729709845177529e0 * t135 * t121;
  t140 = t53 * t53;
  t141 = 0.1e1 / t140;
  t142 = t50 * t141;
  t143 = pow(t39, 0.2473804e1);
  t144 = t142 * t143;
  t146 = t33 * t34 * t120;
  t149 = -0.21064836058394555311e-3 * t116 * t121 + 0.18671024483029835192e-7 * t127 * t121 + t138 * t54 + 0.22094403263198687541e-2 * t144 * t146;
  t154 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t104 * t56 - t113 - 0.3e1 / 0.8e1 * t5 * t27 * t149);
  t156 = my_piecewise5(t14, 0, t10, 0, -t99);
  t159 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t156);
  t160 = t159 * t26;
  t164 = t67 * t109;
  t167 = t5 * t164 * t91 / 0.8e1;
  t169 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t160 * t91 - t167);
  tvrho0 = t60 + t95 + t6 * (t154 + t169);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t172 = -t7 - t98;
  t173 = my_piecewise5(t10, 0, t14, 0, t172);
  t176 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t173);
  t177 = t176 * t26;
  t182 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t177 * t56 - t113);
  t184 = my_piecewise5(t14, 0, t10, 0, -t172);
  t187 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t184);
  t188 = t187 * t26;
  t192 = pow(t74, 0.1626712e1);
  t194 = t192 * t78 * t29;
  t195 = t32 * t69;
  t196 = rho[1] * rho[1];
  t198 = 0.1e1 / t70 / t196;
  t199 = t195 * t198;
  t202 = pow(t74, 0.4253424e1);
  t203 = pow(t77, -0.1657946e1);
  t205 = t202 * t203 * t29;
  t208 = pow(t74, 0.2217063e1);
  t209 = t208 * t29;
  t212 = pow(t74, 0.2223476e1);
  t213 = t212 * t29;
  t216 = 0.19393490805022174494e0 * t209 * t199 - 0.19513729709845177529e0 * t213 * t199;
  t218 = t88 * t88;
  t219 = 0.1e1 / t218;
  t220 = t85 * t219;
  t221 = pow(t74, 0.2473804e1);
  t222 = t220 * t221;
  t224 = t33 * t69 * t198;
  t227 = -0.21064836058394555311e-3 * t194 * t199 + 0.18671024483029835192e-7 * t205 * t199 + t216 * t89 + 0.22094403263198687541e-2 * t222 * t224;
  t232 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t188 * t91 - t167 - 0.3e1 / 0.8e1 * t5 * t68 * t227);
  tvrho1 = t60 + t95 + t6 * (t182 + t232);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t235 = 0.1e1 / t34;
  t236 = t32 * t235;
  t237 = t236 * t37;
  t246 = -0.72725590518833154352e-1 * t131 * t237 + 0.73176486411919415733e-1 * t135 * t237;
  t249 = t33 * t235 * t37;
  t252 = 0.78993135218979582417e-4 * t116 * t237 - 0.7001634181136188197e-8 * t127 * t237 + t246 * t54 - 0.82854012236995078279e-3 * t144 * t249;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t252);
  tvsigma0 = t6 * t256;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t257 = 0.1e1 / t69;
  t258 = t32 * t257;
  t259 = t258 * t72;
  t268 = -0.72725590518833154352e-1 * t209 * t259 + 0.73176486411919415733e-1 * t213 * t259;
  t271 = t33 * t257 * t72;
  t274 = 0.78993135218979582417e-4 * t194 * t259 - 0.7001634181136188197e-8 * t205 * t259 + t268 * t89 - 0.82854012236995078279e-3 * t222 * t271;
  t278 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t274);
  tvsigma2 = t6 * t278;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t281 = t23 * t23;
  t282 = 0.1e1 / t281;
  t283 = t100 * t100;
  t286 = t96 * t6;
  t287 = 0.1e1 / t286;
  t288 = t16 * t287;
  t290 = -0.2e1 * t97 + 0.2e1 * t288;
  t291 = my_piecewise5(t10, 0, t14, 0, t290);
  t295 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t282 * t283 + 0.4e1 / 0.3e1 * t23 * t291);
  t296 = t295 * t26;
  t300 = t103 * t109;
  t302 = t5 * t300 * t56;
  t308 = 0.1e1 / t108 / t6;
  t309 = t25 * t308;
  t312 = t5 * t309 * t56 / 0.12e2;
  t314 = t5 * t110 * t149;
  t316 = pow(t39, 0.626712e0);
  t317 = t316 * t43;
  t318 = t317 * t28;
  t319 = t31 * t31;
  t320 = 0.1e1 / t319;
  t321 = t320 * sigma[0];
  t322 = t118 * t118;
  t323 = t35 * t35;
  t325 = 0.1e1 / t323 / t322;
  t326 = t321 * t325;
  t329 = pow(t39, 0.3253424e1);
  t330 = t329 * t125;
  t331 = t330 * t28;
  t334 = t118 * rho[0];
  t336 = 0.1e1 / t35 / t334;
  t337 = t117 * t336;
  t340 = pow(t39, 0.5880136e1);
  t341 = pow(t42, -0.2657946e1);
  t342 = t340 * t341;
  t343 = t342 * t28;
  t348 = pow(t39, 0.1217063e1);
  t349 = t348 * t28;
  t354 = pow(t39, 0.1223476e1);
  t355 = t354 * t28;
  t360 = -0.343972727237239018e1 * t349 * t326 - 0.45251478545051740486e0 * t131 * t337 + 0.34710647744262172761e1 * t355 * t326 + 0.45532035989638747568e0 * t135 * t337;
  t362 = t138 * t141;
  t363 = t362 * t143;
  t367 = 0.1e1 / t140 / t53;
  t368 = t50 * t367;
  t369 = pow(t39, 0.4947608e1);
  t370 = t368 * t369;
  t371 = t28 * t320;
  t373 = t371 * sigma[0] * t325;
  t376 = pow(t39, 0.1473804e1);
  t377 = t142 * t376;
  t381 = t33 * t34 * t336;
  t384 = 0.27413137275378499087e-2 * t318 * t326 - 0.10276735016205996654e-5 * t331 * t326 + 0.49151284136253962392e-3 * t116 * t337 + 0.87631609607945203792e-10 * t343 * t326 - 0.43565723793736282115e-7 * t127 * t337 + t360 * t54 + 0.44188806526397375082e-2 * t363 * t146 + 0.58579518666821377499e-4 * t370 * t373 - 0.43725778536091172827e-1 * t377 * t373 - 0.51553607614130270929e-2 * t144 * t381;
  t389 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t296 * t56 - t302 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t104 * t149 + t312 - t314 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t384);
  t390 = t65 * t65;
  t391 = 0.1e1 / t390;
  t392 = t156 * t156;
  t396 = my_piecewise5(t14, 0, t10, 0, -t290);
  t400 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t391 * t392 + 0.4e1 / 0.3e1 * t65 * t396);
  t401 = t400 * t26;
  t405 = t159 * t109;
  t407 = t5 * t405 * t91;
  t409 = t67 * t308;
  t412 = t5 * t409 * t91 / 0.12e2;
  t414 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t401 * t91 - t407 / 0.4e1 + t412);
  tv2rho20 = 0.2e1 * t154 + 0.2e1 * t169 + t6 * (t389 + t414);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t417 = t282 * t173;
  t420 = 0.2e1 * t288;
  t421 = my_piecewise5(t10, 0, t14, 0, t420);
  t425 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t417 * t100 + 0.4e1 / 0.3e1 * t23 * t421);
  t426 = t425 * t26;
  t430 = t176 * t109;
  t432 = t5 * t430 * t56;
  t440 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t426 * t56 - t432 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t177 * t149 - t302 / 0.8e1 + t312 - t314 / 0.8e1);
  t441 = t391 * t184;
  t444 = my_piecewise5(t14, 0, t10, 0, -t420);
  t448 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t441 * t156 + 0.4e1 / 0.3e1 * t65 * t444);
  t449 = t448 * t26;
  t453 = t187 * t109;
  t455 = t5 * t453 * t91;
  t462 = t5 * t164 * t227;
  t465 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t449 * t91 - t455 / 0.8e1 - t407 / 0.8e1 + t412 - 0.3e1 / 0.8e1 * t5 * t160 * t227 - t462 / 0.8e1);
  tv2rho21 = t154 + t169 + t182 + t232 + t6 * (t440 + t465);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t470 = t173 * t173;
  t474 = 0.2e1 * t97 + 0.2e1 * t288;
  t475 = my_piecewise5(t10, 0, t14, 0, t474);
  t479 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t282 * t470 + 0.4e1 / 0.3e1 * t23 * t475);
  t480 = t479 * t26;
  t486 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t480 * t56 - t432 / 0.4e1 + t312);
  t487 = t184 * t184;
  t491 = my_piecewise5(t14, 0, t10, 0, -t474);
  t495 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t391 * t487 + 0.4e1 / 0.3e1 * t65 * t491);
  t496 = t495 * t26;
  t505 = pow(t74, 0.626712e0);
  t506 = t505 * t78;
  t507 = t506 * t28;
  t508 = t320 * sigma[2];
  t509 = t196 * t196;
  t510 = t70 * t70;
  t512 = 0.1e1 / t510 / t509;
  t513 = t508 * t512;
  t516 = pow(t74, 0.3253424e1);
  t517 = t516 * t203;
  t518 = t517 * t28;
  t521 = t196 * rho[1];
  t523 = 0.1e1 / t70 / t521;
  t524 = t195 * t523;
  t527 = pow(t74, 0.5880136e1);
  t528 = pow(t77, -0.2657946e1);
  t529 = t527 * t528;
  t530 = t529 * t28;
  t535 = pow(t74, 0.1217063e1);
  t536 = t535 * t28;
  t541 = pow(t74, 0.1223476e1);
  t542 = t541 * t28;
  t547 = -0.343972727237239018e1 * t536 * t513 - 0.45251478545051740486e0 * t209 * t524 + 0.34710647744262172761e1 * t542 * t513 + 0.45532035989638747568e0 * t213 * t524;
  t549 = t216 * t219;
  t550 = t549 * t221;
  t554 = 0.1e1 / t218 / t88;
  t555 = t85 * t554;
  t556 = pow(t74, 0.4947608e1);
  t557 = t555 * t556;
  t559 = t371 * sigma[2] * t512;
  t562 = pow(t74, 0.1473804e1);
  t563 = t220 * t562;
  t567 = t33 * t69 * t523;
  t570 = 0.27413137275378499087e-2 * t507 * t513 - 0.10276735016205996654e-5 * t518 * t513 + 0.49151284136253962392e-3 * t194 * t524 + 0.87631609607945203792e-10 * t530 * t513 - 0.43565723793736282115e-7 * t205 * t524 + t547 * t89 + 0.44188806526397375082e-2 * t550 * t224 + 0.58579518666821377499e-4 * t557 * t559 - 0.43725778536091172827e-1 * t563 * t559 - 0.51553607614130270929e-2 * t222 * t567;
  t575 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t496 * t91 - t455 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t188 * t227 + t412 - t462 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t68 * t570);
  tv2rho22 = 0.2e1 * t182 + 0.2e1 * t232 + t6 * (t486 + t575);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t583 = t5 * t110 * t252 / 0.8e1;
  t585 = 0.1e1 / t323 / t334;
  t586 = t371 * t585;
  t591 = t236 * t120;
  t598 = t320 * t585;
  t607 = 0.12898977271396463175e1 * t349 * t598 + 0.96967454025110872469e-1 * t131 * t591 - 0.13016492904098314785e1 * t355 * t598 - 0.97568648549225887644e-1 * t135 * t591;
  t609 = t246 * t141;
  t610 = t609 * t143;
  t620 = t33 * t235 * t120;
  t623 = -0.10279926478266937158e-2 * t317 * t586 + 0.38537756310772487454e-6 * t330 * t586 - 0.10532418029197277656e-3 * t116 * t591 - 0.32861853602979451422e-10 * t342 * t586 + 0.9335512241514917596e-8 * t127 * t591 + t607 * t54 + 0.22094403263198687541e-2 * t610 * t146 - 0.82854012236995078279e-3 * t363 * t249 - 0.21967319500058016562e-4 * t370 * t586 + 0.1639716695103418981e-1 * t377 * t586 + 0.11047201631599343771e-2 * t144 * t620;
  t628 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t104 * t252 - t583 - 0.3e1 / 0.8e1 * t5 * t27 * t623);
  tv2rhosigma0 = t6 * t628 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t635 = t5 * t164 * t274 / 0.8e1;
  t637 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t160 * t274 - t635);
  tv2rhosigma2 = t6 * t637 + t278;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t643 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t177 * t252 - t583);
  tv2rhosigma3 = t6 * t643 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t649 = 0.1e1 / t510 / t521;
  t650 = t371 * t649;
  t655 = t258 * t198;
  t662 = t320 * t649;
  t671 = 0.12898977271396463175e1 * t536 * t662 + 0.96967454025110872469e-1 * t209 * t655 - 0.13016492904098314785e1 * t542 * t662 - 0.97568648549225887644e-1 * t213 * t655;
  t673 = t268 * t219;
  t674 = t673 * t221;
  t684 = t33 * t257 * t198;
  t687 = -0.10279926478266937158e-2 * t506 * t650 + 0.38537756310772487454e-6 * t517 * t650 - 0.10532418029197277656e-3 * t194 * t655 - 0.32861853602979451422e-10 * t529 * t650 + 0.9335512241514917596e-8 * t205 * t655 + t671 * t89 + 0.22094403263198687541e-2 * t674 * t224 - 0.82854012236995078279e-3 * t550 * t271 - 0.21967319500058016562e-4 * t557 * t650 + 0.1639716695103418981e-1 * t563 * t650 + 0.11047201631599343771e-2 * t222 * t684;
  t692 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t188 * t274 - t635 - 0.3e1 / 0.8e1 * t5 * t68 * t687);
  tv2rhosigma5 = t6 * t692 + t278;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t694 = 0.1e1 / sigma[0];
  t695 = t320 * t694;
  t697 = 0.1e1 / t323 / t118;
  t698 = t695 * t697;
  t703 = t34 * sigma[0];
  t704 = 0.1e1 / t703;
  t705 = t32 * t704;
  t706 = t705 * t37;
  t721 = -0.48371164767736736906e0 * t349 * t698 + 0.36362795259416577176e-1 * t131 * t706 + 0.48811848390368680445e0 * t355 * t698 - 0.36588243205959707866e-1 * t135 * t706;
  t726 = t371 * t694 * t697;
  t732 = t33 * t704 * t37;
  t735 = 0.38549724293501014342e-3 * t318 * t698 - 0.14451658616539682796e-6 * t331 * t698 - 0.39496567609489791208e-4 * t116 * t706 + 0.12323195101117294284e-10 * t343 * t698 + 0.35008170905680940985e-8 * t127 * t706 + t721 * t54 - 0.16570802447399015656e-2 * t610 * t249 + 0.82377448125217562105e-5 * t370 * t726 - 0.61489376066378211788e-2 * t377 * t726 + 0.4142700611849753914e-3 * t144 * t732;
  t739 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t735);
  tv2sigma20 = t6 * t739;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t740 = 0.1e1 / sigma[2];
  t741 = t320 * t740;
  t743 = 0.1e1 / t510 / t196;
  t744 = t741 * t743;
  t749 = t69 * sigma[2];
  t750 = 0.1e1 / t749;
  t751 = t32 * t750;
  t752 = t751 * t72;
  t767 = -0.48371164767736736906e0 * t536 * t744 + 0.36362795259416577176e-1 * t209 * t752 + 0.48811848390368680445e0 * t542 * t744 - 0.36588243205959707866e-1 * t213 * t752;
  t772 = t371 * t740 * t743;
  t778 = t33 * t750 * t72;
  t781 = 0.38549724293501014342e-3 * t507 * t744 - 0.14451658616539682796e-6 * t518 * t744 - 0.39496567609489791208e-4 * t194 * t752 + 0.12323195101117294284e-10 * t530 * t744 + 0.35008170905680940985e-8 * t205 * t752 + t767 * t89 - 0.16570802447399015656e-2 * t674 * t271 + 0.82377448125217562105e-5 * t557 * t772 - 0.61489376066378211788e-2 * t563 * t772 + 0.4142700611849753914e-3 * t222 * t778;
  t785 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t781);
  tv2sigma25 = t6 * t785;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t789 = 0.1e1 / t281 / t19;
  t790 = t283 * t100;
  t793 = t282 * t100;
  t796 = t96 * t96;
  t797 = 0.1e1 / t796;
  t798 = t16 * t797;
  t800 = 0.6e1 * t287 - 0.6e1 * t798;
  t801 = my_piecewise5(t10, 0, t14, 0, t800);
  t805 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t789 * t790 + 0.4e1 / 0.3e1 * t793 * t291 + 0.4e1 / 0.3e1 * t23 * t801);
  t806 = t805 * t26;
  t810 = t295 * t109;
  t812 = t5 * t810 * t56;
  t817 = t103 * t308;
  t819 = t5 * t817 * t56;
  t822 = t5 * t300 * t149;
  t828 = 0.1e1 / t108 / t96;
  t829 = t25 * t828;
  t832 = 0.5e1 / 0.36e2 * t5 * t829 * t56;
  t834 = t5 * t309 * t149;
  t837 = t5 * t110 * t384;
  t841 = t322 * rho[0];
  t843 = 0.1e1 / t323 / t841;
  t845 = t371 * sigma[0] * t843;
  t851 = 0.1e1 / t35 / t322;
  t853 = t33 * t34 * t851;
  t856 = pow(t39, 0.217063e0);
  t857 = 0.1e1 / t30;
  t858 = t856 * t857;
  t859 = t322 * t334;
  t860 = 0.1e1 / t859;
  t861 = t703 * t860;
  t864 = t321 * t843;
  t867 = t117 * t851;
  t870 = pow(t39, 0.223476e0);
  t871 = t870 * t857;
  t878 = 0.33490918346362866477e2 * t858 * t861 + 0.2407809090660673126e2 * t349 * t864 + 0.15083826181683913495e1 * t131 * t867 - 0.33974115567647124865e2 * t871 * t861 - 0.24297453420983520933e2 * t355 * t864 - 0.15177345329879582523e1 * t135 * t867;
  t880 = t140 * t140;
  t881 = 0.1e1 / t880;
  t882 = t50 * t881;
  t883 = pow(t39, 0.7421412e1);
  t884 = t883 * t703;
  t885 = t884 * t860;
  t888 = pow(t39, 0.3947608e1);
  t889 = t888 * t703;
  t890 = t889 * t860;
  t893 = pow(t39, 0.2253424e1);
  t894 = t893 * t125;
  t895 = t857 * t703;
  t896 = t895 * t860;
  t899 = pow(t39, 0.4880136e1);
  t900 = t899 * t341;
  t903 = pow(t39, -0.373288e0);
  t904 = t903 * t43;
  t907 = t368 * t888;
  t910 = -0.15466082284239081279e-1 * t363 * t381 - 0.4100566306677496425e-3 * t370 * t845 + 0.30608044975263820979e0 * t377 * t845 + 0.17184535871376756976e-1 * t144 * t853 + t878 * t54 + 0.23604827715716212363e-6 * t882 * t885 - 0.1174630647445706867e-3 * t368 * t890 + 0.26747661074691982766e-4 * t894 * t896 - 0.41222862591489958308e-8 * t900 * t896 - 0.13744113670501607936e-1 * t904 * t896 - 0.23186279615369182551e-2 * t907 * t896;
  t911 = pow(t39, 0.473804e0);
  t912 = t142 * t911;
  t917 = t360 * t141;
  t918 = t917 * t143;
  t921 = t138 * t367;
  t922 = t921 * t369;
  t925 = t362 * t376;
  t940 = pow(t39, 0.7506848e1);
  t941 = pow(t42, -0.3657946e1);
  t942 = t940 * t941;
  t945 = 0.51554581847684251902e0 * t912 * t896 + 0.14521907931245427372e-6 * t127 * t867 + 0.66283209789596062623e-2 * t918 * t146 + 0.1757385560004641325e-3 * t922 * t373 - 0.13117733560827351848e0 * t925 * t373 - 0.19189196092764949361e-1 * t318 * t864 + 0.71937145113441976578e-5 * t331 * t864 - 0.16383761378751320797e-2 * t116 * t867 - 0.61342126725561642654e-9 * t343 * t864 + 0.51733457620317460808e-6 * t894 * t861 - 0.48870643036920313633e-9 * t900 * t861 + 0.66808151565745085494e-13 * t942 * t861;
  t946 = t910 + t945;
  t951 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t806 * t56 - 0.3e1 / 0.8e1 * t812 - 0.9e1 / 0.8e1 * t5 * t296 * t149 + t819 / 0.4e1 - 0.3e1 / 0.4e1 * t822 - 0.9e1 / 0.8e1 * t5 * t104 * t384 - t832 + t834 / 0.4e1 - 0.3e1 / 0.8e1 * t837 - 0.3e1 / 0.8e1 * t5 * t27 * t946);
  t953 = 0.1e1 / t390 / t63;
  t954 = t392 * t156;
  t957 = t391 * t156;
  t961 = my_piecewise5(t14, 0, t10, 0, -t800);
  t965 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t953 * t954 + 0.4e1 / 0.3e1 * t957 * t396 + 0.4e1 / 0.3e1 * t65 * t961);
  t966 = t965 * t26;
  t970 = t400 * t109;
  t972 = t5 * t970 * t91;
  t974 = t159 * t308;
  t976 = t5 * t974 * t91;
  t978 = t67 * t828;
  t981 = 0.5e1 / 0.36e2 * t5 * t978 * t91;
  t983 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t966 * t91 - 0.3e1 / 0.8e1 * t972 + t976 / 0.4e1 - t981);
  tv3rho30 = 0.3e1 * t389 + 0.3e1 * t414 + t6 * (t951 + t983);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t986 = 0.2e1 * t440;
  t987 = 0.2e1 * t465;
  t988 = t789 * t173;
  t991 = t282 * t421;
  t996 = 0.2e1 * t287;
  t997 = 0.6e1 * t798;
  t998 = t996 - t997;
  t999 = my_piecewise5(t10, 0, t14, 0, t998);
  t1003 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t988 * t283 + 0.8e1 / 0.9e1 * t991 * t100 + 0.4e1 / 0.9e1 * t417 * t291 + 0.4e1 / 0.3e1 * t23 * t999);
  t1004 = t1003 * t26;
  t1008 = t425 * t109;
  t1011 = t5 * t1008 * t56 / 0.4e1;
  t1015 = t176 * t308;
  t1017 = t5 * t1015 * t56;
  t1021 = t5 * t430 * t149 / 0.4e1;
  t1030 = -0.3e1 / 0.8e1 * t5 * t1004 * t56 - t1011 - 0.3e1 / 0.4e1 * t5 * t426 * t149 + t1017 / 0.12e2 - t1021 - 0.3e1 / 0.8e1 * t5 * t177 * t384 - t812 / 0.8e1 + t819 / 0.6e1 - t822 / 0.4e1 - t832 + t834 / 0.6e1 - t837 / 0.8e1;
  t1031 = my_piecewise3(t1, 0, t1030);
  t1032 = t953 * t184;
  t1035 = t391 * t444;
  t1041 = my_piecewise5(t14, 0, t10, 0, -t998);
  t1045 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1032 * t392 + 0.8e1 / 0.9e1 * t1035 * t156 + 0.4e1 / 0.9e1 * t441 * t396 + 0.4e1 / 0.3e1 * t65 * t1041);
  t1046 = t1045 * t26;
  t1050 = t448 * t109;
  t1053 = t5 * t1050 * t91 / 0.4e1;
  t1054 = t187 * t308;
  t1056 = t5 * t1054 * t91;
  t1065 = t5 * t405 * t227 / 0.4e1;
  t1067 = t5 * t409 * t227;
  t1070 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1046 * t91 - t1053 + t1056 / 0.12e2 - t972 / 0.8e1 + t976 / 0.6e1 - t981 - 0.3e1 / 0.8e1 * t5 * t401 * t227 - t1065 + t1067 / 0.12e2);
  tv3rho31 = t389 + t414 + t986 + t987 + t6 * (t1031 + t1070);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1073 = t789 * t470;
  t1078 = t282 * t475;
  t1081 = -t996 - t997;
  t1082 = my_piecewise5(t10, 0, t14, 0, t1081);
  t1086 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1073 * t100 + 0.8e1 / 0.9e1 * t417 * t421 + 0.4e1 / 0.9e1 * t1078 * t100 + 0.4e1 / 0.3e1 * t23 * t1082);
  t1087 = t1086 * t26;
  t1091 = t479 * t109;
  t1093 = t5 * t1091 * t56;
  t1102 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1087 * t56 - t1093 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t480 * t149 - t1011 + t1017 / 0.6e1 - t1021 + t819 / 0.12e2 - t832 + t834 / 0.12e2);
  t1103 = t953 * t487;
  t1108 = t391 * t491;
  t1112 = my_piecewise5(t14, 0, t10, 0, -t1081);
  t1116 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1103 * t156 + 0.8e1 / 0.9e1 * t441 * t444 + 0.4e1 / 0.9e1 * t1108 * t156 + 0.4e1 / 0.3e1 * t65 * t1112);
  t1117 = t1116 * t26;
  t1121 = t495 * t109;
  t1123 = t5 * t1121 * t91;
  t1130 = t5 * t453 * t227;
  t1138 = t5 * t164 * t570;
  t1140 = -0.3e1 / 0.8e1 * t5 * t1117 * t91 - t1123 / 0.8e1 - t1053 + t1056 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t449 * t227 - t1130 / 0.4e1 + t976 / 0.12e2 - t981 - t1065 + t1067 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t160 * t570 - t1138 / 0.8e1;
  t1141 = my_piecewise3(t61, 0, t1140);
  tv3rho32 = t986 + t987 + t486 + t575 + t6 * (t1102 + t1141);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1146 = t470 * t173;
  t1152 = -0.6e1 * t287 - 0.6e1 * t798;
  t1153 = my_piecewise5(t10, 0, t14, 0, t1152);
  t1157 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t789 * t1146 + 0.4e1 / 0.3e1 * t417 * t475 + 0.4e1 / 0.3e1 * t23 * t1153);
  t1158 = t1157 * t26;
  t1165 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1158 * t56 - 0.3e1 / 0.8e1 * t1093 + t1017 / 0.4e1 - t832);
  t1166 = t487 * t184;
  t1172 = my_piecewise5(t14, 0, t10, 0, -t1152);
  t1176 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t953 * t1166 + 0.4e1 / 0.3e1 * t441 * t491 + 0.4e1 / 0.3e1 * t65 * t1172);
  t1177 = t1176 * t26;
  t1192 = pow(t74, 0.3947608e1);
  t1193 = t555 * t1192;
  t1194 = t857 * t749;
  t1195 = t509 * t521;
  t1196 = 0.1e1 / t1195;
  t1197 = t1194 * t1196;
  t1200 = pow(t74, 0.473804e0);
  t1201 = t220 * t1200;
  t1204 = t1192 * t749;
  t1205 = t1204 * t1196;
  t1208 = t218 * t218;
  t1209 = 0.1e1 / t1208;
  t1210 = t85 * t1209;
  t1211 = pow(t74, 0.7421412e1);
  t1212 = t1211 * t749;
  t1213 = t1212 * t1196;
  t1216 = pow(t74, 0.4880136e1);
  t1217 = t1216 * t528;
  t1220 = pow(t74, -0.373288e0);
  t1221 = t1220 * t78;
  t1224 = pow(t74, 0.2253424e1);
  t1225 = t1224 * t203;
  t1228 = t549 * t562;
  t1232 = 0.1e1 / t70 / t509;
  t1233 = t195 * t1232;
  t1236 = t509 * rho[1];
  t1238 = 0.1e1 / t510 / t1236;
  t1239 = t508 * t1238;
  t1244 = -0.23186279615369182551e-2 * t1193 * t1197 + 0.51554581847684251902e0 * t1201 * t1197 - 0.1174630647445706867e-3 * t555 * t1205 + 0.23604827715716212363e-6 * t1210 * t1213 - 0.41222862591489958308e-8 * t1217 * t1197 - 0.13744113670501607936e-1 * t1221 * t1197 + 0.26747661074691982766e-4 * t1225 * t1197 - 0.13117733560827351848e0 * t1228 * t559 - 0.16383761378751320797e-2 * t194 * t1233 - 0.61342126725561642654e-9 * t530 * t1239 + 0.14521907931245427372e-6 * t205 * t1233;
  t1245 = t547 * t219;
  t1246 = t1245 * t221;
  t1249 = t216 * t554;
  t1250 = t1249 * t556;
  t1257 = pow(t74, 0.217063e0);
  t1258 = t1257 * t857;
  t1259 = t749 * t1196;
  t1266 = pow(t74, 0.223476e0);
  t1267 = t1266 * t857;
  t1274 = 0.33490918346362866477e2 * t1258 * t1259 + 0.2407809090660673126e2 * t536 * t1239 + 0.15083826181683913495e1 * t209 * t1233 - 0.33974115567647124865e2 * t1267 * t1259 - 0.24297453420983520933e2 * t542 * t1239 - 0.15177345329879582523e1 * t213 * t1233;
  t1280 = pow(t74, 0.7506848e1);
  t1281 = pow(t77, -0.3657946e1);
  t1282 = t1280 * t1281;
  t1286 = t371 * sigma[2] * t1238;
  t1292 = t33 * t69 * t1232;
  t1297 = 0.66283209789596062623e-2 * t1246 * t224 + 0.1757385560004641325e-3 * t1250 * t559 - 0.19189196092764949361e-1 * t507 * t1239 + 0.71937145113441976578e-5 * t518 * t1239 + t1274 * t89 + 0.51733457620317460808e-6 * t1225 * t1259 - 0.48870643036920313633e-9 * t1217 * t1259 + 0.66808151565745085494e-13 * t1282 * t1259 - 0.4100566306677496425e-3 * t557 * t1286 + 0.30608044975263820979e0 * t563 * t1286 + 0.17184535871376756976e-1 * t222 * t1292 - 0.15466082284239081279e-1 * t550 * t567;
  t1298 = t1244 + t1297;
  t1303 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1177 * t91 - 0.3e1 / 0.8e1 * t1123 - 0.9e1 / 0.8e1 * t5 * t496 * t227 + t1056 / 0.4e1 - 0.3e1 / 0.4e1 * t1130 - 0.9e1 / 0.8e1 * t5 * t188 * t570 - t981 + t1067 / 0.4e1 - 0.3e1 / 0.8e1 * t1138 - 0.3e1 / 0.8e1 * t5 * t68 * t1298);
  tv3rho33 = 0.3e1 * t486 + 0.3e1 * t575 + t6 * (t1165 + t1303);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1311 = t5 * t300 * t252;
  t1318 = t5 * t309 * t252 / 0.12e2;
  t1320 = t5 * t110 * t623;
  t1322 = t322 * t118;
  t1323 = 0.1e1 / t1322;
  t1324 = t1323 * t34;
  t1327 = t320 * t325;
  t1330 = t236 * t336;
  t1339 = -0.12559094379886074929e2 * t858 * t1324 - 0.64494886356982315875e1 * t349 * t1327 - 0.22625739272525870243e0 * t131 * t1330 + 0.12740293337867671824e2 * t871 * t1324 + 0.65082464520491573925e1 * t355 * t1327 + 0.22766017994819373784e0 * t135 * t1330;
  t1343 = t607 * t141;
  t1344 = t1343 * t143;
  t1348 = t33 * t235 * t336;
  t1355 = t246 * t367;
  t1356 = t1355 * t369;
  t1359 = t609 * t376;
  t1363 = t888 * t1323 * t34;
  t1367 = t883 * t1323 * t34;
  t1371 = t857 * t1323 * t34;
  t1378 = t1339 * t54 - 0.82854012236995078279e-3 * t918 * t249 + 0.44188806526397375082e-2 * t1344 * t146 - 0.25776803807065135466e-2 * t144 * t1348 - 0.51553607614130270929e-2 * t610 * t381 + 0.22094403263198687542e-2 * t363 * t620 + 0.58579518666821377499e-4 * t1356 * t373 - 0.43725778536091172827e-1 * t1359 * t373 + 0.44048649279214007511e-4 * t368 * t1363 - 0.8851810393393579636e-7 * t882 * t1367 - 0.10030372903009493538e-4 * t894 * t1371 + 0.15458573471808734365e-8 * t900 * t1371 + 0.51540426264381029761e-2 * t904 * t1371;
  t1379 = t371 * t325;
  t1408 = 0.5139963239133468579e-2 * t317 * t1379 - 0.19268878155386243727e-5 * t330 * t1379 + 0.16430926801489725711e-9 * t342 * t1379 - 0.43934639000116033124e-4 * t922 * t586 + 0.3279433390206837962e-1 * t925 * t586 + 0.86948548557634434565e-3 * t907 * t1371 - 0.19332968192881594463e0 * t912 * t1371 + 0.10983659750029008281e-3 * t370 * t1379 - 0.81985834755170949051e-1 * t377 * t1379 + 0.24575642068126981197e-3 * t116 * t1330 - 0.21782861896868141057e-7 * t127 * t1330 - 0.2505305683715440706e-13 * t942 * t1324 - 0.19400046607619047804e-6 * t894 * t1324 + 0.18326491138845117613e-9 * t900 * t1324;
  t1409 = t1378 + t1408;
  t1414 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t296 * t252 - t1311 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t104 * t623 + t1318 - t1320 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1409);
  tv3rho2sigma0 = t6 * t1414 + 0.2e1 * t628;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1421 = t5 * t405 * t274;
  t1425 = t5 * t409 * t274 / 0.12e2;
  t1427 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t401 * t274 - t1421 / 0.4e1 + t1425);
  tv3rho2sigma2 = t6 * t1427 + 0.2e1 * t637;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1433 = t5 * t430 * t252;
  t1441 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t426 * t252 - t1433 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t177 * t623 - t1311 / 0.8e1 + t1318 - t1320 / 0.8e1);
  tv3rho2sigma3 = t6 * t1441 + t628 + t643;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1447 = t5 * t453 * t274;
  t1454 = t5 * t164 * t687;
  t1457 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t449 * t274 - t1447 / 0.8e1 - t1421 / 0.8e1 + t1425 - 0.3e1 / 0.8e1 * t5 * t160 * t687 - t1454 / 0.8e1);
  tv3rho2sigma5 = t6 * t1457 + t637 + t692;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1465 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t480 * t252 - t1433 / 0.4e1 + t1318);
  tv3rho2sigma6 = t6 * t1465 + 0.2e1 * t643;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1476 = t509 * t196;
  t1477 = 0.1e1 / t1476;
  t1478 = t1477 * t69;
  t1481 = t320 * t512;
  t1484 = t258 * t523;
  t1493 = -0.12559094379886074929e2 * t1258 * t1478 - 0.64494886356982315875e1 * t536 * t1481 - 0.22625739272525870243e0 * t209 * t1484 + 0.12740293337867671824e2 * t1267 * t1478 + 0.65082464520491573925e1 * t542 * t1481 + 0.22766017994819373784e0 * t213 * t1484;
  t1495 = t671 * t219;
  t1496 = t1495 * t221;
  t1499 = t268 * t554;
  t1500 = t1499 * t556;
  t1503 = t673 * t562;
  t1509 = t33 * t257 * t523;
  t1517 = t1192 * t1477 * t69;
  t1521 = t1211 * t1477 * t69;
  t1525 = t857 * t1477 * t69;
  t1532 = t1493 * t89 + 0.44188806526397375082e-2 * t1496 * t224 + 0.58579518666821377499e-4 * t1500 * t559 - 0.43725778536091172827e-1 * t1503 * t559 - 0.82854012236995078279e-3 * t1246 * t271 - 0.25776803807065135466e-2 * t222 * t1509 - 0.51553607614130270929e-2 * t674 * t567 + 0.22094403263198687542e-2 * t550 * t684 + 0.44048649279214007511e-4 * t555 * t1517 - 0.8851810393393579636e-7 * t1210 * t1521 + 0.51540426264381029761e-2 * t1221 * t1525 - 0.10030372903009493538e-4 * t1225 * t1525 + 0.15458573471808734365e-8 * t1217 * t1525;
  t1533 = t371 * t512;
  t1562 = 0.5139963239133468579e-2 * t506 * t1533 - 0.19268878155386243727e-5 * t517 * t1533 + 0.16430926801489725711e-9 * t529 * t1533 - 0.2505305683715440706e-13 * t1282 * t1478 - 0.19400046607619047804e-6 * t1225 * t1478 + 0.18326491138845117613e-9 * t1217 * t1478 - 0.43934639000116033124e-4 * t1250 * t650 + 0.3279433390206837962e-1 * t1228 * t650 + 0.86948548557634434565e-3 * t1193 * t1525 - 0.19332968192881594463e0 * t1201 * t1525 + 0.10983659750029008281e-3 * t557 * t1533 - 0.81985834755170949051e-1 * t563 * t1533 + 0.24575642068126981197e-3 * t194 * t1484 - 0.21782861896868141057e-7 * t205 * t1484;
  t1563 = t1532 + t1562;
  t1568 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t496 * t274 - t1447 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t188 * t687 + t1425 - t1454 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t68 * t1563);
  tv3rho2sigma8 = t6 * t1568 + 0.2e1 * t692;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1575 = t5 * t110 * t735 / 0.8e1;
  t1576 = 0.1e1 / t841;
  t1577 = t235 * t1576;
  t1580 = t695 * t585;
  t1583 = t705 * t120;
  t1592 = 0.47096603924572780983e1 * t858 * t1577 + 0.64494886356982315875e0 * t349 * t1580 - 0.48483727012555436235e-1 * t131 * t1583 - 0.47776100017003769341e1 * t871 * t1577 - 0.65082464520491573924e0 * t355 * t1580 + 0.48784324274612943821e-1 * t135 * t1583;
  t1594 = t721 * t141;
  t1595 = t1594 * t143;
  t1607 = t371 * t694 * t585;
  t1613 = t33 * t704 * t120;
  t1618 = t883 * t235;
  t1619 = t1618 * t1576;
  t1622 = t888 * t235;
  t1623 = t1622 * t1576;
  t1626 = t857 * t235;
  t1627 = t1626 * t1576;
  t1630 = t1592 * t54 + 0.22094403263198687541e-2 * t1595 * t146 - 0.16570802447399015656e-2 * t1344 * t249 + 0.82377448125217562105e-5 * t922 * t726 - 0.61489376066378211788e-2 * t925 * t726 + 0.4142700611849753914e-3 * t363 * t732 - 0.1098365975002900828e-4 * t370 * t1607 + 0.81985834755170949048e-2 * t377 * t1607 - 0.55236008157996718853e-3 * t144 * t1613 + 0.22094403263198687541e-2 * t610 * t620 + 0.33194288975225923634e-7 * t882 * t1619 - 0.16518243479705252817e-4 * t368 * t1623 - 0.1932765984914288616e-2 * t904 * t1627;
  t1659 = 0.37613898386285600769e-5 * t894 * t1627 - 0.57969650519282753874e-9 * t900 * t1627 + 0.72750174778571429264e-7 * t894 * t1577 - 0.68724341770669191052e-10 * t900 * t1577 + 0.93948963139329026481e-14 * t942 * t1577 - 0.43934639000116033125e-4 * t1356 * t586 + 0.32794333902068379621e-1 * t1359 * t586 - 0.32605705709112912961e-3 * t907 * t1627 + 0.72498630723305979237e-1 * t912 * t1627 - 0.4667756120757458798e-8 * t127 * t1583 - 0.51399632391334685792e-3 * t318 * t1580 + 0.19268878155386243729e-6 * t331 * t1580 + 0.52662090145986388277e-4 * t116 * t1583 - 0.16430926801489725713e-10 * t343 * t1580;
  t1660 = t1630 + t1659;
  t1665 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t104 * t735 - t1575 - 0.3e1 / 0.8e1 * t5 * t27 * t1660);
  tv3rhosigma20 = t6 * t1665 + t739;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1672 = t5 * t164 * t781 / 0.8e1;
  t1674 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t160 * t781 - t1672);
  tv3rhosigma25 = t6 * t1674 + t785;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1680 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t177 * t735 - t1575);
  tv3rhosigma26 = t6 * t1680 + t739;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1685 = 0.1e1 / t1236;
  t1686 = t257 * t1685;
  t1689 = t741 * t649;
  t1692 = t751 * t198;
  t1701 = 0.47096603924572780983e1 * t1258 * t1686 + 0.64494886356982315875e0 * t536 * t1689 - 0.48483727012555436235e-1 * t209 * t1692 - 0.47776100017003769341e1 * t1267 * t1686 - 0.65082464520491573924e0 * t542 * t1689 + 0.48784324274612943821e-1 * t213 * t1692;
  t1711 = t767 * t219;
  t1712 = t1711 * t221;
  t1716 = t371 * t740 * t649;
  t1722 = t33 * t750 * t198;
  t1727 = t1211 * t257;
  t1728 = t1727 * t1685;
  t1731 = t1192 * t257;
  t1732 = t1731 * t1685;
  t1735 = t857 * t257;
  t1736 = t1735 * t1685;
  t1739 = t1701 * t89 - 0.16570802447399015656e-2 * t1496 * t271 + 0.82377448125217562105e-5 * t1250 * t772 - 0.61489376066378211788e-2 * t1228 * t772 + 0.4142700611849753914e-3 * t550 * t778 + 0.22094403263198687541e-2 * t1712 * t224 - 0.1098365975002900828e-4 * t557 * t1716 + 0.81985834755170949048e-2 * t563 * t1716 - 0.55236008157996718853e-3 * t222 * t1722 + 0.22094403263198687541e-2 * t674 * t684 + 0.33194288975225923634e-7 * t1210 * t1728 - 0.16518243479705252817e-4 * t555 * t1732 - 0.1932765984914288616e-2 * t1221 * t1736;
  t1768 = 0.37613898386285600769e-5 * t1225 * t1736 - 0.57969650519282753874e-9 * t1217 * t1736 + 0.72750174778571429264e-7 * t1225 * t1686 - 0.68724341770669191052e-10 * t1217 * t1686 + 0.93948963139329026481e-14 * t1282 * t1686 + 0.72498630723305979237e-1 * t1201 * t1736 - 0.43934639000116033125e-4 * t1500 * t650 + 0.32794333902068379621e-1 * t1503 * t650 - 0.32605705709112912961e-3 * t1193 * t1736 + 0.19268878155386243729e-6 * t518 * t1689 + 0.52662090145986388277e-4 * t194 * t1692 - 0.16430926801489725713e-10 * t530 * t1689 - 0.4667756120757458798e-8 * t205 * t1692 - 0.51399632391334685792e-3 * t507 * t1689;
  t1769 = t1739 + t1768;
  t1774 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t188 * t781 - t1672 - 0.3e1 / 0.8e1 * t5 * t68 * t1769);
  tv3rhosigma211 = t6 * t1774 + t785;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1776 = t857 * t704;
  t1777 = 0.1e1 / t322;
  t1778 = t1776 * t1777;
  t1783 = t883 * t704;
  t1784 = t1783 * t1777;
  t1787 = t888 * t704;
  t1788 = t1787 * t1777;
  t1797 = t704 * t1777;
  t1800 = sigma[0] * sigma[0];
  t1801 = 0.1e1 / t1800;
  t1802 = t320 * t1801;
  t1803 = t1802 * t697;
  t1807 = 0.1e1 / t34 / t1800;
  t1808 = t32 * t1807;
  t1809 = t1808 * t37;
  t1818 = -0.17661226471714792869e1 * t858 * t1797 + 0.72556747151605105359e0 * t349 * t1803 - 0.54544192889124865764e-1 * t131 * t1809 + 0.17916037506376413503e1 * t871 * t1797 - 0.73217772585553020667e0 * t355 * t1803 + 0.54882364808939561799e-1 * t135 * t1809;
  t1826 = -0.27186986521239742214e-1 * t912 * t1778 + 0.1222713964091734236e-3 * t907 * t1778 - 0.12447858365709721362e-7 * t882 * t1784 + 0.61943413048894698061e-5 * t368 * t1788 + 0.21738618944731032703e-9 * t900 * t1778 + 0.72478724434285823101e-3 * t904 * t1778 - 0.14105211894857100288e-5 * t894 * t1778 + t1818 * t54 - 0.27281315541964285976e-7 * t894 * t1797 + 0.25771628164000946647e-10 * t900 * t1797 - 0.35230861177248384934e-14 * t942 * t1797;
  t1846 = t371 * t1801 * t697;
  t1852 = t33 * t1807 * t37;
  t1855 = -0.52512256358521411478e-8 * t127 * t1809 - 0.24856203671098523484e-2 * t1595 * t249 + 0.24713234437565268632e-4 * t1356 * t726 - 0.18446812819913463537e-1 * t1359 * t726 - 0.57824586440251521513e-3 * t318 * t1803 + 0.21677487924809524194e-6 * t331 * t1803 + 0.59244851414234686812e-4 * t116 * t1809 - 0.18484792651675941426e-10 * t343 * t1803 + 0.12428101835549261742e-2 * t610 * t732 - 0.12356617218782634316e-4 * t370 * t1846 + 0.92234064099567317682e-2 * t377 * t1846 - 0.6214050917774630871e-3 * t144 * t1852;
  t1856 = t1826 + t1855;
  t1860 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1856);
  tv3sigma30 = t6 * t1860;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1861 = t1192 * t750;
  t1862 = 0.1e1 / t509;
  t1863 = t1861 * t1862;
  t1866 = t1211 * t750;
  t1867 = t1866 * t1862;
  t1874 = sigma[2] * sigma[2];
  t1875 = 0.1e1 / t1874;
  t1876 = t320 * t1875;
  t1877 = t1876 * t743;
  t1881 = 0.1e1 / t69 / t1874;
  t1882 = t32 * t1881;
  t1883 = t1882 * t72;
  t1895 = t371 * t1875 * t743;
  t1898 = 0.61943413048894698061e-5 * t555 * t1863 - 0.12447858365709721362e-7 * t1210 * t1867 + 0.24713234437565268632e-4 * t1500 * t772 - 0.18446812819913463537e-1 * t1503 * t772 + 0.21677487924809524194e-6 * t518 * t1877 + 0.59244851414234686812e-4 * t194 * t1883 - 0.18484792651675941426e-10 * t530 * t1877 - 0.52512256358521411478e-8 * t205 * t1883 - 0.24856203671098523484e-2 * t1712 * t271 + 0.12428101835549261742e-2 * t674 * t778 - 0.12356617218782634316e-4 * t557 * t1895;
  t1902 = t33 * t1881 * t72;
  t1905 = t750 * t1862;
  t1918 = -0.17661226471714792869e1 * t1258 * t1905 + 0.72556747151605105359e0 * t536 * t1877 - 0.54544192889124865764e-1 * t209 * t1883 + 0.17916037506376413503e1 * t1267 * t1905 - 0.73217772585553020667e0 * t542 * t1877 + 0.54882364808939561799e-1 * t213 * t1883;
  t1920 = t857 * t750;
  t1921 = t1920 * t1862;
  t1940 = 0.92234064099567317682e-2 * t563 * t1895 - 0.6214050917774630871e-3 * t222 * t1902 + t1918 * t89 - 0.27186986521239742214e-1 * t1201 * t1921 + 0.1222713964091734236e-3 * t1193 * t1921 + 0.21738618944731032703e-9 * t1217 * t1921 + 0.72478724434285823101e-3 * t1221 * t1921 - 0.14105211894857100288e-5 * t1225 * t1921 - 0.27281315541964285976e-7 * t1225 * t1905 + 0.25771628164000946647e-10 * t1217 * t1905 - 0.35230861177248384934e-14 * t1282 * t1905 - 0.57824586440251521513e-3 * t507 * t1877;
  t1941 = t1898 + t1940;
  t1945 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t1941);
  tv3sigma39 = t6 * t1945;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t39, t40;
  double t42, t43, t46, t48, t50, t51, t53, t54;
  double t56, t60, t61, t62, t63, t64, t65, t67;
  double t68, t69, t70, t72, t74, t75, t77, t78;
  double t81, t83, t85, t86, t88, t89, t91, t95;
  double tzk0;

  double t96, t97, t98, t99, t100, t103, t104, t108;
  double t109, t110, t113, t114, t116, t117, t118, t120;
  double t121, t124, t125, t127, t130, t131, t134, t135;
  double t138, t140, t141, t142, t143, t144, t146, t149;
  double t154, t156, t159, t160, t164, t167, t169, tvrho0;
  double t172, t173, t176, t177, t182, t184, t187, t188;
  double t192, t194, t195, t196, t198, t199, t202, t203;
  double t205, t208, t209, t212, t213, t216, t218, t219;
  double t220, t221, t222, t224, t227, t232, tvrho1, t235;
  double t236, t237, t246, t249, t252, t256, tvsigma0, tvsigma1;
  double t257, t258, t259, t268, t271, t274, t278, tvsigma2;

  double t281, t282, t283, t286, t287, t288, t290, t291;
  double t295, t296, t300, t302, t308, t309, t312, t314;
  double t316, t317, t318, t319, t320, t321, t322, t323;
  double t325, t326, t329, t330, t331, t334, t336, t337;
  double t340, t341, t342, t343, t348, t349, t354, t355;
  double t360, t362, t363, t367, t368, t369, t370, t371;
  double t373, t376, t377, t381, t384, t389, t390, t391;
  double t392, t396, t400, t401, t405, t407, t409, t412;
  double t414, tv2rho20, t417, t420, t421, t425, t426, t430;
  double t432, t440, t441, t444, t448, t449, t453, t455;
  double t462, t465, tv2rho21, t470, t474, t475, t479, t480;
  double t486, t487, t491, t495, t496, t505, t506, t507;
  double t508, t509, t510, t512, t513, t516, t517, t518;
  double t521, t523, t524, t527, t528, t529, t530, t535;
  double t536, t541, t542, t547, t549, t550, t554, t555;
  double t556, t557, t559, t562, t563, t567, t570, t575;
  double tv2rho22, t583, t585, t586, t591, t598, t607, t609;
  double t610, t620, t623, t628, tv2rhosigma0, tv2rhosigma1, t635, t637;
  double tv2rhosigma2, t643, tv2rhosigma3, tv2rhosigma4, t649, t650, t655, t662;
  double t671, t673, t674, t684, t687, t692, tv2rhosigma5, t694;
  double t695, t697, t698, t703, t704, t705, t706, t721;
  double t726, t732, t735, t739, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t740, t741, t743, t744, t749, t750, t751;
  double t752, t767, t772, t778, t781, t785, tv2sigma25;

  double t789, t790, t793, t796, t797, t798, t800, t801;
  double t805, t806, t810, t812, t817, t819, t822, t828;
  double t829, t832, t834, t837, t841, t843, t845, t851;
  double t853, t856, t857, t858, t859, t860, t861, t864;
  double t867, t870, t871, t878, t880, t881, t882, t883;
  double t884, t885, t888, t889, t890, t893, t894, t895;
  double t896, t899, t900, t903, t904, t907, t910, t911;
  double t912, t917, t918, t921, t922, t925, t940, t941;
  double t942, t945, t946, t951, t953, t954, t957, t961;
  double t965, t966, t970, t972, t974, t976, t978, t981;
  double t983, tv3rho30, t986, t987, t988, t991, t996, t997;
  double t998, t999, t1003, t1004, t1008, t1011, t1015, t1017;
  double t1021, t1030, t1031, t1032, t1035, t1041, t1045, t1046;
  double t1050, t1053, t1054, t1056, t1065, t1067, t1070, tv3rho31;
  double t1073, t1078, t1081, t1082, t1086, t1087, t1091, t1093;
  double t1102, t1103, t1108, t1112, t1116, t1117, t1121, t1123;
  double t1130, t1138, t1140, t1141, tv3rho32, t1146, t1152, t1153;
  double t1157, t1158, t1165, t1166, t1172, t1176, t1177, t1192;
  double t1193, t1194, t1195, t1196, t1197, t1200, t1201, t1204;
  double t1205, t1208, t1209, t1210, t1211, t1212, t1213, t1216;
  double t1217, t1220, t1221, t1224, t1225, t1228, t1232, t1233;
  double t1236, t1238, t1239, t1244, t1245, t1246, t1249, t1250;
  double t1257, t1258, t1259, t1266, t1267, t1274, t1280, t1281;
  double t1282, t1286, t1292, t1297, t1298, t1303, tv3rho33, t1311;
  double t1318, t1320, t1322, t1323, t1324, t1327, t1330, t1339;
  double t1343, t1344, t1348, t1355, t1356, t1359, t1363, t1367;
  double t1371, t1378, t1379, t1408, t1409, t1414, tv3rho2sigma0, tv3rho2sigma1;
  double t1421, t1425, t1427, tv3rho2sigma2, t1433, t1441, tv3rho2sigma3, tv3rho2sigma4;
  double t1447, t1454, t1457, tv3rho2sigma5, t1465, tv3rho2sigma6, tv3rho2sigma7, t1476;
  double t1477, t1478, t1481, t1484, t1493, t1495, t1496, t1499;
  double t1500, t1503, t1509, t1517, t1521, t1525, t1532, t1533;
  double t1562, t1563, t1568, tv3rho2sigma8, t1575, t1576, t1577, t1580;
  double t1583, t1592, t1594, t1595, t1607, t1613, t1618, t1619;
  double t1622, t1623, t1626, t1627, t1630, t1659, t1660, t1665;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1672, t1674, tv3rhosigma25;
  double t1680, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1685, t1686;
  double t1689, t1692, t1701, t1711, t1712, t1716, t1722, t1727;
  double t1728, t1731, t1732, t1735, t1736, t1739, t1768, t1769;
  double t1774, tv3rhosigma211, t1776, t1777, t1778, t1783, t1784, t1787;
  double t1788, t1797, t1800, t1801, t1802, t1803, t1807, t1808;
  double t1809, t1818, t1826, t1846, t1852, t1855, t1856, t1860;
  double tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37;
  double tv3sigma38, t1861, t1862, t1863, t1866, t1867, t1874, t1875;
  double t1876, t1877, t1881, t1882, t1883, t1895, t1898, t1902;
  double t1905, t1918, t1920, t1921, t1940, t1941, t1945, tv3sigma39;

  double t1949, t1951, t1957, t1965, t1968, t1972, t1978, t1979;
  double t1980, t1983, t1985, t1988, t1989, t1992, t1993, t1997;
  double t1998, t1999, t2002, t2003, t2004, t2007, t2009, t2019;
  double t2022, t2024, t2027, t2028, t2035, t2037, t2040, t2047;
  double t2050, t2055, t2073, t2074, t2075, t2079, t2080, t2087;
  double t2090, t2091, t2099, t2102, t2103, t2121, t2128, t2131;
  double t2134, t2137, t2141, t2146, t2149, t2153, t2155, t2156;
  double t2162, t2169, t2171, t2172, t2176, t2185, t2189, t2193;
  double t2197, t2199, t2200, t2201, t2203, t2204, t2210, t2216;
  double t2220, t2227, t2231, t2235, t2240, t2242, tv4rho40, t2251;
  double t2252, t2254, t2257, t2278, t2279, t2280, t2281, t2285;
  double t2295, t2299, t2300, t2303, t2314, t2315, t2333, t2337;
  double t2344, t2348, t2349, t2352, t2361, t2364, t2365, t2367;
  double t2369, t2370, tv4rho41, t2379, t2383, t2386, t2399, t2412;
  double t2416, t2435, t2436, t2445, t2458, t2462, t2469, t2473;
  double t2482, t2485, t2496, t2499, t2501, t2502, tv4rho42, t2522;
  double t2523, t2527, t2534, t2545, t2546, t2563, t2567, t2574;
  double t2582, t2591, t2601, t2603, t2604, tv4rho43, t2609, t2614;
  double t2620, t2621, t2625, t2634, t2635, t2637, t2638, t2641;
  double t2643, t2646, t2648, t2651, t2652, t2660, t2661, t2665;
  double t2666, t2671, t2677, t2678, t2679, t2682, t2689, t2690;
  double t2694, t2695, t2699, t2700, t2704, t2707, t2710, t2711;
  double t2721, t2722, t2736, t2739, t2758, t2762, t2765, t2772;
  double t2773, t2776, t2779, t2781, t2784, t2787, t2790, t2791;
  double t2797, t2808, t2820, t2825, t2831, t2835, t2851, t2852;
  double tv4rho44, t2860, t2866, t2869, t2876, t2878, t2881, t2884;
  double t2886, t2891, t2906, t2919, t2935, t2938, t2951, t2958;
  double t2961, t2964, t2969, t2979, t2987, t2988, t2996, t3036;
  double t3041, t3048, tv4rho3sigma0, tv4rho3sigma1, t3055, t3058, t3062, t3064;
  double tv4rho3sigma2, t3066, t3072, t3077, t3081, t3090, t3091, tv4rho3sigma3;
  double tv4rho3sigma4, t3093, t3099, t3101, t3110, t3112, t3115, tv4rho3sigma5;
  double t3121, t3130, tv4rho3sigma6, tv4rho3sigma7, t3136, t3143, t3151, t3153;
  double t3154, tv4rho3sigma8, t3163, tv4rho3sigma9, tv4rho3sigma10, t3180, t3185, t3193;
  double t3196, t3205, t3212, t3217, t3219, t3232, t3249, t3252;
  double t3256, t3259, t3279, t3282, t3304, t3305, t3338, t3345;
  double tv4rho3sigma11, t3352, t3359, t3361, t3364, t3366, t3373, t3399;
  double t3402, t3404, t3407, t3418, t3424, t3427, t3430, t3439;
  double t3465, t3486, t3517, t3524, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t3531, t3535, t3537, tv4rho2sigma25, t3543, t3551, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t3557, t3564, t3567, tv4rho2sigma211;
  double t3575, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t3586, t3600;
  double t3602, t3612, t3619, t3622, t3625, t3627, t3644, t3650;
  double t3659, t3662, t3664, t3709, t3740, t3747, tv4rho2sigma217, t3754;
  double t3755, t3761, t3765, t3767, t3773, t3790, t3817, t3821;
  double t3824, t3848, t3851, t3854, t3899, t3906, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t3913;
  double t3915, tv4rhosigma39, t3921, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314;
  double tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t3928, t3930, t3933, t3936;
  double t3939, t3958, t3972, t3981, t3987, t4012, t4026, t4041;
  double t4070, t4077, tv4rhosigma319, t4081, t4084, t4087, t4088, t4090;
  double t4094, t4096, t4115, t4134, t4156, t4159, t4212, t4218;
  double tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47;
  double tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t4219, t4226;
  double t4231, t4232, t4234, t4238, t4240, t4255, t4284, t4297;
  double t4305, t4352, t4358, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = pow(t39, 0.2626712e1);
  t42 = 0.1e1 + 0.13471619689594796103e-3 * t40;
  t43 = pow(t42, -0.657946e0);
  t46 = pow(t39, 0.3217063e1);
  t48 = pow(t39, 0.3223476e1);
  t50 = 0.1e1 - 0.45212413010769857073e-1 * t46 + 0.45402221956620378581e-1 * t48;
  t51 = pow(t39, 0.3473804e1);
  t53 = 0.1e1 + 0.47702180224903349918e-3 * t51;
  t54 = 0.1e1 / t53;
  t56 = 0.60146019220211109872e-4 * t40 * t43 + t50 * t54;
  t60 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t56);
  t61 = rho[1] <= p->dens_threshold;
  t62 = my_piecewise5(t14, t11, t10, t15, -t17);
  t63 = 0.1e1 + t62;
  t64 = t63 <= p->zeta_threshold;
  t65 = POW_1_3(t63);
  t67 = my_piecewise3(t64, t22, t65 * t63);
  t68 = t67 * t26;
  t69 = sqrt(sigma[2]);
  t70 = POW_1_3(rho[1]);
  t72 = 0.1e1 / t70 / rho[1];
  t74 = t33 * t69 * t72;
  t75 = pow(t74, 0.2626712e1);
  t77 = 0.1e1 + 0.13471619689594796103e-3 * t75;
  t78 = pow(t77, -0.657946e0);
  t81 = pow(t74, 0.3217063e1);
  t83 = pow(t74, 0.3223476e1);
  t85 = 0.1e1 - 0.45212413010769857073e-1 * t81 + 0.45402221956620378581e-1 * t83;
  t86 = pow(t74, 0.3473804e1);
  t88 = 0.1e1 + 0.47702180224903349918e-3 * t86;
  t89 = 0.1e1 / t88;
  t91 = 0.60146019220211109872e-4 * t75 * t78 + t85 * t89;
  t95 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t91);
  tzk0 = t60 + t95;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t96 = t6 * t6;
  t97 = 0.1e1 / t96;
  t98 = t16 * t97;
  t99 = t7 - t98;
  t100 = my_piecewise5(t10, 0, t14, 0, t99);
  t103 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t100);
  t104 = t103 * t26;
  t108 = t26 * t26;
  t109 = 0.1e1 / t108;
  t110 = t25 * t109;
  t113 = t5 * t110 * t56 / 0.8e1;
  t114 = pow(t39, 0.1626712e1);
  t116 = t114 * t43 * t29;
  t117 = t32 * t34;
  t118 = rho[0] * rho[0];
  t120 = 0.1e1 / t35 / t118;
  t121 = t117 * t120;
  t124 = pow(t39, 0.4253424e1);
  t125 = pow(t42, -0.1657946e1);
  t127 = t124 * t125 * t29;
  t130 = pow(t39, 0.2217063e1);
  t131 = t130 * t29;
  t134 = pow(t39, 0.2223476e1);
  t135 = t134 * t29;
  t138 = 0.19393490805022174494e0 * t131 * t121 - 0.19513729709845177529e0 * t135 * t121;
  t140 = t53 * t53;
  t141 = 0.1e1 / t140;
  t142 = t50 * t141;
  t143 = pow(t39, 0.2473804e1);
  t144 = t142 * t143;
  t146 = t33 * t34 * t120;
  t149 = -0.21064836058394555311e-3 * t116 * t121 + 0.18671024483029835192e-7 * t127 * t121 + t138 * t54 + 0.22094403263198687541e-2 * t144 * t146;
  t154 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t104 * t56 - t113 - 0.3e1 / 0.8e1 * t5 * t27 * t149);
  t156 = my_piecewise5(t14, 0, t10, 0, -t99);
  t159 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t156);
  t160 = t159 * t26;
  t164 = t67 * t109;
  t167 = t5 * t164 * t91 / 0.8e1;
  t169 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t160 * t91 - t167);
  tvrho0 = t60 + t95 + t6 * (t154 + t169);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t172 = -t7 - t98;
  t173 = my_piecewise5(t10, 0, t14, 0, t172);
  t176 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t173);
  t177 = t176 * t26;
  t182 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t177 * t56 - t113);
  t184 = my_piecewise5(t14, 0, t10, 0, -t172);
  t187 = my_piecewise3(t64, 0, 0.4e1 / 0.3e1 * t65 * t184);
  t188 = t187 * t26;
  t192 = pow(t74, 0.1626712e1);
  t194 = t192 * t78 * t29;
  t195 = t32 * t69;
  t196 = rho[1] * rho[1];
  t198 = 0.1e1 / t70 / t196;
  t199 = t195 * t198;
  t202 = pow(t74, 0.4253424e1);
  t203 = pow(t77, -0.1657946e1);
  t205 = t202 * t203 * t29;
  t208 = pow(t74, 0.2217063e1);
  t209 = t208 * t29;
  t212 = pow(t74, 0.2223476e1);
  t213 = t212 * t29;
  t216 = 0.19393490805022174494e0 * t209 * t199 - 0.19513729709845177529e0 * t213 * t199;
  t218 = t88 * t88;
  t219 = 0.1e1 / t218;
  t220 = t85 * t219;
  t221 = pow(t74, 0.2473804e1);
  t222 = t220 * t221;
  t224 = t33 * t69 * t198;
  t227 = -0.21064836058394555311e-3 * t194 * t199 + 0.18671024483029835192e-7 * t205 * t199 + t216 * t89 + 0.22094403263198687541e-2 * t222 * t224;
  t232 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t188 * t91 - t167 - 0.3e1 / 0.8e1 * t5 * t68 * t227);
  tvrho1 = t60 + t95 + t6 * (t182 + t232);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t235 = 0.1e1 / t34;
  t236 = t32 * t235;
  t237 = t236 * t37;
  t246 = -0.72725590518833154352e-1 * t131 * t237 + 0.73176486411919415733e-1 * t135 * t237;
  t249 = t33 * t235 * t37;
  t252 = 0.78993135218979582417e-4 * t116 * t237 - 0.7001634181136188197e-8 * t127 * t237 + t246 * t54 - 0.82854012236995078279e-3 * t144 * t249;
  t256 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t252);
  tvsigma0 = t6 * t256;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t257 = 0.1e1 / t69;
  t258 = t32 * t257;
  t259 = t258 * t72;
  t268 = -0.72725590518833154352e-1 * t209 * t259 + 0.73176486411919415733e-1 * t213 * t259;
  t271 = t33 * t257 * t72;
  t274 = 0.78993135218979582417e-4 * t194 * t259 - 0.7001634181136188197e-8 * t205 * t259 + t268 * t89 - 0.82854012236995078279e-3 * t222 * t271;
  t278 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t274);
  tvsigma2 = t6 * t278;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t281 = t23 * t23;
  t282 = 0.1e1 / t281;
  t283 = t100 * t100;
  t286 = t96 * t6;
  t287 = 0.1e1 / t286;
  t288 = t16 * t287;
  t290 = -0.2e1 * t97 + 0.2e1 * t288;
  t291 = my_piecewise5(t10, 0, t14, 0, t290);
  t295 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t282 * t283 + 0.4e1 / 0.3e1 * t23 * t291);
  t296 = t295 * t26;
  t300 = t103 * t109;
  t302 = t5 * t300 * t56;
  t308 = 0.1e1 / t108 / t6;
  t309 = t25 * t308;
  t312 = t5 * t309 * t56 / 0.12e2;
  t314 = t5 * t110 * t149;
  t316 = pow(t39, 0.626712e0);
  t317 = t316 * t43;
  t318 = t317 * t28;
  t319 = t31 * t31;
  t320 = 0.1e1 / t319;
  t321 = t320 * sigma[0];
  t322 = t118 * t118;
  t323 = t35 * t35;
  t325 = 0.1e1 / t323 / t322;
  t326 = t321 * t325;
  t329 = pow(t39, 0.3253424e1);
  t330 = t329 * t125;
  t331 = t330 * t28;
  t334 = t118 * rho[0];
  t336 = 0.1e1 / t35 / t334;
  t337 = t117 * t336;
  t340 = pow(t39, 0.5880136e1);
  t341 = pow(t42, -0.2657946e1);
  t342 = t340 * t341;
  t343 = t342 * t28;
  t348 = pow(t39, 0.1217063e1);
  t349 = t348 * t28;
  t354 = pow(t39, 0.1223476e1);
  t355 = t354 * t28;
  t360 = -0.343972727237239018e1 * t349 * t326 - 0.45251478545051740486e0 * t131 * t337 + 0.34710647744262172761e1 * t355 * t326 + 0.45532035989638747568e0 * t135 * t337;
  t362 = t138 * t141;
  t363 = t362 * t143;
  t367 = 0.1e1 / t140 / t53;
  t368 = t50 * t367;
  t369 = pow(t39, 0.4947608e1);
  t370 = t368 * t369;
  t371 = t28 * t320;
  t373 = t371 * sigma[0] * t325;
  t376 = pow(t39, 0.1473804e1);
  t377 = t142 * t376;
  t381 = t33 * t34 * t336;
  t384 = 0.27413137275378499087e-2 * t318 * t326 - 0.10276735016205996654e-5 * t331 * t326 + 0.49151284136253962392e-3 * t116 * t337 + 0.87631609607945203792e-10 * t343 * t326 - 0.43565723793736282115e-7 * t127 * t337 + t360 * t54 + 0.44188806526397375082e-2 * t363 * t146 + 0.58579518666821377499e-4 * t370 * t373 - 0.43725778536091172827e-1 * t377 * t373 - 0.51553607614130270929e-2 * t144 * t381;
  t389 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t296 * t56 - t302 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t104 * t149 + t312 - t314 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t384);
  t390 = t65 * t65;
  t391 = 0.1e1 / t390;
  t392 = t156 * t156;
  t396 = my_piecewise5(t14, 0, t10, 0, -t290);
  t400 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t391 * t392 + 0.4e1 / 0.3e1 * t65 * t396);
  t401 = t400 * t26;
  t405 = t159 * t109;
  t407 = t5 * t405 * t91;
  t409 = t67 * t308;
  t412 = t5 * t409 * t91 / 0.12e2;
  t414 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t401 * t91 - t407 / 0.4e1 + t412);
  tv2rho20 = 0.2e1 * t154 + 0.2e1 * t169 + t6 * (t389 + t414);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t417 = t282 * t173;
  t420 = 0.2e1 * t288;
  t421 = my_piecewise5(t10, 0, t14, 0, t420);
  t425 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t417 * t100 + 0.4e1 / 0.3e1 * t23 * t421);
  t426 = t425 * t26;
  t430 = t176 * t109;
  t432 = t5 * t430 * t56;
  t440 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t426 * t56 - t432 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t177 * t149 - t302 / 0.8e1 + t312 - t314 / 0.8e1);
  t441 = t391 * t184;
  t444 = my_piecewise5(t14, 0, t10, 0, -t420);
  t448 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t441 * t156 + 0.4e1 / 0.3e1 * t65 * t444);
  t449 = t448 * t26;
  t453 = t187 * t109;
  t455 = t5 * t453 * t91;
  t462 = t5 * t164 * t227;
  t465 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t449 * t91 - t455 / 0.8e1 - t407 / 0.8e1 + t412 - 0.3e1 / 0.8e1 * t5 * t160 * t227 - t462 / 0.8e1);
  tv2rho21 = t154 + t169 + t182 + t232 + t6 * (t440 + t465);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t470 = t173 * t173;
  t474 = 0.2e1 * t97 + 0.2e1 * t288;
  t475 = my_piecewise5(t10, 0, t14, 0, t474);
  t479 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t282 * t470 + 0.4e1 / 0.3e1 * t23 * t475);
  t480 = t479 * t26;
  t486 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t480 * t56 - t432 / 0.4e1 + t312);
  t487 = t184 * t184;
  t491 = my_piecewise5(t14, 0, t10, 0, -t474);
  t495 = my_piecewise3(t64, 0, 0.4e1 / 0.9e1 * t391 * t487 + 0.4e1 / 0.3e1 * t65 * t491);
  t496 = t495 * t26;
  t505 = pow(t74, 0.626712e0);
  t506 = t505 * t78;
  t507 = t506 * t28;
  t508 = t320 * sigma[2];
  t509 = t196 * t196;
  t510 = t70 * t70;
  t512 = 0.1e1 / t510 / t509;
  t513 = t508 * t512;
  t516 = pow(t74, 0.3253424e1);
  t517 = t516 * t203;
  t518 = t517 * t28;
  t521 = t196 * rho[1];
  t523 = 0.1e1 / t70 / t521;
  t524 = t195 * t523;
  t527 = pow(t74, 0.5880136e1);
  t528 = pow(t77, -0.2657946e1);
  t529 = t527 * t528;
  t530 = t529 * t28;
  t535 = pow(t74, 0.1217063e1);
  t536 = t535 * t28;
  t541 = pow(t74, 0.1223476e1);
  t542 = t541 * t28;
  t547 = -0.343972727237239018e1 * t536 * t513 - 0.45251478545051740486e0 * t209 * t524 + 0.34710647744262172761e1 * t542 * t513 + 0.45532035989638747568e0 * t213 * t524;
  t549 = t216 * t219;
  t550 = t549 * t221;
  t554 = 0.1e1 / t218 / t88;
  t555 = t85 * t554;
  t556 = pow(t74, 0.4947608e1);
  t557 = t555 * t556;
  t559 = t371 * sigma[2] * t512;
  t562 = pow(t74, 0.1473804e1);
  t563 = t220 * t562;
  t567 = t33 * t69 * t523;
  t570 = 0.27413137275378499087e-2 * t507 * t513 - 0.10276735016205996654e-5 * t518 * t513 + 0.49151284136253962392e-3 * t194 * t524 + 0.87631609607945203792e-10 * t530 * t513 - 0.43565723793736282115e-7 * t205 * t524 + t547 * t89 + 0.44188806526397375082e-2 * t550 * t224 + 0.58579518666821377499e-4 * t557 * t559 - 0.43725778536091172827e-1 * t563 * t559 - 0.51553607614130270929e-2 * t222 * t567;
  t575 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t496 * t91 - t455 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t188 * t227 + t412 - t462 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t68 * t570);
  tv2rho22 = 0.2e1 * t182 + 0.2e1 * t232 + t6 * (t486 + t575);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t583 = t5 * t110 * t252 / 0.8e1;
  t585 = 0.1e1 / t323 / t334;
  t586 = t371 * t585;
  t591 = t236 * t120;
  t598 = t320 * t585;
  t607 = 0.12898977271396463175e1 * t349 * t598 + 0.96967454025110872469e-1 * t131 * t591 - 0.13016492904098314785e1 * t355 * t598 - 0.97568648549225887644e-1 * t135 * t591;
  t609 = t246 * t141;
  t610 = t609 * t143;
  t620 = t33 * t235 * t120;
  t623 = -0.10279926478266937158e-2 * t317 * t586 + 0.38537756310772487454e-6 * t330 * t586 - 0.10532418029197277656e-3 * t116 * t591 - 0.32861853602979451422e-10 * t342 * t586 + 0.9335512241514917596e-8 * t127 * t591 + t607 * t54 + 0.22094403263198687541e-2 * t610 * t146 - 0.82854012236995078279e-3 * t363 * t249 - 0.21967319500058016562e-4 * t370 * t586 + 0.1639716695103418981e-1 * t377 * t586 + 0.11047201631599343771e-2 * t144 * t620;
  t628 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t104 * t252 - t583 - 0.3e1 / 0.8e1 * t5 * t27 * t623);
  tv2rhosigma0 = t6 * t628 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t635 = t5 * t164 * t274 / 0.8e1;
  t637 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t160 * t274 - t635);
  tv2rhosigma2 = t6 * t637 + t278;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t643 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t177 * t252 - t583);
  tv2rhosigma3 = t6 * t643 + t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t649 = 0.1e1 / t510 / t521;
  t650 = t371 * t649;
  t655 = t258 * t198;
  t662 = t320 * t649;
  t671 = 0.12898977271396463175e1 * t536 * t662 + 0.96967454025110872469e-1 * t209 * t655 - 0.13016492904098314785e1 * t542 * t662 - 0.97568648549225887644e-1 * t213 * t655;
  t673 = t268 * t219;
  t674 = t673 * t221;
  t684 = t33 * t257 * t198;
  t687 = -0.10279926478266937158e-2 * t506 * t650 + 0.38537756310772487454e-6 * t517 * t650 - 0.10532418029197277656e-3 * t194 * t655 - 0.32861853602979451422e-10 * t529 * t650 + 0.9335512241514917596e-8 * t205 * t655 + t671 * t89 + 0.22094403263198687541e-2 * t674 * t224 - 0.82854012236995078279e-3 * t550 * t271 - 0.21967319500058016562e-4 * t557 * t650 + 0.1639716695103418981e-1 * t563 * t650 + 0.11047201631599343771e-2 * t222 * t684;
  t692 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t188 * t274 - t635 - 0.3e1 / 0.8e1 * t5 * t68 * t687);
  tv2rhosigma5 = t6 * t692 + t278;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t694 = 0.1e1 / sigma[0];
  t695 = t320 * t694;
  t697 = 0.1e1 / t323 / t118;
  t698 = t695 * t697;
  t703 = t34 * sigma[0];
  t704 = 0.1e1 / t703;
  t705 = t32 * t704;
  t706 = t705 * t37;
  t721 = -0.48371164767736736906e0 * t349 * t698 + 0.36362795259416577176e-1 * t131 * t706 + 0.48811848390368680445e0 * t355 * t698 - 0.36588243205959707866e-1 * t135 * t706;
  t726 = t371 * t694 * t697;
  t732 = t33 * t704 * t37;
  t735 = 0.38549724293501014342e-3 * t318 * t698 - 0.14451658616539682796e-6 * t331 * t698 - 0.39496567609489791208e-4 * t116 * t706 + 0.12323195101117294284e-10 * t343 * t698 + 0.35008170905680940985e-8 * t127 * t706 + t721 * t54 - 0.16570802447399015656e-2 * t610 * t249 + 0.82377448125217562105e-5 * t370 * t726 - 0.61489376066378211788e-2 * t377 * t726 + 0.4142700611849753914e-3 * t144 * t732;
  t739 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t735);
  tv2sigma20 = t6 * t739;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t740 = 0.1e1 / sigma[2];
  t741 = t320 * t740;
  t743 = 0.1e1 / t510 / t196;
  t744 = t741 * t743;
  t749 = t69 * sigma[2];
  t750 = 0.1e1 / t749;
  t751 = t32 * t750;
  t752 = t751 * t72;
  t767 = -0.48371164767736736906e0 * t536 * t744 + 0.36362795259416577176e-1 * t209 * t752 + 0.48811848390368680445e0 * t542 * t744 - 0.36588243205959707866e-1 * t213 * t752;
  t772 = t371 * t740 * t743;
  t778 = t33 * t750 * t72;
  t781 = 0.38549724293501014342e-3 * t507 * t744 - 0.14451658616539682796e-6 * t518 * t744 - 0.39496567609489791208e-4 * t194 * t752 + 0.12323195101117294284e-10 * t530 * t744 + 0.35008170905680940985e-8 * t205 * t752 + t767 * t89 - 0.16570802447399015656e-2 * t674 * t271 + 0.82377448125217562105e-5 * t557 * t772 - 0.61489376066378211788e-2 * t563 * t772 + 0.4142700611849753914e-3 * t222 * t778;
  t785 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t781);
  tv2sigma25 = t6 * t785;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t789 = 0.1e1 / t281 / t19;
  t790 = t283 * t100;
  t793 = t282 * t100;
  t796 = t96 * t96;
  t797 = 0.1e1 / t796;
  t798 = t16 * t797;
  t800 = 0.6e1 * t287 - 0.6e1 * t798;
  t801 = my_piecewise5(t10, 0, t14, 0, t800);
  t805 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t789 * t790 + 0.4e1 / 0.3e1 * t793 * t291 + 0.4e1 / 0.3e1 * t23 * t801);
  t806 = t805 * t26;
  t810 = t295 * t109;
  t812 = t5 * t810 * t56;
  t817 = t103 * t308;
  t819 = t5 * t817 * t56;
  t822 = t5 * t300 * t149;
  t828 = 0.1e1 / t108 / t96;
  t829 = t25 * t828;
  t832 = 0.5e1 / 0.36e2 * t5 * t829 * t56;
  t834 = t5 * t309 * t149;
  t837 = t5 * t110 * t384;
  t841 = t322 * rho[0];
  t843 = 0.1e1 / t323 / t841;
  t845 = t371 * sigma[0] * t843;
  t851 = 0.1e1 / t35 / t322;
  t853 = t33 * t34 * t851;
  t856 = pow(t39, 0.217063e0);
  t857 = 0.1e1 / t30;
  t858 = t856 * t857;
  t859 = t322 * t334;
  t860 = 0.1e1 / t859;
  t861 = t703 * t860;
  t864 = t321 * t843;
  t867 = t117 * t851;
  t870 = pow(t39, 0.223476e0);
  t871 = t870 * t857;
  t878 = 0.33490918346362866477e2 * t858 * t861 + 0.2407809090660673126e2 * t349 * t864 + 0.15083826181683913495e1 * t131 * t867 - 0.33974115567647124865e2 * t871 * t861 - 0.24297453420983520933e2 * t355 * t864 - 0.15177345329879582523e1 * t135 * t867;
  t880 = t140 * t140;
  t881 = 0.1e1 / t880;
  t882 = t50 * t881;
  t883 = pow(t39, 0.7421412e1);
  t884 = t883 * t703;
  t885 = t884 * t860;
  t888 = pow(t39, 0.3947608e1);
  t889 = t888 * t703;
  t890 = t889 * t860;
  t893 = pow(t39, 0.2253424e1);
  t894 = t893 * t125;
  t895 = t857 * t703;
  t896 = t895 * t860;
  t899 = pow(t39, 0.4880136e1);
  t900 = t899 * t341;
  t903 = pow(t39, -0.373288e0);
  t904 = t903 * t43;
  t907 = t368 * t888;
  t910 = -0.15466082284239081279e-1 * t363 * t381 - 0.4100566306677496425e-3 * t370 * t845 + 0.30608044975263820979e0 * t377 * t845 + 0.17184535871376756976e-1 * t144 * t853 + t878 * t54 + 0.23604827715716212363e-6 * t882 * t885 - 0.1174630647445706867e-3 * t368 * t890 + 0.26747661074691982766e-4 * t894 * t896 - 0.41222862591489958308e-8 * t900 * t896 - 0.13744113670501607936e-1 * t904 * t896 - 0.23186279615369182551e-2 * t907 * t896;
  t911 = pow(t39, 0.473804e0);
  t912 = t142 * t911;
  t917 = t360 * t141;
  t918 = t917 * t143;
  t921 = t138 * t367;
  t922 = t921 * t369;
  t925 = t362 * t376;
  t940 = pow(t39, 0.7506848e1);
  t941 = pow(t42, -0.3657946e1);
  t942 = t940 * t941;
  t945 = 0.51554581847684251902e0 * t912 * t896 + 0.14521907931245427372e-6 * t127 * t867 + 0.66283209789596062623e-2 * t918 * t146 + 0.1757385560004641325e-3 * t922 * t373 - 0.13117733560827351848e0 * t925 * t373 - 0.19189196092764949361e-1 * t318 * t864 + 0.71937145113441976578e-5 * t331 * t864 - 0.16383761378751320797e-2 * t116 * t867 - 0.61342126725561642654e-9 * t343 * t864 + 0.51733457620317460808e-6 * t894 * t861 - 0.48870643036920313633e-9 * t900 * t861 + 0.66808151565745085494e-13 * t942 * t861;
  t946 = t910 + t945;
  t951 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t806 * t56 - 0.3e1 / 0.8e1 * t812 - 0.9e1 / 0.8e1 * t5 * t296 * t149 + t819 / 0.4e1 - 0.3e1 / 0.4e1 * t822 - 0.9e1 / 0.8e1 * t5 * t104 * t384 - t832 + t834 / 0.4e1 - 0.3e1 / 0.8e1 * t837 - 0.3e1 / 0.8e1 * t5 * t27 * t946);
  t953 = 0.1e1 / t390 / t63;
  t954 = t392 * t156;
  t957 = t391 * t156;
  t961 = my_piecewise5(t14, 0, t10, 0, -t800);
  t965 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t953 * t954 + 0.4e1 / 0.3e1 * t957 * t396 + 0.4e1 / 0.3e1 * t65 * t961);
  t966 = t965 * t26;
  t970 = t400 * t109;
  t972 = t5 * t970 * t91;
  t974 = t159 * t308;
  t976 = t5 * t974 * t91;
  t978 = t67 * t828;
  t981 = 0.5e1 / 0.36e2 * t5 * t978 * t91;
  t983 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t966 * t91 - 0.3e1 / 0.8e1 * t972 + t976 / 0.4e1 - t981);
  tv3rho30 = 0.3e1 * t389 + 0.3e1 * t414 + t6 * (t951 + t983);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t986 = 0.2e1 * t440;
  t987 = 0.2e1 * t465;
  t988 = t789 * t173;
  t991 = t282 * t421;
  t996 = 0.2e1 * t287;
  t997 = 0.6e1 * t798;
  t998 = t996 - t997;
  t999 = my_piecewise5(t10, 0, t14, 0, t998);
  t1003 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t988 * t283 + 0.8e1 / 0.9e1 * t991 * t100 + 0.4e1 / 0.9e1 * t417 * t291 + 0.4e1 / 0.3e1 * t23 * t999);
  t1004 = t1003 * t26;
  t1008 = t425 * t109;
  t1011 = t5 * t1008 * t56 / 0.4e1;
  t1015 = t176 * t308;
  t1017 = t5 * t1015 * t56;
  t1021 = t5 * t430 * t149 / 0.4e1;
  t1030 = -0.3e1 / 0.8e1 * t5 * t1004 * t56 - t1011 - 0.3e1 / 0.4e1 * t5 * t426 * t149 + t1017 / 0.12e2 - t1021 - 0.3e1 / 0.8e1 * t5 * t177 * t384 - t812 / 0.8e1 + t819 / 0.6e1 - t822 / 0.4e1 - t832 + t834 / 0.6e1 - t837 / 0.8e1;
  t1031 = my_piecewise3(t1, 0, t1030);
  t1032 = t953 * t184;
  t1035 = t391 * t444;
  t1041 = my_piecewise5(t14, 0, t10, 0, -t998);
  t1045 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1032 * t392 + 0.8e1 / 0.9e1 * t1035 * t156 + 0.4e1 / 0.9e1 * t441 * t396 + 0.4e1 / 0.3e1 * t65 * t1041);
  t1046 = t1045 * t26;
  t1050 = t448 * t109;
  t1053 = t5 * t1050 * t91 / 0.4e1;
  t1054 = t187 * t308;
  t1056 = t5 * t1054 * t91;
  t1065 = t5 * t405 * t227 / 0.4e1;
  t1067 = t5 * t409 * t227;
  t1070 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1046 * t91 - t1053 + t1056 / 0.12e2 - t972 / 0.8e1 + t976 / 0.6e1 - t981 - 0.3e1 / 0.8e1 * t5 * t401 * t227 - t1065 + t1067 / 0.12e2);
  tv3rho31 = t389 + t414 + t986 + t987 + t6 * (t1031 + t1070);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1073 = t789 * t470;
  t1078 = t282 * t475;
  t1081 = -t996 - t997;
  t1082 = my_piecewise5(t10, 0, t14, 0, t1081);
  t1086 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1073 * t100 + 0.8e1 / 0.9e1 * t417 * t421 + 0.4e1 / 0.9e1 * t1078 * t100 + 0.4e1 / 0.3e1 * t23 * t1082);
  t1087 = t1086 * t26;
  t1091 = t479 * t109;
  t1093 = t5 * t1091 * t56;
  t1102 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1087 * t56 - t1093 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t480 * t149 - t1011 + t1017 / 0.6e1 - t1021 + t819 / 0.12e2 - t832 + t834 / 0.12e2);
  t1103 = t953 * t487;
  t1108 = t391 * t491;
  t1112 = my_piecewise5(t14, 0, t10, 0, -t1081);
  t1116 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t1103 * t156 + 0.8e1 / 0.9e1 * t441 * t444 + 0.4e1 / 0.9e1 * t1108 * t156 + 0.4e1 / 0.3e1 * t65 * t1112);
  t1117 = t1116 * t26;
  t1121 = t495 * t109;
  t1123 = t5 * t1121 * t91;
  t1130 = t5 * t453 * t227;
  t1138 = t5 * t164 * t570;
  t1140 = -0.3e1 / 0.8e1 * t5 * t1117 * t91 - t1123 / 0.8e1 - t1053 + t1056 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t449 * t227 - t1130 / 0.4e1 + t976 / 0.12e2 - t981 - t1065 + t1067 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t160 * t570 - t1138 / 0.8e1;
  t1141 = my_piecewise3(t61, 0, t1140);
  tv3rho32 = t986 + t987 + t486 + t575 + t6 * (t1102 + t1141);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1146 = t470 * t173;
  t1152 = -0.6e1 * t287 - 0.6e1 * t798;
  t1153 = my_piecewise5(t10, 0, t14, 0, t1152);
  t1157 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t789 * t1146 + 0.4e1 / 0.3e1 * t417 * t475 + 0.4e1 / 0.3e1 * t23 * t1153);
  t1158 = t1157 * t26;
  t1165 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1158 * t56 - 0.3e1 / 0.8e1 * t1093 + t1017 / 0.4e1 - t832);
  t1166 = t487 * t184;
  t1172 = my_piecewise5(t14, 0, t10, 0, -t1152);
  t1176 = my_piecewise3(t64, 0, -0.8e1 / 0.27e2 * t953 * t1166 + 0.4e1 / 0.3e1 * t441 * t491 + 0.4e1 / 0.3e1 * t65 * t1172);
  t1177 = t1176 * t26;
  t1192 = pow(t74, 0.3947608e1);
  t1193 = t555 * t1192;
  t1194 = t857 * t749;
  t1195 = t509 * t521;
  t1196 = 0.1e1 / t1195;
  t1197 = t1194 * t1196;
  t1200 = pow(t74, 0.473804e0);
  t1201 = t220 * t1200;
  t1204 = t1192 * t749;
  t1205 = t1204 * t1196;
  t1208 = t218 * t218;
  t1209 = 0.1e1 / t1208;
  t1210 = t85 * t1209;
  t1211 = pow(t74, 0.7421412e1);
  t1212 = t1211 * t749;
  t1213 = t1212 * t1196;
  t1216 = pow(t74, 0.4880136e1);
  t1217 = t1216 * t528;
  t1220 = pow(t74, -0.373288e0);
  t1221 = t1220 * t78;
  t1224 = pow(t74, 0.2253424e1);
  t1225 = t1224 * t203;
  t1228 = t549 * t562;
  t1232 = 0.1e1 / t70 / t509;
  t1233 = t195 * t1232;
  t1236 = t509 * rho[1];
  t1238 = 0.1e1 / t510 / t1236;
  t1239 = t508 * t1238;
  t1244 = -0.23186279615369182551e-2 * t1193 * t1197 + 0.51554581847684251902e0 * t1201 * t1197 - 0.1174630647445706867e-3 * t555 * t1205 + 0.23604827715716212363e-6 * t1210 * t1213 - 0.41222862591489958308e-8 * t1217 * t1197 - 0.13744113670501607936e-1 * t1221 * t1197 + 0.26747661074691982766e-4 * t1225 * t1197 - 0.13117733560827351848e0 * t1228 * t559 - 0.16383761378751320797e-2 * t194 * t1233 - 0.61342126725561642654e-9 * t530 * t1239 + 0.14521907931245427372e-6 * t205 * t1233;
  t1245 = t547 * t219;
  t1246 = t1245 * t221;
  t1249 = t216 * t554;
  t1250 = t1249 * t556;
  t1257 = pow(t74, 0.217063e0);
  t1258 = t1257 * t857;
  t1259 = t749 * t1196;
  t1266 = pow(t74, 0.223476e0);
  t1267 = t1266 * t857;
  t1274 = 0.33490918346362866477e2 * t1258 * t1259 + 0.2407809090660673126e2 * t536 * t1239 + 0.15083826181683913495e1 * t209 * t1233 - 0.33974115567647124865e2 * t1267 * t1259 - 0.24297453420983520933e2 * t542 * t1239 - 0.15177345329879582523e1 * t213 * t1233;
  t1280 = pow(t74, 0.7506848e1);
  t1281 = pow(t77, -0.3657946e1);
  t1282 = t1280 * t1281;
  t1286 = t371 * sigma[2] * t1238;
  t1292 = t33 * t69 * t1232;
  t1297 = 0.66283209789596062623e-2 * t1246 * t224 + 0.1757385560004641325e-3 * t1250 * t559 - 0.19189196092764949361e-1 * t507 * t1239 + 0.71937145113441976578e-5 * t518 * t1239 + t1274 * t89 + 0.51733457620317460808e-6 * t1225 * t1259 - 0.48870643036920313633e-9 * t1217 * t1259 + 0.66808151565745085494e-13 * t1282 * t1259 - 0.4100566306677496425e-3 * t557 * t1286 + 0.30608044975263820979e0 * t563 * t1286 + 0.17184535871376756976e-1 * t222 * t1292 - 0.15466082284239081279e-1 * t550 * t567;
  t1298 = t1244 + t1297;
  t1303 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1177 * t91 - 0.3e1 / 0.8e1 * t1123 - 0.9e1 / 0.8e1 * t5 * t496 * t227 + t1056 / 0.4e1 - 0.3e1 / 0.4e1 * t1130 - 0.9e1 / 0.8e1 * t5 * t188 * t570 - t981 + t1067 / 0.4e1 - 0.3e1 / 0.8e1 * t1138 - 0.3e1 / 0.8e1 * t5 * t68 * t1298);
  tv3rho33 = 0.3e1 * t486 + 0.3e1 * t575 + t6 * (t1165 + t1303);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1311 = t5 * t300 * t252;
  t1318 = t5 * t309 * t252 / 0.12e2;
  t1320 = t5 * t110 * t623;
  t1322 = t322 * t118;
  t1323 = 0.1e1 / t1322;
  t1324 = t1323 * t34;
  t1327 = t320 * t325;
  t1330 = t236 * t336;
  t1339 = -0.12559094379886074929e2 * t858 * t1324 - 0.64494886356982315875e1 * t349 * t1327 - 0.22625739272525870243e0 * t131 * t1330 + 0.12740293337867671824e2 * t871 * t1324 + 0.65082464520491573925e1 * t355 * t1327 + 0.22766017994819373784e0 * t135 * t1330;
  t1343 = t607 * t141;
  t1344 = t1343 * t143;
  t1348 = t33 * t235 * t336;
  t1355 = t246 * t367;
  t1356 = t1355 * t369;
  t1359 = t609 * t376;
  t1363 = t888 * t1323 * t34;
  t1367 = t883 * t1323 * t34;
  t1371 = t857 * t1323 * t34;
  t1378 = t1339 * t54 - 0.82854012236995078279e-3 * t918 * t249 + 0.44188806526397375082e-2 * t1344 * t146 - 0.25776803807065135466e-2 * t144 * t1348 - 0.51553607614130270929e-2 * t610 * t381 + 0.22094403263198687542e-2 * t363 * t620 + 0.58579518666821377499e-4 * t1356 * t373 - 0.43725778536091172827e-1 * t1359 * t373 + 0.44048649279214007511e-4 * t368 * t1363 - 0.8851810393393579636e-7 * t882 * t1367 - 0.10030372903009493538e-4 * t894 * t1371 + 0.15458573471808734365e-8 * t900 * t1371 + 0.51540426264381029761e-2 * t904 * t1371;
  t1379 = t371 * t325;
  t1408 = 0.5139963239133468579e-2 * t317 * t1379 - 0.19268878155386243727e-5 * t330 * t1379 + 0.16430926801489725711e-9 * t342 * t1379 - 0.43934639000116033124e-4 * t922 * t586 + 0.3279433390206837962e-1 * t925 * t586 + 0.86948548557634434565e-3 * t907 * t1371 - 0.19332968192881594463e0 * t912 * t1371 + 0.10983659750029008281e-3 * t370 * t1379 - 0.81985834755170949051e-1 * t377 * t1379 + 0.24575642068126981197e-3 * t116 * t1330 - 0.21782861896868141057e-7 * t127 * t1330 - 0.2505305683715440706e-13 * t942 * t1324 - 0.19400046607619047804e-6 * t894 * t1324 + 0.18326491138845117613e-9 * t900 * t1324;
  t1409 = t1378 + t1408;
  t1414 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t296 * t252 - t1311 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t104 * t623 + t1318 - t1320 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1409);
  tv3rho2sigma0 = t6 * t1414 + 0.2e1 * t628;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1421 = t5 * t405 * t274;
  t1425 = t5 * t409 * t274 / 0.12e2;
  t1427 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t401 * t274 - t1421 / 0.4e1 + t1425);
  tv3rho2sigma2 = t6 * t1427 + 0.2e1 * t637;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1433 = t5 * t430 * t252;
  t1441 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t426 * t252 - t1433 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t177 * t623 - t1311 / 0.8e1 + t1318 - t1320 / 0.8e1);
  tv3rho2sigma3 = t6 * t1441 + t628 + t643;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1447 = t5 * t453 * t274;
  t1454 = t5 * t164 * t687;
  t1457 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t449 * t274 - t1447 / 0.8e1 - t1421 / 0.8e1 + t1425 - 0.3e1 / 0.8e1 * t5 * t160 * t687 - t1454 / 0.8e1);
  tv3rho2sigma5 = t6 * t1457 + t637 + t692;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1465 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t480 * t252 - t1433 / 0.4e1 + t1318);
  tv3rho2sigma6 = t6 * t1465 + 0.2e1 * t643;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1476 = t509 * t196;
  t1477 = 0.1e1 / t1476;
  t1478 = t1477 * t69;
  t1481 = t320 * t512;
  t1484 = t258 * t523;
  t1493 = -0.12559094379886074929e2 * t1258 * t1478 - 0.64494886356982315875e1 * t536 * t1481 - 0.22625739272525870243e0 * t209 * t1484 + 0.12740293337867671824e2 * t1267 * t1478 + 0.65082464520491573925e1 * t542 * t1481 + 0.22766017994819373784e0 * t213 * t1484;
  t1495 = t671 * t219;
  t1496 = t1495 * t221;
  t1499 = t268 * t554;
  t1500 = t1499 * t556;
  t1503 = t673 * t562;
  t1509 = t33 * t257 * t523;
  t1517 = t1192 * t1477 * t69;
  t1521 = t1211 * t1477 * t69;
  t1525 = t857 * t1477 * t69;
  t1532 = t1493 * t89 + 0.44188806526397375082e-2 * t1496 * t224 + 0.58579518666821377499e-4 * t1500 * t559 - 0.43725778536091172827e-1 * t1503 * t559 - 0.82854012236995078279e-3 * t1246 * t271 - 0.25776803807065135466e-2 * t222 * t1509 - 0.51553607614130270929e-2 * t674 * t567 + 0.22094403263198687542e-2 * t550 * t684 + 0.44048649279214007511e-4 * t555 * t1517 - 0.8851810393393579636e-7 * t1210 * t1521 + 0.51540426264381029761e-2 * t1221 * t1525 - 0.10030372903009493538e-4 * t1225 * t1525 + 0.15458573471808734365e-8 * t1217 * t1525;
  t1533 = t371 * t512;
  t1562 = 0.5139963239133468579e-2 * t506 * t1533 - 0.19268878155386243727e-5 * t517 * t1533 + 0.16430926801489725711e-9 * t529 * t1533 - 0.2505305683715440706e-13 * t1282 * t1478 - 0.19400046607619047804e-6 * t1225 * t1478 + 0.18326491138845117613e-9 * t1217 * t1478 - 0.43934639000116033124e-4 * t1250 * t650 + 0.3279433390206837962e-1 * t1228 * t650 + 0.86948548557634434565e-3 * t1193 * t1525 - 0.19332968192881594463e0 * t1201 * t1525 + 0.10983659750029008281e-3 * t557 * t1533 - 0.81985834755170949051e-1 * t563 * t1533 + 0.24575642068126981197e-3 * t194 * t1484 - 0.21782861896868141057e-7 * t205 * t1484;
  t1563 = t1532 + t1562;
  t1568 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t496 * t274 - t1447 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t188 * t687 + t1425 - t1454 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t68 * t1563);
  tv3rho2sigma8 = t6 * t1568 + 0.2e1 * t692;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1575 = t5 * t110 * t735 / 0.8e1;
  t1576 = 0.1e1 / t841;
  t1577 = t235 * t1576;
  t1580 = t695 * t585;
  t1583 = t705 * t120;
  t1592 = 0.47096603924572780983e1 * t858 * t1577 + 0.64494886356982315875e0 * t349 * t1580 - 0.48483727012555436235e-1 * t131 * t1583 - 0.47776100017003769341e1 * t871 * t1577 - 0.65082464520491573924e0 * t355 * t1580 + 0.48784324274612943821e-1 * t135 * t1583;
  t1594 = t721 * t141;
  t1595 = t1594 * t143;
  t1607 = t371 * t694 * t585;
  t1613 = t33 * t704 * t120;
  t1618 = t883 * t235;
  t1619 = t1618 * t1576;
  t1622 = t888 * t235;
  t1623 = t1622 * t1576;
  t1626 = t857 * t235;
  t1627 = t1626 * t1576;
  t1630 = t1592 * t54 + 0.22094403263198687541e-2 * t1595 * t146 - 0.16570802447399015656e-2 * t1344 * t249 + 0.82377448125217562105e-5 * t922 * t726 - 0.61489376066378211788e-2 * t925 * t726 + 0.4142700611849753914e-3 * t363 * t732 - 0.1098365975002900828e-4 * t370 * t1607 + 0.81985834755170949048e-2 * t377 * t1607 - 0.55236008157996718853e-3 * t144 * t1613 + 0.22094403263198687541e-2 * t610 * t620 + 0.33194288975225923634e-7 * t882 * t1619 - 0.16518243479705252817e-4 * t368 * t1623 - 0.1932765984914288616e-2 * t904 * t1627;
  t1659 = 0.37613898386285600769e-5 * t894 * t1627 - 0.57969650519282753874e-9 * t900 * t1627 + 0.72750174778571429264e-7 * t894 * t1577 - 0.68724341770669191052e-10 * t900 * t1577 + 0.93948963139329026481e-14 * t942 * t1577 - 0.43934639000116033125e-4 * t1356 * t586 + 0.32794333902068379621e-1 * t1359 * t586 - 0.32605705709112912961e-3 * t907 * t1627 + 0.72498630723305979237e-1 * t912 * t1627 - 0.4667756120757458798e-8 * t127 * t1583 - 0.51399632391334685792e-3 * t318 * t1580 + 0.19268878155386243729e-6 * t331 * t1580 + 0.52662090145986388277e-4 * t116 * t1583 - 0.16430926801489725713e-10 * t343 * t1580;
  t1660 = t1630 + t1659;
  t1665 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t104 * t735 - t1575 - 0.3e1 / 0.8e1 * t5 * t27 * t1660);
  tv3rhosigma20 = t6 * t1665 + t739;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1672 = t5 * t164 * t781 / 0.8e1;
  t1674 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t160 * t781 - t1672);
  tv3rhosigma25 = t6 * t1674 + t785;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1680 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t177 * t735 - t1575);
  tv3rhosigma26 = t6 * t1680 + t739;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1685 = 0.1e1 / t1236;
  t1686 = t257 * t1685;
  t1689 = t741 * t649;
  t1692 = t751 * t198;
  t1701 = 0.47096603924572780983e1 * t1258 * t1686 + 0.64494886356982315875e0 * t536 * t1689 - 0.48483727012555436235e-1 * t209 * t1692 - 0.47776100017003769341e1 * t1267 * t1686 - 0.65082464520491573924e0 * t542 * t1689 + 0.48784324274612943821e-1 * t213 * t1692;
  t1711 = t767 * t219;
  t1712 = t1711 * t221;
  t1716 = t371 * t740 * t649;
  t1722 = t33 * t750 * t198;
  t1727 = t1211 * t257;
  t1728 = t1727 * t1685;
  t1731 = t1192 * t257;
  t1732 = t1731 * t1685;
  t1735 = t857 * t257;
  t1736 = t1735 * t1685;
  t1739 = t1701 * t89 - 0.16570802447399015656e-2 * t1496 * t271 + 0.82377448125217562105e-5 * t1250 * t772 - 0.61489376066378211788e-2 * t1228 * t772 + 0.4142700611849753914e-3 * t550 * t778 + 0.22094403263198687541e-2 * t1712 * t224 - 0.1098365975002900828e-4 * t557 * t1716 + 0.81985834755170949048e-2 * t563 * t1716 - 0.55236008157996718853e-3 * t222 * t1722 + 0.22094403263198687541e-2 * t674 * t684 + 0.33194288975225923634e-7 * t1210 * t1728 - 0.16518243479705252817e-4 * t555 * t1732 - 0.1932765984914288616e-2 * t1221 * t1736;
  t1768 = 0.37613898386285600769e-5 * t1225 * t1736 - 0.57969650519282753874e-9 * t1217 * t1736 + 0.72750174778571429264e-7 * t1225 * t1686 - 0.68724341770669191052e-10 * t1217 * t1686 + 0.93948963139329026481e-14 * t1282 * t1686 + 0.72498630723305979237e-1 * t1201 * t1736 - 0.43934639000116033125e-4 * t1500 * t650 + 0.32794333902068379621e-1 * t1503 * t650 - 0.32605705709112912961e-3 * t1193 * t1736 + 0.19268878155386243729e-6 * t518 * t1689 + 0.52662090145986388277e-4 * t194 * t1692 - 0.16430926801489725713e-10 * t530 * t1689 - 0.4667756120757458798e-8 * t205 * t1692 - 0.51399632391334685792e-3 * t507 * t1689;
  t1769 = t1739 + t1768;
  t1774 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t188 * t781 - t1672 - 0.3e1 / 0.8e1 * t5 * t68 * t1769);
  tv3rhosigma211 = t6 * t1774 + t785;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1776 = t857 * t704;
  t1777 = 0.1e1 / t322;
  t1778 = t1776 * t1777;
  t1783 = t883 * t704;
  t1784 = t1783 * t1777;
  t1787 = t888 * t704;
  t1788 = t1787 * t1777;
  t1797 = t704 * t1777;
  t1800 = sigma[0] * sigma[0];
  t1801 = 0.1e1 / t1800;
  t1802 = t320 * t1801;
  t1803 = t1802 * t697;
  t1807 = 0.1e1 / t34 / t1800;
  t1808 = t32 * t1807;
  t1809 = t1808 * t37;
  t1818 = -0.17661226471714792869e1 * t858 * t1797 + 0.72556747151605105359e0 * t349 * t1803 - 0.54544192889124865764e-1 * t131 * t1809 + 0.17916037506376413503e1 * t871 * t1797 - 0.73217772585553020667e0 * t355 * t1803 + 0.54882364808939561799e-1 * t135 * t1809;
  t1826 = -0.27186986521239742214e-1 * t912 * t1778 + 0.1222713964091734236e-3 * t907 * t1778 - 0.12447858365709721362e-7 * t882 * t1784 + 0.61943413048894698061e-5 * t368 * t1788 + 0.21738618944731032703e-9 * t900 * t1778 + 0.72478724434285823101e-3 * t904 * t1778 - 0.14105211894857100288e-5 * t894 * t1778 + t1818 * t54 - 0.27281315541964285976e-7 * t894 * t1797 + 0.25771628164000946647e-10 * t900 * t1797 - 0.35230861177248384934e-14 * t942 * t1797;
  t1846 = t371 * t1801 * t697;
  t1852 = t33 * t1807 * t37;
  t1855 = -0.52512256358521411478e-8 * t127 * t1809 - 0.24856203671098523484e-2 * t1595 * t249 + 0.24713234437565268632e-4 * t1356 * t726 - 0.18446812819913463537e-1 * t1359 * t726 - 0.57824586440251521513e-3 * t318 * t1803 + 0.21677487924809524194e-6 * t331 * t1803 + 0.59244851414234686812e-4 * t116 * t1809 - 0.18484792651675941426e-10 * t343 * t1803 + 0.12428101835549261742e-2 * t610 * t732 - 0.12356617218782634316e-4 * t370 * t1846 + 0.92234064099567317682e-2 * t377 * t1846 - 0.6214050917774630871e-3 * t144 * t1852;
  t1856 = t1826 + t1855;
  t1860 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1856);
  tv3sigma30 = t6 * t1860;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1861 = t1192 * t750;
  t1862 = 0.1e1 / t509;
  t1863 = t1861 * t1862;
  t1866 = t1211 * t750;
  t1867 = t1866 * t1862;
  t1874 = sigma[2] * sigma[2];
  t1875 = 0.1e1 / t1874;
  t1876 = t320 * t1875;
  t1877 = t1876 * t743;
  t1881 = 0.1e1 / t69 / t1874;
  t1882 = t32 * t1881;
  t1883 = t1882 * t72;
  t1895 = t371 * t1875 * t743;
  t1898 = 0.61943413048894698061e-5 * t555 * t1863 - 0.12447858365709721362e-7 * t1210 * t1867 + 0.24713234437565268632e-4 * t1500 * t772 - 0.18446812819913463537e-1 * t1503 * t772 + 0.21677487924809524194e-6 * t518 * t1877 + 0.59244851414234686812e-4 * t194 * t1883 - 0.18484792651675941426e-10 * t530 * t1877 - 0.52512256358521411478e-8 * t205 * t1883 - 0.24856203671098523484e-2 * t1712 * t271 + 0.12428101835549261742e-2 * t674 * t778 - 0.12356617218782634316e-4 * t557 * t1895;
  t1902 = t33 * t1881 * t72;
  t1905 = t750 * t1862;
  t1918 = -0.17661226471714792869e1 * t1258 * t1905 + 0.72556747151605105359e0 * t536 * t1877 - 0.54544192889124865764e-1 * t209 * t1883 + 0.17916037506376413503e1 * t1267 * t1905 - 0.73217772585553020667e0 * t542 * t1877 + 0.54882364808939561799e-1 * t213 * t1883;
  t1920 = t857 * t750;
  t1921 = t1920 * t1862;
  t1940 = 0.92234064099567317682e-2 * t563 * t1895 - 0.6214050917774630871e-3 * t222 * t1902 + t1918 * t89 - 0.27186986521239742214e-1 * t1201 * t1921 + 0.1222713964091734236e-3 * t1193 * t1921 + 0.21738618944731032703e-9 * t1217 * t1921 + 0.72478724434285823101e-3 * t1221 * t1921 - 0.14105211894857100288e-5 * t1225 * t1921 - 0.27281315541964285976e-7 * t1225 * t1905 + 0.25771628164000946647e-10 * t1217 * t1905 - 0.35230861177248384934e-14 * t1282 * t1905 - 0.57824586440251521513e-3 * t507 * t1877;
  t1941 = t1898 + t1940;
  t1945 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * t1941);
  tv3sigma39 = t6 * t1945;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1949 = 0.1e1 / t323 / t1322;
  t1951 = t371 * sigma[0] * t1949;
  t1957 = 0.1e1 / t35 / t841;
  t1965 = t360 * t367 * t369;
  t1968 = t917 * t376;
  t1972 = t878 * t141 * t143;
  t1978 = pow(t39, 0.9895216e1);
  t1979 = t50 / t880 / t53 * t1978;
  t1980 = t322 * t322;
  t1983 = 0.1e1 / t35 / t1980 / rho[0];
  t1985 = t1800 * t1983 * t33;
  t1988 = pow(t39, 0.6421412e1);
  t1989 = t882 * t1988;
  t1992 = pow(t39, 0.2947608e1);
  t1993 = t368 * t1992;
  t1997 = pow(t39, 0.1253424e1);
  t1998 = t1997 * t125;
  t1999 = t1998 * t857;
  t2002 = pow(t39, 0.3880136e1);
  t2003 = t2002 * t341;
  t2004 = t2003 * t857;
  t2007 = pow(t39, -0.1373288e1);
  t2009 = t2007 * t43 * t857;
  t2019 = t368 * t1992 * t857;
  t2022 = pow(t39, -0.526196e0);
  t2024 = t142 * t2022 * t857;
  t2027 = 0.1e1 / t1980;
  t2028 = t703 * t2027;
  t2035 = -0.80365095212768942096e-4 * t1999 * t1985 + 0.26823090100771125224e-7 * t2004 * t1985 - 0.68406836051122722976e-2 * t2009 * t1985 - 0.30932164568478162558e-1 * t918 * t381 - 0.164022652267099857e-2 * t922 * t845 + 0.12243217990105528392e1 * t925 * t845 + 0.12204045719982441065e-1 * t2019 * t1985 - 0.32569022797013585718e0 * t2024 * t1985 - 0.93531412192043119691e-12 * t942 * t2028 - 0.72426840668444445132e-5 * t894 * t2028 + 0.68418900251688439086e-8 * t900 * t2028;
  t2037 = t362 * t911;
  t2040 = t321 * t1949;
  t2047 = t1983 * t29 * t32;
  t2050 = t895 * t2027;
  t2055 = t138 * t881;
  t2073 = pow(t39, 0.913356e1);
  t2074 = pow(t42, -0.4657946e1);
  t2075 = t2073 * t2074;
  t2079 = pow(t39, 0.6506848e1);
  t2080 = t2079 * t941;
  t2087 = t921 * t888;
  t2090 = pow(t39, -0.782937e0);
  t2091 = t2090 * t857;
  t2099 = t117 * t1957;
  t2102 = pow(t39, -0.776524e0);
  t2103 = t2102 * t857;
  t2121 = 0.1924175913870225111e0 * t904 * t2050 - 0.37446725504568775873e-3 * t894 * t2050 + 0.57712007628085941631e-7 * t900 * t2050 + 0.11530224269375980259e-15 * t2075 * t1800 * t2047 - 0.18053450996815247162e-11 * t2080 * t1800 * t2047 - 0.1986658582623342004e-5 * t1998 * t1800 * t2047 - 0.92745118461476730205e-2 * t2087 * t896 + (-0.96928522786887505147e1 * t2091 * t1800 * t2047 - 0.46887285684908013068e3 * t858 * t2028 - 0.16319594947811228965e3 * t349 * t2040 - 0.65363246787296958478e1 * t131 * t2099 + 0.10123199267460678502e2 * t2103 * t1800 * t2047 + 0.47563761794705974812e3 * t871 * t2028 + 0.16468273985333275299e3 * t355 * t2040 + 0.65768496429478190933e1 * t135 * t2099) * t54 + 0.13006010685096243456e0 * t318 * t2040 + 0.7099629930792239012e-2 * t116 * t2099 - 0.62928267702063518612e-6 * t127 * t2099;
  t2128 = t5 * t110 * t946;
  t2131 = t5 * t829 * t149;
  t2134 = t5 * t309 * t384;
  t2137 = 0.1e1 / t108 / t286;
  t2141 = 0.1e2 / 0.27e2 * t5 * t25 * t2137 * t56;
  t2146 = t5 * t300 * t384;
  t2149 = t5 * t817 * t149;
  t2153 = t19 * t19;
  t2155 = 0.1e1 / t281 / t2153;
  t2156 = t283 * t283;
  t2162 = t291 * t291;
  t2169 = t16 / t796 / t6;
  t2171 = -0.24e2 * t797 + 0.24e2 * t2169;
  t2172 = my_piecewise5(t10, 0, t14, 0, t2171);
  t2176 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2155 * t2156 - 0.16e2 / 0.9e1 * t789 * t283 * t291 + 0.4e1 / 0.3e1 * t282 * t2162 + 0.16e2 / 0.9e1 * t793 * t801 + 0.4e1 / 0.3e1 * t23 * t2172);
  t2185 = t5 * t810 * t149;
  t2189 = t5 * t103 * t828 * t56;
  t2193 = t5 * t805 * t109 * t56;
  t2197 = t5 * t295 * t308 * t56;
  t2199 = -0.3e1 / 0.8e1 * t5 * t27 * (0.27792727189703031325e-2 * t370 * t1951 - 0.20745452705456589774e1 * t377 * t1951 - 0.74466322109299280229e-1 * t144 * t33 * t34 * t1957 + 0.68738143485507027906e-1 * t363 * t853 + 0.351477112000928265e-3 * t1965 * t373 - 0.26235467121654703696e0 * t1968 * t373 + 0.88377613052794750164e-2 * t1972 * t146 + 0.2086138330037452416e-8 * t1979 * t1985 - 0.46714973777959703206e-5 * t1989 * t1985 + 0.84908755835065660761e-3 * t1993 * t1985 + t2035 + 0.2062183273907370076e1 * t2037 * t896 - 0.4875739835466622857e-4 * t331 * t2040 + 0.41576330336214002244e-8 * t343 * t2040 + 0.57045785072932893532e-8 * t2003 * t1800 * t2047 - 0.72176414586757952662e1 * t912 * t2050 + 0.32460791461516855572e-1 * t907 * t2050 + 0.94419310862864849453e-6 * t2055 * t885 - 0.46985225897828274679e-3 * t921 * t890 - 0.33046758802002697308e-5 * t882 * t884 * t2027 + 0.16444829064239896138e-2 * t368 * t889 * t2027 + t2121) - t2128 / 0.2e1 - 0.5e1 / 0.9e1 * t2131 + t2134 / 0.2e1 + t2141 - 0.3e1 / 0.2e1 * t5 * t104 * t946 - 0.3e1 / 0.2e1 * t2146 + t2149 - 0.9e1 / 0.4e1 * t5 * t296 * t384 - 0.3e1 / 0.8e1 * t5 * t2176 * t26 * t56 - 0.3e1 / 0.2e1 * t5 * t806 * t149 - 0.3e1 / 0.2e1 * t2185 - 0.5e1 / 0.9e1 * t2189 - t2193 / 0.2e1 + t2197 / 0.2e1;
  t2200 = my_piecewise3(t1, 0, t2199);
  t2201 = t63 * t63;
  t2203 = 0.1e1 / t390 / t2201;
  t2204 = t392 * t392;
  t2210 = t396 * t396;
  t2216 = my_piecewise5(t14, 0, t10, 0, -t2171);
  t2220 = my_piecewise3(t64, 0, 0.4e2 / 0.81e2 * t2203 * t2204 - 0.16e2 / 0.9e1 * t953 * t392 * t396 + 0.4e1 / 0.3e1 * t391 * t2210 + 0.16e2 / 0.9e1 * t957 * t961 + 0.4e1 / 0.3e1 * t65 * t2216);
  t2227 = t5 * t965 * t109 * t91;
  t2231 = t5 * t400 * t308 * t91;
  t2235 = t5 * t159 * t828 * t91;
  t2240 = 0.1e2 / 0.27e2 * t5 * t67 * t2137 * t91;
  t2242 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t2220 * t26 * t91 - t2227 / 0.2e1 + t2231 / 0.2e1 - 0.5e1 / 0.9e1 * t2235 + t2240);
  tv4rho40 = 0.4e1 * t951 + 0.4e1 * t983 + t6 * (t2200 + t2242);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2251 = t5 * t1015 * t149;
  t2252 = t2251 / 0.4e1;
  t2254 = t5 * t430 * t384;
  t2257 = t5 * t1008 * t149;
  t2278 = 0.12e2 * t797;
  t2279 = 0.24e2 * t2169;
  t2280 = -t2278 + t2279;
  t2281 = my_piecewise5(t10, 0, t14, 0, t2280);
  t2285 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2155 * t173 * t790 - 0.8e1 / 0.9e1 * t789 * t421 * t283 - 0.8e1 / 0.9e1 * t988 * t100 * t291 + 0.4e1 / 0.3e1 * t282 * t999 * t100 + 0.4e1 / 0.3e1 * t991 * t291 + 0.4e1 / 0.9e1 * t417 * t801 + 0.4e1 / 0.3e1 * t23 * t2281);
  t2295 = t5 * t176 * t828 * t56;
  t2299 = t5 * t425 * t308 * t56;
  t2300 = t2299 / 0.4e1;
  t2303 = t5 * t1003 * t109 * t56;
  t2314 = -0.3e1 / 0.8e1 * t5 * t177 * t946 + t2252 - 0.3e1 / 0.8e1 * t2254 - 0.3e1 / 0.4e1 * t2257 - 0.9e1 / 0.8e1 * t5 * t426 * t384 - 0.3e1 / 0.8e1 * t5 * t2285 * t26 * t56 - 0.9e1 / 0.8e1 * t5 * t1004 * t149 - 0.5e1 / 0.36e2 * t2295 + t2300 - 0.3e1 / 0.8e1 * t2303 - t2128 / 0.8e1 - 0.5e1 / 0.12e2 * t2131 + t2134 / 0.4e1 + t2141 - 0.3e1 / 0.8e1 * t2146 + t2149 / 0.2e1 - 0.3e1 / 0.8e1 * t2185 - 0.5e1 / 0.12e2 * t2189 - t2193 / 0.8e1 + t2197 / 0.4e1;
  t2315 = my_piecewise3(t1, 0, t2314);
  t2333 = my_piecewise5(t14, 0, t10, 0, -t2280);
  t2337 = my_piecewise3(t64, 0, 0.4e2 / 0.81e2 * t2203 * t184 * t954 - 0.8e1 / 0.9e1 * t953 * t444 * t392 - 0.8e1 / 0.9e1 * t1032 * t156 * t396 + 0.4e1 / 0.3e1 * t391 * t1041 * t156 + 0.4e1 / 0.3e1 * t1035 * t396 + 0.4e1 / 0.9e1 * t441 * t961 + 0.4e1 / 0.3e1 * t65 * t2333);
  t2344 = t5 * t1045 * t109 * t91;
  t2348 = t5 * t448 * t308 * t91;
  t2349 = t2348 / 0.4e1;
  t2352 = t5 * t187 * t828 * t91;
  t2361 = t5 * t970 * t227;
  t2364 = t5 * t974 * t227;
  t2365 = t2364 / 0.4e1;
  t2367 = t5 * t978 * t227;
  t2369 = -0.3e1 / 0.8e1 * t5 * t2337 * t26 * t91 - 0.3e1 / 0.8e1 * t2344 + t2349 - 0.5e1 / 0.36e2 * t2352 - t2227 / 0.8e1 + t2231 / 0.4e1 - 0.5e1 / 0.12e2 * t2235 + t2240 - 0.3e1 / 0.8e1 * t5 * t966 * t227 - 0.3e1 / 0.8e1 * t2361 + t2365 - 0.5e1 / 0.36e2 * t2367;
  t2370 = my_piecewise3(t61, 0, t2369);
  tv4rho41 = t951 + t983 + 0.3e1 * t1031 + 0.3e1 * t1070 + t6 * (t2315 + t2370);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2379 = t5 * t1086 * t109 * t56;
  t2383 = t5 * t479 * t308 * t56;
  t2386 = t5 * t1091 * t149;
  t2399 = t421 * t421;
  t2412 = my_piecewise5(t10, 0, t14, 0, t2279);
  t2416 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2155 * t470 * t283 - 0.32e2 / 0.27e2 * t988 * t100 * t421 - 0.8e1 / 0.27e2 * t1073 * t291 + 0.8e1 / 0.9e1 * t282 * t2399 + 0.8e1 / 0.9e1 * t417 * t999 - 0.8e1 / 0.27e2 * t789 * t475 * t283 + 0.8e1 / 0.9e1 * t282 * t1082 * t100 + 0.4e1 / 0.9e1 * t1078 * t291 + 0.4e1 / 0.3e1 * t23 * t2412);
  t2435 = -t2379 / 0.4e1 + t2383 / 0.12e2 - t2386 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t480 * t384 - 0.3e1 / 0.8e1 * t5 * t2416 * t26 * t56 - 0.3e1 / 0.4e1 * t5 * t1087 * t149 + t2251 / 0.3e1 - t2254 / 0.4e1 - t2257 / 0.2e1 - 0.5e1 / 0.18e2 * t2295 + t2299 / 0.3e1 - t2303 / 0.4e1 - 0.5e1 / 0.18e2 * t2131 + t2134 / 0.12e2 + t2141 + t2149 / 0.6e1 - 0.5e1 / 0.18e2 * t2189 + t2197 / 0.12e2;
  t2436 = my_piecewise3(t1, 0, t2435);
  t2445 = t444 * t444;
  t2458 = my_piecewise5(t14, 0, t10, 0, -t2279);
  t2462 = my_piecewise3(t64, 0, 0.4e2 / 0.81e2 * t2203 * t487 * t392 - 0.32e2 / 0.27e2 * t1032 * t156 * t444 - 0.8e1 / 0.27e2 * t1103 * t396 + 0.8e1 / 0.9e1 * t391 * t2445 + 0.8e1 / 0.9e1 * t441 * t1041 - 0.8e1 / 0.27e2 * t953 * t491 * t392 + 0.8e1 / 0.9e1 * t391 * t1112 * t156 + 0.4e1 / 0.9e1 * t1108 * t396 + 0.4e1 / 0.3e1 * t65 * t2458);
  t2469 = t5 * t1116 * t109 * t91;
  t2473 = t5 * t495 * t308 * t91;
  t2482 = t5 * t1050 * t227;
  t2485 = t5 * t1054 * t227;
  t2496 = t5 * t405 * t570;
  t2499 = t5 * t409 * t570;
  t2501 = -0.3e1 / 0.8e1 * t5 * t2462 * t26 * t91 - t2469 / 0.4e1 + t2473 / 0.12e2 - t2344 / 0.4e1 + t2348 / 0.3e1 - 0.5e1 / 0.18e2 * t2352 - 0.3e1 / 0.4e1 * t5 * t1046 * t227 - t2482 / 0.2e1 + t2485 / 0.6e1 + t2231 / 0.12e2 - 0.5e1 / 0.18e2 * t2235 + t2240 - t2361 / 0.4e1 + t2364 / 0.3e1 - 0.5e1 / 0.18e2 * t2367 - 0.3e1 / 0.8e1 * t5 * t401 * t570 - t2496 / 0.4e1 + t2499 / 0.12e2;
  t2502 = my_piecewise3(t61, 0, t2501);
  tv4rho42 = 0.2e1 * t1031 + 0.2e1 * t1070 + 0.2e1 * t1102 + 0.2e1 * t1141 + t6 * (t2436 + t2502);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2522 = t2278 + t2279;
  t2523 = my_piecewise5(t10, 0, t14, 0, t2522);
  t2527 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2155 * t1146 * t100 - 0.8e1 / 0.9e1 * t1073 * t421 - 0.8e1 / 0.9e1 * t988 * t475 * t100 + 0.4e1 / 0.3e1 * t991 * t475 + 0.4e1 / 0.3e1 * t417 * t1082 + 0.4e1 / 0.9e1 * t282 * t1153 * t100 + 0.4e1 / 0.3e1 * t23 * t2523);
  t2534 = t5 * t1157 * t109 * t56;
  t2545 = -0.3e1 / 0.8e1 * t5 * t2527 * t26 * t56 - t2534 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1158 * t149 - 0.3e1 / 0.8e1 * t2379 + t2383 / 0.4e1 - 0.3e1 / 0.8e1 * t2386 + t2300 - 0.5e1 / 0.12e2 * t2295 + t2252 - 0.5e1 / 0.36e2 * t2189 + t2141 - 0.5e1 / 0.36e2 * t2131;
  t2546 = my_piecewise3(t1, 0, t2545);
  t2563 = my_piecewise5(t14, 0, t10, 0, -t2522);
  t2567 = my_piecewise3(t64, 0, 0.4e2 / 0.81e2 * t2203 * t1166 * t156 - 0.8e1 / 0.9e1 * t1103 * t444 - 0.8e1 / 0.9e1 * t1032 * t491 * t156 + 0.4e1 / 0.3e1 * t1035 * t491 + 0.4e1 / 0.3e1 * t441 * t1112 + 0.4e1 / 0.9e1 * t391 * t1172 * t156 + 0.4e1 / 0.3e1 * t65 * t2563);
  t2574 = t5 * t1176 * t109 * t91;
  t2582 = t5 * t1121 * t227;
  t2591 = t5 * t453 * t570;
  t2601 = t5 * t164 * t1298;
  t2603 = -0.3e1 / 0.8e1 * t5 * t2567 * t26 * t91 - t2574 / 0.8e1 - 0.3e1 / 0.8e1 * t2469 + t2473 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1117 * t227 - 0.3e1 / 0.8e1 * t2582 + t2349 - 0.5e1 / 0.12e2 * t2352 - 0.3e1 / 0.4e1 * t2482 + t2485 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t449 * t570 - 0.3e1 / 0.8e1 * t2591 - 0.5e1 / 0.36e2 * t2235 + t2240 + t2365 - 0.5e1 / 0.12e2 * t2367 - 0.3e1 / 0.8e1 * t2496 + t2499 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t160 * t1298 - t2601 / 0.8e1;
  t2604 = my_piecewise3(t61, 0, t2603);
  tv4rho43 = 0.3e1 * t1102 + 0.3e1 * t1141 + t1165 + t1303 + t6 * (t2546 + t2604);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2609 = t470 * t470;
  t2614 = t475 * t475;
  t2620 = 0.24e2 * t797 + 0.24e2 * t2169;
  t2621 = my_piecewise5(t10, 0, t14, 0, t2620);
  t2625 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2155 * t2609 - 0.16e2 / 0.9e1 * t1073 * t475 + 0.4e1 / 0.3e1 * t282 * t2614 + 0.16e2 / 0.9e1 * t417 * t1153 + 0.4e1 / 0.3e1 * t23 * t2621);
  t2634 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2625 * t26 * t56 - t2534 / 0.2e1 + t2383 / 0.2e1 - 0.5e1 / 0.9e1 * t2295 + t2141);
  t2635 = pow(t74, 0.2947608e1);
  t2637 = t555 * t2635 * t857;
  t2638 = t509 * t509;
  t2641 = 0.1e1 / t70 / t2638 / rho[1];
  t2643 = t1874 * t2641 * t33;
  t2646 = pow(t74, -0.526196e0);
  t2648 = t220 * t2646 * t857;
  t2651 = 0.1e1 / t2638;
  t2652 = t749 * t2651;
  t2660 = 0.1e1 / t70 / t1236;
  t2661 = t195 * t2660;
  t2665 = 0.1e1 / t510 / t1476;
  t2666 = t508 * t2665;
  t2671 = t1194 * t2651;
  t2677 = pow(t74, 0.913356e1);
  t2678 = pow(t77, -0.4657946e1);
  t2679 = t2677 * t2678;
  t2682 = t2641 * t29 * t32;
  t2689 = pow(t74, 0.6506848e1);
  t2690 = t2689 * t1281;
  t2694 = pow(t74, 0.1253424e1);
  t2695 = t2694 * t203;
  t2699 = pow(t74, 0.3880136e1);
  t2700 = t2699 * t528;
  t2704 = t1249 * t1192;
  t2707 = t549 * t1200;
  t2710 = pow(t74, -0.782937e0);
  t2711 = t2710 * t857;
  t2721 = pow(t74, -0.776524e0);
  t2722 = t2721 * t857;
  t2736 = t216 * t1209;
  t2739 = 0.11530224269375980259e-15 * t2679 * t1874 * t2682 + 0.13006010685096243456e0 * t507 * t2666 - 0.4875739835466622857e-4 * t518 * t2666 - 0.18053450996815247162e-11 * t2690 * t1874 * t2682 - 0.1986658582623342004e-5 * t2695 * t1874 * t2682 + 0.57045785072932893532e-8 * t2700 * t1874 * t2682 - 0.92745118461476730205e-2 * t2704 * t1197 + 0.2062183273907370076e1 * t2707 * t1197 + (-0.96928522786887505147e1 * t2711 * t1874 * t2682 - 0.46887285684908013068e3 * t1258 * t2652 - 0.16319594947811228965e3 * t536 * t2666 - 0.65363246787296958478e1 * t209 * t2661 + 0.10123199267460678502e2 * t2722 * t1874 * t2682 + 0.47563761794705974812e3 * t1267 * t2652 + 0.16468273985333275299e3 * t542 * t2666 + 0.65768496429478190933e1 * t213 * t2661) * t89 - 0.46985225897828274679e-3 * t1249 * t1205 + 0.94419310862864849453e-6 * t2736 * t1213;
  t2758 = t1274 * t219 * t221;
  t2762 = t547 * t554 * t556;
  t2765 = t555 * t2635;
  t2772 = pow(t74, 0.9895216e1);
  t2773 = t85 / t1208 / t88 * t2772;
  t2776 = t2700 * t857;
  t2779 = pow(t74, -0.1373288e1);
  t2781 = t2779 * t78 * t857;
  t2784 = t2695 * t857;
  t2787 = t1245 * t562;
  t2790 = pow(t74, 0.6421412e1);
  t2791 = t1210 * t2790;
  t2797 = t371 * sigma[2] * t2665;
  t2808 = 0.2086138330037452416e-8 * t2773 * t2643 + 0.26823090100771125224e-7 * t2776 * t2643 - 0.68406836051122722976e-2 * t2781 * t2643 - 0.80365095212768942096e-4 * t2784 * t2643 - 0.26235467121654703696e0 * t2787 * t559 - 0.46714973777959703206e-5 * t2791 * t2643 + 0.12243217990105528392e1 * t1228 * t1286 + 0.27792727189703031325e-2 * t557 * t2797 - 0.20745452705456589774e1 * t563 * t2797 - 0.74466322109299280229e-1 * t222 * t33 * t69 * t2660 - 0.30932164568478162558e-1 * t1246 * t567;
  t2820 = t487 * t487;
  t2825 = t491 * t491;
  t2831 = my_piecewise5(t14, 0, t10, 0, -t2620);
  t2835 = my_piecewise3(t64, 0, 0.4e2 / 0.81e2 * t2203 * t2820 - 0.16e2 / 0.9e1 * t1103 * t491 + 0.4e1 / 0.3e1 * t391 * t2825 + 0.16e2 / 0.9e1 * t441 * t1172 + 0.4e1 / 0.3e1 * t65 * t2831);
  t2851 = -0.3e1 / 0.8e1 * t5 * t68 * (0.12204045719982441065e-1 * t2637 * t2643 - 0.32569022797013585718e0 * t2648 * t2643 + 0.68418900251688439086e-8 * t1217 * t2652 - 0.93531412192043119691e-12 * t1282 * t2652 - 0.72426840668444445132e-5 * t1225 * t2652 + 0.7099629930792239012e-2 * t194 * t2661 + 0.41576330336214002244e-8 * t530 * t2666 - 0.62928267702063518612e-6 * t205 * t2661 - 0.72176414586757952662e1 * t1201 * t2671 + 0.32460791461516855572e-1 * t1193 * t2671 + t2739 - 0.33046758802002697308e-5 * t1210 * t1212 * t2651 + 0.57712007628085941631e-7 * t1217 * t2671 + 0.1924175913870225111e0 * t1221 * t2671 - 0.37446725504568775873e-3 * t1225 * t2671 + 0.16444829064239896138e-2 * t555 * t1204 * t2651 - 0.164022652267099857e-2 * t1250 * t1286 + 0.68738143485507027906e-1 * t550 * t1292 + 0.88377613052794750164e-2 * t2758 * t224 + 0.351477112000928265e-3 * t2762 * t559 + 0.84908755835065660761e-3 * t2765 * t2643 + t2808) - 0.3e1 / 0.2e1 * t5 * t188 * t1298 - 0.9e1 / 0.4e1 * t5 * t496 * t570 - 0.3e1 / 0.8e1 * t5 * t2835 * t26 * t91 - 0.3e1 / 0.2e1 * t5 * t1177 * t227 - t2574 / 0.2e1 - 0.3e1 / 0.2e1 * t2582 - 0.3e1 / 0.2e1 * t2591 - t2601 / 0.2e1 + t2473 / 0.2e1 + t2485 + t2499 / 0.2e1 - 0.5e1 / 0.9e1 * t2367 - 0.5e1 / 0.9e1 * t2352 + t2240;
  t2852 = my_piecewise3(t61, 0, t2851);
  tv4rho44 = 0.4e1 * t1165 + 0.4e1 * t1303 + t6 * (t2634 + t2852);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t2860 = t5 * t810 * t252;
  t2866 = t5 * t817 * t252;
  t2869 = t5 * t300 * t623;
  t2876 = 0.5e1 / 0.36e2 * t5 * t829 * t252;
  t2878 = t5 * t309 * t623;
  t2881 = t5 * t110 * t1409;
  t2884 = 0.1e1 / t35 / t1980;
  t2886 = t2884 * sigma[0] * t33;
  t2891 = t860 * t34;
  t2906 = sigma[0] * t29 * t32;
  t2919 = -0.45765171449934153995e-2 * t2019 * t2886 + 0.12213383548880094644e0 * t2024 * t2886 + 0.21340051268380952584e-5 * t894 * t2891 - 0.20159140252729629374e-8 * t900 * t2891 + 0.27558362520869847766e-12 * t942 * t2891 + 0.2608456456729033037e-2 * t2087 * t1371 + 0.4919150085310256943e-1 * t1968 * t586 - 0.57998904578644783389e0 * t2037 * t1371 + 0.74499696848375325154e-6 * t1998 * t2884 * t2906 - 0.65901958500174049686e-4 * t1965 * t586 - 0.21392169402349835075e-8 * t2003 * t2884 * t2906 + 0.67700441238057176857e-12 * t2080 * t2884 * t2906 - 0.15466082284239081279e-1 * t1344 * t381;
  t2935 = t607 * t367 * t369;
  t2938 = t1343 * t376;
  t2951 = 0.85922679356883784887e-2 * t144 * t33 * t235 * t851 + 0.17184535871376756976e-1 * t610 * t853 - 0.4100566306677496425e-3 * t1356 * t845 + 0.30608044975263820979e0 * t1359 * t845 + 0.33141604894798031313e-2 * t918 * t620 - 0.77330411421195406397e-2 * t363 * t1348 + 0.1757385560004641325e-3 * t2935 * t373 - 0.13117733560827351848e0 * t2938 * t373 - 0.82854012236995078279e-3 * t1972 * t249 + 0.17518115166734888702e-5 * t1989 * t2886 - 0.31840783438149622784e-3 * t1993 * t2886 - 0.78230187376404465597e-9 * t1979 * t2886 + 0.30136910704788353288e-4 * t1999 * t2886;
  t2958 = t1339 * t141 * t143;
  t2961 = t609 * t911;
  t2964 = t371 * t843;
  t2969 = t236 * t851;
  t2979 = t857 * t860 * t34;
  t2987 = -0.10058658787789171959e-7 * t2004 * t2886 + 0.25652563519171021116e-2 * t2009 * t2886 + 0.66283209789596062623e-2 * t2958 * t146 + 0.51554581847684251902e0 * t2961 * t896 - 0.58091356011264532686e-3 * t370 * t2964 + 0.43361397048290413054e0 * t377 * t2964 - 0.8191880689375660399e-3 * t116 * t2969 + 0.72609539656227136857e-7 * t127 * t2969 + 0.32950979250087024843e-3 * t922 * t1379 - 0.24595750426551284715e0 * t925 * t1379 - 0.95643403413397878022e-2 * t907 * t2979 + 0.2126626501216975391e1 * t912 * t2979 - 0.43238341010159925972e-16 * t2075 * t2884 * t2906;
  t2988 = t1355 * t888;
  t2996 = t320 * t843;
  t3036 = t246 * t881;
  t3041 = -0.23186279615369182551e-2 * t2988 * t896 + (0.3634819604508281443e1 * t2091 * t2884 * t2906 + 0.13815003817874682422e3 * t858 * t2891 + 0.34110628784359535952e2 * t349 * t2996 + 0.75419130908419567477e0 * t131 * t2969 - 0.37961997252977544381e1 * t2103 * t2884 * t2906 - 0.14014322671654439006e3 * t871 * t2891 - 0.3442139234639332132e2 * t355 * t2996 - 0.75886726649397912613e0 * t135 * t2969) * t54 + 0.13214594783764202253e-3 * t921 * t1363 - 0.26555431180180738908e-6 * t2055 * t1367 - 0.27184694464750344929e-1 * t317 * t2964 + 0.10191095557737613349e-4 * t330 * t2964 - 0.86901346194545660427e-9 * t342 * t2964 - 0.56694468890819132738e-1 * t904 * t2979 - 0.48453514207135408263e-3 * t368 * t888 * t860 * t34 + 0.97369914327329375996e-6 * t882 * t883 * t860 * t34 + 0.11033410193310442892e-3 * t894 * t2979 - 0.17004430818989607802e-7 * t900 * t2979 + 0.23604827715716212363e-6 * t3036 * t885 - 0.1174630647445706867e-3 * t1355 * t890;
  t3048 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t806 * t252 - 0.3e1 / 0.8e1 * t2860 - 0.9e1 / 0.8e1 * t5 * t296 * t623 + t2866 / 0.4e1 - 0.3e1 / 0.4e1 * t2869 - 0.9e1 / 0.8e1 * t5 * t104 * t1409 - t2876 + t2878 / 0.4e1 - 0.3e1 / 0.8e1 * t2881 - 0.3e1 / 0.8e1 * t5 * t27 * (t2919 + t2951 + t2987 + t3041));
  tv4rho3sigma0 = t6 * t3048 + 0.3e1 * t1414;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t3055 = t5 * t970 * t274;
  t3058 = t5 * t974 * t274;
  t3062 = 0.5e1 / 0.36e2 * t5 * t978 * t274;
  t3064 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t966 * t274 - 0.3e1 / 0.8e1 * t3055 + t3058 / 0.4e1 - t3062);
  tv4rho3sigma2 = t6 * t3064 + 0.3e1 * t1427;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t3066 = 0.2e1 * t1441;
  t3072 = t5 * t1008 * t252 / 0.4e1;
  t3077 = t5 * t1015 * t252;
  t3081 = t5 * t430 * t623 / 0.4e1;
  t3090 = -0.3e1 / 0.8e1 * t5 * t1004 * t252 - t3072 - 0.3e1 / 0.4e1 * t5 * t426 * t623 + t3077 / 0.12e2 - t3081 - 0.3e1 / 0.8e1 * t5 * t177 * t1409 - t2860 / 0.8e1 + t2866 / 0.6e1 - t2869 / 0.4e1 - t2876 + t2878 / 0.6e1 - t2881 / 0.8e1;
  t3091 = my_piecewise3(t1, 0, t3090);
  tv4rho3sigma3 = t6 * t3091 + t1414 + t3066;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t3093 = 0.2e1 * t1457;
  t3099 = t5 * t1050 * t274 / 0.4e1;
  t3101 = t5 * t1054 * t274;
  t3110 = t5 * t405 * t687 / 0.4e1;
  t3112 = t5 * t409 * t687;
  t3115 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1046 * t274 - t3099 + t3101 / 0.12e2 - t3055 / 0.8e1 + t3058 / 0.6e1 - t3062 - 0.3e1 / 0.8e1 * t5 * t401 * t687 - t3110 + t3112 / 0.12e2);
  tv4rho3sigma5 = t6 * t3115 + t1427 + t3093;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t3121 = t5 * t1091 * t252;
  t3130 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1087 * t252 - t3121 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t480 * t623 - t3072 + t3077 / 0.6e1 - t3081 + t2866 / 0.12e2 - t2876 + t2878 / 0.12e2);
  tv4rho3sigma6 = t6 * t3130 + t1465 + t3066;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t3136 = t5 * t1121 * t274;
  t3143 = t5 * t453 * t687;
  t3151 = t5 * t164 * t1563;
  t3153 = -0.3e1 / 0.8e1 * t5 * t1117 * t274 - t3136 / 0.8e1 - t3099 + t3101 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t449 * t687 - t3143 / 0.4e1 + t3058 / 0.12e2 - t3062 - t3110 + t3112 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t160 * t1563 - t3151 / 0.8e1;
  t3154 = my_piecewise3(t61, 0, t3153);
  tv4rho3sigma8 = t6 * t3154 + t1568 + t3093;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t3163 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1158 * t252 - 0.3e1 / 0.8e1 * t3121 + t3077 / 0.4e1 - t2876);
  tv4rho3sigma9 = t6 * t3163 + 0.3e1 * t1465;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t3180 = t371 * t1238;
  t3185 = t258 * t1232;
  t3193 = 0.1e1 / t70 / t2638;
  t3196 = sigma[2] * t29 * t32;
  t3205 = t673 * t1200;
  t3212 = t1499 * t1192;
  t3217 = -0.58091356011264532686e-3 * t557 * t3180 + 0.43361397048290413054e0 * t563 * t3180 - 0.8191880689375660399e-3 * t194 * t3185 + 0.72609539656227136857e-7 * t205 * t3185 - 0.57998904578644783389e0 * t2707 * t1525 + 0.67700441238057176857e-12 * t2690 * t3193 * t3196 + 0.74499696848375325154e-6 * t2695 * t3193 * t3196 - 0.21392169402349835075e-8 * t2700 * t3193 * t3196 + 0.51554581847684251902e0 * t3205 * t1197 - 0.65901958500174049686e-4 * t2762 * t650 + 0.4919150085310256943e-1 * t2787 * t650 - 0.23186279615369182551e-2 * t3212 * t1197 + 0.32950979250087024843e-3 * t1250 * t1533;
  t3219 = t857 * t1196 * t69;
  t3232 = t3193 * sigma[2] * t33;
  t3249 = -0.95643403413397878022e-2 * t1193 * t3219 - 0.24595750426551284715e0 * t1228 * t1533 + 0.2126626501216975391e1 * t1201 * t3219 - 0.43238341010159925972e-16 * t2679 * t3193 * t3196 + 0.2608456456729033037e-2 * t2704 * t1525 + 0.30136910704788353288e-4 * t2784 * t3232 - 0.10058658787789171959e-7 * t2776 * t3232 - 0.77330411421195406397e-2 * t550 * t1509 - 0.82854012236995078279e-3 * t2758 * t271 + 0.17518115166734888702e-5 * t2791 * t3232 - 0.31840783438149622784e-3 * t2765 * t3232 - 0.78230187376404465597e-9 * t2773 * t3232 + 0.25652563519171021116e-2 * t2781 * t3232;
  t3252 = t1493 * t219 * t221;
  t3256 = t671 * t554 * t556;
  t3259 = t1495 * t562;
  t3279 = t1196 * t69;
  t3282 = t320 * t1238;
  t3304 = 0.66283209789596062623e-2 * t3252 * t224 + 0.1757385560004641325e-3 * t3256 * t559 - 0.13117733560827351848e0 * t3259 * t559 + 0.33141604894798031313e-2 * t1246 * t684 + 0.85922679356883784887e-2 * t222 * t33 * t257 * t1232 + 0.17184535871376756976e-1 * t674 * t1292 - 0.15466082284239081279e-1 * t1496 * t567 - 0.4100566306677496425e-3 * t1500 * t1286 + 0.30608044975263820979e0 * t1503 * t1286 + (0.3634819604508281443e1 * t2711 * t3193 * t3196 + 0.13815003817874682422e3 * t1258 * t3279 + 0.34110628784359535952e2 * t536 * t3282 + 0.75419130908419567477e0 * t209 * t3185 - 0.37961997252977544381e1 * t2722 * t3193 * t3196 - 0.14014322671654439006e3 * t1267 * t3279 - 0.3442139234639332132e2 * t542 * t3282 - 0.75886726649397912613e0 * t213 * t3185) * t89 + 0.13214594783764202253e-3 * t1249 * t1517 - 0.26555431180180738908e-6 * t2736 * t1521 - 0.1174630647445706867e-3 * t1499 * t1205;
  t3305 = t268 * t1209;
  t3338 = 0.23604827715716212363e-6 * t3305 * t1213 - 0.48453514207135408263e-3 * t555 * t1192 * t1196 * t69 - 0.27184694464750344929e-1 * t506 * t3180 + 0.10191095557737613349e-4 * t517 * t3180 - 0.86901346194545660427e-9 * t529 * t3180 + 0.97369914327329375996e-6 * t1210 * t1211 * t1196 * t69 - 0.17004430818989607802e-7 * t1217 * t3219 - 0.56694468890819132738e-1 * t1221 * t3219 + 0.11033410193310442892e-3 * t1225 * t3219 + 0.12213383548880094644e0 * t2648 * t3232 - 0.45765171449934153995e-2 * t2637 * t3232 + 0.21340051268380952584e-5 * t1225 * t3279 - 0.20159140252729629374e-8 * t1217 * t3279 + 0.27558362520869847766e-12 * t1282 * t3279;
  t3345 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t1177 * t274 - 0.3e1 / 0.8e1 * t3136 - 0.9e1 / 0.8e1 * t5 * t496 * t687 + t3101 / 0.4e1 - 0.3e1 / 0.4e1 * t3143 - 0.9e1 / 0.8e1 * t5 * t188 * t1563 - t3062 + t3112 / 0.4e1 - 0.3e1 / 0.8e1 * t3151 - 0.3e1 / 0.8e1 * t5 * t68 * (t3217 + t3249 + t3304 + t3338));
  tv4rho3sigma11 = t6 * t3345 + 0.3e1 * t1568;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t3352 = t5 * t300 * t735;
  t3359 = t5 * t309 * t735 / 0.12e2;
  t3361 = t5 * t110 * t1660;
  t3364 = 0.1e1 / t35 / t859;
  t3366 = t857 * t3364 * t33;
  t3373 = t371 * t694 * t325;
  t3399 = t1592 * t141 * t143;
  t3402 = 0.17161939293725307748e-2 * t1993 * t3366 - 0.45800188308300354915e-1 * t142 * t2022 * t3366 + 0.25628539416734352652e-4 * t370 * t3373 - 0.19130028109539888111e-1 * t377 * t3373 + 0.12888401903532567732e-2 * t144 * t33 * t704 * t336 - 0.51553607614130270929e-2 * t610 * t1348 - 0.2196731950005801656e-4 * t922 * t1607 + 0.1639716695103418981e-1 * t925 * t1607 - 0.11047201631599343771e-2 * t363 * t1613 - 0.51553607614130270929e-2 * t1595 * t381 + 0.44188806526397375082e-2 * t1344 * t620 - 0.61489376066378211788e-2 * t1968 * t726 + 0.4142700611849753914e-3 * t918 * t732 + 0.44188806526397375082e-2 * t3399 * t146;
  t3404 = t721 * t367 * t369;
  t3407 = t1594 * t376;
  t3418 = t1626 * t1323;
  t3424 = t3364 * t29 * t32;
  t3427 = t705 * t336;
  t3430 = t695 * t325;
  t3439 = 0.58579518666821377499e-4 * t3404 * t373 - 0.43725778536091172827e-1 * t3407 * t373 - 0.16570802447399015656e-2 * t2958 * t249 + 0.82377448125217562105e-5 * t1965 * t726 + 0.21967319500058016563e-3 * t1356 * t1379 - 0.16397166951034189811e0 * t1359 * t1379 + 0.20650280282438178208e-2 * t907 * t3418 - 0.45915799458093786849e0 * t912 * t3418 + 0.29336320266151674598e-9 * t1979 * t3424 - 0.12287821034063490598e-3 * t116 * t3427 + 0.11993247557978093352e-2 * t318 * t3430 + 0.10891430948434070529e-7 * t127 * t3427 - 0.96197113196891329185e-3 * t2009 * t3424 - 0.11301341514295632484e-4 * t1999 * t3424;
  t3465 = t235 * t1323;
  t3486 = 0.37719970454209394848e-8 * t2004 * t3424 - 0.38665936385763188927e0 * t2961 * t1371 - 0.65211411418225825922e-3 * t2087 * t1627 + 0.14499726144661195847e0 * t2037 * t1627 - 0.44960715695901235371e-6 * t331 * t3430 + 0.38338829203476026666e-10 * t343 * t3430 - 0.65692931875255832632e-6 * t1989 * t3424 + 0.11940293789306108544e-3 * t1993 * t3424 - 0.8786927800023206625e-4 * t2935 * t586 + 0.17389709711526886913e-2 * t2988 * t1371 + 0.65588667804136759242e-1 * t2938 * t586 + (-0.13630573516906055411e1 * t2091 * t3424 - 0.29827849152229427956e2 * t858 * t3465 - 0.15048806816629207038e1 * t349 * t3430 + 0.11312869636262935121e0 * t131 * t3427 + 0.14235748969866579143e1 * t2103 * t3424 + 0.30258196677435720582e2 * t871 * t3465 + 0.15185908388114700582e1 * t355 * t3430 - 0.11383008997409686892e0 * t135 * t3427) * t54 + 0.1621437787880997224e-16 * t2075 * t3424 + 0.80220635258811881537e-9 * t2003 * t3424;
  t3517 = -0.25387665464271441323e-12 * t2080 * t3424 + 0.12240851237790494568e-1 * t904 * t3418 - 0.23822135644647547153e-4 * t894 * t3418 + 0.36714111995545744121e-8 * t900 * t3418 - 0.27937386318140746932e-6 * t1998 * t3424 - 0.17703620786787159272e-6 * t3036 * t1367 + 0.88097298558428015025e-4 * t1355 * t1363 + 0.66388577950451847268e-7 * t2055 * t1619 - 0.33036486959410505634e-4 * t921 * t1623 + 0.10461554203813326784e-3 * t368 * t1622 * t1323 - 0.21023049684309751635e-6 * t882 * t1618 * t1323 - 0.59501009988241716772e-13 * t942 * t3465 - 0.46075110693095238534e-6 * t894 * t3465 + 0.43525416454757154333e-9 * t900 * t3465;
  t3524 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t296 * t735 - t3352 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t104 * t1660 + t3359 - t3361 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t3402 + t3439 + t3486 + t3517));
  tv4rho2sigma20 = t6 * t3524 + 0.2e1 * t1665;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t3531 = t5 * t405 * t781;
  t3535 = t5 * t409 * t781 / 0.12e2;
  t3537 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t401 * t781 - t3531 / 0.4e1 + t3535);
  tv4rho2sigma25 = t6 * t3537 + 0.2e1 * t1674;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t3543 = t5 * t430 * t735;
  t3551 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t426 * t735 - t3543 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t177 * t1660 - t3352 / 0.8e1 + t3359 - t3361 / 0.8e1);
  tv4rho2sigma26 = t6 * t3551 + t1665 + t1680;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t3557 = t5 * t453 * t781;
  t3564 = t5 * t164 * t1769;
  t3567 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t449 * t781 - t3557 / 0.8e1 - t3531 / 0.8e1 + t3535 - 0.3e1 / 0.8e1 * t5 * t160 * t1769 - t3564 / 0.8e1);
  tv4rho2sigma211 = t6 * t3567 + t1674 + t1774;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t3575 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t480 * t735 - t3543 / 0.4e1 + t3359);
  tv4rho2sigma212 = t6 * t3575 + 0.2e1 * t1680;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t3586 = t257 * t1477;
  t3600 = 0.1e1 / t70 / t1195;
  t3602 = t857 * t3600 * t33;
  t3612 = t1701 * t219 * t221;
  t3619 = t767 * t554 * t556;
  t3622 = t1711 * t562;
  t3625 = -0.59501009988241716772e-13 * t1282 * t3586 - 0.46075110693095238534e-6 * t1225 * t3586 + 0.43525416454757154333e-9 * t1217 * t3586 + 0.1639716695103418981e-1 * t1228 * t1716 - 0.11047201631599343771e-2 * t550 * t1722 + 0.4142700611849753914e-3 * t1246 * t778 + 0.17161939293725307748e-2 * t2765 * t3602 - 0.16570802447399015656e-2 * t3252 * t271 + 0.82377448125217562105e-5 * t2762 * t772 - 0.61489376066378211788e-2 * t2787 * t772 + 0.44188806526397375082e-2 * t3612 * t224 - 0.45800188308300354915e-1 * t220 * t2646 * t3602 + 0.58579518666821377499e-4 * t3619 * t559 - 0.43725778536091172827e-1 * t3622 * t559;
  t3627 = t371 * t740 * t512;
  t3644 = t1735 * t1477;
  t3650 = t3600 * t29 * t32;
  t3659 = t741 * t512;
  t3662 = -0.19130028109539888111e-1 * t563 * t3627 + 0.12888401903532567732e-2 * t222 * t33 * t750 * t523 - 0.51553607614130270929e-2 * t674 * t1509 - 0.51553607614130270929e-2 * t1712 * t567 + 0.25628539416734352652e-4 * t557 * t3627 + 0.44188806526397375082e-2 * t1496 * t684 - 0.2196731950005801656e-4 * t1250 * t1716 - 0.45915799458093786849e0 * t1201 * t3644 + 0.21967319500058016563e-3 * t1500 * t1533 + 0.29336320266151674598e-9 * t2773 * t3650 - 0.65692931875255832632e-6 * t2791 * t3650 + 0.11940293789306108544e-3 * t2765 * t3650 - 0.96197113196891329185e-3 * t2781 * t3650 - 0.44960715695901235371e-6 * t518 * t3659;
  t3664 = t751 * t523;
  t3709 = -0.12287821034063490598e-3 * t194 * t3664 + 0.38338829203476026666e-10 * t530 * t3659 - 0.16397166951034189811e0 * t1503 * t1533 + 0.20650280282438178208e-2 * t1193 * t3644 + (-0.13630573516906055411e1 * t2711 * t3650 - 0.29827849152229427956e2 * t1258 * t3586 - 0.15048806816629207038e1 * t536 * t3659 + 0.11312869636262935121e0 * t209 * t3664 + 0.14235748969866579143e1 * t2722 * t3650 + 0.30258196677435720582e2 * t1267 * t3586 + 0.15185908388114700582e1 * t542 * t3659 - 0.11383008997409686892e0 * t213 * t3664) * t89 - 0.11301341514295632484e-4 * t2784 * t3650 + 0.37719970454209394848e-8 * t2776 * t3650 + 0.14499726144661195847e0 * t2707 * t1736 - 0.8786927800023206625e-4 * t3256 * t650 + 0.10891430948434070529e-7 * t205 * t3664 + 0.11993247557978093352e-2 * t507 * t3659 + 0.17389709711526886913e-2 * t3212 * t1525 + 0.65588667804136759242e-1 * t3259 * t650 - 0.38665936385763188927e0 * t3205 * t1525;
  t3740 = -0.65211411418225825922e-3 * t2704 * t1736 - 0.27937386318140746932e-6 * t2695 * t3650 + 0.80220635258811881537e-9 * t2700 * t3650 - 0.25387665464271441324e-12 * t2690 * t3650 - 0.21023049684309751635e-6 * t1210 * t1727 * t1477 + 0.10461554203813326784e-3 * t555 * t1731 * t1477 + 0.12240851237790494568e-1 * t1221 * t3644 - 0.23822135644647547153e-4 * t1225 * t3644 + 0.36714111995545744121e-8 * t1217 * t3644 - 0.17703620786787159272e-6 * t3305 * t1521 + 0.1621437787880997224e-16 * t2679 * t3650 + 0.66388577950451847268e-7 * t2736 * t1728 - 0.33036486959410505634e-4 * t1249 * t1732 + 0.88097298558428015025e-4 * t1499 * t1517;
  t3747 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t496 * t781 - t3557 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t188 * t1769 + t3535 - t3564 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t68 * (t3625 + t3662 + t3709 + t3740));
  tv4rho2sigma217 = t6 * t3747 + 0.2e1 * t1774;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t3754 = t5 * t110 * t1856 / 0.8e1;
  t3755 = t704 * t1576;
  t3761 = t1818 * t141 * t143;
  t3765 = 0.1e1 / t35 / t1322;
  t3767 = t694 * t3765 * t33;
  t3773 = t371 * t1801 * t585;
  t3790 = -0.1e-28 * t900 * t3755 + 0.2e-32 * t942 * t3755 + 0.22094403263198687541e-2 * t3761 * t146 - 0.44776101709897907041e-4 * t1993 * t3767 - 0.16570802447399015656e-2 * t610 * t1613 + 0.16475489625043512421e-4 * t370 * t3773 - 0.12297875213275642357e-1 * t377 * t3773 + 0.8285401223699507828e-3 * t144 * t33 * t1807 * t120 + 0.33141604894798031312e-2 * t1595 * t620 - 0.32950979250087024841e-4 * t1356 * t1607 + 0.24595750426551284716e-1 * t1359 * t1607 - 0.12356617218782634316e-4 * t922 * t1846;
  t3817 = 0.92234064099567317682e-2 * t925 * t1846 - 0.6214050917774630871e-3 * t363 * t1852 + 0.12428101835549261742e-2 * t1344 * t732 - 0.24856203671098523484e-2 * t3399 * t249 + 0.24713234437565268632e-4 * t2935 * t726 - 0.18446812819913463537e-1 * t2938 * t726 + 0.24634849453220937235e-6 * t1989 * t3767 - 0.11001120099806877974e-9 * t1979 * t3767 - 0.14144988920328523068e-8 * t2004 * t3767 + 0.36073917448834248445e-3 * t2009 * t3767 + 0.42380030678608621812e-5 * t1999 * t3767 - 0.97817117127338738885e-3 * t2988 * t1627 + 0.21749589216991793772e0 * t2961 * t1627;
  t3821 = t3765 * t29 * t32;
  t3824 = t1802 * t585;
  t3848 = t1808 * t120;
  t3851 = -0.60803917045537395908e-17 * t2075 * t694 * t3821 - 0.28903317233079365593e-6 * t331 * t3824 + 0.24646390202234588569e-10 * t343 * t3824 - 0.65901958500174049687e-4 * t3404 * t586 + 0.49191500853102569431e-1 * t3407 * t586 + 0.9520374549101790497e-13 * t2080 * t694 * t3821 + 0.104765198693027801e-6 * t1998 * t694 * t3821 - 0.30082738222054455577e-9 * t2003 * t694 * t3821 - 0.27186986521239742214e-1 * t2037 * t1778 + 0.1222713964091734236e-3 * t2087 * t1778 + 0.77099448587002028687e-3 * t318 * t3824 - 0.78993135218979582416e-4 * t116 * t3848;
  t3854 = t1776 * t1576;
  t3899 = 0.7001634181136188197e-8 * t127 * t3848 + 0.2e-22 * t907 * t3854 + (0.51114650688397707793e0 * t2091 * t694 * t3821 + 0.1e-18 * t858 * t3755 - 0.96742329535473473808e0 * t349 * t3824 + 0.72725590518833154352e-1 * t131 * t3848 - 0.53384058636999671787e0 * t2103 * t694 * t3821 - 0.1e-18 * t871 * t3755 + 0.97623696780737360892e0 * t355 * t3824 - 0.73176486411919415732e-1 * t135 * t3848) * t54 + 0.61943413048894698061e-5 * t921 * t1788 - 0.12447858365709721362e-7 * t2055 * t1784 + 0.1e-23 * t368 * t1787 * t1576 - 0.2e-28 * t900 * t3854 - 0.1e-24 * t894 * t3854 - 0.4e-26 * t882 * t1783 * t1576 + 0.99582866925677770904e-7 * t3036 * t1619 - 0.49554730439115758452e-4 * t1355 * t1623 + 0.17175070615612633093e-1 * t2024 * t3767 - 0.64357272351469904052e-3 * t2019 * t3767;
  t3906 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t104 * t1856 - t3754 - 0.3e1 / 0.8e1 * t5 * t27 * (t3790 + t3817 + t3851 + t3899));
  tv4rhosigma30 = t6 * t3906 + t1860;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t3913 = t5 * t164 * t1941 / 0.8e1;
  t3915 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t160 * t1941 - t3913);
  tv4rhosigma39 = t6 * t3915 + t1945;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t3921 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t177 * t1856 - t3754);
  tv4rhosigma310 = t6 * t3921 + t1860;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t3928 = 0.1e1 / t70 / t1476;
  t3930 = t3928 * t29 * t32;
  t3933 = t750 * t1685;
  t3936 = t1876 * t649;
  t3939 = t1882 * t198;
  t3958 = t740 * t3928 * t33;
  t3972 = t371 * t1875 * t649;
  t3981 = (0.51114650688397707793e0 * t2711 * t740 * t3930 + 0.1e-18 * t1258 * t3933 - 0.96742329535473473808e0 * t536 * t3936 + 0.72725590518833154352e-1 * t209 * t3939 - 0.53384058636999671787e0 * t2722 * t740 * t3930 - 0.1e-18 * t1267 * t3933 + 0.97623696780737360892e0 * t542 * t3936 - 0.73176486411919415732e-1 * t213 * t3939) * t89 - 0.6214050917774630871e-3 * t550 * t1902 - 0.18446812819913463537e-1 * t3259 * t772 + 0.24634849453220937236e-6 * t2791 * t3958 - 0.44776101709897907041e-4 * t2765 * t3958 - 0.11001120099806877974e-9 * t2773 * t3958 + 0.24713234437565268632e-4 * t3256 * t772 + 0.33141604894798031312e-2 * t1712 * t684 - 0.16570802447399015656e-2 * t674 * t1722 + 0.16475489625043512421e-4 * t557 * t3972 - 0.12297875213275642357e-1 * t563 * t3972 + 0.8285401223699507828e-3 * t222 * t33 * t1881 * t198;
  t3987 = t1918 * t219 * t221;
  t4012 = -0.32950979250087024841e-4 * t1500 * t1716 + 0.24595750426551284716e-1 * t1503 * t1716 + 0.22094403263198687541e-2 * t3987 * t224 - 0.14144988920328523068e-8 * t2776 * t3958 + 0.36073917448834248445e-3 * t2781 * t3958 + 0.42380030678608621812e-5 * t2784 * t3958 - 0.24856203671098523484e-2 * t3612 * t271 + 0.12428101835549261742e-2 * t1496 * t778 - 0.12356617218782634316e-4 * t1250 * t1895 + 0.92234064099567317682e-2 * t1228 * t1895 - 0.30082738222054455577e-9 * t2700 * t740 * t3930 - 0.60803917045537395908e-17 * t2679 * t740 * t3930 + 0.1222713964091734236e-3 * t2704 * t1921;
  t4026 = t1920 * t1685;
  t4041 = 0.9520374549101790497e-13 * t2690 * t740 * t3930 + 0.104765198693027801e-6 * t2695 * t740 * t3930 - 0.27186986521239742214e-1 * t2707 * t1921 - 0.65901958500174049687e-4 * t3619 * t650 + 0.49191500853102569431e-1 * t3622 * t650 + 0.2e-22 * t1193 * t4026 + 0.77099448587002028687e-3 * t507 * t3936 - 0.97817117127338738885e-3 * t3212 * t1736 + 0.21749589216991793772e0 * t3205 * t1736 + 0.7001634181136188197e-8 * t205 * t3939 - 0.28903317233079365593e-6 * t518 * t3936 - 0.78993135218979582416e-4 * t194 * t3939;
  t4070 = 0.24646390202234588569e-10 * t530 * t3936 - 0.4e-26 * t1210 * t1866 * t1685 + 0.1e-23 * t555 * t1861 * t1685 - 0.1e-24 * t1225 * t4026 - 0.12447858365709721362e-7 * t2736 * t1867 + 0.61943413048894698061e-5 * t1249 * t1863 - 0.2e-28 * t1217 * t4026 + 0.99582866925677770904e-7 * t3305 * t1728 - 0.49554730439115758452e-4 * t1499 * t1732 - 0.1e-28 * t1217 * t3933 + 0.2e-32 * t1282 * t3933 - 0.64357272351469904052e-3 * t2637 * t3958 + 0.17175070615612633093e-1 * t2648 * t3958;
  t4077 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t188 * t1941 - t3913 - 0.3e1 / 0.8e1 * t5 * t68 * (t3981 + t4012 + t4041 + t4070));
  tv4rhosigma319 = t6 * t4077 + t1945;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t4081 = t1957 * t29 * t32;
  t4084 = t1807 * t1777;
  t4087 = t1800 * sigma[0];
  t4088 = 0.1e1 / t4087;
  t4090 = t320 * t4088 * t697;
  t4094 = 0.1e1 / t34 / t4087;
  t4096 = t32 * t4094 * t37;
  t4115 = t1801 * t1957 * t33;
  t4134 = t371 * t4088 * t697;
  t4156 = t857 * t1807 * t1777;
  t4159 = -0.24856203671098523484e-2 * t610 * t1852 + 0.3089154304695658579e-4 * t370 * t4134 - 0.2305851602489182942e-1 * t377 * t4134 + 0.15535127294436577178e-2 * t144 * t33 * t4094 * t37 + 0.24856203671098523484e-2 * t1595 * t732 - 0.49426468875130537264e-4 * t1356 * t1846 + 0.36893625639826927073e-1 * t1359 * t1846 + 0.14456146610062880379e-2 * t318 * t4090 - 0.14811212853558671703e-3 * t116 * t4096 + 0.1312806408963035287e-7 * t127 * t4096 + 0.81560959563719226642e-1 * t912 * t4156;
  t4212 = 0.42315635684571300864e-5 * t894 * t4156 + 0.37343575097129164087e-7 * t882 * t883 * t1807 * t1777 - 0.18583023914668409418e-4 * t368 * t888 * t1807 * t1777 - 0.65215856834193098108e-9 * t900 * t4156 + 0.24777365219557879225e-4 * t1355 * t1788 - 0.4979143346283888545e-7 * t3036 * t1784 + 0.81843946625892857929e-7 * t894 * t4084 - 0.77314884492002839941e-10 * t900 * t4084 + 0.1056925835317451548e-13 * t942 * t4084 - 0.644065148085473741e-2 * t2024 * t4115 + 0.2413397713180121402e-3 * t2019 * t4115;
  t4218 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * ((-0.19167994008149140423e0 * t2091 * t1801 * t4081 + 0.52983679415144378607e1 * t858 * t4084 - 0.1813918678790127634e1 * t349 * t4090 + 0.13636048222281216441e0 * t131 * t4096 + 0.2001902198887487692e0 * t2103 * t1801 * t4081 - 0.53748112519129240508e1 * t871 * t4084 + 0.18304443146388255166e1 * t355 * t4090 - 0.1372059120223489045e0 * t135 * t4096) * t54 + 0.49426468875130537264e-4 * t3404 * t726 - 0.36893625639826927074e-1 * t3407 * t726 - 0.92380685449578514634e-7 * t1989 * t4115 + 0.41254200374275792402e-10 * t1979 * t4115 + 0.53043708451231961506e-9 * t2004 * t4115 - 0.13527719043312843167e-3 * t2009 * t4115 - 0.1589251150447823318e-5 * t1999 * t4115 - 0.33141604894798031312e-2 * t3761 * t249 + 0.1679103814121171514e-4 * t1993 * t4115 + t4159 - 0.36681418922752027081e-3 * t907 * t4156 + 0.22801468892076523465e-17 * t2075 * t1801 * t4081 - 0.54193719812023810485e-6 * t331 * t4090 + 0.46211981629189853565e-10 * t343 * t4090 - 0.39286949509885425377e-7 * t1998 * t1801 * t4081 + 0.11281026833270420842e-9 * t2003 * t1801 * t4081 - 0.35701404559131714362e-13 * t2080 * t1801 * t4081 - 0.10874794608495896886e0 * t2961 * t1778 + 0.48908558563669369442e-3 * t2988 * t1778 - 0.2174361733028574693e-2 * t904 * t4156 + t4212));
  tv4sigma40 = t6 * t4218;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t4219 = t1881 * t1862;
  t4226 = t2660 * t29 * t32;
  t4231 = t1874 * sigma[2];
  t4232 = 0.1e1 / t4231;
  t4234 = t320 * t4232 * t743;
  t4238 = 0.1e1 / t69 / t4231;
  t4240 = t32 * t4238 * t72;
  t4255 = t1875 * t2660 * t33;
  t4284 = t371 * t4232 * t743;
  t4297 = 0.41254200374275792402e-10 * t2773 * t4255 + 0.49426468875130537264e-4 * t3619 * t772 + 0.15535127294436577178e-2 * t222 * t33 * t4238 * t72 + 0.24856203671098523484e-2 * t1712 * t778 - 0.24856203671098523484e-2 * t674 * t1902 + 0.3089154304695658579e-4 * t557 * t4284 - 0.2305851602489182942e-1 * t563 * t4284 - 0.49426468875130537264e-4 * t1500 * t1895 + 0.36893625639826927073e-1 * t1503 * t1895 + 0.14456146610062880379e-2 * t507 * t4234 + 0.48908558563669369442e-3 * t3212 * t1921;
  t4305 = t857 * t1881 * t1862;
  t4352 = -0.39286949509885425377e-7 * t2695 * t1875 * t4226 - 0.18583023914668409418e-4 * t555 * t1192 * t1881 * t1862 + 0.37343575097129164087e-7 * t1210 * t1211 * t1881 * t1862 - 0.2174361733028574693e-2 * t1221 * t4305 + 0.42315635684571300864e-5 * t1225 * t4305 - 0.65215856834193098108e-9 * t1217 * t4305 + 0.24777365219557879225e-4 * t1499 * t1863 - 0.4979143346283888545e-7 * t3305 * t1867 - 0.644065148085473741e-2 * t2648 * t4255 + 0.2413397713180121402e-3 * t2637 * t4255 + 0.81843946625892857929e-7 * t1225 * t4219;
  t4358 = my_piecewise3(t61, 0, -0.3e1 / 0.8e1 * t5 * t68 * (-0.77314884492002839941e-10 * t1217 * t4219 + 0.1056925835317451548e-13 * t1282 * t4219 + (-0.19167994008149140423e0 * t2711 * t1875 * t4226 + 0.52983679415144378607e1 * t1258 * t4219 - 0.1813918678790127634e1 * t536 * t4234 + 0.13636048222281216441e0 * t209 * t4240 + 0.2001902198887487692e0 * t2722 * t1875 * t4226 - 0.53748112519129240508e1 * t1267 * t4219 + 0.18304443146388255166e1 * t542 * t4234 - 0.1372059120223489045e0 * t213 * t4240) * t89 + 0.53043708451231961506e-9 * t2776 * t4255 - 0.13527719043312843167e-3 * t2781 * t4255 - 0.1589251150447823318e-5 * t2784 * t4255 - 0.33141604894798031312e-2 * t3987 * t271 - 0.36893625639826927074e-1 * t3622 * t772 - 0.92380685449578514634e-7 * t2791 * t4255 + 0.1679103814121171514e-4 * t2765 * t4255 + t4297 - 0.10874794608495896886e0 * t3205 * t1921 + 0.11281026833270420842e-9 * t2700 * t1875 * t4226 - 0.36681418922752027081e-3 * t1193 * t4305 + 0.81560959563719226642e-1 * t1201 * t4305 - 0.54193719812023810485e-6 * t518 * t4234 - 0.14811212853558671703e-3 * t194 * t4240 + 0.46211981629189853565e-10 * t530 * t4234 + 0.1312806408963035287e-7 * t205 * t4240 + 0.22801468892076523465e-17 * t2679 * t1875 * t4226 - 0.35701404559131714362e-13 * t2690 * t1875 * t4226 + t4352));
  tv4sigma414 = t6 * t4358;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t32;
  double t33, t35, t36, t39, t41, t43, t44, t46;
  double t47, t49, t53, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = pow(t32, 0.2626712e1);
  t35 = 0.1e1 + 0.13471619689594796103e-3 * t33;
  t36 = pow(t35, -0.657946e0);
  t39 = pow(t32, 0.3217063e1);
  t41 = pow(t32, 0.3223476e1);
  t43 = 0.1e1 - 0.45212413010769857073e-1 * t39 + 0.45402221956620378581e-1 * t41;
  t44 = pow(t32, 0.3473804e1);
  t46 = 0.1e1 + 0.47702180224903349918e-3 * t44;
  t47 = 0.1e1 / t46;
  t49 = 0.60146019220211109872e-4 * t33 * t36 + t43 * t47;
  t53 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t49);
  tzk0 = 0.2e1 * t53;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t32;
  double t33, t35, t36, t39, t41, t43, t44, t46;
  double t47, t49, t53, tzk0;

  double t54, t56, t60, t62, t63, t64, t66, t67;
  double t68, t71, t72, t74, t77, t79, t80, t83;
  double t85, t88, t90, t91, t92, t93, t94, t95;
  double t98, t103, tvrho0, t106, t107, t108, t109, t114;
  double t115, t120, t124, t128, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = pow(t32, 0.2626712e1);
  t35 = 0.1e1 + 0.13471619689594796103e-3 * t33;
  t36 = pow(t35, -0.657946e0);
  t39 = pow(t32, 0.3217063e1);
  t41 = pow(t32, 0.3223476e1);
  t43 = 0.1e1 - 0.45212413010769857073e-1 * t39 + 0.45402221956620378581e-1 * t41;
  t44 = pow(t32, 0.3473804e1);
  t46 = 0.1e1 + 0.47702180224903349918e-3 * t44;
  t47 = 0.1e1 / t46;
  t49 = 0.60146019220211109872e-4 * t33 * t36 + t43 * t47;
  t53 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t49);
  tzk0 = 0.2e1 * t53;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t54 = t18 * t18;
  t56 = t17 / t54;
  t60 = pow(t32, 0.1626712e1);
  t62 = t60 * t36 * t21;
  t63 = t24 * t26;
  t64 = rho[0] * rho[0];
  t66 = 0.1e1 / t18 / t64;
  t67 = t27 * t66;
  t68 = t63 * t67;
  t71 = pow(t32, 0.4253424e1);
  t72 = pow(t35, -0.1657946e1);
  t74 = t71 * t72 * t21;
  t77 = pow(t32, 0.2217063e1);
  t79 = t77 * t21 * t24;
  t80 = t28 * t66;
  t83 = pow(t32, 0.2223476e1);
  t85 = t83 * t21 * t24;
  t88 = 0.19393490805022174494e0 * t79 * t80 - 0.19513729709845177529e0 * t85 * t80;
  t90 = t46 * t46;
  t91 = 0.1e1 / t90;
  t92 = t43 * t91;
  t93 = pow(t32, 0.2473804e1);
  t94 = t93 * t21;
  t95 = t92 * t94;
  t98 = -0.21064836058394555311e-3 * t62 * t68 + 0.18671024483029835192e-7 * t74 * t68 + t88 * t47 + 0.22094403263198687541e-2 * t95 * t68;
  t103 = my_piecewise3(t2, 0, -t6 * t56 * t49 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t98);
  tvrho0 = 0.2e1 * rho[0] * t103 + 0.2e1 * t53;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t106 = 0.1e1 / t26;
  t107 = t24 * t106;
  t108 = t27 * t30;
  t109 = t107 * t108;
  t114 = t106 * t27;
  t115 = t114 * t30;
  t120 = -0.72725590518833154352e-1 * t79 * t115 + 0.73176486411919415733e-1 * t85 * t115;
  t124 = 0.78993135218979582417e-4 * t62 * t109 - 0.7001634181136188197e-8 * t74 * t109 + t120 * t47 - 0.82854012236995078279e-3 * t95 * t109;
  t128 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t124);
  tvsigma0 = 0.2e1 * rho[0] * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t32;
  double t33, t35, t36, t39, t41, t43, t44, t46;
  double t47, t49, t53, tzk0;

  double t54, t56, t60, t62, t63, t64, t66, t67;
  double t68, t71, t72, t74, t77, t79, t80, t83;
  double t85, t88, t90, t91, t92, t93, t94, t95;
  double t98, t103, tvrho0, t106, t107, t108, t109, t114;
  double t115, t120, t124, t128, tvsigma0;

  double t133, t140, t142, t143, t144, t145, t146, t147;
  double t149, t150, t151, t154, t156, t159, t161, t162;
  double t163, t166, t167, t169, t174, t175, t176, t177;
  double t178, t181, t184, t185, t186, t191, t193, t194;
  double t198, t199, t200, t201, t202, t205, t206, t207;
  double t212, t217, tv2rho20, t223, t225, t226, t231, t240;
  double t247, t249, t250, t255, t256, t257, t258, t261;
  double t266, t271, tv2rhosigma0, t274, t275, t277, t278, t279;
  double t284, t285, t286, t287, t294, t295, t298, t299;
  double t306, t316, t320, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = pow(t32, 0.2626712e1);
  t35 = 0.1e1 + 0.13471619689594796103e-3 * t33;
  t36 = pow(t35, -0.657946e0);
  t39 = pow(t32, 0.3217063e1);
  t41 = pow(t32, 0.3223476e1);
  t43 = 0.1e1 - 0.45212413010769857073e-1 * t39 + 0.45402221956620378581e-1 * t41;
  t44 = pow(t32, 0.3473804e1);
  t46 = 0.1e1 + 0.47702180224903349918e-3 * t44;
  t47 = 0.1e1 / t46;
  t49 = 0.60146019220211109872e-4 * t33 * t36 + t43 * t47;
  t53 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t49);
  tzk0 = 0.2e1 * t53;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t54 = t18 * t18;
  t56 = t17 / t54;
  t60 = pow(t32, 0.1626712e1);
  t62 = t60 * t36 * t21;
  t63 = t24 * t26;
  t64 = rho[0] * rho[0];
  t66 = 0.1e1 / t18 / t64;
  t67 = t27 * t66;
  t68 = t63 * t67;
  t71 = pow(t32, 0.4253424e1);
  t72 = pow(t35, -0.1657946e1);
  t74 = t71 * t72 * t21;
  t77 = pow(t32, 0.2217063e1);
  t79 = t77 * t21 * t24;
  t80 = t28 * t66;
  t83 = pow(t32, 0.2223476e1);
  t85 = t83 * t21 * t24;
  t88 = 0.19393490805022174494e0 * t79 * t80 - 0.19513729709845177529e0 * t85 * t80;
  t90 = t46 * t46;
  t91 = 0.1e1 / t90;
  t92 = t43 * t91;
  t93 = pow(t32, 0.2473804e1);
  t94 = t93 * t21;
  t95 = t92 * t94;
  t98 = -0.21064836058394555311e-3 * t62 * t68 + 0.18671024483029835192e-7 * t74 * t68 + t88 * t47 + 0.22094403263198687541e-2 * t95 * t68;
  t103 = my_piecewise3(t2, 0, -t6 * t56 * t49 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t98);
  tvrho0 = 0.2e1 * rho[0] * t103 + 0.2e1 * t53;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t106 = 0.1e1 / t26;
  t107 = t24 * t106;
  t108 = t27 * t30;
  t109 = t107 * t108;
  t114 = t106 * t27;
  t115 = t114 * t30;
  t120 = -0.72725590518833154352e-1 * t79 * t115 + 0.73176486411919415733e-1 * t85 * t115;
  t124 = 0.78993135218979582417e-4 * t62 * t109 - 0.7001634181136188197e-8 * t74 * t109 + t120 * t47 - 0.82854012236995078279e-3 * t95 * t109;
  t128 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t124);
  tvsigma0 = 0.2e1 * rho[0] * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t133 = t17 / t54 / rho[0];
  t140 = pow(t32, 0.626712e0);
  t142 = t140 * t36 * t20;
  t143 = t23 * t23;
  t144 = 0.1e1 / t143;
  t145 = t144 * sigma[0];
  t146 = t27 * t27;
  t147 = t64 * t64;
  t149 = 0.1e1 / t54 / t147;
  t150 = t146 * t149;
  t151 = t145 * t150;
  t154 = pow(t32, 0.3253424e1);
  t156 = t154 * t72 * t20;
  t159 = t64 * rho[0];
  t161 = 0.1e1 / t18 / t159;
  t162 = t27 * t161;
  t163 = t63 * t162;
  t166 = pow(t32, 0.5880136e1);
  t167 = pow(t35, -0.2657946e1);
  t169 = t166 * t167 * t20;
  t174 = pow(t32, 0.1217063e1);
  t175 = t174 * t20;
  t176 = t175 * t144;
  t177 = sigma[0] * t146;
  t178 = t177 * t149;
  t181 = t28 * t161;
  t184 = pow(t32, 0.1223476e1);
  t185 = t184 * t20;
  t186 = t185 * t144;
  t191 = -0.343972727237239018e1 * t176 * t178 - 0.45251478545051740486e0 * t79 * t181 + 0.34710647744262172761e1 * t186 * t178 + 0.45532035989638747568e0 * t85 * t181;
  t193 = t88 * t91;
  t194 = t193 * t94;
  t198 = 0.1e1 / t90 / t46;
  t199 = t43 * t198;
  t200 = pow(t32, 0.4947608e1);
  t201 = t200 * t20;
  t202 = t199 * t201;
  t205 = pow(t32, 0.1473804e1);
  t206 = t205 * t20;
  t207 = t92 * t206;
  t212 = 0.27413137275378499087e-2 * t142 * t151 - 0.10276735016205996654e-5 * t156 * t151 + 0.49151284136253962392e-3 * t62 * t163 + 0.87631609607945203792e-10 * t169 * t151 - 0.43565723793736282115e-7 * t74 * t163 + t191 * t47 + 0.44188806526397375082e-2 * t194 * t68 + 0.58579518666821377499e-4 * t202 * t151 - 0.43725778536091172827e-1 * t207 * t151 - 0.51553607614130270929e-2 * t95 * t163;
  t217 = my_piecewise3(t2, 0, t6 * t133 * t49 / 0.12e2 - t6 * t56 * t98 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t212);
  tv2rho20 = 0.2e1 * rho[0] * t217 + 0.4e1 * t103;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t223 = t144 * t146;
  t225 = 0.1e1 / t54 / t159;
  t226 = t223 * t225;
  t231 = t107 * t67;
  t240 = t114 * t66;
  t247 = 0.12898977271396463175e1 * t175 * t226 + 0.96967454025110872469e-1 * t79 * t240 - 0.13016492904098314785e1 * t185 * t226 - 0.97568648549225887644e-1 * t85 * t240;
  t249 = t120 * t91;
  t250 = t249 * t94;
  t255 = t199 * t200;
  t256 = t20 * t144;
  t257 = t146 * t225;
  t258 = t256 * t257;
  t261 = t92 * t205;
  t266 = -0.10279926478266937158e-2 * t142 * t226 + 0.38537756310772487454e-6 * t156 * t226 - 0.10532418029197277656e-3 * t62 * t231 - 0.32861853602979451422e-10 * t169 * t226 + 0.9335512241514917596e-8 * t74 * t231 + t247 * t47 + 0.22094403263198687541e-2 * t250 * t68 - 0.82854012236995078279e-3 * t194 * t109 - 0.21967319500058016562e-4 * t255 * t258 + 0.1639716695103418981e-1 * t261 * t258 + 0.11047201631599343771e-2 * t95 * t231;
  t271 = my_piecewise3(t2, 0, -t6 * t56 * t124 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t266);
  tv2rhosigma0 = 0.2e1 * rho[0] * t271 + 0.2e1 * t128;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t274 = 0.1e1 / sigma[0];
  t275 = t144 * t274;
  t277 = 0.1e1 / t54 / t64;
  t278 = t146 * t277;
  t279 = t275 * t278;
  t284 = t26 * sigma[0];
  t285 = 0.1e1 / t284;
  t286 = t24 * t285;
  t287 = t286 * t108;
  t294 = t274 * t146;
  t295 = t294 * t277;
  t298 = t285 * t27;
  t299 = t298 * t30;
  t306 = -0.48371164767736736906e0 * t176 * t295 + 0.36362795259416577176e-1 * t79 * t299 + 0.48811848390368680445e0 * t186 * t295 - 0.36588243205959707866e-1 * t85 * t299;
  t316 = 0.38549724293501014342e-3 * t142 * t279 - 0.14451658616539682796e-6 * t156 * t279 - 0.39496567609489791208e-4 * t62 * t287 + 0.12323195101117294284e-10 * t169 * t279 + 0.35008170905680940985e-8 * t74 * t287 + t306 * t47 - 0.16570802447399015656e-2 * t250 * t109 + 0.82377448125217562105e-5 * t202 * t279 - 0.61489376066378211788e-2 * t207 * t279 + 0.4142700611849753914e-3 * t95 * t287;
  t320 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t316);
  tv2sigma20 = 0.2e1 * rho[0] * t320;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t32;
  double t33, t35, t36, t39, t41, t43, t44, t46;
  double t47, t49, t53, tzk0;

  double t54, t56, t60, t62, t63, t64, t66, t67;
  double t68, t71, t72, t74, t77, t79, t80, t83;
  double t85, t88, t90, t91, t92, t93, t94, t95;
  double t98, t103, tvrho0, t106, t107, t108, t109, t114;
  double t115, t120, t124, t128, tvsigma0;

  double t133, t140, t142, t143, t144, t145, t146, t147;
  double t149, t150, t151, t154, t156, t159, t161, t162;
  double t163, t166, t167, t169, t174, t175, t176, t177;
  double t178, t181, t184, t185, t186, t191, t193, t194;
  double t198, t199, t200, t201, t202, t205, t206, t207;
  double t212, t217, tv2rho20, t223, t225, t226, t231, t240;
  double t247, t249, t250, t255, t256, t257, t258, t261;
  double t266, t271, tv2rhosigma0, t274, t275, t277, t278, t279;
  double t284, t285, t286, t287, t294, t295, t298, t299;
  double t306, t316, t320, tv2sigma20;

  double t323, t333, t334, t335, t336, t337, t338, t339;
  double t342, t343, t346, t347, t348, t351, t353, t354;
  double t358, t359, t362, t363, t370, t372, t375, t376;
  double t379, t380, t383, t384, t387, t388, t397, t406;
  double t407, t408, t409, t410, t411, t414, t415, t418;
  double t419, t422, t423, t426, t427, t434, t435, t436;
  double t439, t440, t445, tv3rho30, t455, t456, t458, t466;
  double t470, t473, t476, t479, t488, t490, t495, t496;
  double t499, t506, t507, t510, t521, t524, t527, t542;
  double t543, t548, tv3rho2sigma0, t554, t559, t562, t565, t572;
  double t573, t576, t579, t588, t590, t591, t594, t595;
  double t598, t599, t606, t607, t608, t637, t638, t643;
  double tv3rhosigma20, t646, t647, t650, t651, t652, t653, t657;
  double t658, t659, t668, t670, t671, t676, t677, t680;
  double t681, t696, t706, t715, t716, t725, t726, t730;
  double tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = pow(t32, 0.2626712e1);
  t35 = 0.1e1 + 0.13471619689594796103e-3 * t33;
  t36 = pow(t35, -0.657946e0);
  t39 = pow(t32, 0.3217063e1);
  t41 = pow(t32, 0.3223476e1);
  t43 = 0.1e1 - 0.45212413010769857073e-1 * t39 + 0.45402221956620378581e-1 * t41;
  t44 = pow(t32, 0.3473804e1);
  t46 = 0.1e1 + 0.47702180224903349918e-3 * t44;
  t47 = 0.1e1 / t46;
  t49 = 0.60146019220211109872e-4 * t33 * t36 + t43 * t47;
  t53 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t49);
  tzk0 = 0.2e1 * t53;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t54 = t18 * t18;
  t56 = t17 / t54;
  t60 = pow(t32, 0.1626712e1);
  t62 = t60 * t36 * t21;
  t63 = t24 * t26;
  t64 = rho[0] * rho[0];
  t66 = 0.1e1 / t18 / t64;
  t67 = t27 * t66;
  t68 = t63 * t67;
  t71 = pow(t32, 0.4253424e1);
  t72 = pow(t35, -0.1657946e1);
  t74 = t71 * t72 * t21;
  t77 = pow(t32, 0.2217063e1);
  t79 = t77 * t21 * t24;
  t80 = t28 * t66;
  t83 = pow(t32, 0.2223476e1);
  t85 = t83 * t21 * t24;
  t88 = 0.19393490805022174494e0 * t79 * t80 - 0.19513729709845177529e0 * t85 * t80;
  t90 = t46 * t46;
  t91 = 0.1e1 / t90;
  t92 = t43 * t91;
  t93 = pow(t32, 0.2473804e1);
  t94 = t93 * t21;
  t95 = t92 * t94;
  t98 = -0.21064836058394555311e-3 * t62 * t68 + 0.18671024483029835192e-7 * t74 * t68 + t88 * t47 + 0.22094403263198687541e-2 * t95 * t68;
  t103 = my_piecewise3(t2, 0, -t6 * t56 * t49 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t98);
  tvrho0 = 0.2e1 * rho[0] * t103 + 0.2e1 * t53;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t106 = 0.1e1 / t26;
  t107 = t24 * t106;
  t108 = t27 * t30;
  t109 = t107 * t108;
  t114 = t106 * t27;
  t115 = t114 * t30;
  t120 = -0.72725590518833154352e-1 * t79 * t115 + 0.73176486411919415733e-1 * t85 * t115;
  t124 = 0.78993135218979582417e-4 * t62 * t109 - 0.7001634181136188197e-8 * t74 * t109 + t120 * t47 - 0.82854012236995078279e-3 * t95 * t109;
  t128 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t124);
  tvsigma0 = 0.2e1 * rho[0] * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t133 = t17 / t54 / rho[0];
  t140 = pow(t32, 0.626712e0);
  t142 = t140 * t36 * t20;
  t143 = t23 * t23;
  t144 = 0.1e1 / t143;
  t145 = t144 * sigma[0];
  t146 = t27 * t27;
  t147 = t64 * t64;
  t149 = 0.1e1 / t54 / t147;
  t150 = t146 * t149;
  t151 = t145 * t150;
  t154 = pow(t32, 0.3253424e1);
  t156 = t154 * t72 * t20;
  t159 = t64 * rho[0];
  t161 = 0.1e1 / t18 / t159;
  t162 = t27 * t161;
  t163 = t63 * t162;
  t166 = pow(t32, 0.5880136e1);
  t167 = pow(t35, -0.2657946e1);
  t169 = t166 * t167 * t20;
  t174 = pow(t32, 0.1217063e1);
  t175 = t174 * t20;
  t176 = t175 * t144;
  t177 = sigma[0] * t146;
  t178 = t177 * t149;
  t181 = t28 * t161;
  t184 = pow(t32, 0.1223476e1);
  t185 = t184 * t20;
  t186 = t185 * t144;
  t191 = -0.343972727237239018e1 * t176 * t178 - 0.45251478545051740486e0 * t79 * t181 + 0.34710647744262172761e1 * t186 * t178 + 0.45532035989638747568e0 * t85 * t181;
  t193 = t88 * t91;
  t194 = t193 * t94;
  t198 = 0.1e1 / t90 / t46;
  t199 = t43 * t198;
  t200 = pow(t32, 0.4947608e1);
  t201 = t200 * t20;
  t202 = t199 * t201;
  t205 = pow(t32, 0.1473804e1);
  t206 = t205 * t20;
  t207 = t92 * t206;
  t212 = 0.27413137275378499087e-2 * t142 * t151 - 0.10276735016205996654e-5 * t156 * t151 + 0.49151284136253962392e-3 * t62 * t163 + 0.87631609607945203792e-10 * t169 * t151 - 0.43565723793736282115e-7 * t74 * t163 + t191 * t47 + 0.44188806526397375082e-2 * t194 * t68 + 0.58579518666821377499e-4 * t202 * t151 - 0.43725778536091172827e-1 * t207 * t151 - 0.51553607614130270929e-2 * t95 * t163;
  t217 = my_piecewise3(t2, 0, t6 * t133 * t49 / 0.12e2 - t6 * t56 * t98 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t212);
  tv2rho20 = 0.2e1 * rho[0] * t217 + 0.4e1 * t103;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t223 = t144 * t146;
  t225 = 0.1e1 / t54 / t159;
  t226 = t223 * t225;
  t231 = t107 * t67;
  t240 = t114 * t66;
  t247 = 0.12898977271396463175e1 * t175 * t226 + 0.96967454025110872469e-1 * t79 * t240 - 0.13016492904098314785e1 * t185 * t226 - 0.97568648549225887644e-1 * t85 * t240;
  t249 = t120 * t91;
  t250 = t249 * t94;
  t255 = t199 * t200;
  t256 = t20 * t144;
  t257 = t146 * t225;
  t258 = t256 * t257;
  t261 = t92 * t205;
  t266 = -0.10279926478266937158e-2 * t142 * t226 + 0.38537756310772487454e-6 * t156 * t226 - 0.10532418029197277656e-3 * t62 * t231 - 0.32861853602979451422e-10 * t169 * t226 + 0.9335512241514917596e-8 * t74 * t231 + t247 * t47 + 0.22094403263198687541e-2 * t250 * t68 - 0.82854012236995078279e-3 * t194 * t109 - 0.21967319500058016562e-4 * t255 * t258 + 0.1639716695103418981e-1 * t261 * t258 + 0.11047201631599343771e-2 * t95 * t231;
  t271 = my_piecewise3(t2, 0, -t6 * t56 * t124 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t266);
  tv2rhosigma0 = 0.2e1 * rho[0] * t271 + 0.2e1 * t128;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t274 = 0.1e1 / sigma[0];
  t275 = t144 * t274;
  t277 = 0.1e1 / t54 / t64;
  t278 = t146 * t277;
  t279 = t275 * t278;
  t284 = t26 * sigma[0];
  t285 = 0.1e1 / t284;
  t286 = t24 * t285;
  t287 = t286 * t108;
  t294 = t274 * t146;
  t295 = t294 * t277;
  t298 = t285 * t27;
  t299 = t298 * t30;
  t306 = -0.48371164767736736906e0 * t176 * t295 + 0.36362795259416577176e-1 * t79 * t299 + 0.48811848390368680445e0 * t186 * t295 - 0.36588243205959707866e-1 * t85 * t299;
  t316 = 0.38549724293501014342e-3 * t142 * t279 - 0.14451658616539682796e-6 * t156 * t279 - 0.39496567609489791208e-4 * t62 * t287 + 0.12323195101117294284e-10 * t169 * t279 + 0.35008170905680940985e-8 * t74 * t287 + t306 * t47 - 0.16570802447399015656e-2 * t250 * t109 + 0.82377448125217562105e-5 * t202 * t279 - 0.61489376066378211788e-2 * t207 * t279 + 0.4142700611849753914e-3 * t95 * t287;
  t320 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t316);
  tv2sigma20 = 0.2e1 * rho[0] * t320;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t323 = t17 * t277;
  t333 = pow(t32, 0.473804e0);
  t334 = t92 * t333;
  t335 = 0.1e1 / t22;
  t336 = t335 * t284;
  t337 = t147 * t159;
  t338 = 0.1e1 / t337;
  t339 = t336 * t338;
  t342 = pow(t32, 0.3947608e1);
  t343 = t199 * t342;
  t346 = pow(t32, 0.217063e0);
  t347 = t346 * t335;
  t348 = t284 * t338;
  t351 = t147 * rho[0];
  t353 = 0.1e1 / t54 / t351;
  t354 = t177 * t353;
  t358 = 0.1e1 / t18 / t147;
  t359 = t28 * t358;
  t362 = pow(t32, 0.223476e0);
  t363 = t362 * t335;
  t370 = 0.66981836692725732954e2 * t347 * t348 + 0.2407809090660673126e2 * t176 * t354 + 0.15083826181683913495e1 * t79 * t359 - 0.67948231135294249729e2 * t363 * t348 - 0.24297453420983520933e2 * t186 * t354 - 0.15177345329879582523e1 * t85 * t359;
  t372 = t193 * t206;
  t375 = t27 * t358;
  t376 = t63 * t375;
  t379 = t191 * t91;
  t380 = t379 * t94;
  t383 = t88 * t198;
  t384 = t383 * t201;
  t387 = t146 * t353;
  t388 = t145 * t387;
  t397 = 0.1031091636953685038e1 * t334 * t339 - 0.46372559230738365102e-2 * t343 * t339 + t370 * t47 - 0.13117733560827351848e0 * t372 * t151 + 0.14521907931245427372e-6 * t74 * t376 + 0.66283209789596062623e-2 * t380 * t68 + 0.1757385560004641325e-3 * t384 * t151 - 0.19189196092764949361e-1 * t142 * t388 + 0.71937145113441976578e-5 * t156 * t388 - 0.16383761378751320797e-2 * t62 * t376 - 0.61342126725561642654e-9 * t169 * t388;
  t406 = t90 * t90;
  t407 = 0.1e1 / t406;
  t408 = t43 * t407;
  t409 = pow(t32, 0.7421412e1);
  t410 = t409 * t284;
  t411 = t410 * t338;
  t414 = t342 * t284;
  t415 = t414 * t338;
  t418 = pow(t32, -0.373288e0);
  t419 = t418 * t36;
  t422 = pow(t32, 0.2253424e1);
  t423 = t422 * t72;
  t426 = pow(t32, 0.4880136e1);
  t427 = t426 * t167;
  t434 = pow(t32, 0.7506848e1);
  t435 = pow(t35, -0.3657946e1);
  t436 = t434 * t435;
  t439 = -0.15466082284239081279e-1 * t194 * t163 - 0.4100566306677496425e-3 * t202 * t388 + 0.30608044975263820979e0 * t207 * t388 + 0.17184535871376756976e-1 * t95 * t376 + 0.47209655431432424724e-6 * t408 * t411 - 0.23492612948914137338e-3 * t199 * t415 - 0.27488227341003215872e-1 * t419 * t339 + 0.53495322149383965533e-4 * t423 * t339 - 0.82445725182979916615e-8 * t427 * t339 + 0.10346691524063492162e-5 * t423 * t348 - 0.97741286073840627267e-9 * t427 * t348 + 0.13361630313149017099e-12 * t436 * t348;
  t440 = t397 + t439;
  t445 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t323 * t49 + t6 * t133 * t98 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t56 * t212 - 0.3e1 / 0.8e1 * t6 * t19 * t440);
  tv3rho30 = 0.2e1 * rho[0] * t445 + 0.6e1 * t217;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t455 = t147 * t64;
  t456 = 0.1e1 / t455;
  t458 = t335 * t456 * t26;
  t466 = t409 * t456 * t26;
  t470 = t342 * t456 * t26;
  t473 = t456 * t26;
  t476 = t223 * t149;
  t479 = t114 * t161;
  t488 = -0.25118188759772149858e2 * t347 * t473 - 0.64494886356982315875e1 * t175 * t476 - 0.22625739272525870243e0 * t79 * t479 + 0.25480586675735343648e2 * t363 * t473 + 0.65082464520491573925e1 * t185 * t476 + 0.22766017994819373784e0 * t85 * t479;
  t490 = t249 * t206;
  t495 = t247 * t91;
  t496 = t495 * t94;
  t499 = t107 * t162;
  t506 = t120 * t198;
  t507 = t506 * t201;
  t510 = 0.10308085252876205952e-1 * t419 * t458 - 0.20060745806018987076e-4 * t423 * t458 + 0.30917146943617468731e-8 * t427 * t458 - 0.17703620786787159271e-6 * t408 * t466 + 0.88097298558428015019e-4 * t199 * t470 + t488 * t47 - 0.43725778536091172827e-1 * t490 * t151 - 0.82854012236995078279e-3 * t380 * t109 + 0.44188806526397375082e-2 * t496 * t68 - 0.25776803807065135466e-2 * t95 * t499 - 0.51553607614130270929e-2 * t250 * t163 + 0.22094403263198687542e-2 * t194 * t231 + 0.58579518666821377499e-4 * t507 * t151;
  t521 = t383 * t200;
  t524 = t193 * t205;
  t527 = t256 * t150;
  t542 = 0.17389709711526886913e-2 * t343 * t458 - 0.38665936385763188926e0 * t334 * t458 - 0.19268878155386243727e-5 * t156 * t476 + 0.16430926801489725711e-9 * t169 * t476 + 0.5139963239133468579e-2 * t142 * t476 - 0.43934639000116033124e-4 * t521 * t258 + 0.3279433390206837962e-1 * t524 * t258 + 0.10983659750029008281e-3 * t255 * t527 - 0.81985834755170949051e-1 * t261 * t527 - 0.21782861896868141057e-7 * t74 * t499 + 0.24575642068126981197e-3 * t62 * t499 - 0.38800093215238095609e-6 * t423 * t473 + 0.36652982277690235227e-9 * t427 * t473 - 0.5010611367430881412e-13 * t436 * t473;
  t543 = t510 + t542;
  t548 = my_piecewise3(t2, 0, t6 * t133 * t124 / 0.12e2 - t6 * t56 * t266 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t543);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t548 + 0.4e1 * t271;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t554 = t275 * t257;
  t559 = t286 * t67;
  t562 = t506 * t200;
  t565 = t249 * t205;
  t572 = 0.1e1 / t351;
  t573 = t106 * t572;
  t576 = t294 * t225;
  t579 = t298 * t66;
  t588 = 0.94193207849145561966e1 * t347 * t573 + 0.64494886356982315875e0 * t176 * t576 - 0.48483727012555436235e-1 * t79 * t579 - 0.95552200034007538682e1 * t363 * t573 - 0.65082464520491573924e0 * t186 * t576 + 0.48784324274612943821e-1 * t85 * t579;
  t590 = t409 * t106;
  t591 = t590 * t572;
  t594 = t342 * t106;
  t595 = t594 * t572;
  t598 = t335 * t106;
  t599 = t598 * t572;
  t606 = -0.51399632391334685792e-3 * t142 * t554 + 0.19268878155386243729e-6 * t156 * t554 + 0.52662090145986388277e-4 * t62 * t559 - 0.43934639000116033125e-4 * t562 * t258 + 0.32794333902068379621e-1 * t565 * t258 - 0.16430926801489725713e-10 * t169 * t554 - 0.4667756120757458798e-8 * t74 * t559 + t588 * t47 + 0.66388577950451847266e-7 * t408 * t591 - 0.33036486959410505632e-4 * t199 * t595 - 0.3865531969828577232e-2 * t419 * t599 + 0.75227796772571201537e-5 * t423 * t599 - 0.11593930103856550775e-8 * t427 * t599;
  t607 = t306 * t91;
  t608 = t607 * t94;
  t637 = 0.22094403263198687541e-2 * t608 * t68 - 0.16570802447399015656e-2 * t496 * t109 + 0.22094403263198687541e-2 * t250 * t231 - 0.1098365975002900828e-4 * t202 * t554 + 0.81985834755170949048e-2 * t207 * t554 - 0.55236008157996718853e-3 * t95 * t559 + 0.82377448125217562105e-5 * t384 * t279 - 0.61489376066378211788e-2 * t372 * t279 + 0.4142700611849753914e-3 * t194 * t287 + 0.14499726144661195847e0 * t334 * t599 - 0.65211411418225825922e-3 * t343 * t599 + 0.14550034955714285853e-6 * t423 * t573 - 0.13744868354133838211e-9 * t427 * t573 + 0.18789792627865805296e-13 * t436 * t573;
  t638 = t606 + t637;
  t643 = my_piecewise3(t2, 0, -t6 * t56 * t316 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t638);
  tv3rhosigma20 = 0.2e1 * rho[0] * t643 + 0.2e1 * t320;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t646 = 0.1e1 / t147;
  t647 = t285 * t646;
  t650 = sigma[0] * sigma[0];
  t651 = 0.1e1 / t650;
  t652 = t651 * t146;
  t653 = t652 * t277;
  t657 = 0.1e1 / t26 / t650;
  t658 = t657 * t27;
  t659 = t658 * t30;
  t668 = -0.35322452943429585737e1 * t347 * t647 + 0.72556747151605105359e0 * t176 * t653 - 0.54544192889124865764e-1 * t79 * t659 + 0.35832075012752827006e1 * t363 * t647 - 0.73217772585553020667e0 * t186 * t653 + 0.54882364808939561799e-1 * t85 * t659;
  t670 = t335 * t285;
  t671 = t670 * t646;
  t676 = t144 * t651;
  t677 = t676 * t278;
  t680 = t24 * t657;
  t681 = t680 * t108;
  t696 = t668 * t47 - 0.54373973042479484428e-1 * t334 * t671 + 0.24454279281834684721e-3 * t343 * t671 + 0.92234064099567317682e-2 * t207 * t677 - 0.6214050917774630871e-3 * t95 * t681 + 0.12428101835549261742e-2 * t250 * t287 - 0.12356617218782634316e-4 * t202 * t677 + 0.24713234437565268632e-4 * t507 * t279 - 0.18446812819913463537e-1 * t490 * t279 - 0.52512256358521411478e-8 * t74 * t681 - 0.24856203671098523484e-2 * t608 * t109;
  t706 = t342 * t285 * t646;
  t715 = t409 * t285;
  t716 = t715 * t646;
  t725 = -0.57824586440251521513e-3 * t142 * t677 + 0.21677487924809524194e-6 * t156 * t677 + 0.59244851414234686812e-4 * t62 * t681 - 0.18484792651675941426e-10 * t169 * t677 + 0.12388682609778939612e-4 * t199 * t706 + 0.1449574488685716462e-2 * t419 * t671 - 0.28210423789714200577e-5 * t423 * t671 + 0.43477237889462065405e-9 * t427 * t671 - 0.24895716731419442725e-7 * t408 * t716 - 0.5456263108392857195e-7 * t423 * t647 + 0.5154325632800189329e-10 * t427 * t647 - 0.70461722354496769862e-14 * t436 * t647;
  t726 = t696 + t725;
  t730 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t726);
  tv3sigma30 = 0.2e1 * rho[0] * t730;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t32;
  double t33, t35, t36, t39, t41, t43, t44, t46;
  double t47, t49, t53, tzk0;

  double t54, t56, t60, t62, t63, t64, t66, t67;
  double t68, t71, t72, t74, t77, t79, t80, t83;
  double t85, t88, t90, t91, t92, t93, t94, t95;
  double t98, t103, tvrho0, t106, t107, t108, t109, t114;
  double t115, t120, t124, t128, tvsigma0;

  double t133, t140, t142, t143, t144, t145, t146, t147;
  double t149, t150, t151, t154, t156, t159, t161, t162;
  double t163, t166, t167, t169, t174, t175, t176, t177;
  double t178, t181, t184, t185, t186, t191, t193, t194;
  double t198, t199, t200, t201, t202, t205, t206, t207;
  double t212, t217, tv2rho20, t223, t225, t226, t231, t240;
  double t247, t249, t250, t255, t256, t257, t258, t261;
  double t266, t271, tv2rhosigma0, t274, t275, t277, t278, t279;
  double t284, t285, t286, t287, t294, t295, t298, t299;
  double t306, t316, t320, tv2sigma20;

  double t323, t333, t334, t335, t336, t337, t338, t339;
  double t342, t343, t346, t347, t348, t351, t353, t354;
  double t358, t359, t362, t363, t370, t372, t375, t376;
  double t379, t380, t383, t384, t387, t388, t397, t406;
  double t407, t408, t409, t410, t411, t414, t415, t418;
  double t419, t422, t423, t426, t427, t434, t435, t436;
  double t439, t440, t445, tv3rho30, t455, t456, t458, t466;
  double t470, t473, t476, t479, t488, t490, t495, t496;
  double t499, t506, t507, t510, t521, t524, t527, t542;
  double t543, t548, tv3rho2sigma0, t554, t559, t562, t565, t572;
  double t573, t576, t579, t588, t590, t591, t594, t595;
  double t598, t599, t606, t607, t608, t637, t638, t643;
  double tv3rhosigma20, t646, t647, t650, t651, t652, t653, t657;
  double t658, t659, t668, t670, t671, t676, t677, t680;
  double t681, t696, t706, t715, t716, t725, t726, t730;
  double tv3sigma30;

  double t746, t747, t748, t755, t758, t774, t775, t779;
  double t781, t782, t785, t786, t787, t791, t792, t796;
  double t797, t802, t804, t812, t814, t819, t820, t826;
  double t829, t832, t833, t845, t846, t849, t852, t855;
  double t858, t863, t885, t886, t891, t892, t893, t903;
  double t906, t913, t915, t917, t918, t922, t925, t932;
  double tv4rho40, t946, t949, t952, t963, t966, t973, t978;
  double t1005, t1008, t1013, t1022, t1025, t1044, t1068, t1075;
  double t1087, t1093, t1096, t1097, t1109, t1114, t1121, tv4rho3sigma0;
  double t1142, t1157, t1167, t1179, t1188, t1194, t1205, t1225;
  double t1235, t1238, t1259, t1262, t1263, t1264, t1267, t1294;
  double t1301, tv4rho2sigma20, t1309, t1325, t1331, t1333, t1340, t1347;
  double t1355, t1369, t1373, t1397, t1421, t1424, t1436, t1450;
  double t1457, tv4rhosigma30, t1461, t1487, t1488, t1490, t1494, t1496;
  double t1499, t1502, t1529, t1536, t1549, t1585, t1589, t1603;
  double t1609, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = pow(t32, 0.2626712e1);
  t35 = 0.1e1 + 0.13471619689594796103e-3 * t33;
  t36 = pow(t35, -0.657946e0);
  t39 = pow(t32, 0.3217063e1);
  t41 = pow(t32, 0.3223476e1);
  t43 = 0.1e1 - 0.45212413010769857073e-1 * t39 + 0.45402221956620378581e-1 * t41;
  t44 = pow(t32, 0.3473804e1);
  t46 = 0.1e1 + 0.47702180224903349918e-3 * t44;
  t47 = 0.1e1 / t46;
  t49 = 0.60146019220211109872e-4 * t33 * t36 + t43 * t47;
  t53 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t49);
  tzk0 = 0.2e1 * t53;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t54 = t18 * t18;
  t56 = t17 / t54;
  t60 = pow(t32, 0.1626712e1);
  t62 = t60 * t36 * t21;
  t63 = t24 * t26;
  t64 = rho[0] * rho[0];
  t66 = 0.1e1 / t18 / t64;
  t67 = t27 * t66;
  t68 = t63 * t67;
  t71 = pow(t32, 0.4253424e1);
  t72 = pow(t35, -0.1657946e1);
  t74 = t71 * t72 * t21;
  t77 = pow(t32, 0.2217063e1);
  t79 = t77 * t21 * t24;
  t80 = t28 * t66;
  t83 = pow(t32, 0.2223476e1);
  t85 = t83 * t21 * t24;
  t88 = 0.19393490805022174494e0 * t79 * t80 - 0.19513729709845177529e0 * t85 * t80;
  t90 = t46 * t46;
  t91 = 0.1e1 / t90;
  t92 = t43 * t91;
  t93 = pow(t32, 0.2473804e1);
  t94 = t93 * t21;
  t95 = t92 * t94;
  t98 = -0.21064836058394555311e-3 * t62 * t68 + 0.18671024483029835192e-7 * t74 * t68 + t88 * t47 + 0.22094403263198687541e-2 * t95 * t68;
  t103 = my_piecewise3(t2, 0, -t6 * t56 * t49 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t98);
  tvrho0 = 0.2e1 * rho[0] * t103 + 0.2e1 * t53;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t106 = 0.1e1 / t26;
  t107 = t24 * t106;
  t108 = t27 * t30;
  t109 = t107 * t108;
  t114 = t106 * t27;
  t115 = t114 * t30;
  t120 = -0.72725590518833154352e-1 * t79 * t115 + 0.73176486411919415733e-1 * t85 * t115;
  t124 = 0.78993135218979582417e-4 * t62 * t109 - 0.7001634181136188197e-8 * t74 * t109 + t120 * t47 - 0.82854012236995078279e-3 * t95 * t109;
  t128 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t124);
  tvsigma0 = 0.2e1 * rho[0] * t128;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t133 = t17 / t54 / rho[0];
  t140 = pow(t32, 0.626712e0);
  t142 = t140 * t36 * t20;
  t143 = t23 * t23;
  t144 = 0.1e1 / t143;
  t145 = t144 * sigma[0];
  t146 = t27 * t27;
  t147 = t64 * t64;
  t149 = 0.1e1 / t54 / t147;
  t150 = t146 * t149;
  t151 = t145 * t150;
  t154 = pow(t32, 0.3253424e1);
  t156 = t154 * t72 * t20;
  t159 = t64 * rho[0];
  t161 = 0.1e1 / t18 / t159;
  t162 = t27 * t161;
  t163 = t63 * t162;
  t166 = pow(t32, 0.5880136e1);
  t167 = pow(t35, -0.2657946e1);
  t169 = t166 * t167 * t20;
  t174 = pow(t32, 0.1217063e1);
  t175 = t174 * t20;
  t176 = t175 * t144;
  t177 = sigma[0] * t146;
  t178 = t177 * t149;
  t181 = t28 * t161;
  t184 = pow(t32, 0.1223476e1);
  t185 = t184 * t20;
  t186 = t185 * t144;
  t191 = -0.343972727237239018e1 * t176 * t178 - 0.45251478545051740486e0 * t79 * t181 + 0.34710647744262172761e1 * t186 * t178 + 0.45532035989638747568e0 * t85 * t181;
  t193 = t88 * t91;
  t194 = t193 * t94;
  t198 = 0.1e1 / t90 / t46;
  t199 = t43 * t198;
  t200 = pow(t32, 0.4947608e1);
  t201 = t200 * t20;
  t202 = t199 * t201;
  t205 = pow(t32, 0.1473804e1);
  t206 = t205 * t20;
  t207 = t92 * t206;
  t212 = 0.27413137275378499087e-2 * t142 * t151 - 0.10276735016205996654e-5 * t156 * t151 + 0.49151284136253962392e-3 * t62 * t163 + 0.87631609607945203792e-10 * t169 * t151 - 0.43565723793736282115e-7 * t74 * t163 + t191 * t47 + 0.44188806526397375082e-2 * t194 * t68 + 0.58579518666821377499e-4 * t202 * t151 - 0.43725778536091172827e-1 * t207 * t151 - 0.51553607614130270929e-2 * t95 * t163;
  t217 = my_piecewise3(t2, 0, t6 * t133 * t49 / 0.12e2 - t6 * t56 * t98 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t212);
  tv2rho20 = 0.2e1 * rho[0] * t217 + 0.4e1 * t103;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t223 = t144 * t146;
  t225 = 0.1e1 / t54 / t159;
  t226 = t223 * t225;
  t231 = t107 * t67;
  t240 = t114 * t66;
  t247 = 0.12898977271396463175e1 * t175 * t226 + 0.96967454025110872469e-1 * t79 * t240 - 0.13016492904098314785e1 * t185 * t226 - 0.97568648549225887644e-1 * t85 * t240;
  t249 = t120 * t91;
  t250 = t249 * t94;
  t255 = t199 * t200;
  t256 = t20 * t144;
  t257 = t146 * t225;
  t258 = t256 * t257;
  t261 = t92 * t205;
  t266 = -0.10279926478266937158e-2 * t142 * t226 + 0.38537756310772487454e-6 * t156 * t226 - 0.10532418029197277656e-3 * t62 * t231 - 0.32861853602979451422e-10 * t169 * t226 + 0.9335512241514917596e-8 * t74 * t231 + t247 * t47 + 0.22094403263198687541e-2 * t250 * t68 - 0.82854012236995078279e-3 * t194 * t109 - 0.21967319500058016562e-4 * t255 * t258 + 0.1639716695103418981e-1 * t261 * t258 + 0.11047201631599343771e-2 * t95 * t231;
  t271 = my_piecewise3(t2, 0, -t6 * t56 * t124 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t266);
  tv2rhosigma0 = 0.2e1 * rho[0] * t271 + 0.2e1 * t128;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t274 = 0.1e1 / sigma[0];
  t275 = t144 * t274;
  t277 = 0.1e1 / t54 / t64;
  t278 = t146 * t277;
  t279 = t275 * t278;
  t284 = t26 * sigma[0];
  t285 = 0.1e1 / t284;
  t286 = t24 * t285;
  t287 = t286 * t108;
  t294 = t274 * t146;
  t295 = t294 * t277;
  t298 = t285 * t27;
  t299 = t298 * t30;
  t306 = -0.48371164767736736906e0 * t176 * t295 + 0.36362795259416577176e-1 * t79 * t299 + 0.48811848390368680445e0 * t186 * t295 - 0.36588243205959707866e-1 * t85 * t299;
  t316 = 0.38549724293501014342e-3 * t142 * t279 - 0.14451658616539682796e-6 * t156 * t279 - 0.39496567609489791208e-4 * t62 * t287 + 0.12323195101117294284e-10 * t169 * t279 + 0.35008170905680940985e-8 * t74 * t287 + t306 * t47 - 0.16570802447399015656e-2 * t250 * t109 + 0.82377448125217562105e-5 * t202 * t279 - 0.61489376066378211788e-2 * t207 * t279 + 0.4142700611849753914e-3 * t95 * t287;
  t320 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t316);
  tv2sigma20 = 0.2e1 * rho[0] * t320;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t323 = t17 * t277;
  t333 = pow(t32, 0.473804e0);
  t334 = t92 * t333;
  t335 = 0.1e1 / t22;
  t336 = t335 * t284;
  t337 = t147 * t159;
  t338 = 0.1e1 / t337;
  t339 = t336 * t338;
  t342 = pow(t32, 0.3947608e1);
  t343 = t199 * t342;
  t346 = pow(t32, 0.217063e0);
  t347 = t346 * t335;
  t348 = t284 * t338;
  t351 = t147 * rho[0];
  t353 = 0.1e1 / t54 / t351;
  t354 = t177 * t353;
  t358 = 0.1e1 / t18 / t147;
  t359 = t28 * t358;
  t362 = pow(t32, 0.223476e0);
  t363 = t362 * t335;
  t370 = 0.66981836692725732954e2 * t347 * t348 + 0.2407809090660673126e2 * t176 * t354 + 0.15083826181683913495e1 * t79 * t359 - 0.67948231135294249729e2 * t363 * t348 - 0.24297453420983520933e2 * t186 * t354 - 0.15177345329879582523e1 * t85 * t359;
  t372 = t193 * t206;
  t375 = t27 * t358;
  t376 = t63 * t375;
  t379 = t191 * t91;
  t380 = t379 * t94;
  t383 = t88 * t198;
  t384 = t383 * t201;
  t387 = t146 * t353;
  t388 = t145 * t387;
  t397 = 0.1031091636953685038e1 * t334 * t339 - 0.46372559230738365102e-2 * t343 * t339 + t370 * t47 - 0.13117733560827351848e0 * t372 * t151 + 0.14521907931245427372e-6 * t74 * t376 + 0.66283209789596062623e-2 * t380 * t68 + 0.1757385560004641325e-3 * t384 * t151 - 0.19189196092764949361e-1 * t142 * t388 + 0.71937145113441976578e-5 * t156 * t388 - 0.16383761378751320797e-2 * t62 * t376 - 0.61342126725561642654e-9 * t169 * t388;
  t406 = t90 * t90;
  t407 = 0.1e1 / t406;
  t408 = t43 * t407;
  t409 = pow(t32, 0.7421412e1);
  t410 = t409 * t284;
  t411 = t410 * t338;
  t414 = t342 * t284;
  t415 = t414 * t338;
  t418 = pow(t32, -0.373288e0);
  t419 = t418 * t36;
  t422 = pow(t32, 0.2253424e1);
  t423 = t422 * t72;
  t426 = pow(t32, 0.4880136e1);
  t427 = t426 * t167;
  t434 = pow(t32, 0.7506848e1);
  t435 = pow(t35, -0.3657946e1);
  t436 = t434 * t435;
  t439 = -0.15466082284239081279e-1 * t194 * t163 - 0.4100566306677496425e-3 * t202 * t388 + 0.30608044975263820979e0 * t207 * t388 + 0.17184535871376756976e-1 * t95 * t376 + 0.47209655431432424724e-6 * t408 * t411 - 0.23492612948914137338e-3 * t199 * t415 - 0.27488227341003215872e-1 * t419 * t339 + 0.53495322149383965533e-4 * t423 * t339 - 0.82445725182979916615e-8 * t427 * t339 + 0.10346691524063492162e-5 * t423 * t348 - 0.97741286073840627267e-9 * t427 * t348 + 0.13361630313149017099e-12 * t436 * t348;
  t440 = t397 + t439;
  t445 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t323 * t49 + t6 * t133 * t98 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t56 * t212 - 0.3e1 / 0.8e1 * t6 * t19 * t440);
  tv3rho30 = 0.2e1 * rho[0] * t445 + 0.6e1 * t217;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t455 = t147 * t64;
  t456 = 0.1e1 / t455;
  t458 = t335 * t456 * t26;
  t466 = t409 * t456 * t26;
  t470 = t342 * t456 * t26;
  t473 = t456 * t26;
  t476 = t223 * t149;
  t479 = t114 * t161;
  t488 = -0.25118188759772149858e2 * t347 * t473 - 0.64494886356982315875e1 * t175 * t476 - 0.22625739272525870243e0 * t79 * t479 + 0.25480586675735343648e2 * t363 * t473 + 0.65082464520491573925e1 * t185 * t476 + 0.22766017994819373784e0 * t85 * t479;
  t490 = t249 * t206;
  t495 = t247 * t91;
  t496 = t495 * t94;
  t499 = t107 * t162;
  t506 = t120 * t198;
  t507 = t506 * t201;
  t510 = 0.10308085252876205952e-1 * t419 * t458 - 0.20060745806018987076e-4 * t423 * t458 + 0.30917146943617468731e-8 * t427 * t458 - 0.17703620786787159271e-6 * t408 * t466 + 0.88097298558428015019e-4 * t199 * t470 + t488 * t47 - 0.43725778536091172827e-1 * t490 * t151 - 0.82854012236995078279e-3 * t380 * t109 + 0.44188806526397375082e-2 * t496 * t68 - 0.25776803807065135466e-2 * t95 * t499 - 0.51553607614130270929e-2 * t250 * t163 + 0.22094403263198687542e-2 * t194 * t231 + 0.58579518666821377499e-4 * t507 * t151;
  t521 = t383 * t200;
  t524 = t193 * t205;
  t527 = t256 * t150;
  t542 = 0.17389709711526886913e-2 * t343 * t458 - 0.38665936385763188926e0 * t334 * t458 - 0.19268878155386243727e-5 * t156 * t476 + 0.16430926801489725711e-9 * t169 * t476 + 0.5139963239133468579e-2 * t142 * t476 - 0.43934639000116033124e-4 * t521 * t258 + 0.3279433390206837962e-1 * t524 * t258 + 0.10983659750029008281e-3 * t255 * t527 - 0.81985834755170949051e-1 * t261 * t527 - 0.21782861896868141057e-7 * t74 * t499 + 0.24575642068126981197e-3 * t62 * t499 - 0.38800093215238095609e-6 * t423 * t473 + 0.36652982277690235227e-9 * t427 * t473 - 0.5010611367430881412e-13 * t436 * t473;
  t543 = t510 + t542;
  t548 = my_piecewise3(t2, 0, t6 * t133 * t124 / 0.12e2 - t6 * t56 * t266 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t543);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t548 + 0.4e1 * t271;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t554 = t275 * t257;
  t559 = t286 * t67;
  t562 = t506 * t200;
  t565 = t249 * t205;
  t572 = 0.1e1 / t351;
  t573 = t106 * t572;
  t576 = t294 * t225;
  t579 = t298 * t66;
  t588 = 0.94193207849145561966e1 * t347 * t573 + 0.64494886356982315875e0 * t176 * t576 - 0.48483727012555436235e-1 * t79 * t579 - 0.95552200034007538682e1 * t363 * t573 - 0.65082464520491573924e0 * t186 * t576 + 0.48784324274612943821e-1 * t85 * t579;
  t590 = t409 * t106;
  t591 = t590 * t572;
  t594 = t342 * t106;
  t595 = t594 * t572;
  t598 = t335 * t106;
  t599 = t598 * t572;
  t606 = -0.51399632391334685792e-3 * t142 * t554 + 0.19268878155386243729e-6 * t156 * t554 + 0.52662090145986388277e-4 * t62 * t559 - 0.43934639000116033125e-4 * t562 * t258 + 0.32794333902068379621e-1 * t565 * t258 - 0.16430926801489725713e-10 * t169 * t554 - 0.4667756120757458798e-8 * t74 * t559 + t588 * t47 + 0.66388577950451847266e-7 * t408 * t591 - 0.33036486959410505632e-4 * t199 * t595 - 0.3865531969828577232e-2 * t419 * t599 + 0.75227796772571201537e-5 * t423 * t599 - 0.11593930103856550775e-8 * t427 * t599;
  t607 = t306 * t91;
  t608 = t607 * t94;
  t637 = 0.22094403263198687541e-2 * t608 * t68 - 0.16570802447399015656e-2 * t496 * t109 + 0.22094403263198687541e-2 * t250 * t231 - 0.1098365975002900828e-4 * t202 * t554 + 0.81985834755170949048e-2 * t207 * t554 - 0.55236008157996718853e-3 * t95 * t559 + 0.82377448125217562105e-5 * t384 * t279 - 0.61489376066378211788e-2 * t372 * t279 + 0.4142700611849753914e-3 * t194 * t287 + 0.14499726144661195847e0 * t334 * t599 - 0.65211411418225825922e-3 * t343 * t599 + 0.14550034955714285853e-6 * t423 * t573 - 0.13744868354133838211e-9 * t427 * t573 + 0.18789792627865805296e-13 * t436 * t573;
  t638 = t606 + t637;
  t643 = my_piecewise3(t2, 0, -t6 * t56 * t316 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t638);
  tv3rhosigma20 = 0.2e1 * rho[0] * t643 + 0.2e1 * t320;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t646 = 0.1e1 / t147;
  t647 = t285 * t646;
  t650 = sigma[0] * sigma[0];
  t651 = 0.1e1 / t650;
  t652 = t651 * t146;
  t653 = t652 * t277;
  t657 = 0.1e1 / t26 / t650;
  t658 = t657 * t27;
  t659 = t658 * t30;
  t668 = -0.35322452943429585737e1 * t347 * t647 + 0.72556747151605105359e0 * t176 * t653 - 0.54544192889124865764e-1 * t79 * t659 + 0.35832075012752827006e1 * t363 * t647 - 0.73217772585553020667e0 * t186 * t653 + 0.54882364808939561799e-1 * t85 * t659;
  t670 = t335 * t285;
  t671 = t670 * t646;
  t676 = t144 * t651;
  t677 = t676 * t278;
  t680 = t24 * t657;
  t681 = t680 * t108;
  t696 = t668 * t47 - 0.54373973042479484428e-1 * t334 * t671 + 0.24454279281834684721e-3 * t343 * t671 + 0.92234064099567317682e-2 * t207 * t677 - 0.6214050917774630871e-3 * t95 * t681 + 0.12428101835549261742e-2 * t250 * t287 - 0.12356617218782634316e-4 * t202 * t677 + 0.24713234437565268632e-4 * t507 * t279 - 0.18446812819913463537e-1 * t490 * t279 - 0.52512256358521411478e-8 * t74 * t681 - 0.24856203671098523484e-2 * t608 * t109;
  t706 = t342 * t285 * t646;
  t715 = t409 * t285;
  t716 = t715 * t646;
  t725 = -0.57824586440251521513e-3 * t142 * t677 + 0.21677487924809524194e-6 * t156 * t677 + 0.59244851414234686812e-4 * t62 * t681 - 0.18484792651675941426e-10 * t169 * t677 + 0.12388682609778939612e-4 * t199 * t706 + 0.1449574488685716462e-2 * t419 * t671 - 0.28210423789714200577e-5 * t423 * t671 + 0.43477237889462065405e-9 * t427 * t671 - 0.24895716731419442725e-7 * t408 * t716 - 0.5456263108392857195e-7 * t423 * t647 + 0.5154325632800189329e-10 * t427 * t647 - 0.70461722354496769862e-14 * t436 * t647;
  t726 = t696 + t725;
  t730 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t726);
  tv3sigma30 = 0.2e1 * rho[0] * t730;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t746 = t147 * t147;
  t747 = 0.1e1 / t746;
  t748 = t284 * t747;
  t755 = t88 * t407;
  t758 = t336 * t747;
  t774 = pow(t32, 0.6506848e1);
  t775 = t774 * t435;
  t779 = 0.1e1 / t18 / t746 / rho[0];
  t781 = t24 * t27;
  t782 = t779 * t21 * t781;
  t785 = pow(t32, 0.913356e1);
  t786 = pow(t35, -0.4657946e1);
  t787 = t785 * t786;
  t791 = pow(t32, 0.1253424e1);
  t792 = t791 * t72;
  t796 = pow(t32, 0.3880136e1);
  t797 = t796 * t167;
  t802 = 0.1e1 / t54 / t455;
  t804 = t145 * t146 * t802;
  t812 = 0.1e1 / t18 / t351;
  t814 = t63 * t27 * t812;
  t819 = pow(t32, -0.782937e0);
  t820 = t819 * t335;
  t826 = t177 * t802;
  t829 = t28 * t812;
  t832 = pow(t32, -0.776524e0);
  t833 = t832 * t335;
  t845 = t191 * t198;
  t846 = t845 * t201;
  t849 = -0.36106901993630494324e-11 * t775 * t650 * t782 + 0.23060448538751960519e-15 * t787 * t650 * t782 - 0.39733171652466840081e-5 * t792 * t650 * t782 + 0.11409157014586578706e-7 * t797 * t650 * t782 - 0.4875739835466622857e-4 * t156 * t804 + 0.41576330336214002244e-8 * t169 * t804 + 0.13006010685096243456e0 * t142 * t804 + 0.7099629930792239012e-2 * t62 * t814 - 0.62928267702063518612e-6 * t74 * t814 + (-0.19385704557377501029e2 * t820 * t650 * t782 - 0.93774571369816026136e3 * t347 * t748 - 0.16319594947811228965e3 * t176 * t826 - 0.65363246787296958478e1 * t79 * t829 + 0.20246398534921357003e2 * t833 * t650 * t782 + 0.95127523589411949621e3 * t363 * t748 + 0.16468273985333275299e3 * t186 * t826 + 0.65768496429478190933e1 * t85 * t829) * t47 + 0.351477112000928265e-3 * t846 * t151;
  t852 = t370 * t91 * t94;
  t855 = t379 * t206;
  t858 = pow(t32, 0.2947608e1);
  t863 = pow(t32, 0.6421412e1);
  t885 = t43 / t406 / t46;
  t886 = pow(t32, 0.9895216e1);
  t891 = pow(t32, -0.1373288e1);
  t892 = t891 * t36;
  t893 = t335 * t650;
  t903 = t193 * t333;
  t906 = t383 * t342;
  t913 = pow(t32, -0.526196e0);
  t915 = t92 * t913 * t335;
  t917 = t25 * t27;
  t918 = t650 * t779 * t917;
  t922 = t199 * t858 * t335;
  t925 = -0.164022652267099857e-2 * t384 * t388 + 0.41722766600749048317e-8 * t885 * t886 * t650 * t782 - 0.13681367210224544595e-1 * t892 * t893 * t782 - 0.16073019042553788419e-3 * t792 * t893 * t782 + 0.53646180201542250447e-7 * t797 * t893 * t782 + 0.41243665478147401521e1 * t903 * t339 - 0.18549023692295346041e-1 * t906 * t339 - 0.14435282917351590532e2 * t334 * t758 + 0.64921582923033711143e-1 * t343 * t758 - 0.65138045594027171433e0 * t915 * t918 + 0.24408091439964882131e-1 * t922 * t918;
  t932 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t225 * t49 - 0.5e1 / 0.9e1 * t6 * t323 * t98 + t6 * t133 * t212 / 0.2e1 - t6 * t56 * t440 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.14485368133688889027e-4 * t423 * t748 + 0.13683780050337687817e-7 * t427 * t748 - 0.18706282438408623938e-11 * t436 * t748 + 0.18883862172572969889e-5 * t755 * t411 + 0.3848351827740450222e0 * t419 * t758 - 0.74893451009137551746e-3 * t423 * t758 - 0.93970451795656549353e-3 * t383 * t415 - 0.66093517604005394614e-5 * t408 * t410 * t747 + 0.32889658128479792274e-2 * t199 * t414 * t747 + 0.11542401525617188326e-6 * t427 * t758 + t849 + 0.88377613052794750164e-2 * t852 * t68 - 0.26235467121654703696e0 * t855 * t151 + 0.16981751167013132151e-2 * t199 * t858 * t650 * t782 - 0.93429947555919406409e-5 * t408 * t863 * t650 * t782 + 0.12243217990105528392e1 * t372 * t388 + 0.68738143485507027906e-1 * t194 * t376 + 0.27792727189703031325e-2 * t202 * t804 - 0.20745452705456589774e1 * t207 * t804 - 0.74466322109299280229e-1 * t95 * t814 - 0.30932164568478162558e-1 * t380 * t163 + t925));
  tv4rho40 = 0.2e1 * rho[0] * t932 + 0.8e1 * t445;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t946 = t335 * t338 * t26;
  t949 = t120 * t407;
  t952 = t223 * t353;
  t963 = t249 * t333;
  t966 = t506 * t342;
  t973 = t338 * t26;
  t978 = -0.11338893778163826547e0 * t419 * t946 + 0.47209655431432424724e-6 * t949 * t411 + 0.10191095557737613349e-4 * t156 * t952 - 0.86901346194545660427e-9 * t169 * t952 - 0.19128680682679575604e-1 * t343 * t946 + 0.42532530024339507819e1 * t334 * t946 - 0.27184694464750344929e-1 * t142 * t952 + 0.1031091636953685038e1 * t963 * t339 - 0.46372559230738365102e-2 * t966 * t339 - 0.11599780915728956678e1 * t903 * t458 + 0.52169129134580660739e-2 * t906 * t458 - 0.40318280505459258749e-8 * t427 * t973 + 0.55116725041739695532e-12 * t436 * t973;
  t1005 = t107 * t375;
  t1008 = t256 * t387;
  t1013 = 0.42680102536761905169e-5 * t423 * t973 - 0.23492612948914137338e-3 * t506 * t415 + 0.19473982865465875199e-5 * t408 * t409 * t338 * t26 - 0.96907028414270816521e-3 * t199 * t342 * t338 * t26 - 0.53110862360361477814e-6 * t755 * t466 + 0.26429189567528404506e-3 * t383 * t470 + 0.22066820386620885784e-3 * t423 * t946 - 0.34008861637979215604e-7 * t427 * t946 + 0.4919150085310256943e-1 * t379 * t205 * t258 - 0.65901958500174049686e-4 * t845 * t200 * t258 - 0.8191880689375660399e-3 * t62 * t1005 - 0.58091356011264532686e-3 * t255 * t1008 + 0.43361397048290413054e0 * t261 * t1008;
  t1022 = 0.1e1 / t18 / t746;
  t1025 = sigma[0] * t21 * t781;
  t1044 = t114 * t358;
  t1068 = 0.72609539656227136857e-7 * t74 * t1005 - 0.24595750426551284715e0 * t524 * t527 + 0.32950979250087024843e-3 * t521 * t527 - 0.86476682020319851943e-16 * t787 * t1022 * t1025 + 0.14899939369675065031e-5 * t792 * t1022 * t1025 - 0.42784338804699670152e-8 * t797 * t1022 * t1025 + 0.13540088247611435372e-11 * t775 * t1022 * t1025 + (0.72696392090165628861e1 * t820 * t1022 * t1025 + 0.27630007635749364844e3 * t347 * t973 + 0.34110628784359535952e2 * t175 * t952 + 0.75419130908419567477e0 * t79 * t1044 - 0.75923994505955088761e1 * t833 * t1022 * t1025 - 0.28028645343308878013e3 * t363 * t973 - 0.3442139234639332132e2 * t185 * t952 - 0.75886726649397912613e0 * t85 * t1044) * t47 + 0.17184535871376756976e-1 * t250 * t376 - 0.15466082284239081279e-1 * t496 * t163 + 0.85922679356883784887e-2 * t95 * t1005 - 0.4100566306677496425e-3 * t507 * t388 + 0.30608044975263820979e0 * t490 * t388;
  t1075 = t335 * t1022;
  t1087 = t495 * t206;
  t1093 = t488 * t91 * t94;
  t1096 = t247 * t198;
  t1097 = t1096 * t201;
  t1109 = t1022 * sigma[0] * t917;
  t1114 = 0.33141604894798031313e-2 * t380 * t231 - 0.15646037475280893119e-8 * t885 * t886 * t1022 * t1025 + 0.51305127038342042232e-2 * t892 * t1075 * t1025 + 0.60273821409576706576e-4 * t792 * t1075 * t1025 - 0.20117317575578343918e-7 * t797 * t1075 * t1025 - 0.77330411421195406397e-2 * t194 * t499 - 0.13117733560827351848e0 * t1087 * t151 - 0.82854012236995078279e-3 * t852 * t109 + 0.66283209789596062623e-2 * t1093 * t68 + 0.1757385560004641325e-3 * t1097 * t151 - 0.63681566876299245568e-3 * t199 * t858 * t1022 * t1025 + 0.35036230333469777402e-5 * t408 * t863 * t1022 * t1025 - 0.9153034289986830799e-2 * t922 * t1109 + 0.24426767097760189288e0 * t915 * t1109;
  t1121 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t323 * t124 + t6 * t133 * t266 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t56 * t543 - 0.3e1 / 0.8e1 * t6 * t19 * (t978 + t1013 + t1068 + t1114));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1121 + 0.6e1 * t548;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1142 = t598 * t456;
  t1157 = 0.1e1 / t18 / t337;
  t1167 = 0.20923108407626653567e-3 * t199 * t594 * t456 - 0.35407241573574318544e-6 * t949 * t466 + 0.17619459711685603004e-3 * t506 * t470 + 0.13277715590090369453e-6 * t755 * t591 - 0.66072973918821011264e-4 * t383 * t595 + 0.73428223991091488242e-8 * t427 * t1142 - 0.42046099368619503268e-6 * t408 * t590 * t456 + 0.24481702475580989136e-1 * t419 * t1142 - 0.47644271289295094307e-4 * t423 * t1142 + 0.41300560564876356417e-2 * t343 * t1142 - 0.91831598916187573698e0 * t334 * t1142 + 0.32428755757619944481e-16 * t787 * t1157 * t917 - 0.50775330928542882648e-12 * t775 * t1157 * t917 - 0.55874772636281493865e-6 * t792 * t1157 * t917;
  t1179 = t106 * t456;
  t1188 = t1157 * t21 * t781;
  t1194 = t275 * t150;
  t1205 = 0.16044127051762376308e-8 * t797 * t1157 * t917 + 0.28999452289322391694e0 * t903 * t599 - 0.13042282283645165184e-2 * t906 * t599 + 0.34779419423053773827e-2 * t966 * t458 - 0.77331872771526377854e0 * t963 * t458 - 0.11900201997648343354e-12 * t436 * t1179 - 0.9215022138619047707e-6 * t423 * t1179 + 0.8705083290951430867e-9 * t427 * t1179 + 0.58672640532303349194e-9 * t885 * t886 * t1188 - 0.13138586375051166526e-5 * t408 * t863 * t1188 - 0.44960715695901235371e-6 * t156 * t1194 + 0.65588667804136759242e-1 * t495 * t205 * t258 - 0.8786927800023206625e-4 * t1096 * t200 * t258 + 0.21967319500058016563e-3 * t562 * t527;
  t1225 = t286 * t162;
  t1235 = t294 * t149;
  t1238 = t298 * t161;
  t1259 = t588 * t91 * t94;
  t1262 = -0.16397166951034189811e0 * t565 * t527 + 0.38338829203476026666e-10 * t169 * t1194 + 0.23880587578612217087e-3 * t199 * t858 * t1188 - 0.19239422639378265837e-2 * t892 * t335 * t1188 - 0.22602683028591264967e-4 * t792 * t335 * t1188 + 0.75439940908418789697e-8 * t797 * t335 * t1188 + 0.11993247557978093352e-2 * t142 * t1194 - 0.12287821034063490598e-3 * t62 * t1225 + 0.10891430948434070529e-7 * t74 * t1225 + (-0.27261147033812110822e1 * t820 * t1157 * t917 - 0.59655698304458855912e2 * t347 * t1179 - 0.15048806816629207038e1 * t176 * t1235 + 0.11312869636262935121e0 * t79 * t1238 + 0.28471497939733158286e1 * t833 * t1157 * t917 + 0.60516393354871441165e2 * t363 * t1179 + 0.15185908388114700582e1 * t186 * t1235 - 0.11383008997409686892e0 * t85 * t1238) * t47 - 0.51553607614130270929e-2 * t250 * t499 - 0.91600376616600709828e-1 * t915 * t1188 + 0.34323878587450615495e-2 * t922 * t1188 + 0.44188806526397375082e-2 * t1259 * t68;
  t1263 = t306 * t198;
  t1264 = t1263 * t201;
  t1267 = t607 * t206;
  t1294 = 0.58579518666821377499e-4 * t1264 * t151 - 0.43725778536091172827e-1 * t1267 * t151 - 0.16570802447399015656e-2 * t1093 * t109 + 0.4142700611849753914e-3 * t380 * t287 + 0.82377448125217562105e-5 * t846 * t279 - 0.61489376066378211788e-2 * t855 * t279 + 0.44188806526397375082e-2 * t496 * t231 - 0.2196731950005801656e-4 * t384 * t554 + 0.1639716695103418981e-1 * t372 * t554 - 0.11047201631599343771e-2 * t194 * t559 - 0.51553607614130270929e-2 * t608 * t163 + 0.25628539416734352652e-4 * t202 * t1194 - 0.19130028109539888111e-1 * t207 * t1194 + 0.12888401903532567732e-2 * t95 * t1225;
  t1301 = my_piecewise3(t2, 0, t6 * t133 * t316 / 0.12e2 - t6 * t56 * t638 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1167 + t1205 + t1262 + t1294));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1301 + 0.4e1 * t643;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1309 = t676 * t257;
  t1325 = t668 * t91 * t94;
  t1331 = 0.1e1 / t18 / t455;
  t1333 = t1331 * t21 * t781;
  t1340 = -0.24856203671098523484e-2 * t1259 * t109 + 0.16475489625043512421e-4 * t202 * t1309 + 0.12428101835549261742e-2 * t496 * t287 - 0.32950979250087024841e-4 * t507 * t554 + 0.24595750426551284716e-1 * t490 * t554 - 0.12356617218782634316e-4 * t384 * t677 + 0.24713234437565268632e-4 * t1097 * t279 - 0.18446812819913463537e-1 * t1087 * t279 + 0.22094403263198687541e-2 * t1325 * t68 - 0.8955220341979581408e-4 * t199 * t858 * t274 * t1333 + 0.49269698906441874473e-6 * t408 * t863 * t274 * t1333;
  t1347 = t680 * t67;
  t1355 = t274 * t1331 * t917;
  t1369 = 0.92234064099567317682e-2 * t372 * t677 - 0.6214050917774630871e-3 * t194 * t681 + 0.33141604894798031312e-2 * t608 * t231 + 0.8285401223699507828e-3 * t95 * t1347 - 0.16570802447399015656e-2 * t250 * t559 - 0.12297875213275642357e-1 * t207 * t1309 + 0.34350141231225266187e-1 * t915 * t1355 - 0.12871454470293980811e-2 * t922 * t1355 + 0.12388682609778939612e-4 * t383 * t706 - 0.24895716731419442725e-7 * t755 * t716 - 0.1e-26 * t408 * t715 * t572 + 0.1991657338513555418e-6 * t949 * t591;
  t1373 = t670 * t572;
  t1397 = -0.991094608782315169e-4 * t506 * t595 + 0.1e-21 * t419 * t1373 + 0.1e-22 * t343 * t1373 + 0.43499178433983587543e0 * t963 * t599 - 0.19563423425467747777e-2 * t966 * t599 + 0.24454279281834684721e-3 * t906 * t671 - 0.54373973042479484428e-1 * t903 * t671 + 0.1e-32 * t436 * t285 * t572 - 0.28903317233079365593e-6 * t156 * t1309 + 0.24646390202234588569e-10 * t169 * t1309 + 0.7001634181136188197e-8 * t74 * t1347 + 0.77099448587002028687e-3 * t142 * t1309;
  t1421 = t652 * t225;
  t1424 = t658 * t66;
  t1436 = t335 * t274;
  t1450 = -0.78993135218979582416e-4 * t62 * t1347 - 0.12160783409107479181e-16 * t787 * t274 * t1333 + 0.209530397386055602e-6 * t792 * t274 * t1333 - 0.60165476444108911153e-9 * t797 * t274 * t1333 + 0.19040749098203580993e-12 * t775 * t274 * t1333 - 0.65901958500174049687e-4 * t1263 * t200 * t258 + 0.49191500853102569431e-1 * t607 * t205 * t258 + (0.10222930137679541558e1 * t820 * t274 * t1333 - 0.96742329535473473808e0 * t176 * t1421 + 0.72725590518833154352e-1 * t79 * t1424 - 0.10676811727399934357e1 * t833 * t274 * t1333 + 0.97623696780737360892e0 * t186 * t1421 - 0.73176486411919415732e-1 * t85 * t1424) * t47 + 0.72147834897668496888e-3 * t892 * t1436 * t1333 + 0.84760061357217243627e-5 * t792 * t1436 * t1333 - 0.28289977840657046136e-8 * t797 * t1436 * t1333 - 0.22002240199613755948e-9 * t885 * t886 * t274 * t1333;
  t1457 = my_piecewise3(t2, 0, -t6 * t56 * t726 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1340 + t1369 + t1397 + t1450));
  tv4rhosigma30 = 0.2e1 * rho[0] * t1457 + 0.2e1 * t730;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1461 = t335 * t657 * t646;
  t1487 = t650 * sigma[0];
  t1488 = 0.1e1 / t1487;
  t1490 = t144 * t1488 * t278;
  t1494 = 0.1e1 / t26 / t1487;
  t1496 = t24 * t1494 * t108;
  t1499 = t335 * t651;
  t1502 = t812 * t21 * t781;
  t1529 = -0.2305851602489182942e-1 * t207 * t1490 + 0.15535127294436577178e-2 * t95 * t1496 - 0.27055438086625686333e-3 * t892 * t1499 * t1502 - 0.31785023008956466361e-5 * t792 * t1499 * t1502 + 0.10608741690246392301e-8 * t797 * t1499 * t1502 + 0.82508400748551584807e-10 * t885 * t886 * t651 * t1502 - 0.36893625639826927074e-1 * t1267 * t279 + 0.3358207628242343028e-4 * t199 * t858 * t651 * t1502 - 0.18476137089915702927e-6 * t408 * t863 * t651 * t1502 + 0.36893625639826927073e-1 * t490 * t677 - 0.24856203671098523484e-2 * t250 * t681;
  t1536 = t651 * t812 * t917;
  t1549 = t657 * t646;
  t1585 = t1488 * t146 * t277;
  t1589 = t1494 * t27 * t30;
  t1603 = 0.21138516706349030958e-13 * t436 * t1549 - 0.14811212853558671703e-3 * t62 * t1496 + 0.14456146610062880379e-2 * t142 * t1490 + 0.1312806408963035287e-7 * t74 * t1496 + 0.45602937784153046926e-17 * t787 * t651 * t1502 - 0.7857389901977085075e-7 * t792 * t651 * t1502 + 0.22562053666540841683e-9 * t797 * t651 * t1502 - 0.7140280911826342872e-13 * t775 * t651 * t1502 - 0.54193719812023810485e-6 * t156 * t1490 + 0.46211981629189853565e-10 * t169 * t1490 + (-0.38335988016298280844e0 * t820 * t651 * t1502 + 0.10596735883028875721e2 * t347 * t1549 - 0.1813918678790127634e1 * t176 * t1585 + 0.13636048222281216441e0 * t79 * t1589 + 0.4003804397774975384e0 * t833 * t651 * t1502 - 0.10749622503825848102e2 * t363 * t1549 + 0.18304443146388255166e1 * t186 * t1585 - 0.1372059120223489045e0 * t85 * t1589) * t47;
  t1609 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (-0.4348723466057149386e-2 * t419 * t1461 + 0.84631271369142601731e-5 * t423 * t1461 - 0.13043171366838619622e-8 * t427 * t1461 - 0.37166047829336818836e-4 * t199 * t342 * t657 * t646 + 0.74687150194258328176e-7 * t408 * t409 * t657 * t646 - 0.99582866925677770901e-7 * t949 * t716 + 0.4955473043911575845e-4 * t506 * t706 - 0.49426468875130537264e-4 * t507 * t677 + 0.49426468875130537264e-4 * t1264 * t279 - 0.33141604894798031312e-2 * t1325 * t109 + t1529 + 0.3089154304695658579e-4 * t202 * t1490 + 0.24856203671098523484e-2 * t608 * t287 - 0.1288130296170947482e-1 * t915 * t1536 + 0.48267954263602428041e-3 * t922 * t1536 + 0.16312191912743845328e0 * t334 * t1461 - 0.73362837845504054164e-3 * t343 * t1461 + 0.97817117127338738884e-3 * t966 * t671 - 0.21749589216991793772e0 * t963 * t671 + 0.16368789325178571585e-6 * t423 * t1549 - 0.15462976898400567987e-9 * t427 * t1549 + t1603));
  tv4sigma40 = 0.2e1 * rho[0] * t1609;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif

