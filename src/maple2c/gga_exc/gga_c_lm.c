/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_c_lm.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t5, t6, t7, t8, t9, t10;
  double t11, t12, t14, t16, t17, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t31;
  double t32, t33, t34, t36, t39, t43, t45, t47;
  double t48, t54, t55, t56, t57, t59, t60, t62;
  double t63, t66, t68, t69, t70, t72, t73, t74;
  double t75, t76, t81, t82, t86, t89, tzk0;

  gga_c_lm_params *params;

  assert(p->params != NULL);
  params = (gga_c_lm_params * )(p->params);

  t1 = 0.1e1 / M_PI;
  t2 = 0.1e1 / rho[0];
  t5 = 0.1e1 + t1 * t2 / 0.36e5;
  t6 = M_CBRT3;
  t7 = t6 * t6;
  t8 = POW_1_3(t1);
  t9 = 0.1e1 / t8;
  t10 = t7 * t9;
  t11 = M_CBRT4;
  t12 = POW_1_3(rho[0]);
  t14 = t10 * t11 * t12;
  t16 = 0.1e1 + 0.1e2 * t14;
  t17 = log(t16);
  t19 = 0.252e-1 * t5 * t17;
  t20 = t8 * t8;
  t21 = t7 * t20;
  t22 = t12 * t12;
  t23 = 0.1e1 / t22;
  t24 = t11 * t23;
  t25 = t21 * t24;
  t26 = 0.7e-5 * t25;
  t27 = t6 * t8;
  t28 = t11 * t11;
  t31 = t27 * t28 / t12;
  t32 = 0.105e-3 * t31;
  t33 = 0.1e1 <= p->zeta_threshold;
  t34 = POW_1_3(p->zeta_threshold);
  t36 = my_piecewise3(t33, t34 * p->zeta_threshold, 1);
  t39 = M_CBRT2;
  t43 = (0.2e1 * t36 - 0.2e1) / (0.2e1 * t39 - 0.2e1);
  t45 = 0.1e1 + 0.56588424210451674939e-6 * t2;
  t47 = 0.1e1 + 0.25e2 * t14;
  t48 = log(t47);
  t54 = t43 * (-0.127e-1 * t45 * t48 - 0.64355555555555555556e-5 * t25 + 0.83833333333333333334e-4 * t31 - 0.41666666666666666667e-2 + t19);
  t55 = M_PI * t7;
  t56 = M_PI * M_PI;
  t57 = POW_1_3(t56);
  t59 = 0.1e1 / t57 / t56;
  t60 = rho[0] * rho[0];
  t62 = 0.1e1 / t22 / t60;
  t63 = sigma[0] * t62;
  t66 = t34 * t34;
  t68 = my_piecewise3(t33, t66 * p->zeta_threshold, 1);
  t69 = sqrt(t68);
  t70 = 0.1e1 / t69;
  t72 = pow(t1, 0.1e1 / 0.6e1);
  t73 = 0.1e1 / t72;
  t74 = sqrt(sigma[0]);
  t75 = t73 * t74;
  t76 = pow(rho[0], 0.1e1 / 0.6e1);
  t81 = exp(-t6 * params->lm_f * t75 / t76 / rho[0]);
  t82 = t70 * t81;
  t86 = t59 * (-0.7e1 / 0.9e1 * t63 * t36 + 0.2e1 * t82 * t63);
  t89 = t55 * t86 * t12 / 0.144e3;
  tzk0 = -t19 + t26 - t32 + 0.84e-2 + t54 + t89;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t5, t6, t7, t8, t9, t10;
  double t11, t12, t14, t16, t17, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t31;
  double t32, t33, t34, t36, t39, t43, t45, t47;
  double t48, t54, t55, t56, t57, t59, t60, t62;
  double t63, t66, t68, t69, t70, t72, t73, t74;
  double t75, t76, t81, t82, t86, t89, tzk0;

  double t90, t92, t93, t95, t96, t98, t99, t101;
  double t102, t103, t105, t107, t108, t113, t114, t121;
  double t122, t124, t125, t129, t130, t131, t132, t133;
  double t134, t135, t138, t145, t147, t150, tvrho0, t154;
  double t155, t160, t165, tvsigma0;

  gga_c_lm_params *params;

  assert(p->params != NULL);
  params = (gga_c_lm_params * )(p->params);

  t1 = 0.1e1 / M_PI;
  t2 = 0.1e1 / rho[0];
  t5 = 0.1e1 + t1 * t2 / 0.36e5;
  t6 = M_CBRT3;
  t7 = t6 * t6;
  t8 = POW_1_3(t1);
  t9 = 0.1e1 / t8;
  t10 = t7 * t9;
  t11 = M_CBRT4;
  t12 = POW_1_3(rho[0]);
  t14 = t10 * t11 * t12;
  t16 = 0.1e1 + 0.1e2 * t14;
  t17 = log(t16);
  t19 = 0.252e-1 * t5 * t17;
  t20 = t8 * t8;
  t21 = t7 * t20;
  t22 = t12 * t12;
  t23 = 0.1e1 / t22;
  t24 = t11 * t23;
  t25 = t21 * t24;
  t26 = 0.7e-5 * t25;
  t27 = t6 * t8;
  t28 = t11 * t11;
  t31 = t27 * t28 / t12;
  t32 = 0.105e-3 * t31;
  t33 = 0.1e1 <= p->zeta_threshold;
  t34 = POW_1_3(p->zeta_threshold);
  t36 = my_piecewise3(t33, t34 * p->zeta_threshold, 1);
  t39 = M_CBRT2;
  t43 = (0.2e1 * t36 - 0.2e1) / (0.2e1 * t39 - 0.2e1);
  t45 = 0.1e1 + 0.56588424210451674939e-6 * t2;
  t47 = 0.1e1 + 0.25e2 * t14;
  t48 = log(t47);
  t54 = t43 * (-0.127e-1 * t45 * t48 - 0.64355555555555555556e-5 * t25 + 0.83833333333333333334e-4 * t31 - 0.41666666666666666667e-2 + t19);
  t55 = M_PI * t7;
  t56 = M_PI * M_PI;
  t57 = POW_1_3(t56);
  t59 = 0.1e1 / t57 / t56;
  t60 = rho[0] * rho[0];
  t62 = 0.1e1 / t22 / t60;
  t63 = sigma[0] * t62;
  t66 = t34 * t34;
  t68 = my_piecewise3(t33, t66 * p->zeta_threshold, 1);
  t69 = sqrt(t68);
  t70 = 0.1e1 / t69;
  t72 = pow(t1, 0.1e1 / 0.6e1);
  t73 = 0.1e1 / t72;
  t74 = sqrt(sigma[0]);
  t75 = t73 * t74;
  t76 = pow(rho[0], 0.1e1 / 0.6e1);
  t81 = exp(-t6 * params->lm_f * t75 / t76 / rho[0]);
  t82 = t70 * t81;
  t86 = t59 * (-0.7e1 / 0.9e1 * t63 * t36 + 0.2e1 * t82 * t63);
  t89 = t55 * t86 * t12 / 0.144e3;
  tzk0 = -t19 + t26 - t32 + 0.84e-2 + t54 + t89;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t90 = 0.1e1 / t60;
  t92 = t1 * t90 * t17;
  t93 = 0.7e-6 * t92;
  t95 = t5 * t7 * t9;
  t96 = 0.1e1 / t16;
  t98 = t95 * t24 * t96;
  t99 = 0.84e-1 * t98;
  t101 = 0.1e1 / t22 / rho[0];
  t102 = t11 * t101;
  t103 = t21 * t102;
  t105 = t12 * rho[0];
  t107 = t28 / t105;
  t108 = t27 * t107;
  t113 = t45 * t7 * t9;
  t114 = 0.1e1 / t47;
  t121 = t43 * (0.71867298747273627173e-8 * t90 * t48 - 0.10583333333333333333e0 * t113 * t24 * t114 + 0.42903703703703703704e-5 * t103 - 0.27944444444444444445e-4 * t108 - t93 + t99);
  t122 = t60 * rho[0];
  t124 = 0.1e1 / t22 / t122;
  t125 = sigma[0] * t124;
  t129 = t70 * t6 * params->lm_f;
  t130 = t74 * sigma[0];
  t131 = t73 * t130;
  t132 = t60 * t60;
  t133 = t76 * t76;
  t134 = t133 * t133;
  t135 = t134 * t76;
  t138 = 0.1e1 / t135 / t132 * t81;
  t145 = t59 * (0.56e2 / 0.27e2 * t125 * t36 + 0.7e1 / 0.3e1 * t129 * t131 * t138 - 0.16e2 / 0.3e1 * t82 * t125);
  t147 = t55 * t145 * t12;
  t150 = t55 * t86 * t23;
  tvrho0 = -t19 + t26 - t32 + 0.84e-2 + t54 + t89 + rho[0] * (t93 - t99 - 0.46666666666666666667e-5 * t103 + 0.35e-4 * t108 + t121 + t147 / 0.144e3 + t150 / 0.432e3);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t154 = t105 * M_PI;
  t155 = t7 * t59;
  t160 = 0.1e1 / t135 / t122 * t81;
  t165 = -0.7e1 / 0.9e1 * t62 * t36 - t129 * t75 * t160 + 0.2e1 * t82 * t62;
  tvsigma0 = t154 * t155 * t165 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t5, t6, t7, t8, t9, t10;
  double t11, t12, t14, t16, t17, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t31;
  double t32, t33, t34, t36, t39, t43, t45, t47;
  double t48, t54, t55, t56, t57, t59, t60, t62;
  double t63, t66, t68, t69, t70, t72, t73, t74;
  double t75, t76, t81, t82, t86, t89, tzk0;

  double t90, t92, t93, t95, t96, t98, t99, t101;
  double t102, t103, t105, t107, t108, t113, t114, t121;
  double t122, t124, t125, t129, t130, t131, t132, t133;
  double t134, t135, t138, t145, t147, t150, tvrho0, t154;
  double t155, t160, t165, tvsigma0;

  double t175, t177, t178, t181, t182, t183, t184, t186;
  double t187, t189, t190, t191, t192, t194, t195, t196;
  double t197, t201, t202, t207, t214, t215, t216, t223;
  double t225, t226, t229, t232, t237, t238, t239, t240;
  double t241, t242, t243, t250, t252, t255, t258, tv2rho20;
  double t262, t271, t272, t273, t274, t280, tv2rhosigma0, t284;
  double t285, t289, t295, tv2sigma20;

  gga_c_lm_params *params;

  assert(p->params != NULL);
  params = (gga_c_lm_params * )(p->params);

  t1 = 0.1e1 / M_PI;
  t2 = 0.1e1 / rho[0];
  t5 = 0.1e1 + t1 * t2 / 0.36e5;
  t6 = M_CBRT3;
  t7 = t6 * t6;
  t8 = POW_1_3(t1);
  t9 = 0.1e1 / t8;
  t10 = t7 * t9;
  t11 = M_CBRT4;
  t12 = POW_1_3(rho[0]);
  t14 = t10 * t11 * t12;
  t16 = 0.1e1 + 0.1e2 * t14;
  t17 = log(t16);
  t19 = 0.252e-1 * t5 * t17;
  t20 = t8 * t8;
  t21 = t7 * t20;
  t22 = t12 * t12;
  t23 = 0.1e1 / t22;
  t24 = t11 * t23;
  t25 = t21 * t24;
  t26 = 0.7e-5 * t25;
  t27 = t6 * t8;
  t28 = t11 * t11;
  t31 = t27 * t28 / t12;
  t32 = 0.105e-3 * t31;
  t33 = 0.1e1 <= p->zeta_threshold;
  t34 = POW_1_3(p->zeta_threshold);
  t36 = my_piecewise3(t33, t34 * p->zeta_threshold, 1);
  t39 = M_CBRT2;
  t43 = (0.2e1 * t36 - 0.2e1) / (0.2e1 * t39 - 0.2e1);
  t45 = 0.1e1 + 0.56588424210451674939e-6 * t2;
  t47 = 0.1e1 + 0.25e2 * t14;
  t48 = log(t47);
  t54 = t43 * (-0.127e-1 * t45 * t48 - 0.64355555555555555556e-5 * t25 + 0.83833333333333333334e-4 * t31 - 0.41666666666666666667e-2 + t19);
  t55 = M_PI * t7;
  t56 = M_PI * M_PI;
  t57 = POW_1_3(t56);
  t59 = 0.1e1 / t57 / t56;
  t60 = rho[0] * rho[0];
  t62 = 0.1e1 / t22 / t60;
  t63 = sigma[0] * t62;
  t66 = t34 * t34;
  t68 = my_piecewise3(t33, t66 * p->zeta_threshold, 1);
  t69 = sqrt(t68);
  t70 = 0.1e1 / t69;
  t72 = pow(t1, 0.1e1 / 0.6e1);
  t73 = 0.1e1 / t72;
  t74 = sqrt(sigma[0]);
  t75 = t73 * t74;
  t76 = pow(rho[0], 0.1e1 / 0.6e1);
  t81 = exp(-t6 * params->lm_f * t75 / t76 / rho[0]);
  t82 = t70 * t81;
  t86 = t59 * (-0.7e1 / 0.9e1 * t63 * t36 + 0.2e1 * t82 * t63);
  t89 = t55 * t86 * t12 / 0.144e3;
  tzk0 = -t19 + t26 - t32 + 0.84e-2 + t54 + t89;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t90 = 0.1e1 / t60;
  t92 = t1 * t90 * t17;
  t93 = 0.7e-6 * t92;
  t95 = t5 * t7 * t9;
  t96 = 0.1e1 / t16;
  t98 = t95 * t24 * t96;
  t99 = 0.84e-1 * t98;
  t101 = 0.1e1 / t22 / rho[0];
  t102 = t11 * t101;
  t103 = t21 * t102;
  t105 = t12 * rho[0];
  t107 = t28 / t105;
  t108 = t27 * t107;
  t113 = t45 * t7 * t9;
  t114 = 0.1e1 / t47;
  t121 = t43 * (0.71867298747273627173e-8 * t90 * t48 - 0.10583333333333333333e0 * t113 * t24 * t114 + 0.42903703703703703704e-5 * t103 - 0.27944444444444444445e-4 * t108 - t93 + t99);
  t122 = t60 * rho[0];
  t124 = 0.1e1 / t22 / t122;
  t125 = sigma[0] * t124;
  t129 = t70 * t6 * params->lm_f;
  t130 = t74 * sigma[0];
  t131 = t73 * t130;
  t132 = t60 * t60;
  t133 = t76 * t76;
  t134 = t133 * t133;
  t135 = t134 * t76;
  t138 = 0.1e1 / t135 / t132 * t81;
  t145 = t59 * (0.56e2 / 0.27e2 * t125 * t36 + 0.7e1 / 0.3e1 * t129 * t131 * t138 - 0.16e2 / 0.3e1 * t82 * t125);
  t147 = t55 * t145 * t12;
  t150 = t55 * t86 * t23;
  tvrho0 = -t19 + t26 - t32 + 0.84e-2 + t54 + t89 + rho[0] * (t93 - t99 - 0.46666666666666666667e-5 * t103 + 0.35e-4 * t108 + t121 + t147 / 0.144e3 + t150 / 0.432e3);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t154 = t105 * M_PI;
  t155 = t7 * t59;
  t160 = 0.1e1 / t135 / t122 * t81;
  t165 = -0.7e1 / 0.9e1 * t62 * t36 - t129 * t75 * t160 + 0.2e1 * t82 * t62;
  tvsigma0 = t154 * t155 * t165 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t175 = 0.1e1 / t122;
  t177 = t1 * t175 * t17;
  t178 = 0.14e-5 * t177;
  t181 = t9 * t11;
  t182 = t181 * t96;
  t183 = t1 * t62 * t7 * t182;
  t184 = 0.46666666666666666666e-5 * t183;
  t186 = t95 * t102 * t96;
  t187 = 0.56e-1 * t186;
  t189 = 0.1e1 / t20;
  t190 = t5 * t6 * t189;
  t191 = t16 * t16;
  t192 = 0.1e1 / t191;
  t194 = t190 * t107 * t192;
  t195 = 0.84e0 * t194;
  t196 = t11 * t62;
  t197 = t21 * t196;
  t201 = t28 / t12 / t60;
  t202 = t27 * t201;
  t207 = t181 * t114;
  t214 = t45 * t6 * t189;
  t215 = t47 * t47;
  t216 = 0.1e1 / t215;
  t223 = t43 * (-0.14373459749454725435e-7 * t175 * t48 + 0.11977883124545604529e-6 * t62 * t7 * t207 + 0.70555555555555555553e-1 * t113 * t102 * t114 + 0.26458333333333333332e1 * t214 * t107 * t216 - 0.7150617283950617284e-5 * t197 + 0.3725925925925925926e-4 * t202 + t178 - t184 - t187 - t195);
  t225 = 0.1e1 / t22 / t132;
  t226 = sigma[0] * t225;
  t229 = t132 * rho[0];
  t232 = 0.1e1 / t135 / t229 * t81;
  t237 = params->lm_f * params->lm_f;
  t238 = t70 * t7 * t237;
  t239 = sigma[0] * sigma[0];
  t240 = t9 * t239;
  t241 = t132 * t122;
  t242 = 0.1e1 / t241;
  t243 = t242 * t81;
  t250 = t59 * (-0.616e3 / 0.81e2 * t226 * t36 - 0.35e2 / 0.2e1 * t129 * t131 * t232 + 0.49e2 / 0.18e2 * t238 * t240 * t243 + 0.176e3 / 0.9e1 * t82 * t226);
  t252 = t55 * t250 * t12;
  t255 = t55 * t145 * t23;
  t258 = t55 * t86 * t101;
  tv2rho20 = 0.14e-5 * t92 - 0.168e0 * t98 - 0.93333333333333333334e-5 * t103 + 0.7e-4 * t108 + 0.2e1 * t121 + t147 / 0.72e2 + t150 / 0.216e3 + rho[0] * (-t178 + t184 + t187 + t195 + 0.77777777777777777778e-5 * t197 - 0.46666666666666666667e-4 * t202 + t223 + t252 / 0.144e3 + t255 / 0.216e3 - t258 / 0.648e3);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t262 = t59 * t165;
  t271 = t9 * sigma[0];
  t272 = t132 * t60;
  t273 = 0.1e1 / t272;
  t274 = t273 * t81;
  t280 = 0.56e2 / 0.27e2 * t124 * t36 + 0.37e2 / 0.6e1 * t129 * t75 * t138 - 0.7e1 / 0.6e1 * t238 * t271 * t274 - 0.16e2 / 0.3e1 * t82 * t124;
  tv2rhosigma0 = t55 * t262 * t12 / 0.108e3 + t154 * t155 * t280 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t284 = 0.1e1 / t74;
  t285 = t73 * t284;
  t289 = 0.1e1 / t229;
  t295 = t155 * (-0.3e1 / 0.2e1 * t129 * t285 * t160 + t238 * t9 * t289 * t81 / 0.2e1);
  tv2sigma20 = t154 * t295 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t5, t6, t7, t8, t9, t10;
  double t11, t12, t14, t16, t17, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t31;
  double t32, t33, t34, t36, t39, t43, t45, t47;
  double t48, t54, t55, t56, t57, t59, t60, t62;
  double t63, t66, t68, t69, t70, t72, t73, t74;
  double t75, t76, t81, t82, t86, t89, tzk0;

  double t90, t92, t93, t95, t96, t98, t99, t101;
  double t102, t103, t105, t107, t108, t113, t114, t121;
  double t122, t124, t125, t129, t130, t131, t132, t133;
  double t134, t135, t138, t145, t147, t150, tvrho0, t154;
  double t155, t160, t165, tvsigma0;

  double t175, t177, t178, t181, t182, t183, t184, t186;
  double t187, t189, t190, t191, t192, t194, t195, t196;
  double t197, t201, t202, t207, t214, t215, t216, t223;
  double t225, t226, t229, t232, t237, t238, t239, t240;
  double t241, t242, t243, t250, t252, t255, t258, tv2rho20;
  double t262, t271, t272, t273, t274, t280, tv2rhosigma0, t284;
  double t285, t289, t295, tv2sigma20;

  double t307, t309, t310, t313, t314, t316, t319, t320;
  double t321, t322, t324, t325, t327, t328, t329, t331;
  double t333, t334, t335, t336, t338, t339, t347, t358;
  double t363, t364, t366, t367, t372, t376, t378, t384;
  double t386, t387, t388, t390, t398, t400, t403, t406;
  double t409, t411, tv3rho30, t413, t429, t436, tv3rho2sigma0, t440;
  double t451, t457, tv3rhosigma20, t460, t461, t464, t465, t466;
  double t470, t476, tv3sigma30;

  gga_c_lm_params *params;

  assert(p->params != NULL);
  params = (gga_c_lm_params * )(p->params);

  t1 = 0.1e1 / M_PI;
  t2 = 0.1e1 / rho[0];
  t5 = 0.1e1 + t1 * t2 / 0.36e5;
  t6 = M_CBRT3;
  t7 = t6 * t6;
  t8 = POW_1_3(t1);
  t9 = 0.1e1 / t8;
  t10 = t7 * t9;
  t11 = M_CBRT4;
  t12 = POW_1_3(rho[0]);
  t14 = t10 * t11 * t12;
  t16 = 0.1e1 + 0.1e2 * t14;
  t17 = log(t16);
  t19 = 0.252e-1 * t5 * t17;
  t20 = t8 * t8;
  t21 = t7 * t20;
  t22 = t12 * t12;
  t23 = 0.1e1 / t22;
  t24 = t11 * t23;
  t25 = t21 * t24;
  t26 = 0.7e-5 * t25;
  t27 = t6 * t8;
  t28 = t11 * t11;
  t31 = t27 * t28 / t12;
  t32 = 0.105e-3 * t31;
  t33 = 0.1e1 <= p->zeta_threshold;
  t34 = POW_1_3(p->zeta_threshold);
  t36 = my_piecewise3(t33, t34 * p->zeta_threshold, 1);
  t39 = M_CBRT2;
  t43 = (0.2e1 * t36 - 0.2e1) / (0.2e1 * t39 - 0.2e1);
  t45 = 0.1e1 + 0.56588424210451674939e-6 * t2;
  t47 = 0.1e1 + 0.25e2 * t14;
  t48 = log(t47);
  t54 = t43 * (-0.127e-1 * t45 * t48 - 0.64355555555555555556e-5 * t25 + 0.83833333333333333334e-4 * t31 - 0.41666666666666666667e-2 + t19);
  t55 = M_PI * t7;
  t56 = M_PI * M_PI;
  t57 = POW_1_3(t56);
  t59 = 0.1e1 / t57 / t56;
  t60 = rho[0] * rho[0];
  t62 = 0.1e1 / t22 / t60;
  t63 = sigma[0] * t62;
  t66 = t34 * t34;
  t68 = my_piecewise3(t33, t66 * p->zeta_threshold, 1);
  t69 = sqrt(t68);
  t70 = 0.1e1 / t69;
  t72 = pow(t1, 0.1e1 / 0.6e1);
  t73 = 0.1e1 / t72;
  t74 = sqrt(sigma[0]);
  t75 = t73 * t74;
  t76 = pow(rho[0], 0.1e1 / 0.6e1);
  t81 = exp(-t6 * params->lm_f * t75 / t76 / rho[0]);
  t82 = t70 * t81;
  t86 = t59 * (-0.7e1 / 0.9e1 * t63 * t36 + 0.2e1 * t82 * t63);
  t89 = t55 * t86 * t12 / 0.144e3;
  tzk0 = -t19 + t26 - t32 + 0.84e-2 + t54 + t89;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t90 = 0.1e1 / t60;
  t92 = t1 * t90 * t17;
  t93 = 0.7e-6 * t92;
  t95 = t5 * t7 * t9;
  t96 = 0.1e1 / t16;
  t98 = t95 * t24 * t96;
  t99 = 0.84e-1 * t98;
  t101 = 0.1e1 / t22 / rho[0];
  t102 = t11 * t101;
  t103 = t21 * t102;
  t105 = t12 * rho[0];
  t107 = t28 / t105;
  t108 = t27 * t107;
  t113 = t45 * t7 * t9;
  t114 = 0.1e1 / t47;
  t121 = t43 * (0.71867298747273627173e-8 * t90 * t48 - 0.10583333333333333333e0 * t113 * t24 * t114 + 0.42903703703703703704e-5 * t103 - 0.27944444444444444445e-4 * t108 - t93 + t99);
  t122 = t60 * rho[0];
  t124 = 0.1e1 / t22 / t122;
  t125 = sigma[0] * t124;
  t129 = t70 * t6 * params->lm_f;
  t130 = t74 * sigma[0];
  t131 = t73 * t130;
  t132 = t60 * t60;
  t133 = t76 * t76;
  t134 = t133 * t133;
  t135 = t134 * t76;
  t138 = 0.1e1 / t135 / t132 * t81;
  t145 = t59 * (0.56e2 / 0.27e2 * t125 * t36 + 0.7e1 / 0.3e1 * t129 * t131 * t138 - 0.16e2 / 0.3e1 * t82 * t125);
  t147 = t55 * t145 * t12;
  t150 = t55 * t86 * t23;
  tvrho0 = -t19 + t26 - t32 + 0.84e-2 + t54 + t89 + rho[0] * (t93 - t99 - 0.46666666666666666667e-5 * t103 + 0.35e-4 * t108 + t121 + t147 / 0.144e3 + t150 / 0.432e3);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t154 = t105 * M_PI;
  t155 = t7 * t59;
  t160 = 0.1e1 / t135 / t122 * t81;
  t165 = -0.7e1 / 0.9e1 * t62 * t36 - t129 * t75 * t160 + 0.2e1 * t82 * t62;
  tvsigma0 = t154 * t155 * t165 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t175 = 0.1e1 / t122;
  t177 = t1 * t175 * t17;
  t178 = 0.14e-5 * t177;
  t181 = t9 * t11;
  t182 = t181 * t96;
  t183 = t1 * t62 * t7 * t182;
  t184 = 0.46666666666666666666e-5 * t183;
  t186 = t95 * t102 * t96;
  t187 = 0.56e-1 * t186;
  t189 = 0.1e1 / t20;
  t190 = t5 * t6 * t189;
  t191 = t16 * t16;
  t192 = 0.1e1 / t191;
  t194 = t190 * t107 * t192;
  t195 = 0.84e0 * t194;
  t196 = t11 * t62;
  t197 = t21 * t196;
  t201 = t28 / t12 / t60;
  t202 = t27 * t201;
  t207 = t181 * t114;
  t214 = t45 * t6 * t189;
  t215 = t47 * t47;
  t216 = 0.1e1 / t215;
  t223 = t43 * (-0.14373459749454725435e-7 * t175 * t48 + 0.11977883124545604529e-6 * t62 * t7 * t207 + 0.70555555555555555553e-1 * t113 * t102 * t114 + 0.26458333333333333332e1 * t214 * t107 * t216 - 0.7150617283950617284e-5 * t197 + 0.3725925925925925926e-4 * t202 + t178 - t184 - t187 - t195);
  t225 = 0.1e1 / t22 / t132;
  t226 = sigma[0] * t225;
  t229 = t132 * rho[0];
  t232 = 0.1e1 / t135 / t229 * t81;
  t237 = params->lm_f * params->lm_f;
  t238 = t70 * t7 * t237;
  t239 = sigma[0] * sigma[0];
  t240 = t9 * t239;
  t241 = t132 * t122;
  t242 = 0.1e1 / t241;
  t243 = t242 * t81;
  t250 = t59 * (-0.616e3 / 0.81e2 * t226 * t36 - 0.35e2 / 0.2e1 * t129 * t131 * t232 + 0.49e2 / 0.18e2 * t238 * t240 * t243 + 0.176e3 / 0.9e1 * t82 * t226);
  t252 = t55 * t250 * t12;
  t255 = t55 * t145 * t23;
  t258 = t55 * t86 * t101;
  tv2rho20 = 0.14e-5 * t92 - 0.168e0 * t98 - 0.93333333333333333334e-5 * t103 + 0.7e-4 * t108 + 0.2e1 * t121 + t147 / 0.72e2 + t150 / 0.216e3 + rho[0] * (-t178 + t184 + t187 + t195 + 0.77777777777777777778e-5 * t197 - 0.46666666666666666667e-4 * t202 + t223 + t252 / 0.144e3 + t255 / 0.216e3 - t258 / 0.648e3);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t262 = t59 * t165;
  t271 = t9 * sigma[0];
  t272 = t132 * t60;
  t273 = 0.1e1 / t272;
  t274 = t273 * t81;
  t280 = 0.56e2 / 0.27e2 * t124 * t36 + 0.37e2 / 0.6e1 * t129 * t75 * t138 - 0.7e1 / 0.6e1 * t238 * t271 * t274 - 0.16e2 / 0.3e1 * t82 * t124;
  tv2rhosigma0 = t55 * t262 * t12 / 0.108e3 + t154 * t155 * t280 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t284 = 0.1e1 / t74;
  t285 = t73 * t284;
  t289 = 0.1e1 / t229;
  t295 = t155 * (-0.3e1 / 0.2e1 * t129 * t285 * t160 + t238 * t9 * t289 * t81 / 0.2e1);
  tv2sigma20 = t154 * t295 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t307 = 0.1e1 / t132;
  t309 = t1 * t307 * t17;
  t310 = 0.42e-5 * t309;
  t313 = t1 * t124 * t7 * t182;
  t314 = 0.18666666666666666666e-4 * t313;
  t316 = 0.1e1 / t12 / t122;
  t319 = t189 * t28;
  t320 = t319 * t192;
  t321 = t1 * t316 * t6 * t320;
  t322 = 0.69999999999999999999e-4 * t321;
  t324 = t95 * t196 * t96;
  t325 = 0.93333333333333333334e-1 * t324;
  t327 = t190 * t201 * t192;
  t328 = 0.168e1 * t327;
  t329 = t5 * M_PI;
  t331 = 0.1e1 / t191 / t16;
  t333 = t329 * t90 * t331;
  t334 = 0.672e2 * t333;
  t335 = t11 * t124;
  t336 = t21 * t335;
  t338 = t28 * t316;
  t339 = t27 * t338;
  t347 = t319 * t216;
  t358 = 0.1e1 / t215 / t47;
  t363 = 0.43120379248364176305e-7 * t307 * t48 - 0.47911532498182418116e-6 * t124 * t7 * t207 - 0.44917061717046016982e-5 * t316 * t6 * t347 - 0.11759259259259259259e0 * t113 * t196 * t114 - 0.52916666666666666664e1 * t214 * t201 * t216 - 0.1662426112524598922e4 * t45 * t90 * t358 + 0.19068312757201646091e-4 * t336 - 0.86938271604938271607e-4 * t339 - t310 + t314 + t322 + t325 + t328 + t334;
  t364 = t43 * t363;
  t366 = 0.1e1 / t22 / t229;
  t367 = sigma[0] * t366;
  t372 = 0.1e1 / t135 / t272 * t81;
  t376 = t132 * t132;
  t378 = 0.1e1 / t376 * t81;
  t384 = sqrt(t1);
  t386 = t70 * t237 * params->lm_f / t384;
  t387 = t74 * t239;
  t388 = t376 * rho[0];
  t390 = 0.1e1 / t76 / t388;
  t398 = t59 * (0.8624e4 / 0.243e3 * t367 * t36 + 0.13489e5 / 0.108e3 * t129 * t131 * t372 - 0.1421e4 / 0.36e2 * t238 * t240 * t378 + 0.343e3 / 0.36e2 * t386 * t387 * t390 * t81 - 0.2464e4 / 0.27e2 * t82 * t367);
  t400 = t55 * t398 * t12;
  t403 = t55 * t250 * t23;
  t406 = t55 * t145 * t101;
  t409 = t55 * t86 * t62;
  t411 = t310 - t314 - t322 - t325 - t328 - t334 - 0.20740740740740740741e-4 * t336 + 0.10888888888888888889e-3 * t339 + t364 + t400 / 0.144e3 + t403 / 0.144e3 - t406 / 0.216e3 + 0.5e1 / 0.1944e4 * t409;
  tv3rho30 = -0.42e-5 * t177 + 0.14e-4 * t183 + 0.168e0 * t186 + 0.252e1 * t194 + 0.23333333333333333334e-4 * t197 - 0.14e-3 * t202 + 0.3e1 * t223 + t252 / 0.48e2 + t255 / 0.72e2 - t258 / 0.216e3 + rho[0] * t411;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t413 = t59 * t280;
  t429 = 0.1e1 / t76 / t376;
  t436 = -0.616e3 / 0.81e2 * t225 * t36 - 0.1297e4 / 0.36e2 * t129 * t75 * t232 + 0.511e3 / 0.36e2 * t238 * t271 * t243 - 0.49e2 / 0.12e2 * t386 * t130 * t429 * t81 + 0.176e3 / 0.9e1 * t82 * t225;
  tv3rho2sigma0 = t55 * t413 * t12 / 0.54e2 + t55 * t262 * t23 / 0.324e3 + t154 * t155 * t436 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t440 = t12 * M_PI;
  t451 = 0.1e1 / t76 / t241;
  t457 = t155 * (0.23e2 / 0.4e1 * t129 * t285 * t138 - 0.17e2 / 0.4e1 * t238 * t9 * t273 * t81 + 0.7e1 / 0.4e1 * t386 * t451 * t74 * t81);
  tv3rhosigma20 = t440 * t295 / 0.108e3 + t154 * t457 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t460 = 0.1e1 / t130;
  t461 = t73 * t460;
  t464 = 0.1e1 / sigma[0];
  t465 = t9 * t464;
  t466 = t289 * t81;
  t470 = 0.1e1 / t76 / t272;
  t476 = t155 * (-0.3e1 / 0.4e1 * t386 * t470 * t284 * t81 + 0.3e1 / 0.4e1 * t129 * t461 * t160 + 0.3e1 / 0.4e1 * t238 * t465 * t466);
  tv3sigma30 = t154 * t476 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t5, t6, t7, t8, t9, t10;
  double t11, t12, t14, t16, t17, t19, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t31;
  double t32, t33, t34, t36, t39, t43, t45, t47;
  double t48, t54, t55, t56, t57, t59, t60, t62;
  double t63, t66, t68, t69, t70, t72, t73, t74;
  double t75, t76, t81, t82, t86, t89, tzk0;

  double t90, t92, t93, t95, t96, t98, t99, t101;
  double t102, t103, t105, t107, t108, t113, t114, t121;
  double t122, t124, t125, t129, t130, t131, t132, t133;
  double t134, t135, t138, t145, t147, t150, tvrho0, t154;
  double t155, t160, t165, tvsigma0;

  double t175, t177, t178, t181, t182, t183, t184, t186;
  double t187, t189, t190, t191, t192, t194, t195, t196;
  double t197, t201, t202, t207, t214, t215, t216, t223;
  double t225, t226, t229, t232, t237, t238, t239, t240;
  double t241, t242, t243, t250, t252, t255, t258, tv2rho20;
  double t262, t271, t272, t273, t274, t280, tv2rhosigma0, t284;
  double t285, t289, t295, tv2sigma20;

  double t307, t309, t310, t313, t314, t316, t319, t320;
  double t321, t322, t324, t325, t327, t328, t329, t331;
  double t333, t334, t335, t336, t338, t339, t347, t358;
  double t363, t364, t366, t367, t372, t376, t378, t384;
  double t386, t387, t388, t390, t398, t400, t403, t406;
  double t409, t411, tv3rho30, t413, t429, t436, tv3rho2sigma0, t440;
  double t451, t457, tv3rhosigma20, t460, t461, t464, t465, t466;
  double t470, t476, tv3sigma30;

  double t499, t501, t505, t508, t513, t521, t523, t528;
  double t539, t544, t547, t549, t552, t554, t570, t584;
  double t591, t593, t599, t612, tv4rho40, tv4rho3sigma0, tv4rho2sigma20, tv4rhosigma30;
  double tv4sigma40;

  gga_c_lm_params *params;

  assert(p->params != NULL);
  params = (gga_c_lm_params * )(p->params);

  t1 = 0.1e1 / M_PI;
  t2 = 0.1e1 / rho[0];
  t5 = 0.1e1 + t1 * t2 / 0.36e5;
  t6 = M_CBRT3;
  t7 = t6 * t6;
  t8 = POW_1_3(t1);
  t9 = 0.1e1 / t8;
  t10 = t7 * t9;
  t11 = M_CBRT4;
  t12 = POW_1_3(rho[0]);
  t14 = t10 * t11 * t12;
  t16 = 0.1e1 + 0.1e2 * t14;
  t17 = log(t16);
  t19 = 0.252e-1 * t5 * t17;
  t20 = t8 * t8;
  t21 = t7 * t20;
  t22 = t12 * t12;
  t23 = 0.1e1 / t22;
  t24 = t11 * t23;
  t25 = t21 * t24;
  t26 = 0.7e-5 * t25;
  t27 = t6 * t8;
  t28 = t11 * t11;
  t31 = t27 * t28 / t12;
  t32 = 0.105e-3 * t31;
  t33 = 0.1e1 <= p->zeta_threshold;
  t34 = POW_1_3(p->zeta_threshold);
  t36 = my_piecewise3(t33, t34 * p->zeta_threshold, 1);
  t39 = M_CBRT2;
  t43 = (0.2e1 * t36 - 0.2e1) / (0.2e1 * t39 - 0.2e1);
  t45 = 0.1e1 + 0.56588424210451674939e-6 * t2;
  t47 = 0.1e1 + 0.25e2 * t14;
  t48 = log(t47);
  t54 = t43 * (-0.127e-1 * t45 * t48 - 0.64355555555555555556e-5 * t25 + 0.83833333333333333334e-4 * t31 - 0.41666666666666666667e-2 + t19);
  t55 = M_PI * t7;
  t56 = M_PI * M_PI;
  t57 = POW_1_3(t56);
  t59 = 0.1e1 / t57 / t56;
  t60 = rho[0] * rho[0];
  t62 = 0.1e1 / t22 / t60;
  t63 = sigma[0] * t62;
  t66 = t34 * t34;
  t68 = my_piecewise3(t33, t66 * p->zeta_threshold, 1);
  t69 = sqrt(t68);
  t70 = 0.1e1 / t69;
  t72 = pow(t1, 0.1e1 / 0.6e1);
  t73 = 0.1e1 / t72;
  t74 = sqrt(sigma[0]);
  t75 = t73 * t74;
  t76 = pow(rho[0], 0.1e1 / 0.6e1);
  t81 = exp(-t6 * params->lm_f * t75 / t76 / rho[0]);
  t82 = t70 * t81;
  t86 = t59 * (-0.7e1 / 0.9e1 * t63 * t36 + 0.2e1 * t82 * t63);
  t89 = t55 * t86 * t12 / 0.144e3;
  tzk0 = -t19 + t26 - t32 + 0.84e-2 + t54 + t89;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t90 = 0.1e1 / t60;
  t92 = t1 * t90 * t17;
  t93 = 0.7e-6 * t92;
  t95 = t5 * t7 * t9;
  t96 = 0.1e1 / t16;
  t98 = t95 * t24 * t96;
  t99 = 0.84e-1 * t98;
  t101 = 0.1e1 / t22 / rho[0];
  t102 = t11 * t101;
  t103 = t21 * t102;
  t105 = t12 * rho[0];
  t107 = t28 / t105;
  t108 = t27 * t107;
  t113 = t45 * t7 * t9;
  t114 = 0.1e1 / t47;
  t121 = t43 * (0.71867298747273627173e-8 * t90 * t48 - 0.10583333333333333333e0 * t113 * t24 * t114 + 0.42903703703703703704e-5 * t103 - 0.27944444444444444445e-4 * t108 - t93 + t99);
  t122 = t60 * rho[0];
  t124 = 0.1e1 / t22 / t122;
  t125 = sigma[0] * t124;
  t129 = t70 * t6 * params->lm_f;
  t130 = t74 * sigma[0];
  t131 = t73 * t130;
  t132 = t60 * t60;
  t133 = t76 * t76;
  t134 = t133 * t133;
  t135 = t134 * t76;
  t138 = 0.1e1 / t135 / t132 * t81;
  t145 = t59 * (0.56e2 / 0.27e2 * t125 * t36 + 0.7e1 / 0.3e1 * t129 * t131 * t138 - 0.16e2 / 0.3e1 * t82 * t125);
  t147 = t55 * t145 * t12;
  t150 = t55 * t86 * t23;
  tvrho0 = -t19 + t26 - t32 + 0.84e-2 + t54 + t89 + rho[0] * (t93 - t99 - 0.46666666666666666667e-5 * t103 + 0.35e-4 * t108 + t121 + t147 / 0.144e3 + t150 / 0.432e3);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t154 = t105 * M_PI;
  t155 = t7 * t59;
  t160 = 0.1e1 / t135 / t122 * t81;
  t165 = -0.7e1 / 0.9e1 * t62 * t36 - t129 * t75 * t160 + 0.2e1 * t82 * t62;
  tvsigma0 = t154 * t155 * t165 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t175 = 0.1e1 / t122;
  t177 = t1 * t175 * t17;
  t178 = 0.14e-5 * t177;
  t181 = t9 * t11;
  t182 = t181 * t96;
  t183 = t1 * t62 * t7 * t182;
  t184 = 0.46666666666666666666e-5 * t183;
  t186 = t95 * t102 * t96;
  t187 = 0.56e-1 * t186;
  t189 = 0.1e1 / t20;
  t190 = t5 * t6 * t189;
  t191 = t16 * t16;
  t192 = 0.1e1 / t191;
  t194 = t190 * t107 * t192;
  t195 = 0.84e0 * t194;
  t196 = t11 * t62;
  t197 = t21 * t196;
  t201 = t28 / t12 / t60;
  t202 = t27 * t201;
  t207 = t181 * t114;
  t214 = t45 * t6 * t189;
  t215 = t47 * t47;
  t216 = 0.1e1 / t215;
  t223 = t43 * (-0.14373459749454725435e-7 * t175 * t48 + 0.11977883124545604529e-6 * t62 * t7 * t207 + 0.70555555555555555553e-1 * t113 * t102 * t114 + 0.26458333333333333332e1 * t214 * t107 * t216 - 0.7150617283950617284e-5 * t197 + 0.3725925925925925926e-4 * t202 + t178 - t184 - t187 - t195);
  t225 = 0.1e1 / t22 / t132;
  t226 = sigma[0] * t225;
  t229 = t132 * rho[0];
  t232 = 0.1e1 / t135 / t229 * t81;
  t237 = params->lm_f * params->lm_f;
  t238 = t70 * t7 * t237;
  t239 = sigma[0] * sigma[0];
  t240 = t9 * t239;
  t241 = t132 * t122;
  t242 = 0.1e1 / t241;
  t243 = t242 * t81;
  t250 = t59 * (-0.616e3 / 0.81e2 * t226 * t36 - 0.35e2 / 0.2e1 * t129 * t131 * t232 + 0.49e2 / 0.18e2 * t238 * t240 * t243 + 0.176e3 / 0.9e1 * t82 * t226);
  t252 = t55 * t250 * t12;
  t255 = t55 * t145 * t23;
  t258 = t55 * t86 * t101;
  tv2rho20 = 0.14e-5 * t92 - 0.168e0 * t98 - 0.93333333333333333334e-5 * t103 + 0.7e-4 * t108 + 0.2e1 * t121 + t147 / 0.72e2 + t150 / 0.216e3 + rho[0] * (-t178 + t184 + t187 + t195 + 0.77777777777777777778e-5 * t197 - 0.46666666666666666667e-4 * t202 + t223 + t252 / 0.144e3 + t255 / 0.216e3 - t258 / 0.648e3);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t262 = t59 * t165;
  t271 = t9 * sigma[0];
  t272 = t132 * t60;
  t273 = 0.1e1 / t272;
  t274 = t273 * t81;
  t280 = 0.56e2 / 0.27e2 * t124 * t36 + 0.37e2 / 0.6e1 * t129 * t75 * t138 - 0.7e1 / 0.6e1 * t238 * t271 * t274 - 0.16e2 / 0.3e1 * t82 * t124;
  tv2rhosigma0 = t55 * t262 * t12 / 0.108e3 + t154 * t155 * t280 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t284 = 0.1e1 / t74;
  t285 = t73 * t284;
  t289 = 0.1e1 / t229;
  t295 = t155 * (-0.3e1 / 0.2e1 * t129 * t285 * t160 + t238 * t9 * t289 * t81 / 0.2e1);
  tv2sigma20 = t154 * t295 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t307 = 0.1e1 / t132;
  t309 = t1 * t307 * t17;
  t310 = 0.42e-5 * t309;
  t313 = t1 * t124 * t7 * t182;
  t314 = 0.18666666666666666666e-4 * t313;
  t316 = 0.1e1 / t12 / t122;
  t319 = t189 * t28;
  t320 = t319 * t192;
  t321 = t1 * t316 * t6 * t320;
  t322 = 0.69999999999999999999e-4 * t321;
  t324 = t95 * t196 * t96;
  t325 = 0.93333333333333333334e-1 * t324;
  t327 = t190 * t201 * t192;
  t328 = 0.168e1 * t327;
  t329 = t5 * M_PI;
  t331 = 0.1e1 / t191 / t16;
  t333 = t329 * t90 * t331;
  t334 = 0.672e2 * t333;
  t335 = t11 * t124;
  t336 = t21 * t335;
  t338 = t28 * t316;
  t339 = t27 * t338;
  t347 = t319 * t216;
  t358 = 0.1e1 / t215 / t47;
  t363 = 0.43120379248364176305e-7 * t307 * t48 - 0.47911532498182418116e-6 * t124 * t7 * t207 - 0.44917061717046016982e-5 * t316 * t6 * t347 - 0.11759259259259259259e0 * t113 * t196 * t114 - 0.52916666666666666664e1 * t214 * t201 * t216 - 0.1662426112524598922e4 * t45 * t90 * t358 + 0.19068312757201646091e-4 * t336 - 0.86938271604938271607e-4 * t339 - t310 + t314 + t322 + t325 + t328 + t334;
  t364 = t43 * t363;
  t366 = 0.1e1 / t22 / t229;
  t367 = sigma[0] * t366;
  t372 = 0.1e1 / t135 / t272 * t81;
  t376 = t132 * t132;
  t378 = 0.1e1 / t376 * t81;
  t384 = sqrt(t1);
  t386 = t70 * t237 * params->lm_f / t384;
  t387 = t74 * t239;
  t388 = t376 * rho[0];
  t390 = 0.1e1 / t76 / t388;
  t398 = t59 * (0.8624e4 / 0.243e3 * t367 * t36 + 0.13489e5 / 0.108e3 * t129 * t131 * t372 - 0.1421e4 / 0.36e2 * t238 * t240 * t378 + 0.343e3 / 0.36e2 * t386 * t387 * t390 * t81 - 0.2464e4 / 0.27e2 * t82 * t367);
  t400 = t55 * t398 * t12;
  t403 = t55 * t250 * t23;
  t406 = t55 * t145 * t101;
  t409 = t55 * t86 * t62;
  t411 = t310 - t314 - t322 - t325 - t328 - t334 - 0.20740740740740740741e-4 * t336 + 0.10888888888888888889e-3 * t339 + t364 + t400 / 0.144e3 + t403 / 0.144e3 - t406 / 0.216e3 + 0.5e1 / 0.1944e4 * t409;
  tv3rho30 = -0.42e-5 * t177 + 0.14e-4 * t183 + 0.168e0 * t186 + 0.252e1 * t194 + 0.23333333333333333334e-4 * t197 - 0.14e-3 * t202 + 0.3e1 * t223 + t252 / 0.48e2 + t255 / 0.72e2 - t258 / 0.216e3 + rho[0] * t411;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t413 = t59 * t280;
  t429 = 0.1e1 / t76 / t376;
  t436 = -0.616e3 / 0.81e2 * t225 * t36 - 0.1297e4 / 0.36e2 * t129 * t75 * t232 + 0.511e3 / 0.36e2 * t238 * t271 * t243 - 0.49e2 / 0.12e2 * t386 * t130 * t429 * t81 + 0.176e3 / 0.9e1 * t82 * t225;
  tv3rho2sigma0 = t55 * t413 * t12 / 0.54e2 + t55 * t262 * t23 / 0.324e3 + t154 * t155 * t436 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t440 = t12 * M_PI;
  t451 = 0.1e1 / t76 / t241;
  t457 = t155 * (0.23e2 / 0.4e1 * t129 * t285 * t138 - 0.17e2 / 0.4e1 * t238 * t9 * t273 * t81 + 0.7e1 / 0.4e1 * t386 * t451 * t74 * t81);
  tv3rhosigma20 = t440 * t295 / 0.108e3 + t154 * t457 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t460 = 0.1e1 / t130;
  t461 = t73 * t460;
  t464 = 0.1e1 / sigma[0];
  t465 = t9 * t464;
  t466 = t289 * t81;
  t470 = 0.1e1 / t76 / t272;
  t476 = t155 * (-0.3e1 / 0.4e1 * t386 * t470 * t284 * t81 + 0.3e1 / 0.4e1 * t129 * t461 * t160 + 0.3e1 / 0.4e1 * t238 * t465 * t466);
  tv3sigma30 = t154 * t476 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t499 = 0.85037037037037037035e-4 * t1 * t225 * t7 * t182;
  t501 = 0.1e1 / t12 / t132;
  t505 = 0.46666666666666666666e-3 * t1 * t501 * t6 * t320;
  t508 = 0.48533333333333333333e1 * t190 * t338 * t192;
  t513 = t215 * t215;
  t521 = 0.24888888888888888889e0 * t95 * t335 * t96;
  t523 = t191 * t191;
  t528 = 0.672e3 * t329 * t62 / t523 * t7 * t181;
  t539 = 0.74666666666666666666e-2 * t307 * t331;
  t544 = 0.168e-4 * t1 * t289 * t17;
  t547 = 0.2688e3 * t329 * t175 * t331;
  t549 = t21 * t11 * t225;
  t552 = t27 * t28 * t501;
  t554 = -0.17248151699345670522e-6 * t289 * t48 + 0.66497044500983956879e4 * t45 * t175 * t358 - t499 - t505 - t508 + 0.15287037037037037037e2 * t214 * t338 * t216 + 0.4156065281311497305e5 * t45 * t62 / t513 * t10 * t11 - t521 - t528 + 0.31358024691358024691e0 * t113 * t335 * t114 + 0.21826364804727546031e-5 * t225 * t7 * t207 + 0.29944707811364011322e-4 * t501 * t6 * t347 - t539 + 0.37629629629629629629e-2 * t307 * t358 + t544 - t547 - 0.69917146776406035667e-4 * t549 + 0.28979423868312757202e-3 * t552;
  t570 = sigma[0] / t22 / t272;
  t584 = t376 * t60;
  t591 = t237 * t237;
  t593 = t70 * t591 * t189;
  t599 = t6 * t81;
  t612 = t43 * t554 + t499 + t505 + t508 + t55 * t398 * t23 / 0.108e3 - t55 * t250 * t101 / 0.108e3 + 0.5e1 / 0.486e3 * t55 * t145 * t62 - 0.5e1 / 0.729e3 * t55 * t86 * t124 + t521 + t528 + t55 * t59 * (-0.146608e6 / 0.729e3 * t570 * t36 - 0.207347e6 / 0.216e3 * t129 * t131 / t135 / t241 * t81 + 0.299047e6 / 0.648e3 * t238 * t240 / t388 * t81 - 0.24353e5 / 0.108e3 * t386 * t387 / t76 / t584 * t81 + 0.2401e4 / 0.216e3 * t593 * t239 * sigma[0] / t12 / t376 / t122 * t599 + 0.41888e5 / 0.81e2 * t82 * t570) * t12 / 0.144e3 + t539 - t544 + t547 + 0.76049382716049382717e-4 * t549 - 0.36296296296296296297e-3 * t552;
  tv4rho40 = 0.4e1 * t364 - 0.74666666666666666666e-4 * t313 - 0.28e-3 * t321 - 0.672e1 * t327 + t403 / 0.36e2 - t406 / 0.54e2 + 0.5e1 / 0.486e3 * t409 - 0.37333333333333333333e0 * t324 + t400 / 0.36e2 + 0.168e-4 * t309 - 0.2688e3 * t333 - 0.82962962962962962965e-4 * t336 + 0.43555555555555555556e-3 * t339 + rho[0] * t612;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  tv4rho3sigma0 = t55 * t59 * t436 * t12 / 0.36e2 + t55 * t413 * t23 / 0.108e3 - t55 * t262 * t101 / 0.486e3 + t154 * t155 * (0.8624e4 / 0.243e3 * t366 * t36 + 0.50323e5 / 0.216e3 * t129 * t75 * t372 - 0.30541e5 / 0.216e3 * t238 * t271 * t378 + 0.2989e4 / 0.36e2 * t386 * t130 * t390 * t81 - 0.343e3 / 0.72e2 * t593 * t239 / t12 / t584 * t599 - 0.2464e4 / 0.27e2 * t82 * t366) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho2sigma20 = t23 * M_PI * t295 / 0.324e3 + t440 * t457 / 0.54e2 + t154 * t155 * (-0.667e3 / 0.24e2 * t129 * t285 * t232 + 0.773e3 / 0.24e2 * t238 * t9 * t242 * t81 - 0.329e3 / 0.12e2 * t386 * t429 * t74 * t81 + 0.49e2 / 0.24e2 * t593 / t12 / t388 * sigma[0] * t599) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rhosigma30 = t440 * t476 / 0.108e3 + t154 * t155 * (-0.23e2 / 0.8e1 * t129 * t461 * t138 - 0.23e2 / 0.8e1 * t238 * t465 * t274 + 0.29e2 / 0.4e1 * t386 * t284 * t451 * t81 - 0.7e1 / 0.8e1 * t593 / t12 / t376 * t6 * t81) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4sigma40 = t154 * t155 * (-0.9e1 / 0.8e1 * t129 * t73 / t387 * t160 - 0.9e1 / 0.8e1 * t238 * t9 / t239 * t466 - 0.3e1 / 0.4e1 * t386 * t460 * t470 * t81 + 0.3e1 / 0.8e1 * t593 / t12 / t241 * t464 * t599) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t6, t7, t8, t9, t10;
  double t11, t12, t13, t15, t17, t18, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t49, t52, t53, t55, t57, t58, t63, t64;
  double t65, t66, t67, t69, t70, t71, t72, t74;
  double t75, t77, t78, t79, t81, t82, t87, t88;
  double t89, t90, t91, t92, t93, t94, t95, t96;
  double t98, t99, t100, t101, t102, t104, t105, t106;
  double t107, t112, t113, t114, t116, t121, t124, tzk0;

  gga_c_lm_params *params;

  assert(p->params != NULL);
  params = (gga_c_lm_params * )(p->params);

  t1 = 0.1e1 / M_PI;
  t2 = rho[0] + rho[1];
  t3 = 0.1e1 / t2;
  t6 = 0.1e1 + t1 * t3 / 0.36e5;
  t7 = M_CBRT3;
  t8 = t7 * t7;
  t9 = POW_1_3(t1);
  t10 = 0.1e1 / t9;
  t11 = t8 * t10;
  t12 = M_CBRT4;
  t13 = POW_1_3(t2);
  t15 = t11 * t12 * t13;
  t17 = 0.1e1 + 0.1e2 * t15;
  t18 = log(t17);
  t20 = 0.252e-1 * t6 * t18;
  t21 = t9 * t9;
  t22 = t8 * t21;
  t23 = t13 * t13;
  t24 = 0.1e1 / t23;
  t25 = t12 * t24;
  t26 = t22 * t25;
  t27 = 0.7e-5 * t26;
  t28 = t7 * t9;
  t29 = t12 * t12;
  t32 = t28 * t29 / t13;
  t33 = 0.105e-3 * t32;
  t34 = rho[0] - rho[1];
  t35 = t34 * t3;
  t36 = 0.1e1 + t35;
  t37 = t36 <= p->zeta_threshold;
  t38 = POW_1_3(p->zeta_threshold);
  t39 = t38 * p->zeta_threshold;
  t40 = POW_1_3(t36);
  t41 = t40 * t36;
  t42 = my_piecewise3(t37, t39, t41);
  t43 = 0.1e1 - t35;
  t44 = t43 <= p->zeta_threshold;
  t45 = POW_1_3(t43);
  t46 = t45 * t43;
  t47 = my_piecewise3(t44, t39, t46);
  t49 = M_CBRT2;
  t52 = 0.1e1 / (0.2e1 * t49 - 0.2e1);
  t53 = (t42 + t47 - 0.2e1) * t52;
  t55 = 0.1e1 + 0.56588424210451674939e-6 * t3;
  t57 = 0.1e1 + 0.25e2 * t15;
  t58 = log(t57);
  t63 = -0.127e-1 * t55 * t58 - 0.64355555555555555556e-5 * t26 + 0.83833333333333333334e-4 * t32 - 0.41666666666666666667e-2 + t20;
  t64 = t53 * t63;
  t65 = M_PI * t8;
  t66 = M_PI * M_PI;
  t67 = POW_1_3(t66);
  t69 = 0.1e1 / t67 / t66;
  t70 = rho[0] * rho[0];
  t71 = POW_1_3(rho[0]);
  t72 = t71 * t71;
  t74 = 0.1e1 / t72 / t70;
  t75 = sigma[0] * t74;
  t77 = rho[1] * rho[1];
  t78 = POW_1_3(rho[1]);
  t79 = t78 * t78;
  t81 = 0.1e1 / t79 / t77;
  t82 = sigma[2] * t81;
  t87 = t38 * t38;
  t88 = t87 * p->zeta_threshold;
  t89 = t40 * t40;
  t90 = t89 * t36;
  t91 = my_piecewise3(t37, t88, t90);
  t92 = t45 * t45;
  t93 = t92 * t43;
  t94 = my_piecewise3(t44, t88, t93);
  t95 = t91 + t94;
  t96 = sqrt(t95);
  t98 = M_SQRT2;
  t99 = 0.1e1 / t96 * t98;
  t100 = t7 * params->lm_f;
  t101 = pow(t1, 0.1e1 / 0.6e1);
  t102 = 0.1e1 / t101;
  t104 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t105 = sqrt(t104);
  t106 = t102 * t105;
  t107 = pow(t2, 0.1e1 / 0.6e1);
  t112 = exp(-t100 * t106 / t107 / t2);
  t113 = t112 * t104;
  t114 = t2 * t2;
  t116 = 0.1e1 / t23 / t114;
  t121 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t42 + t82 * t47) + 0.2e1 * t99 * t113 * t116);
  t124 = t65 * t121 * t13 / 0.144e3;
  tzk0 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t6, t7, t8, t9, t10;
  double t11, t12, t13, t15, t17, t18, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t49, t52, t53, t55, t57, t58, t63, t64;
  double t65, t66, t67, t69, t70, t71, t72, t74;
  double t75, t77, t78, t79, t81, t82, t87, t88;
  double t89, t90, t91, t92, t93, t94, t95, t96;
  double t98, t99, t100, t101, t102, t104, t105, t106;
  double t107, t112, t113, t114, t116, t121, t124, tzk0;

  double t125, t127, t128, t130, t131, t133, t134, t136;
  double t137, t138, t139, t140, t142, t143, t144, t145;
  double t146, t149, t150, t153, t155, t156, t160, t161;
  double t167, t168, t171, t172, t182, t183, t184, t187;
  double t190, t191, t194, t195, t196, t197, t198, t199;
  double t200, t202, t203, t206, t207, t209, t212, t214;
  double t216, t217, t219, t220, tvrho0, t223, t226, t227;
  double t230, t232, t233, t237, t238, t247, t250, t251;
  double t255, t257, t258, tvrho1, t261, t262, t263, t267;
  double t268, t270, t271, t272, t273, t274, tvsigma0, t279;
  double tvsigma1, t282, t285, tvsigma2;

  gga_c_lm_params *params;

  assert(p->params != NULL);
  params = (gga_c_lm_params * )(p->params);

  t1 = 0.1e1 / M_PI;
  t2 = rho[0] + rho[1];
  t3 = 0.1e1 / t2;
  t6 = 0.1e1 + t1 * t3 / 0.36e5;
  t7 = M_CBRT3;
  t8 = t7 * t7;
  t9 = POW_1_3(t1);
  t10 = 0.1e1 / t9;
  t11 = t8 * t10;
  t12 = M_CBRT4;
  t13 = POW_1_3(t2);
  t15 = t11 * t12 * t13;
  t17 = 0.1e1 + 0.1e2 * t15;
  t18 = log(t17);
  t20 = 0.252e-1 * t6 * t18;
  t21 = t9 * t9;
  t22 = t8 * t21;
  t23 = t13 * t13;
  t24 = 0.1e1 / t23;
  t25 = t12 * t24;
  t26 = t22 * t25;
  t27 = 0.7e-5 * t26;
  t28 = t7 * t9;
  t29 = t12 * t12;
  t32 = t28 * t29 / t13;
  t33 = 0.105e-3 * t32;
  t34 = rho[0] - rho[1];
  t35 = t34 * t3;
  t36 = 0.1e1 + t35;
  t37 = t36 <= p->zeta_threshold;
  t38 = POW_1_3(p->zeta_threshold);
  t39 = t38 * p->zeta_threshold;
  t40 = POW_1_3(t36);
  t41 = t40 * t36;
  t42 = my_piecewise3(t37, t39, t41);
  t43 = 0.1e1 - t35;
  t44 = t43 <= p->zeta_threshold;
  t45 = POW_1_3(t43);
  t46 = t45 * t43;
  t47 = my_piecewise3(t44, t39, t46);
  t49 = M_CBRT2;
  t52 = 0.1e1 / (0.2e1 * t49 - 0.2e1);
  t53 = (t42 + t47 - 0.2e1) * t52;
  t55 = 0.1e1 + 0.56588424210451674939e-6 * t3;
  t57 = 0.1e1 + 0.25e2 * t15;
  t58 = log(t57);
  t63 = -0.127e-1 * t55 * t58 - 0.64355555555555555556e-5 * t26 + 0.83833333333333333334e-4 * t32 - 0.41666666666666666667e-2 + t20;
  t64 = t53 * t63;
  t65 = M_PI * t8;
  t66 = M_PI * M_PI;
  t67 = POW_1_3(t66);
  t69 = 0.1e1 / t67 / t66;
  t70 = rho[0] * rho[0];
  t71 = POW_1_3(rho[0]);
  t72 = t71 * t71;
  t74 = 0.1e1 / t72 / t70;
  t75 = sigma[0] * t74;
  t77 = rho[1] * rho[1];
  t78 = POW_1_3(rho[1]);
  t79 = t78 * t78;
  t81 = 0.1e1 / t79 / t77;
  t82 = sigma[2] * t81;
  t87 = t38 * t38;
  t88 = t87 * p->zeta_threshold;
  t89 = t40 * t40;
  t90 = t89 * t36;
  t91 = my_piecewise3(t37, t88, t90);
  t92 = t45 * t45;
  t93 = t92 * t43;
  t94 = my_piecewise3(t44, t88, t93);
  t95 = t91 + t94;
  t96 = sqrt(t95);
  t98 = M_SQRT2;
  t99 = 0.1e1 / t96 * t98;
  t100 = t7 * params->lm_f;
  t101 = pow(t1, 0.1e1 / 0.6e1);
  t102 = 0.1e1 / t101;
  t104 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t105 = sqrt(t104);
  t106 = t102 * t105;
  t107 = pow(t2, 0.1e1 / 0.6e1);
  t112 = exp(-t100 * t106 / t107 / t2);
  t113 = t112 * t104;
  t114 = t2 * t2;
  t116 = 0.1e1 / t23 / t114;
  t121 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t42 + t82 * t47) + 0.2e1 * t99 * t113 * t116);
  t124 = t65 * t121 * t13 / 0.144e3;
  tzk0 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = 0.1e1 / t114;
  t127 = t1 * t125 * t18;
  t128 = 0.7e-6 * t127;
  t130 = t6 * t8 * t10;
  t131 = 0.1e1 / t17;
  t133 = t130 * t25 * t131;
  t134 = 0.84e-1 * t133;
  t136 = 0.1e1 / t23 / t2;
  t137 = t12 * t136;
  t138 = t22 * t137;
  t139 = 0.46666666666666666667e-5 * t138;
  t140 = t13 * t2;
  t142 = t29 / t140;
  t143 = t28 * t142;
  t144 = 0.35e-4 * t143;
  t145 = t34 * t125;
  t146 = t3 - t145;
  t149 = my_piecewise3(t37, 0, 0.4e1 / 0.3e1 * t40 * t146);
  t150 = -t146;
  t153 = my_piecewise3(t44, 0, 0.4e1 / 0.3e1 * t45 * t150);
  t155 = (t149 + t153) * t52;
  t156 = t155 * t63;
  t160 = t55 * t8 * t10;
  t161 = 0.1e1 / t57;
  t167 = 0.71867298747273627173e-8 * t125 * t58 - 0.10583333333333333333e0 * t160 * t25 * t161 + 0.42903703703703703704e-5 * t138 - 0.27944444444444444445e-4 * t143 - t128 + t134;
  t168 = t53 * t167;
  t171 = 0.1e1 / t72 / t70 / rho[0];
  t172 = sigma[0] * t171;
  t182 = 0.1e1 / t96 / t95 * t98;
  t183 = t182 * t112;
  t184 = t104 * t116;
  t187 = my_piecewise3(t37, 0, 0.5e1 / 0.3e1 * t89 * t146);
  t190 = my_piecewise3(t44, 0, 0.5e1 / 0.3e1 * t92 * t150);
  t191 = t187 + t190;
  t194 = t99 * t100;
  t195 = t105 * t104;
  t196 = t102 * t195;
  t197 = t114 * t114;
  t198 = t107 * t107;
  t199 = t198 * t198;
  t200 = t199 * t107;
  t202 = 0.1e1 / t200 / t197;
  t203 = t202 * t112;
  t206 = 0.7e1 / 0.3e1 * t194 * t196 * t203;
  t207 = t114 * t2;
  t209 = 0.1e1 / t23 / t207;
  t212 = 0.16e2 / 0.3e1 * t99 * t113 * t209;
  t214 = t69 * (-0.7e1 / 0.36e2 * t49 * (-0.8e1 / 0.3e1 * t172 * t42 + t75 * t149 + t82 * t153) - t183 * t184 * t191 + t206 - t212);
  t216 = t65 * t214 * t13;
  t217 = t216 / 0.144e3;
  t219 = t65 * t121 * t24;
  t220 = t219 / 0.432e3;
  tvrho0 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124 + t2 * (t128 - t134 - t139 + t144 + t156 + t168 + t217 + t220);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t223 = -t3 - t145;
  t226 = my_piecewise3(t37, 0, 0.4e1 / 0.3e1 * t40 * t223);
  t227 = -t223;
  t230 = my_piecewise3(t44, 0, 0.4e1 / 0.3e1 * t45 * t227);
  t232 = (t226 + t230) * t52;
  t233 = t232 * t63;
  t237 = 0.1e1 / t79 / t77 / rho[1];
  t238 = sigma[2] * t237;
  t247 = my_piecewise3(t37, 0, 0.5e1 / 0.3e1 * t89 * t223);
  t250 = my_piecewise3(t44, 0, 0.5e1 / 0.3e1 * t92 * t227);
  t251 = t247 + t250;
  t255 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t226 - 0.8e1 / 0.3e1 * t238 * t47 + t82 * t230) - t183 * t184 * t251 + t206 - t212);
  t257 = t65 * t255 * t13;
  t258 = t257 / 0.144e3;
  tvrho1 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124 + t2 * (t128 - t134 - t139 + t144 + t233 + t168 + t258 + t220);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t261 = t140 * M_PI;
  t262 = t8 * t69;
  t263 = t49 * t74;
  t267 = 0.1e1 / t200 / t207;
  t268 = t267 * t112;
  t270 = t194 * t106 * t268;
  t271 = t112 * t116;
  t272 = t99 * t271;
  t273 = 0.2e1 * t272;
  t274 = -0.7e1 / 0.36e2 * t263 * t42 - t270 + t273;
  tvsigma0 = t261 * t262 * t274 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t279 = -0.2e1 * t270 + 0.4e1 * t272;
  tvsigma1 = t261 * t262 * t279 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t282 = t49 * t81;
  t285 = -0.7e1 / 0.36e2 * t282 * t47 - t270 + t273;
  tvsigma2 = t261 * t262 * t285 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t6, t7, t8, t9, t10;
  double t11, t12, t13, t15, t17, t18, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t49, t52, t53, t55, t57, t58, t63, t64;
  double t65, t66, t67, t69, t70, t71, t72, t74;
  double t75, t77, t78, t79, t81, t82, t87, t88;
  double t89, t90, t91, t92, t93, t94, t95, t96;
  double t98, t99, t100, t101, t102, t104, t105, t106;
  double t107, t112, t113, t114, t116, t121, t124, tzk0;

  double t125, t127, t128, t130, t131, t133, t134, t136;
  double t137, t138, t139, t140, t142, t143, t144, t145;
  double t146, t149, t150, t153, t155, t156, t160, t161;
  double t167, t168, t171, t172, t182, t183, t184, t187;
  double t190, t191, t194, t195, t196, t197, t198, t199;
  double t200, t202, t203, t206, t207, t209, t212, t214;
  double t216, t217, t219, t220, tvrho0, t223, t226, t227;
  double t230, t232, t233, t237, t238, t247, t250, t251;
  double t255, t257, t258, tvrho1, t261, t262, t263, t267;
  double t268, t270, t271, t272, t273, t274, tvsigma0, t279;
  double tvsigma1, t282, t285, tvsigma2;

  double t288, t289, t290, t291, t293, t295, t296, t298;
  double t299, t302, t303, t304, t305, t307, t308, t310;
  double t311, t312, t313, t315, t316, t317, t318, t319;
  double t322, t323, t324, t325, t326, t329, t331, t335;
  double t336, t337, t340, t344, t346, t347, t348, t349;
  double t353, t360, t361, t362, t368, t369, t370, t372;
  double t373, t383, t386, t387, t388, t392, t393, t395;
  double t397, t399, t401, t407, t408, t414, t415, t418;
  double t420, t421, t424, t425, t426, t427, t428, t429;
  double t430, t431, t432, t435, t437, t440, t442, t444;
  double t445, t447, t448, t450, t451, t452, tv2rho20, t454;
  double t457, t461, t462, t465, t469, t471, t472, t473;
  double t483, t487, t489, t492, t494, t497, t501, t502;
  double t505, t509, t510, t516, t518, t521, t524, tv2rho21;
  double t528, t532, t536, t537, t540, t544, t546, t547;
  double t548, t550, t552, t553, t562, t573, t579, t580;
  double t584, t586, t587, t588, t589, tv2rho22, t591, t594;
  double t595, t600, t602, t603, t605, t606, t607, t608;
  double t609, t610, t612, t613, t615, t616, t617, t618;
  double t619, tv2rhosigma0, t623, t626, t627, t628, t630, t631;
  double tv2rhosigma1, t635, t638, t641, tv2rhosigma2, t647, t649, t650;
  double t652, t654, tv2rhosigma3, t659, tv2rhosigma4, t662, t668, tv2rhosigma5;
  double t671, t672, t674, t676, t677, t678, t679, t681;
  double t684, tv2sigma20, t688, tv2sigma21, tv2sigma22, t693, tv2sigma23, tv2sigma24;
  double tv2sigma25;

  gga_c_lm_params *params;

  assert(p->params != NULL);
  params = (gga_c_lm_params * )(p->params);

  t1 = 0.1e1 / M_PI;
  t2 = rho[0] + rho[1];
  t3 = 0.1e1 / t2;
  t6 = 0.1e1 + t1 * t3 / 0.36e5;
  t7 = M_CBRT3;
  t8 = t7 * t7;
  t9 = POW_1_3(t1);
  t10 = 0.1e1 / t9;
  t11 = t8 * t10;
  t12 = M_CBRT4;
  t13 = POW_1_3(t2);
  t15 = t11 * t12 * t13;
  t17 = 0.1e1 + 0.1e2 * t15;
  t18 = log(t17);
  t20 = 0.252e-1 * t6 * t18;
  t21 = t9 * t9;
  t22 = t8 * t21;
  t23 = t13 * t13;
  t24 = 0.1e1 / t23;
  t25 = t12 * t24;
  t26 = t22 * t25;
  t27 = 0.7e-5 * t26;
  t28 = t7 * t9;
  t29 = t12 * t12;
  t32 = t28 * t29 / t13;
  t33 = 0.105e-3 * t32;
  t34 = rho[0] - rho[1];
  t35 = t34 * t3;
  t36 = 0.1e1 + t35;
  t37 = t36 <= p->zeta_threshold;
  t38 = POW_1_3(p->zeta_threshold);
  t39 = t38 * p->zeta_threshold;
  t40 = POW_1_3(t36);
  t41 = t40 * t36;
  t42 = my_piecewise3(t37, t39, t41);
  t43 = 0.1e1 - t35;
  t44 = t43 <= p->zeta_threshold;
  t45 = POW_1_3(t43);
  t46 = t45 * t43;
  t47 = my_piecewise3(t44, t39, t46);
  t49 = M_CBRT2;
  t52 = 0.1e1 / (0.2e1 * t49 - 0.2e1);
  t53 = (t42 + t47 - 0.2e1) * t52;
  t55 = 0.1e1 + 0.56588424210451674939e-6 * t3;
  t57 = 0.1e1 + 0.25e2 * t15;
  t58 = log(t57);
  t63 = -0.127e-1 * t55 * t58 - 0.64355555555555555556e-5 * t26 + 0.83833333333333333334e-4 * t32 - 0.41666666666666666667e-2 + t20;
  t64 = t53 * t63;
  t65 = M_PI * t8;
  t66 = M_PI * M_PI;
  t67 = POW_1_3(t66);
  t69 = 0.1e1 / t67 / t66;
  t70 = rho[0] * rho[0];
  t71 = POW_1_3(rho[0]);
  t72 = t71 * t71;
  t74 = 0.1e1 / t72 / t70;
  t75 = sigma[0] * t74;
  t77 = rho[1] * rho[1];
  t78 = POW_1_3(rho[1]);
  t79 = t78 * t78;
  t81 = 0.1e1 / t79 / t77;
  t82 = sigma[2] * t81;
  t87 = t38 * t38;
  t88 = t87 * p->zeta_threshold;
  t89 = t40 * t40;
  t90 = t89 * t36;
  t91 = my_piecewise3(t37, t88, t90);
  t92 = t45 * t45;
  t93 = t92 * t43;
  t94 = my_piecewise3(t44, t88, t93);
  t95 = t91 + t94;
  t96 = sqrt(t95);
  t98 = M_SQRT2;
  t99 = 0.1e1 / t96 * t98;
  t100 = t7 * params->lm_f;
  t101 = pow(t1, 0.1e1 / 0.6e1);
  t102 = 0.1e1 / t101;
  t104 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t105 = sqrt(t104);
  t106 = t102 * t105;
  t107 = pow(t2, 0.1e1 / 0.6e1);
  t112 = exp(-t100 * t106 / t107 / t2);
  t113 = t112 * t104;
  t114 = t2 * t2;
  t116 = 0.1e1 / t23 / t114;
  t121 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t42 + t82 * t47) + 0.2e1 * t99 * t113 * t116);
  t124 = t65 * t121 * t13 / 0.144e3;
  tzk0 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = 0.1e1 / t114;
  t127 = t1 * t125 * t18;
  t128 = 0.7e-6 * t127;
  t130 = t6 * t8 * t10;
  t131 = 0.1e1 / t17;
  t133 = t130 * t25 * t131;
  t134 = 0.84e-1 * t133;
  t136 = 0.1e1 / t23 / t2;
  t137 = t12 * t136;
  t138 = t22 * t137;
  t139 = 0.46666666666666666667e-5 * t138;
  t140 = t13 * t2;
  t142 = t29 / t140;
  t143 = t28 * t142;
  t144 = 0.35e-4 * t143;
  t145 = t34 * t125;
  t146 = t3 - t145;
  t149 = my_piecewise3(t37, 0, 0.4e1 / 0.3e1 * t40 * t146);
  t150 = -t146;
  t153 = my_piecewise3(t44, 0, 0.4e1 / 0.3e1 * t45 * t150);
  t155 = (t149 + t153) * t52;
  t156 = t155 * t63;
  t160 = t55 * t8 * t10;
  t161 = 0.1e1 / t57;
  t167 = 0.71867298747273627173e-8 * t125 * t58 - 0.10583333333333333333e0 * t160 * t25 * t161 + 0.42903703703703703704e-5 * t138 - 0.27944444444444444445e-4 * t143 - t128 + t134;
  t168 = t53 * t167;
  t171 = 0.1e1 / t72 / t70 / rho[0];
  t172 = sigma[0] * t171;
  t182 = 0.1e1 / t96 / t95 * t98;
  t183 = t182 * t112;
  t184 = t104 * t116;
  t187 = my_piecewise3(t37, 0, 0.5e1 / 0.3e1 * t89 * t146);
  t190 = my_piecewise3(t44, 0, 0.5e1 / 0.3e1 * t92 * t150);
  t191 = t187 + t190;
  t194 = t99 * t100;
  t195 = t105 * t104;
  t196 = t102 * t195;
  t197 = t114 * t114;
  t198 = t107 * t107;
  t199 = t198 * t198;
  t200 = t199 * t107;
  t202 = 0.1e1 / t200 / t197;
  t203 = t202 * t112;
  t206 = 0.7e1 / 0.3e1 * t194 * t196 * t203;
  t207 = t114 * t2;
  t209 = 0.1e1 / t23 / t207;
  t212 = 0.16e2 / 0.3e1 * t99 * t113 * t209;
  t214 = t69 * (-0.7e1 / 0.36e2 * t49 * (-0.8e1 / 0.3e1 * t172 * t42 + t75 * t149 + t82 * t153) - t183 * t184 * t191 + t206 - t212);
  t216 = t65 * t214 * t13;
  t217 = t216 / 0.144e3;
  t219 = t65 * t121 * t24;
  t220 = t219 / 0.432e3;
  tvrho0 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124 + t2 * (t128 - t134 - t139 + t144 + t156 + t168 + t217 + t220);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t223 = -t3 - t145;
  t226 = my_piecewise3(t37, 0, 0.4e1 / 0.3e1 * t40 * t223);
  t227 = -t223;
  t230 = my_piecewise3(t44, 0, 0.4e1 / 0.3e1 * t45 * t227);
  t232 = (t226 + t230) * t52;
  t233 = t232 * t63;
  t237 = 0.1e1 / t79 / t77 / rho[1];
  t238 = sigma[2] * t237;
  t247 = my_piecewise3(t37, 0, 0.5e1 / 0.3e1 * t89 * t223);
  t250 = my_piecewise3(t44, 0, 0.5e1 / 0.3e1 * t92 * t227);
  t251 = t247 + t250;
  t255 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t226 - 0.8e1 / 0.3e1 * t238 * t47 + t82 * t230) - t183 * t184 * t251 + t206 - t212);
  t257 = t65 * t255 * t13;
  t258 = t257 / 0.144e3;
  tvrho1 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124 + t2 * (t128 - t134 - t139 + t144 + t233 + t168 + t258 + t220);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t261 = t140 * M_PI;
  t262 = t8 * t69;
  t263 = t49 * t74;
  t267 = 0.1e1 / t200 / t207;
  t268 = t267 * t112;
  t270 = t194 * t106 * t268;
  t271 = t112 * t116;
  t272 = t99 * t271;
  t273 = 0.2e1 * t272;
  t274 = -0.7e1 / 0.36e2 * t263 * t42 - t270 + t273;
  tvsigma0 = t261 * t262 * t274 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t279 = -0.2e1 * t270 + 0.4e1 * t272;
  tvsigma1 = t261 * t262 * t279 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t282 = t49 * t81;
  t285 = -0.7e1 / 0.36e2 * t282 * t47 - t270 + t273;
  tvsigma2 = t261 * t262 * t285 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t288 = 0.14e-5 * t127;
  t289 = 0.168e0 * t133;
  t290 = 0.93333333333333333334e-5 * t138;
  t291 = 0.7e-4 * t143;
  t293 = 0.2e1 * t168;
  t295 = t219 / 0.216e3;
  t296 = 0.1e1 / t207;
  t298 = t1 * t296 * t18;
  t299 = 0.14e-5 * t298;
  t302 = t10 * t12;
  t303 = t302 * t131;
  t304 = t1 * t116 * t8 * t303;
  t305 = 0.46666666666666666666e-5 * t304;
  t307 = t130 * t137 * t131;
  t308 = 0.56e-1 * t307;
  t310 = 0.1e1 / t21;
  t311 = t6 * t7 * t310;
  t312 = t17 * t17;
  t313 = 0.1e1 / t312;
  t315 = t311 * t142 * t313;
  t316 = 0.84e0 * t315;
  t317 = t12 * t116;
  t318 = t22 * t317;
  t319 = 0.77777777777777777778e-5 * t318;
  t322 = t29 / t13 / t114;
  t323 = t28 * t322;
  t324 = 0.46666666666666666667e-4 * t323;
  t325 = 0.1e1 / t89;
  t326 = t146 * t146;
  t329 = t34 * t296;
  t331 = -0.2e1 * t125 + 0.2e1 * t329;
  t335 = my_piecewise3(t37, 0, 0.4e1 / 0.9e1 * t325 * t326 + 0.4e1 / 0.3e1 * t40 * t331);
  t336 = 0.1e1 / t92;
  t337 = t150 * t150;
  t340 = -t331;
  t344 = my_piecewise3(t44, 0, 0.4e1 / 0.9e1 * t336 * t337 + 0.4e1 / 0.3e1 * t45 * t340);
  t346 = (t335 + t344) * t52;
  t347 = t346 * t63;
  t348 = t155 * t167;
  t349 = 0.2e1 * t348;
  t353 = t302 * t161;
  t360 = t55 * t7 * t310;
  t361 = t57 * t57;
  t362 = 0.1e1 / t361;
  t368 = -0.14373459749454725435e-7 * t296 * t58 + 0.11977883124545604529e-6 * t116 * t8 * t353 + 0.70555555555555555553e-1 * t160 * t137 * t161 + 0.26458333333333333332e1 * t360 * t142 * t362 - 0.7150617283950617284e-5 * t318 + 0.3725925925925925926e-4 * t323 + t299 - t305 - t308 - t316;
  t369 = t53 * t368;
  t370 = t70 * t70;
  t372 = 0.1e1 / t72 / t370;
  t373 = sigma[0] * t372;
  t383 = t95 * t95;
  t386 = 0.1e1 / t96 / t383 * t98;
  t387 = t386 * t112;
  t388 = t191 * t191;
  t392 = t182 * t100;
  t393 = t203 * t191;
  t395 = t392 * t196 * t393;
  t397 = t104 * t209;
  t399 = t183 * t397 * t191;
  t401 = 0.1e1 / t40;
  t407 = my_piecewise3(t37, 0, 0.1e2 / 0.9e1 * t401 * t326 + 0.5e1 / 0.3e1 * t89 * t331);
  t408 = 0.1e1 / t45;
  t414 = my_piecewise3(t44, 0, 0.1e2 / 0.9e1 * t408 * t337 + 0.5e1 / 0.3e1 * t92 * t340);
  t415 = t407 + t414;
  t418 = t197 * t2;
  t420 = 0.1e1 / t200 / t418;
  t421 = t420 * t112;
  t424 = 0.35e2 / 0.2e1 * t194 * t196 * t421;
  t425 = params->lm_f * params->lm_f;
  t426 = t8 * t425;
  t427 = t99 * t426;
  t428 = t104 * t104;
  t429 = t10 * t428;
  t430 = t197 * t207;
  t431 = 0.1e1 / t430;
  t432 = t431 * t112;
  t435 = 0.49e2 / 0.18e2 * t427 * t429 * t432;
  t437 = 0.1e1 / t23 / t197;
  t440 = 0.176e3 / 0.9e1 * t99 * t113 * t437;
  t442 = t69 * (-0.7e1 / 0.36e2 * t49 * (0.88e2 / 0.9e1 * t373 * t42 - 0.16e2 / 0.3e1 * t172 * t149 + t75 * t335 + t82 * t344) + 0.3e1 / 0.2e1 * t387 * t184 * t388 - 0.7e1 / 0.3e1 * t395 + 0.16e2 / 0.3e1 * t399 - t183 * t184 * t415 - t424 + t435 + t440);
  t444 = t65 * t442 * t13;
  t445 = t444 / 0.144e3;
  t447 = t65 * t214 * t24;
  t448 = t447 / 0.216e3;
  t450 = t65 * t121 * t136;
  t451 = t450 / 0.648e3;
  t452 = -t299 + t305 + t308 + t316 + t319 - t324 + t347 + t349 + t369 + t445 + t448 - t451;
  tv2rho20 = t288 - t289 - t290 + t291 + 0.2e1 * t156 + t293 + t216 / 0.72e2 + t295 + t2 * t452;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t454 = t325 * t223;
  t457 = t40 * t34;
  t461 = my_piecewise3(t37, 0, 0.4e1 / 0.9e1 * t454 * t146 + 0.8e1 / 0.3e1 * t457 * t296);
  t462 = t336 * t227;
  t465 = t45 * t34;
  t469 = my_piecewise3(t44, 0, 0.4e1 / 0.9e1 * t462 * t150 - 0.8e1 / 0.3e1 * t465 * t296);
  t471 = (t461 + t469) * t52;
  t472 = t471 * t63;
  t473 = t232 * t167;
  t483 = t251 * t191;
  t487 = t203 * t251;
  t489 = t392 * t196 * t487;
  t492 = t183 * t397 * t251;
  t494 = t401 * t223;
  t497 = t89 * t34;
  t501 = my_piecewise3(t37, 0, 0.1e2 / 0.9e1 * t494 * t146 + 0.1e2 / 0.3e1 * t497 * t296);
  t502 = t408 * t227;
  t505 = t92 * t34;
  t509 = my_piecewise3(t44, 0, 0.1e2 / 0.9e1 * t502 * t150 - 0.1e2 / 0.3e1 * t505 * t296);
  t510 = t501 + t509;
  t516 = t69 * (-0.7e1 / 0.36e2 * t49 * (-0.8e1 / 0.3e1 * t172 * t226 + t75 * t461 - 0.8e1 / 0.3e1 * t238 * t153 + t82 * t469) + 0.3e1 / 0.2e1 * t387 * t184 * t483 - 0.7e1 / 0.6e1 * t489 + 0.8e1 / 0.3e1 * t492 - t183 * t184 * t510 - 0.7e1 / 0.6e1 * t395 - t424 + t435 + 0.8e1 / 0.3e1 * t399 + t440);
  t518 = t65 * t516 * t13;
  t521 = t65 * t255 * t24;
  t524 = -t299 + t305 + t308 + t316 + t319 - t324 + t472 + t473 + t348 + t369 + t518 / 0.144e3 + t521 / 0.432e3 + t447 / 0.432e3 - t451;
  tv2rho21 = t2 * t524 + t156 + t217 + t233 + t258 + t288 - t289 - t290 + t291 + t293 + t295;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t528 = t223 * t223;
  t532 = 0.2e1 * t125 + 0.2e1 * t329;
  t536 = my_piecewise3(t37, 0, 0.4e1 / 0.9e1 * t325 * t528 + 0.4e1 / 0.3e1 * t40 * t532);
  t537 = t227 * t227;
  t540 = -t532;
  t544 = my_piecewise3(t44, 0, 0.4e1 / 0.9e1 * t336 * t537 + 0.4e1 / 0.3e1 * t45 * t540);
  t546 = (t536 + t544) * t52;
  t547 = t546 * t63;
  t548 = 0.2e1 * t473;
  t550 = t77 * t77;
  t552 = 0.1e1 / t79 / t550;
  t553 = sigma[2] * t552;
  t562 = t251 * t251;
  t573 = my_piecewise3(t37, 0, 0.1e2 / 0.9e1 * t401 * t528 + 0.5e1 / 0.3e1 * t89 * t532);
  t579 = my_piecewise3(t44, 0, 0.1e2 / 0.9e1 * t408 * t537 + 0.5e1 / 0.3e1 * t92 * t540);
  t580 = t573 + t579;
  t584 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t536 + 0.88e2 / 0.9e1 * t553 * t47 - 0.16e2 / 0.3e1 * t238 * t230 + t82 * t544) + 0.3e1 / 0.2e1 * t387 * t184 * t562 - 0.7e1 / 0.3e1 * t489 + 0.16e2 / 0.3e1 * t492 - t183 * t184 * t580 - t424 + t435 + t440);
  t586 = t65 * t584 * t13;
  t587 = t586 / 0.144e3;
  t588 = t521 / 0.216e3;
  t589 = -t299 + t305 + t308 + t316 + t319 - t324 + t547 + t548 + t369 + t587 + t588 - t451;
  tv2rho22 = t288 - t289 - t290 + t291 + 0.2e1 * t233 + t293 + t257 / 0.72e2 + t295 + t2 * t589;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t591 = t69 * t274;
  t594 = t65 * t591 * t13 / 0.108e3;
  t595 = t49 * t171;
  t600 = t268 * t191;
  t602 = t392 * t106 * t600;
  t603 = t602 / 0.2e1;
  t605 = t194 * t106 * t203;
  t606 = 0.37e2 / 0.6e1 * t605;
  t607 = t10 * t104;
  t608 = t197 * t114;
  t609 = 0.1e1 / t608;
  t610 = t609 * t112;
  t612 = t427 * t607 * t610;
  t613 = 0.7e1 / 0.6e1 * t612;
  t615 = t182 * t271 * t191;
  t616 = t112 * t209;
  t617 = t99 * t616;
  t618 = 0.16e2 / 0.3e1 * t617;
  t619 = 0.14e2 / 0.27e2 * t595 * t42 - 0.7e1 / 0.36e2 * t263 * t149 + t603 + t606 - t613 - t615 - t618;
  tv2rhosigma0 = t594 + t261 * t262 * t619 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t623 = t69 * t279;
  t626 = t65 * t623 * t13 / 0.108e3;
  t627 = 0.37e2 / 0.3e1 * t605;
  t628 = 0.7e1 / 0.3e1 * t612;
  t630 = 0.32e2 / 0.3e1 * t617;
  t631 = t602 + t627 - t628 - 0.2e1 * t615 - t630;
  tv2rhosigma1 = t626 + t261 * t262 * t631 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t635 = t69 * t285;
  t638 = t65 * t635 * t13 / 0.108e3;
  t641 = -0.7e1 / 0.36e2 * t282 * t153 + t603 + t606 - t613 - t615 - t618;
  tv2rhosigma2 = t638 + t261 * t262 * t641 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t647 = t268 * t251;
  t649 = t392 * t106 * t647;
  t650 = t649 / 0.2e1;
  t652 = t182 * t271 * t251;
  t654 = t262 * (-0.7e1 / 0.36e2 * t263 * t226 + t650 + t606 - t613 - t652 - t618);
  tv2rhosigma3 = t594 + t261 * t654 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  t659 = t262 * (t649 + t627 - t628 - 0.2e1 * t652 - t630);
  tv2rhosigma4 = t626 + t261 * t659 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t662 = t49 * t237;
  t668 = t262 * (0.14e2 / 0.27e2 * t662 * t47 - 0.7e1 / 0.36e2 * t282 * t230 + t650 + t606 - t613 - t652 - t618);
  tv2rhosigma5 = t638 + t261 * t668 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t671 = 0.1e1 / t105;
  t672 = t102 * t671;
  t674 = t194 * t672 * t268;
  t676 = t99 * t8;
  t677 = t425 * t10;
  t678 = 0.1e1 / t418;
  t679 = t678 * t112;
  t681 = t676 * t677 * t679;
  t684 = t262 * (-0.3e1 / 0.2e1 * t674 + t681 / 0.2e1);
  tv2sigma20 = t261 * t684 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t688 = t262 * (-0.3e1 * t674 + t681);
  tv2sigma21 = t261 * t688 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = tv2sigma20;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  t693 = t262 * (-0.6e1 * t674 + 0.2e1 * t681);
  tv2sigma23 = t261 * t693 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = tv2sigma21;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = tv2sigma22;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t6, t7, t8, t9, t10;
  double t11, t12, t13, t15, t17, t18, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t49, t52, t53, t55, t57, t58, t63, t64;
  double t65, t66, t67, t69, t70, t71, t72, t74;
  double t75, t77, t78, t79, t81, t82, t87, t88;
  double t89, t90, t91, t92, t93, t94, t95, t96;
  double t98, t99, t100, t101, t102, t104, t105, t106;
  double t107, t112, t113, t114, t116, t121, t124, tzk0;

  double t125, t127, t128, t130, t131, t133, t134, t136;
  double t137, t138, t139, t140, t142, t143, t144, t145;
  double t146, t149, t150, t153, t155, t156, t160, t161;
  double t167, t168, t171, t172, t182, t183, t184, t187;
  double t190, t191, t194, t195, t196, t197, t198, t199;
  double t200, t202, t203, t206, t207, t209, t212, t214;
  double t216, t217, t219, t220, tvrho0, t223, t226, t227;
  double t230, t232, t233, t237, t238, t247, t250, t251;
  double t255, t257, t258, tvrho1, t261, t262, t263, t267;
  double t268, t270, t271, t272, t273, t274, tvsigma0, t279;
  double tvsigma1, t282, t285, tvsigma2;

  double t288, t289, t290, t291, t293, t295, t296, t298;
  double t299, t302, t303, t304, t305, t307, t308, t310;
  double t311, t312, t313, t315, t316, t317, t318, t319;
  double t322, t323, t324, t325, t326, t329, t331, t335;
  double t336, t337, t340, t344, t346, t347, t348, t349;
  double t353, t360, t361, t362, t368, t369, t370, t372;
  double t373, t383, t386, t387, t388, t392, t393, t395;
  double t397, t399, t401, t407, t408, t414, t415, t418;
  double t420, t421, t424, t425, t426, t427, t428, t429;
  double t430, t431, t432, t435, t437, t440, t442, t444;
  double t445, t447, t448, t450, t451, t452, tv2rho20, t454;
  double t457, t461, t462, t465, t469, t471, t472, t473;
  double t483, t487, t489, t492, t494, t497, t501, t502;
  double t505, t509, t510, t516, t518, t521, t524, tv2rho21;
  double t528, t532, t536, t537, t540, t544, t546, t547;
  double t548, t550, t552, t553, t562, t573, t579, t580;
  double t584, t586, t587, t588, t589, tv2rho22, t591, t594;
  double t595, t600, t602, t603, t605, t606, t607, t608;
  double t609, t610, t612, t613, t615, t616, t617, t618;
  double t619, tv2rhosigma0, t623, t626, t627, t628, t630, t631;
  double tv2rhosigma1, t635, t638, t641, tv2rhosigma2, t647, t649, t650;
  double t652, t654, tv2rhosigma3, t659, tv2rhosigma4, t662, t668, tv2rhosigma5;
  double t671, t672, t674, t676, t677, t678, t679, t681;
  double t684, tv2sigma20, t688, tv2sigma21, tv2sigma22, t693, tv2sigma23, tv2sigma24;
  double tv2sigma25;

  double t695, t698, t699, t700, t702, t703, t704, t706;
  double t707, t709, t710, t713, t714, t716, t719, t720;
  double t721, t722, t724, t725, t727, t728, t729, t731;
  double t733, t734, t735, t736, t737, t738, t739, t740;
  double t741, t742, t745, t748, t750, t754, t755, t756;
  double t759, t762, t766, t768, t769, t770, t772, t773;
  double t780, t791, t796, t797, t798, t800, t802, t804;
  double t807, t811, t812, t813, t818, t820, t824, t826;
  double t828, t829, t830, t831, t832, t833, t834, t836;
  double t837, t840, t841, t842, t844, t846, t848, t850;
  double t851, t853, t857, t860, t862, t864, t867, t873;
  double t874, t877, t883, t884, t888, t891, t894, t895;
  double t907, t908, t910, t911, t913, t916, t917, t919;
  double t920, t921, tv3rho30, t924, t925, t926, t927, t928;
  double t929, t930, t933, t934, t936, t943, t946, t947;
  double t957, t961, t964, t965, t975, t980, t986, t989;
  double t990, t993, t1003, t1004, t1007, t1017, t1018, t1021;
  double t1025, t1029, t1031, t1038, t1041, t1042, t1044, t1047;
  double t1049, t1051, t1055, t1056, t1057, t1058, t1059, t1061;
  double t1066, t1069, t1071, tv3rho31, t1073, t1078, t1083, t1087;
  double t1088, t1093, t1096, t1100, t1102, t1103, t1104, t1107;
  double t1109, t1113, t1118, t1120, t1125, t1131, t1132, t1137;
  double t1143, t1144, t1149, t1151, t1169, t1171, t1173, t1175;
  double t1177, t1179, t1181, t1184, t1188, tv3rho32, t1195, t1201;
  double t1205, t1206, t1211, t1215, t1217, t1218, t1220, t1221;
  double t1225, t1238, t1246, t1247, t1258, t1259, t1270, t1271;
  double t1273, t1274, t1276, t1277, tv3rho33, t1279, t1281, t1285;
  double t1286, t1293, t1295, t1296, t1298, t1299, t1302, t1303;
  double t1304, t1306, t1307, t1309, t1310, t1312, t1313, t1314;
  double t1316, t1319, t1320, t1322, t1323, t1325, t1326, t1328;
  double t1329, t1330, t1331, t1332, tv3rho2sigma0, t1336, t1338, t1342;
  double t1346, t1347, t1348, t1352, t1353, tv3rho2sigma1, t1357, t1359;
  double t1363, t1366, tv3rho2sigma2, t1371, t1372, t1378, t1380, t1381;
  double t1383, t1384, t1387, t1388, t1389, t1391, t1392, t1393;
  double t1394, t1395, t1397, t1398, t1400, t1401, t1403, t1404;
  double t1405, t1406, tv3rho2sigma3, t1410, t1413, t1414, t1416, t1418;
  double t1419, tv3rho2sigma4, t1423, t1429, t1430, tv3rho2sigma5, t1436, t1438;
  double t1439, t1440, t1442, t1443, t1445, t1446, t1448, t1449;
  double t1450, tv3rho2sigma6, t1460, t1461, tv3rho2sigma7, t1465, t1472, t1473;
  double tv3rho2sigma8, t1477, t1479, t1482, t1483, t1485, t1486, t1487;
  double t1488, t1490, t1493, t1495, t1497, t1498, t1500, tv3rhosigma20;
  double t1504, t1506, t1507, t1509, t1511, tv3rhosigma21, tv3rhosigma22, t1515;
  double t1517, t1518, t1519, t1521, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, t1525;
  double t1528, t1531, tv3rhosigma26, t1537, tv3rhosigma27, tv3rhosigma28, t1542, tv3rhosigma29;
  double tv3rhosigma210, tv3rhosigma211, t1545, t1546, t1549, t1550, t1554, t1559;
  double t1561, tv3sigma30, t1564, tv3sigma31, tv3sigma32, t1567, tv3sigma33, tv3sigma34;
  double tv3sigma35, t1570, tv3sigma36, tv3sigma37, tv3sigma38, tv3sigma39;

  gga_c_lm_params *params;

  assert(p->params != NULL);
  params = (gga_c_lm_params * )(p->params);

  t1 = 0.1e1 / M_PI;
  t2 = rho[0] + rho[1];
  t3 = 0.1e1 / t2;
  t6 = 0.1e1 + t1 * t3 / 0.36e5;
  t7 = M_CBRT3;
  t8 = t7 * t7;
  t9 = POW_1_3(t1);
  t10 = 0.1e1 / t9;
  t11 = t8 * t10;
  t12 = M_CBRT4;
  t13 = POW_1_3(t2);
  t15 = t11 * t12 * t13;
  t17 = 0.1e1 + 0.1e2 * t15;
  t18 = log(t17);
  t20 = 0.252e-1 * t6 * t18;
  t21 = t9 * t9;
  t22 = t8 * t21;
  t23 = t13 * t13;
  t24 = 0.1e1 / t23;
  t25 = t12 * t24;
  t26 = t22 * t25;
  t27 = 0.7e-5 * t26;
  t28 = t7 * t9;
  t29 = t12 * t12;
  t32 = t28 * t29 / t13;
  t33 = 0.105e-3 * t32;
  t34 = rho[0] - rho[1];
  t35 = t34 * t3;
  t36 = 0.1e1 + t35;
  t37 = t36 <= p->zeta_threshold;
  t38 = POW_1_3(p->zeta_threshold);
  t39 = t38 * p->zeta_threshold;
  t40 = POW_1_3(t36);
  t41 = t40 * t36;
  t42 = my_piecewise3(t37, t39, t41);
  t43 = 0.1e1 - t35;
  t44 = t43 <= p->zeta_threshold;
  t45 = POW_1_3(t43);
  t46 = t45 * t43;
  t47 = my_piecewise3(t44, t39, t46);
  t49 = M_CBRT2;
  t52 = 0.1e1 / (0.2e1 * t49 - 0.2e1);
  t53 = (t42 + t47 - 0.2e1) * t52;
  t55 = 0.1e1 + 0.56588424210451674939e-6 * t3;
  t57 = 0.1e1 + 0.25e2 * t15;
  t58 = log(t57);
  t63 = -0.127e-1 * t55 * t58 - 0.64355555555555555556e-5 * t26 + 0.83833333333333333334e-4 * t32 - 0.41666666666666666667e-2 + t20;
  t64 = t53 * t63;
  t65 = M_PI * t8;
  t66 = M_PI * M_PI;
  t67 = POW_1_3(t66);
  t69 = 0.1e1 / t67 / t66;
  t70 = rho[0] * rho[0];
  t71 = POW_1_3(rho[0]);
  t72 = t71 * t71;
  t74 = 0.1e1 / t72 / t70;
  t75 = sigma[0] * t74;
  t77 = rho[1] * rho[1];
  t78 = POW_1_3(rho[1]);
  t79 = t78 * t78;
  t81 = 0.1e1 / t79 / t77;
  t82 = sigma[2] * t81;
  t87 = t38 * t38;
  t88 = t87 * p->zeta_threshold;
  t89 = t40 * t40;
  t90 = t89 * t36;
  t91 = my_piecewise3(t37, t88, t90);
  t92 = t45 * t45;
  t93 = t92 * t43;
  t94 = my_piecewise3(t44, t88, t93);
  t95 = t91 + t94;
  t96 = sqrt(t95);
  t98 = M_SQRT2;
  t99 = 0.1e1 / t96 * t98;
  t100 = t7 * params->lm_f;
  t101 = pow(t1, 0.1e1 / 0.6e1);
  t102 = 0.1e1 / t101;
  t104 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t105 = sqrt(t104);
  t106 = t102 * t105;
  t107 = pow(t2, 0.1e1 / 0.6e1);
  t112 = exp(-t100 * t106 / t107 / t2);
  t113 = t112 * t104;
  t114 = t2 * t2;
  t116 = 0.1e1 / t23 / t114;
  t121 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t42 + t82 * t47) + 0.2e1 * t99 * t113 * t116);
  t124 = t65 * t121 * t13 / 0.144e3;
  tzk0 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = 0.1e1 / t114;
  t127 = t1 * t125 * t18;
  t128 = 0.7e-6 * t127;
  t130 = t6 * t8 * t10;
  t131 = 0.1e1 / t17;
  t133 = t130 * t25 * t131;
  t134 = 0.84e-1 * t133;
  t136 = 0.1e1 / t23 / t2;
  t137 = t12 * t136;
  t138 = t22 * t137;
  t139 = 0.46666666666666666667e-5 * t138;
  t140 = t13 * t2;
  t142 = t29 / t140;
  t143 = t28 * t142;
  t144 = 0.35e-4 * t143;
  t145 = t34 * t125;
  t146 = t3 - t145;
  t149 = my_piecewise3(t37, 0, 0.4e1 / 0.3e1 * t40 * t146);
  t150 = -t146;
  t153 = my_piecewise3(t44, 0, 0.4e1 / 0.3e1 * t45 * t150);
  t155 = (t149 + t153) * t52;
  t156 = t155 * t63;
  t160 = t55 * t8 * t10;
  t161 = 0.1e1 / t57;
  t167 = 0.71867298747273627173e-8 * t125 * t58 - 0.10583333333333333333e0 * t160 * t25 * t161 + 0.42903703703703703704e-5 * t138 - 0.27944444444444444445e-4 * t143 - t128 + t134;
  t168 = t53 * t167;
  t171 = 0.1e1 / t72 / t70 / rho[0];
  t172 = sigma[0] * t171;
  t182 = 0.1e1 / t96 / t95 * t98;
  t183 = t182 * t112;
  t184 = t104 * t116;
  t187 = my_piecewise3(t37, 0, 0.5e1 / 0.3e1 * t89 * t146);
  t190 = my_piecewise3(t44, 0, 0.5e1 / 0.3e1 * t92 * t150);
  t191 = t187 + t190;
  t194 = t99 * t100;
  t195 = t105 * t104;
  t196 = t102 * t195;
  t197 = t114 * t114;
  t198 = t107 * t107;
  t199 = t198 * t198;
  t200 = t199 * t107;
  t202 = 0.1e1 / t200 / t197;
  t203 = t202 * t112;
  t206 = 0.7e1 / 0.3e1 * t194 * t196 * t203;
  t207 = t114 * t2;
  t209 = 0.1e1 / t23 / t207;
  t212 = 0.16e2 / 0.3e1 * t99 * t113 * t209;
  t214 = t69 * (-0.7e1 / 0.36e2 * t49 * (-0.8e1 / 0.3e1 * t172 * t42 + t75 * t149 + t82 * t153) - t183 * t184 * t191 + t206 - t212);
  t216 = t65 * t214 * t13;
  t217 = t216 / 0.144e3;
  t219 = t65 * t121 * t24;
  t220 = t219 / 0.432e3;
  tvrho0 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124 + t2 * (t128 - t134 - t139 + t144 + t156 + t168 + t217 + t220);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t223 = -t3 - t145;
  t226 = my_piecewise3(t37, 0, 0.4e1 / 0.3e1 * t40 * t223);
  t227 = -t223;
  t230 = my_piecewise3(t44, 0, 0.4e1 / 0.3e1 * t45 * t227);
  t232 = (t226 + t230) * t52;
  t233 = t232 * t63;
  t237 = 0.1e1 / t79 / t77 / rho[1];
  t238 = sigma[2] * t237;
  t247 = my_piecewise3(t37, 0, 0.5e1 / 0.3e1 * t89 * t223);
  t250 = my_piecewise3(t44, 0, 0.5e1 / 0.3e1 * t92 * t227);
  t251 = t247 + t250;
  t255 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t226 - 0.8e1 / 0.3e1 * t238 * t47 + t82 * t230) - t183 * t184 * t251 + t206 - t212);
  t257 = t65 * t255 * t13;
  t258 = t257 / 0.144e3;
  tvrho1 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124 + t2 * (t128 - t134 - t139 + t144 + t233 + t168 + t258 + t220);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t261 = t140 * M_PI;
  t262 = t8 * t69;
  t263 = t49 * t74;
  t267 = 0.1e1 / t200 / t207;
  t268 = t267 * t112;
  t270 = t194 * t106 * t268;
  t271 = t112 * t116;
  t272 = t99 * t271;
  t273 = 0.2e1 * t272;
  t274 = -0.7e1 / 0.36e2 * t263 * t42 - t270 + t273;
  tvsigma0 = t261 * t262 * t274 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t279 = -0.2e1 * t270 + 0.4e1 * t272;
  tvsigma1 = t261 * t262 * t279 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t282 = t49 * t81;
  t285 = -0.7e1 / 0.36e2 * t282 * t47 - t270 + t273;
  tvsigma2 = t261 * t262 * t285 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t288 = 0.14e-5 * t127;
  t289 = 0.168e0 * t133;
  t290 = 0.93333333333333333334e-5 * t138;
  t291 = 0.7e-4 * t143;
  t293 = 0.2e1 * t168;
  t295 = t219 / 0.216e3;
  t296 = 0.1e1 / t207;
  t298 = t1 * t296 * t18;
  t299 = 0.14e-5 * t298;
  t302 = t10 * t12;
  t303 = t302 * t131;
  t304 = t1 * t116 * t8 * t303;
  t305 = 0.46666666666666666666e-5 * t304;
  t307 = t130 * t137 * t131;
  t308 = 0.56e-1 * t307;
  t310 = 0.1e1 / t21;
  t311 = t6 * t7 * t310;
  t312 = t17 * t17;
  t313 = 0.1e1 / t312;
  t315 = t311 * t142 * t313;
  t316 = 0.84e0 * t315;
  t317 = t12 * t116;
  t318 = t22 * t317;
  t319 = 0.77777777777777777778e-5 * t318;
  t322 = t29 / t13 / t114;
  t323 = t28 * t322;
  t324 = 0.46666666666666666667e-4 * t323;
  t325 = 0.1e1 / t89;
  t326 = t146 * t146;
  t329 = t34 * t296;
  t331 = -0.2e1 * t125 + 0.2e1 * t329;
  t335 = my_piecewise3(t37, 0, 0.4e1 / 0.9e1 * t325 * t326 + 0.4e1 / 0.3e1 * t40 * t331);
  t336 = 0.1e1 / t92;
  t337 = t150 * t150;
  t340 = -t331;
  t344 = my_piecewise3(t44, 0, 0.4e1 / 0.9e1 * t336 * t337 + 0.4e1 / 0.3e1 * t45 * t340);
  t346 = (t335 + t344) * t52;
  t347 = t346 * t63;
  t348 = t155 * t167;
  t349 = 0.2e1 * t348;
  t353 = t302 * t161;
  t360 = t55 * t7 * t310;
  t361 = t57 * t57;
  t362 = 0.1e1 / t361;
  t368 = -0.14373459749454725435e-7 * t296 * t58 + 0.11977883124545604529e-6 * t116 * t8 * t353 + 0.70555555555555555553e-1 * t160 * t137 * t161 + 0.26458333333333333332e1 * t360 * t142 * t362 - 0.7150617283950617284e-5 * t318 + 0.3725925925925925926e-4 * t323 + t299 - t305 - t308 - t316;
  t369 = t53 * t368;
  t370 = t70 * t70;
  t372 = 0.1e1 / t72 / t370;
  t373 = sigma[0] * t372;
  t383 = t95 * t95;
  t386 = 0.1e1 / t96 / t383 * t98;
  t387 = t386 * t112;
  t388 = t191 * t191;
  t392 = t182 * t100;
  t393 = t203 * t191;
  t395 = t392 * t196 * t393;
  t397 = t104 * t209;
  t399 = t183 * t397 * t191;
  t401 = 0.1e1 / t40;
  t407 = my_piecewise3(t37, 0, 0.1e2 / 0.9e1 * t401 * t326 + 0.5e1 / 0.3e1 * t89 * t331);
  t408 = 0.1e1 / t45;
  t414 = my_piecewise3(t44, 0, 0.1e2 / 0.9e1 * t408 * t337 + 0.5e1 / 0.3e1 * t92 * t340);
  t415 = t407 + t414;
  t418 = t197 * t2;
  t420 = 0.1e1 / t200 / t418;
  t421 = t420 * t112;
  t424 = 0.35e2 / 0.2e1 * t194 * t196 * t421;
  t425 = params->lm_f * params->lm_f;
  t426 = t8 * t425;
  t427 = t99 * t426;
  t428 = t104 * t104;
  t429 = t10 * t428;
  t430 = t197 * t207;
  t431 = 0.1e1 / t430;
  t432 = t431 * t112;
  t435 = 0.49e2 / 0.18e2 * t427 * t429 * t432;
  t437 = 0.1e1 / t23 / t197;
  t440 = 0.176e3 / 0.9e1 * t99 * t113 * t437;
  t442 = t69 * (-0.7e1 / 0.36e2 * t49 * (0.88e2 / 0.9e1 * t373 * t42 - 0.16e2 / 0.3e1 * t172 * t149 + t75 * t335 + t82 * t344) + 0.3e1 / 0.2e1 * t387 * t184 * t388 - 0.7e1 / 0.3e1 * t395 + 0.16e2 / 0.3e1 * t399 - t183 * t184 * t415 - t424 + t435 + t440);
  t444 = t65 * t442 * t13;
  t445 = t444 / 0.144e3;
  t447 = t65 * t214 * t24;
  t448 = t447 / 0.216e3;
  t450 = t65 * t121 * t136;
  t451 = t450 / 0.648e3;
  t452 = -t299 + t305 + t308 + t316 + t319 - t324 + t347 + t349 + t369 + t445 + t448 - t451;
  tv2rho20 = t288 - t289 - t290 + t291 + 0.2e1 * t156 + t293 + t216 / 0.72e2 + t295 + t2 * t452;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t454 = t325 * t223;
  t457 = t40 * t34;
  t461 = my_piecewise3(t37, 0, 0.4e1 / 0.9e1 * t454 * t146 + 0.8e1 / 0.3e1 * t457 * t296);
  t462 = t336 * t227;
  t465 = t45 * t34;
  t469 = my_piecewise3(t44, 0, 0.4e1 / 0.9e1 * t462 * t150 - 0.8e1 / 0.3e1 * t465 * t296);
  t471 = (t461 + t469) * t52;
  t472 = t471 * t63;
  t473 = t232 * t167;
  t483 = t251 * t191;
  t487 = t203 * t251;
  t489 = t392 * t196 * t487;
  t492 = t183 * t397 * t251;
  t494 = t401 * t223;
  t497 = t89 * t34;
  t501 = my_piecewise3(t37, 0, 0.1e2 / 0.9e1 * t494 * t146 + 0.1e2 / 0.3e1 * t497 * t296);
  t502 = t408 * t227;
  t505 = t92 * t34;
  t509 = my_piecewise3(t44, 0, 0.1e2 / 0.9e1 * t502 * t150 - 0.1e2 / 0.3e1 * t505 * t296);
  t510 = t501 + t509;
  t516 = t69 * (-0.7e1 / 0.36e2 * t49 * (-0.8e1 / 0.3e1 * t172 * t226 + t75 * t461 - 0.8e1 / 0.3e1 * t238 * t153 + t82 * t469) + 0.3e1 / 0.2e1 * t387 * t184 * t483 - 0.7e1 / 0.6e1 * t489 + 0.8e1 / 0.3e1 * t492 - t183 * t184 * t510 - 0.7e1 / 0.6e1 * t395 - t424 + t435 + 0.8e1 / 0.3e1 * t399 + t440);
  t518 = t65 * t516 * t13;
  t521 = t65 * t255 * t24;
  t524 = -t299 + t305 + t308 + t316 + t319 - t324 + t472 + t473 + t348 + t369 + t518 / 0.144e3 + t521 / 0.432e3 + t447 / 0.432e3 - t451;
  tv2rho21 = t2 * t524 + t156 + t217 + t233 + t258 + t288 - t289 - t290 + t291 + t293 + t295;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t528 = t223 * t223;
  t532 = 0.2e1 * t125 + 0.2e1 * t329;
  t536 = my_piecewise3(t37, 0, 0.4e1 / 0.9e1 * t325 * t528 + 0.4e1 / 0.3e1 * t40 * t532);
  t537 = t227 * t227;
  t540 = -t532;
  t544 = my_piecewise3(t44, 0, 0.4e1 / 0.9e1 * t336 * t537 + 0.4e1 / 0.3e1 * t45 * t540);
  t546 = (t536 + t544) * t52;
  t547 = t546 * t63;
  t548 = 0.2e1 * t473;
  t550 = t77 * t77;
  t552 = 0.1e1 / t79 / t550;
  t553 = sigma[2] * t552;
  t562 = t251 * t251;
  t573 = my_piecewise3(t37, 0, 0.1e2 / 0.9e1 * t401 * t528 + 0.5e1 / 0.3e1 * t89 * t532);
  t579 = my_piecewise3(t44, 0, 0.1e2 / 0.9e1 * t408 * t537 + 0.5e1 / 0.3e1 * t92 * t540);
  t580 = t573 + t579;
  t584 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t536 + 0.88e2 / 0.9e1 * t553 * t47 - 0.16e2 / 0.3e1 * t238 * t230 + t82 * t544) + 0.3e1 / 0.2e1 * t387 * t184 * t562 - 0.7e1 / 0.3e1 * t489 + 0.16e2 / 0.3e1 * t492 - t183 * t184 * t580 - t424 + t435 + t440);
  t586 = t65 * t584 * t13;
  t587 = t586 / 0.144e3;
  t588 = t521 / 0.216e3;
  t589 = -t299 + t305 + t308 + t316 + t319 - t324 + t547 + t548 + t369 + t587 + t588 - t451;
  tv2rho22 = t288 - t289 - t290 + t291 + 0.2e1 * t233 + t293 + t257 / 0.72e2 + t295 + t2 * t589;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t591 = t69 * t274;
  t594 = t65 * t591 * t13 / 0.108e3;
  t595 = t49 * t171;
  t600 = t268 * t191;
  t602 = t392 * t106 * t600;
  t603 = t602 / 0.2e1;
  t605 = t194 * t106 * t203;
  t606 = 0.37e2 / 0.6e1 * t605;
  t607 = t10 * t104;
  t608 = t197 * t114;
  t609 = 0.1e1 / t608;
  t610 = t609 * t112;
  t612 = t427 * t607 * t610;
  t613 = 0.7e1 / 0.6e1 * t612;
  t615 = t182 * t271 * t191;
  t616 = t112 * t209;
  t617 = t99 * t616;
  t618 = 0.16e2 / 0.3e1 * t617;
  t619 = 0.14e2 / 0.27e2 * t595 * t42 - 0.7e1 / 0.36e2 * t263 * t149 + t603 + t606 - t613 - t615 - t618;
  tv2rhosigma0 = t594 + t261 * t262 * t619 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t623 = t69 * t279;
  t626 = t65 * t623 * t13 / 0.108e3;
  t627 = 0.37e2 / 0.3e1 * t605;
  t628 = 0.7e1 / 0.3e1 * t612;
  t630 = 0.32e2 / 0.3e1 * t617;
  t631 = t602 + t627 - t628 - 0.2e1 * t615 - t630;
  tv2rhosigma1 = t626 + t261 * t262 * t631 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t635 = t69 * t285;
  t638 = t65 * t635 * t13 / 0.108e3;
  t641 = -0.7e1 / 0.36e2 * t282 * t153 + t603 + t606 - t613 - t615 - t618;
  tv2rhosigma2 = t638 + t261 * t262 * t641 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t647 = t268 * t251;
  t649 = t392 * t106 * t647;
  t650 = t649 / 0.2e1;
  t652 = t182 * t271 * t251;
  t654 = t262 * (-0.7e1 / 0.36e2 * t263 * t226 + t650 + t606 - t613 - t652 - t618);
  tv2rhosigma3 = t594 + t261 * t654 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  t659 = t262 * (t649 + t627 - t628 - 0.2e1 * t652 - t630);
  tv2rhosigma4 = t626 + t261 * t659 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t662 = t49 * t237;
  t668 = t262 * (0.14e2 / 0.27e2 * t662 * t47 - 0.7e1 / 0.36e2 * t282 * t230 + t650 + t606 - t613 - t652 - t618);
  tv2rhosigma5 = t638 + t261 * t668 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t671 = 0.1e1 / t105;
  t672 = t102 * t671;
  t674 = t194 * t672 * t268;
  t676 = t99 * t8;
  t677 = t425 * t10;
  t678 = 0.1e1 / t418;
  t679 = t678 * t112;
  t681 = t676 * t677 * t679;
  t684 = t262 * (-0.3e1 / 0.2e1 * t674 + t681 / 0.2e1);
  tv2sigma20 = t261 * t684 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t688 = t262 * (-0.3e1 * t674 + t681);
  tv2sigma21 = t261 * t688 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = tv2sigma20;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  t693 = t262 * (-0.6e1 * t674 + 0.2e1 * t681);
  tv2sigma23 = t261 * t693 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = tv2sigma21;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = tv2sigma22;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t695 = 0.42e-5 * t298;
  t698 = 0.3e1 * t369;
  t699 = 0.14e-4 * t304;
  t700 = 0.252e1 * t315;
  t702 = t450 / 0.216e3;
  t703 = 0.23333333333333333334e-4 * t318;
  t704 = 0.14e-3 * t323;
  t706 = 0.168e0 * t307;
  t707 = 0.1e1 / t197;
  t709 = t1 * t707 * t18;
  t710 = 0.42e-5 * t709;
  t713 = t1 * t209 * t8 * t303;
  t714 = 0.18666666666666666666e-4 * t713;
  t716 = 0.1e1 / t13 / t207;
  t719 = t310 * t29;
  t720 = t719 * t313;
  t721 = t1 * t716 * t7 * t720;
  t722 = 0.69999999999999999999e-4 * t721;
  t724 = t130 * t317 * t131;
  t725 = 0.93333333333333333334e-1 * t724;
  t727 = t311 * t322 * t313;
  t728 = 0.168e1 * t727;
  t729 = t6 * M_PI;
  t731 = 0.1e1 / t312 / t17;
  t733 = t729 * t125 * t731;
  t734 = 0.672e2 * t733;
  t735 = t12 * t209;
  t736 = t22 * t735;
  t737 = 0.20740740740740740741e-4 * t736;
  t738 = t29 * t716;
  t739 = t28 * t738;
  t740 = 0.10888888888888888889e-3 * t739;
  t741 = 0.1e1 / t90;
  t742 = t326 * t146;
  t745 = t325 * t146;
  t748 = t34 * t707;
  t750 = 0.6e1 * t296 - 0.6e1 * t748;
  t754 = my_piecewise3(t37, 0, -0.8e1 / 0.27e2 * t741 * t742 + 0.4e1 / 0.3e1 * t745 * t331 + 0.4e1 / 0.3e1 * t40 * t750);
  t755 = 0.1e1 / t93;
  t756 = t337 * t150;
  t759 = t336 * t150;
  t762 = -t750;
  t766 = my_piecewise3(t44, 0, -0.8e1 / 0.27e2 * t755 * t756 + 0.4e1 / 0.3e1 * t759 * t340 + 0.4e1 / 0.3e1 * t45 * t762);
  t768 = (t754 + t766) * t52;
  t769 = t768 * t63;
  t770 = t346 * t167;
  t772 = t155 * t368;
  t773 = 0.3e1 * t772;
  t780 = t719 * t362;
  t791 = 0.1e1 / t361 / t57;
  t796 = 0.43120379248364176305e-7 * t707 * t58 - 0.47911532498182418116e-6 * t209 * t8 * t353 - 0.44917061717046016982e-5 * t716 * t7 * t780 - 0.11759259259259259259e0 * t160 * t317 * t161 - 0.52916666666666666664e1 * t360 * t322 * t362 - 0.1662426112524598922e4 * t55 * t125 * t791 + 0.19068312757201646091e-4 * t736 - 0.86938271604938271607e-4 * t739 - t710 + t714 + t722 + t725 + t728 + t734;
  t797 = t53 * t796;
  t798 = t421 * t191;
  t800 = t392 * t196 * t798;
  t802 = t197 * t197;
  t804 = 0.1e1 / t802 * t112;
  t807 = 0.1421e4 / 0.36e2 * t427 * t429 * t804;
  t811 = 0.1e1 / t96 / t383 / t95 * t98;
  t812 = t811 * t112;
  t813 = t388 * t191;
  t818 = t387 * t397 * t388;
  t820 = t191 * t415;
  t824 = t104 * t437;
  t826 = t183 * t824 * t191;
  t828 = t425 * params->lm_f;
  t829 = t99 * t828;
  t830 = sqrt(t1);
  t831 = 0.1e1 / t830;
  t832 = t105 * t428;
  t833 = t831 * t832;
  t834 = t802 * t2;
  t836 = 0.1e1 / t107 / t834;
  t837 = t836 * t112;
  t840 = 0.343e3 / 0.36e2 * t829 * t833 * t837;
  t841 = t386 * t100;
  t842 = t203 * t388;
  t844 = t841 * t196 * t842;
  t846 = t203 * t415;
  t848 = t392 * t196 * t846;
  t850 = t182 * t426;
  t851 = t432 * t191;
  t853 = t850 * t429 * t851;
  t857 = 0.1e1 / t200 / t608 * t112;
  t860 = 0.13489e5 / 0.108e3 * t194 * t196 * t857;
  t862 = t183 * t397 * t415;
  t864 = 0.1e1 / t41;
  t867 = t401 * t146;
  t873 = my_piecewise3(t37, 0, -0.1e2 / 0.27e2 * t864 * t742 + 0.1e2 / 0.3e1 * t867 * t331 + 0.5e1 / 0.3e1 * t89 * t750);
  t874 = 0.1e1 / t46;
  t877 = t408 * t150;
  t883 = my_piecewise3(t44, 0, -0.1e2 / 0.27e2 * t874 * t756 + 0.1e2 / 0.3e1 * t877 * t340 + 0.5e1 / 0.3e1 * t92 * t762);
  t884 = t873 + t883;
  t888 = 0.1e1 / t23 / t418;
  t891 = 0.2464e4 / 0.27e2 * t99 * t113 * t888;
  t894 = 0.1e1 / t72 / t370 / rho[0];
  t895 = sigma[0] * t894;
  t907 = 0.105e3 / 0.4e1 * t800 - t807 - 0.15e2 / 0.4e1 * t812 * t184 * t813 - 0.12e2 * t818 + 0.9e1 / 0.2e1 * t387 * t184 * t820 - 0.88e2 / 0.3e1 * t826 + t840 + 0.21e2 / 0.4e1 * t844 - 0.7e1 / 0.2e1 * t848 - 0.49e2 / 0.12e2 * t853 + t860 + 0.8e1 * t862 - t183 * t184 * t884 - t891 - 0.7e1 / 0.36e2 * t49 * (-0.1232e4 / 0.27e2 * t895 * t42 + 0.88e2 / 0.3e1 * t373 * t149 - 0.8e1 * t172 * t335 + t75 * t754 + t82 * t766);
  t908 = t69 * t907;
  t910 = t65 * t908 * t13;
  t911 = t910 / 0.144e3;
  t913 = t65 * t442 * t24;
  t916 = t65 * t214 * t136;
  t917 = t916 / 0.216e3;
  t919 = t65 * t121 * t116;
  t920 = 0.5e1 / 0.1944e4 * t919;
  t921 = t710 - t714 - t722 - t725 - t728 - t734 - t737 + t740 + t769 + 0.3e1 * t770 + t773 + t797 + t911 + t913 / 0.144e3 - t917 + t920;
  tv3rho30 = -t695 + 0.3e1 * t347 + 0.6e1 * t348 + t698 + t699 + t700 + t447 / 0.72e2 - t702 + t703 - t704 + t444 / 0.48e2 + t706 + t2 * t921;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t924 = t65 * t516 * t24;
  t925 = t924 / 0.216e3;
  t926 = t100 * t102;
  t927 = t386 * t926;
  t928 = t195 * t202;
  t929 = t112 * t251;
  t930 = t929 * t191;
  t933 = 0.7e1 / 0.2e1 * t927 * t928 * t930;
  t934 = t421 * t251;
  t936 = t392 * t196 * t934;
  t943 = t741 * t223;
  t946 = t325 * t34;
  t947 = t296 * t146;
  t957 = my_piecewise3(t37, 0, -0.8e1 / 0.27e2 * t943 * t326 + 0.16e2 / 0.9e1 * t946 * t947 + 0.4e1 / 0.9e1 * t454 * t331 + 0.8e1 / 0.3e1 * t40 * t296 - 0.8e1 * t457 * t707);
  t961 = t755 * t227;
  t964 = t336 * t34;
  t965 = t296 * t150;
  t975 = my_piecewise3(t44, 0, -0.8e1 / 0.27e2 * t961 * t337 - 0.16e2 / 0.9e1 * t964 * t965 + 0.4e1 / 0.9e1 * t462 * t340 - 0.8e1 / 0.3e1 * t45 * t296 + 0.8e1 * t465 * t707);
  t980 = t251 * t388;
  t986 = 0.8e1 * t387 * t397 * t483;
  t989 = 0.16e2 / 0.3e1 * t183 * t397 * t510;
  t990 = t864 * t223;
  t993 = t401 * t34;
  t1003 = my_piecewise3(t37, 0, -0.1e2 / 0.27e2 * t990 * t326 + 0.4e2 / 0.9e1 * t993 * t947 + 0.1e2 / 0.9e1 * t494 * t331 + 0.1e2 / 0.3e1 * t89 * t296 - 0.1e2 * t497 * t707);
  t1004 = t874 * t227;
  t1007 = t408 * t34;
  t1017 = my_piecewise3(t44, 0, -0.1e2 / 0.27e2 * t1004 * t337 - 0.4e2 / 0.9e1 * t1007 * t965 + 0.1e2 / 0.9e1 * t502 * t340 - 0.1e2 / 0.3e1 * t92 * t296 + 0.1e2 * t505 * t707);
  t1018 = t1003 + t1017;
  t1021 = t510 * t191;
  t1025 = t251 * t415;
  t1029 = t933 + 0.35e2 / 0.4e1 * t936 + 0.35e2 / 0.2e1 * t800 - 0.7e1 / 0.36e2 * t49 * (0.88e2 / 0.9e1 * t373 * t226 - 0.16e2 / 0.3e1 * t172 * t461 + t75 * t957 - 0.8e1 / 0.3e1 * t238 * t344 + t82 * t975) - 0.15e2 / 0.4e1 * t812 * t184 * t980 - t986 - t807 + t989 - t183 * t184 * t1018 + 0.3e1 * t387 * t184 * t1021 + 0.3e1 / 0.2e1 * t387 * t184 * t1025;
  t1031 = t183 * t824 * t251;
  t1038 = t203 * t510;
  t1041 = 0.7e1 / 0.3e1 * t392 * t196 * t1038;
  t1042 = t432 * t251;
  t1044 = t850 * t429 * t1042;
  t1047 = -0.88e2 / 0.9e1 * t1031 - 0.4e1 * t818 - 0.176e3 / 0.9e1 * t826 + t840 + 0.7e1 / 0.4e1 * t844 - 0.7e1 / 0.6e1 * t848 - 0.49e2 / 0.18e2 * t853 + t860 - t1041 - 0.49e2 / 0.36e2 * t1044 + 0.8e1 / 0.3e1 * t862 - t891;
  t1049 = t69 * (t1029 + t1047);
  t1051 = t65 * t1049 * t13;
  t1055 = (t957 + t975) * t52;
  t1056 = t1055 * t63;
  t1057 = t471 * t167;
  t1058 = 0.2e1 * t1057;
  t1059 = t232 * t368;
  t1061 = t65 * t255 * t136;
  t1066 = -t737 + t740 + t925 + t1051 / 0.144e3 - t725 + t770 + 0.2e1 * t772 + t797 + t1056 + t1058 + t1059 - t1061 / 0.648e3 - 0.18666666666666666667e-4 * t713 - t722 - t728 + t913 / 0.432e3 - t916 / 0.324e3 + t920 + t710 - t734;
  t1069 = 0.2e1 * t472;
  t1071 = t518 / 0.72e2;
  tv3rho31 = t2 * t1066 - t695 + t347 + 0.4e1 * t348 + t698 + t1069 + t548 + t699 + t700 + t447 / 0.108e3 - t702 + t588 + t703 - t704 + t445 + t1071 + t706;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1073 = t741 * t528;
  t1078 = t325 * t532;
  t1083 = -0.2e1 * t296 - 0.6e1 * t748;
  t1087 = my_piecewise3(t37, 0, -0.8e1 / 0.27e2 * t1073 * t146 + 0.16e2 / 0.9e1 * t454 * t329 + 0.4e1 / 0.9e1 * t1078 * t146 + 0.4e1 / 0.3e1 * t40 * t1083);
  t1088 = t755 * t537;
  t1093 = t336 * t540;
  t1096 = -t1083;
  t1100 = my_piecewise3(t44, 0, -0.8e1 / 0.27e2 * t1088 * t150 - 0.16e2 / 0.9e1 * t462 * t329 + 0.4e1 / 0.9e1 * t1093 * t150 + 0.4e1 / 0.3e1 * t45 * t1096);
  t1102 = (t1087 + t1100) * t52;
  t1103 = t1102 * t63;
  t1104 = t546 * t167;
  t1107 = t387 * t397 * t562;
  t1109 = t251 * t510;
  t1113 = t580 * t191;
  t1118 = t183 * t397 * t580;
  t1120 = t864 * t528;
  t1125 = t401 * t532;
  t1131 = my_piecewise3(t37, 0, -0.1e2 / 0.27e2 * t1120 * t146 + 0.4e2 / 0.9e1 * t494 * t329 + 0.1e2 / 0.9e1 * t1125 * t146 + 0.5e1 / 0.3e1 * t89 * t1083);
  t1132 = t874 * t537;
  t1137 = t408 * t540;
  t1143 = my_piecewise3(t44, 0, -0.1e2 / 0.27e2 * t1132 * t150 - 0.4e2 / 0.9e1 * t502 * t329 + 0.1e2 / 0.9e1 * t1137 * t150 + 0.5e1 / 0.3e1 * t92 * t1096);
  t1144 = t1131 + t1143;
  t1149 = -0.4e1 * t1107 + 0.3e1 * t387 * t184 * t1109 + 0.3e1 / 0.2e1 * t387 * t184 * t1113 + 0.8e1 / 0.3e1 * t1118 - t183 * t184 * t1144 + t933 + 0.35e2 / 0.2e1 * t936 + 0.35e2 / 0.4e1 * t800 - t986 - t807 + t989;
  t1151 = t562 * t191;
  t1169 = t203 * t562;
  t1171 = t841 * t196 * t1169;
  t1173 = t203 * t580;
  t1175 = t392 * t196 * t1173;
  t1177 = -0.176e3 / 0.9e1 * t1031 - 0.15e2 / 0.4e1 * t812 * t184 * t1151 - 0.88e2 / 0.9e1 * t826 + t840 - 0.7e1 / 0.36e2 * t49 * (-0.8e1 / 0.3e1 * t172 * t536 + t75 * t1087 + 0.88e2 / 0.9e1 * t553 * t153 - 0.16e2 / 0.3e1 * t238 * t469 + t82 * t1100) - 0.49e2 / 0.36e2 * t853 + t860 - t1041 - 0.49e2 / 0.18e2 * t1044 + 0.7e1 / 0.4e1 * t1171 - 0.7e1 / 0.6e1 * t1175 - t891;
  t1179 = t69 * (t1149 + t1177);
  t1181 = t65 * t1179 * t13;
  t1184 = t65 * t584 * t24;
  t1188 = t710 - t714 - t722 - t725 - t728 - t734 - t737 + t740 + t1103 + t1104 + t1058 + 0.2e1 * t1059 + t772 + t797 + t1181 / 0.144e3 + t1184 / 0.432e3 + t925 - t1061 / 0.324e3 - t916 / 0.648e3 + t920;
  tv3rho32 = -t695 + t349 + t698 + t1069 + 0.4e1 * t473 + t547 + t2 * t1188 + t699 + t700 + t448 - t702 + t521 / 0.108e3 + t703 - t704 + t1071 + t587 + t706;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1195 = t528 * t223;
  t1201 = -0.6e1 * t296 - 0.6e1 * t748;
  t1205 = my_piecewise3(t37, 0, -0.8e1 / 0.27e2 * t741 * t1195 + 0.4e1 / 0.3e1 * t454 * t532 + 0.4e1 / 0.3e1 * t40 * t1201);
  t1206 = t537 * t227;
  t1211 = -t1201;
  t1215 = my_piecewise3(t44, 0, -0.8e1 / 0.27e2 * t755 * t1206 + 0.4e1 / 0.3e1 * t462 * t540 + 0.4e1 / 0.3e1 * t45 * t1211);
  t1217 = (t1205 + t1215) * t52;
  t1218 = t1217 * t63;
  t1220 = 0.3e1 * t1059;
  t1221 = t562 * t251;
  t1225 = t251 * t580;
  t1238 = my_piecewise3(t37, 0, -0.1e2 / 0.27e2 * t864 * t1195 + 0.1e2 / 0.3e1 * t494 * t532 + 0.5e1 / 0.3e1 * t89 * t1201);
  t1246 = my_piecewise3(t44, 0, -0.1e2 / 0.27e2 * t874 * t1206 + 0.1e2 / 0.3e1 * t502 * t540 + 0.5e1 / 0.3e1 * t92 * t1211);
  t1247 = t1238 + t1246;
  t1258 = 0.1e1 / t79 / t550 / rho[1];
  t1259 = sigma[2] * t1258;
  t1270 = -0.15e2 / 0.4e1 * t812 * t184 * t1221 + 0.9e1 / 0.2e1 * t387 * t184 * t1225 - 0.12e2 * t1107 + 0.8e1 * t1118 - t183 * t184 * t1247 + 0.105e3 / 0.4e1 * t936 - t807 - 0.88e2 / 0.3e1 * t1031 + t840 + t860 - 0.49e2 / 0.12e2 * t1044 + 0.21e2 / 0.4e1 * t1171 - 0.7e1 / 0.2e1 * t1175 - 0.7e1 / 0.36e2 * t49 * (t75 * t1205 - 0.1232e4 / 0.27e2 * t1259 * t47 + 0.88e2 / 0.3e1 * t553 * t230 - 0.8e1 * t238 * t544 + t82 * t1215) - t891;
  t1271 = t69 * t1270;
  t1273 = t65 * t1271 * t13;
  t1274 = t1273 / 0.144e3;
  t1276 = t1061 / 0.216e3;
  t1277 = t710 - t714 - t722 - t725 - t728 - t734 - t737 + t740 + t1218 + 0.3e1 * t1104 + t1220 + t797 + t1274 + t1184 / 0.144e3 - t1276 + t920;
  tv3rho33 = -t695 + t698 + 0.6e1 * t473 + 0.3e1 * t547 + t699 + t700 - t702 + t521 / 0.72e2 + t703 - t704 + t586 / 0.48e2 + t706 + t2 * t1277;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1279 = t69 * t619;
  t1281 = t65 * t1279 * t13;
  t1285 = t65 * t591 * t24 / 0.324e3;
  t1286 = t49 * t372;
  t1293 = t268 * t388;
  t1295 = t841 * t106 * t1293;
  t1296 = 0.3e1 / 0.4e1 * t1295;
  t1298 = t392 * t106 * t393;
  t1299 = 0.37e2 / 0.6e1 * t1298;
  t1302 = t850 * t607 * t610 * t191;
  t1303 = 0.7e1 / 0.6e1 * t1302;
  t1304 = t268 * t415;
  t1306 = t392 * t106 * t1304;
  t1307 = t1306 / 0.2e1;
  t1309 = t194 * t106 * t421;
  t1310 = 0.1297e4 / 0.36e2 * t1309;
  t1312 = t427 * t607 * t432;
  t1313 = 0.511e3 / 0.36e2 * t1312;
  t1314 = t831 * t195;
  t1316 = 0.1e1 / t107 / t802;
  t1319 = t829 * t1314 * t1316 * t112;
  t1320 = 0.49e2 / 0.12e2 * t1319;
  t1322 = t386 * t271 * t388;
  t1323 = 0.3e1 / 0.2e1 * t1322;
  t1325 = t182 * t616 * t191;
  t1326 = 0.16e2 / 0.3e1 * t1325;
  t1328 = t182 * t271 * t415;
  t1329 = t112 * t437;
  t1330 = t99 * t1329;
  t1331 = 0.176e3 / 0.9e1 * t1330;
  t1332 = -0.154e3 / 0.81e2 * t1286 * t42 + 0.28e2 / 0.27e2 * t595 * t149 - 0.7e1 / 0.36e2 * t263 * t335 - t1296 - t1299 + t1303 + t1307 - t1310 + t1313 - t1320 + t1323 + t1326 - t1328 + t1331;
  tv3rho2sigma0 = t1281 / 0.54e2 + t1285 + t261 * t262 * t1332 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t1336 = t69 * t631;
  t1338 = t65 * t1336 * t13;
  t1342 = t65 * t623 * t24 / 0.324e3;
  t1346 = 0.1297e4 / 0.18e2 * t1309;
  t1347 = 0.511e3 / 0.18e2 * t1312;
  t1348 = 0.49e2 / 0.6e1 * t1319;
  t1352 = 0.352e3 / 0.9e1 * t1330;
  t1353 = -0.3e1 / 0.2e1 * t1295 - 0.37e2 / 0.3e1 * t1298 + 0.7e1 / 0.3e1 * t1302 + t1306 - t1346 + t1347 - t1348 + 0.3e1 * t1322 + 0.32e2 / 0.3e1 * t1325 - 0.2e1 * t1328 + t1352;
  tv3rho2sigma1 = t1338 / 0.54e2 + t1342 + t261 * t262 * t1353 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1357 = t69 * t641;
  t1359 = t65 * t1357 * t13;
  t1363 = t65 * t635 * t24 / 0.324e3;
  t1366 = -0.7e1 / 0.36e2 * t282 * t344 - t1296 - t1299 + t1303 + t1307 - t1310 + t1313 - t1320 + t1323 + t1326 - t1328 + t1331;
  tv3rho2sigma2 = t1359 / 0.54e2 + t1363 + t261 * t262 * t1366 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1371 = t13 * M_PI;
  t1372 = t1371 * t654;
  t1378 = t105 * t267;
  t1380 = t927 * t1378 * t930;
  t1381 = 0.3e1 / 0.4e1 * t1380;
  t1383 = t392 * t106 * t487;
  t1384 = 0.37e2 / 0.12e2 * t1383;
  t1387 = t850 * t607 * t610 * t251;
  t1388 = 0.7e1 / 0.12e2 * t1387;
  t1389 = t268 * t510;
  t1391 = t392 * t106 * t1389;
  t1392 = t1391 / 0.2e1;
  t1393 = 0.37e2 / 0.12e2 * t1298;
  t1394 = 0.7e1 / 0.12e2 * t1302;
  t1395 = t116 * t251;
  t1397 = t387 * t1395 * t191;
  t1398 = 0.3e1 / 0.2e1 * t1397;
  t1400 = t182 * t616 * t251;
  t1401 = 0.8e1 / 0.3e1 * t1400;
  t1403 = t182 * t271 * t510;
  t1404 = 0.8e1 / 0.3e1 * t1325;
  t1405 = 0.14e2 / 0.27e2 * t595 * t226 - 0.7e1 / 0.36e2 * t263 * t461 - t1381 - t1384 + t1388 + t1392 - t1393 - t1310 + t1313 + t1394 - t1320 + t1398 + t1401 - t1403 + t1404 + t1331;
  t1406 = t262 * t1405;
  tv3rho2sigma3 = t1281 / 0.108e3 + t1285 + t1372 / 0.108e3 + t261 * t1406 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t1410 = t1371 * t659;
  t1413 = 0.37e2 / 0.6e1 * t1383;
  t1414 = 0.7e1 / 0.6e1 * t1387;
  t1416 = 0.16e2 / 0.3e1 * t1400;
  t1418 = -0.3e1 / 0.2e1 * t1380 - t1413 + t1414 + t1391 - t1299 - t1346 + t1347 + t1303 - t1348 + 0.3e1 * t1397 + t1416 - 0.2e1 * t1403 + t1326 + t1352;
  t1419 = t262 * t1418;
  tv3rho2sigma4 = t1338 / 0.108e3 + t1342 + t1410 / 0.108e3 + t261 * t1419 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1423 = t1371 * t668;
  t1429 = 0.14e2 / 0.27e2 * t662 * t153 - 0.7e1 / 0.36e2 * t282 * t469 - t1381 - t1384 + t1388 + t1392 - t1393 - t1310 + t1313 + t1394 - t1320 + t1398 + t1401 - t1403 + t1404 + t1331;
  t1430 = t262 * t1429;
  tv3rho2sigma5 = t1359 / 0.108e3 + t1363 + t1423 / 0.108e3 + t261 * t1430 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1436 = t268 * t562;
  t1438 = t841 * t106 * t1436;
  t1439 = 0.3e1 / 0.4e1 * t1438;
  t1440 = t268 * t580;
  t1442 = t392 * t106 * t1440;
  t1443 = t1442 / 0.2e1;
  t1445 = t386 * t271 * t562;
  t1446 = 0.3e1 / 0.2e1 * t1445;
  t1448 = t182 * t271 * t580;
  t1449 = -0.7e1 / 0.36e2 * t263 * t536 - t1439 - t1413 + t1414 + t1443 - t1310 + t1313 - t1320 + t1446 + t1416 - t1448 + t1331;
  t1450 = t262 * t1449;
  tv3rho2sigma6 = t1372 / 0.54e2 + t1285 + t261 * t1450 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  t1460 = -0.3e1 / 0.2e1 * t1438 - 0.37e2 / 0.3e1 * t1383 + 0.7e1 / 0.3e1 * t1387 + t1442 - t1346 + t1347 - t1348 + 0.3e1 * t1445 + 0.32e2 / 0.3e1 * t1400 - 0.2e1 * t1448 + t1352;
  t1461 = t262 * t1460;
  tv3rho2sigma7 = t1410 / 0.54e2 + t1342 + t261 * t1461 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1465 = t49 * t552;
  t1472 = -0.154e3 / 0.81e2 * t1465 * t47 + 0.28e2 / 0.27e2 * t662 * t230 - 0.7e1 / 0.36e2 * t282 * t544 - t1439 - t1413 + t1414 + t1443 - t1310 + t1313 - t1320 + t1446 + t1416 - t1448 + t1331;
  t1473 = t262 * t1472;
  tv3rho2sigma8 = t1423 / 0.54e2 + t1363 + t261 * t1473 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1477 = t1371 * t684 / 0.108e3;
  t1479 = t392 * t672 * t600;
  t1482 = t194 * t672 * t203;
  t1483 = 0.23e2 / 0.4e1 * t1482;
  t1485 = t676 * t677 * t610;
  t1486 = 0.17e2 / 0.4e1 * t1485;
  t1487 = t10 * t678;
  t1488 = t112 * t191;
  t1490 = t850 * t1487 * t1488;
  t1493 = 0.1e1 / t107 / t430;
  t1495 = t105 * t112;
  t1497 = t829 * t831 * t1493 * t1495;
  t1498 = 0.7e1 / 0.4e1 * t1497;
  t1500 = t262 * (0.3e1 / 0.4e1 * t1479 + t1483 - t1486 - t1490 / 0.4e1 + t1498);
  tv3rhosigma20 = t1477 + t261 * t1500 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t1504 = t1371 * t688 / 0.108e3;
  t1506 = 0.23e2 / 0.2e1 * t1482;
  t1507 = 0.17e2 / 0.2e1 * t1485;
  t1509 = 0.7e1 / 0.2e1 * t1497;
  t1511 = t262 * (0.3e1 / 0.2e1 * t1479 + t1506 - t1507 - t1490 / 0.2e1 + t1509);
  tv3rhosigma21 = t1504 + t261 * t1511 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = tv3rhosigma20;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  t1515 = t1371 * t693 / 0.108e3;
  t1517 = 0.23e2 * t1482;
  t1518 = 0.17e2 * t1485;
  t1519 = 0.7e1 * t1497;
  t1521 = t262 * (0.3e1 * t1479 + t1517 - t1518 - t1490 + t1519);
  tv3rhosigma23 = t1515 + t261 * t1521 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = tv3rhosigma21;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = tv3rhosigma22;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1525 = t392 * t672 * t647;
  t1528 = t850 * t1487 * t929;
  t1531 = t262 * (0.3e1 / 0.4e1 * t1525 + t1483 - t1486 - t1528 / 0.4e1 + t1498);
  tv3rhosigma26 = t1477 + t261 * t1531 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  t1537 = t262 * (0.3e1 / 0.2e1 * t1525 + t1506 - t1507 - t1528 / 0.2e1 + t1509);
  tv3rhosigma27 = t1504 + t261 * t1537 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = tv3rhosigma26;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  t1542 = t262 * (0.3e1 * t1525 + t1517 - t1518 - t1528 + t1519);
  tv3rhosigma29 = t1515 + t261 * t1542 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = tv3rhosigma27;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  tv3rhosigma211 = tv3rhosigma28;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1545 = 0.1e1 / t195;
  t1546 = t102 * t1545;
  t1549 = 0.1e1 / t104;
  t1550 = t10 * t1549;
  t1554 = 0.1e1 / t107 / t608;
  t1559 = -t829 * t831 * t1554 * t671 * t112 + t194 * t1546 * t268 + t427 * t1550 * t679;
  t1561 = 0.3e1 / 0.4e1 * t262 * t1559;
  tv3sigma30 = t261 * t1561 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1564 = 0.3e1 / 0.2e1 * t262 * t1559;
  tv3sigma31 = t261 * t1564 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = tv3sigma30;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  t1567 = 0.3e1 * t262 * t1559;
  tv3sigma33 = t261 * t1567 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = tv3sigma31;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = tv3sigma32;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  t1570 = 0.6e1 * t262 * t1559;
  tv3sigma36 = t261 * t1570 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = tv3sigma33;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = tv3sigma34;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  tv3sigma39 = tv3sigma35;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t6, t7, t8, t9, t10;
  double t11, t12, t13, t15, t17, t18, t20, t21;
  double t22, t23, t24, t25, t26, t27, t28, t29;
  double t32, t33, t34, t35, t36, t37, t38, t39;
  double t40, t41, t42, t43, t44, t45, t46, t47;
  double t49, t52, t53, t55, t57, t58, t63, t64;
  double t65, t66, t67, t69, t70, t71, t72, t74;
  double t75, t77, t78, t79, t81, t82, t87, t88;
  double t89, t90, t91, t92, t93, t94, t95, t96;
  double t98, t99, t100, t101, t102, t104, t105, t106;
  double t107, t112, t113, t114, t116, t121, t124, tzk0;

  double t125, t127, t128, t130, t131, t133, t134, t136;
  double t137, t138, t139, t140, t142, t143, t144, t145;
  double t146, t149, t150, t153, t155, t156, t160, t161;
  double t167, t168, t171, t172, t182, t183, t184, t187;
  double t190, t191, t194, t195, t196, t197, t198, t199;
  double t200, t202, t203, t206, t207, t209, t212, t214;
  double t216, t217, t219, t220, tvrho0, t223, t226, t227;
  double t230, t232, t233, t237, t238, t247, t250, t251;
  double t255, t257, t258, tvrho1, t261, t262, t263, t267;
  double t268, t270, t271, t272, t273, t274, tvsigma0, t279;
  double tvsigma1, t282, t285, tvsigma2;

  double t288, t289, t290, t291, t293, t295, t296, t298;
  double t299, t302, t303, t304, t305, t307, t308, t310;
  double t311, t312, t313, t315, t316, t317, t318, t319;
  double t322, t323, t324, t325, t326, t329, t331, t335;
  double t336, t337, t340, t344, t346, t347, t348, t349;
  double t353, t360, t361, t362, t368, t369, t370, t372;
  double t373, t383, t386, t387, t388, t392, t393, t395;
  double t397, t399, t401, t407, t408, t414, t415, t418;
  double t420, t421, t424, t425, t426, t427, t428, t429;
  double t430, t431, t432, t435, t437, t440, t442, t444;
  double t445, t447, t448, t450, t451, t452, tv2rho20, t454;
  double t457, t461, t462, t465, t469, t471, t472, t473;
  double t483, t487, t489, t492, t494, t497, t501, t502;
  double t505, t509, t510, t516, t518, t521, t524, tv2rho21;
  double t528, t532, t536, t537, t540, t544, t546, t547;
  double t548, t550, t552, t553, t562, t573, t579, t580;
  double t584, t586, t587, t588, t589, tv2rho22, t591, t594;
  double t595, t600, t602, t603, t605, t606, t607, t608;
  double t609, t610, t612, t613, t615, t616, t617, t618;
  double t619, tv2rhosigma0, t623, t626, t627, t628, t630, t631;
  double tv2rhosigma1, t635, t638, t641, tv2rhosigma2, t647, t649, t650;
  double t652, t654, tv2rhosigma3, t659, tv2rhosigma4, t662, t668, tv2rhosigma5;
  double t671, t672, t674, t676, t677, t678, t679, t681;
  double t684, tv2sigma20, t688, tv2sigma21, tv2sigma22, t693, tv2sigma23, tv2sigma24;
  double tv2sigma25;

  double t695, t698, t699, t700, t702, t703, t704, t706;
  double t707, t709, t710, t713, t714, t716, t719, t720;
  double t721, t722, t724, t725, t727, t728, t729, t731;
  double t733, t734, t735, t736, t737, t738, t739, t740;
  double t741, t742, t745, t748, t750, t754, t755, t756;
  double t759, t762, t766, t768, t769, t770, t772, t773;
  double t780, t791, t796, t797, t798, t800, t802, t804;
  double t807, t811, t812, t813, t818, t820, t824, t826;
  double t828, t829, t830, t831, t832, t833, t834, t836;
  double t837, t840, t841, t842, t844, t846, t848, t850;
  double t851, t853, t857, t860, t862, t864, t867, t873;
  double t874, t877, t883, t884, t888, t891, t894, t895;
  double t907, t908, t910, t911, t913, t916, t917, t919;
  double t920, t921, tv3rho30, t924, t925, t926, t927, t928;
  double t929, t930, t933, t934, t936, t943, t946, t947;
  double t957, t961, t964, t965, t975, t980, t986, t989;
  double t990, t993, t1003, t1004, t1007, t1017, t1018, t1021;
  double t1025, t1029, t1031, t1038, t1041, t1042, t1044, t1047;
  double t1049, t1051, t1055, t1056, t1057, t1058, t1059, t1061;
  double t1066, t1069, t1071, tv3rho31, t1073, t1078, t1083, t1087;
  double t1088, t1093, t1096, t1100, t1102, t1103, t1104, t1107;
  double t1109, t1113, t1118, t1120, t1125, t1131, t1132, t1137;
  double t1143, t1144, t1149, t1151, t1169, t1171, t1173, t1175;
  double t1177, t1179, t1181, t1184, t1188, tv3rho32, t1195, t1201;
  double t1205, t1206, t1211, t1215, t1217, t1218, t1220, t1221;
  double t1225, t1238, t1246, t1247, t1258, t1259, t1270, t1271;
  double t1273, t1274, t1276, t1277, tv3rho33, t1279, t1281, t1285;
  double t1286, t1293, t1295, t1296, t1298, t1299, t1302, t1303;
  double t1304, t1306, t1307, t1309, t1310, t1312, t1313, t1314;
  double t1316, t1319, t1320, t1322, t1323, t1325, t1326, t1328;
  double t1329, t1330, t1331, t1332, tv3rho2sigma0, t1336, t1338, t1342;
  double t1346, t1347, t1348, t1352, t1353, tv3rho2sigma1, t1357, t1359;
  double t1363, t1366, tv3rho2sigma2, t1371, t1372, t1378, t1380, t1381;
  double t1383, t1384, t1387, t1388, t1389, t1391, t1392, t1393;
  double t1394, t1395, t1397, t1398, t1400, t1401, t1403, t1404;
  double t1405, t1406, tv3rho2sigma3, t1410, t1413, t1414, t1416, t1418;
  double t1419, tv3rho2sigma4, t1423, t1429, t1430, tv3rho2sigma5, t1436, t1438;
  double t1439, t1440, t1442, t1443, t1445, t1446, t1448, t1449;
  double t1450, tv3rho2sigma6, t1460, t1461, tv3rho2sigma7, t1465, t1472, t1473;
  double tv3rho2sigma8, t1477, t1479, t1482, t1483, t1485, t1486, t1487;
  double t1488, t1490, t1493, t1495, t1497, t1498, t1500, tv3rhosigma20;
  double t1504, t1506, t1507, t1509, t1511, tv3rhosigma21, tv3rhosigma22, t1515;
  double t1517, t1518, t1519, t1521, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, t1525;
  double t1528, t1531, tv3rhosigma26, t1537, tv3rhosigma27, tv3rhosigma28, t1542, tv3rhosigma29;
  double tv3rhosigma210, tv3rhosigma211, t1545, t1546, t1549, t1550, t1554, t1559;
  double t1561, tv3sigma30, t1564, tv3sigma31, tv3sigma32, t1567, tv3sigma33, tv3sigma34;
  double tv3sigma35, t1570, tv3sigma36, tv3sigma37, tv3sigma38, tv3sigma39;

  double t1574, t1576, t1579, t1582, t1586, t1587, t1589, t1592;
  double t1593, t1596, t1609, t1611, t1612, t1618, t1623, t1625;
  double t1629, t1631, t1633, t1634, t1640, t1645, t1649, t1655;
  double t1658, t1671, t1673, t1686, t1691, t1693, t1697, t1698;
  double t1703, t1706, t1708, t1712, t1714, t1720, t1725, t1731;
  double t1736, t1738, t1741, t1742, t1744, t1746, t1748, t1754;
  double t1757, t1762, t1768, t1771, t1775, t1779, t1783, t1785;
  double t1788, t1790, t1793, t1797, t1801, t1803, t1805, t1807;
  double t1814, t1815, t1817, t1818, t1821, t1823, t1828, t1830;
  double t1833, t1836, t1840, t1842, t1844, t1850, t1874, t1875;
  double t1876, t1878, t1879, t1881, t1885, t1886, t1887, t1888;
  double t1891, t1892, t1893, tv4rho40, t1898, t1901, t1907, t1910;
  double t1918, t1920, t1925, t1928, t1934, t1937, t1945, t1947;
  double t1951, t1953, t1954, t1955, t1958, t1962, t1977, t1978;
  double t1980, t1982, t1984, t1987, t1990, t1991, t1992, t1993;
  double t1995, t1999, t2000, t2002, t2024, t2026, t2047, t2049;
  double t2054, t2057, t2058, t2060, t2070, t2073, t2074, t2088;
  double t2090, t2093, t2101, t2103, t2110, t2111, t2114, t2115;
  double t2116, t2119, t2123, t2127, t2138, t2146, t2149, t2150;
  double t2154, t2157, t2161, t2163, t2167, tv4rho41, t2169, t2172;
  double t2182, t2187, t2204, t2214, t2235, t2240, t2241, t2243;
  double t2245, t2247, t2249, t2250, t2252, t2260, t2285, t2309;
  double t2314, t2316, t2321, t2323, t2335, t2338, t2356, t2363;
  double t2376, t2378, t2381, t2385, t2389, t2393, t2406, t2413;
  double t2417, t2423, t2429, t2442, t2447, tv4rho42, t2453, t2456;
  double t2466, t2470, t2476, t2479, t2487, t2491, t2495, t2497;
  double t2516, t2534, t2539, t2542, t2546, t2550, t2569, t2583;
  double t2592, t2594, t2603, t2611, t2621, t2633, t2636, t2643;
  double t2646, tv4rho43, t2647, t2652, t2658, t2662, t2663, t2668;
  double t2673, t2677, t2699, t2714, t2726, t2730, t2749, t2759;
  double t2770, tv4rho44, t2780, t2783, t2787, t2799, t2800, t2803;
  double t2804, t2806, t2807, t2809, t2810, t2813, t2814, t2817;
  double t2818, t2821, t2822, t2824, t2825, t2826, t2828, t2829;
  double t2831, t2832, t2837, t2838, t2839, t2841, t2842, t2844;
  double t2845, t2847, t2848, t2850, t2851, t2853, t2854, t2856;
  double t2857, t2859, t2860, t2862, t2864, t2865, t2867, t2868;
  double t2869, tv4rho3sigma0, t2876, t2879, t2883, t2884, t2889, t2890;
  double t2892, t2900, t2905, tv4rho3sigma1, t2912, t2915, t2919, t2922;
  double t2923, tv4rho3sigma2, t2930, t2931, t2934, t2942, t2943, t2946;
  double t2947, t2950, t2951, t2953, t2954, t2957, t2958, t2961;
  double t2962, t2964, t2965, t2967, t2968, t2970, t2971, t2972;
  double t2973, t2974, t2975, t2976, t2977, t2978, t2980, t2982;
  double t2984, t2985, t2987, t2989, t2992, t2995, t2998, t3001;
  double t3005, t3006, t3009, t3010, t3011, tv4rho3sigma3, t3018, t3021;
  double t3023, t3026, t3027, t3028, t3029, t3036, t3037, t3039;
  double t3041, t3048, t3049, t3050, tv4rho3sigma4, t3057, t3060, t3065;
  double tv4rho3sigma5, t3072, t3080, t3081, t3083, t3084, t3087, t3088;
  double t3091, t3092, t3095, t3096, t3099, t3100, t3102, t3103;
  double t3105, t3106, t3107, t3108, t3109, t3113, t3116, t3119;
  double t3122, t3124, t3127, t3129, tv4rho3sigma6, t3136, t3148, t3156;
  double tv4rho3sigma7, t3163, t3171, tv4rho3sigma8, t3179, t3181, t3182, t3184;
  double t3185, t3186, t3187, t3188, t3191, t3192, t3195, t3196;
  double t3197, t3198, t3199, t3200, t3201, t3204, t3205, t3207;
  double t3208, t3209, t3210, tv4rho3sigma9, t3233, tv4rho3sigma10, t3249, t3250;
  double tv4rho3sigma11, t3256, t3257, t3260, t3263, t3264, t3265, t3267;
  double t3268, t3270, t3273, t3274, t3276, t3277, t3280, t3281;
  double t3284, t3286, t3288, t3289, t3292, t3298, t3299, t3300;
  double tv4rho2sigma20, t3305, t3306, t3309, t3310, t3312, t3313, t3314;
  double t3316, t3318, t3319, tv4rho2sigma21, tv4rho2sigma22, t3324, t3325, t3331;
  double t3332, t3333, t3336, t3337, tv4rho2sigma23, tv4rho2sigma24, tv4rho2sigma25, t3342;
  double t3346, t3349, t3352, t3355, t3360, t3363, t3366, t3369;
  double tv4rho2sigma26, t3374, t3377, t3378, t3381, t3383, tv4rho2sigma27, tv4rho2sigma28;
  double t3388, t3391, t3392, t3395, t3396, tv4rho2sigma29, tv4rho2sigma210, tv4rho2sigma211;
  double t3402, t3405, t3408, t3411, t3413, tv4rho2sigma212, t3422, tv4rho2sigma213;
  double tv4rho2sigma214, t3433, tv4rho2sigma215, tv4rho2sigma216, tv4rho2sigma217, t3438, t3440, t3443;
  double t3444, t3446, t3447, t3450, t3455, t3456, t3457, t3459;
  double t3466, t3467, tv4rhosigma30, t3473, t3475, t3476, t3478, t3480;
  double tv4rhosigma31, tv4rhosigma32, t3486, t3488, t3489, t3491, t3493, tv4rhosigma33;
  double tv4rhosigma34, tv4rhosigma35, t3499, t3501, t3502, t3504, t3506, tv4rhosigma36;
  double tv4rhosigma37, tv4rhosigma38, tv4rhosigma39, t3512, t3516, t3519, tv4rhosigma310, tv4rhosigma311;
  double tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, tv4rhosigma319;
  double t3549, t3554, t3559, t3565, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43;
  double tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411;
  double tv4sigma412, tv4sigma413, tv4sigma414;

  gga_c_lm_params *params;

  assert(p->params != NULL);
  params = (gga_c_lm_params * )(p->params);

  t1 = 0.1e1 / M_PI;
  t2 = rho[0] + rho[1];
  t3 = 0.1e1 / t2;
  t6 = 0.1e1 + t1 * t3 / 0.36e5;
  t7 = M_CBRT3;
  t8 = t7 * t7;
  t9 = POW_1_3(t1);
  t10 = 0.1e1 / t9;
  t11 = t8 * t10;
  t12 = M_CBRT4;
  t13 = POW_1_3(t2);
  t15 = t11 * t12 * t13;
  t17 = 0.1e1 + 0.1e2 * t15;
  t18 = log(t17);
  t20 = 0.252e-1 * t6 * t18;
  t21 = t9 * t9;
  t22 = t8 * t21;
  t23 = t13 * t13;
  t24 = 0.1e1 / t23;
  t25 = t12 * t24;
  t26 = t22 * t25;
  t27 = 0.7e-5 * t26;
  t28 = t7 * t9;
  t29 = t12 * t12;
  t32 = t28 * t29 / t13;
  t33 = 0.105e-3 * t32;
  t34 = rho[0] - rho[1];
  t35 = t34 * t3;
  t36 = 0.1e1 + t35;
  t37 = t36 <= p->zeta_threshold;
  t38 = POW_1_3(p->zeta_threshold);
  t39 = t38 * p->zeta_threshold;
  t40 = POW_1_3(t36);
  t41 = t40 * t36;
  t42 = my_piecewise3(t37, t39, t41);
  t43 = 0.1e1 - t35;
  t44 = t43 <= p->zeta_threshold;
  t45 = POW_1_3(t43);
  t46 = t45 * t43;
  t47 = my_piecewise3(t44, t39, t46);
  t49 = M_CBRT2;
  t52 = 0.1e1 / (0.2e1 * t49 - 0.2e1);
  t53 = (t42 + t47 - 0.2e1) * t52;
  t55 = 0.1e1 + 0.56588424210451674939e-6 * t3;
  t57 = 0.1e1 + 0.25e2 * t15;
  t58 = log(t57);
  t63 = -0.127e-1 * t55 * t58 - 0.64355555555555555556e-5 * t26 + 0.83833333333333333334e-4 * t32 - 0.41666666666666666667e-2 + t20;
  t64 = t53 * t63;
  t65 = M_PI * t8;
  t66 = M_PI * M_PI;
  t67 = POW_1_3(t66);
  t69 = 0.1e1 / t67 / t66;
  t70 = rho[0] * rho[0];
  t71 = POW_1_3(rho[0]);
  t72 = t71 * t71;
  t74 = 0.1e1 / t72 / t70;
  t75 = sigma[0] * t74;
  t77 = rho[1] * rho[1];
  t78 = POW_1_3(rho[1]);
  t79 = t78 * t78;
  t81 = 0.1e1 / t79 / t77;
  t82 = sigma[2] * t81;
  t87 = t38 * t38;
  t88 = t87 * p->zeta_threshold;
  t89 = t40 * t40;
  t90 = t89 * t36;
  t91 = my_piecewise3(t37, t88, t90);
  t92 = t45 * t45;
  t93 = t92 * t43;
  t94 = my_piecewise3(t44, t88, t93);
  t95 = t91 + t94;
  t96 = sqrt(t95);
  t98 = M_SQRT2;
  t99 = 0.1e1 / t96 * t98;
  t100 = t7 * params->lm_f;
  t101 = pow(t1, 0.1e1 / 0.6e1);
  t102 = 0.1e1 / t101;
  t104 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t105 = sqrt(t104);
  t106 = t102 * t105;
  t107 = pow(t2, 0.1e1 / 0.6e1);
  t112 = exp(-t100 * t106 / t107 / t2);
  t113 = t112 * t104;
  t114 = t2 * t2;
  t116 = 0.1e1 / t23 / t114;
  t121 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t42 + t82 * t47) + 0.2e1 * t99 * t113 * t116);
  t124 = t65 * t121 * t13 / 0.144e3;
  tzk0 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = 0.1e1 / t114;
  t127 = t1 * t125 * t18;
  t128 = 0.7e-6 * t127;
  t130 = t6 * t8 * t10;
  t131 = 0.1e1 / t17;
  t133 = t130 * t25 * t131;
  t134 = 0.84e-1 * t133;
  t136 = 0.1e1 / t23 / t2;
  t137 = t12 * t136;
  t138 = t22 * t137;
  t139 = 0.46666666666666666667e-5 * t138;
  t140 = t13 * t2;
  t142 = t29 / t140;
  t143 = t28 * t142;
  t144 = 0.35e-4 * t143;
  t145 = t34 * t125;
  t146 = t3 - t145;
  t149 = my_piecewise3(t37, 0, 0.4e1 / 0.3e1 * t40 * t146);
  t150 = -t146;
  t153 = my_piecewise3(t44, 0, 0.4e1 / 0.3e1 * t45 * t150);
  t155 = (t149 + t153) * t52;
  t156 = t155 * t63;
  t160 = t55 * t8 * t10;
  t161 = 0.1e1 / t57;
  t167 = 0.71867298747273627173e-8 * t125 * t58 - 0.10583333333333333333e0 * t160 * t25 * t161 + 0.42903703703703703704e-5 * t138 - 0.27944444444444444445e-4 * t143 - t128 + t134;
  t168 = t53 * t167;
  t171 = 0.1e1 / t72 / t70 / rho[0];
  t172 = sigma[0] * t171;
  t182 = 0.1e1 / t96 / t95 * t98;
  t183 = t182 * t112;
  t184 = t104 * t116;
  t187 = my_piecewise3(t37, 0, 0.5e1 / 0.3e1 * t89 * t146);
  t190 = my_piecewise3(t44, 0, 0.5e1 / 0.3e1 * t92 * t150);
  t191 = t187 + t190;
  t194 = t99 * t100;
  t195 = t105 * t104;
  t196 = t102 * t195;
  t197 = t114 * t114;
  t198 = t107 * t107;
  t199 = t198 * t198;
  t200 = t199 * t107;
  t202 = 0.1e1 / t200 / t197;
  t203 = t202 * t112;
  t206 = 0.7e1 / 0.3e1 * t194 * t196 * t203;
  t207 = t114 * t2;
  t209 = 0.1e1 / t23 / t207;
  t212 = 0.16e2 / 0.3e1 * t99 * t113 * t209;
  t214 = t69 * (-0.7e1 / 0.36e2 * t49 * (-0.8e1 / 0.3e1 * t172 * t42 + t75 * t149 + t82 * t153) - t183 * t184 * t191 + t206 - t212);
  t216 = t65 * t214 * t13;
  t217 = t216 / 0.144e3;
  t219 = t65 * t121 * t24;
  t220 = t219 / 0.432e3;
  tvrho0 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124 + t2 * (t128 - t134 - t139 + t144 + t156 + t168 + t217 + t220);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t223 = -t3 - t145;
  t226 = my_piecewise3(t37, 0, 0.4e1 / 0.3e1 * t40 * t223);
  t227 = -t223;
  t230 = my_piecewise3(t44, 0, 0.4e1 / 0.3e1 * t45 * t227);
  t232 = (t226 + t230) * t52;
  t233 = t232 * t63;
  t237 = 0.1e1 / t79 / t77 / rho[1];
  t238 = sigma[2] * t237;
  t247 = my_piecewise3(t37, 0, 0.5e1 / 0.3e1 * t89 * t223);
  t250 = my_piecewise3(t44, 0, 0.5e1 / 0.3e1 * t92 * t227);
  t251 = t247 + t250;
  t255 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t226 - 0.8e1 / 0.3e1 * t238 * t47 + t82 * t230) - t183 * t184 * t251 + t206 - t212);
  t257 = t65 * t255 * t13;
  t258 = t257 / 0.144e3;
  tvrho1 = -t20 + t27 - t33 + 0.84e-2 + t64 + t124 + t2 * (t128 - t134 - t139 + t144 + t233 + t168 + t258 + t220);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t261 = t140 * M_PI;
  t262 = t8 * t69;
  t263 = t49 * t74;
  t267 = 0.1e1 / t200 / t207;
  t268 = t267 * t112;
  t270 = t194 * t106 * t268;
  t271 = t112 * t116;
  t272 = t99 * t271;
  t273 = 0.2e1 * t272;
  t274 = -0.7e1 / 0.36e2 * t263 * t42 - t270 + t273;
  tvsigma0 = t261 * t262 * t274 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t279 = -0.2e1 * t270 + 0.4e1 * t272;
  tvsigma1 = t261 * t262 * t279 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t282 = t49 * t81;
  t285 = -0.7e1 / 0.36e2 * t282 * t47 - t270 + t273;
  tvsigma2 = t261 * t262 * t285 / 0.144e3;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t288 = 0.14e-5 * t127;
  t289 = 0.168e0 * t133;
  t290 = 0.93333333333333333334e-5 * t138;
  t291 = 0.7e-4 * t143;
  t293 = 0.2e1 * t168;
  t295 = t219 / 0.216e3;
  t296 = 0.1e1 / t207;
  t298 = t1 * t296 * t18;
  t299 = 0.14e-5 * t298;
  t302 = t10 * t12;
  t303 = t302 * t131;
  t304 = t1 * t116 * t8 * t303;
  t305 = 0.46666666666666666666e-5 * t304;
  t307 = t130 * t137 * t131;
  t308 = 0.56e-1 * t307;
  t310 = 0.1e1 / t21;
  t311 = t6 * t7 * t310;
  t312 = t17 * t17;
  t313 = 0.1e1 / t312;
  t315 = t311 * t142 * t313;
  t316 = 0.84e0 * t315;
  t317 = t12 * t116;
  t318 = t22 * t317;
  t319 = 0.77777777777777777778e-5 * t318;
  t322 = t29 / t13 / t114;
  t323 = t28 * t322;
  t324 = 0.46666666666666666667e-4 * t323;
  t325 = 0.1e1 / t89;
  t326 = t146 * t146;
  t329 = t34 * t296;
  t331 = -0.2e1 * t125 + 0.2e1 * t329;
  t335 = my_piecewise3(t37, 0, 0.4e1 / 0.9e1 * t325 * t326 + 0.4e1 / 0.3e1 * t40 * t331);
  t336 = 0.1e1 / t92;
  t337 = t150 * t150;
  t340 = -t331;
  t344 = my_piecewise3(t44, 0, 0.4e1 / 0.9e1 * t336 * t337 + 0.4e1 / 0.3e1 * t45 * t340);
  t346 = (t335 + t344) * t52;
  t347 = t346 * t63;
  t348 = t155 * t167;
  t349 = 0.2e1 * t348;
  t353 = t302 * t161;
  t360 = t55 * t7 * t310;
  t361 = t57 * t57;
  t362 = 0.1e1 / t361;
  t368 = -0.14373459749454725435e-7 * t296 * t58 + 0.11977883124545604529e-6 * t116 * t8 * t353 + 0.70555555555555555553e-1 * t160 * t137 * t161 + 0.26458333333333333332e1 * t360 * t142 * t362 - 0.7150617283950617284e-5 * t318 + 0.3725925925925925926e-4 * t323 + t299 - t305 - t308 - t316;
  t369 = t53 * t368;
  t370 = t70 * t70;
  t372 = 0.1e1 / t72 / t370;
  t373 = sigma[0] * t372;
  t383 = t95 * t95;
  t386 = 0.1e1 / t96 / t383 * t98;
  t387 = t386 * t112;
  t388 = t191 * t191;
  t392 = t182 * t100;
  t393 = t203 * t191;
  t395 = t392 * t196 * t393;
  t397 = t104 * t209;
  t399 = t183 * t397 * t191;
  t401 = 0.1e1 / t40;
  t407 = my_piecewise3(t37, 0, 0.1e2 / 0.9e1 * t401 * t326 + 0.5e1 / 0.3e1 * t89 * t331);
  t408 = 0.1e1 / t45;
  t414 = my_piecewise3(t44, 0, 0.1e2 / 0.9e1 * t408 * t337 + 0.5e1 / 0.3e1 * t92 * t340);
  t415 = t407 + t414;
  t418 = t197 * t2;
  t420 = 0.1e1 / t200 / t418;
  t421 = t420 * t112;
  t424 = 0.35e2 / 0.2e1 * t194 * t196 * t421;
  t425 = params->lm_f * params->lm_f;
  t426 = t8 * t425;
  t427 = t99 * t426;
  t428 = t104 * t104;
  t429 = t10 * t428;
  t430 = t197 * t207;
  t431 = 0.1e1 / t430;
  t432 = t431 * t112;
  t435 = 0.49e2 / 0.18e2 * t427 * t429 * t432;
  t437 = 0.1e1 / t23 / t197;
  t440 = 0.176e3 / 0.9e1 * t99 * t113 * t437;
  t442 = t69 * (-0.7e1 / 0.36e2 * t49 * (0.88e2 / 0.9e1 * t373 * t42 - 0.16e2 / 0.3e1 * t172 * t149 + t75 * t335 + t82 * t344) + 0.3e1 / 0.2e1 * t387 * t184 * t388 - 0.7e1 / 0.3e1 * t395 + 0.16e2 / 0.3e1 * t399 - t183 * t184 * t415 - t424 + t435 + t440);
  t444 = t65 * t442 * t13;
  t445 = t444 / 0.144e3;
  t447 = t65 * t214 * t24;
  t448 = t447 / 0.216e3;
  t450 = t65 * t121 * t136;
  t451 = t450 / 0.648e3;
  t452 = -t299 + t305 + t308 + t316 + t319 - t324 + t347 + t349 + t369 + t445 + t448 - t451;
  tv2rho20 = t288 - t289 - t290 + t291 + 0.2e1 * t156 + t293 + t216 / 0.72e2 + t295 + t2 * t452;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t454 = t325 * t223;
  t457 = t40 * t34;
  t461 = my_piecewise3(t37, 0, 0.4e1 / 0.9e1 * t454 * t146 + 0.8e1 / 0.3e1 * t457 * t296);
  t462 = t336 * t227;
  t465 = t45 * t34;
  t469 = my_piecewise3(t44, 0, 0.4e1 / 0.9e1 * t462 * t150 - 0.8e1 / 0.3e1 * t465 * t296);
  t471 = (t461 + t469) * t52;
  t472 = t471 * t63;
  t473 = t232 * t167;
  t483 = t251 * t191;
  t487 = t203 * t251;
  t489 = t392 * t196 * t487;
  t492 = t183 * t397 * t251;
  t494 = t401 * t223;
  t497 = t89 * t34;
  t501 = my_piecewise3(t37, 0, 0.1e2 / 0.9e1 * t494 * t146 + 0.1e2 / 0.3e1 * t497 * t296);
  t502 = t408 * t227;
  t505 = t92 * t34;
  t509 = my_piecewise3(t44, 0, 0.1e2 / 0.9e1 * t502 * t150 - 0.1e2 / 0.3e1 * t505 * t296);
  t510 = t501 + t509;
  t516 = t69 * (-0.7e1 / 0.36e2 * t49 * (-0.8e1 / 0.3e1 * t172 * t226 + t75 * t461 - 0.8e1 / 0.3e1 * t238 * t153 + t82 * t469) + 0.3e1 / 0.2e1 * t387 * t184 * t483 - 0.7e1 / 0.6e1 * t489 + 0.8e1 / 0.3e1 * t492 - t183 * t184 * t510 - 0.7e1 / 0.6e1 * t395 - t424 + t435 + 0.8e1 / 0.3e1 * t399 + t440);
  t518 = t65 * t516 * t13;
  t521 = t65 * t255 * t24;
  t524 = -t299 + t305 + t308 + t316 + t319 - t324 + t472 + t473 + t348 + t369 + t518 / 0.144e3 + t521 / 0.432e3 + t447 / 0.432e3 - t451;
  tv2rho21 = t2 * t524 + t156 + t217 + t233 + t258 + t288 - t289 - t290 + t291 + t293 + t295;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t528 = t223 * t223;
  t532 = 0.2e1 * t125 + 0.2e1 * t329;
  t536 = my_piecewise3(t37, 0, 0.4e1 / 0.9e1 * t325 * t528 + 0.4e1 / 0.3e1 * t40 * t532);
  t537 = t227 * t227;
  t540 = -t532;
  t544 = my_piecewise3(t44, 0, 0.4e1 / 0.9e1 * t336 * t537 + 0.4e1 / 0.3e1 * t45 * t540);
  t546 = (t536 + t544) * t52;
  t547 = t546 * t63;
  t548 = 0.2e1 * t473;
  t550 = t77 * t77;
  t552 = 0.1e1 / t79 / t550;
  t553 = sigma[2] * t552;
  t562 = t251 * t251;
  t573 = my_piecewise3(t37, 0, 0.1e2 / 0.9e1 * t401 * t528 + 0.5e1 / 0.3e1 * t89 * t532);
  t579 = my_piecewise3(t44, 0, 0.1e2 / 0.9e1 * t408 * t537 + 0.5e1 / 0.3e1 * t92 * t540);
  t580 = t573 + t579;
  t584 = t69 * (-0.7e1 / 0.36e2 * t49 * (t75 * t536 + 0.88e2 / 0.9e1 * t553 * t47 - 0.16e2 / 0.3e1 * t238 * t230 + t82 * t544) + 0.3e1 / 0.2e1 * t387 * t184 * t562 - 0.7e1 / 0.3e1 * t489 + 0.16e2 / 0.3e1 * t492 - t183 * t184 * t580 - t424 + t435 + t440);
  t586 = t65 * t584 * t13;
  t587 = t586 / 0.144e3;
  t588 = t521 / 0.216e3;
  t589 = -t299 + t305 + t308 + t316 + t319 - t324 + t547 + t548 + t369 + t587 + t588 - t451;
  tv2rho22 = t288 - t289 - t290 + t291 + 0.2e1 * t233 + t293 + t257 / 0.72e2 + t295 + t2 * t589;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t591 = t69 * t274;
  t594 = t65 * t591 * t13 / 0.108e3;
  t595 = t49 * t171;
  t600 = t268 * t191;
  t602 = t392 * t106 * t600;
  t603 = t602 / 0.2e1;
  t605 = t194 * t106 * t203;
  t606 = 0.37e2 / 0.6e1 * t605;
  t607 = t10 * t104;
  t608 = t197 * t114;
  t609 = 0.1e1 / t608;
  t610 = t609 * t112;
  t612 = t427 * t607 * t610;
  t613 = 0.7e1 / 0.6e1 * t612;
  t615 = t182 * t271 * t191;
  t616 = t112 * t209;
  t617 = t99 * t616;
  t618 = 0.16e2 / 0.3e1 * t617;
  t619 = 0.14e2 / 0.27e2 * t595 * t42 - 0.7e1 / 0.36e2 * t263 * t149 + t603 + t606 - t613 - t615 - t618;
  tv2rhosigma0 = t594 + t261 * t262 * t619 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t623 = t69 * t279;
  t626 = t65 * t623 * t13 / 0.108e3;
  t627 = 0.37e2 / 0.3e1 * t605;
  t628 = 0.7e1 / 0.3e1 * t612;
  t630 = 0.32e2 / 0.3e1 * t617;
  t631 = t602 + t627 - t628 - 0.2e1 * t615 - t630;
  tv2rhosigma1 = t626 + t261 * t262 * t631 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t635 = t69 * t285;
  t638 = t65 * t635 * t13 / 0.108e3;
  t641 = -0.7e1 / 0.36e2 * t282 * t153 + t603 + t606 - t613 - t615 - t618;
  tv2rhosigma2 = t638 + t261 * t262 * t641 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t647 = t268 * t251;
  t649 = t392 * t106 * t647;
  t650 = t649 / 0.2e1;
  t652 = t182 * t271 * t251;
  t654 = t262 * (-0.7e1 / 0.36e2 * t263 * t226 + t650 + t606 - t613 - t652 - t618);
  tv2rhosigma3 = t594 + t261 * t654 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  t659 = t262 * (t649 + t627 - t628 - 0.2e1 * t652 - t630);
  tv2rhosigma4 = t626 + t261 * t659 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t662 = t49 * t237;
  t668 = t262 * (0.14e2 / 0.27e2 * t662 * t47 - 0.7e1 / 0.36e2 * t282 * t230 + t650 + t606 - t613 - t652 - t618);
  tv2rhosigma5 = t638 + t261 * t668 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t671 = 0.1e1 / t105;
  t672 = t102 * t671;
  t674 = t194 * t672 * t268;
  t676 = t99 * t8;
  t677 = t425 * t10;
  t678 = 0.1e1 / t418;
  t679 = t678 * t112;
  t681 = t676 * t677 * t679;
  t684 = t262 * (-0.3e1 / 0.2e1 * t674 + t681 / 0.2e1);
  tv2sigma20 = t261 * t684 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t688 = t262 * (-0.3e1 * t674 + t681);
  tv2sigma21 = t261 * t688 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = tv2sigma20;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  t693 = t262 * (-0.6e1 * t674 + 0.2e1 * t681);
  tv2sigma23 = t261 * t693 / 0.144e3;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = tv2sigma21;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = tv2sigma22;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t695 = 0.42e-5 * t298;
  t698 = 0.3e1 * t369;
  t699 = 0.14e-4 * t304;
  t700 = 0.252e1 * t315;
  t702 = t450 / 0.216e3;
  t703 = 0.23333333333333333334e-4 * t318;
  t704 = 0.14e-3 * t323;
  t706 = 0.168e0 * t307;
  t707 = 0.1e1 / t197;
  t709 = t1 * t707 * t18;
  t710 = 0.42e-5 * t709;
  t713 = t1 * t209 * t8 * t303;
  t714 = 0.18666666666666666666e-4 * t713;
  t716 = 0.1e1 / t13 / t207;
  t719 = t310 * t29;
  t720 = t719 * t313;
  t721 = t1 * t716 * t7 * t720;
  t722 = 0.69999999999999999999e-4 * t721;
  t724 = t130 * t317 * t131;
  t725 = 0.93333333333333333334e-1 * t724;
  t727 = t311 * t322 * t313;
  t728 = 0.168e1 * t727;
  t729 = t6 * M_PI;
  t731 = 0.1e1 / t312 / t17;
  t733 = t729 * t125 * t731;
  t734 = 0.672e2 * t733;
  t735 = t12 * t209;
  t736 = t22 * t735;
  t737 = 0.20740740740740740741e-4 * t736;
  t738 = t29 * t716;
  t739 = t28 * t738;
  t740 = 0.10888888888888888889e-3 * t739;
  t741 = 0.1e1 / t90;
  t742 = t326 * t146;
  t745 = t325 * t146;
  t748 = t34 * t707;
  t750 = 0.6e1 * t296 - 0.6e1 * t748;
  t754 = my_piecewise3(t37, 0, -0.8e1 / 0.27e2 * t741 * t742 + 0.4e1 / 0.3e1 * t745 * t331 + 0.4e1 / 0.3e1 * t40 * t750);
  t755 = 0.1e1 / t93;
  t756 = t337 * t150;
  t759 = t336 * t150;
  t762 = -t750;
  t766 = my_piecewise3(t44, 0, -0.8e1 / 0.27e2 * t755 * t756 + 0.4e1 / 0.3e1 * t759 * t340 + 0.4e1 / 0.3e1 * t45 * t762);
  t768 = (t754 + t766) * t52;
  t769 = t768 * t63;
  t770 = t346 * t167;
  t772 = t155 * t368;
  t773 = 0.3e1 * t772;
  t780 = t719 * t362;
  t791 = 0.1e1 / t361 / t57;
  t796 = 0.43120379248364176305e-7 * t707 * t58 - 0.47911532498182418116e-6 * t209 * t8 * t353 - 0.44917061717046016982e-5 * t716 * t7 * t780 - 0.11759259259259259259e0 * t160 * t317 * t161 - 0.52916666666666666664e1 * t360 * t322 * t362 - 0.1662426112524598922e4 * t55 * t125 * t791 + 0.19068312757201646091e-4 * t736 - 0.86938271604938271607e-4 * t739 - t710 + t714 + t722 + t725 + t728 + t734;
  t797 = t53 * t796;
  t798 = t421 * t191;
  t800 = t392 * t196 * t798;
  t802 = t197 * t197;
  t804 = 0.1e1 / t802 * t112;
  t807 = 0.1421e4 / 0.36e2 * t427 * t429 * t804;
  t811 = 0.1e1 / t96 / t383 / t95 * t98;
  t812 = t811 * t112;
  t813 = t388 * t191;
  t818 = t387 * t397 * t388;
  t820 = t191 * t415;
  t824 = t104 * t437;
  t826 = t183 * t824 * t191;
  t828 = t425 * params->lm_f;
  t829 = t99 * t828;
  t830 = sqrt(t1);
  t831 = 0.1e1 / t830;
  t832 = t105 * t428;
  t833 = t831 * t832;
  t834 = t802 * t2;
  t836 = 0.1e1 / t107 / t834;
  t837 = t836 * t112;
  t840 = 0.343e3 / 0.36e2 * t829 * t833 * t837;
  t841 = t386 * t100;
  t842 = t203 * t388;
  t844 = t841 * t196 * t842;
  t846 = t203 * t415;
  t848 = t392 * t196 * t846;
  t850 = t182 * t426;
  t851 = t432 * t191;
  t853 = t850 * t429 * t851;
  t857 = 0.1e1 / t200 / t608 * t112;
  t860 = 0.13489e5 / 0.108e3 * t194 * t196 * t857;
  t862 = t183 * t397 * t415;
  t864 = 0.1e1 / t41;
  t867 = t401 * t146;
  t873 = my_piecewise3(t37, 0, -0.1e2 / 0.27e2 * t864 * t742 + 0.1e2 / 0.3e1 * t867 * t331 + 0.5e1 / 0.3e1 * t89 * t750);
  t874 = 0.1e1 / t46;
  t877 = t408 * t150;
  t883 = my_piecewise3(t44, 0, -0.1e2 / 0.27e2 * t874 * t756 + 0.1e2 / 0.3e1 * t877 * t340 + 0.5e1 / 0.3e1 * t92 * t762);
  t884 = t873 + t883;
  t888 = 0.1e1 / t23 / t418;
  t891 = 0.2464e4 / 0.27e2 * t99 * t113 * t888;
  t894 = 0.1e1 / t72 / t370 / rho[0];
  t895 = sigma[0] * t894;
  t907 = 0.105e3 / 0.4e1 * t800 - t807 - 0.15e2 / 0.4e1 * t812 * t184 * t813 - 0.12e2 * t818 + 0.9e1 / 0.2e1 * t387 * t184 * t820 - 0.88e2 / 0.3e1 * t826 + t840 + 0.21e2 / 0.4e1 * t844 - 0.7e1 / 0.2e1 * t848 - 0.49e2 / 0.12e2 * t853 + t860 + 0.8e1 * t862 - t183 * t184 * t884 - t891 - 0.7e1 / 0.36e2 * t49 * (-0.1232e4 / 0.27e2 * t895 * t42 + 0.88e2 / 0.3e1 * t373 * t149 - 0.8e1 * t172 * t335 + t75 * t754 + t82 * t766);
  t908 = t69 * t907;
  t910 = t65 * t908 * t13;
  t911 = t910 / 0.144e3;
  t913 = t65 * t442 * t24;
  t916 = t65 * t214 * t136;
  t917 = t916 / 0.216e3;
  t919 = t65 * t121 * t116;
  t920 = 0.5e1 / 0.1944e4 * t919;
  t921 = t710 - t714 - t722 - t725 - t728 - t734 - t737 + t740 + t769 + 0.3e1 * t770 + t773 + t797 + t911 + t913 / 0.144e3 - t917 + t920;
  tv3rho30 = -t695 + 0.3e1 * t347 + 0.6e1 * t348 + t698 + t699 + t700 + t447 / 0.72e2 - t702 + t703 - t704 + t444 / 0.48e2 + t706 + t2 * t921;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t924 = t65 * t516 * t24;
  t925 = t924 / 0.216e3;
  t926 = t100 * t102;
  t927 = t386 * t926;
  t928 = t195 * t202;
  t929 = t112 * t251;
  t930 = t929 * t191;
  t933 = 0.7e1 / 0.2e1 * t927 * t928 * t930;
  t934 = t421 * t251;
  t936 = t392 * t196 * t934;
  t943 = t741 * t223;
  t946 = t325 * t34;
  t947 = t296 * t146;
  t957 = my_piecewise3(t37, 0, -0.8e1 / 0.27e2 * t943 * t326 + 0.16e2 / 0.9e1 * t946 * t947 + 0.4e1 / 0.9e1 * t454 * t331 + 0.8e1 / 0.3e1 * t40 * t296 - 0.8e1 * t457 * t707);
  t961 = t755 * t227;
  t964 = t336 * t34;
  t965 = t296 * t150;
  t975 = my_piecewise3(t44, 0, -0.8e1 / 0.27e2 * t961 * t337 - 0.16e2 / 0.9e1 * t964 * t965 + 0.4e1 / 0.9e1 * t462 * t340 - 0.8e1 / 0.3e1 * t45 * t296 + 0.8e1 * t465 * t707);
  t980 = t251 * t388;
  t986 = 0.8e1 * t387 * t397 * t483;
  t989 = 0.16e2 / 0.3e1 * t183 * t397 * t510;
  t990 = t864 * t223;
  t993 = t401 * t34;
  t1003 = my_piecewise3(t37, 0, -0.1e2 / 0.27e2 * t990 * t326 + 0.4e2 / 0.9e1 * t993 * t947 + 0.1e2 / 0.9e1 * t494 * t331 + 0.1e2 / 0.3e1 * t89 * t296 - 0.1e2 * t497 * t707);
  t1004 = t874 * t227;
  t1007 = t408 * t34;
  t1017 = my_piecewise3(t44, 0, -0.1e2 / 0.27e2 * t1004 * t337 - 0.4e2 / 0.9e1 * t1007 * t965 + 0.1e2 / 0.9e1 * t502 * t340 - 0.1e2 / 0.3e1 * t92 * t296 + 0.1e2 * t505 * t707);
  t1018 = t1003 + t1017;
  t1021 = t510 * t191;
  t1025 = t251 * t415;
  t1029 = t933 + 0.35e2 / 0.4e1 * t936 + 0.35e2 / 0.2e1 * t800 - 0.7e1 / 0.36e2 * t49 * (0.88e2 / 0.9e1 * t373 * t226 - 0.16e2 / 0.3e1 * t172 * t461 + t75 * t957 - 0.8e1 / 0.3e1 * t238 * t344 + t82 * t975) - 0.15e2 / 0.4e1 * t812 * t184 * t980 - t986 - t807 + t989 - t183 * t184 * t1018 + 0.3e1 * t387 * t184 * t1021 + 0.3e1 / 0.2e1 * t387 * t184 * t1025;
  t1031 = t183 * t824 * t251;
  t1038 = t203 * t510;
  t1041 = 0.7e1 / 0.3e1 * t392 * t196 * t1038;
  t1042 = t432 * t251;
  t1044 = t850 * t429 * t1042;
  t1047 = -0.88e2 / 0.9e1 * t1031 - 0.4e1 * t818 - 0.176e3 / 0.9e1 * t826 + t840 + 0.7e1 / 0.4e1 * t844 - 0.7e1 / 0.6e1 * t848 - 0.49e2 / 0.18e2 * t853 + t860 - t1041 - 0.49e2 / 0.36e2 * t1044 + 0.8e1 / 0.3e1 * t862 - t891;
  t1049 = t69 * (t1029 + t1047);
  t1051 = t65 * t1049 * t13;
  t1055 = (t957 + t975) * t52;
  t1056 = t1055 * t63;
  t1057 = t471 * t167;
  t1058 = 0.2e1 * t1057;
  t1059 = t232 * t368;
  t1061 = t65 * t255 * t136;
  t1066 = -t737 + t740 + t925 + t1051 / 0.144e3 - t725 + t770 + 0.2e1 * t772 + t797 + t1056 + t1058 + t1059 - t1061 / 0.648e3 - 0.18666666666666666667e-4 * t713 - t722 - t728 + t913 / 0.432e3 - t916 / 0.324e3 + t920 + t710 - t734;
  t1069 = 0.2e1 * t472;
  t1071 = t518 / 0.72e2;
  tv3rho31 = t2 * t1066 - t695 + t347 + 0.4e1 * t348 + t698 + t1069 + t548 + t699 + t700 + t447 / 0.108e3 - t702 + t588 + t703 - t704 + t445 + t1071 + t706;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1073 = t741 * t528;
  t1078 = t325 * t532;
  t1083 = -0.2e1 * t296 - 0.6e1 * t748;
  t1087 = my_piecewise3(t37, 0, -0.8e1 / 0.27e2 * t1073 * t146 + 0.16e2 / 0.9e1 * t454 * t329 + 0.4e1 / 0.9e1 * t1078 * t146 + 0.4e1 / 0.3e1 * t40 * t1083);
  t1088 = t755 * t537;
  t1093 = t336 * t540;
  t1096 = -t1083;
  t1100 = my_piecewise3(t44, 0, -0.8e1 / 0.27e2 * t1088 * t150 - 0.16e2 / 0.9e1 * t462 * t329 + 0.4e1 / 0.9e1 * t1093 * t150 + 0.4e1 / 0.3e1 * t45 * t1096);
  t1102 = (t1087 + t1100) * t52;
  t1103 = t1102 * t63;
  t1104 = t546 * t167;
  t1107 = t387 * t397 * t562;
  t1109 = t251 * t510;
  t1113 = t580 * t191;
  t1118 = t183 * t397 * t580;
  t1120 = t864 * t528;
  t1125 = t401 * t532;
  t1131 = my_piecewise3(t37, 0, -0.1e2 / 0.27e2 * t1120 * t146 + 0.4e2 / 0.9e1 * t494 * t329 + 0.1e2 / 0.9e1 * t1125 * t146 + 0.5e1 / 0.3e1 * t89 * t1083);
  t1132 = t874 * t537;
  t1137 = t408 * t540;
  t1143 = my_piecewise3(t44, 0, -0.1e2 / 0.27e2 * t1132 * t150 - 0.4e2 / 0.9e1 * t502 * t329 + 0.1e2 / 0.9e1 * t1137 * t150 + 0.5e1 / 0.3e1 * t92 * t1096);
  t1144 = t1131 + t1143;
  t1149 = -0.4e1 * t1107 + 0.3e1 * t387 * t184 * t1109 + 0.3e1 / 0.2e1 * t387 * t184 * t1113 + 0.8e1 / 0.3e1 * t1118 - t183 * t184 * t1144 + t933 + 0.35e2 / 0.2e1 * t936 + 0.35e2 / 0.4e1 * t800 - t986 - t807 + t989;
  t1151 = t562 * t191;
  t1169 = t203 * t562;
  t1171 = t841 * t196 * t1169;
  t1173 = t203 * t580;
  t1175 = t392 * t196 * t1173;
  t1177 = -0.176e3 / 0.9e1 * t1031 - 0.15e2 / 0.4e1 * t812 * t184 * t1151 - 0.88e2 / 0.9e1 * t826 + t840 - 0.7e1 / 0.36e2 * t49 * (-0.8e1 / 0.3e1 * t172 * t536 + t75 * t1087 + 0.88e2 / 0.9e1 * t553 * t153 - 0.16e2 / 0.3e1 * t238 * t469 + t82 * t1100) - 0.49e2 / 0.36e2 * t853 + t860 - t1041 - 0.49e2 / 0.18e2 * t1044 + 0.7e1 / 0.4e1 * t1171 - 0.7e1 / 0.6e1 * t1175 - t891;
  t1179 = t69 * (t1149 + t1177);
  t1181 = t65 * t1179 * t13;
  t1184 = t65 * t584 * t24;
  t1188 = t710 - t714 - t722 - t725 - t728 - t734 - t737 + t740 + t1103 + t1104 + t1058 + 0.2e1 * t1059 + t772 + t797 + t1181 / 0.144e3 + t1184 / 0.432e3 + t925 - t1061 / 0.324e3 - t916 / 0.648e3 + t920;
  tv3rho32 = -t695 + t349 + t698 + t1069 + 0.4e1 * t473 + t547 + t2 * t1188 + t699 + t700 + t448 - t702 + t521 / 0.108e3 + t703 - t704 + t1071 + t587 + t706;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1195 = t528 * t223;
  t1201 = -0.6e1 * t296 - 0.6e1 * t748;
  t1205 = my_piecewise3(t37, 0, -0.8e1 / 0.27e2 * t741 * t1195 + 0.4e1 / 0.3e1 * t454 * t532 + 0.4e1 / 0.3e1 * t40 * t1201);
  t1206 = t537 * t227;
  t1211 = -t1201;
  t1215 = my_piecewise3(t44, 0, -0.8e1 / 0.27e2 * t755 * t1206 + 0.4e1 / 0.3e1 * t462 * t540 + 0.4e1 / 0.3e1 * t45 * t1211);
  t1217 = (t1205 + t1215) * t52;
  t1218 = t1217 * t63;
  t1220 = 0.3e1 * t1059;
  t1221 = t562 * t251;
  t1225 = t251 * t580;
  t1238 = my_piecewise3(t37, 0, -0.1e2 / 0.27e2 * t864 * t1195 + 0.1e2 / 0.3e1 * t494 * t532 + 0.5e1 / 0.3e1 * t89 * t1201);
  t1246 = my_piecewise3(t44, 0, -0.1e2 / 0.27e2 * t874 * t1206 + 0.1e2 / 0.3e1 * t502 * t540 + 0.5e1 / 0.3e1 * t92 * t1211);
  t1247 = t1238 + t1246;
  t1258 = 0.1e1 / t79 / t550 / rho[1];
  t1259 = sigma[2] * t1258;
  t1270 = -0.15e2 / 0.4e1 * t812 * t184 * t1221 + 0.9e1 / 0.2e1 * t387 * t184 * t1225 - 0.12e2 * t1107 + 0.8e1 * t1118 - t183 * t184 * t1247 + 0.105e3 / 0.4e1 * t936 - t807 - 0.88e2 / 0.3e1 * t1031 + t840 + t860 - 0.49e2 / 0.12e2 * t1044 + 0.21e2 / 0.4e1 * t1171 - 0.7e1 / 0.2e1 * t1175 - 0.7e1 / 0.36e2 * t49 * (t75 * t1205 - 0.1232e4 / 0.27e2 * t1259 * t47 + 0.88e2 / 0.3e1 * t553 * t230 - 0.8e1 * t238 * t544 + t82 * t1215) - t891;
  t1271 = t69 * t1270;
  t1273 = t65 * t1271 * t13;
  t1274 = t1273 / 0.144e3;
  t1276 = t1061 / 0.216e3;
  t1277 = t710 - t714 - t722 - t725 - t728 - t734 - t737 + t740 + t1218 + 0.3e1 * t1104 + t1220 + t797 + t1274 + t1184 / 0.144e3 - t1276 + t920;
  tv3rho33 = -t695 + t698 + 0.6e1 * t473 + 0.3e1 * t547 + t699 + t700 - t702 + t521 / 0.72e2 + t703 - t704 + t586 / 0.48e2 + t706 + t2 * t1277;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1279 = t69 * t619;
  t1281 = t65 * t1279 * t13;
  t1285 = t65 * t591 * t24 / 0.324e3;
  t1286 = t49 * t372;
  t1293 = t268 * t388;
  t1295 = t841 * t106 * t1293;
  t1296 = 0.3e1 / 0.4e1 * t1295;
  t1298 = t392 * t106 * t393;
  t1299 = 0.37e2 / 0.6e1 * t1298;
  t1302 = t850 * t607 * t610 * t191;
  t1303 = 0.7e1 / 0.6e1 * t1302;
  t1304 = t268 * t415;
  t1306 = t392 * t106 * t1304;
  t1307 = t1306 / 0.2e1;
  t1309 = t194 * t106 * t421;
  t1310 = 0.1297e4 / 0.36e2 * t1309;
  t1312 = t427 * t607 * t432;
  t1313 = 0.511e3 / 0.36e2 * t1312;
  t1314 = t831 * t195;
  t1316 = 0.1e1 / t107 / t802;
  t1319 = t829 * t1314 * t1316 * t112;
  t1320 = 0.49e2 / 0.12e2 * t1319;
  t1322 = t386 * t271 * t388;
  t1323 = 0.3e1 / 0.2e1 * t1322;
  t1325 = t182 * t616 * t191;
  t1326 = 0.16e2 / 0.3e1 * t1325;
  t1328 = t182 * t271 * t415;
  t1329 = t112 * t437;
  t1330 = t99 * t1329;
  t1331 = 0.176e3 / 0.9e1 * t1330;
  t1332 = -0.154e3 / 0.81e2 * t1286 * t42 + 0.28e2 / 0.27e2 * t595 * t149 - 0.7e1 / 0.36e2 * t263 * t335 - t1296 - t1299 + t1303 + t1307 - t1310 + t1313 - t1320 + t1323 + t1326 - t1328 + t1331;
  tv3rho2sigma0 = t1281 / 0.54e2 + t1285 + t261 * t262 * t1332 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t1336 = t69 * t631;
  t1338 = t65 * t1336 * t13;
  t1342 = t65 * t623 * t24 / 0.324e3;
  t1346 = 0.1297e4 / 0.18e2 * t1309;
  t1347 = 0.511e3 / 0.18e2 * t1312;
  t1348 = 0.49e2 / 0.6e1 * t1319;
  t1352 = 0.352e3 / 0.9e1 * t1330;
  t1353 = -0.3e1 / 0.2e1 * t1295 - 0.37e2 / 0.3e1 * t1298 + 0.7e1 / 0.3e1 * t1302 + t1306 - t1346 + t1347 - t1348 + 0.3e1 * t1322 + 0.32e2 / 0.3e1 * t1325 - 0.2e1 * t1328 + t1352;
  tv3rho2sigma1 = t1338 / 0.54e2 + t1342 + t261 * t262 * t1353 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1357 = t69 * t641;
  t1359 = t65 * t1357 * t13;
  t1363 = t65 * t635 * t24 / 0.324e3;
  t1366 = -0.7e1 / 0.36e2 * t282 * t344 - t1296 - t1299 + t1303 + t1307 - t1310 + t1313 - t1320 + t1323 + t1326 - t1328 + t1331;
  tv3rho2sigma2 = t1359 / 0.54e2 + t1363 + t261 * t262 * t1366 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1371 = t13 * M_PI;
  t1372 = t1371 * t654;
  t1378 = t105 * t267;
  t1380 = t927 * t1378 * t930;
  t1381 = 0.3e1 / 0.4e1 * t1380;
  t1383 = t392 * t106 * t487;
  t1384 = 0.37e2 / 0.12e2 * t1383;
  t1387 = t850 * t607 * t610 * t251;
  t1388 = 0.7e1 / 0.12e2 * t1387;
  t1389 = t268 * t510;
  t1391 = t392 * t106 * t1389;
  t1392 = t1391 / 0.2e1;
  t1393 = 0.37e2 / 0.12e2 * t1298;
  t1394 = 0.7e1 / 0.12e2 * t1302;
  t1395 = t116 * t251;
  t1397 = t387 * t1395 * t191;
  t1398 = 0.3e1 / 0.2e1 * t1397;
  t1400 = t182 * t616 * t251;
  t1401 = 0.8e1 / 0.3e1 * t1400;
  t1403 = t182 * t271 * t510;
  t1404 = 0.8e1 / 0.3e1 * t1325;
  t1405 = 0.14e2 / 0.27e2 * t595 * t226 - 0.7e1 / 0.36e2 * t263 * t461 - t1381 - t1384 + t1388 + t1392 - t1393 - t1310 + t1313 + t1394 - t1320 + t1398 + t1401 - t1403 + t1404 + t1331;
  t1406 = t262 * t1405;
  tv3rho2sigma3 = t1281 / 0.108e3 + t1285 + t1372 / 0.108e3 + t261 * t1406 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t1410 = t1371 * t659;
  t1413 = 0.37e2 / 0.6e1 * t1383;
  t1414 = 0.7e1 / 0.6e1 * t1387;
  t1416 = 0.16e2 / 0.3e1 * t1400;
  t1418 = -0.3e1 / 0.2e1 * t1380 - t1413 + t1414 + t1391 - t1299 - t1346 + t1347 + t1303 - t1348 + 0.3e1 * t1397 + t1416 - 0.2e1 * t1403 + t1326 + t1352;
  t1419 = t262 * t1418;
  tv3rho2sigma4 = t1338 / 0.108e3 + t1342 + t1410 / 0.108e3 + t261 * t1419 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1423 = t1371 * t668;
  t1429 = 0.14e2 / 0.27e2 * t662 * t153 - 0.7e1 / 0.36e2 * t282 * t469 - t1381 - t1384 + t1388 + t1392 - t1393 - t1310 + t1313 + t1394 - t1320 + t1398 + t1401 - t1403 + t1404 + t1331;
  t1430 = t262 * t1429;
  tv3rho2sigma5 = t1359 / 0.108e3 + t1363 + t1423 / 0.108e3 + t261 * t1430 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1436 = t268 * t562;
  t1438 = t841 * t106 * t1436;
  t1439 = 0.3e1 / 0.4e1 * t1438;
  t1440 = t268 * t580;
  t1442 = t392 * t106 * t1440;
  t1443 = t1442 / 0.2e1;
  t1445 = t386 * t271 * t562;
  t1446 = 0.3e1 / 0.2e1 * t1445;
  t1448 = t182 * t271 * t580;
  t1449 = -0.7e1 / 0.36e2 * t263 * t536 - t1439 - t1413 + t1414 + t1443 - t1310 + t1313 - t1320 + t1446 + t1416 - t1448 + t1331;
  t1450 = t262 * t1449;
  tv3rho2sigma6 = t1372 / 0.54e2 + t1285 + t261 * t1450 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  t1460 = -0.3e1 / 0.2e1 * t1438 - 0.37e2 / 0.3e1 * t1383 + 0.7e1 / 0.3e1 * t1387 + t1442 - t1346 + t1347 - t1348 + 0.3e1 * t1445 + 0.32e2 / 0.3e1 * t1400 - 0.2e1 * t1448 + t1352;
  t1461 = t262 * t1460;
  tv3rho2sigma7 = t1410 / 0.54e2 + t1342 + t261 * t1461 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1465 = t49 * t552;
  t1472 = -0.154e3 / 0.81e2 * t1465 * t47 + 0.28e2 / 0.27e2 * t662 * t230 - 0.7e1 / 0.36e2 * t282 * t544 - t1439 - t1413 + t1414 + t1443 - t1310 + t1313 - t1320 + t1446 + t1416 - t1448 + t1331;
  t1473 = t262 * t1472;
  tv3rho2sigma8 = t1423 / 0.54e2 + t1363 + t261 * t1473 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1477 = t1371 * t684 / 0.108e3;
  t1479 = t392 * t672 * t600;
  t1482 = t194 * t672 * t203;
  t1483 = 0.23e2 / 0.4e1 * t1482;
  t1485 = t676 * t677 * t610;
  t1486 = 0.17e2 / 0.4e1 * t1485;
  t1487 = t10 * t678;
  t1488 = t112 * t191;
  t1490 = t850 * t1487 * t1488;
  t1493 = 0.1e1 / t107 / t430;
  t1495 = t105 * t112;
  t1497 = t829 * t831 * t1493 * t1495;
  t1498 = 0.7e1 / 0.4e1 * t1497;
  t1500 = t262 * (0.3e1 / 0.4e1 * t1479 + t1483 - t1486 - t1490 / 0.4e1 + t1498);
  tv3rhosigma20 = t1477 + t261 * t1500 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t1504 = t1371 * t688 / 0.108e3;
  t1506 = 0.23e2 / 0.2e1 * t1482;
  t1507 = 0.17e2 / 0.2e1 * t1485;
  t1509 = 0.7e1 / 0.2e1 * t1497;
  t1511 = t262 * (0.3e1 / 0.2e1 * t1479 + t1506 - t1507 - t1490 / 0.2e1 + t1509);
  tv3rhosigma21 = t1504 + t261 * t1511 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = tv3rhosigma20;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  t1515 = t1371 * t693 / 0.108e3;
  t1517 = 0.23e2 * t1482;
  t1518 = 0.17e2 * t1485;
  t1519 = 0.7e1 * t1497;
  t1521 = t262 * (0.3e1 * t1479 + t1517 - t1518 - t1490 + t1519);
  tv3rhosigma23 = t1515 + t261 * t1521 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = tv3rhosigma21;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = tv3rhosigma22;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1525 = t392 * t672 * t647;
  t1528 = t850 * t1487 * t929;
  t1531 = t262 * (0.3e1 / 0.4e1 * t1525 + t1483 - t1486 - t1528 / 0.4e1 + t1498);
  tv3rhosigma26 = t1477 + t261 * t1531 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  t1537 = t262 * (0.3e1 / 0.2e1 * t1525 + t1506 - t1507 - t1528 / 0.2e1 + t1509);
  tv3rhosigma27 = t1504 + t261 * t1537 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = tv3rhosigma26;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  t1542 = t262 * (0.3e1 * t1525 + t1517 - t1518 - t1528 + t1519);
  tv3rhosigma29 = t1515 + t261 * t1542 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = tv3rhosigma27;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  tv3rhosigma211 = tv3rhosigma28;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1545 = 0.1e1 / t195;
  t1546 = t102 * t1545;
  t1549 = 0.1e1 / t104;
  t1550 = t10 * t1549;
  t1554 = 0.1e1 / t107 / t608;
  t1559 = -t829 * t831 * t1554 * t671 * t112 + t194 * t1546 * t268 + t427 * t1550 * t679;
  t1561 = 0.3e1 / 0.4e1 * t262 * t1559;
  tv3sigma30 = t261 * t1561 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1564 = 0.3e1 / 0.2e1 * t262 * t1559;
  tv3sigma31 = t261 * t1564 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = tv3sigma30;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  t1567 = 0.3e1 * t262 * t1559;
  tv3sigma33 = t261 * t1567 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = tv3sigma31;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = tv3sigma32;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  t1570 = 0.6e1 * t262 * t1559;
  tv3sigma36 = t261 * t1570 / 0.144e3;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = tv3sigma33;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = tv3sigma34;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  tv3sigma39 = tv3sigma35;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1574 = 0.5e1 / 0.729e3 * t65 * t121 * t209;
  t1576 = t65 * t908 * t24;
  t1579 = t65 * t442 * t136;
  t1582 = t65 * t214 * t116;
  t1586 = t1 * t437 * t8 * t303;
  t1587 = 0.85037037037037037035e-4 * t1586;
  t1589 = 0.1e1 / t13 / t197;
  t1592 = t1 * t1589 * t7 * t720;
  t1593 = 0.46666666666666666666e-3 * t1592;
  t1596 = 0.48533333333333333333e1 * t311 * t738 * t313;
  t1609 = t36 * t36;
  t1611 = 0.1e1 / t89 / t1609;
  t1612 = t326 * t326;
  t1618 = t331 * t331;
  t1623 = t34 * t678;
  t1625 = -0.24e2 * t707 + 0.24e2 * t1623;
  t1629 = my_piecewise3(t37, 0, 0.4e2 / 0.81e2 * t1611 * t1612 - 0.16e2 / 0.9e1 * t741 * t326 * t331 + 0.4e1 / 0.3e1 * t325 * t1618 + 0.16e2 / 0.9e1 * t745 * t750 + 0.4e1 / 0.3e1 * t40 * t1625);
  t1631 = t43 * t43;
  t1633 = 0.1e1 / t92 / t1631;
  t1634 = t337 * t337;
  t1640 = t340 * t340;
  t1645 = -t1625;
  t1649 = my_piecewise3(t44, 0, 0.4e2 / 0.81e2 * t1633 * t1634 - 0.16e2 / 0.9e1 * t755 * t337 * t340 + 0.4e1 / 0.3e1 * t336 * t1640 + 0.16e2 / 0.9e1 * t759 * t762 + 0.4e1 / 0.3e1 * t45 * t1645);
  t1655 = t183 * t397 * t884;
  t1658 = 0.1e1 / t40 / t1609;
  t1671 = my_piecewise3(t37, 0, 0.4e2 / 0.81e2 * t1658 * t1612 - 0.2e2 / 0.9e1 * t864 * t326 * t331 + 0.1e2 / 0.3e1 * t401 * t1618 + 0.4e2 / 0.9e1 * t867 * t750 + 0.5e1 / 0.3e1 * t89 * t1625);
  t1673 = 0.1e1 / t45 / t1631;
  t1686 = my_piecewise3(t44, 0, 0.4e2 / 0.81e2 * t1673 * t1634 - 0.2e2 / 0.9e1 * t874 * t337 * t340 + 0.1e2 / 0.3e1 * t408 * t1640 + 0.4e2 / 0.9e1 * t877 * t762 + 0.5e1 / 0.3e1 * t92 * t1645);
  t1691 = t183 * t824 * t415;
  t1693 = t383 * t383;
  t1697 = 0.1e1 / t96 / t1693 * t98 * t112;
  t1698 = t388 * t388;
  t1703 = t812 * t397 * t813;
  t1706 = t387 * t824 * t388;
  t1708 = t415 * t415;
  t1712 = t104 * t888;
  t1714 = t183 * t1712 * t191;
  t1720 = 0.41888e5 / 0.81e2 * t99 * t113 / t23 / t608;
  t1725 = t802 * t114;
  t1731 = 0.24353e5 / 0.108e3 * t829 * t833 / t107 / t1725 * t112;
  t1736 = -0.7e1 / 0.36e2 * t49 * (0.20944e5 / 0.81e2 * sigma[0] / t72 / t370 / t70 * t42 - 0.4928e4 / 0.27e2 * t895 * t149 + 0.176e3 / 0.3e1 * t373 * t335 - 0.32e2 / 0.3e1 * t172 * t754 + t75 * t1629 + t82 * t1649) + 0.32e2 / 0.3e1 * t1655 - t183 * t184 * (t1671 + t1686) - 0.176e3 / 0.3e1 * t1691 + 0.105e3 / 0.8e1 * t1697 * t184 * t1698 + 0.4e2 * t1703 + 0.88e2 * t1706 + 0.9e1 / 0.2e1 * t387 * t184 * t1708 + 0.4928e4 / 0.27e2 * t1714 + t1720 + 0.6e1 * t387 * t184 * t191 * t884 - t1731 - 0.45e2 / 0.2e1 * t812 * t184 * t388 * t415;
  t1738 = t387 * t397 * t820;
  t1741 = t182 * t828 * t831;
  t1742 = t832 * t836;
  t1744 = t1741 * t1742 * t1488;
  t1746 = t425 * t425;
  t1748 = t99 * t1746 * t310;
  t1754 = t7 * t112;
  t1757 = 0.2401e4 / 0.216e3 * t1748 * t428 * t104 / t13 / t802 / t207 * t1754;
  t1762 = 0.299047e6 / 0.648e3 * t427 * t429 / t834 * t112;
  t1768 = 0.207347e6 / 0.216e3 * t194 * t196 / t200 / t430 * t112;
  t1771 = t841 * t196 * t421 * t388;
  t1775 = t392 * t196 * t857 * t191;
  t1779 = t392 * t196 * t421 * t415;
  t1783 = t850 * t429 * t804 * t191;
  t1785 = t811 * t100;
  t1788 = t1785 * t196 * t203 * t813;
  t1790 = t386 * t426;
  t1793 = t1790 * t429 * t432 * t388;
  t1797 = t392 * t196 * t203 * t884;
  t1801 = t850 * t429 * t432 * t415;
  t1803 = t1488 * t415;
  t1805 = t927 * t928 * t1803;
  t1807 = -0.48e2 * t1738 - 0.343e3 / 0.18e2 * t1744 + t1757 + t1762 - t1768 - 0.315e3 / 0.4e1 * t1771 - 0.13489e5 / 0.54e2 * t1775 + 0.105e3 / 0.2e1 * t1779 + 0.1421e4 / 0.18e2 * t1783 - 0.35e2 / 0.2e1 * t1788 + 0.49e2 / 0.4e1 * t1793 - 0.14e2 / 0.3e1 * t1797 - 0.49e2 / 0.6e1 * t1801 + 0.21e2 * t1805;
  t1814 = t22 * t12 * t437;
  t1815 = 0.76049382716049382717e-4 * t1814;
  t1817 = t28 * t29 * t1589;
  t1818 = 0.36296296296296296297e-3 * t1817;
  t1821 = 0.24888888888888888889e0 * t130 * t735 * t131;
  t1823 = t312 * t312;
  t1828 = 0.672e3 * t729 * t116 / t1823 * t8 * t302;
  t1830 = 0.74666666666666666666e-2 * t707 * t731;
  t1833 = 0.168e-4 * t1 * t678 * t18;
  t1836 = 0.2688e3 * t729 * t296 * t731;
  t1840 = t768 * t167;
  t1842 = t346 * t368;
  t1844 = t155 * t796;
  t1850 = t361 * t361;
  t1874 = 0.15287037037037037037e2 * t360 * t738 * t362 + 0.4156065281311497305e5 * t55 * t116 / t1850 * t11 * t12 - t1587 - t1593 - t1596 + 0.21826364804727546031e-5 * t437 * t8 * t353 + 0.29944707811364011322e-4 * t1589 * t7 * t780 - 0.69917146776406035667e-4 * t1814 + 0.28979423868312757202e-3 * t1817 + 0.31358024691358024691e0 * t160 * t735 * t161 - t1821 - t1828 + 0.37629629629629629629e-2 * t707 * t791 - t1830 + t1833 - t1836 - 0.17248151699345670522e-6 * t678 * t58 + 0.66497044500983956879e4 * t55 * t296 * t791;
  t1875 = t53 * t1874;
  t1876 = -t1574 + t1576 / 0.108e3 - t1579 / 0.108e3 + 0.5e1 / 0.486e3 * t1582 + t1587 + t1593 + t1596 + t65 * t69 * (t1736 + t1807) * t13 / 0.144e3 + t1815 - t1818 + t1821 + t1828 + t1830 - t1833 + t1836 + (t1629 + t1649) * t52 * t63 + 0.4e1 * t1840 + 0.6e1 * t1842 + 0.4e1 * t1844 + t1875;
  t1878 = 0.82962962962962962965e-4 * t736;
  t1879 = 0.43555555555555555556e-3 * t739;
  t1881 = 0.37333333333333333333e0 * t724;
  t1885 = 0.4e1 * t797;
  t1886 = 0.74666666666666666666e-4 * t713;
  t1887 = 0.28e-3 * t721;
  t1888 = 0.672e1 * t727;
  t1891 = 0.5e1 / 0.486e3 * t919;
  t1892 = 0.168e-4 * t709;
  t1893 = 0.2688e3 * t733;
  tv4rho40 = t2 * t1876 - t1878 + t1879 + t910 / 0.36e2 - t1881 + 0.4e1 * t769 + 0.12e2 * t770 + 0.12e2 * t772 + t1885 - t1886 - t1887 - t1888 + t913 / 0.36e2 - t916 / 0.54e2 + t1891 + t1892 - t1893;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1898 = t296 * t326;
  t1901 = t146 * t331;
  t1907 = t707 * t146;
  t1910 = t296 * t331;
  t1918 = 0.32e2 * t457 * t678;
  t1920 = my_piecewise3(t37, 0, 0.4e2 / 0.81e2 * t1611 * t223 * t742 - 0.16e2 / 0.9e1 * t741 * t34 * t1898 - 0.8e1 / 0.9e1 * t943 * t1901 + 0.8e1 / 0.3e1 * t325 * t296 * t146 - 0.8e1 * t946 * t1907 + 0.8e1 / 0.3e1 * t946 * t1910 + 0.4e1 / 0.9e1 * t454 * t750 - 0.16e2 * t40 * t707 + t1918);
  t1925 = t296 * t337;
  t1928 = t150 * t340;
  t1934 = t707 * t150;
  t1937 = t296 * t340;
  t1945 = 0.32e2 * t465 * t678;
  t1947 = my_piecewise3(t44, 0, 0.4e2 / 0.81e2 * t1633 * t227 * t756 + 0.16e2 / 0.9e1 * t755 * t34 * t1925 - 0.8e1 / 0.9e1 * t961 * t1928 - 0.8e1 / 0.3e1 * t336 * t296 * t150 + 0.8e1 * t964 * t1934 - 0.8e1 / 0.3e1 * t964 * t1937 + 0.4e1 / 0.9e1 * t462 * t762 + 0.16e2 * t45 * t707 - t1945);
  t1951 = t1055 * t167;
  t1953 = t471 * t368;
  t1954 = 0.3e1 * t1953;
  t1955 = t232 * t796;
  t1958 = (t1920 + t1947) * t52 * t63 + 0.3e1 * t1951 + t1954 + t1955 - t1833 + t1840 + 0.3e1 * t1842 + 0.3e1 * t1844 + t1875 + t1830 + t1815 - t1818 + t1836;
  t1962 = t65 * t1049 * t24;
  t1977 = t112 * t510;
  t1978 = t1977 * t191;
  t1980 = t927 * t928 * t1978;
  t1982 = t929 * t415;
  t1984 = t927 * t928 * t1982;
  t1987 = t386 * t426 * t10;
  t1990 = t1987 * t428 * t431 * t930;
  t1991 = 0.49e2 / 0.8e1 * t1990;
  t1992 = t811 * t926;
  t1993 = t929 * t388;
  t1995 = t1992 * t928 * t1993;
  t1999 = t927 * t195 * t420 * t930;
  t2000 = 0.315e3 / 0.8e1 * t1999;
  t2002 = t183 * t397 * t1018;
  t2024 = 0.4e2 * t497 * t678;
  t2026 = my_piecewise3(t37, 0, 0.4e2 / 0.81e2 * t1658 * t223 * t742 - 0.2e2 / 0.9e1 * t864 * t34 * t1898 - 0.1e2 / 0.9e1 * t990 * t1901 + 0.2e2 / 0.3e1 * t401 * t296 * t146 - 0.2e2 * t993 * t1907 + 0.2e2 / 0.3e1 * t993 * t1910 + 0.1e2 / 0.9e1 * t494 * t750 - 0.2e2 * t89 * t707 + t2024);
  t2047 = 0.4e2 * t505 * t678;
  t2049 = my_piecewise3(t44, 0, 0.4e2 / 0.81e2 * t1673 * t227 * t756 + 0.2e2 / 0.9e1 * t874 * t34 * t1925 - 0.1e2 / 0.9e1 * t1004 * t1928 - 0.2e2 / 0.3e1 * t408 * t296 * t150 + 0.2e2 * t1007 * t1934 - 0.2e2 / 0.3e1 * t1007 * t1937 + 0.1e2 / 0.9e1 * t502 * t762 + 0.2e2 * t92 * t707 - t2047);
  t2054 = t183 * t1712 * t251;
  t2057 = t183 * t824 * t510;
  t2058 = 0.88e2 / 0.3e1 * t2057;
  t2060 = -0.7e1 / 0.36e2 * t49 * (-0.1232e4 / 0.27e2 * t895 * t226 + 0.88e2 / 0.3e1 * t373 * t461 - 0.8e1 * t172 * t957 + t75 * t1920 - 0.8e1 / 0.3e1 * t238 * t766 + t82 * t1947) + 0.21e2 / 0.2e1 * t1980 + 0.21e2 / 0.4e1 * t1984 + t1991 - 0.105e3 / 0.8e1 * t1995 - t2000 + 0.8e1 * t2002 - t183 * t184 * (t2026 + t2049) + 0.1232e4 / 0.27e2 * t2054 - t2058 + 0.8e1 / 0.3e1 * t1655;
  t2070 = t812 * t397 * t980;
  t2073 = t387 * t824 * t483;
  t2074 = 0.44e2 * t2073;
  t2088 = t387 * t397 * t1021;
  t2090 = -0.88e2 / 0.3e1 * t1691 + 0.1e2 * t1703 + 0.44e2 * t1706 + 0.1232e4 / 0.9e1 * t1714 + t1720 + 0.105e3 / 0.8e1 * t1697 * t184 * t251 * t813 + 0.3e2 * t2070 + t2074 + 0.9e1 / 0.2e1 * t387 * t184 * t510 * t415 + 0.3e1 / 0.2e1 * t387 * t184 * t251 * t884 - 0.45e2 / 0.4e1 * t812 * t184 * t510 * t388 - 0.24e2 * t2088;
  t2093 = t387 * t397 * t1025;
  t2101 = t1741 * t1742 * t929;
  t2103 = t811 * t113;
  t2110 = t850 * t429 * t432 * t510;
  t2111 = 0.49e2 / 0.12e2 * t2110;
  t2114 = t392 * t196 * t421 * t510;
  t2115 = 0.105e3 / 0.4e1 * t2114;
  t2116 = -0.12e2 * t2093 + 0.9e1 / 0.2e1 * t387 * t184 * t1018 * t191 - t1731 - 0.12e2 * t1738 - 0.343e3 / 0.72e2 * t2101 - 0.45e2 / 0.4e1 * t2103 * t1395 * t820 - 0.343e3 / 0.24e2 * t1744 + t1757 + t1762 - t1768 - t2111 + t2115;
  t2119 = t850 * t429 * t804 * t251;
  t2123 = t392 * t196 * t203 * t1018;
  t2127 = t392 * t196 * t857 * t251;
  t2138 = 0.1421e4 / 0.72e2 * t2119 - 0.7e1 / 0.2e1 * t2123 - 0.13489e5 / 0.216e3 * t2127 - 0.315e3 / 0.8e1 * t1771 - 0.13489e5 / 0.72e2 * t1775 + 0.105e3 / 0.4e1 * t1779 + 0.1421e4 / 0.24e2 * t1783 - 0.35e2 / 0.8e1 * t1788 + 0.49e2 / 0.8e1 * t1793 - 0.7e1 / 0.6e1 * t1797 - 0.49e2 / 0.12e2 * t1801 + 0.21e2 / 0.4e1 * t1805;
  t2146 = t65 * t255 * t116;
  t2149 = t65 * t516 * t136;
  t2150 = t2149 / 0.216e3;
  t2154 = 0.85037037037037037039e-4 * t1586 + 0.46666666666666666667e-3 * t1592 + t1596 + t1821 + t1962 / 0.144e3 + t65 * t69 * (t2060 + t2090 + t2116 + t2138) * t13 / 0.144e3 + 0.5e1 / 0.1944e4 * t2146 - t2150 - t1574 + t1576 / 0.432e3 - t1579 / 0.216e3 + 0.5e1 / 0.648e3 * t1582 + t1828;
  t2157 = t924 / 0.72e2;
  t2161 = t2 * (t1958 + t2154) - t1878 + t1879 + t2157 + t911 + t1051 / 0.48e2 - t1881 + t769 + 0.6e1 * t770 + 0.9e1 * t772 + t1885;
  t2163 = 0.6e1 * t1057;
  t2167 = 0.3e1 * t1056 + t2163 + t1220 - t1276 - 0.74666666666666666667e-4 * t713 - t1887 - t1888 + t913 / 0.72e2 - t916 / 0.72e2 + t1891 + t1892 - t1893;
  tv4rho41 = t2161 + t2167;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2169 = t65 * t584 * t136;
  t2172 = t65 * t1179 * t24;
  t2182 = t146 * t34 * t296;
  t2187 = t34 * t34;
  t2204 = my_piecewise3(t37, 0, 0.4e2 / 0.81e2 * t1611 * t528 * t326 - 0.64e2 / 0.27e2 * t943 * t2182 - 0.8e1 / 0.27e2 * t1073 * t331 + 0.32e2 / 0.9e1 * t325 * t2187 * t609 + 0.16e2 / 0.9e1 * t454 * t296 - 0.16e2 / 0.3e1 * t454 * t748 - 0.8e1 / 0.27e2 * t741 * t532 * t326 + 0.8e1 / 0.9e1 * t325 * t1083 * t146 + 0.4e1 / 0.9e1 * t1078 * t331 + t1918);
  t2214 = t150 * t34 * t296;
  t2235 = my_piecewise3(t44, 0, 0.4e2 / 0.81e2 * t1633 * t537 * t337 + 0.64e2 / 0.27e2 * t961 * t2214 - 0.8e1 / 0.27e2 * t1088 * t340 + 0.32e2 / 0.9e1 * t336 * t2187 * t609 - 0.16e2 / 0.9e1 * t462 * t296 + 0.16e2 / 0.3e1 * t462 * t748 - 0.8e1 / 0.27e2 * t755 * t540 * t337 + 0.8e1 / 0.9e1 * t336 * t1096 * t150 + 0.4e1 / 0.9e1 * t1093 * t340 - t1945);
  t2240 = t112 * t562;
  t2241 = t2240 * t191;
  t2243 = t1992 * t928 * t2241;
  t2245 = t929 * t510;
  t2247 = t927 * t928 * t2245;
  t2249 = t112 * t580;
  t2250 = t2249 * t191;
  t2252 = t927 * t928 * t2250;
  t2260 = t183 * t397 * t1144;
  t2285 = my_piecewise3(t37, 0, 0.4e2 / 0.81e2 * t1658 * t528 * t326 - 0.8e2 / 0.27e2 * t990 * t2182 - 0.1e2 / 0.27e2 * t1120 * t331 + 0.8e2 / 0.9e1 * t401 * t2187 * t609 + 0.4e2 / 0.9e1 * t494 * t296 - 0.4e2 / 0.3e1 * t494 * t748 - 0.1e2 / 0.27e2 * t864 * t532 * t326 + 0.2e2 / 0.9e1 * t401 * t1083 * t146 + 0.1e2 / 0.9e1 * t1125 * t331 + t2024);
  t2309 = my_piecewise3(t44, 0, 0.4e2 / 0.81e2 * t1673 * t537 * t337 + 0.8e2 / 0.27e2 * t1004 * t2214 - 0.1e2 / 0.27e2 * t1132 * t340 + 0.8e2 / 0.9e1 * t408 * t2187 * t609 - 0.4e2 / 0.9e1 * t502 * t296 + 0.4e2 / 0.3e1 * t502 * t748 - 0.1e2 / 0.27e2 * t874 * t540 * t337 + 0.2e2 / 0.9e1 * t408 * t1096 * t150 + 0.1e2 / 0.9e1 * t1137 * t340 - t2047);
  t2314 = t387 * t824 * t562;
  t2316 = t510 * t510;
  t2321 = t183 * t824 * t580;
  t2323 = -0.7e1 / 0.36e2 * t49 * (0.88e2 / 0.9e1 * t373 * t536 - 0.16e2 / 0.3e1 * t172 * t1087 + t75 * t2204 + 0.88e2 / 0.9e1 * t553 * t344 - 0.16e2 / 0.3e1 * t238 * t975 + t82 * t2235) - 0.35e2 / 0.4e1 * t2243 + 0.7e1 * t2247 + 0.7e1 / 0.2e1 * t2252 + 0.7e1 * t1980 + 0.7e1 / 0.2e1 * t1984 + 0.49e2 / 0.6e1 * t1990 - 0.35e2 / 0.4e1 * t1995 - 0.105e3 / 0.2e1 * t1999 + 0.16e2 / 0.3e1 * t2260 - t183 * t184 * (t2285 + t2309) + 0.44e2 / 0.3e1 * t2314 + 0.3e1 * t387 * t184 * t2316 - 0.88e2 / 0.9e1 * t2321;
  t2335 = t812 * t397 * t1151;
  t2338 = t387 * t397 * t1109;
  t2356 = 0.16e2 / 0.3e1 * t2002 + 0.2464e4 / 0.27e2 * t2054 - 0.352e3 / 0.9e1 * t2057 - 0.88e2 / 0.9e1 * t1691 + 0.44e2 / 0.3e1 * t1706 + 0.2464e4 / 0.27e2 * t1714 + t1720 - 0.15e2 / 0.4e1 * t812 * t184 * t562 * t415 + 0.2e2 * t2335 - 0.16e2 * t2338 + 0.3e1 * t387 * t184 * t251 * t1018 + 0.3e1 * t387 * t184 * t1144 * t191 + 0.3e1 / 0.2e1 * t387 * t184 * t580 * t415 + 0.105e3 / 0.8e1 * t1697 * t184 * t562 * t388;
  t2363 = t387 * t397 * t1113;
  t2376 = t1790 * t429 * t432 * t562;
  t2378 = -0.15e2 / 0.4e1 * t812 * t184 * t580 * t388 - 0.8e1 * t2363 + 0.2e2 * t2070 + 0.176e3 / 0.3e1 * t2073 - 0.16e2 * t2088 - 0.8e1 * t2093 - t1731 - 0.15e2 * t2103 * t1395 * t1021 - 0.343e3 / 0.36e2 * t2101 - 0.343e3 / 0.36e2 * t1744 + t1757 + t1762 - t1768 + 0.49e2 / 0.24e2 * t2376;
  t2381 = t850 * t429 * t432 * t580;
  t2385 = t841 * t196 * t421 * t562;
  t2389 = t392 * t196 * t421 * t580;
  t2393 = t392 * t196 * t203 * t1144;
  t2406 = -0.49e2 / 0.36e2 * t2381 - 0.105e3 / 0.8e1 * t2385 + 0.35e2 / 0.4e1 * t2389 - 0.7e1 / 0.3e1 * t2393 - 0.49e2 / 0.9e1 * t2110 + 0.35e2 * t2114 + 0.1421e4 / 0.36e2 * t2119 - 0.7e1 / 0.3e1 * t2123 - 0.13489e5 / 0.108e3 * t2127 - 0.105e3 / 0.8e1 * t1771 - 0.13489e5 / 0.108e3 * t1775 + 0.35e2 / 0.4e1 * t1779 + 0.1421e4 / 0.36e2 * t1783 + 0.49e2 / 0.24e2 * t1793 - 0.49e2 / 0.36e2 * t1801;
  t2413 = t546 * t368;
  t2417 = t1102 * t167;
  t2423 = -t2169 / 0.648e3 + t2172 / 0.216e3 + t65 * t69 * (t2323 + t2356 + t2378 + t2406) * t13 / 0.144e3 + t2413 + (t2204 + t2235) * t52 * t63 + 0.2e1 * t2417 + 0.2e1 * t1951 + 0.4e1 * t1953 + 0.2e1 * t1955 - t1833 + t1842 + 0.2e1 * t1844 + t1875 + t1830;
  t2429 = t1815 - t1818 + t1836 + t1587 + t1593 + t1596 + t1821 + t1962 / 0.216e3 + 0.5e1 / 0.972e3 * t2146 - t2149 / 0.162e3 - t1574 - t1579 / 0.648e3 + 0.5e1 / 0.972e3 * t1582 + t1828;
  t2442 = t2 * (t2423 + t2429) + t1181 / 0.72e2 + t1184 / 0.216e3 - t1061 / 0.108e3 + t1051 / 0.72e2 + t913 / 0.216e3 - t916 / 0.108e3 + t1891 + t924 / 0.54e2 + 0.2e1 * t1103 + 0.2e1 * t1104 + 0.2e1 * t1056;
  t2447 = 0.8e1 * t1057 + 0.6e1 * t1059 + t1892 + 0.2e1 * t770 + 0.6e1 * t772 + t1885 - t1893 - t1878 + t1879 - t1886 - t1887 - t1881 - t1888;
  tv4rho42 = t2442 + t2447;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2453 = t532 * t146;
  t2456 = t296 * t532;
  t2466 = 0.12e2 * t707 + 0.24e2 * t1623;
  t2470 = my_piecewise3(t37, 0, 0.4e2 / 0.81e2 * t1611 * t1195 * t146 - 0.16e2 / 0.9e1 * t1073 * t329 - 0.8e1 / 0.9e1 * t943 * t2453 + 0.8e1 / 0.3e1 * t946 * t2456 + 0.4e1 / 0.3e1 * t454 * t1083 + 0.4e1 / 0.9e1 * t325 * t1201 * t146 + 0.4e1 / 0.3e1 * t40 * t2466);
  t2476 = t540 * t150;
  t2479 = t296 * t540;
  t2487 = -t2466;
  t2491 = my_piecewise3(t44, 0, 0.4e2 / 0.81e2 * t1633 * t1206 * t150 + 0.16e2 / 0.9e1 * t1088 * t329 - 0.8e1 / 0.9e1 * t961 * t2476 - 0.8e1 / 0.3e1 * t964 * t2479 + 0.4e1 / 0.3e1 * t462 * t1096 + 0.4e1 / 0.9e1 * t336 * t1211 * t150 + 0.4e1 / 0.3e1 * t45 * t2487);
  t2495 = t1217 * t167;
  t2497 = t65 * t1271 * t24;
  t2516 = my_piecewise3(t37, 0, 0.4e2 / 0.81e2 * t1658 * t1195 * t146 - 0.2e2 / 0.9e1 * t1120 * t329 - 0.1e2 / 0.9e1 * t990 * t2453 + 0.2e2 / 0.3e1 * t993 * t2456 + 0.1e2 / 0.3e1 * t494 * t1083 + 0.1e2 / 0.9e1 * t401 * t1201 * t146 + 0.5e1 / 0.3e1 * t89 * t2466);
  t2534 = my_piecewise3(t44, 0, 0.4e2 / 0.81e2 * t1673 * t1206 * t150 + 0.2e2 / 0.9e1 * t1132 * t329 - 0.1e2 / 0.9e1 * t1004 * t2476 - 0.2e2 / 0.3e1 * t1007 * t2479 + 0.1e2 / 0.3e1 * t502 * t1096 + 0.1e2 / 0.9e1 * t408 * t1211 * t150 + 0.5e1 / 0.3e1 * t92 * t2487);
  t2539 = t812 * t397 * t1221;
  t2542 = t183 * t397 * t1247;
  t2546 = t1785 * t196 * t203 * t1221;
  t2550 = t392 * t196 * t203 * t1247;
  t2569 = t387 * t397 * t1225;
  t2583 = -t183 * t184 * (t2516 + t2534) + 0.1e2 * t2539 + 0.8e1 / 0.3e1 * t2542 - 0.35e2 / 0.8e1 * t2546 - 0.7e1 / 0.6e1 * t2550 - 0.7e1 / 0.36e2 * t49 * (-0.8e1 / 0.3e1 * t172 * t1205 + t75 * t2470 - 0.1232e4 / 0.27e2 * t1259 * t153 + 0.88e2 / 0.3e1 * t553 * t469 - 0.8e1 * t238 * t1100 + t82 * t2491) - 0.45e2 / 0.4e1 * t2103 * t1395 * t1113 - 0.12e2 * t2569 + 0.105e3 / 0.8e1 * t1697 * t184 * t1221 * t191 - 0.45e2 / 0.4e1 * t812 * t184 * t562 * t510 + 0.9e1 / 0.2e1 * t387 * t184 * t510 * t580;
  t2592 = t929 * t580;
  t2594 = t927 * t928 * t2592;
  t2603 = 0.9e1 / 0.2e1 * t387 * t184 * t251 * t1144 + 0.3e1 / 0.2e1 * t387 * t184 * t1247 * t191 + 0.21e2 / 0.4e1 * t2594 - 0.105e3 / 0.8e1 * t2243 + 0.21e2 / 0.2e1 * t2247 + 0.21e2 / 0.4e1 * t2252 + t1991 - t2000 + 0.8e1 * t2260 + 0.44e2 * t2314 - 0.88e2 / 0.3e1 * t2321 + 0.1232e4 / 0.9e1 * t2054;
  t2611 = -t2058 + 0.1232e4 / 0.27e2 * t1714 + t1720 + 0.3e2 * t2335 - 0.24e2 * t2338 - 0.12e2 * t2363 + t2074 - t1731 - 0.343e3 / 0.24e2 * t2101 - 0.343e3 / 0.72e2 * t1744 + t1757 + t1762;
  t2621 = -t1768 + 0.49e2 / 0.8e1 * t2376 - 0.49e2 / 0.12e2 * t2381 - 0.315e3 / 0.8e1 * t2385 + 0.105e3 / 0.4e1 * t2389 - 0.7e1 / 0.2e1 * t2393 - t2111 + t2115 + 0.1421e4 / 0.24e2 * t2119 - 0.13489e5 / 0.72e2 * t2127 - 0.13489e5 / 0.216e3 * t1775 + 0.1421e4 / 0.72e2 * t1783;
  t2633 = (t2470 + t2491) * t52 * t63 + t2495 + t2497 / 0.432e3 + t65 * t69 * (t2583 + t2603 + t2611 + t2621) * t13 / 0.144e3 - t2169 / 0.216e3 + t2172 / 0.144e3 + 0.3e1 * t2413 + 0.3e1 * t2417 + t1954 + 0.3e1 * t1955 - t1833 + t1844 + t1875;
  t2636 = t1830 + t1815 - t1818 + t1836 + t1587 + t1593 + t1596 + t1821 + 0.5e1 / 0.648e3 * t2146 - t2150 - t1574 + 0.5e1 / 0.1944e4 * t1582 + t1828;
  t2643 = t2 * (t2633 + t2636) + t1274 + t1181 / 0.48e2 + t1184 / 0.72e2 + 0.3e1 * t1103 + 0.6e1 * t1104 - t1878 + t1879 + t1218 + t2157 - t1881;
  t2646 = t773 + t1885 + t2163 + 0.9e1 * t1059 - t1061 / 0.72e2 - t1886 - t1887 - t1888 - t917 + t1891 + t1892 - t1893;
  tv4rho43 = t2643 + t2646;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2647 = t528 * t528;
  t2652 = t532 * t532;
  t2658 = 0.24e2 * t707 + 0.24e2 * t1623;
  t2662 = my_piecewise3(t37, 0, 0.4e2 / 0.81e2 * t1611 * t2647 - 0.16e2 / 0.9e1 * t1073 * t532 + 0.4e1 / 0.3e1 * t325 * t2652 + 0.16e2 / 0.9e1 * t454 * t1201 + 0.4e1 / 0.3e1 * t40 * t2658);
  t2663 = t537 * t537;
  t2668 = t540 * t540;
  t2673 = -t2658;
  t2677 = my_piecewise3(t44, 0, 0.4e2 / 0.81e2 * t1633 * t2663 - 0.16e2 / 0.9e1 * t1088 * t540 + 0.4e1 / 0.3e1 * t336 * t2668 + 0.16e2 / 0.9e1 * t462 * t1211 + 0.4e1 / 0.3e1 * t45 * t2673);
  t2699 = t580 * t580;
  t2714 = my_piecewise3(t37, 0, 0.4e2 / 0.81e2 * t1658 * t2647 - 0.2e2 / 0.9e1 * t1120 * t532 + 0.1e2 / 0.3e1 * t401 * t2652 + 0.4e2 / 0.9e1 * t494 * t1201 + 0.5e1 / 0.3e1 * t89 * t2658);
  t2726 = my_piecewise3(t44, 0, 0.4e2 / 0.81e2 * t1673 * t2663 - 0.2e2 / 0.9e1 * t1132 * t540 + 0.1e2 / 0.3e1 * t408 * t2668 + 0.4e2 / 0.9e1 * t502 * t1211 + 0.5e1 / 0.3e1 * t92 * t2673);
  t2730 = t562 * t562;
  t2749 = -0.7e1 / 0.36e2 * t49 * (t75 * t2662 + 0.20944e5 / 0.81e2 * sigma[2] / t79 / t550 / t77 * t47 - 0.4928e4 / 0.27e2 * t1259 * t230 + 0.176e3 / 0.3e1 * t553 * t544 - 0.32e2 / 0.3e1 * t238 * t1215 + t82 * t2677) + 0.9e1 / 0.2e1 * t387 * t184 * t2699 - t183 * t184 * (t2714 + t2726) + 0.105e3 / 0.8e1 * t1697 * t184 * t2730 + 0.4e2 * t2539 + 0.32e2 / 0.3e1 * t2542 - 0.35e2 / 0.2e1 * t2546 - 0.14e2 / 0.3e1 * t2550 - 0.45e2 / 0.2e1 * t812 * t184 * t562 * t580 + 0.6e1 * t387 * t184 * t251 * t1247 - 0.48e2 * t2569 + 0.21e2 * t2594 + 0.88e2 * t2314;
  t2759 = -0.176e3 / 0.3e1 * t2321 + 0.4928e4 / 0.27e2 * t2054 + t1720 - t1731 - 0.343e3 / 0.18e2 * t2101 + t1757 + t1762 - t1768 + 0.49e2 / 0.4e1 * t2376 - 0.49e2 / 0.6e1 * t2381 - 0.315e3 / 0.4e1 * t2385 + 0.105e3 / 0.2e1 * t2389 + 0.1421e4 / 0.18e2 * t2119 - 0.13489e5 / 0.54e2 * t2127;
  t2770 = (t2662 + t2677) * t52 * t63 + t2497 / 0.108e3 + t65 * t69 * (t2749 + t2759) * t13 / 0.144e3 - t2169 / 0.108e3 + 0.4e1 * t2495 + 0.6e1 * t2413 + 0.5e1 / 0.486e3 * t2146 - t1574 + t1587 + t1593 + t1596 + t1815 - t1818 + t1821 + t1828 + t1830 - t1833 + t1836 + t1875 + 0.4e1 * t1955;
  tv4rho44 = t2 * t2770 + t1273 / 0.36e2 + t1184 / 0.36e2 + 0.12e2 * t1104 - t1878 + t1879 + 0.4e1 * t1218 - t1881 + t1885 + 0.12e2 * t1059 - t1061 / 0.54e2 - t1886 - t1887 - t1888 + t1891 + t1892 - t1893;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t2780 = t65 * t69 * t1332 * t13;
  t2783 = t65 * t1279 * t24;
  t2787 = t65 * t591 * t136 / 0.486e3;
  t2799 = t387 * t116 * t191 * t415;
  t2800 = 0.9e1 / 0.2e1 * t2799;
  t2803 = t1790 * t607 * t610 * t388;
  t2804 = 0.21e2 / 0.8e1 * t2803;
  t2806 = t392 * t106 * t846;
  t2807 = 0.37e2 / 0.4e1 * t2806;
  t2809 = t850 * t607 * t851;
  t2810 = 0.511e3 / 0.24e2 * t2809;
  t2813 = t850 * t607 * t610 * t415;
  t2814 = 0.7e1 / 0.4e1 * t2813;
  t2817 = t392 * t106 * t268 * t884;
  t2818 = t2817 / 0.2e1;
  t2821 = t1785 * t106 * t268 * t813;
  t2822 = 0.15e2 / 0.8e1 * t2821;
  t2824 = t841 * t106 * t842;
  t2825 = 0.111e3 / 0.8e1 * t2824;
  t2826 = -0.154e3 / 0.27e2 * t1286 * t149 + 0.14e2 / 0.9e1 * t595 * t335 - 0.7e1 / 0.36e2 * t263 * t754 + 0.2156e4 / 0.243e3 * t49 * t894 * t42 + t2800 - t2804 - t2807 - t2810 + t2814 + t2818 + t2822 + t2825;
  t2828 = t392 * t106 * t798;
  t2829 = 0.1297e4 / 0.24e2 * t2828;
  t2831 = t427 * t607 * t804;
  t2832 = 0.30541e5 / 0.216e3 * t2831;
  t2837 = t1748 * t428 / t13 / t1725 * t1754;
  t2838 = 0.343e3 / 0.72e2 * t2837;
  t2839 = t195 * t1316;
  t2841 = t1741 * t2839 * t1488;
  t2842 = 0.49e2 / 0.8e1 * t2841;
  t2844 = t194 * t106 * t857;
  t2845 = 0.50323e5 / 0.216e3 * t2844;
  t2847 = t829 * t1314 * t837;
  t2848 = 0.2989e4 / 0.36e2 * t2847;
  t2850 = t386 * t616 * t388;
  t2851 = 0.12e2 * t2850;
  t2853 = t182 * t1329 * t191;
  t2854 = 0.88e2 / 0.3e1 * t2853;
  t2856 = t811 * t271 * t813;
  t2857 = 0.15e2 / 0.4e1 * t2856;
  t2859 = t182 * t616 * t415;
  t2860 = 0.8e1 * t2859;
  t2862 = t182 * t271 * t884;
  t2864 = t927 * t1378 * t1803;
  t2865 = 0.9e1 / 0.4e1 * t2864;
  t2867 = t99 * t112 * t888;
  t2868 = 0.2464e4 / 0.27e2 * t2867;
  t2869 = t2829 - t2832 - t2838 + t2842 + t2845 + t2848 - t2851 - t2854 - t2857 + t2860 - t2862 - t2865 - t2868;
  tv4rho3sigma0 = t2780 / 0.36e2 + t2783 / 0.108e3 - t2787 + t261 * t262 * (t2826 + t2869) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t2876 = t65 * t69 * t1353 * t13;
  t2879 = t65 * t1336 * t24;
  t2883 = t65 * t623 * t136 / 0.486e3;
  t2884 = 0.2989e4 / 0.18e2 * t2847;
  t2889 = 0.30541e5 / 0.108e3 * t2831;
  t2890 = 0.343e3 / 0.36e2 * t2837;
  t2892 = 0.50323e5 / 0.108e3 * t2844;
  t2900 = 0.4928e4 / 0.27e2 * t2867;
  t2905 = -0.37e2 / 0.2e1 * t2806 - 0.511e3 / 0.12e2 * t2809 + 0.7e1 / 0.2e1 * t2813 + t2817 + 0.16e2 * t2859 - 0.2e1 * t2862 - t2900 + 0.15e2 / 0.4e1 * t2821 + 0.111e3 / 0.4e1 * t2824 - 0.9e1 / 0.2e1 * t2864 + 0.1297e4 / 0.12e2 * t2828;
  tv4rho3sigma1 = t2876 / 0.36e2 + t2879 / 0.108e3 - t2883 + t261 * t262 * (t2884 - 0.24e2 * t2850 + 0.9e1 * t2799 - 0.176e3 / 0.3e1 * t2853 - 0.15e2 / 0.2e1 * t2856 - t2889 - t2890 + 0.49e2 / 0.4e1 * t2841 + t2892 - 0.21e2 / 0.4e1 * t2803 + t2905) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t2912 = t65 * t69 * t1366 * t13;
  t2915 = t65 * t1357 * t24;
  t2919 = t65 * t635 * t136 / 0.486e3;
  t2922 = t2848 - t2851 + t2800 - t2854 - t2857 - 0.7e1 / 0.36e2 * t282 * t766 - t2832 - t2838 + t2842 + t2845 - t2804;
  t2923 = -t2807 - t2810 + t2814 + t2818 + t2860 - t2862 - t2868 + t2822 + t2825 - t2865 + t2829;
  tv4rho3sigma2 = t2912 / 0.36e2 + t2915 / 0.108e3 - t2919 + t261 * t262 * (t2922 + t2923) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t2930 = t24 * M_PI;
  t2931 = t2930 * t654;
  t2934 = t1371 * t1406 / 0.54e2;
  t2942 = t812 * t1395 * t388;
  t2943 = 0.15e2 / 0.4e1 * t2942;
  t2946 = t387 * t209 * t251 * t191;
  t2947 = 0.8e1 * t2946;
  t2950 = t387 * t116 * t510 * t191;
  t2951 = 0.3e1 * t2950;
  t2953 = t387 * t1395 * t415;
  t2954 = 0.3e1 / 0.2e1 * t2953;
  t2957 = t850 * t607 * t610 * t510;
  t2958 = 0.7e1 / 0.6e1 * t2957;
  t2961 = t392 * t106 * t268 * t1018;
  t2962 = t2961 / 0.2e1;
  t2964 = t392 * t106 * t1038;
  t2965 = 0.37e2 / 0.6e1 * t2964;
  t2967 = t850 * t607 * t1042;
  t2968 = 0.511e3 / 0.72e2 * t2967;
  t2970 = t392 * t106 * t934;
  t2971 = 0.1297e4 / 0.72e2 * t2970;
  t2972 = 0.7e1 / 0.8e1 * t2803;
  t2973 = 0.37e2 / 0.12e2 * t2806;
  t2974 = 0.511e3 / 0.36e2 * t2809;
  t2975 = 0.7e1 / 0.12e2 * t2813;
  t2976 = 0.37e2 / 0.8e1 * t2824;
  t2977 = 0.1297e4 / 0.36e2 * t2828;
  t2978 = -0.154e3 / 0.81e2 * t1286 * t226 + 0.28e2 / 0.27e2 * t595 * t461 - 0.7e1 / 0.36e2 * t263 * t957 - t2943 - t2947 + t2951 + t2954 + t2958 + t2962 - t2965 - t2968 + t2971 - t2972 - t2973 - t2974 + t2975 + t2976 + t2977;
  t2980 = t1741 * t2839 * t929;
  t2982 = 0.49e2 / 0.12e2 * t2841;
  t2984 = t182 * t616 * t510;
  t2985 = 0.16e2 / 0.3e1 * t2984;
  t2987 = t182 * t271 * t1018;
  t2989 = t182 * t1329 * t251;
  t2992 = 0.176e3 / 0.9e1 * t2853;
  t2995 = t1992 * t1378 * t1993;
  t2998 = t927 * t1378 * t1978;
  t3001 = t927 * t1378 * t1982;
  t3005 = t1987 * t104 * t609 * t930;
  t3006 = 0.7e1 / 0.4e1 * t3005;
  t3009 = t927 * t105 * t202 * t930;
  t3010 = 0.37e2 / 0.4e1 * t3009;
  t3011 = 0.49e2 / 0.24e2 * t2980 - t2832 - t2838 + t2982 + t2845 + t2848 + t2985 - t2987 - 0.88e2 / 0.9e1 * t2989 - 0.4e1 * t2850 - t2992 + 0.8e1 / 0.3e1 * t2859 + 0.15e2 / 0.8e1 * t2995 - 0.3e1 / 0.2e1 * t2998 - 0.3e1 / 0.4e1 * t3001 - t3006 + t3010 - t2868;
  tv4rho3sigma3 = t2780 / 0.108e3 + t2783 / 0.162e3 - t2787 + t2931 / 0.324e3 + t2934 + t261 * t262 * (t2978 + t3011) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  t3018 = t2930 * t659;
  t3021 = t1371 * t1419 / 0.54e2;
  t3023 = 0.16e2 * t2946;
  t3026 = 0.7e1 / 0.3e1 * t2957;
  t3027 = 0.37e2 / 0.3e1 * t2964;
  t3028 = 0.511e3 / 0.36e2 * t2967;
  t3029 = 0.1297e4 / 0.36e2 * t2970;
  t3036 = 0.49e2 / 0.12e2 * t2980;
  t3037 = -0.15e2 / 0.2e1 * t2942 - t3023 + 0.6e1 * t2950 + 0.3e1 * t2953 + t3026 + t2961 - t3027 - t3028 + t3029 - 0.7e1 / 0.4e1 * t2803 - 0.37e2 / 0.6e1 * t2806 - 0.511e3 / 0.18e2 * t2809 + 0.7e1 / 0.6e1 * t2813 + 0.37e2 / 0.4e1 * t2824 + 0.1297e4 / 0.18e2 * t2828 + t3036;
  t3039 = 0.32e2 / 0.3e1 * t2984;
  t3041 = 0.176e3 / 0.9e1 * t2989;
  t3048 = 0.7e1 / 0.2e1 * t3005;
  t3049 = 0.37e2 / 0.2e1 * t3009;
  t3050 = -t2889 - t2890 + 0.49e2 / 0.6e1 * t2841 + t2892 + t2884 + t3039 - 0.2e1 * t2987 - t3041 - 0.8e1 * t2850 - 0.352e3 / 0.9e1 * t2853 + 0.16e2 / 0.3e1 * t2859 + 0.15e2 / 0.4e1 * t2995 - 0.3e1 * t2998 - 0.3e1 / 0.2e1 * t3001 - t3048 + t3049 - t2900;
  tv4rho3sigma4 = t2876 / 0.108e3 + t2879 / 0.162e3 - t2883 + t3018 / 0.324e3 + t3021 + t261 * t262 * (t3037 + t3050) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t3057 = t2930 * t668;
  t3060 = t1371 * t1430 / 0.54e2;
  t3065 = 0.14e2 / 0.27e2 * t662 * t344 - 0.7e1 / 0.36e2 * t282 * t975 - t2943 - t2947 + t2951 + t2954 + t2958 + t2962 - t2965 - t2968 + t2971 - t2972 - t2973 - t2974 + t2975 + t2976 + t2977;
  tv4rho3sigma5 = t2912 / 0.108e3 + t2915 / 0.162e3 - t2919 + t3057 / 0.324e3 + t3060 + t261 * t262 * (t3065 + t3011) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t3072 = t1371 * t1450;
  t3080 = t812 * t116 * t562 * t191;
  t3081 = 0.15e2 / 0.4e1 * t3080;
  t3083 = t387 * t1395 * t510;
  t3084 = 0.3e1 * t3083;
  t3087 = t387 * t116 * t580 * t191;
  t3088 = 0.3e1 / 0.2e1 * t3087;
  t3091 = t1790 * t607 * t610 * t562;
  t3092 = 0.7e1 / 0.8e1 * t3091;
  t3095 = t392 * t106 * t268 * t1144;
  t3096 = t3095 / 0.2e1;
  t3099 = t850 * t607 * t610 * t580;
  t3100 = 0.7e1 / 0.12e2 * t3099;
  t3102 = t841 * t106 * t1169;
  t3103 = 0.37e2 / 0.8e1 * t3102;
  t3105 = t392 * t106 * t1173;
  t3106 = 0.37e2 / 0.12e2 * t3105;
  t3107 = 0.511e3 / 0.72e2 * t2809;
  t3108 = 0.1297e4 / 0.72e2 * t2828;
  t3109 = 0.14e2 / 0.27e2 * t595 * t536 - 0.7e1 / 0.36e2 * t263 * t1087 - t3081 + t3084 + t3088 - t2947 - t3092 + t3096 + t3100 + t3103 - t3106 + t2958 - t2965 - t3028 + t3029 - t3107 + t3108;
  t3113 = t927 * t1378 * t2245;
  t3116 = t927 * t1378 * t2250;
  t3119 = t1992 * t1378 * t2241;
  t3122 = t182 * t271 * t1144;
  t3124 = t386 * t616 * t562;
  t3127 = t182 * t616 * t580;
  t3129 = t3036 - t2832 - t2838 + 0.49e2 / 0.24e2 * t2841 + t2845 + t2848 + t2985 - t3041 - 0.88e2 / 0.9e1 * t2853 - 0.3e1 / 0.2e1 * t3113 - 0.3e1 / 0.4e1 * t3116 + 0.15e2 / 0.8e1 * t3119 - t3006 + t3010 - t3122 - 0.4e1 * t3124 + 0.8e1 / 0.3e1 * t3127 - t2868;
  tv4rho3sigma6 = t2931 / 0.162e3 + t2934 + t2783 / 0.324e3 - t2787 + t3072 / 0.108e3 + t261 * t262 * (t3109 + t3129) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  t3136 = t1371 * t1461;
  t3148 = -0.15e2 / 0.2e1 * t3080 + 0.6e1 * t3083 + 0.3e1 * t3087 - t3023 - 0.7e1 / 0.4e1 * t3091 + t3095 + 0.7e1 / 0.6e1 * t3099 + 0.37e2 / 0.4e1 * t3102 - 0.37e2 / 0.6e1 * t3105 + t3026 - t3027 - 0.511e3 / 0.18e2 * t2967 + 0.1297e4 / 0.18e2 * t2970 - t2974 + t2977 + 0.49e2 / 0.6e1 * t2980;
  t3156 = -t2889 - t2890 + t2982 + t2892 + t2884 + t3039 - 0.352e3 / 0.9e1 * t2989 - t2992 - 0.3e1 * t3113 - 0.3e1 / 0.2e1 * t3116 + 0.15e2 / 0.4e1 * t3119 - t3048 + t3049 - 0.2e1 * t3122 - 0.8e1 * t3124 + 0.16e2 / 0.3e1 * t3127 - t2900;
  tv4rho3sigma7 = t3018 / 0.162e3 + t3021 + t2879 / 0.324e3 - t2883 + t3136 / 0.108e3 + t261 * t262 * (t3148 + t3156) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t3163 = t1371 * t1473;
  t3171 = -0.154e3 / 0.81e2 * t1465 * t153 + 0.28e2 / 0.27e2 * t662 * t469 - 0.7e1 / 0.36e2 * t282 * t1100 - t3081 + t3084 + t3088 - t2947 - t3092 + t3096 + t3100 + t3103 - t3106 + t2958 - t2965 - t3028 + t3029 - t3107 + t3108;
  tv4rho3sigma8 = t3057 / 0.162e3 + t3060 + t2915 / 0.324e3 - t2919 + t3163 / 0.108e3 + t261 * t262 * (t3171 + t3129) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t3179 = t182 * t271 * t1247;
  t3181 = t811 * t271 * t1221;
  t3182 = 0.15e2 / 0.4e1 * t3181;
  t3184 = t387 * t1395 * t580;
  t3185 = 0.9e1 / 0.2e1 * t3184;
  t3186 = 0.12e2 * t3124;
  t3187 = 0.8e1 * t3127;
  t3188 = 0.88e2 / 0.3e1 * t2989;
  t3191 = 0.49e2 / 0.8e1 * t2980;
  t3192 = -t3179 + t2848 - t3182 + t3185 - t3186 + t3187 - t3188 - 0.7e1 / 0.36e2 * t263 * t1205 + t3191 - t2832 - t2838;
  t3195 = t392 * t106 * t268 * t1247;
  t3196 = t3195 / 0.2e1;
  t3197 = 0.21e2 / 0.8e1 * t3091;
  t3198 = 0.7e1 / 0.4e1 * t3099;
  t3199 = 0.511e3 / 0.24e2 * t2967;
  t3200 = 0.111e3 / 0.8e1 * t3102;
  t3201 = 0.37e2 / 0.4e1 * t3105;
  t3204 = t1785 * t106 * t268 * t1221;
  t3205 = 0.15e2 / 0.8e1 * t3204;
  t3207 = t927 * t1378 * t2592;
  t3208 = 0.9e1 / 0.4e1 * t3207;
  t3209 = 0.1297e4 / 0.24e2 * t2970;
  t3210 = t3196 - t3197 + t3198 + t2845 - t3199 - t2868 + t3200 - t3201 + t3205 - t3208 + t3209;
  tv4rho3sigma9 = t2931 / 0.108e3 + t3072 / 0.36e2 - t2787 + t261 * t262 * (t3192 + t3210) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  t3233 = t3195 - 0.21e2 / 0.4e1 * t3091 + 0.7e1 / 0.2e1 * t3099 + t2892 - 0.511e3 / 0.12e2 * t2967 - t2900 + 0.111e3 / 0.4e1 * t3102 - 0.37e2 / 0.2e1 * t3105 + 0.15e2 / 0.4e1 * t3204 - 0.9e1 / 0.2e1 * t3207 + 0.1297e4 / 0.12e2 * t2970;
  tv4rho3sigma10 = t3018 / 0.108e3 + t3136 / 0.36e2 - t2883 + t261 * t262 * (-0.2e1 * t3179 + t2884 - 0.15e2 / 0.2e1 * t3181 + 0.9e1 * t3184 - 0.24e2 * t3124 + 0.16e2 * t3127 - 0.176e3 / 0.3e1 * t2989 + 0.49e2 / 0.4e1 * t2980 - t2889 - t2890 + t3233) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t3249 = 0.2156e4 / 0.243e3 * t49 * t1258 * t47 - 0.154e3 / 0.27e2 * t1465 * t230 + 0.14e2 / 0.9e1 * t662 * t544 - 0.7e1 / 0.36e2 * t282 * t1215 + t3185 + t3196 + t3205 - t3197 + t3198 + t3200 - t3201 - t3199;
  t3250 = t3209 + t3191 - t2832 - t2838 + t2845 + t2848 - t3188 - t3208 - t3186 + t3187 - t3179 - t3182 - t2868;
  tv4rho3sigma11 = t3057 / 0.108e3 + t3163 / 0.36e2 - t2919 + t261 * t262 * (t3249 + t3250) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t3256 = t2930 * t684 / 0.324e3;
  t3257 = t1371 * t1500;
  t3260 = t841 * t672 * t1293;
  t3263 = t392 * t672 * t393;
  t3264 = 0.23e2 / 0.4e1 * t3263;
  t3265 = t10 * t609;
  t3267 = t850 * t3265 * t1488;
  t3268 = 0.17e2 / 0.4e1 * t3267;
  t3270 = t392 * t672 * t1304;
  t3273 = t194 * t672 * t421;
  t3274 = 0.667e3 / 0.24e2 * t3273;
  t3276 = t676 * t677 * t432;
  t3277 = 0.773e3 / 0.24e2 * t3276;
  t3280 = t829 * t831 * t1316 * t1495;
  t3281 = 0.329e3 / 0.12e2 * t3280;
  t3284 = t1790 * t1487 * t112 * t388;
  t3286 = t1493 * t105;
  t3288 = t1741 * t3286 * t1488;
  t3289 = 0.7e1 / 0.4e1 * t3288;
  t3292 = t850 * t1487 * t112 * t415;
  t3298 = t1748 / t13 / t834 * t104 * t1754;
  t3299 = 0.49e2 / 0.24e2 * t3298;
  t3300 = -0.9e1 / 0.8e1 * t3260 - t3264 + t3268 + 0.3e1 / 0.4e1 * t3270 - t3274 + t3277 - t3281 + 0.3e1 / 0.8e1 * t3284 - t3289 - t3292 / 0.4e1 + t3299;
  tv4rho2sigma20 = t3256 + t3257 / 0.54e2 + t261 * t262 * t3300 / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t3305 = t2930 * t688 / 0.324e3;
  t3306 = t1371 * t1511;
  t3309 = 0.23e2 / 0.2e1 * t3263;
  t3310 = 0.17e2 / 0.2e1 * t3267;
  t3312 = 0.667e3 / 0.12e2 * t3273;
  t3313 = 0.773e3 / 0.12e2 * t3276;
  t3314 = 0.329e3 / 0.6e1 * t3280;
  t3316 = 0.7e1 / 0.2e1 * t3288;
  t3318 = 0.49e2 / 0.12e2 * t3298;
  t3319 = -0.9e1 / 0.4e1 * t3260 - t3309 + t3310 + 0.3e1 / 0.2e1 * t3270 - t3312 + t3313 - t3314 + 0.3e1 / 0.4e1 * t3284 - t3316 - t3292 / 0.2e1 + t3318;
  tv4rho2sigma21 = t3305 + t3306 / 0.54e2 + t261 * t262 * t3319 / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = tv4rho2sigma20;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  t3324 = t2930 * t693 / 0.324e3;
  t3325 = t1371 * t1521;
  t3331 = 0.667e3 / 0.6e1 * t3273;
  t3332 = 0.773e3 / 0.6e1 * t3276;
  t3333 = 0.329e3 / 0.3e1 * t3280;
  t3336 = 0.49e2 / 0.6e1 * t3298;
  t3337 = -0.9e1 / 0.2e1 * t3260 - 0.23e2 * t3263 + 0.17e2 * t3267 + 0.3e1 * t3270 - t3331 + t3332 - t3333 + 0.3e1 / 0.2e1 * t3284 - 0.7e1 * t3288 - t3292 + t3336;
  tv4rho2sigma23 = t3324 + t3325 / 0.54e2 + t261 * t262 * t3337 / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = tv4rho2sigma21;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = tv4rho2sigma22;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t3342 = t1371 * t1531;
  t3346 = t927 * t671 * t267 * t930;
  t3349 = t392 * t672 * t487;
  t3352 = t850 * t3265 * t929;
  t3355 = t392 * t672 * t1389;
  t3360 = t1790 * t1487 * t930;
  t3363 = t1741 * t3286 * t929;
  t3366 = t850 * t1487 * t1977;
  t3369 = -0.9e1 / 0.8e1 * t3346 - 0.23e2 / 0.8e1 * t3349 + 0.17e2 / 0.8e1 * t3352 + 0.3e1 / 0.4e1 * t3355 - 0.23e2 / 0.8e1 * t3263 - t3274 + t3277 + 0.17e2 / 0.8e1 * t3267 - t3281 + 0.3e1 / 0.8e1 * t3360 - 0.7e1 / 0.8e1 * t3363 - t3366 / 0.4e1 - 0.7e1 / 0.8e1 * t3288 + t3299;
  tv4rho2sigma26 = t3256 + t3257 / 0.108e3 + t3342 / 0.108e3 + t261 * t262 * t3369 / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  t3374 = t1371 * t1537;
  t3377 = 0.23e2 / 0.4e1 * t3349;
  t3378 = 0.17e2 / 0.4e1 * t3352;
  t3381 = 0.7e1 / 0.4e1 * t3363;
  t3383 = -0.9e1 / 0.4e1 * t3346 - t3377 + t3378 + 0.3e1 / 0.2e1 * t3355 - t3264 - t3312 + t3313 + t3268 - t3314 + 0.3e1 / 0.4e1 * t3360 - t3381 - t3366 / 0.2e1 - t3289 + t3318;
  tv4rho2sigma27 = t3305 + t3306 / 0.108e3 + t3374 / 0.108e3 + t261 * t262 * t3383 / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = tv4rho2sigma26;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  t3388 = t1371 * t1542;
  t3391 = 0.23e2 / 0.2e1 * t3349;
  t3392 = 0.17e2 / 0.2e1 * t3352;
  t3395 = 0.7e1 / 0.2e1 * t3363;
  t3396 = -0.9e1 / 0.2e1 * t3346 - t3391 + t3392 + 0.3e1 * t3355 - t3309 - t3331 + t3332 + t3310 - t3333 + 0.3e1 / 0.2e1 * t3360 - t3395 - t3366 - t3316 + t3336;
  tv4rho2sigma29 = t3324 + t3325 / 0.108e3 + t3388 / 0.108e3 + t261 * t262 * t3396 / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = tv4rho2sigma27;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  tv4rho2sigma211 = tv4rho2sigma28;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t3402 = t841 * t672 * t1436;
  t3405 = t392 * t672 * t1440;
  t3408 = t1790 * t1487 * t2240;
  t3411 = t850 * t1487 * t2249;
  t3413 = -0.9e1 / 0.8e1 * t3402 - t3377 + t3378 + 0.3e1 / 0.4e1 * t3405 - t3274 + t3277 - t3281 + 0.3e1 / 0.8e1 * t3408 - t3381 - t3411 / 0.4e1 + t3299;
  tv4rho2sigma212 = t3256 + t3342 / 0.54e2 + t261 * t262 * t3413 / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  t3422 = -0.9e1 / 0.4e1 * t3402 - t3391 + t3392 + 0.3e1 / 0.2e1 * t3405 - t3312 + t3313 - t3314 + 0.3e1 / 0.4e1 * t3408 - t3395 - t3411 / 0.2e1 + t3318;
  tv4rho2sigma213 = t3305 + t3374 / 0.54e2 + t261 * t262 * t3422 / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = tv4rho2sigma212;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  t3433 = -0.9e1 / 0.2e1 * t3402 - 0.23e2 * t3349 + 0.17e2 * t3352 + 0.3e1 * t3405 - t3331 + t3332 - t3333 + 0.3e1 / 0.2e1 * t3408 - 0.7e1 * t3363 - t3411 + t3336;
  tv4rho2sigma215 = t3324 + t3388 / 0.54e2 + t261 * t262 * t3433 / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = tv4rho2sigma213;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  tv4rho2sigma217 = tv4rho2sigma214;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t3438 = t1371 * t1561 / 0.108e3;
  t3440 = t392 * t1546 * t600;
  t3443 = t194 * t1546 * t203;
  t3444 = 0.23e2 / 0.8e1 * t3443;
  t3446 = t427 * t1550 * t610;
  t3447 = 0.23e2 / 0.8e1 * t3446;
  t3450 = t850 * t1550 * t679 * t191;
  t3455 = t829 * t831 * t671 * t1493 * t112;
  t3456 = 0.29e2 / 0.4e1 * t3455;
  t3457 = t1554 * t671;
  t3459 = t1741 * t3457 * t1488;
  t3466 = t99 * t1746 * t310 / t13 / t802 * t1754;
  t3467 = 0.7e1 / 0.8e1 * t3466;
  tv4rhosigma30 = t3438 + t261 * t262 * (-0.3e1 / 0.8e1 * t3440 - t3444 - t3447 - 0.3e1 / 0.8e1 * t3450 + t3456 + 0.3e1 / 0.8e1 * t3459 - t3467) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t3473 = t1371 * t1564 / 0.108e3;
  t3475 = 0.23e2 / 0.4e1 * t3443;
  t3476 = 0.23e2 / 0.4e1 * t3446;
  t3478 = 0.29e2 / 0.2e1 * t3455;
  t3480 = 0.7e1 / 0.4e1 * t3466;
  tv4rhosigma31 = t3473 + t261 * t262 * (-0.3e1 / 0.4e1 * t3440 - t3475 - t3476 - 0.3e1 / 0.4e1 * t3450 + t3478 + 0.3e1 / 0.4e1 * t3459 - t3480) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = tv4rhosigma30;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  t3486 = t1371 * t1567 / 0.108e3;
  t3488 = 0.23e2 / 0.2e1 * t3443;
  t3489 = 0.23e2 / 0.2e1 * t3446;
  t3491 = 0.29e2 * t3455;
  t3493 = 0.7e1 / 0.2e1 * t3466;
  tv4rhosigma33 = t3486 + t261 * t262 * (-0.3e1 / 0.2e1 * t3440 - t3488 - t3489 - 0.3e1 / 0.2e1 * t3450 + t3491 + 0.3e1 / 0.2e1 * t3459 - t3493) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = tv4rhosigma31;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = tv4rhosigma32;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  t3499 = t1371 * t1570 / 0.108e3;
  t3501 = 0.23e2 * t3443;
  t3502 = 0.23e2 * t3446;
  t3504 = 0.58e2 * t3455;
  t3506 = 0.7e1 * t3466;
  tv4rhosigma36 = t3499 + t261 * t262 * (-0.3e1 * t3440 - t3501 - t3502 - 0.3e1 * t3450 + t3504 + 0.3e1 * t3459 - t3506) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = tv4rhosigma33;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = tv4rhosigma34;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = tv4rhosigma35;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t3512 = t392 * t1546 * t647;
  t3516 = t850 * t1550 * t679 * t251;
  t3519 = t1741 * t3457 * t929;
  tv4rhosigma310 = t3438 + t261 * t262 * (-0.3e1 / 0.8e1 * t3512 - t3444 - t3447 - 0.3e1 / 0.8e1 * t3516 + t3456 + 0.3e1 / 0.8e1 * t3519 - t3467) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = t3473 + t261 * t262 * (-0.3e1 / 0.4e1 * t3512 - t3475 - t3476 - 0.3e1 / 0.4e1 * t3516 + t3478 + 0.3e1 / 0.4e1 * t3519 - t3480) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = tv4rhosigma310;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = t3486 + t261 * t262 * (-0.3e1 / 0.2e1 * t3512 - t3488 - t3489 - 0.3e1 / 0.2e1 * t3516 + t3491 + 0.3e1 / 0.2e1 * t3519 - t3493) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = tv4rhosigma311;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = tv4rhosigma312;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = t3499 + t261 * t262 * (-0.3e1 * t3512 - t3501 - t3502 - 0.3e1 * t3516 + t3504 + 0.3e1 * t3519 - t3506) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = tv4rhosigma313;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = tv4rhosigma314;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  tv4rhosigma319 = tv4rhosigma315;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t3549 = t194 * t102 / t832 * t268;
  t3554 = t427 * t10 / t428 * t679;
  t3559 = t829 * t831 * t1545 * t1554 * t112;
  t3565 = t1748 / t13 / t430 * t1549 * t1754;
  tv4sigma40 = t261 * t262 * (-0.9e1 / 0.8e1 * t3549 - 0.9e1 / 0.8e1 * t3554 - 0.3e1 / 0.4e1 * t3559 + 0.3e1 / 0.8e1 * t3565) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = t261 * t262 * (-0.9e1 / 0.4e1 * t3549 - 0.9e1 / 0.4e1 * t3554 - 0.3e1 / 0.2e1 * t3559 + 0.3e1 / 0.4e1 * t3565) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = tv4sigma40;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = t261 * t262 * (-0.9e1 / 0.2e1 * t3549 - 0.9e1 / 0.2e1 * t3554 - 0.3e1 * t3559 + 0.3e1 / 0.2e1 * t3565) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = tv4sigma41;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = tv4sigma42;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = t261 * t262 * (-0.9e1 * t3549 - 0.9e1 * t3554 - 0.6e1 * t3559 + 0.3e1 * t3565) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = tv4sigma43;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = tv4sigma44;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = tv4sigma45;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = t261 * t262 * (-0.18e2 * t3549 - 0.18e2 * t3554 - 0.12e2 * t3559 + 0.6e1 * t3565) / 0.144e3;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = tv4sigma46;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = tv4sigma47;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = tv4sigma48;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  tv4sigma414 = tv4sigma49;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

