/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_2d_b88.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t27, t29, t30, t33, t34;
  double t37, t41, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t24 = sqrt(sigma[0]);
  t25 = t24 * t17;
  t27 = 0.1e1 / t18 / rho[0];
  t29 = log(t25 * t27 + sqrt(POW_2(t25 * t27) + 0.1e1));
  t30 = t27 * t29;
  t33 = 0.1e1 + 0.56e-1 * t25 * t30;
  t34 = 0.1e1 / t33;
  t37 = 0.1e1 + 0.93053827172539591434e-2 * t23 * t34;
  t41 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t37);
  tzk0 = 0.2e1 * t41;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t27, t29, t30, t33, t34;
  double t37, t41, tzk0;

  double t43, t47, t48, t49, t52, t53, t55, t56;
  double t60, t61, t62, t65, t66, t69, t74, tvrho0;
  double t80, t85, t86, t89, t93, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t24 = sqrt(sigma[0]);
  t25 = t24 * t17;
  t27 = 0.1e1 / t18 / rho[0];
  t29 = log(t25 * t27 + sqrt(POW_2(t25 * t27) + 0.1e1));
  t30 = t27 * t29;
  t33 = 0.1e1 + 0.56e-1 * t25 * t30;
  t34 = 0.1e1 / t33;
  t37 = 0.1e1 + 0.93053827172539591434e-2 * t23 * t34;
  t41 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t37);
  tzk0 = 0.2e1 * t41;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t43 = t17 / t18;
  t47 = t20 * t20;
  t48 = 0.1e1 / t47;
  t49 = sigma[0] * t48;
  t52 = t33 * t33;
  t53 = 0.1e1 / t52;
  t55 = 0.1e1 / t18 / t20;
  t56 = t55 * t29;
  t60 = 0.2e1 * t23 + 0.1e1;
  t61 = sqrt(t60);
  t62 = 0.1e1 / t61;
  t65 = -0.84e-1 * t25 * t56 - 0.168e0 * t49 * t62;
  t66 = t53 * t65;
  t69 = -0.2791614815176187743e-1 * t49 * t34 - 0.93053827172539591434e-2 * t23 * t66;
  t74 = my_piecewise3(t2, 0, -t16 * t43 * t37 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t69);
  tvrho0 = 0.2e1 * rho[0] * t74 + 0.2e1 * t41;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t80 = 0.1e1 / t24 * t17;
  t85 = 0.28e-1 * t80 * t30 + 0.56e-1 * t22 * t62;
  t86 = t53 * t85;
  t89 = 0.93053827172539591434e-2 * t22 * t34 - 0.93053827172539591434e-2 * t23 * t86;
  t93 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t89);
  tvsigma0 = 0.2e1 * rho[0] * t93;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t27, t29, t30, t33, t34;
  double t37, t41, tzk0;

  double t43, t47, t48, t49, t52, t53, t55, t56;
  double t60, t61, t62, t65, t66, t69, t74, tvrho0;
  double t80, t85, t86, t89, t93, tvsigma0;

  double t96, t103, t104, t105, t111, t112, t113, t117;
  double t118, t123, t124, t125, t128, t131, t132, t135;
  double t140, tv2rho20, t148, t153, t154, t161, t162, t163;
  double t166, t167, t170, t175, tv2rhosigma0, t180, t181, t186;
  double t189, t193, t194, t197, t198, t201, t205, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t24 = sqrt(sigma[0]);
  t25 = t24 * t17;
  t27 = 0.1e1 / t18 / rho[0];
  t29 = log(t25 * t27 + sqrt(POW_2(t25 * t27) + 0.1e1));
  t30 = t27 * t29;
  t33 = 0.1e1 + 0.56e-1 * t25 * t30;
  t34 = 0.1e1 / t33;
  t37 = 0.1e1 + 0.93053827172539591434e-2 * t23 * t34;
  t41 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t37);
  tzk0 = 0.2e1 * t41;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t43 = t17 / t18;
  t47 = t20 * t20;
  t48 = 0.1e1 / t47;
  t49 = sigma[0] * t48;
  t52 = t33 * t33;
  t53 = 0.1e1 / t52;
  t55 = 0.1e1 / t18 / t20;
  t56 = t55 * t29;
  t60 = 0.2e1 * t23 + 0.1e1;
  t61 = sqrt(t60);
  t62 = 0.1e1 / t61;
  t65 = -0.84e-1 * t25 * t56 - 0.168e0 * t49 * t62;
  t66 = t53 * t65;
  t69 = -0.2791614815176187743e-1 * t49 * t34 - 0.93053827172539591434e-2 * t23 * t66;
  t74 = my_piecewise3(t2, 0, -t16 * t43 * t37 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t69);
  tvrho0 = 0.2e1 * rho[0] * t74 + 0.2e1 * t41;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t80 = 0.1e1 / t24 * t17;
  t85 = 0.28e-1 * t80 * t30 + 0.56e-1 * t22 * t62;
  t86 = t53 * t85;
  t89 = 0.93053827172539591434e-2 * t22 * t34 - 0.93053827172539591434e-2 * t23 * t86;
  t93 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t89);
  tvsigma0 = 0.2e1 * rho[0] * t93;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t96 = t17 * t27;
  t103 = t47 * rho[0];
  t104 = 0.1e1 / t103;
  t105 = sigma[0] * t104;
  t111 = 0.1e1 / t52 / t33;
  t112 = t65 * t65;
  t113 = t111 * t112;
  t117 = 0.1e1 / t18 / t21;
  t118 = t117 * t29;
  t123 = sigma[0] * sigma[0];
  t124 = t47 * t47;
  t125 = 0.1e1 / t124;
  t128 = 0.1e1 / t61 / t60;
  t131 = 0.21e0 * t25 * t118 + 0.924e0 * t105 * t62 - 0.504e0 * t123 * t125 * t128;
  t132 = t53 * t131;
  t135 = 0.11166459260704750972e0 * t105 * t34 + 0.5583229630352375486e-1 * t49 * t66 + 0.18610765434507918287e-1 * t23 * t113 - 0.93053827172539591434e-2 * t23 * t132;
  t140 = my_piecewise3(t2, 0, t16 * t96 * t37 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t43 * t69 - 0.2e1 / 0.3e1 * t16 * t19 * t135);
  tv2rho20 = 0.2e1 * rho[0] * t140 + 0.4e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t148 = t22 * t53;
  t153 = t111 * t85;
  t154 = t153 * t65;
  t161 = t47 * t21;
  t162 = 0.1e1 / t161;
  t163 = t162 * t128;
  t166 = -0.42e-1 * t80 * t56 - 0.252e0 * t48 * t62 + 0.168e0 * t163 * sigma[0];
  t167 = t53 * t166;
  t170 = -0.2791614815176187743e-1 * t48 * t34 - 0.93053827172539591434e-2 * t148 * t65 + 0.2791614815176187743e-1 * t49 * t86 + 0.18610765434507918287e-1 * t23 * t154 - 0.93053827172539591434e-2 * t23 * t167;
  t175 = my_piecewise3(t2, 0, -t16 * t43 * t89 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t170);
  tv2rhosigma0 = 0.2e1 * rho[0] * t175 + 0.2e1 * t93;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t180 = t85 * t85;
  t181 = t111 * t180;
  t186 = 0.1e1 / t24 / sigma[0] * t17;
  t189 = 0.1e1 / sigma[0];
  t193 = t47 * t20;
  t194 = 0.1e1 / t193;
  t197 = -0.14e-1 * t186 * t30 + 0.28e-1 * t189 * t22 * t62 - 0.56e-1 * t194 * t128;
  t198 = t53 * t197;
  t201 = -0.18610765434507918287e-1 * t148 * t85 + 0.18610765434507918287e-1 * t23 * t181 - 0.93053827172539591434e-2 * t23 * t198;
  t205 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t201);
  tv2sigma20 = 0.2e1 * rho[0] * t205;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t27, t29, t30, t33, t34;
  double t37, t41, tzk0;

  double t43, t47, t48, t49, t52, t53, t55, t56;
  double t60, t61, t62, t65, t66, t69, t74, tvrho0;
  double t80, t85, t86, t89, t93, tvsigma0;

  double t96, t103, t104, t105, t111, t112, t113, t117;
  double t118, t123, t124, t125, t128, t131, t132, t135;
  double t140, tv2rho20, t148, t153, t154, t161, t162, t163;
  double t166, t167, t170, t175, tv2rhosigma0, t180, t181, t186;
  double t189, t193, t194, t197, t198, t201, t205, tv2sigma20;

  double t208, t217, t226, t227, t228, t229, t232, t233;
  double t238, t244, t248, t250, t252, t254, t257, t258;
  double t261, t266, tv3rho30, t278, t281, t293, t296, t297;
  double t300, t307, t312, t315, t316, t319, t324, tv3rho2sigma0;
  double t332, t339, t340, t343, t348, t349, t359, t360;
  double t363, t364, t367, t372, tv3rhosigma20, t379, t380, t383;
  double t388, t391, t400, t401, t404, t408, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t24 = sqrt(sigma[0]);
  t25 = t24 * t17;
  t27 = 0.1e1 / t18 / rho[0];
  t29 = log(t25 * t27 + sqrt(POW_2(t25 * t27) + 0.1e1));
  t30 = t27 * t29;
  t33 = 0.1e1 + 0.56e-1 * t25 * t30;
  t34 = 0.1e1 / t33;
  t37 = 0.1e1 + 0.93053827172539591434e-2 * t23 * t34;
  t41 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t37);
  tzk0 = 0.2e1 * t41;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t43 = t17 / t18;
  t47 = t20 * t20;
  t48 = 0.1e1 / t47;
  t49 = sigma[0] * t48;
  t52 = t33 * t33;
  t53 = 0.1e1 / t52;
  t55 = 0.1e1 / t18 / t20;
  t56 = t55 * t29;
  t60 = 0.2e1 * t23 + 0.1e1;
  t61 = sqrt(t60);
  t62 = 0.1e1 / t61;
  t65 = -0.84e-1 * t25 * t56 - 0.168e0 * t49 * t62;
  t66 = t53 * t65;
  t69 = -0.2791614815176187743e-1 * t49 * t34 - 0.93053827172539591434e-2 * t23 * t66;
  t74 = my_piecewise3(t2, 0, -t16 * t43 * t37 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t69);
  tvrho0 = 0.2e1 * rho[0] * t74 + 0.2e1 * t41;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t80 = 0.1e1 / t24 * t17;
  t85 = 0.28e-1 * t80 * t30 + 0.56e-1 * t22 * t62;
  t86 = t53 * t85;
  t89 = 0.93053827172539591434e-2 * t22 * t34 - 0.93053827172539591434e-2 * t23 * t86;
  t93 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t89);
  tvsigma0 = 0.2e1 * rho[0] * t93;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t96 = t17 * t27;
  t103 = t47 * rho[0];
  t104 = 0.1e1 / t103;
  t105 = sigma[0] * t104;
  t111 = 0.1e1 / t52 / t33;
  t112 = t65 * t65;
  t113 = t111 * t112;
  t117 = 0.1e1 / t18 / t21;
  t118 = t117 * t29;
  t123 = sigma[0] * sigma[0];
  t124 = t47 * t47;
  t125 = 0.1e1 / t124;
  t128 = 0.1e1 / t61 / t60;
  t131 = 0.21e0 * t25 * t118 + 0.924e0 * t105 * t62 - 0.504e0 * t123 * t125 * t128;
  t132 = t53 * t131;
  t135 = 0.11166459260704750972e0 * t105 * t34 + 0.5583229630352375486e-1 * t49 * t66 + 0.18610765434507918287e-1 * t23 * t113 - 0.93053827172539591434e-2 * t23 * t132;
  t140 = my_piecewise3(t2, 0, t16 * t96 * t37 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t43 * t69 - 0.2e1 / 0.3e1 * t16 * t19 * t135);
  tv2rho20 = 0.2e1 * rho[0] * t140 + 0.4e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t148 = t22 * t53;
  t153 = t111 * t85;
  t154 = t153 * t65;
  t161 = t47 * t21;
  t162 = 0.1e1 / t161;
  t163 = t162 * t128;
  t166 = -0.42e-1 * t80 * t56 - 0.252e0 * t48 * t62 + 0.168e0 * t163 * sigma[0];
  t167 = t53 * t166;
  t170 = -0.2791614815176187743e-1 * t48 * t34 - 0.93053827172539591434e-2 * t148 * t65 + 0.2791614815176187743e-1 * t49 * t86 + 0.18610765434507918287e-1 * t23 * t154 - 0.93053827172539591434e-2 * t23 * t167;
  t175 = my_piecewise3(t2, 0, -t16 * t43 * t89 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t170);
  tv2rhosigma0 = 0.2e1 * rho[0] * t175 + 0.2e1 * t93;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t180 = t85 * t85;
  t181 = t111 * t180;
  t186 = 0.1e1 / t24 / sigma[0] * t17;
  t189 = 0.1e1 / sigma[0];
  t193 = t47 * t20;
  t194 = 0.1e1 / t193;
  t197 = -0.14e-1 * t186 * t30 + 0.28e-1 * t189 * t22 * t62 - 0.56e-1 * t194 * t128;
  t198 = t53 * t197;
  t201 = -0.18610765434507918287e-1 * t148 * t85 + 0.18610765434507918287e-1 * t23 * t181 - 0.93053827172539591434e-2 * t23 * t198;
  t205 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t201);
  tv2sigma20 = 0.2e1 * rho[0] * t205;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t208 = t17 * t55;
  t217 = sigma[0] * t194;
  t226 = t52 * t52;
  t227 = 0.1e1 / t226;
  t228 = t112 * t65;
  t229 = t227 * t228;
  t232 = t111 * t65;
  t233 = t232 * t131;
  t238 = 0.1e1 / t18 / t47 * t29;
  t244 = 0.1e1 / t124 / rho[0];
  t248 = t123 * sigma[0];
  t250 = 0.1e1 / t124 / t47;
  t252 = t60 * t60;
  t254 = 0.1e1 / t61 / t252;
  t257 = -0.735e0 * t25 * t238 - 0.525e1 * t217 * t62 + 0.6804e1 * t123 * t244 * t128 - 0.4536e1 * t248 * t250 * t254;
  t258 = t53 * t257;
  t261 = -0.5583229630352375486e0 * t217 * t34 - 0.33499377782114252916e0 * t105 * t66 - 0.16749688891057126458e0 * t49 * t113 + 0.8374844445528563229e-1 * t49 * t132 - 0.55832296303523754861e-1 * t23 * t229 + 0.55832296303523754861e-1 * t23 * t233 - 0.93053827172539591434e-2 * t23 * t258;
  t266 = my_piecewise3(t2, 0, -t16 * t208 * t37 / 0.4e1 + t16 * t96 * t69 / 0.2e1 - t16 * t43 * t135 - 0.2e1 / 0.3e1 * t16 * t19 * t261);
  tv3rho30 = 0.2e1 * rho[0] * t266 + 0.6e1 * t140;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t278 = t48 * t53;
  t281 = t22 * t111;
  t293 = t227 * t85 * t112;
  t296 = t111 * t166;
  t297 = t296 * t65;
  t300 = t153 * t131;
  t307 = t125 * t128;
  t312 = 0.1e1 / t124 / t21 * t254;
  t315 = 0.105e0 * t80 * t118 + 0.1134e1 * t104 * t62 - 0.1932e1 * t307 * sigma[0] + 0.1512e1 * t312 * t123;
  t316 = t53 * t315;
  t319 = 0.11166459260704750972e0 * t104 * t34 + 0.5583229630352375486e-1 * t278 * t65 + 0.18610765434507918287e-1 * t281 * t112 - 0.93053827172539591434e-2 * t148 * t131 - 0.11166459260704750972e0 * t105 * t86 - 0.11166459260704750972e0 * t49 * t154 + 0.5583229630352375486e-1 * t49 * t167 - 0.55832296303523754861e-1 * t23 * t293 + 0.37221530869015836574e-1 * t23 * t297 + 0.18610765434507918287e-1 * t23 * t300 - 0.93053827172539591434e-2 * t23 * t316;
  t324 = my_piecewise3(t2, 0, t16 * t96 * t89 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t43 * t170 - 0.2e1 / 0.3e1 * t16 * t19 * t319);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t324 + 0.4e1 * t175;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t332 = t85 * t65;
  t339 = t227 * t180;
  t340 = t339 * t65;
  t343 = t153 * t166;
  t348 = t111 * t197;
  t349 = t348 * t65;
  t359 = 0.1e1 / t124 / t20;
  t360 = t359 * t254;
  t363 = 0.21e-1 * t186 * t56 - 0.42e-1 * t189 * t48 * t62 + 0.42e0 * t163 - 0.504e0 * t360 * sigma[0];
  t364 = t53 * t363;
  t367 = 0.55832296303523754861e-1 * t278 * t85 + 0.37221530869015836574e-1 * t281 * t332 - 0.18610765434507918287e-1 * t148 * t166 - 0.55832296303523754861e-1 * t49 * t181 - 0.55832296303523754861e-1 * t23 * t340 + 0.37221530869015836574e-1 * t23 * t343 + 0.2791614815176187743e-1 * t49 * t198 + 0.18610765434507918287e-1 * t23 * t349 - 0.93053827172539591434e-2 * t23 * t364;
  t372 = my_piecewise3(t2, 0, -t16 * t43 * t201 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t367);
  tv3rhosigma20 = 0.2e1 * rho[0] * t372 + 0.2e1 * t205;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t379 = t180 * t85;
  t380 = t227 * t379;
  t383 = t153 * t197;
  t388 = 0.1e1 / t24 / t123 * t17;
  t391 = 0.1e1 / t123;
  t400 = 0.21e-1 * t388 * t30 - 0.42e-1 * t391 * t22 * t62 - 0.28e-1 * t189 * t194 * t128 + 0.168e0 * t244 * t254;
  t401 = t53 * t400;
  t404 = 0.55832296303523754861e-1 * t281 * t180 - 0.2791614815176187743e-1 * t148 * t197 - 0.55832296303523754861e-1 * t23 * t380 + 0.55832296303523754861e-1 * t23 * t383 - 0.93053827172539591434e-2 * t23 * t401;
  t408 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t404);
  tv3sigma30 = 0.2e1 * rho[0] * t408;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t27, t29, t30, t33, t34;
  double t37, t41, tzk0;

  double t43, t47, t48, t49, t52, t53, t55, t56;
  double t60, t61, t62, t65, t66, t69, t74, tvrho0;
  double t80, t85, t86, t89, t93, tvsigma0;

  double t96, t103, t104, t105, t111, t112, t113, t117;
  double t118, t123, t124, t125, t128, t131, t132, t135;
  double t140, tv2rho20, t148, t153, t154, t161, t162, t163;
  double t166, t167, t170, t175, tv2rhosigma0, t180, t181, t186;
  double t189, t193, t194, t197, t198, t201, t205, tv2sigma20;

  double t208, t217, t226, t227, t228, t229, t232, t233;
  double t238, t244, t248, t250, t252, t254, t257, t258;
  double t261, t266, tv3rho30, t278, t281, t293, t296, t297;
  double t300, t307, t312, t315, t316, t319, t324, tv3rho2sigma0;
  double t332, t339, t340, t343, t348, t349, t359, t360;
  double t363, t364, t367, t372, tv3rhosigma20, t379, t380, t383;
  double t388, t391, t400, t401, t404, t408, tv3sigma30;

  double t422, t438, t439, t447, t465, t469, t470, t475;
  double t482, t487, tv4rho40, t551, t555, t558, t566, t573;
  double t579, tv4rho3sigma0, t614, t624, t664, t670, tv4rho2sigma20, t702;
  double t734, t739, tv4rhosigma30, t748, t755, t787, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t24 = sqrt(sigma[0]);
  t25 = t24 * t17;
  t27 = 0.1e1 / t18 / rho[0];
  t29 = log(t25 * t27 + sqrt(POW_2(t25 * t27) + 0.1e1));
  t30 = t27 * t29;
  t33 = 0.1e1 + 0.56e-1 * t25 * t30;
  t34 = 0.1e1 / t33;
  t37 = 0.1e1 + 0.93053827172539591434e-2 * t23 * t34;
  t41 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t37);
  tzk0 = 0.2e1 * t41;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t43 = t17 / t18;
  t47 = t20 * t20;
  t48 = 0.1e1 / t47;
  t49 = sigma[0] * t48;
  t52 = t33 * t33;
  t53 = 0.1e1 / t52;
  t55 = 0.1e1 / t18 / t20;
  t56 = t55 * t29;
  t60 = 0.2e1 * t23 + 0.1e1;
  t61 = sqrt(t60);
  t62 = 0.1e1 / t61;
  t65 = -0.84e-1 * t25 * t56 - 0.168e0 * t49 * t62;
  t66 = t53 * t65;
  t69 = -0.2791614815176187743e-1 * t49 * t34 - 0.93053827172539591434e-2 * t23 * t66;
  t74 = my_piecewise3(t2, 0, -t16 * t43 * t37 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t69);
  tvrho0 = 0.2e1 * rho[0] * t74 + 0.2e1 * t41;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t80 = 0.1e1 / t24 * t17;
  t85 = 0.28e-1 * t80 * t30 + 0.56e-1 * t22 * t62;
  t86 = t53 * t85;
  t89 = 0.93053827172539591434e-2 * t22 * t34 - 0.93053827172539591434e-2 * t23 * t86;
  t93 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t89);
  tvsigma0 = 0.2e1 * rho[0] * t93;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t96 = t17 * t27;
  t103 = t47 * rho[0];
  t104 = 0.1e1 / t103;
  t105 = sigma[0] * t104;
  t111 = 0.1e1 / t52 / t33;
  t112 = t65 * t65;
  t113 = t111 * t112;
  t117 = 0.1e1 / t18 / t21;
  t118 = t117 * t29;
  t123 = sigma[0] * sigma[0];
  t124 = t47 * t47;
  t125 = 0.1e1 / t124;
  t128 = 0.1e1 / t61 / t60;
  t131 = 0.21e0 * t25 * t118 + 0.924e0 * t105 * t62 - 0.504e0 * t123 * t125 * t128;
  t132 = t53 * t131;
  t135 = 0.11166459260704750972e0 * t105 * t34 + 0.5583229630352375486e-1 * t49 * t66 + 0.18610765434507918287e-1 * t23 * t113 - 0.93053827172539591434e-2 * t23 * t132;
  t140 = my_piecewise3(t2, 0, t16 * t96 * t37 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t43 * t69 - 0.2e1 / 0.3e1 * t16 * t19 * t135);
  tv2rho20 = 0.2e1 * rho[0] * t140 + 0.4e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t148 = t22 * t53;
  t153 = t111 * t85;
  t154 = t153 * t65;
  t161 = t47 * t21;
  t162 = 0.1e1 / t161;
  t163 = t162 * t128;
  t166 = -0.42e-1 * t80 * t56 - 0.252e0 * t48 * t62 + 0.168e0 * t163 * sigma[0];
  t167 = t53 * t166;
  t170 = -0.2791614815176187743e-1 * t48 * t34 - 0.93053827172539591434e-2 * t148 * t65 + 0.2791614815176187743e-1 * t49 * t86 + 0.18610765434507918287e-1 * t23 * t154 - 0.93053827172539591434e-2 * t23 * t167;
  t175 = my_piecewise3(t2, 0, -t16 * t43 * t89 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t170);
  tv2rhosigma0 = 0.2e1 * rho[0] * t175 + 0.2e1 * t93;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t180 = t85 * t85;
  t181 = t111 * t180;
  t186 = 0.1e1 / t24 / sigma[0] * t17;
  t189 = 0.1e1 / sigma[0];
  t193 = t47 * t20;
  t194 = 0.1e1 / t193;
  t197 = -0.14e-1 * t186 * t30 + 0.28e-1 * t189 * t22 * t62 - 0.56e-1 * t194 * t128;
  t198 = t53 * t197;
  t201 = -0.18610765434507918287e-1 * t148 * t85 + 0.18610765434507918287e-1 * t23 * t181 - 0.93053827172539591434e-2 * t23 * t198;
  t205 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t201);
  tv2sigma20 = 0.2e1 * rho[0] * t205;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t208 = t17 * t55;
  t217 = sigma[0] * t194;
  t226 = t52 * t52;
  t227 = 0.1e1 / t226;
  t228 = t112 * t65;
  t229 = t227 * t228;
  t232 = t111 * t65;
  t233 = t232 * t131;
  t238 = 0.1e1 / t18 / t47 * t29;
  t244 = 0.1e1 / t124 / rho[0];
  t248 = t123 * sigma[0];
  t250 = 0.1e1 / t124 / t47;
  t252 = t60 * t60;
  t254 = 0.1e1 / t61 / t252;
  t257 = -0.735e0 * t25 * t238 - 0.525e1 * t217 * t62 + 0.6804e1 * t123 * t244 * t128 - 0.4536e1 * t248 * t250 * t254;
  t258 = t53 * t257;
  t261 = -0.5583229630352375486e0 * t217 * t34 - 0.33499377782114252916e0 * t105 * t66 - 0.16749688891057126458e0 * t49 * t113 + 0.8374844445528563229e-1 * t49 * t132 - 0.55832296303523754861e-1 * t23 * t229 + 0.55832296303523754861e-1 * t23 * t233 - 0.93053827172539591434e-2 * t23 * t258;
  t266 = my_piecewise3(t2, 0, -t16 * t208 * t37 / 0.4e1 + t16 * t96 * t69 / 0.2e1 - t16 * t43 * t135 - 0.2e1 / 0.3e1 * t16 * t19 * t261);
  tv3rho30 = 0.2e1 * rho[0] * t266 + 0.6e1 * t140;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t278 = t48 * t53;
  t281 = t22 * t111;
  t293 = t227 * t85 * t112;
  t296 = t111 * t166;
  t297 = t296 * t65;
  t300 = t153 * t131;
  t307 = t125 * t128;
  t312 = 0.1e1 / t124 / t21 * t254;
  t315 = 0.105e0 * t80 * t118 + 0.1134e1 * t104 * t62 - 0.1932e1 * t307 * sigma[0] + 0.1512e1 * t312 * t123;
  t316 = t53 * t315;
  t319 = 0.11166459260704750972e0 * t104 * t34 + 0.5583229630352375486e-1 * t278 * t65 + 0.18610765434507918287e-1 * t281 * t112 - 0.93053827172539591434e-2 * t148 * t131 - 0.11166459260704750972e0 * t105 * t86 - 0.11166459260704750972e0 * t49 * t154 + 0.5583229630352375486e-1 * t49 * t167 - 0.55832296303523754861e-1 * t23 * t293 + 0.37221530869015836574e-1 * t23 * t297 + 0.18610765434507918287e-1 * t23 * t300 - 0.93053827172539591434e-2 * t23 * t316;
  t324 = my_piecewise3(t2, 0, t16 * t96 * t89 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t43 * t170 - 0.2e1 / 0.3e1 * t16 * t19 * t319);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t324 + 0.4e1 * t175;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t332 = t85 * t65;
  t339 = t227 * t180;
  t340 = t339 * t65;
  t343 = t153 * t166;
  t348 = t111 * t197;
  t349 = t348 * t65;
  t359 = 0.1e1 / t124 / t20;
  t360 = t359 * t254;
  t363 = 0.21e-1 * t186 * t56 - 0.42e-1 * t189 * t48 * t62 + 0.42e0 * t163 - 0.504e0 * t360 * sigma[0];
  t364 = t53 * t363;
  t367 = 0.55832296303523754861e-1 * t278 * t85 + 0.37221530869015836574e-1 * t281 * t332 - 0.18610765434507918287e-1 * t148 * t166 - 0.55832296303523754861e-1 * t49 * t181 - 0.55832296303523754861e-1 * t23 * t340 + 0.37221530869015836574e-1 * t23 * t343 + 0.2791614815176187743e-1 * t49 * t198 + 0.18610765434507918287e-1 * t23 * t349 - 0.93053827172539591434e-2 * t23 * t364;
  t372 = my_piecewise3(t2, 0, -t16 * t43 * t201 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t367);
  tv3rhosigma20 = 0.2e1 * rho[0] * t372 + 0.2e1 * t205;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t379 = t180 * t85;
  t380 = t227 * t379;
  t383 = t153 * t197;
  t388 = 0.1e1 / t24 / t123 * t17;
  t391 = 0.1e1 / t123;
  t400 = 0.21e-1 * t388 * t30 - 0.42e-1 * t391 * t22 * t62 - 0.28e-1 * t189 * t194 * t128 + 0.168e0 * t244 * t254;
  t401 = t53 * t400;
  t404 = 0.55832296303523754861e-1 * t281 * t180 - 0.2791614815176187743e-1 * t148 * t197 - 0.55832296303523754861e-1 * t23 * t380 + 0.55832296303523754861e-1 * t23 * t383 - 0.93053827172539591434e-2 * t23 * t401;
  t408 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t404);
  tv3sigma30 = 0.2e1 * rho[0] * t408;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t422 = sigma[0] * t162;
  t438 = 0.1e1 / t226 / t33;
  t439 = t112 * t112;
  t447 = t131 * t131;
  t465 = 0.1e1 / t124 / t103;
  t469 = t123 * t123;
  t470 = t124 * t124;
  t475 = 0.1e1 / t61 / t252 / t60;
  t482 = 0.33499377782114252916e1 * t422 * t34 + 0.22332918521409501944e1 * t217 * t66 + 0.13399751112845701166e1 * t105 * t113 - 0.66998755564228505832e0 * t105 * t132 + 0.66998755564228505832e0 * t49 * t229 - 0.66998755564228505832e0 * t49 * t233 + 0.11166459260704750972e0 * t49 * t258 + 0.22332918521409501944e0 * t23 * t438 * t439 - 0.33499377782114252916e0 * t23 * t227 * t112 * t131 + 0.55832296303523754861e-1 * t23 * t111 * t447 + 0.74443061738031673148e-1 * t23 * t232 * t257 - 0.93053827172539591434e-2 * t23 * t53 * (0.33075e1 * t25 / t18 / t103 * t29 + 0.33705e2 * t422 * t62 - 0.76986e2 * t123 * t359 * t128 + 0.115668e3 * t248 * t465 * t254 - 0.6804e2 * t469 / t470 * t475);
  t487 = my_piecewise3(t2, 0, 0.5e1 / 0.8e1 * t16 * t17 * t117 * t37 - t16 * t208 * t69 + t16 * t96 * t135 - 0.4e1 / 0.3e1 * t16 * t43 * t261 - 0.2e1 / 0.3e1 * t16 * t19 * t482);
  tv4rho40 = 0.2e1 * rho[0] * t487 + 0.8e1 * t266;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t551 = t23 * t227;
  t555 = t48 * t111;
  t558 = t22 * t227;
  t566 = t104 * t53;
  t573 = -0.33499377782114252916e0 * t49 * t297 + 0.50249066673171379374e0 * t49 * t293 + 0.22332918521409501944e0 * t23 * t438 * t85 * t228 - 0.16749688891057126458e0 * t551 * t332 * t131 - 0.16749688891057126458e0 * t555 * t112 - 0.55832296303523754861e-1 * t558 * t228 + 0.55832296303523754861e-1 * t281 * t65 * t131 - 0.5583229630352375486e0 * t194 * t34 - 0.33499377782114252916e0 * t566 * t65 + 0.8374844445528563229e-1 * t278 * t131 - 0.93053827172539591434e-2 * t148 * t257;
  t579 = my_piecewise3(t2, 0, -t16 * t208 * t89 / 0.4e1 + t16 * t96 * t170 / 0.2e1 - t16 * t43 * t319 - 0.2e1 / 0.3e1 * t16 * t19 * (0.18610765434507918287e-1 * t23 * t153 * t257 + 0.55832296303523754861e-1 * t23 * t111 * t315 * t65 + 0.55832296303523754861e-1 * t23 * t296 * t131 - 0.16749688891057126458e0 * t49 * t300 - 0.16749688891057126458e0 * t23 * t227 * t166 * t112 - 0.93053827172539591434e-2 * t23 * t53 * (-0.3675e0 * t80 * t238 - 0.5985e1 * t194 * t62 + 0.18858e2 * t244 * t128 * sigma[0] - 0.3402e2 * t250 * t254 * t123 + 0.2268e2 / t124 / t161 * t475 * t248) - 0.33499377782114252916e0 * t105 * t167 + 0.8374844445528563229e-1 * t49 * t316 + 0.5583229630352375486e0 * t217 * t86 + 0.66998755564228505832e0 * t105 * t154 + t573));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t579 + 0.6e1 * t324;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t614 = t166 * t166;
  t624 = -0.55832296303523754861e-1 * t23 * t227 * t197 * t112 + 0.22332918521409501944e0 * t23 * t438 * t180 * t112 - 0.22332918521409501944e0 * t551 * t332 * t166 - 0.11166459260704750972e0 * t105 * t198 - 0.11166459260704750972e0 * t49 * t349 + 0.37221530869015836574e-1 * t23 * t111 * t363 * t65 + 0.18610765434507918287e-1 * t23 * t348 * t131 - 0.55832296303523754861e-1 * t23 * t339 * t131 + 0.37221530869015836574e-1 * t23 * t111 * t614 + 0.37221530869015836574e-1 * t23 * t153 * t315 - 0.11166459260704750972e0 * t558 * t85 * t112;
  t664 = 0.22332918521409501944e0 * t105 * t181 + 0.33499377782114252916e0 * t49 * t340 - 0.22332918521409501944e0 * t49 * t343 - 0.93053827172539591434e-2 * t23 * t53 * (-0.525e-1 * t186 * t118 + 0.105e0 * t189 * t104 * t62 - 0.3066e1 * t307 + 0.882e1 * t312 * sigma[0] - 0.756e1 / t124 / t193 * t475 * t123) + 0.5583229630352375486e-1 * t49 * t364 - 0.22332918521409501944e0 * t566 * t85 - 0.22332918521409501944e0 * t555 * t332 + 0.74443061738031673148e-1 * t281 * t166 * t65 + 0.37221530869015836574e-1 * t281 * t85 * t131 + 0.11166459260704750972e0 * t278 * t166 - 0.18610765434507918287e-1 * t148 * t315;
  t670 = my_piecewise3(t2, 0, t16 * t96 * t201 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t43 * t367 - 0.2e1 / 0.3e1 * t16 * t19 * (t624 + t664));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t670 + 0.4e1 * t372;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t702 = t85 * t197;
  t734 = -0.16749688891057126458e0 * t555 * t180 - 0.16749688891057126458e0 * t558 * t180 * t65 + 0.11166459260704750972e0 * t281 * t85 * t166 + 0.8374844445528563229e-1 * t278 * t197 + 0.5583229630352375486e-1 * t281 * t197 * t65 - 0.2791614815176187743e-1 * t148 * t363 + 0.16749688891057126458e0 * t49 * t380 + 0.22332918521409501944e0 * t23 * t438 * t379 * t65 - 0.16749688891057126458e0 * t23 * t339 * t166 - 0.16749688891057126458e0 * t49 * t383 - 0.16749688891057126458e0 * t551 * t702 * t65 + 0.55832296303523754861e-1 * t23 * t296 * t197 + 0.55832296303523754861e-1 * t23 * t153 * t363 + 0.2791614815176187743e-1 * t49 * t401 + 0.18610765434507918287e-1 * t23 * t111 * t400 * t65 - 0.93053827172539591434e-2 * t23 * t53 * (-0.315e-1 * t388 * t56 + 0.63e-1 * t391 * t48 * t62 + 0.42e-1 * t189 * t162 * t128 - 0.1764e1 * t360 + 0.252e1 * t465 * t475 * sigma[0]);
  t739 = my_piecewise3(t2, 0, -t16 * t43 * t404 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t734);
  tv4rhosigma30 = 0.2e1 * rho[0] * t739 + 0.2e1 * t408;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t748 = t180 * t180;
  t755 = t197 * t197;
  t787 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * (-0.22332918521409501944e0 * t558 * t379 + 0.22332918521409501944e0 * t281 * t702 - 0.37221530869015836573e-1 * t148 * t400 + 0.22332918521409501944e0 * t23 * t438 * t748 - 0.33499377782114252916e0 * t23 * t339 * t197 + 0.55832296303523754861e-1 * t23 * t111 * t755 + 0.74443061738031673148e-1 * t23 * t153 * t400 - 0.93053827172539591434e-2 * t23 * t53 * (-0.525e-1 / t24 / t248 * t17 * t30 + 0.105e0 / t248 * t22 * t62 + 0.7e-1 * t391 * t194 * t128 + 0.84e-1 * t189 * t244 * t254 - 0.84e0 * t250 * t475)));
  tv4sigma40 = 0.2e1 * rho[0] * t787;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t32, t33, t35, t36, t37;
  double t40, t41, t44, t45, t48, t49, t50, t51;
  double t52, t53, t54, t55, t56, t57, t58, t59;
  double t60, t61, t62, t64, t65, t66, t69, t70;
  double t73, t74, t77, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t32 = sqrt(sigma[0]);
  t33 = sqrt(rho[0]);
  t35 = 0.1e1 / t33 / rho[0];
  t36 = t32 * t35;
  t37 = log(t36 + sqrt(t36 * t36 + 0.1e1));
  t40 = 0.1e1 + 0.56e-1 * t36 * t37;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 + 0.46526913586269795717e-2 * t31 * t41;
  t45 = t27 * t44;
  t48 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t45);
  t49 = rho[1] <= p->dens_threshold;
  t50 = my_piecewise5(t12, t9, t8, t13, -t15);
  t51 = 0.1e1 + t50;
  t52 = t51 <= p->zeta_threshold;
  t53 = sqrt(t51);
  t54 = t53 * t51;
  t55 = my_piecewise3(t52, t20, t54);
  t56 = t3 * t55;
  t57 = rho[1] * rho[1];
  t58 = t57 * rho[1];
  t59 = 0.1e1 / t58;
  t60 = sigma[2] * t59;
  t61 = sqrt(sigma[2]);
  t62 = sqrt(rho[1]);
  t64 = 0.1e1 / t62 / rho[1];
  t65 = t61 * t64;
  t66 = log(t65 + sqrt(t65 * t65 + 0.1e1));
  t69 = 0.1e1 + 0.56e-1 * t65 * t66;
  t70 = 0.1e1 / t69;
  t73 = 0.1e1 + 0.46526913586269795717e-2 * t60 * t70;
  t74 = t27 * t73;
  t77 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t74);
  tzk0 = t48 + t77;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t32, t33, t35, t36, t37;
  double t40, t41, t44, t45, t48, t49, t50, t51;
  double t52, t53, t54, t55, t56, t57, t58, t59;
  double t60, t61, t62, t64, t65, t66, t69, t70;
  double t73, t74, t77, tzk0;

  double t78, t79, t80, t81, t82, t85, t86, t90;
  double t91, t93, t94, t95, t96, t99, t100, t102;
  double t106, t107, t108, t111, t112, t115, t116, t120;
  double t122, t125, t126, t129, t131, t133, tvrho0, t136;
  double t137, t140, t141, t145, t147, t150, t151, t154;
  double t155, t156, t159, t160, t162, t166, t167, t168;
  double t171, t172, t175, t176, t180, tvrho1, t185, t191;
  double t192, t195, t196, t199, tvsigma0, tvsigma1, t202, t208;
  double t209, t212, t213, t216, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t32 = sqrt(sigma[0]);
  t33 = sqrt(rho[0]);
  t35 = 0.1e1 / t33 / rho[0];
  t36 = t32 * t35;
  t37 = log(t36 + sqrt(t36 * t36 + 0.1e1));
  t40 = 0.1e1 + 0.56e-1 * t36 * t37;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 + 0.46526913586269795717e-2 * t31 * t41;
  t45 = t27 * t44;
  t48 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t45);
  t49 = rho[1] <= p->dens_threshold;
  t50 = my_piecewise5(t12, t9, t8, t13, -t15);
  t51 = 0.1e1 + t50;
  t52 = t51 <= p->zeta_threshold;
  t53 = sqrt(t51);
  t54 = t53 * t51;
  t55 = my_piecewise3(t52, t20, t54);
  t56 = t3 * t55;
  t57 = rho[1] * rho[1];
  t58 = t57 * rho[1];
  t59 = 0.1e1 / t58;
  t60 = sigma[2] * t59;
  t61 = sqrt(sigma[2]);
  t62 = sqrt(rho[1]);
  t64 = 0.1e1 / t62 / rho[1];
  t65 = t61 * t64;
  t66 = log(t65 + sqrt(t65 * t65 + 0.1e1));
  t69 = 0.1e1 + 0.56e-1 * t65 * t66;
  t70 = 0.1e1 / t69;
  t73 = 0.1e1 + 0.46526913586269795717e-2 * t60 * t70;
  t74 = t27 * t73;
  t77 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t74);
  tzk0 = t48 + t77;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t4 * t4;
  t79 = 0.1e1 / t78;
  t80 = t14 * t79;
  t81 = t5 - t80;
  t82 = my_piecewise5(t8, 0, t12, 0, t81);
  t85 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t82);
  t86 = t3 * t85;
  t90 = t25 / t26;
  t91 = t90 * t44;
  t93 = t24 * t91 / 0.3e1;
  t94 = t28 * t28;
  t95 = 0.1e1 / t94;
  t96 = sigma[0] * t95;
  t99 = t40 * t40;
  t100 = 0.1e1 / t99;
  t102 = 0.1e1 / t33 / t28;
  t106 = t31 + 0.1e1;
  t107 = sqrt(t106);
  t108 = 0.1e1 / t107;
  t111 = -0.84e-1 * t32 * t102 * t37 - 0.84e-1 * t96 * t108;
  t112 = t100 * t111;
  t115 = -0.13958074075880938715e-1 * t96 * t41 - 0.46526913586269795717e-2 * t31 * t112;
  t116 = t27 * t115;
  t120 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t86 * t45 - t93 - 0.2e1 / 0.3e1 * t24 * t116);
  t122 = my_piecewise5(t12, 0, t8, 0, -t81);
  t125 = my_piecewise3(t52, 0, 0.3e1 / 0.2e1 * t53 * t122);
  t126 = t3 * t125;
  t129 = t90 * t73;
  t131 = t56 * t129 / 0.3e1;
  t133 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t126 * t74 - t131);
  tvrho0 = t48 + t77 + t4 * (t120 + t133);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t136 = -t5 - t80;
  t137 = my_piecewise5(t8, 0, t12, 0, t136);
  t140 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t137);
  t141 = t3 * t140;
  t145 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t141 * t45 - t93);
  t147 = my_piecewise5(t12, 0, t8, 0, -t136);
  t150 = my_piecewise3(t52, 0, 0.3e1 / 0.2e1 * t53 * t147);
  t151 = t3 * t150;
  t154 = t57 * t57;
  t155 = 0.1e1 / t154;
  t156 = sigma[2] * t155;
  t159 = t69 * t69;
  t160 = 0.1e1 / t159;
  t162 = 0.1e1 / t62 / t57;
  t166 = t60 + 0.1e1;
  t167 = sqrt(t166);
  t168 = 0.1e1 / t167;
  t171 = -0.84e-1 * t61 * t162 * t66 - 0.84e-1 * t156 * t168;
  t172 = t160 * t171;
  t175 = -0.13958074075880938715e-1 * t156 * t70 - 0.46526913586269795717e-2 * t60 * t172;
  t176 = t27 * t175;
  t180 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t151 * t74 - t131 - 0.2e1 / 0.3e1 * t56 * t176);
  tvrho1 = t48 + t77 + t4 * (t145 + t180);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t185 = 0.1e1 / t32;
  t191 = 0.28e-1 * t185 * t35 * t37 + 0.28e-1 * t30 * t108;
  t192 = t100 * t191;
  t195 = 0.46526913586269795717e-2 * t30 * t41 - 0.46526913586269795717e-2 * t31 * t192;
  t196 = t27 * t195;
  t199 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t196);
  tvsigma0 = t4 * t199;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t202 = 0.1e1 / t61;
  t208 = 0.28e-1 * t202 * t64 * t66 + 0.28e-1 * t59 * t168;
  t209 = t160 * t208;
  t212 = 0.46526913586269795717e-2 * t59 * t70 - 0.46526913586269795717e-2 * t60 * t209;
  t213 = t27 * t212;
  t216 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t213);
  tvsigma2 = t4 * t216;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t32, t33, t35, t36, t37;
  double t40, t41, t44, t45, t48, t49, t50, t51;
  double t52, t53, t54, t55, t56, t57, t58, t59;
  double t60, t61, t62, t64, t65, t66, t69, t70;
  double t73, t74, t77, tzk0;

  double t78, t79, t80, t81, t82, t85, t86, t90;
  double t91, t93, t94, t95, t96, t99, t100, t102;
  double t106, t107, t108, t111, t112, t115, t116, t120;
  double t122, t125, t126, t129, t131, t133, tvrho0, t136;
  double t137, t140, t141, t145, t147, t150, t151, t154;
  double t155, t156, t159, t160, t162, t166, t167, t168;
  double t171, t172, t175, t176, t180, tvrho1, t185, t191;
  double t192, t195, t196, t199, tvsigma0, tvsigma1, t202, t208;
  double t209, t212, t213, t216, tvsigma2;

  double t219, t220, t223, t224, t225, t227, t228, t232;
  double t233, t236, t242, t243, t245, t246, t247, t249;
  double t250, t251, t257, t258, t259, t263, t269, t270;
  double t271, t274, t277, t278, t281, t282, t286, t287;
  double t288, t292, t296, t297, t300, t302, t304, t306;
  double tv2rho20, t309, t312, t313, t317, t318, t321, t328;
  double t329, t332, t336, t337, t340, t345, t346, t349;
  double tv2rho21, t354, t358, t359, t363, t364, t369, t370;
  double t374, t378, t379, t386, t387, t388, t394, t395;
  double t396, t400, t406, t407, t408, t411, t414, t415;
  double t418, t419, t423, tv2rho22, t428, t430, t433, t438;
  double t439, t447, t448, t449, t452, t453, t456, t457;
  double t461, tv2rhosigma0, tv2rhosigma1, t465, t467, t469, tv2rhosigma2, t474;
  double tv2rhosigma3, tv2rhosigma4, t480, t485, t486, t494, t495, t496;
  double t499, t500, t503, t504, t508, tv2rhosigma5, t512, t513;
  double t517, t521, t525, t526, t529, t530, t533, t534;
  double t537, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t540, t541;
  double t545, t549, t553, t554, t557, t558, t561, t562;
  double t565, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t32 = sqrt(sigma[0]);
  t33 = sqrt(rho[0]);
  t35 = 0.1e1 / t33 / rho[0];
  t36 = t32 * t35;
  t37 = log(t36 + sqrt(t36 * t36 + 0.1e1));
  t40 = 0.1e1 + 0.56e-1 * t36 * t37;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 + 0.46526913586269795717e-2 * t31 * t41;
  t45 = t27 * t44;
  t48 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t45);
  t49 = rho[1] <= p->dens_threshold;
  t50 = my_piecewise5(t12, t9, t8, t13, -t15);
  t51 = 0.1e1 + t50;
  t52 = t51 <= p->zeta_threshold;
  t53 = sqrt(t51);
  t54 = t53 * t51;
  t55 = my_piecewise3(t52, t20, t54);
  t56 = t3 * t55;
  t57 = rho[1] * rho[1];
  t58 = t57 * rho[1];
  t59 = 0.1e1 / t58;
  t60 = sigma[2] * t59;
  t61 = sqrt(sigma[2]);
  t62 = sqrt(rho[1]);
  t64 = 0.1e1 / t62 / rho[1];
  t65 = t61 * t64;
  t66 = log(t65 + sqrt(t65 * t65 + 0.1e1));
  t69 = 0.1e1 + 0.56e-1 * t65 * t66;
  t70 = 0.1e1 / t69;
  t73 = 0.1e1 + 0.46526913586269795717e-2 * t60 * t70;
  t74 = t27 * t73;
  t77 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t74);
  tzk0 = t48 + t77;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t4 * t4;
  t79 = 0.1e1 / t78;
  t80 = t14 * t79;
  t81 = t5 - t80;
  t82 = my_piecewise5(t8, 0, t12, 0, t81);
  t85 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t82);
  t86 = t3 * t85;
  t90 = t25 / t26;
  t91 = t90 * t44;
  t93 = t24 * t91 / 0.3e1;
  t94 = t28 * t28;
  t95 = 0.1e1 / t94;
  t96 = sigma[0] * t95;
  t99 = t40 * t40;
  t100 = 0.1e1 / t99;
  t102 = 0.1e1 / t33 / t28;
  t106 = t31 + 0.1e1;
  t107 = sqrt(t106);
  t108 = 0.1e1 / t107;
  t111 = -0.84e-1 * t32 * t102 * t37 - 0.84e-1 * t96 * t108;
  t112 = t100 * t111;
  t115 = -0.13958074075880938715e-1 * t96 * t41 - 0.46526913586269795717e-2 * t31 * t112;
  t116 = t27 * t115;
  t120 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t86 * t45 - t93 - 0.2e1 / 0.3e1 * t24 * t116);
  t122 = my_piecewise5(t12, 0, t8, 0, -t81);
  t125 = my_piecewise3(t52, 0, 0.3e1 / 0.2e1 * t53 * t122);
  t126 = t3 * t125;
  t129 = t90 * t73;
  t131 = t56 * t129 / 0.3e1;
  t133 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t126 * t74 - t131);
  tvrho0 = t48 + t77 + t4 * (t120 + t133);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t136 = -t5 - t80;
  t137 = my_piecewise5(t8, 0, t12, 0, t136);
  t140 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t137);
  t141 = t3 * t140;
  t145 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t141 * t45 - t93);
  t147 = my_piecewise5(t12, 0, t8, 0, -t136);
  t150 = my_piecewise3(t52, 0, 0.3e1 / 0.2e1 * t53 * t147);
  t151 = t3 * t150;
  t154 = t57 * t57;
  t155 = 0.1e1 / t154;
  t156 = sigma[2] * t155;
  t159 = t69 * t69;
  t160 = 0.1e1 / t159;
  t162 = 0.1e1 / t62 / t57;
  t166 = t60 + 0.1e1;
  t167 = sqrt(t166);
  t168 = 0.1e1 / t167;
  t171 = -0.84e-1 * t61 * t162 * t66 - 0.84e-1 * t156 * t168;
  t172 = t160 * t171;
  t175 = -0.13958074075880938715e-1 * t156 * t70 - 0.46526913586269795717e-2 * t60 * t172;
  t176 = t27 * t175;
  t180 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t151 * t74 - t131 - 0.2e1 / 0.3e1 * t56 * t176);
  tvrho1 = t48 + t77 + t4 * (t145 + t180);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t185 = 0.1e1 / t32;
  t191 = 0.28e-1 * t185 * t35 * t37 + 0.28e-1 * t30 * t108;
  t192 = t100 * t191;
  t195 = 0.46526913586269795717e-2 * t30 * t41 - 0.46526913586269795717e-2 * t31 * t192;
  t196 = t27 * t195;
  t199 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t196);
  tvsigma0 = t4 * t199;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t202 = 0.1e1 / t61;
  t208 = 0.28e-1 * t202 * t64 * t66 + 0.28e-1 * t59 * t168;
  t209 = t160 * t208;
  t212 = 0.46526913586269795717e-2 * t59 * t70 - 0.46526913586269795717e-2 * t60 * t209;
  t213 = t27 * t212;
  t216 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t213);
  tvsigma2 = t4 * t216;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t219 = 0.1e1 / t21;
  t220 = t82 * t82;
  t223 = t78 * t4;
  t224 = 0.1e1 / t223;
  t225 = t14 * t224;
  t227 = -0.2e1 * t79 + 0.2e1 * t225;
  t228 = my_piecewise5(t8, 0, t12, 0, t227);
  t232 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t219 * t220 + 0.3e1 / 0.2e1 * t21 * t228);
  t233 = t3 * t232;
  t236 = t86 * t91;
  t242 = t25 / t26 / t4;
  t243 = t242 * t44;
  t245 = t24 * t243 / 0.6e1;
  t246 = t90 * t115;
  t247 = t24 * t246;
  t249 = t94 * rho[0];
  t250 = 0.1e1 / t249;
  t251 = sigma[0] * t250;
  t257 = 0.1e1 / t99 / t40;
  t258 = t111 * t111;
  t259 = t257 * t258;
  t263 = 0.1e1 / t33 / t29;
  t269 = sigma[0] * sigma[0];
  t270 = t94 * t94;
  t271 = 0.1e1 / t270;
  t274 = 0.1e1 / t107 / t106;
  t277 = 0.21e0 * t32 * t263 * t37 + 0.462e0 * t251 * t108 - 0.126e0 * t269 * t271 * t274;
  t278 = t100 * t277;
  t281 = 0.5583229630352375486e-1 * t251 * t41 + 0.2791614815176187743e-1 * t96 * t112 + 0.93053827172539591434e-2 * t31 * t259 - 0.46526913586269795717e-2 * t31 * t278;
  t282 = t27 * t281;
  t286 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t233 * t45 - 0.2e1 / 0.3e1 * t236 - 0.4e1 / 0.3e1 * t86 * t116 + t245 - 0.2e1 / 0.3e1 * t247 - 0.2e1 / 0.3e1 * t24 * t282);
  t287 = 0.1e1 / t53;
  t288 = t122 * t122;
  t292 = my_piecewise5(t12, 0, t8, 0, -t227);
  t296 = my_piecewise3(t52, 0, 0.3e1 / 0.4e1 * t287 * t288 + 0.3e1 / 0.2e1 * t53 * t292);
  t297 = t3 * t296;
  t300 = t126 * t129;
  t302 = t242 * t73;
  t304 = t56 * t302 / 0.6e1;
  t306 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t297 * t74 - 0.2e1 / 0.3e1 * t300 + t304);
  tv2rho20 = 0.2e1 * t120 + 0.2e1 * t133 + t4 * (t286 + t306);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t309 = t219 * t137;
  t312 = 0.2e1 * t225;
  t313 = my_piecewise5(t8, 0, t12, 0, t312);
  t317 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t309 * t82 + 0.3e1 / 0.2e1 * t21 * t313);
  t318 = t3 * t317;
  t321 = t141 * t91;
  t328 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t318 * t45 - t321 / 0.3e1 - 0.2e1 / 0.3e1 * t141 * t116 - t236 / 0.3e1 + t245 - t247 / 0.3e1);
  t329 = t287 * t147;
  t332 = my_piecewise5(t12, 0, t8, 0, -t312);
  t336 = my_piecewise3(t52, 0, 0.3e1 / 0.4e1 * t329 * t122 + 0.3e1 / 0.2e1 * t53 * t332);
  t337 = t3 * t336;
  t340 = t151 * t129;
  t345 = t90 * t175;
  t346 = t56 * t345;
  t349 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t337 * t74 - t340 / 0.3e1 - t300 / 0.3e1 + t304 - 0.2e1 / 0.3e1 * t126 * t176 - t346 / 0.3e1);
  tv2rho21 = t120 + t133 + t145 + t180 + t4 * (t328 + t349);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t354 = t137 * t137;
  t358 = 0.2e1 * t79 + 0.2e1 * t225;
  t359 = my_piecewise5(t8, 0, t12, 0, t358);
  t363 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t219 * t354 + 0.3e1 / 0.2e1 * t21 * t359);
  t364 = t3 * t363;
  t369 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t364 * t45 - 0.2e1 / 0.3e1 * t321 + t245);
  t370 = t147 * t147;
  t374 = my_piecewise5(t12, 0, t8, 0, -t358);
  t378 = my_piecewise3(t52, 0, 0.3e1 / 0.4e1 * t287 * t370 + 0.3e1 / 0.2e1 * t53 * t374);
  t379 = t3 * t378;
  t386 = t154 * rho[1];
  t387 = 0.1e1 / t386;
  t388 = sigma[2] * t387;
  t394 = 0.1e1 / t159 / t69;
  t395 = t171 * t171;
  t396 = t394 * t395;
  t400 = 0.1e1 / t62 / t58;
  t406 = sigma[2] * sigma[2];
  t407 = t154 * t154;
  t408 = 0.1e1 / t407;
  t411 = 0.1e1 / t167 / t166;
  t414 = 0.21e0 * t61 * t400 * t66 + 0.462e0 * t388 * t168 - 0.126e0 * t406 * t408 * t411;
  t415 = t160 * t414;
  t418 = 0.5583229630352375486e-1 * t388 * t70 + 0.2791614815176187743e-1 * t156 * t172 + 0.93053827172539591434e-2 * t60 * t396 - 0.46526913586269795717e-2 * t60 * t415;
  t419 = t27 * t418;
  t423 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t379 * t74 - 0.2e1 / 0.3e1 * t340 - 0.4e1 / 0.3e1 * t151 * t176 + t304 - 0.2e1 / 0.3e1 * t346 - 0.2e1 / 0.3e1 * t56 * t419);
  tv2rho22 = 0.2e1 * t145 + 0.2e1 * t180 + t4 * (t369 + t423);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t428 = t90 * t195;
  t430 = t24 * t428 / 0.3e1;
  t433 = t30 * t100;
  t438 = t257 * t191;
  t439 = t438 * t111;
  t447 = t94 * t29;
  t448 = 0.1e1 / t447;
  t449 = t448 * t274;
  t452 = -0.42e-1 * t185 * t102 * t37 - 0.126e0 * t95 * t108 + 0.42e-1 * t449 * sigma[0];
  t453 = t100 * t452;
  t456 = -0.13958074075880938715e-1 * t95 * t41 - 0.46526913586269795717e-2 * t433 * t111 + 0.13958074075880938715e-1 * t96 * t192 + 0.93053827172539591434e-2 * t31 * t439 - 0.46526913586269795717e-2 * t31 * t453;
  t457 = t27 * t456;
  t461 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t86 * t196 - t430 - 0.2e1 / 0.3e1 * t24 * t457);
  tv2rhosigma0 = t4 * t461 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t465 = t90 * t212;
  t467 = t56 * t465 / 0.3e1;
  t469 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t126 * t213 - t467);
  tv2rhosigma2 = t4 * t469 + t216;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t474 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t141 * t196 - t430);
  tv2rhosigma3 = t4 * t474 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t480 = t59 * t160;
  t485 = t394 * t208;
  t486 = t485 * t171;
  t494 = t154 * t58;
  t495 = 0.1e1 / t494;
  t496 = t495 * t411;
  t499 = -0.42e-1 * t202 * t162 * t66 - 0.126e0 * t155 * t168 + 0.42e-1 * t496 * sigma[2];
  t500 = t160 * t499;
  t503 = -0.13958074075880938715e-1 * t155 * t70 - 0.46526913586269795717e-2 * t480 * t171 + 0.13958074075880938715e-1 * t156 * t209 + 0.93053827172539591434e-2 * t60 * t486 - 0.46526913586269795717e-2 * t60 * t500;
  t504 = t27 * t503;
  t508 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t151 * t213 - t467 - 0.2e1 / 0.3e1 * t56 * t504);
  tv2rhosigma5 = t4 * t508 + t216;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t512 = t191 * t191;
  t513 = t257 * t512;
  t517 = 0.1e1 / t32 / sigma[0];
  t521 = 0.1e1 / sigma[0];
  t525 = t94 * t28;
  t526 = 0.1e1 / t525;
  t529 = -0.14e-1 * t517 * t35 * t37 + 0.14e-1 * t521 * t30 * t108 - 0.14e-1 * t526 * t274;
  t530 = t100 * t529;
  t533 = -0.93053827172539591434e-2 * t433 * t191 + 0.93053827172539591434e-2 * t31 * t513 - 0.46526913586269795717e-2 * t31 * t530;
  t534 = t27 * t533;
  t537 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t534);
  tv2sigma20 = t4 * t537;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t540 = t208 * t208;
  t541 = t394 * t540;
  t545 = 0.1e1 / t61 / sigma[2];
  t549 = 0.1e1 / sigma[2];
  t553 = t154 * t57;
  t554 = 0.1e1 / t553;
  t557 = -0.14e-1 * t545 * t64 * t66 + 0.14e-1 * t549 * t59 * t168 - 0.14e-1 * t554 * t411;
  t558 = t160 * t557;
  t561 = -0.93053827172539591434e-2 * t480 * t208 + 0.93053827172539591434e-2 * t60 * t541 - 0.46526913586269795717e-2 * t60 * t558;
  t562 = t27 * t561;
  t565 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t562);
  tv2sigma25 = t4 * t565;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t32, t33, t35, t36, t37;
  double t40, t41, t44, t45, t48, t49, t50, t51;
  double t52, t53, t54, t55, t56, t57, t58, t59;
  double t60, t61, t62, t64, t65, t66, t69, t70;
  double t73, t74, t77, tzk0;

  double t78, t79, t80, t81, t82, t85, t86, t90;
  double t91, t93, t94, t95, t96, t99, t100, t102;
  double t106, t107, t108, t111, t112, t115, t116, t120;
  double t122, t125, t126, t129, t131, t133, tvrho0, t136;
  double t137, t140, t141, t145, t147, t150, t151, t154;
  double t155, t156, t159, t160, t162, t166, t167, t168;
  double t171, t172, t175, t176, t180, tvrho1, t185, t191;
  double t192, t195, t196, t199, tvsigma0, tvsigma1, t202, t208;
  double t209, t212, t213, t216, tvsigma2;

  double t219, t220, t223, t224, t225, t227, t228, t232;
  double t233, t236, t242, t243, t245, t246, t247, t249;
  double t250, t251, t257, t258, t259, t263, t269, t270;
  double t271, t274, t277, t278, t281, t282, t286, t287;
  double t288, t292, t296, t297, t300, t302, t304, t306;
  double tv2rho20, t309, t312, t313, t317, t318, t321, t328;
  double t329, t332, t336, t337, t340, t345, t346, t349;
  double tv2rho21, t354, t358, t359, t363, t364, t369, t370;
  double t374, t378, t379, t386, t387, t388, t394, t395;
  double t396, t400, t406, t407, t408, t411, t414, t415;
  double t418, t419, t423, tv2rho22, t428, t430, t433, t438;
  double t439, t447, t448, t449, t452, t453, t456, t457;
  double t461, tv2rhosigma0, tv2rhosigma1, t465, t467, t469, tv2rhosigma2, t474;
  double tv2rhosigma3, tv2rhosigma4, t480, t485, t486, t494, t495, t496;
  double t499, t500, t503, t504, t508, tv2rhosigma5, t512, t513;
  double t517, t521, t525, t526, t529, t530, t533, t534;
  double t537, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t540, t541;
  double t545, t549, t553, t554, t557, t558, t561, t562;
  double t565, tv2sigma25;

  double t568, t569, t572, t575, t576, t577, t579, t580;
  double t584, t585, t588, t591, t593, t599, t600, t602;
  double t603, t604, t606, t607, t608, t617, t618, t619;
  double t620, t623, t624, t628, t635, t639, t641, t643;
  double t645, t648, t649, t652, t653, t657, t658, t659;
  double t662, t666, t670, t671, t674, t675, t677, t679;
  double t681, tv3rho30, t684, t685, t686, t689, t694, t695;
  double t696, t697, t701, t702, t706, t709, t712, t720;
  double t721, t722, t725, t731, t735, t736, t740, t741;
  double t748, t749, t750, t753, tv3rho31, t756, t761, t764;
  double t765, t769, t770, t773, t781, t782, t787, t791;
  double t795, t796, t799, t804, t810, t811, t813, t814;
  double tv3rho32, t819, t825, t826, t830, t831, t836, t837;
  double t843, t847, t848, t858, t867, t868, t869, t870;
  double t873, t874, t878, t885, t889, t891, t893, t895;
  double t898, t899, t902, t903, t907, tv3rho33, t913, t917;
  double t919, t920, t921, t925, t928, t940, t943, t944;
  double t947, t955, t960, t963, t964, t967, t968, t972;
  double tv3rho2sigma0, tv3rho2sigma1, t977, t979, t981, t983, tv3rho2sigma2, t987;
  double t994, tv3rho2sigma3, tv3rho2sigma4, t998, t1003, t1004, t1007, tv3rho2sigma5;
  double t1014, tv3rho2sigma6, tv3rho2sigma7, t1025, t1028, t1040, t1043, t1044;
  double t1047, t1055, t1060, t1063, t1064, t1067, t1068, t1072;
  double tv3rho2sigma8, t1076, t1078, t1081, t1088, t1089, t1092, t1097;
  double t1098, t1109, t1110, t1113, t1114, t1117, t1118, t1122;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1126, t1128, t1130;
  double tv3rhosigma25, t1135, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1141;
  double t1148, t1149, t1152, t1157, t1158, t1169, t1170, t1173;
  double t1174, t1177, t1178, t1182, tv3rhosigma211, t1188, t1189, t1192;
  double t1196, t1200, t1209, t1210, t1213, t1214, t1217, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t1222, t1223, t1226, t1230, t1234, t1243, t1244, t1247;
  double t1248, t1251, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t32 = sqrt(sigma[0]);
  t33 = sqrt(rho[0]);
  t35 = 0.1e1 / t33 / rho[0];
  t36 = t32 * t35;
  t37 = log(t36 + sqrt(t36 * t36 + 0.1e1));
  t40 = 0.1e1 + 0.56e-1 * t36 * t37;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 + 0.46526913586269795717e-2 * t31 * t41;
  t45 = t27 * t44;
  t48 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t45);
  t49 = rho[1] <= p->dens_threshold;
  t50 = my_piecewise5(t12, t9, t8, t13, -t15);
  t51 = 0.1e1 + t50;
  t52 = t51 <= p->zeta_threshold;
  t53 = sqrt(t51);
  t54 = t53 * t51;
  t55 = my_piecewise3(t52, t20, t54);
  t56 = t3 * t55;
  t57 = rho[1] * rho[1];
  t58 = t57 * rho[1];
  t59 = 0.1e1 / t58;
  t60 = sigma[2] * t59;
  t61 = sqrt(sigma[2]);
  t62 = sqrt(rho[1]);
  t64 = 0.1e1 / t62 / rho[1];
  t65 = t61 * t64;
  t66 = log(t65 + sqrt(t65 * t65 + 0.1e1));
  t69 = 0.1e1 + 0.56e-1 * t65 * t66;
  t70 = 0.1e1 / t69;
  t73 = 0.1e1 + 0.46526913586269795717e-2 * t60 * t70;
  t74 = t27 * t73;
  t77 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t74);
  tzk0 = t48 + t77;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t4 * t4;
  t79 = 0.1e1 / t78;
  t80 = t14 * t79;
  t81 = t5 - t80;
  t82 = my_piecewise5(t8, 0, t12, 0, t81);
  t85 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t82);
  t86 = t3 * t85;
  t90 = t25 / t26;
  t91 = t90 * t44;
  t93 = t24 * t91 / 0.3e1;
  t94 = t28 * t28;
  t95 = 0.1e1 / t94;
  t96 = sigma[0] * t95;
  t99 = t40 * t40;
  t100 = 0.1e1 / t99;
  t102 = 0.1e1 / t33 / t28;
  t106 = t31 + 0.1e1;
  t107 = sqrt(t106);
  t108 = 0.1e1 / t107;
  t111 = -0.84e-1 * t32 * t102 * t37 - 0.84e-1 * t96 * t108;
  t112 = t100 * t111;
  t115 = -0.13958074075880938715e-1 * t96 * t41 - 0.46526913586269795717e-2 * t31 * t112;
  t116 = t27 * t115;
  t120 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t86 * t45 - t93 - 0.2e1 / 0.3e1 * t24 * t116);
  t122 = my_piecewise5(t12, 0, t8, 0, -t81);
  t125 = my_piecewise3(t52, 0, 0.3e1 / 0.2e1 * t53 * t122);
  t126 = t3 * t125;
  t129 = t90 * t73;
  t131 = t56 * t129 / 0.3e1;
  t133 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t126 * t74 - t131);
  tvrho0 = t48 + t77 + t4 * (t120 + t133);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t136 = -t5 - t80;
  t137 = my_piecewise5(t8, 0, t12, 0, t136);
  t140 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t137);
  t141 = t3 * t140;
  t145 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t141 * t45 - t93);
  t147 = my_piecewise5(t12, 0, t8, 0, -t136);
  t150 = my_piecewise3(t52, 0, 0.3e1 / 0.2e1 * t53 * t147);
  t151 = t3 * t150;
  t154 = t57 * t57;
  t155 = 0.1e1 / t154;
  t156 = sigma[2] * t155;
  t159 = t69 * t69;
  t160 = 0.1e1 / t159;
  t162 = 0.1e1 / t62 / t57;
  t166 = t60 + 0.1e1;
  t167 = sqrt(t166);
  t168 = 0.1e1 / t167;
  t171 = -0.84e-1 * t61 * t162 * t66 - 0.84e-1 * t156 * t168;
  t172 = t160 * t171;
  t175 = -0.13958074075880938715e-1 * t156 * t70 - 0.46526913586269795717e-2 * t60 * t172;
  t176 = t27 * t175;
  t180 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t151 * t74 - t131 - 0.2e1 / 0.3e1 * t56 * t176);
  tvrho1 = t48 + t77 + t4 * (t145 + t180);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t185 = 0.1e1 / t32;
  t191 = 0.28e-1 * t185 * t35 * t37 + 0.28e-1 * t30 * t108;
  t192 = t100 * t191;
  t195 = 0.46526913586269795717e-2 * t30 * t41 - 0.46526913586269795717e-2 * t31 * t192;
  t196 = t27 * t195;
  t199 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t196);
  tvsigma0 = t4 * t199;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t202 = 0.1e1 / t61;
  t208 = 0.28e-1 * t202 * t64 * t66 + 0.28e-1 * t59 * t168;
  t209 = t160 * t208;
  t212 = 0.46526913586269795717e-2 * t59 * t70 - 0.46526913586269795717e-2 * t60 * t209;
  t213 = t27 * t212;
  t216 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t213);
  tvsigma2 = t4 * t216;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t219 = 0.1e1 / t21;
  t220 = t82 * t82;
  t223 = t78 * t4;
  t224 = 0.1e1 / t223;
  t225 = t14 * t224;
  t227 = -0.2e1 * t79 + 0.2e1 * t225;
  t228 = my_piecewise5(t8, 0, t12, 0, t227);
  t232 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t219 * t220 + 0.3e1 / 0.2e1 * t21 * t228);
  t233 = t3 * t232;
  t236 = t86 * t91;
  t242 = t25 / t26 / t4;
  t243 = t242 * t44;
  t245 = t24 * t243 / 0.6e1;
  t246 = t90 * t115;
  t247 = t24 * t246;
  t249 = t94 * rho[0];
  t250 = 0.1e1 / t249;
  t251 = sigma[0] * t250;
  t257 = 0.1e1 / t99 / t40;
  t258 = t111 * t111;
  t259 = t257 * t258;
  t263 = 0.1e1 / t33 / t29;
  t269 = sigma[0] * sigma[0];
  t270 = t94 * t94;
  t271 = 0.1e1 / t270;
  t274 = 0.1e1 / t107 / t106;
  t277 = 0.21e0 * t32 * t263 * t37 + 0.462e0 * t251 * t108 - 0.126e0 * t269 * t271 * t274;
  t278 = t100 * t277;
  t281 = 0.5583229630352375486e-1 * t251 * t41 + 0.2791614815176187743e-1 * t96 * t112 + 0.93053827172539591434e-2 * t31 * t259 - 0.46526913586269795717e-2 * t31 * t278;
  t282 = t27 * t281;
  t286 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t233 * t45 - 0.2e1 / 0.3e1 * t236 - 0.4e1 / 0.3e1 * t86 * t116 + t245 - 0.2e1 / 0.3e1 * t247 - 0.2e1 / 0.3e1 * t24 * t282);
  t287 = 0.1e1 / t53;
  t288 = t122 * t122;
  t292 = my_piecewise5(t12, 0, t8, 0, -t227);
  t296 = my_piecewise3(t52, 0, 0.3e1 / 0.4e1 * t287 * t288 + 0.3e1 / 0.2e1 * t53 * t292);
  t297 = t3 * t296;
  t300 = t126 * t129;
  t302 = t242 * t73;
  t304 = t56 * t302 / 0.6e1;
  t306 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t297 * t74 - 0.2e1 / 0.3e1 * t300 + t304);
  tv2rho20 = 0.2e1 * t120 + 0.2e1 * t133 + t4 * (t286 + t306);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t309 = t219 * t137;
  t312 = 0.2e1 * t225;
  t313 = my_piecewise5(t8, 0, t12, 0, t312);
  t317 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t309 * t82 + 0.3e1 / 0.2e1 * t21 * t313);
  t318 = t3 * t317;
  t321 = t141 * t91;
  t328 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t318 * t45 - t321 / 0.3e1 - 0.2e1 / 0.3e1 * t141 * t116 - t236 / 0.3e1 + t245 - t247 / 0.3e1);
  t329 = t287 * t147;
  t332 = my_piecewise5(t12, 0, t8, 0, -t312);
  t336 = my_piecewise3(t52, 0, 0.3e1 / 0.4e1 * t329 * t122 + 0.3e1 / 0.2e1 * t53 * t332);
  t337 = t3 * t336;
  t340 = t151 * t129;
  t345 = t90 * t175;
  t346 = t56 * t345;
  t349 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t337 * t74 - t340 / 0.3e1 - t300 / 0.3e1 + t304 - 0.2e1 / 0.3e1 * t126 * t176 - t346 / 0.3e1);
  tv2rho21 = t120 + t133 + t145 + t180 + t4 * (t328 + t349);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t354 = t137 * t137;
  t358 = 0.2e1 * t79 + 0.2e1 * t225;
  t359 = my_piecewise5(t8, 0, t12, 0, t358);
  t363 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t219 * t354 + 0.3e1 / 0.2e1 * t21 * t359);
  t364 = t3 * t363;
  t369 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t364 * t45 - 0.2e1 / 0.3e1 * t321 + t245);
  t370 = t147 * t147;
  t374 = my_piecewise5(t12, 0, t8, 0, -t358);
  t378 = my_piecewise3(t52, 0, 0.3e1 / 0.4e1 * t287 * t370 + 0.3e1 / 0.2e1 * t53 * t374);
  t379 = t3 * t378;
  t386 = t154 * rho[1];
  t387 = 0.1e1 / t386;
  t388 = sigma[2] * t387;
  t394 = 0.1e1 / t159 / t69;
  t395 = t171 * t171;
  t396 = t394 * t395;
  t400 = 0.1e1 / t62 / t58;
  t406 = sigma[2] * sigma[2];
  t407 = t154 * t154;
  t408 = 0.1e1 / t407;
  t411 = 0.1e1 / t167 / t166;
  t414 = 0.21e0 * t61 * t400 * t66 + 0.462e0 * t388 * t168 - 0.126e0 * t406 * t408 * t411;
  t415 = t160 * t414;
  t418 = 0.5583229630352375486e-1 * t388 * t70 + 0.2791614815176187743e-1 * t156 * t172 + 0.93053827172539591434e-2 * t60 * t396 - 0.46526913586269795717e-2 * t60 * t415;
  t419 = t27 * t418;
  t423 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t379 * t74 - 0.2e1 / 0.3e1 * t340 - 0.4e1 / 0.3e1 * t151 * t176 + t304 - 0.2e1 / 0.3e1 * t346 - 0.2e1 / 0.3e1 * t56 * t419);
  tv2rho22 = 0.2e1 * t145 + 0.2e1 * t180 + t4 * (t369 + t423);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t428 = t90 * t195;
  t430 = t24 * t428 / 0.3e1;
  t433 = t30 * t100;
  t438 = t257 * t191;
  t439 = t438 * t111;
  t447 = t94 * t29;
  t448 = 0.1e1 / t447;
  t449 = t448 * t274;
  t452 = -0.42e-1 * t185 * t102 * t37 - 0.126e0 * t95 * t108 + 0.42e-1 * t449 * sigma[0];
  t453 = t100 * t452;
  t456 = -0.13958074075880938715e-1 * t95 * t41 - 0.46526913586269795717e-2 * t433 * t111 + 0.13958074075880938715e-1 * t96 * t192 + 0.93053827172539591434e-2 * t31 * t439 - 0.46526913586269795717e-2 * t31 * t453;
  t457 = t27 * t456;
  t461 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t86 * t196 - t430 - 0.2e1 / 0.3e1 * t24 * t457);
  tv2rhosigma0 = t4 * t461 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t465 = t90 * t212;
  t467 = t56 * t465 / 0.3e1;
  t469 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t126 * t213 - t467);
  tv2rhosigma2 = t4 * t469 + t216;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t474 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t141 * t196 - t430);
  tv2rhosigma3 = t4 * t474 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t480 = t59 * t160;
  t485 = t394 * t208;
  t486 = t485 * t171;
  t494 = t154 * t58;
  t495 = 0.1e1 / t494;
  t496 = t495 * t411;
  t499 = -0.42e-1 * t202 * t162 * t66 - 0.126e0 * t155 * t168 + 0.42e-1 * t496 * sigma[2];
  t500 = t160 * t499;
  t503 = -0.13958074075880938715e-1 * t155 * t70 - 0.46526913586269795717e-2 * t480 * t171 + 0.13958074075880938715e-1 * t156 * t209 + 0.93053827172539591434e-2 * t60 * t486 - 0.46526913586269795717e-2 * t60 * t500;
  t504 = t27 * t503;
  t508 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t151 * t213 - t467 - 0.2e1 / 0.3e1 * t56 * t504);
  tv2rhosigma5 = t4 * t508 + t216;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t512 = t191 * t191;
  t513 = t257 * t512;
  t517 = 0.1e1 / t32 / sigma[0];
  t521 = 0.1e1 / sigma[0];
  t525 = t94 * t28;
  t526 = 0.1e1 / t525;
  t529 = -0.14e-1 * t517 * t35 * t37 + 0.14e-1 * t521 * t30 * t108 - 0.14e-1 * t526 * t274;
  t530 = t100 * t529;
  t533 = -0.93053827172539591434e-2 * t433 * t191 + 0.93053827172539591434e-2 * t31 * t513 - 0.46526913586269795717e-2 * t31 * t530;
  t534 = t27 * t533;
  t537 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t534);
  tv2sigma20 = t4 * t537;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t540 = t208 * t208;
  t541 = t394 * t540;
  t545 = 0.1e1 / t61 / sigma[2];
  t549 = 0.1e1 / sigma[2];
  t553 = t154 * t57;
  t554 = 0.1e1 / t553;
  t557 = -0.14e-1 * t545 * t64 * t66 + 0.14e-1 * t549 * t59 * t168 - 0.14e-1 * t554 * t411;
  t558 = t160 * t557;
  t561 = -0.93053827172539591434e-2 * t480 * t208 + 0.93053827172539591434e-2 * t60 * t541 - 0.46526913586269795717e-2 * t60 * t558;
  t562 = t27 * t561;
  t565 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t562);
  tv2sigma25 = t4 * t565;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t568 = 0.1e1 / t22;
  t569 = t220 * t82;
  t572 = t219 * t82;
  t575 = t78 * t78;
  t576 = 0.1e1 / t575;
  t577 = t14 * t576;
  t579 = 0.6e1 * t224 - 0.6e1 * t577;
  t580 = my_piecewise5(t8, 0, t12, 0, t579);
  t584 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t568 * t569 + 0.9e1 / 0.4e1 * t572 * t228 + 0.3e1 / 0.2e1 * t21 * t580);
  t585 = t3 * t584;
  t588 = t233 * t91;
  t591 = t86 * t243;
  t593 = t86 * t246;
  t599 = t25 / t26 / t78;
  t600 = t599 * t44;
  t602 = t24 * t600 / 0.4e1;
  t603 = t242 * t115;
  t604 = t24 * t603;
  t606 = t90 * t281;
  t607 = t24 * t606;
  t608 = sigma[0] * t526;
  t617 = t99 * t99;
  t618 = 0.1e1 / t617;
  t619 = t258 * t111;
  t620 = t618 * t619;
  t623 = t257 * t111;
  t624 = t623 * t277;
  t628 = 0.1e1 / t33 / t94;
  t635 = 0.1e1 / t270 / rho[0];
  t639 = t269 * sigma[0];
  t641 = 0.1e1 / t270 / t94;
  t643 = t106 * t106;
  t645 = 0.1e1 / t107 / t643;
  t648 = -0.735e0 * t32 * t628 * t37 - 0.2625e1 * t608 * t108 + 0.1701e1 * t269 * t635 * t274 - 0.567e0 * t639 * t641 * t645;
  t649 = t100 * t648;
  t652 = -0.2791614815176187743e0 * t608 * t41 - 0.16749688891057126458e0 * t251 * t112 - 0.8374844445528563229e-1 * t96 * t259 + 0.41874222227642816145e-1 * t96 * t278 - 0.2791614815176187743e-1 * t31 * t620 + 0.2791614815176187743e-1 * t31 * t624 - 0.46526913586269795717e-2 * t31 * t649;
  t653 = t27 * t652;
  t657 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t585 * t45 - t588 - 0.2e1 * t233 * t116 + t591 / 0.2e1 - 0.2e1 * t593 - 0.2e1 * t86 * t282 - t602 + t604 / 0.2e1 - t607 - 0.2e1 / 0.3e1 * t24 * t653);
  t658 = 0.1e1 / t54;
  t659 = t288 * t122;
  t662 = t287 * t122;
  t666 = my_piecewise5(t12, 0, t8, 0, -t579);
  t670 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t658 * t659 + 0.9e1 / 0.4e1 * t662 * t292 + 0.3e1 / 0.2e1 * t53 * t666);
  t671 = t3 * t670;
  t674 = t297 * t129;
  t675 = t126 * t302;
  t677 = t599 * t73;
  t679 = t56 * t677 / 0.4e1;
  t681 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t671 * t74 - t674 + t675 / 0.2e1 - t679);
  tv3rho30 = 0.3e1 * t286 + 0.3e1 * t306 + t4 * (t657 + t681);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t684 = 0.2e1 * t328;
  t685 = 0.2e1 * t349;
  t686 = t568 * t137;
  t689 = t219 * t313;
  t694 = 0.2e1 * t224;
  t695 = 0.6e1 * t577;
  t696 = t694 - t695;
  t697 = my_piecewise5(t8, 0, t12, 0, t696);
  t701 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t686 * t220 + 0.3e1 / 0.2e1 * t689 * t82 + 0.3e1 / 0.4e1 * t309 * t228 + 0.3e1 / 0.2e1 * t21 * t697);
  t702 = t3 * t701;
  t706 = 0.2e1 / 0.3e1 * t318 * t91;
  t709 = t141 * t243;
  t712 = 0.2e1 / 0.3e1 * t141 * t246;
  t720 = -0.2e1 / 0.3e1 * t702 * t45 - t706 - 0.4e1 / 0.3e1 * t318 * t116 + t709 / 0.6e1 - t712 - 0.2e1 / 0.3e1 * t141 * t282 - t588 / 0.3e1 + t591 / 0.3e1 - 0.2e1 / 0.3e1 * t593 - t602 + t604 / 0.3e1 - t607 / 0.3e1;
  t721 = my_piecewise3(t1, 0, t720);
  t722 = t658 * t147;
  t725 = t287 * t332;
  t731 = my_piecewise5(t12, 0, t8, 0, -t696);
  t735 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t722 * t288 + 0.3e1 / 0.2e1 * t725 * t122 + 0.3e1 / 0.4e1 * t329 * t292 + 0.3e1 / 0.2e1 * t53 * t731);
  t736 = t3 * t735;
  t740 = 0.2e1 / 0.3e1 * t337 * t129;
  t741 = t151 * t302;
  t748 = 0.2e1 / 0.3e1 * t126 * t345;
  t749 = t242 * t175;
  t750 = t56 * t749;
  t753 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t736 * t74 - t740 + t741 / 0.6e1 - t674 / 0.3e1 + t675 / 0.3e1 - t679 - 0.2e1 / 0.3e1 * t297 * t176 - t748 + t750 / 0.6e1);
  tv3rho31 = t286 + t306 + t684 + t685 + t4 * (t721 + t753);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t756 = t568 * t354;
  t761 = t219 * t359;
  t764 = -t694 - t695;
  t765 = my_piecewise5(t8, 0, t12, 0, t764);
  t769 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t756 * t82 + 0.3e1 / 0.2e1 * t309 * t313 + 0.3e1 / 0.4e1 * t761 * t82 + 0.3e1 / 0.2e1 * t21 * t765);
  t770 = t3 * t769;
  t773 = t364 * t91;
  t781 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t770 * t45 - t773 / 0.3e1 - 0.2e1 / 0.3e1 * t364 * t116 - t706 + t709 / 0.3e1 - t712 + t591 / 0.6e1 - t602 + t604 / 0.6e1);
  t782 = t658 * t370;
  t787 = t287 * t374;
  t791 = my_piecewise5(t12, 0, t8, 0, -t764);
  t795 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t782 * t122 + 0.3e1 / 0.2e1 * t329 * t332 + 0.3e1 / 0.4e1 * t787 * t122 + 0.3e1 / 0.2e1 * t53 * t791);
  t796 = t3 * t795;
  t799 = t379 * t129;
  t804 = t151 * t345;
  t810 = t90 * t418;
  t811 = t56 * t810;
  t813 = -0.2e1 / 0.3e1 * t796 * t74 - t799 / 0.3e1 - t740 + t741 / 0.3e1 - 0.4e1 / 0.3e1 * t337 * t176 - 0.2e1 / 0.3e1 * t804 + t675 / 0.6e1 - t679 - t748 + t750 / 0.3e1 - 0.2e1 / 0.3e1 * t126 * t419 - t811 / 0.3e1;
  t814 = my_piecewise3(t49, 0, t813);
  tv3rho32 = t684 + t685 + t369 + t423 + t4 * (t781 + t814);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t819 = t354 * t137;
  t825 = -0.6e1 * t224 - 0.6e1 * t577;
  t826 = my_piecewise5(t8, 0, t12, 0, t825);
  t830 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t568 * t819 + 0.9e1 / 0.4e1 * t309 * t359 + 0.3e1 / 0.2e1 * t21 * t826);
  t831 = t3 * t830;
  t836 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t831 * t45 - t773 + t709 / 0.2e1 - t602);
  t837 = t370 * t147;
  t843 = my_piecewise5(t12, 0, t8, 0, -t825);
  t847 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t658 * t837 + 0.9e1 / 0.4e1 * t329 * t374 + 0.3e1 / 0.2e1 * t53 * t843);
  t848 = t3 * t847;
  t858 = sigma[2] * t554;
  t867 = t159 * t159;
  t868 = 0.1e1 / t867;
  t869 = t395 * t171;
  t870 = t868 * t869;
  t873 = t394 * t171;
  t874 = t873 * t414;
  t878 = 0.1e1 / t62 / t154;
  t885 = 0.1e1 / t407 / rho[1];
  t889 = t406 * sigma[2];
  t891 = 0.1e1 / t407 / t154;
  t893 = t166 * t166;
  t895 = 0.1e1 / t167 / t893;
  t898 = -0.735e0 * t61 * t878 * t66 - 0.2625e1 * t858 * t168 + 0.1701e1 * t406 * t885 * t411 - 0.567e0 * t889 * t891 * t895;
  t899 = t160 * t898;
  t902 = -0.2791614815176187743e0 * t858 * t70 - 0.16749688891057126458e0 * t388 * t172 - 0.8374844445528563229e-1 * t156 * t396 + 0.41874222227642816145e-1 * t156 * t415 - 0.2791614815176187743e-1 * t60 * t870 + 0.2791614815176187743e-1 * t60 * t874 - 0.46526913586269795717e-2 * t60 * t899;
  t903 = t27 * t902;
  t907 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t848 * t74 - t799 - 0.2e1 * t379 * t176 + t741 / 0.2e1 - 0.2e1 * t804 - 0.2e1 * t151 * t419 - t679 + t750 / 0.2e1 - t811 - 0.2e1 / 0.3e1 * t56 * t903);
  tv3rho33 = 0.3e1 * t369 + 0.3e1 * t423 + t4 * (t836 + t907);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t913 = t86 * t428;
  t917 = t242 * t195;
  t919 = t24 * t917 / 0.6e1;
  t920 = t90 * t456;
  t921 = t24 * t920;
  t925 = t95 * t100;
  t928 = t30 * t257;
  t940 = t618 * t191 * t258;
  t943 = t257 * t452;
  t944 = t943 * t111;
  t947 = t438 * t277;
  t955 = t271 * t274;
  t960 = 0.1e1 / t270 / t29 * t645;
  t963 = 0.105e0 * t185 * t263 * t37 + 0.567e0 * t250 * t108 - 0.483e0 * t955 * sigma[0] + 0.189e0 * t960 * t269;
  t964 = t100 * t963;
  t967 = 0.5583229630352375486e-1 * t250 * t41 + 0.2791614815176187743e-1 * t925 * t111 + 0.93053827172539591434e-2 * t928 * t258 - 0.46526913586269795717e-2 * t433 * t277 - 0.5583229630352375486e-1 * t251 * t192 - 0.5583229630352375486e-1 * t96 * t439 + 0.2791614815176187743e-1 * t96 * t453 - 0.2791614815176187743e-1 * t31 * t940 + 0.18610765434507918287e-1 * t31 * t944 + 0.93053827172539591434e-2 * t31 * t947 - 0.46526913586269795717e-2 * t31 * t964;
  t968 = t27 * t967;
  t972 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t233 * t196 - 0.2e1 / 0.3e1 * t913 - 0.4e1 / 0.3e1 * t86 * t457 + t919 - 0.2e1 / 0.3e1 * t921 - 0.2e1 / 0.3e1 * t24 * t968);
  tv3rho2sigma0 = t4 * t972 + 0.2e1 * t461;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t977 = t126 * t465;
  t979 = t242 * t212;
  t981 = t56 * t979 / 0.6e1;
  t983 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t297 * t213 - 0.2e1 / 0.3e1 * t977 + t981);
  tv3rho2sigma2 = t4 * t983 + 0.2e1 * t469;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t987 = t141 * t428;
  t994 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t318 * t196 - t987 / 0.3e1 - 0.2e1 / 0.3e1 * t141 * t457 - t913 / 0.3e1 + t919 - t921 / 0.3e1);
  tv3rho2sigma3 = t4 * t994 + t461 + t474;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t998 = t151 * t465;
  t1003 = t90 * t503;
  t1004 = t56 * t1003;
  t1007 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t337 * t213 - t998 / 0.3e1 - t977 / 0.3e1 + t981 - 0.2e1 / 0.3e1 * t126 * t504 - t1004 / 0.3e1);
  tv3rho2sigma5 = t4 * t1007 + t469 + t508;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1014 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t364 * t196 - 0.2e1 / 0.3e1 * t987 + t919);
  tv3rho2sigma6 = t4 * t1014 + 0.2e1 * t474;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1025 = t155 * t160;
  t1028 = t59 * t394;
  t1040 = t868 * t208 * t395;
  t1043 = t394 * t499;
  t1044 = t1043 * t171;
  t1047 = t485 * t414;
  t1055 = t408 * t411;
  t1060 = 0.1e1 / t407 / t58 * t895;
  t1063 = 0.105e0 * t202 * t400 * t66 + 0.567e0 * t387 * t168 - 0.483e0 * t1055 * sigma[2] + 0.189e0 * t1060 * t406;
  t1064 = t160 * t1063;
  t1067 = 0.5583229630352375486e-1 * t387 * t70 + 0.2791614815176187743e-1 * t1025 * t171 + 0.93053827172539591434e-2 * t1028 * t395 - 0.46526913586269795717e-2 * t480 * t414 - 0.5583229630352375486e-1 * t388 * t209 - 0.5583229630352375486e-1 * t156 * t486 + 0.2791614815176187743e-1 * t156 * t500 - 0.2791614815176187743e-1 * t60 * t1040 + 0.18610765434507918287e-1 * t60 * t1044 + 0.93053827172539591434e-2 * t60 * t1047 - 0.46526913586269795717e-2 * t60 * t1064;
  t1068 = t27 * t1067;
  t1072 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t379 * t213 - 0.2e1 / 0.3e1 * t998 - 0.4e1 / 0.3e1 * t151 * t504 + t981 - 0.2e1 / 0.3e1 * t1004 - 0.2e1 / 0.3e1 * t56 * t1068);
  tv3rho2sigma8 = t4 * t1072 + 0.2e1 * t508;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1076 = t90 * t533;
  t1078 = t24 * t1076 / 0.3e1;
  t1081 = t191 * t111;
  t1088 = t618 * t512;
  t1089 = t1088 * t111;
  t1092 = t438 * t452;
  t1097 = t257 * t529;
  t1098 = t1097 * t111;
  t1109 = 0.1e1 / t270 / t28;
  t1110 = t1109 * t645;
  t1113 = 0.21e-1 * t517 * t102 * t37 - 0.21e-1 * t521 * t95 * t108 + 0.105e0 * t449 - 0.63e-1 * t1110 * sigma[0];
  t1114 = t100 * t1113;
  t1117 = 0.2791614815176187743e-1 * t925 * t191 + 0.18610765434507918287e-1 * t928 * t1081 - 0.93053827172539591434e-2 * t433 * t452 - 0.2791614815176187743e-1 * t96 * t513 - 0.2791614815176187743e-1 * t31 * t1089 + 0.18610765434507918287e-1 * t31 * t1092 + 0.13958074075880938715e-1 * t96 * t530 + 0.93053827172539591434e-2 * t31 * t1098 - 0.46526913586269795717e-2 * t31 * t1114;
  t1118 = t27 * t1117;
  t1122 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t86 * t534 - t1078 - 0.2e1 / 0.3e1 * t24 * t1118);
  tv3rhosigma20 = t4 * t1122 + t537;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1126 = t90 * t561;
  t1128 = t56 * t1126 / 0.3e1;
  t1130 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t126 * t562 - t1128);
  tv3rhosigma25 = t4 * t1130 + t565;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1135 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t141 * t534 - t1078);
  tv3rhosigma26 = t4 * t1135 + t537;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1141 = t208 * t171;
  t1148 = t868 * t540;
  t1149 = t1148 * t171;
  t1152 = t485 * t499;
  t1157 = t394 * t557;
  t1158 = t1157 * t171;
  t1169 = 0.1e1 / t407 / t57;
  t1170 = t1169 * t895;
  t1173 = 0.21e-1 * t545 * t162 * t66 - 0.21e-1 * t549 * t155 * t168 + 0.105e0 * t496 - 0.63e-1 * t1170 * sigma[2];
  t1174 = t160 * t1173;
  t1177 = 0.2791614815176187743e-1 * t1025 * t208 + 0.18610765434507918287e-1 * t1028 * t1141 - 0.93053827172539591434e-2 * t480 * t499 - 0.2791614815176187743e-1 * t156 * t541 - 0.2791614815176187743e-1 * t60 * t1149 + 0.18610765434507918287e-1 * t60 * t1152 + 0.13958074075880938715e-1 * t156 * t558 + 0.93053827172539591434e-2 * t60 * t1158 - 0.46526913586269795717e-2 * t60 * t1174;
  t1178 = t27 * t1177;
  t1182 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t151 * t562 - t1128 - 0.2e1 / 0.3e1 * t56 * t1178);
  tv3rhosigma211 = t4 * t1182 + t565;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1188 = t512 * t191;
  t1189 = t618 * t1188;
  t1192 = t438 * t529;
  t1196 = 0.1e1 / t32 / t269;
  t1200 = 0.1e1 / t269;
  t1209 = 0.21e-1 * t1196 * t35 * t37 - 0.21e-1 * t1200 * t30 * t108 - 0.7e-2 * t521 * t526 * t274 + 0.21e-1 * t635 * t645;
  t1210 = t100 * t1209;
  t1213 = 0.2791614815176187743e-1 * t928 * t512 - 0.13958074075880938715e-1 * t433 * t529 - 0.2791614815176187743e-1 * t31 * t1189 + 0.2791614815176187743e-1 * t31 * t1192 - 0.46526913586269795717e-2 * t31 * t1210;
  t1214 = t27 * t1213;
  t1217 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t1214);
  tv3sigma30 = t4 * t1217;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1222 = t540 * t208;
  t1223 = t868 * t1222;
  t1226 = t485 * t557;
  t1230 = 0.1e1 / t61 / t406;
  t1234 = 0.1e1 / t406;
  t1243 = 0.21e-1 * t1230 * t64 * t66 - 0.21e-1 * t1234 * t59 * t168 - 0.7e-2 * t549 * t554 * t411 + 0.21e-1 * t885 * t895;
  t1244 = t160 * t1243;
  t1247 = 0.2791614815176187743e-1 * t1028 * t540 - 0.13958074075880938715e-1 * t480 * t557 - 0.2791614815176187743e-1 * t60 * t1223 + 0.2791614815176187743e-1 * t60 * t1226 - 0.46526913586269795717e-2 * t60 * t1244;
  t1248 = t27 * t1247;
  t1251 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t1248);
  tv3sigma39 = t4 * t1251;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t32, t33, t35, t36, t37;
  double t40, t41, t44, t45, t48, t49, t50, t51;
  double t52, t53, t54, t55, t56, t57, t58, t59;
  double t60, t61, t62, t64, t65, t66, t69, t70;
  double t73, t74, t77, tzk0;

  double t78, t79, t80, t81, t82, t85, t86, t90;
  double t91, t93, t94, t95, t96, t99, t100, t102;
  double t106, t107, t108, t111, t112, t115, t116, t120;
  double t122, t125, t126, t129, t131, t133, tvrho0, t136;
  double t137, t140, t141, t145, t147, t150, t151, t154;
  double t155, t156, t159, t160, t162, t166, t167, t168;
  double t171, t172, t175, t176, t180, tvrho1, t185, t191;
  double t192, t195, t196, t199, tvsigma0, tvsigma1, t202, t208;
  double t209, t212, t213, t216, tvsigma2;

  double t219, t220, t223, t224, t225, t227, t228, t232;
  double t233, t236, t242, t243, t245, t246, t247, t249;
  double t250, t251, t257, t258, t259, t263, t269, t270;
  double t271, t274, t277, t278, t281, t282, t286, t287;
  double t288, t292, t296, t297, t300, t302, t304, t306;
  double tv2rho20, t309, t312, t313, t317, t318, t321, t328;
  double t329, t332, t336, t337, t340, t345, t346, t349;
  double tv2rho21, t354, t358, t359, t363, t364, t369, t370;
  double t374, t378, t379, t386, t387, t388, t394, t395;
  double t396, t400, t406, t407, t408, t411, t414, t415;
  double t418, t419, t423, tv2rho22, t428, t430, t433, t438;
  double t439, t447, t448, t449, t452, t453, t456, t457;
  double t461, tv2rhosigma0, tv2rhosigma1, t465, t467, t469, tv2rhosigma2, t474;
  double tv2rhosigma3, tv2rhosigma4, t480, t485, t486, t494, t495, t496;
  double t499, t500, t503, t504, t508, tv2rhosigma5, t512, t513;
  double t517, t521, t525, t526, t529, t530, t533, t534;
  double t537, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t540, t541;
  double t545, t549, t553, t554, t557, t558, t561, t562;
  double t565, tv2sigma25;

  double t568, t569, t572, t575, t576, t577, t579, t580;
  double t584, t585, t588, t591, t593, t599, t600, t602;
  double t603, t604, t606, t607, t608, t617, t618, t619;
  double t620, t623, t624, t628, t635, t639, t641, t643;
  double t645, t648, t649, t652, t653, t657, t658, t659;
  double t662, t666, t670, t671, t674, t675, t677, t679;
  double t681, tv3rho30, t684, t685, t686, t689, t694, t695;
  double t696, t697, t701, t702, t706, t709, t712, t720;
  double t721, t722, t725, t731, t735, t736, t740, t741;
  double t748, t749, t750, t753, tv3rho31, t756, t761, t764;
  double t765, t769, t770, t773, t781, t782, t787, t791;
  double t795, t796, t799, t804, t810, t811, t813, t814;
  double tv3rho32, t819, t825, t826, t830, t831, t836, t837;
  double t843, t847, t848, t858, t867, t868, t869, t870;
  double t873, t874, t878, t885, t889, t891, t893, t895;
  double t898, t899, t902, t903, t907, tv3rho33, t913, t917;
  double t919, t920, t921, t925, t928, t940, t943, t944;
  double t947, t955, t960, t963, t964, t967, t968, t972;
  double tv3rho2sigma0, tv3rho2sigma1, t977, t979, t981, t983, tv3rho2sigma2, t987;
  double t994, tv3rho2sigma3, tv3rho2sigma4, t998, t1003, t1004, t1007, tv3rho2sigma5;
  double t1014, tv3rho2sigma6, tv3rho2sigma7, t1025, t1028, t1040, t1043, t1044;
  double t1047, t1055, t1060, t1063, t1064, t1067, t1068, t1072;
  double tv3rho2sigma8, t1076, t1078, t1081, t1088, t1089, t1092, t1097;
  double t1098, t1109, t1110, t1113, t1114, t1117, t1118, t1122;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1126, t1128, t1130;
  double tv3rhosigma25, t1135, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1141;
  double t1148, t1149, t1152, t1157, t1158, t1169, t1170, t1173;
  double t1174, t1177, t1178, t1182, tv3rhosigma211, t1188, t1189, t1192;
  double t1196, t1200, t1209, t1210, t1213, t1214, t1217, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t1222, t1223, t1226, t1230, t1234, t1243, t1244, t1247;
  double t1248, t1251, tv3sigma39;

  double t1256, t1259, t1260, t1261, t1262, t1265, t1267, t1283;
  double t1284, t1292, t1310, t1314, t1315, t1320, t1327, t1331;
  double t1333, t1338, t1340, t1341, t1343, t1344, t1350, t1357;
  double t1359, t1360, t1364, t1370, t1374, t1375, t1376, t1378;
  double t1379, t1385, t1391, t1395, t1399, t1401, t1402, t1405;
  double t1407, tv4rho40, t1412, t1414, t1415, t1416, t1435, t1436;
  double t1437, t1438, t1442, t1448, t1452, t1453, t1454, t1461;
  double t1462, t1480, t1484, t1488, t1489, t1490, t1491, t1498;
  double t1499, t1500, t1502, t1504, t1505, tv4rho41, t1512, t1514;
  double t1527, t1540, t1544, t1550, t1562, t1563, t1572, t1585;
  double t1589, t1593, t1595, t1602, t1604, t1613, t1616, t1618;
  double t1619, tv4rho42, t1639, t1640, t1644, t1648, t1656, t1657;
  double t1674, t1678, t1682, t1687, t1692, t1699, t1701, t1702;
  double tv4rho43, t1707, t1712, t1718, t1719, t1723, t1729, t1730;
  double t1746, t1747, t1755, t1773, t1777, t1778, t1783, t1790;
  double t1796, t1801, t1807, t1811, t1824, t1825, tv4rho44, t1831;
  double t1834, t1836, t1842, t1844, t1847, t1872, t1875, t1883;
  double t1897, t1923, t1929, tv4rho3sigma0, tv4rho3sigma1, t1934, t1935, t1939;
  double t1941, tv4rho3sigma2, t1943, t1947, t1950, t1953, t1961, t1962;
  double tv4rho3sigma3, tv4rho3sigma4, t1964, t1968, t1969, t1976, t1978, t1981;
  double tv4rho3sigma5, t1985, t1993, tv4rho3sigma6, tv4rho3sigma7, t1997, t2002, t2009;
  double t2011, t2012, tv4rho3sigma8, t2019, tv4rho3sigma9, tv4rho3sigma10, t2055, t2069;
  double t2097, t2100, t2106, t2112, tv4rho3sigma11, t2117, t2123, t2125;
  double t2157, t2172, t2203, t2209, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t2214, t2218, t2220, tv4rho2sigma25, t2224, t2231, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t2235, t2241, t2244, tv4rho2sigma211;
  double t2251, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t2305, t2332;
  double t2336, t2342, tv4rho2sigma217, t2348, t2375, t2408, t2413, tv4rhosigma30;
  double tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38;
  double t2419, t2421, tv4rhosigma39, t2426, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313;
  double tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t2456, t2489, t2494;
  double tv4rhosigma319, t2502, t2509, t2541, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43;
  double tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411;
  double tv4sigma412, tv4sigma413, t2548, t2555, t2587, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t32 = sqrt(sigma[0]);
  t33 = sqrt(rho[0]);
  t35 = 0.1e1 / t33 / rho[0];
  t36 = t32 * t35;
  t37 = log(t36 + sqrt(t36 * t36 + 0.1e1));
  t40 = 0.1e1 + 0.56e-1 * t36 * t37;
  t41 = 0.1e1 / t40;
  t44 = 0.1e1 + 0.46526913586269795717e-2 * t31 * t41;
  t45 = t27 * t44;
  t48 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t45);
  t49 = rho[1] <= p->dens_threshold;
  t50 = my_piecewise5(t12, t9, t8, t13, -t15);
  t51 = 0.1e1 + t50;
  t52 = t51 <= p->zeta_threshold;
  t53 = sqrt(t51);
  t54 = t53 * t51;
  t55 = my_piecewise3(t52, t20, t54);
  t56 = t3 * t55;
  t57 = rho[1] * rho[1];
  t58 = t57 * rho[1];
  t59 = 0.1e1 / t58;
  t60 = sigma[2] * t59;
  t61 = sqrt(sigma[2]);
  t62 = sqrt(rho[1]);
  t64 = 0.1e1 / t62 / rho[1];
  t65 = t61 * t64;
  t66 = log(t65 + sqrt(t65 * t65 + 0.1e1));
  t69 = 0.1e1 + 0.56e-1 * t65 * t66;
  t70 = 0.1e1 / t69;
  t73 = 0.1e1 + 0.46526913586269795717e-2 * t60 * t70;
  t74 = t27 * t73;
  t77 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t74);
  tzk0 = t48 + t77;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t78 = t4 * t4;
  t79 = 0.1e1 / t78;
  t80 = t14 * t79;
  t81 = t5 - t80;
  t82 = my_piecewise5(t8, 0, t12, 0, t81);
  t85 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t82);
  t86 = t3 * t85;
  t90 = t25 / t26;
  t91 = t90 * t44;
  t93 = t24 * t91 / 0.3e1;
  t94 = t28 * t28;
  t95 = 0.1e1 / t94;
  t96 = sigma[0] * t95;
  t99 = t40 * t40;
  t100 = 0.1e1 / t99;
  t102 = 0.1e1 / t33 / t28;
  t106 = t31 + 0.1e1;
  t107 = sqrt(t106);
  t108 = 0.1e1 / t107;
  t111 = -0.84e-1 * t32 * t102 * t37 - 0.84e-1 * t96 * t108;
  t112 = t100 * t111;
  t115 = -0.13958074075880938715e-1 * t96 * t41 - 0.46526913586269795717e-2 * t31 * t112;
  t116 = t27 * t115;
  t120 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t86 * t45 - t93 - 0.2e1 / 0.3e1 * t24 * t116);
  t122 = my_piecewise5(t12, 0, t8, 0, -t81);
  t125 = my_piecewise3(t52, 0, 0.3e1 / 0.2e1 * t53 * t122);
  t126 = t3 * t125;
  t129 = t90 * t73;
  t131 = t56 * t129 / 0.3e1;
  t133 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t126 * t74 - t131);
  tvrho0 = t48 + t77 + t4 * (t120 + t133);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t136 = -t5 - t80;
  t137 = my_piecewise5(t8, 0, t12, 0, t136);
  t140 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t137);
  t141 = t3 * t140;
  t145 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t141 * t45 - t93);
  t147 = my_piecewise5(t12, 0, t8, 0, -t136);
  t150 = my_piecewise3(t52, 0, 0.3e1 / 0.2e1 * t53 * t147);
  t151 = t3 * t150;
  t154 = t57 * t57;
  t155 = 0.1e1 / t154;
  t156 = sigma[2] * t155;
  t159 = t69 * t69;
  t160 = 0.1e1 / t159;
  t162 = 0.1e1 / t62 / t57;
  t166 = t60 + 0.1e1;
  t167 = sqrt(t166);
  t168 = 0.1e1 / t167;
  t171 = -0.84e-1 * t61 * t162 * t66 - 0.84e-1 * t156 * t168;
  t172 = t160 * t171;
  t175 = -0.13958074075880938715e-1 * t156 * t70 - 0.46526913586269795717e-2 * t60 * t172;
  t176 = t27 * t175;
  t180 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t151 * t74 - t131 - 0.2e1 / 0.3e1 * t56 * t176);
  tvrho1 = t48 + t77 + t4 * (t145 + t180);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t185 = 0.1e1 / t32;
  t191 = 0.28e-1 * t185 * t35 * t37 + 0.28e-1 * t30 * t108;
  t192 = t100 * t191;
  t195 = 0.46526913586269795717e-2 * t30 * t41 - 0.46526913586269795717e-2 * t31 * t192;
  t196 = t27 * t195;
  t199 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t196);
  tvsigma0 = t4 * t199;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t202 = 0.1e1 / t61;
  t208 = 0.28e-1 * t202 * t64 * t66 + 0.28e-1 * t59 * t168;
  t209 = t160 * t208;
  t212 = 0.46526913586269795717e-2 * t59 * t70 - 0.46526913586269795717e-2 * t60 * t209;
  t213 = t27 * t212;
  t216 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t213);
  tvsigma2 = t4 * t216;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t219 = 0.1e1 / t21;
  t220 = t82 * t82;
  t223 = t78 * t4;
  t224 = 0.1e1 / t223;
  t225 = t14 * t224;
  t227 = -0.2e1 * t79 + 0.2e1 * t225;
  t228 = my_piecewise5(t8, 0, t12, 0, t227);
  t232 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t219 * t220 + 0.3e1 / 0.2e1 * t21 * t228);
  t233 = t3 * t232;
  t236 = t86 * t91;
  t242 = t25 / t26 / t4;
  t243 = t242 * t44;
  t245 = t24 * t243 / 0.6e1;
  t246 = t90 * t115;
  t247 = t24 * t246;
  t249 = t94 * rho[0];
  t250 = 0.1e1 / t249;
  t251 = sigma[0] * t250;
  t257 = 0.1e1 / t99 / t40;
  t258 = t111 * t111;
  t259 = t257 * t258;
  t263 = 0.1e1 / t33 / t29;
  t269 = sigma[0] * sigma[0];
  t270 = t94 * t94;
  t271 = 0.1e1 / t270;
  t274 = 0.1e1 / t107 / t106;
  t277 = 0.21e0 * t32 * t263 * t37 + 0.462e0 * t251 * t108 - 0.126e0 * t269 * t271 * t274;
  t278 = t100 * t277;
  t281 = 0.5583229630352375486e-1 * t251 * t41 + 0.2791614815176187743e-1 * t96 * t112 + 0.93053827172539591434e-2 * t31 * t259 - 0.46526913586269795717e-2 * t31 * t278;
  t282 = t27 * t281;
  t286 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t233 * t45 - 0.2e1 / 0.3e1 * t236 - 0.4e1 / 0.3e1 * t86 * t116 + t245 - 0.2e1 / 0.3e1 * t247 - 0.2e1 / 0.3e1 * t24 * t282);
  t287 = 0.1e1 / t53;
  t288 = t122 * t122;
  t292 = my_piecewise5(t12, 0, t8, 0, -t227);
  t296 = my_piecewise3(t52, 0, 0.3e1 / 0.4e1 * t287 * t288 + 0.3e1 / 0.2e1 * t53 * t292);
  t297 = t3 * t296;
  t300 = t126 * t129;
  t302 = t242 * t73;
  t304 = t56 * t302 / 0.6e1;
  t306 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t297 * t74 - 0.2e1 / 0.3e1 * t300 + t304);
  tv2rho20 = 0.2e1 * t120 + 0.2e1 * t133 + t4 * (t286 + t306);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t309 = t219 * t137;
  t312 = 0.2e1 * t225;
  t313 = my_piecewise5(t8, 0, t12, 0, t312);
  t317 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t309 * t82 + 0.3e1 / 0.2e1 * t21 * t313);
  t318 = t3 * t317;
  t321 = t141 * t91;
  t328 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t318 * t45 - t321 / 0.3e1 - 0.2e1 / 0.3e1 * t141 * t116 - t236 / 0.3e1 + t245 - t247 / 0.3e1);
  t329 = t287 * t147;
  t332 = my_piecewise5(t12, 0, t8, 0, -t312);
  t336 = my_piecewise3(t52, 0, 0.3e1 / 0.4e1 * t329 * t122 + 0.3e1 / 0.2e1 * t53 * t332);
  t337 = t3 * t336;
  t340 = t151 * t129;
  t345 = t90 * t175;
  t346 = t56 * t345;
  t349 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t337 * t74 - t340 / 0.3e1 - t300 / 0.3e1 + t304 - 0.2e1 / 0.3e1 * t126 * t176 - t346 / 0.3e1);
  tv2rho21 = t120 + t133 + t145 + t180 + t4 * (t328 + t349);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t354 = t137 * t137;
  t358 = 0.2e1 * t79 + 0.2e1 * t225;
  t359 = my_piecewise5(t8, 0, t12, 0, t358);
  t363 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t219 * t354 + 0.3e1 / 0.2e1 * t21 * t359);
  t364 = t3 * t363;
  t369 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t364 * t45 - 0.2e1 / 0.3e1 * t321 + t245);
  t370 = t147 * t147;
  t374 = my_piecewise5(t12, 0, t8, 0, -t358);
  t378 = my_piecewise3(t52, 0, 0.3e1 / 0.4e1 * t287 * t370 + 0.3e1 / 0.2e1 * t53 * t374);
  t379 = t3 * t378;
  t386 = t154 * rho[1];
  t387 = 0.1e1 / t386;
  t388 = sigma[2] * t387;
  t394 = 0.1e1 / t159 / t69;
  t395 = t171 * t171;
  t396 = t394 * t395;
  t400 = 0.1e1 / t62 / t58;
  t406 = sigma[2] * sigma[2];
  t407 = t154 * t154;
  t408 = 0.1e1 / t407;
  t411 = 0.1e1 / t167 / t166;
  t414 = 0.21e0 * t61 * t400 * t66 + 0.462e0 * t388 * t168 - 0.126e0 * t406 * t408 * t411;
  t415 = t160 * t414;
  t418 = 0.5583229630352375486e-1 * t388 * t70 + 0.2791614815176187743e-1 * t156 * t172 + 0.93053827172539591434e-2 * t60 * t396 - 0.46526913586269795717e-2 * t60 * t415;
  t419 = t27 * t418;
  t423 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t379 * t74 - 0.2e1 / 0.3e1 * t340 - 0.4e1 / 0.3e1 * t151 * t176 + t304 - 0.2e1 / 0.3e1 * t346 - 0.2e1 / 0.3e1 * t56 * t419);
  tv2rho22 = 0.2e1 * t145 + 0.2e1 * t180 + t4 * (t369 + t423);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t428 = t90 * t195;
  t430 = t24 * t428 / 0.3e1;
  t433 = t30 * t100;
  t438 = t257 * t191;
  t439 = t438 * t111;
  t447 = t94 * t29;
  t448 = 0.1e1 / t447;
  t449 = t448 * t274;
  t452 = -0.42e-1 * t185 * t102 * t37 - 0.126e0 * t95 * t108 + 0.42e-1 * t449 * sigma[0];
  t453 = t100 * t452;
  t456 = -0.13958074075880938715e-1 * t95 * t41 - 0.46526913586269795717e-2 * t433 * t111 + 0.13958074075880938715e-1 * t96 * t192 + 0.93053827172539591434e-2 * t31 * t439 - 0.46526913586269795717e-2 * t31 * t453;
  t457 = t27 * t456;
  t461 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t86 * t196 - t430 - 0.2e1 / 0.3e1 * t24 * t457);
  tv2rhosigma0 = t4 * t461 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t465 = t90 * t212;
  t467 = t56 * t465 / 0.3e1;
  t469 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t126 * t213 - t467);
  tv2rhosigma2 = t4 * t469 + t216;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t474 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t141 * t196 - t430);
  tv2rhosigma3 = t4 * t474 + t199;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t480 = t59 * t160;
  t485 = t394 * t208;
  t486 = t485 * t171;
  t494 = t154 * t58;
  t495 = 0.1e1 / t494;
  t496 = t495 * t411;
  t499 = -0.42e-1 * t202 * t162 * t66 - 0.126e0 * t155 * t168 + 0.42e-1 * t496 * sigma[2];
  t500 = t160 * t499;
  t503 = -0.13958074075880938715e-1 * t155 * t70 - 0.46526913586269795717e-2 * t480 * t171 + 0.13958074075880938715e-1 * t156 * t209 + 0.93053827172539591434e-2 * t60 * t486 - 0.46526913586269795717e-2 * t60 * t500;
  t504 = t27 * t503;
  t508 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t151 * t213 - t467 - 0.2e1 / 0.3e1 * t56 * t504);
  tv2rhosigma5 = t4 * t508 + t216;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t512 = t191 * t191;
  t513 = t257 * t512;
  t517 = 0.1e1 / t32 / sigma[0];
  t521 = 0.1e1 / sigma[0];
  t525 = t94 * t28;
  t526 = 0.1e1 / t525;
  t529 = -0.14e-1 * t517 * t35 * t37 + 0.14e-1 * t521 * t30 * t108 - 0.14e-1 * t526 * t274;
  t530 = t100 * t529;
  t533 = -0.93053827172539591434e-2 * t433 * t191 + 0.93053827172539591434e-2 * t31 * t513 - 0.46526913586269795717e-2 * t31 * t530;
  t534 = t27 * t533;
  t537 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t534);
  tv2sigma20 = t4 * t537;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t540 = t208 * t208;
  t541 = t394 * t540;
  t545 = 0.1e1 / t61 / sigma[2];
  t549 = 0.1e1 / sigma[2];
  t553 = t154 * t57;
  t554 = 0.1e1 / t553;
  t557 = -0.14e-1 * t545 * t64 * t66 + 0.14e-1 * t549 * t59 * t168 - 0.14e-1 * t554 * t411;
  t558 = t160 * t557;
  t561 = -0.93053827172539591434e-2 * t480 * t208 + 0.93053827172539591434e-2 * t60 * t541 - 0.46526913586269795717e-2 * t60 * t558;
  t562 = t27 * t561;
  t565 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t562);
  tv2sigma25 = t4 * t565;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t568 = 0.1e1 / t22;
  t569 = t220 * t82;
  t572 = t219 * t82;
  t575 = t78 * t78;
  t576 = 0.1e1 / t575;
  t577 = t14 * t576;
  t579 = 0.6e1 * t224 - 0.6e1 * t577;
  t580 = my_piecewise5(t8, 0, t12, 0, t579);
  t584 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t568 * t569 + 0.9e1 / 0.4e1 * t572 * t228 + 0.3e1 / 0.2e1 * t21 * t580);
  t585 = t3 * t584;
  t588 = t233 * t91;
  t591 = t86 * t243;
  t593 = t86 * t246;
  t599 = t25 / t26 / t78;
  t600 = t599 * t44;
  t602 = t24 * t600 / 0.4e1;
  t603 = t242 * t115;
  t604 = t24 * t603;
  t606 = t90 * t281;
  t607 = t24 * t606;
  t608 = sigma[0] * t526;
  t617 = t99 * t99;
  t618 = 0.1e1 / t617;
  t619 = t258 * t111;
  t620 = t618 * t619;
  t623 = t257 * t111;
  t624 = t623 * t277;
  t628 = 0.1e1 / t33 / t94;
  t635 = 0.1e1 / t270 / rho[0];
  t639 = t269 * sigma[0];
  t641 = 0.1e1 / t270 / t94;
  t643 = t106 * t106;
  t645 = 0.1e1 / t107 / t643;
  t648 = -0.735e0 * t32 * t628 * t37 - 0.2625e1 * t608 * t108 + 0.1701e1 * t269 * t635 * t274 - 0.567e0 * t639 * t641 * t645;
  t649 = t100 * t648;
  t652 = -0.2791614815176187743e0 * t608 * t41 - 0.16749688891057126458e0 * t251 * t112 - 0.8374844445528563229e-1 * t96 * t259 + 0.41874222227642816145e-1 * t96 * t278 - 0.2791614815176187743e-1 * t31 * t620 + 0.2791614815176187743e-1 * t31 * t624 - 0.46526913586269795717e-2 * t31 * t649;
  t653 = t27 * t652;
  t657 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t585 * t45 - t588 - 0.2e1 * t233 * t116 + t591 / 0.2e1 - 0.2e1 * t593 - 0.2e1 * t86 * t282 - t602 + t604 / 0.2e1 - t607 - 0.2e1 / 0.3e1 * t24 * t653);
  t658 = 0.1e1 / t54;
  t659 = t288 * t122;
  t662 = t287 * t122;
  t666 = my_piecewise5(t12, 0, t8, 0, -t579);
  t670 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t658 * t659 + 0.9e1 / 0.4e1 * t662 * t292 + 0.3e1 / 0.2e1 * t53 * t666);
  t671 = t3 * t670;
  t674 = t297 * t129;
  t675 = t126 * t302;
  t677 = t599 * t73;
  t679 = t56 * t677 / 0.4e1;
  t681 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t671 * t74 - t674 + t675 / 0.2e1 - t679);
  tv3rho30 = 0.3e1 * t286 + 0.3e1 * t306 + t4 * (t657 + t681);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t684 = 0.2e1 * t328;
  t685 = 0.2e1 * t349;
  t686 = t568 * t137;
  t689 = t219 * t313;
  t694 = 0.2e1 * t224;
  t695 = 0.6e1 * t577;
  t696 = t694 - t695;
  t697 = my_piecewise5(t8, 0, t12, 0, t696);
  t701 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t686 * t220 + 0.3e1 / 0.2e1 * t689 * t82 + 0.3e1 / 0.4e1 * t309 * t228 + 0.3e1 / 0.2e1 * t21 * t697);
  t702 = t3 * t701;
  t706 = 0.2e1 / 0.3e1 * t318 * t91;
  t709 = t141 * t243;
  t712 = 0.2e1 / 0.3e1 * t141 * t246;
  t720 = -0.2e1 / 0.3e1 * t702 * t45 - t706 - 0.4e1 / 0.3e1 * t318 * t116 + t709 / 0.6e1 - t712 - 0.2e1 / 0.3e1 * t141 * t282 - t588 / 0.3e1 + t591 / 0.3e1 - 0.2e1 / 0.3e1 * t593 - t602 + t604 / 0.3e1 - t607 / 0.3e1;
  t721 = my_piecewise3(t1, 0, t720);
  t722 = t658 * t147;
  t725 = t287 * t332;
  t731 = my_piecewise5(t12, 0, t8, 0, -t696);
  t735 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t722 * t288 + 0.3e1 / 0.2e1 * t725 * t122 + 0.3e1 / 0.4e1 * t329 * t292 + 0.3e1 / 0.2e1 * t53 * t731);
  t736 = t3 * t735;
  t740 = 0.2e1 / 0.3e1 * t337 * t129;
  t741 = t151 * t302;
  t748 = 0.2e1 / 0.3e1 * t126 * t345;
  t749 = t242 * t175;
  t750 = t56 * t749;
  t753 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t736 * t74 - t740 + t741 / 0.6e1 - t674 / 0.3e1 + t675 / 0.3e1 - t679 - 0.2e1 / 0.3e1 * t297 * t176 - t748 + t750 / 0.6e1);
  tv3rho31 = t286 + t306 + t684 + t685 + t4 * (t721 + t753);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t756 = t568 * t354;
  t761 = t219 * t359;
  t764 = -t694 - t695;
  t765 = my_piecewise5(t8, 0, t12, 0, t764);
  t769 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t756 * t82 + 0.3e1 / 0.2e1 * t309 * t313 + 0.3e1 / 0.4e1 * t761 * t82 + 0.3e1 / 0.2e1 * t21 * t765);
  t770 = t3 * t769;
  t773 = t364 * t91;
  t781 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t770 * t45 - t773 / 0.3e1 - 0.2e1 / 0.3e1 * t364 * t116 - t706 + t709 / 0.3e1 - t712 + t591 / 0.6e1 - t602 + t604 / 0.6e1);
  t782 = t658 * t370;
  t787 = t287 * t374;
  t791 = my_piecewise5(t12, 0, t8, 0, -t764);
  t795 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t782 * t122 + 0.3e1 / 0.2e1 * t329 * t332 + 0.3e1 / 0.4e1 * t787 * t122 + 0.3e1 / 0.2e1 * t53 * t791);
  t796 = t3 * t795;
  t799 = t379 * t129;
  t804 = t151 * t345;
  t810 = t90 * t418;
  t811 = t56 * t810;
  t813 = -0.2e1 / 0.3e1 * t796 * t74 - t799 / 0.3e1 - t740 + t741 / 0.3e1 - 0.4e1 / 0.3e1 * t337 * t176 - 0.2e1 / 0.3e1 * t804 + t675 / 0.6e1 - t679 - t748 + t750 / 0.3e1 - 0.2e1 / 0.3e1 * t126 * t419 - t811 / 0.3e1;
  t814 = my_piecewise3(t49, 0, t813);
  tv3rho32 = t684 + t685 + t369 + t423 + t4 * (t781 + t814);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t819 = t354 * t137;
  t825 = -0.6e1 * t224 - 0.6e1 * t577;
  t826 = my_piecewise5(t8, 0, t12, 0, t825);
  t830 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t568 * t819 + 0.9e1 / 0.4e1 * t309 * t359 + 0.3e1 / 0.2e1 * t21 * t826);
  t831 = t3 * t830;
  t836 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t831 * t45 - t773 + t709 / 0.2e1 - t602);
  t837 = t370 * t147;
  t843 = my_piecewise5(t12, 0, t8, 0, -t825);
  t847 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t658 * t837 + 0.9e1 / 0.4e1 * t329 * t374 + 0.3e1 / 0.2e1 * t53 * t843);
  t848 = t3 * t847;
  t858 = sigma[2] * t554;
  t867 = t159 * t159;
  t868 = 0.1e1 / t867;
  t869 = t395 * t171;
  t870 = t868 * t869;
  t873 = t394 * t171;
  t874 = t873 * t414;
  t878 = 0.1e1 / t62 / t154;
  t885 = 0.1e1 / t407 / rho[1];
  t889 = t406 * sigma[2];
  t891 = 0.1e1 / t407 / t154;
  t893 = t166 * t166;
  t895 = 0.1e1 / t167 / t893;
  t898 = -0.735e0 * t61 * t878 * t66 - 0.2625e1 * t858 * t168 + 0.1701e1 * t406 * t885 * t411 - 0.567e0 * t889 * t891 * t895;
  t899 = t160 * t898;
  t902 = -0.2791614815176187743e0 * t858 * t70 - 0.16749688891057126458e0 * t388 * t172 - 0.8374844445528563229e-1 * t156 * t396 + 0.41874222227642816145e-1 * t156 * t415 - 0.2791614815176187743e-1 * t60 * t870 + 0.2791614815176187743e-1 * t60 * t874 - 0.46526913586269795717e-2 * t60 * t899;
  t903 = t27 * t902;
  t907 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t848 * t74 - t799 - 0.2e1 * t379 * t176 + t741 / 0.2e1 - 0.2e1 * t804 - 0.2e1 * t151 * t419 - t679 + t750 / 0.2e1 - t811 - 0.2e1 / 0.3e1 * t56 * t903);
  tv3rho33 = 0.3e1 * t369 + 0.3e1 * t423 + t4 * (t836 + t907);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t913 = t86 * t428;
  t917 = t242 * t195;
  t919 = t24 * t917 / 0.6e1;
  t920 = t90 * t456;
  t921 = t24 * t920;
  t925 = t95 * t100;
  t928 = t30 * t257;
  t940 = t618 * t191 * t258;
  t943 = t257 * t452;
  t944 = t943 * t111;
  t947 = t438 * t277;
  t955 = t271 * t274;
  t960 = 0.1e1 / t270 / t29 * t645;
  t963 = 0.105e0 * t185 * t263 * t37 + 0.567e0 * t250 * t108 - 0.483e0 * t955 * sigma[0] + 0.189e0 * t960 * t269;
  t964 = t100 * t963;
  t967 = 0.5583229630352375486e-1 * t250 * t41 + 0.2791614815176187743e-1 * t925 * t111 + 0.93053827172539591434e-2 * t928 * t258 - 0.46526913586269795717e-2 * t433 * t277 - 0.5583229630352375486e-1 * t251 * t192 - 0.5583229630352375486e-1 * t96 * t439 + 0.2791614815176187743e-1 * t96 * t453 - 0.2791614815176187743e-1 * t31 * t940 + 0.18610765434507918287e-1 * t31 * t944 + 0.93053827172539591434e-2 * t31 * t947 - 0.46526913586269795717e-2 * t31 * t964;
  t968 = t27 * t967;
  t972 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t233 * t196 - 0.2e1 / 0.3e1 * t913 - 0.4e1 / 0.3e1 * t86 * t457 + t919 - 0.2e1 / 0.3e1 * t921 - 0.2e1 / 0.3e1 * t24 * t968);
  tv3rho2sigma0 = t4 * t972 + 0.2e1 * t461;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t977 = t126 * t465;
  t979 = t242 * t212;
  t981 = t56 * t979 / 0.6e1;
  t983 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t297 * t213 - 0.2e1 / 0.3e1 * t977 + t981);
  tv3rho2sigma2 = t4 * t983 + 0.2e1 * t469;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t987 = t141 * t428;
  t994 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t318 * t196 - t987 / 0.3e1 - 0.2e1 / 0.3e1 * t141 * t457 - t913 / 0.3e1 + t919 - t921 / 0.3e1);
  tv3rho2sigma3 = t4 * t994 + t461 + t474;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t998 = t151 * t465;
  t1003 = t90 * t503;
  t1004 = t56 * t1003;
  t1007 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t337 * t213 - t998 / 0.3e1 - t977 / 0.3e1 + t981 - 0.2e1 / 0.3e1 * t126 * t504 - t1004 / 0.3e1);
  tv3rho2sigma5 = t4 * t1007 + t469 + t508;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1014 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t364 * t196 - 0.2e1 / 0.3e1 * t987 + t919);
  tv3rho2sigma6 = t4 * t1014 + 0.2e1 * t474;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1025 = t155 * t160;
  t1028 = t59 * t394;
  t1040 = t868 * t208 * t395;
  t1043 = t394 * t499;
  t1044 = t1043 * t171;
  t1047 = t485 * t414;
  t1055 = t408 * t411;
  t1060 = 0.1e1 / t407 / t58 * t895;
  t1063 = 0.105e0 * t202 * t400 * t66 + 0.567e0 * t387 * t168 - 0.483e0 * t1055 * sigma[2] + 0.189e0 * t1060 * t406;
  t1064 = t160 * t1063;
  t1067 = 0.5583229630352375486e-1 * t387 * t70 + 0.2791614815176187743e-1 * t1025 * t171 + 0.93053827172539591434e-2 * t1028 * t395 - 0.46526913586269795717e-2 * t480 * t414 - 0.5583229630352375486e-1 * t388 * t209 - 0.5583229630352375486e-1 * t156 * t486 + 0.2791614815176187743e-1 * t156 * t500 - 0.2791614815176187743e-1 * t60 * t1040 + 0.18610765434507918287e-1 * t60 * t1044 + 0.93053827172539591434e-2 * t60 * t1047 - 0.46526913586269795717e-2 * t60 * t1064;
  t1068 = t27 * t1067;
  t1072 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t379 * t213 - 0.2e1 / 0.3e1 * t998 - 0.4e1 / 0.3e1 * t151 * t504 + t981 - 0.2e1 / 0.3e1 * t1004 - 0.2e1 / 0.3e1 * t56 * t1068);
  tv3rho2sigma8 = t4 * t1072 + 0.2e1 * t508;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1076 = t90 * t533;
  t1078 = t24 * t1076 / 0.3e1;
  t1081 = t191 * t111;
  t1088 = t618 * t512;
  t1089 = t1088 * t111;
  t1092 = t438 * t452;
  t1097 = t257 * t529;
  t1098 = t1097 * t111;
  t1109 = 0.1e1 / t270 / t28;
  t1110 = t1109 * t645;
  t1113 = 0.21e-1 * t517 * t102 * t37 - 0.21e-1 * t521 * t95 * t108 + 0.105e0 * t449 - 0.63e-1 * t1110 * sigma[0];
  t1114 = t100 * t1113;
  t1117 = 0.2791614815176187743e-1 * t925 * t191 + 0.18610765434507918287e-1 * t928 * t1081 - 0.93053827172539591434e-2 * t433 * t452 - 0.2791614815176187743e-1 * t96 * t513 - 0.2791614815176187743e-1 * t31 * t1089 + 0.18610765434507918287e-1 * t31 * t1092 + 0.13958074075880938715e-1 * t96 * t530 + 0.93053827172539591434e-2 * t31 * t1098 - 0.46526913586269795717e-2 * t31 * t1114;
  t1118 = t27 * t1117;
  t1122 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t86 * t534 - t1078 - 0.2e1 / 0.3e1 * t24 * t1118);
  tv3rhosigma20 = t4 * t1122 + t537;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1126 = t90 * t561;
  t1128 = t56 * t1126 / 0.3e1;
  t1130 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t126 * t562 - t1128);
  tv3rhosigma25 = t4 * t1130 + t565;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1135 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t141 * t534 - t1078);
  tv3rhosigma26 = t4 * t1135 + t537;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1141 = t208 * t171;
  t1148 = t868 * t540;
  t1149 = t1148 * t171;
  t1152 = t485 * t499;
  t1157 = t394 * t557;
  t1158 = t1157 * t171;
  t1169 = 0.1e1 / t407 / t57;
  t1170 = t1169 * t895;
  t1173 = 0.21e-1 * t545 * t162 * t66 - 0.21e-1 * t549 * t155 * t168 + 0.105e0 * t496 - 0.63e-1 * t1170 * sigma[2];
  t1174 = t160 * t1173;
  t1177 = 0.2791614815176187743e-1 * t1025 * t208 + 0.18610765434507918287e-1 * t1028 * t1141 - 0.93053827172539591434e-2 * t480 * t499 - 0.2791614815176187743e-1 * t156 * t541 - 0.2791614815176187743e-1 * t60 * t1149 + 0.18610765434507918287e-1 * t60 * t1152 + 0.13958074075880938715e-1 * t156 * t558 + 0.93053827172539591434e-2 * t60 * t1158 - 0.46526913586269795717e-2 * t60 * t1174;
  t1178 = t27 * t1177;
  t1182 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t151 * t562 - t1128 - 0.2e1 / 0.3e1 * t56 * t1178);
  tv3rhosigma211 = t4 * t1182 + t565;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1188 = t512 * t191;
  t1189 = t618 * t1188;
  t1192 = t438 * t529;
  t1196 = 0.1e1 / t32 / t269;
  t1200 = 0.1e1 / t269;
  t1209 = 0.21e-1 * t1196 * t35 * t37 - 0.21e-1 * t1200 * t30 * t108 - 0.7e-2 * t521 * t526 * t274 + 0.21e-1 * t635 * t645;
  t1210 = t100 * t1209;
  t1213 = 0.2791614815176187743e-1 * t928 * t512 - 0.13958074075880938715e-1 * t433 * t529 - 0.2791614815176187743e-1 * t31 * t1189 + 0.2791614815176187743e-1 * t31 * t1192 - 0.46526913586269795717e-2 * t31 * t1210;
  t1214 = t27 * t1213;
  t1217 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t1214);
  tv3sigma30 = t4 * t1217;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1222 = t540 * t208;
  t1223 = t868 * t1222;
  t1226 = t485 * t557;
  t1230 = 0.1e1 / t61 / t406;
  t1234 = 0.1e1 / t406;
  t1243 = 0.21e-1 * t1230 * t64 * t66 - 0.21e-1 * t1234 * t59 * t168 - 0.7e-2 * t549 * t554 * t411 + 0.21e-1 * t885 * t895;
  t1244 = t160 * t1243;
  t1247 = 0.2791614815176187743e-1 * t1028 * t540 - 0.13958074075880938715e-1 * t480 * t557 - 0.2791614815176187743e-1 * t60 * t1223 + 0.2791614815176187743e-1 * t60 * t1226 - 0.46526913586269795717e-2 * t60 * t1244;
  t1248 = t27 * t1247;
  t1251 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t1248);
  tv3sigma39 = t4 * t1251;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1256 = t25 / t26 / t223;
  t1259 = 0.5e1 / 0.8e1 * t24 * t1256 * t44;
  t1260 = t233 * t243;
  t1261 = t86 * t600;
  t1262 = t585 * t91;
  t1265 = t24 * t90 * t652;
  t1267 = sigma[0] * t448;
  t1283 = 0.1e1 / t617 / t40;
  t1284 = t258 * t258;
  t1292 = t277 * t277;
  t1310 = 0.1e1 / t270 / t249;
  t1314 = t269 * t269;
  t1315 = t270 * t270;
  t1320 = 0.1e1 / t107 / t643 / t106;
  t1327 = 0.16749688891057126458e1 * t1267 * t41 + 0.11166459260704750972e1 * t608 * t112 + 0.66998755564228505832e0 * t251 * t259 - 0.33499377782114252916e0 * t251 * t278 + 0.33499377782114252916e0 * t96 * t620 - 0.33499377782114252916e0 * t96 * t624 + 0.5583229630352375486e-1 * t96 * t649 + 0.11166459260704750972e0 * t31 * t1283 * t1284 - 0.16749688891057126458e0 * t31 * t618 * t258 * t277 + 0.2791614815176187743e-1 * t31 * t257 * t1292 + 0.37221530869015836573e-1 * t31 * t623 * t648 - 0.46526913586269795717e-2 * t31 * t100 * (0.33075e1 * t32 / t33 / t249 * t37 + 0.168525e2 * t1267 * t108 - 0.192465e2 * t269 * t1109 * t274 + 0.144585e2 * t639 * t1310 * t645 - 0.42525e1 * t1314 / t1315 * t1320);
  t1331 = t86 * t603;
  t1333 = t86 * t606;
  t1338 = t24 * t599 * t115;
  t1340 = t24 * t242 * t281;
  t1341 = t17 * t17;
  t1343 = 0.1e1 / t21 / t1341;
  t1344 = t220 * t220;
  t1350 = t228 * t228;
  t1357 = t14 / t575 / t4;
  t1359 = -0.24e2 * t576 + 0.24e2 * t1357;
  t1360 = my_piecewise5(t8, 0, t12, 0, t1359);
  t1364 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t1343 * t1344 - 0.9e1 / 0.4e1 * t568 * t220 * t228 + 0.9e1 / 0.4e1 * t219 * t1350 + 0.3e1 * t572 * t580 + 0.3e1 / 0.2e1 * t21 * t1360);
  t1370 = t233 * t246;
  t1374 = t1259 + t1260 - t1261 - 0.4e1 / 0.3e1 * t1262 - 0.4e1 / 0.3e1 * t1265 - 0.2e1 / 0.3e1 * t24 * t27 * t1327 + 0.2e1 * t1331 - 0.4e1 * t1333 - 0.8e1 / 0.3e1 * t86 * t653 - t1338 + t1340 - 0.2e1 / 0.3e1 * t3 * t1364 * t45 - 0.8e1 / 0.3e1 * t585 * t116 - 0.4e1 * t1370 - 0.4e1 * t233 * t282;
  t1375 = my_piecewise3(t1, 0, t1374);
  t1376 = t51 * t51;
  t1378 = 0.1e1 / t53 / t1376;
  t1379 = t288 * t288;
  t1385 = t292 * t292;
  t1391 = my_piecewise5(t12, 0, t8, 0, -t1359);
  t1395 = my_piecewise3(t52, 0, 0.9e1 / 0.16e2 * t1378 * t1379 - 0.9e1 / 0.4e1 * t658 * t288 * t292 + 0.9e1 / 0.4e1 * t287 * t1385 + 0.3e1 * t662 * t666 + 0.3e1 / 0.2e1 * t53 * t1391);
  t1399 = t671 * t129;
  t1401 = t297 * t302;
  t1402 = t126 * t677;
  t1405 = 0.5e1 / 0.8e1 * t56 * t1256 * t73;
  t1407 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t3 * t1395 * t74 - 0.4e1 / 0.3e1 * t1399 + t1401 - t1402 + t1405);
  tv4rho40 = 0.4e1 * t657 + 0.4e1 * t681 + t4 * (t1375 + t1407);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1412 = t141 * t600;
  t1414 = t702 * t91;
  t1415 = t318 * t243;
  t1416 = t1415 / 0.2e1;
  t1435 = 0.12e2 * t576;
  t1436 = 0.24e2 * t1357;
  t1437 = -t1435 + t1436;
  t1438 = my_piecewise5(t8, 0, t12, 0, t1437);
  t1442 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t1343 * t137 * t569 - 0.9e1 / 0.8e1 * t568 * t313 * t220 - 0.9e1 / 0.8e1 * t686 * t82 * t228 + 0.9e1 / 0.4e1 * t219 * t697 * t82 + 0.9e1 / 0.4e1 * t689 * t228 + 0.3e1 / 0.4e1 * t309 * t580 + 0.3e1 / 0.2e1 * t21 * t1438);
  t1448 = t318 * t246;
  t1452 = t141 * t603;
  t1453 = t1452 / 0.2e1;
  t1454 = t141 * t606;
  t1461 = -t1412 / 0.4e1 - t1414 + t1416 - 0.2e1 / 0.3e1 * t141 * t653 - 0.2e1 / 0.3e1 * t3 * t1442 * t45 - 0.2e1 * t702 * t116 - 0.2e1 * t1448 - 0.2e1 * t318 * t282 + t1453 - t1454 + t1259 + t1260 / 0.2e1 - 0.3e1 / 0.4e1 * t1261 - t1262 / 0.3e1 - t1265 / 0.3e1 + t1331 - t1333 - 0.3e1 / 0.4e1 * t1338 + t1340 / 0.2e1 - t1370;
  t1462 = my_piecewise3(t1, 0, t1461);
  t1480 = my_piecewise5(t12, 0, t8, 0, -t1437);
  t1484 = my_piecewise3(t52, 0, 0.9e1 / 0.16e2 * t1378 * t147 * t659 - 0.9e1 / 0.8e1 * t658 * t332 * t288 - 0.9e1 / 0.8e1 * t722 * t122 * t292 + 0.9e1 / 0.4e1 * t287 * t731 * t122 + 0.9e1 / 0.4e1 * t725 * t292 + 0.3e1 / 0.4e1 * t329 * t666 + 0.3e1 / 0.2e1 * t53 * t1480);
  t1488 = t736 * t129;
  t1489 = t337 * t302;
  t1490 = t1489 / 0.2e1;
  t1491 = t151 * t677;
  t1498 = t297 * t345;
  t1499 = t126 * t749;
  t1500 = t1499 / 0.2e1;
  t1502 = t56 * t599 * t175;
  t1504 = -0.2e1 / 0.3e1 * t3 * t1484 * t74 - t1488 + t1490 - t1491 / 0.4e1 - t1399 / 0.3e1 + t1401 / 0.2e1 - 0.3e1 / 0.4e1 * t1402 + t1405 - 0.2e1 / 0.3e1 * t671 * t176 - t1498 + t1500 - t1502 / 0.4e1;
  t1505 = my_piecewise3(t49, 0, t1504);
  tv4rho41 = t657 + t681 + 0.3e1 * t721 + 0.3e1 * t753 + t4 * (t1462 + t1505);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1512 = t770 * t91;
  t1514 = t364 * t243;
  t1527 = t313 * t313;
  t1540 = my_piecewise5(t8, 0, t12, 0, t1436);
  t1544 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t1343 * t354 * t220 - 0.3e1 / 0.2e1 * t686 * t82 * t313 - 0.3e1 / 0.8e1 * t756 * t228 + 0.3e1 / 0.2e1 * t219 * t1527 + 0.3e1 / 0.2e1 * t309 * t697 - 0.3e1 / 0.8e1 * t568 * t359 * t220 + 0.3e1 / 0.2e1 * t219 * t765 * t82 + 0.3e1 / 0.4e1 * t761 * t228 + 0.3e1 / 0.2e1 * t21 * t1540);
  t1550 = t364 * t246;
  t1562 = -0.2e1 / 0.3e1 * t1512 + t1514 / 0.6e1 - t1412 / 0.2e1 - 0.2e1 / 0.3e1 * t1414 + 0.2e1 / 0.3e1 * t1415 - 0.2e1 / 0.3e1 * t3 * t1544 * t45 - 0.4e1 / 0.3e1 * t770 * t116 - 0.2e1 / 0.3e1 * t1550 - 0.2e1 / 0.3e1 * t364 * t282 - 0.4e1 / 0.3e1 * t1448 + 0.2e1 / 0.3e1 * t1452 - 0.2e1 / 0.3e1 * t1454 + t1259 + t1260 / 0.6e1 - t1261 / 0.2e1 + t1331 / 0.3e1 - t1338 / 0.2e1 + t1340 / 0.6e1;
  t1563 = my_piecewise3(t1, 0, t1562);
  t1572 = t332 * t332;
  t1585 = my_piecewise5(t12, 0, t8, 0, -t1436);
  t1589 = my_piecewise3(t52, 0, 0.9e1 / 0.16e2 * t1378 * t370 * t288 - 0.3e1 / 0.2e1 * t722 * t122 * t332 - 0.3e1 / 0.8e1 * t782 * t292 + 0.3e1 / 0.2e1 * t287 * t1572 + 0.3e1 / 0.2e1 * t329 * t731 - 0.3e1 / 0.8e1 * t658 * t374 * t288 + 0.3e1 / 0.2e1 * t287 * t791 * t122 + 0.3e1 / 0.4e1 * t787 * t292 + 0.3e1 / 0.2e1 * t53 * t1585);
  t1593 = t796 * t129;
  t1595 = t379 * t302;
  t1602 = t337 * t345;
  t1604 = t151 * t749;
  t1613 = t126 * t810;
  t1616 = t56 * t242 * t418;
  t1618 = -0.2e1 / 0.3e1 * t3 * t1589 * t74 - 0.2e1 / 0.3e1 * t1593 + t1595 / 0.6e1 - 0.2e1 / 0.3e1 * t1488 + 0.2e1 / 0.3e1 * t1489 - t1491 / 0.2e1 - 0.4e1 / 0.3e1 * t736 * t176 - 0.4e1 / 0.3e1 * t1602 + t1604 / 0.3e1 + t1401 / 0.6e1 - t1402 / 0.2e1 + t1405 - 0.2e1 / 0.3e1 * t1498 + 0.2e1 / 0.3e1 * t1499 - t1502 / 0.2e1 - 0.2e1 / 0.3e1 * t297 * t419 - 0.2e1 / 0.3e1 * t1613 + t1616 / 0.6e1;
  t1619 = my_piecewise3(t49, 0, t1618);
  tv4rho42 = 0.2e1 * t721 + 0.2e1 * t753 + 0.2e1 * t781 + 0.2e1 * t814 + t4 * (t1563 + t1619);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1639 = t1435 + t1436;
  t1640 = my_piecewise5(t8, 0, t12, 0, t1639);
  t1644 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t1343 * t819 * t82 - 0.9e1 / 0.8e1 * t756 * t313 - 0.9e1 / 0.8e1 * t686 * t359 * t82 + 0.9e1 / 0.4e1 * t689 * t359 + 0.9e1 / 0.4e1 * t309 * t765 + 0.3e1 / 0.4e1 * t219 * t826 * t82 + 0.3e1 / 0.2e1 * t21 * t1640);
  t1648 = t831 * t91;
  t1656 = -0.2e1 / 0.3e1 * t3 * t1644 * t45 - t1648 / 0.3e1 - 0.2e1 / 0.3e1 * t831 * t116 - t1512 + t1514 / 0.2e1 - t1550 + t1416 - 0.3e1 / 0.4e1 * t1412 + t1453 - t1261 / 0.4e1 + t1259 - t1338 / 0.4e1;
  t1657 = my_piecewise3(t1, 0, t1656);
  t1674 = my_piecewise5(t12, 0, t8, 0, -t1639);
  t1678 = my_piecewise3(t52, 0, 0.9e1 / 0.16e2 * t1378 * t837 * t122 - 0.9e1 / 0.8e1 * t782 * t332 - 0.9e1 / 0.8e1 * t722 * t374 * t122 + 0.9e1 / 0.4e1 * t725 * t374 + 0.9e1 / 0.4e1 * t329 * t791 + 0.3e1 / 0.4e1 * t287 * t843 * t122 + 0.3e1 / 0.2e1 * t53 * t1674);
  t1682 = t848 * t129;
  t1687 = t379 * t345;
  t1692 = t151 * t810;
  t1699 = t56 * t90 * t902;
  t1701 = -0.2e1 / 0.3e1 * t3 * t1678 * t74 - t1682 / 0.3e1 - t1593 + t1595 / 0.2e1 - 0.2e1 * t796 * t176 - t1687 + t1490 - 0.3e1 / 0.4e1 * t1491 - 0.2e1 * t1602 + t1604 - 0.2e1 * t337 * t419 - t1692 - t1402 / 0.4e1 + t1405 + t1500 - 0.3e1 / 0.4e1 * t1502 - t1613 + t1616 / 0.2e1 - 0.2e1 / 0.3e1 * t126 * t903 - t1699 / 0.3e1;
  t1702 = my_piecewise3(t49, 0, t1701);
  tv4rho43 = 0.3e1 * t781 + 0.3e1 * t814 + t836 + t907 + t4 * (t1657 + t1702);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1707 = t354 * t354;
  t1712 = t359 * t359;
  t1718 = 0.24e2 * t576 + 0.24e2 * t1357;
  t1719 = my_piecewise5(t8, 0, t12, 0, t1718);
  t1723 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t1343 * t1707 - 0.9e1 / 0.4e1 * t756 * t359 + 0.9e1 / 0.4e1 * t219 * t1712 + 0.3e1 * t309 * t826 + 0.3e1 / 0.2e1 * t21 * t1719);
  t1729 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t3 * t1723 * t45 - 0.4e1 / 0.3e1 * t1648 + t1514 - t1412 + t1259);
  t1730 = sigma[2] * t495;
  t1746 = 0.1e1 / t867 / t69;
  t1747 = t395 * t395;
  t1755 = t414 * t414;
  t1773 = 0.1e1 / t407 / t386;
  t1777 = t406 * t406;
  t1778 = t407 * t407;
  t1783 = 0.1e1 / t167 / t893 / t166;
  t1790 = 0.16749688891057126458e1 * t1730 * t70 + 0.11166459260704750972e1 * t858 * t172 + 0.66998755564228505832e0 * t388 * t396 - 0.33499377782114252916e0 * t388 * t415 + 0.33499377782114252916e0 * t156 * t870 - 0.33499377782114252916e0 * t156 * t874 + 0.5583229630352375486e-1 * t156 * t899 + 0.11166459260704750972e0 * t60 * t1746 * t1747 - 0.16749688891057126458e0 * t60 * t868 * t395 * t414 + 0.2791614815176187743e-1 * t60 * t394 * t1755 + 0.37221530869015836573e-1 * t60 * t873 * t898 - 0.46526913586269795717e-2 * t60 * t160 * (0.33075e1 * t61 / t62 / t386 * t66 + 0.168525e2 * t1730 * t168 - 0.192465e2 * t406 * t1169 * t411 + 0.144585e2 * t889 * t1773 * t895 - 0.42525e1 * t1777 / t1778 * t1783);
  t1796 = t370 * t370;
  t1801 = t374 * t374;
  t1807 = my_piecewise5(t12, 0, t8, 0, -t1718);
  t1811 = my_piecewise3(t52, 0, 0.9e1 / 0.16e2 * t1378 * t1796 - 0.9e1 / 0.4e1 * t782 * t374 + 0.9e1 / 0.4e1 * t287 * t1801 + 0.3e1 * t329 * t843 + 0.3e1 / 0.2e1 * t53 * t1807);
  t1824 = -0.2e1 / 0.3e1 * t56 * t27 * t1790 - 0.8e1 / 0.3e1 * t151 * t903 - 0.2e1 / 0.3e1 * t3 * t1811 * t74 - 0.8e1 / 0.3e1 * t848 * t176 - 0.4e1 * t379 * t419 - 0.4e1 / 0.3e1 * t1699 - 0.4e1 / 0.3e1 * t1682 - 0.4e1 * t1687 - 0.4e1 * t1692 + t1616 + t1595 + 0.2e1 * t1604 - t1491 - t1502 + t1405;
  t1825 = my_piecewise3(t49, 0, t1824);
  tv4rho44 = 0.4e1 * t836 + 0.4e1 * t907 + t4 * (t1729 + t1825);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1831 = t233 * t428;
  t1834 = t86 * t917;
  t1836 = t86 * t920;
  t1842 = t24 * t599 * t195 / 0.4e1;
  t1844 = t24 * t242 * t456;
  t1847 = t24 * t90 * t967;
  t1872 = t95 * t257;
  t1875 = t30 * t618;
  t1883 = t250 * t100;
  t1897 = t31 * t618;
  t1923 = 0.25124533336585689687e0 * t96 * t940 + 0.11166459260704750972e0 * t31 * t1283 * t191 * t619 - 0.8374844445528563229e-1 * t1897 * t1081 * t277 + 0.93053827172539591434e-2 * t31 * t438 * t648 + 0.2791614815176187743e0 * t608 * t192 + 0.33499377782114252916e0 * t251 * t439 - 0.16749688891057126458e0 * t96 * t944 - 0.8374844445528563229e-1 * t96 * t947 - 0.83748444455285632291e-1 * t31 * t618 * t452 * t258 + 0.2791614815176187743e-1 * t31 * t257 * t963 * t111 + 0.2791614815176187743e-1 * t31 * t943 * t277;
  t1929 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t585 * t196 - t1831 - 0.2e1 * t233 * t457 + t1834 / 0.2e1 - 0.2e1 * t1836 - 0.2e1 * t86 * t968 - t1842 + t1844 / 0.2e1 - t1847 - 0.2e1 / 0.3e1 * t24 * t27 * (-0.46526913586269795717e-2 * t31 * t100 * (-0.3675e0 * t185 * t628 * t37 - 0.29925e1 * t526 * t108 + 0.47145e1 * t635 * t274 * sigma[0] - 0.42525e1 * t641 * t645 * t269 + 0.14175e1 / t270 / t447 * t1320 * t639) - 0.16749688891057126458e0 * t251 * t453 + 0.41874222227642816145e-1 * t96 * t964 - 0.8374844445528563229e-1 * t1872 * t258 - 0.2791614815176187743e-1 * t1875 * t619 + 0.2791614815176187743e-1 * t928 * t111 * t277 - 0.2791614815176187743e0 * t526 * t41 - 0.16749688891057126458e0 * t1883 * t111 + 0.41874222227642816145e-1 * t925 * t277 - 0.46526913586269795717e-2 * t433 * t648 + t1923));
  tv4rho3sigma0 = t4 * t1929 + 0.3e1 * t972;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1934 = t297 * t465;
  t1935 = t126 * t979;
  t1939 = t56 * t599 * t212 / 0.4e1;
  t1941 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t671 * t213 - t1934 + t1935 / 0.2e1 - t1939);
  tv4rho3sigma2 = t4 * t1941 + 0.3e1 * t983;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1943 = 0.2e1 * t994;
  t1947 = 0.2e1 / 0.3e1 * t318 * t428;
  t1950 = t141 * t917;
  t1953 = 0.2e1 / 0.3e1 * t141 * t920;
  t1961 = -0.2e1 / 0.3e1 * t702 * t196 - t1947 - 0.4e1 / 0.3e1 * t318 * t457 + t1950 / 0.6e1 - t1953 - 0.2e1 / 0.3e1 * t141 * t968 - t1831 / 0.3e1 + t1834 / 0.3e1 - 0.2e1 / 0.3e1 * t1836 - t1842 + t1844 / 0.3e1 - t1847 / 0.3e1;
  t1962 = my_piecewise3(t1, 0, t1961);
  tv4rho3sigma3 = t4 * t1962 + t1943 + t972;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1964 = 0.2e1 * t1007;
  t1968 = 0.2e1 / 0.3e1 * t337 * t465;
  t1969 = t151 * t979;
  t1976 = 0.2e1 / 0.3e1 * t126 * t1003;
  t1978 = t56 * t242 * t503;
  t1981 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t736 * t213 - t1968 + t1969 / 0.6e1 - t1934 / 0.3e1 + t1935 / 0.3e1 - t1939 - 0.2e1 / 0.3e1 * t297 * t504 - t1976 + t1978 / 0.6e1);
  tv4rho3sigma5 = t4 * t1981 + t1964 + t983;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t1985 = t364 * t428;
  t1993 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t770 * t196 - t1985 / 0.3e1 - 0.2e1 / 0.3e1 * t364 * t457 - t1947 + t1950 / 0.3e1 - t1953 + t1834 / 0.6e1 - t1842 + t1844 / 0.6e1);
  tv4rho3sigma6 = t4 * t1993 + t1014 + t1943;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t1997 = t379 * t465;
  t2002 = t151 * t1003;
  t2009 = t56 * t90 * t1067;
  t2011 = -0.2e1 / 0.3e1 * t796 * t213 - t1997 / 0.3e1 - t1968 + t1969 / 0.3e1 - 0.4e1 / 0.3e1 * t337 * t504 - 0.2e1 / 0.3e1 * t2002 + t1935 / 0.6e1 - t1939 - t1976 + t1978 / 0.3e1 - 0.2e1 / 0.3e1 * t126 * t1068 - t2009 / 0.3e1;
  t2012 = my_piecewise3(t49, 0, t2011);
  tv4rho3sigma8 = t4 * t2012 + t1072 + t1964;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2019 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t831 * t196 - t1985 + t1950 / 0.2e1 - t1842);
  tv4rho3sigma9 = t4 * t2019 + 0.3e1 * t1014;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2055 = t387 * t160;
  t2069 = t60 * t868;
  t2097 = t155 * t394;
  t2100 = t59 * t868;
  t2106 = 0.41874222227642816145e-1 * t1025 * t414 - 0.46526913586269795717e-2 * t480 * t898 + 0.25124533336585689687e0 * t156 * t1040 + 0.11166459260704750972e0 * t60 * t1746 * t208 * t869 - 0.8374844445528563229e-1 * t2069 * t1141 * t414 - 0.46526913586269795717e-2 * t60 * t160 * (-0.3675e0 * t202 * t878 * t66 - 0.29925e1 * t554 * t168 + 0.47145e1 * t885 * t411 * sigma[2] - 0.42525e1 * t891 * t895 * t406 + 0.14175e1 / t407 / t494 * t1783 * t889) - 0.16749688891057126458e0 * t388 * t500 + 0.41874222227642816145e-1 * t156 * t1064 - 0.8374844445528563229e-1 * t2097 * t395 - 0.2791614815176187743e-1 * t2100 * t869 + 0.2791614815176187743e-1 * t1028 * t171 * t414;
  t2112 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t848 * t213 - t1997 - 0.2e1 * t379 * t504 + t1969 / 0.2e1 - 0.2e1 * t2002 - 0.2e1 * t151 * t1068 - t1939 + t1978 / 0.2e1 - t2009 - 0.2e1 / 0.3e1 * t56 * t27 * (0.93053827172539591434e-2 * t60 * t485 * t898 + 0.2791614815176187743e0 * t858 * t209 + 0.33499377782114252916e0 * t388 * t486 - 0.16749688891057126458e0 * t156 * t1044 - 0.8374844445528563229e-1 * t156 * t1047 - 0.83748444455285632291e-1 * t60 * t868 * t499 * t395 + 0.2791614815176187743e-1 * t60 * t394 * t1063 * t171 + 0.2791614815176187743e-1 * t60 * t1043 * t414 - 0.2791614815176187743e0 * t554 * t70 - 0.16749688891057126458e0 * t2055 * t171 + t2106));
  tv4rho3sigma11 = t4 * t2112 + 0.3e1 * t1072;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2117 = t86 * t1076;
  t2123 = t24 * t242 * t533 / 0.6e1;
  t2125 = t24 * t90 * t1117;
  t2157 = t452 * t452;
  t2172 = 0.2791614815176187743e-1 * t96 * t1114 - 0.46526913586269795717e-2 * t31 * t100 * (-0.525e-1 * t517 * t263 * t37 + 0.525e-1 * t521 * t250 * t108 - 0.7665e0 * t955 + 0.11025e1 * t960 * sigma[0] - 0.4725e0 / t270 / t525 * t1320 * t269) - 0.11166459260704750972e0 * t1883 * t191 - 0.11166459260704750972e0 * t1872 * t1081 + 0.37221530869015836574e-1 * t928 * t452 * t111 + 0.18610765434507918287e-1 * t928 * t191 * t277 + 0.18610765434507918287e-1 * t31 * t257 * t2157 + 0.18610765434507918287e-1 * t31 * t438 * t963 - 0.5583229630352375486e-1 * t251 * t530 - 0.5583229630352375486e-1 * t96 * t1098 + 0.18610765434507918287e-1 * t31 * t257 * t1113 * t111;
  t2203 = 0.93053827172539591434e-2 * t31 * t1097 * t277 - 0.55832296303523754861e-1 * t1875 * t191 * t258 + 0.11166459260704750972e0 * t251 * t513 + 0.16749688891057126458e0 * t96 * t1089 - 0.11166459260704750972e0 * t96 * t1092 - 0.2791614815176187743e-1 * t31 * t1088 * t277 - 0.93053827172539591434e-2 * t433 * t963 + 0.5583229630352375486e-1 * t925 * t452 + 0.11166459260704750972e0 * t31 * t1283 * t512 * t258 - 0.11166459260704750972e0 * t1897 * t1081 * t452 - 0.2791614815176187743e-1 * t31 * t618 * t529 * t258;
  t2209 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t233 * t534 - 0.2e1 / 0.3e1 * t2117 - 0.4e1 / 0.3e1 * t86 * t1118 + t2123 - 0.2e1 / 0.3e1 * t2125 - 0.2e1 / 0.3e1 * t24 * t27 * (t2172 + t2203));
  tv4rho2sigma20 = t4 * t2209 + 0.2e1 * t1122;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2214 = t126 * t1126;
  t2218 = t56 * t242 * t561 / 0.6e1;
  t2220 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t297 * t562 - 0.2e1 / 0.3e1 * t2214 + t2218);
  tv4rho2sigma25 = t4 * t2220 + 0.2e1 * t1130;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2224 = t141 * t1076;
  t2231 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t318 * t534 - t2224 / 0.3e1 - 0.2e1 / 0.3e1 * t141 * t1118 - t2117 / 0.3e1 + t2123 - t2125 / 0.3e1);
  tv4rho2sigma26 = t4 * t2231 + t1122 + t1135;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2235 = t151 * t1126;
  t2241 = t56 * t90 * t1177;
  t2244 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t337 * t562 - t2235 / 0.3e1 - t2214 / 0.3e1 + t2218 - 0.2e1 / 0.3e1 * t126 * t1178 - t2241 / 0.3e1);
  tv4rho2sigma211 = t4 * t2244 + t1130 + t1182;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2251 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t364 * t534 - 0.2e1 / 0.3e1 * t2224 + t2123);
  tv4rho2sigma212 = t4 * t2251 + 0.2e1 * t1135;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2305 = -0.46526913586269795717e-2 * t60 * t160 * (-0.525e-1 * t545 * t400 * t66 + 0.525e-1 * t549 * t387 * t168 - 0.7665e0 * t1055 + 0.11025e1 * t1060 * sigma[2] - 0.4725e0 / t407 / t553 * t1783 * t406) + 0.2791614815176187743e-1 * t156 * t1174 + 0.37221530869015836574e-1 * t1028 * t499 * t171 + 0.18610765434507918287e-1 * t1028 * t208 * t414 + 0.5583229630352375486e-1 * t1025 * t499 - 0.93053827172539591434e-2 * t480 * t1063 - 0.2791614815176187743e-1 * t60 * t868 * t557 * t395 + 0.11166459260704750972e0 * t60 * t1746 * t540 * t395 - 0.11166459260704750972e0 * t2069 * t1141 * t499 - 0.11166459260704750972e0 * t2055 * t208 - 0.11166459260704750972e0 * t2097 * t1141;
  t2332 = t499 * t499;
  t2336 = 0.18610765434507918287e-1 * t60 * t485 * t1063 - 0.5583229630352375486e-1 * t388 * t558 - 0.5583229630352375486e-1 * t156 * t1158 + 0.18610765434507918287e-1 * t60 * t394 * t1173 * t171 + 0.93053827172539591434e-2 * t60 * t1157 * t414 - 0.55832296303523754861e-1 * t2100 * t208 * t395 + 0.11166459260704750972e0 * t388 * t541 + 0.16749688891057126458e0 * t156 * t1149 - 0.11166459260704750972e0 * t156 * t1152 - 0.2791614815176187743e-1 * t60 * t1148 * t414 + 0.18610765434507918287e-1 * t60 * t394 * t2332;
  t2342 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t379 * t562 - 0.2e1 / 0.3e1 * t2235 - 0.4e1 / 0.3e1 * t151 * t1178 + t2218 - 0.2e1 / 0.3e1 * t2241 - 0.2e1 / 0.3e1 * t56 * t27 * (t2305 + t2336));
  tv4rho2sigma217 = t4 * t2342 + 0.2e1 * t1182;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2348 = t24 * t90 * t1213 / 0.3e1;
  t2375 = t191 * t529;
  t2408 = -0.8374844445528563229e-1 * t1872 * t512 - 0.8374844445528563229e-1 * t1875 * t512 * t111 + 0.5583229630352375486e-1 * t928 * t191 * t452 + 0.41874222227642816145e-1 * t925 * t529 + 0.2791614815176187743e-1 * t928 * t529 * t111 - 0.13958074075880938715e-1 * t433 * t1113 + 0.8374844445528563229e-1 * t96 * t1189 + 0.11166459260704750972e0 * t31 * t1283 * t1188 * t111 - 0.8374844445528563229e-1 * t31 * t1088 * t452 - 0.8374844445528563229e-1 * t96 * t1192 - 0.8374844445528563229e-1 * t1897 * t2375 * t111 + 0.2791614815176187743e-1 * t31 * t943 * t529 + 0.2791614815176187743e-1 * t31 * t438 * t1113 + 0.13958074075880938715e-1 * t96 * t1210 + 0.93053827172539591434e-2 * t31 * t257 * t1209 * t111 - 0.46526913586269795717e-2 * t31 * t100 * (-0.315e-1 * t1196 * t102 * t37 + 0.315e-1 * t1200 * t95 * t108 + 0.105e-1 * t521 * t448 * t274 - 0.2205e0 * t1110 + 0.1575e0 * t1310 * t1320 * sigma[0]);
  t2413 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t86 * t1214 - t2348 - 0.2e1 / 0.3e1 * t24 * t27 * t2408);
  tv4rhosigma30 = t4 * t2413 + t1217;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2419 = t56 * t90 * t1247 / 0.3e1;
  t2421 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t126 * t1248 - t2419);
  tv4rhosigma39 = t4 * t2421 + t1251;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2426 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t141 * t1214 - t2348);
  tv4rhosigma310 = t4 * t2426 + t1217;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2456 = t208 * t557;
  t2489 = -0.8374844445528563229e-1 * t2097 * t540 - 0.8374844445528563229e-1 * t2100 * t540 * t171 + 0.5583229630352375486e-1 * t1028 * t208 * t499 + 0.41874222227642816145e-1 * t1025 * t557 + 0.2791614815176187743e-1 * t1028 * t557 * t171 - 0.13958074075880938715e-1 * t480 * t1173 + 0.8374844445528563229e-1 * t156 * t1223 + 0.11166459260704750972e0 * t60 * t1746 * t1222 * t171 - 0.8374844445528563229e-1 * t60 * t1148 * t499 - 0.8374844445528563229e-1 * t156 * t1226 - 0.8374844445528563229e-1 * t2069 * t2456 * t171 + 0.2791614815176187743e-1 * t60 * t1043 * t557 + 0.2791614815176187743e-1 * t60 * t485 * t1173 + 0.13958074075880938715e-1 * t156 * t1244 + 0.93053827172539591434e-2 * t60 * t394 * t1243 * t171 - 0.46526913586269795717e-2 * t60 * t160 * (-0.315e-1 * t1230 * t162 * t66 + 0.315e-1 * t1234 * t155 * t168 + 0.105e-1 * t549 * t495 * t411 - 0.2205e0 * t1170 + 0.1575e0 * t1773 * t1783 * sigma[2]);
  t2494 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t151 * t1248 - t2419 - 0.2e1 / 0.3e1 * t56 * t27 * t2489);
  tv4rhosigma319 = t4 * t2494 + t1251;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2502 = t512 * t512;
  t2509 = t529 * t529;
  t2541 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t27 * (-0.11166459260704750972e0 * t1875 * t1188 + 0.11166459260704750972e0 * t928 * t2375 - 0.18610765434507918287e-1 * t433 * t1209 + 0.11166459260704750972e0 * t31 * t1283 * t2502 - 0.16749688891057126458e0 * t31 * t1088 * t529 + 0.2791614815176187743e-1 * t31 * t257 * t2509 + 0.37221530869015836573e-1 * t31 * t438 * t1209 - 0.46526913586269795717e-2 * t31 * t100 * (-0.525e-1 / t32 / t639 * t35 * t37 + 0.525e-1 / t639 * t30 * t108 + 0.175e-1 * t1200 * t526 * t274 + 0.105e-1 * t521 * t635 * t645 - 0.525e-1 * t641 * t1320)));
  tv4sigma40 = t4 * t2541;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2548 = t540 * t540;
  t2555 = t557 * t557;
  t2587 = my_piecewise3(t49, 0, -0.2e1 / 0.3e1 * t56 * t27 * (-0.11166459260704750972e0 * t2100 * t1222 + 0.11166459260704750972e0 * t1028 * t2456 - 0.18610765434507918287e-1 * t480 * t1243 + 0.11166459260704750972e0 * t60 * t1746 * t2548 - 0.16749688891057126458e0 * t60 * t1148 * t557 + 0.2791614815176187743e-1 * t60 * t394 * t2555 + 0.37221530869015836573e-1 * t60 * t485 * t1243 - 0.46526913586269795717e-2 * t60 * t160 * (-0.525e-1 / t61 / t889 * t64 * t66 + 0.525e-1 / t889 * t59 * t168 + 0.175e-1 * t1234 * t554 * t411 + 0.105e-1 * t549 * t885 * t895 - 0.525e-1 * t891 * t1783)));
  tv4sigma414 = t4 * t2587;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

