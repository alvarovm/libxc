/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_mpbe.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t41, t42, t46, t47, t51, t52, t54, t55;
  double t56, t57, t58, t60, t62, t63, t67, t68;
  double t69, t70, t71, t72, t74, t75, t79, t83;
  double t84, t85, t86, t87, t88, t90, t91, t92;
  double t93, t94, t96, t98, t102, t103, t107, t108;
  double t109, t111, t113, t114, t118, t119, t120, t122;
  double t123, t127, t131, tzk0;

  gga_x_mpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_mpbe_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->c1 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = params->a * t28;
  t42 = t33 * sigma[0];
  t46 = 0.1e1 + t41 * t42 * t39 / 0.24e2;
  t47 = 0.1e1 / t46;
  t51 = t28 * t28;
  t52 = params->c2 * t51;
  t54 = 0.1e1 / t31 / t30;
  t55 = t52 * t54;
  t56 = sigma[0] * sigma[0];
  t57 = t35 * t35;
  t58 = t57 * rho[0];
  t60 = 0.1e1 / t36 / t58;
  t62 = t46 * t46;
  t63 = 0.1e1 / t62;
  t67 = t30 * t30;
  t68 = 0.1e1 / t67;
  t69 = params->c3 * t68;
  t70 = t56 * sigma[0];
  t71 = t57 * t57;
  t72 = 0.1e1 / t71;
  t74 = t62 * t46;
  t75 = 0.1e1 / t74;
  t79 = 0.1e1 + t34 * sigma[0] * t39 * t47 / 0.24e2 + t55 * t56 * t60 * t63 / 0.576e3 + t69 * t70 * t72 * t75 / 0.2304e4;
  t83 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t79);
  t84 = rho[1] <= p->dens_threshold;
  t85 = my_piecewise5(t14, t11, t10, t15, -t17);
  t86 = 0.1e1 + t85;
  t87 = t86 <= p->zeta_threshold;
  t88 = POW_1_3(t86);
  t90 = my_piecewise3(t87, t22, t88 * t86);
  t91 = t90 * t26;
  t92 = rho[1] * rho[1];
  t93 = POW_1_3(rho[1]);
  t94 = t93 * t93;
  t96 = 0.1e1 / t94 / t92;
  t98 = t33 * sigma[2];
  t102 = 0.1e1 + t41 * t98 * t96 / 0.24e2;
  t103 = 0.1e1 / t102;
  t107 = sigma[2] * sigma[2];
  t108 = t92 * t92;
  t109 = t108 * rho[1];
  t111 = 0.1e1 / t93 / t109;
  t113 = t102 * t102;
  t114 = 0.1e1 / t113;
  t118 = t107 * sigma[2];
  t119 = t108 * t108;
  t120 = 0.1e1 / t119;
  t122 = t113 * t102;
  t123 = 0.1e1 / t122;
  t127 = 0.1e1 + t34 * sigma[2] * t96 * t103 / 0.24e2 + t55 * t107 * t111 * t114 / 0.576e3 + t69 * t118 * t120 * t123 / 0.2304e4;
  t131 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t127);
  tzk0 = t83 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t41, t42, t46, t47, t51, t52, t54, t55;
  double t56, t57, t58, t60, t62, t63, t67, t68;
  double t69, t70, t71, t72, t74, t75, t79, t83;
  double t84, t85, t86, t87, t88, t90, t91, t92;
  double t93, t94, t96, t98, t102, t103, t107, t108;
  double t109, t111, t113, t114, t118, t119, t120, t122;
  double t123, t127, t131, tzk0;

  double t132, t133, t134, t135, t136, t139, t140, t144;
  double t145, t146, t149, t150, t152, t158, t159, t161;
  double t162, t163, t170, t171, t172, t173, t174, t175;
  double t182, t183, t185, t188, t189, t191, t192, t195;
  double t200, t202, t205, t206, t210, t213, t215, tvrho0;
  double t218, t219, t222, t223, t228, t230, t233, t234;
  double t238, t240, t245, t247, t248, t249, t256, t257;
  double t258, t259, t260, t267, t268, t270, t273, t274;
  double t276, t279, t284, tvrho1, t291, t298, t299, t300;
  double t307, t309, t314, t318, tvsigma0, tvsigma1, t323, t330;
  double t331, t332, t339, t341, t346, t350, tvsigma2;

  gga_x_mpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_mpbe_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->c1 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = params->a * t28;
  t42 = t33 * sigma[0];
  t46 = 0.1e1 + t41 * t42 * t39 / 0.24e2;
  t47 = 0.1e1 / t46;
  t51 = t28 * t28;
  t52 = params->c2 * t51;
  t54 = 0.1e1 / t31 / t30;
  t55 = t52 * t54;
  t56 = sigma[0] * sigma[0];
  t57 = t35 * t35;
  t58 = t57 * rho[0];
  t60 = 0.1e1 / t36 / t58;
  t62 = t46 * t46;
  t63 = 0.1e1 / t62;
  t67 = t30 * t30;
  t68 = 0.1e1 / t67;
  t69 = params->c3 * t68;
  t70 = t56 * sigma[0];
  t71 = t57 * t57;
  t72 = 0.1e1 / t71;
  t74 = t62 * t46;
  t75 = 0.1e1 / t74;
  t79 = 0.1e1 + t34 * sigma[0] * t39 * t47 / 0.24e2 + t55 * t56 * t60 * t63 / 0.576e3 + t69 * t70 * t72 * t75 / 0.2304e4;
  t83 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t79);
  t84 = rho[1] <= p->dens_threshold;
  t85 = my_piecewise5(t14, t11, t10, t15, -t17);
  t86 = 0.1e1 + t85;
  t87 = t86 <= p->zeta_threshold;
  t88 = POW_1_3(t86);
  t90 = my_piecewise3(t87, t22, t88 * t86);
  t91 = t90 * t26;
  t92 = rho[1] * rho[1];
  t93 = POW_1_3(rho[1]);
  t94 = t93 * t93;
  t96 = 0.1e1 / t94 / t92;
  t98 = t33 * sigma[2];
  t102 = 0.1e1 + t41 * t98 * t96 / 0.24e2;
  t103 = 0.1e1 / t102;
  t107 = sigma[2] * sigma[2];
  t108 = t92 * t92;
  t109 = t108 * rho[1];
  t111 = 0.1e1 / t93 / t109;
  t113 = t102 * t102;
  t114 = 0.1e1 / t113;
  t118 = t107 * sigma[2];
  t119 = t108 * t108;
  t120 = 0.1e1 / t119;
  t122 = t113 * t102;
  t123 = 0.1e1 / t122;
  t127 = 0.1e1 + t34 * sigma[2] * t96 * t103 / 0.24e2 + t55 * t107 * t111 * t114 / 0.576e3 + t69 * t118 * t120 * t123 / 0.2304e4;
  t131 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t127);
  tzk0 = t83 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t132 = t6 * t6;
  t133 = 0.1e1 / t132;
  t134 = t16 * t133;
  t135 = t7 - t134;
  t136 = my_piecewise5(t10, 0, t14, 0, t135);
  t139 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t136);
  t140 = t139 * t26;
  t144 = t26 * t26;
  t145 = 0.1e1 / t144;
  t146 = t25 * t145;
  t149 = t5 * t146 * t79 / 0.8e1;
  t150 = t35 * rho[0];
  t152 = 0.1e1 / t37 / t150;
  t158 = params->c1 * t51 * t54;
  t159 = t57 * t35;
  t161 = 0.1e1 / t36 / t159;
  t162 = t56 * t161;
  t163 = t63 * params->a;
  t170 = params->c2 * t68;
  t171 = t170 * t70;
  t172 = t71 * rho[0];
  t173 = 0.1e1 / t172;
  t174 = t173 * t75;
  t175 = t174 * params->a;
  t182 = t56 * t56;
  t183 = t71 * t150;
  t185 = 0.1e1 / t37 / t183;
  t188 = t62 * t62;
  t189 = 0.1e1 / t188;
  t191 = t28 * t33;
  t192 = t189 * params->a * t191;
  t195 = -t34 * sigma[0] * t152 * t47 / 0.9e1 + t158 * t162 * t163 / 0.216e3 - t55 * t162 * t63 / 0.108e3 + t171 * t175 / 0.432e3 - t69 * t70 * t173 * t75 / 0.288e3 + t69 * t182 * t185 * t192 / 0.6912e4;
  t200 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t79 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t195);
  t202 = my_piecewise5(t14, 0, t10, 0, -t135);
  t205 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t88 * t202);
  t206 = t205 * t26;
  t210 = t90 * t145;
  t213 = t5 * t210 * t127 / 0.8e1;
  t215 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t206 * t127 - t213);
  tvrho0 = t83 + t131 + t6 * (t200 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t218 = -t7 - t134;
  t219 = my_piecewise5(t10, 0, t14, 0, t218);
  t222 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t219);
  t223 = t222 * t26;
  t228 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t79 - t149);
  t230 = my_piecewise5(t14, 0, t10, 0, -t218);
  t233 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t88 * t230);
  t234 = t233 * t26;
  t238 = t92 * rho[1];
  t240 = 0.1e1 / t94 / t238;
  t245 = t108 * t92;
  t247 = 0.1e1 / t93 / t245;
  t248 = t107 * t247;
  t249 = t114 * params->a;
  t256 = t170 * t118;
  t257 = t119 * rho[1];
  t258 = 0.1e1 / t257;
  t259 = t258 * t123;
  t260 = t259 * params->a;
  t267 = t107 * t107;
  t268 = t119 * t238;
  t270 = 0.1e1 / t94 / t268;
  t273 = t113 * t113;
  t274 = 0.1e1 / t273;
  t276 = t274 * params->a * t191;
  t279 = -t34 * sigma[2] * t240 * t103 / 0.9e1 + t158 * t248 * t249 / 0.216e3 - t55 * t248 * t114 / 0.108e3 + t256 * t260 / 0.432e3 - t69 * t118 * t258 * t123 / 0.288e3 + t69 * t267 * t270 * t276 / 0.6912e4;
  t284 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t234 * t127 - t213 - 0.3e1 / 0.8e1 * t5 * t91 * t279);
  tvrho1 = t83 + t131 + t6 * (t228 + t284);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t291 = sigma[0] * t60;
  t298 = t170 * t56;
  t299 = t72 * t75;
  t300 = t299 * params->a;
  t307 = t71 * t35;
  t309 = 0.1e1 / t37 / t307;
  t314 = t29 * t33 * t39 * t47 / 0.24e2 - t158 * t291 * t163 / 0.576e3 + t55 * t291 * t63 / 0.288e3 - t298 * t300 / 0.1152e4 + t69 * t56 * t72 * t75 / 0.768e3 - t69 * t70 * t309 * t192 / 0.18432e5;
  t318 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t314);
  tvsigma0 = t6 * t318;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t323 = sigma[2] * t111;
  t330 = t170 * t107;
  t331 = t120 * t123;
  t332 = t331 * params->a;
  t339 = t119 * t92;
  t341 = 0.1e1 / t94 / t339;
  t346 = t29 * t33 * t96 * t103 / 0.24e2 - t158 * t323 * t249 / 0.576e3 + t55 * t323 * t114 / 0.288e3 - t330 * t332 / 0.1152e4 + t69 * t107 * t120 * t123 / 0.768e3 - t69 * t118 * t341 * t276 / 0.18432e5;
  t350 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t346);
  tvsigma2 = t6 * t350;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t41, t42, t46, t47, t51, t52, t54, t55;
  double t56, t57, t58, t60, t62, t63, t67, t68;
  double t69, t70, t71, t72, t74, t75, t79, t83;
  double t84, t85, t86, t87, t88, t90, t91, t92;
  double t93, t94, t96, t98, t102, t103, t107, t108;
  double t109, t111, t113, t114, t118, t119, t120, t122;
  double t123, t127, t131, tzk0;

  double t132, t133, t134, t135, t136, t139, t140, t144;
  double t145, t146, t149, t150, t152, t158, t159, t161;
  double t162, t163, t170, t171, t172, t173, t174, t175;
  double t182, t183, t185, t188, t189, t191, t192, t195;
  double t200, t202, t205, t206, t210, t213, t215, tvrho0;
  double t218, t219, t222, t223, t228, t230, t233, t234;
  double t238, t240, t245, t247, t248, t249, t256, t257;
  double t258, t259, t260, t267, t268, t270, t273, t274;
  double t276, t279, t284, tvrho1, t291, t298, t299, t300;
  double t307, t309, t314, t318, tvsigma0, tvsigma1, t323, t330;
  double t331, t332, t339, t341, t346, t350, tvsigma2;

  double t353, t354, t355, t358, t359, t360, t362, t363;
  double t367, t368, t372, t374, t380, t381, t384, t386;
  double t389, t394, t396, t397, t401, t402, t403, t404;
  double t405, t412, t415, t417, t418, t421, t431, t434;
  double t438, t440, t441, t444, t449, t450, t451, t452;
  double t456, t460, t461, t465, t467, t469, t472, t474;
  double tv2rho20, t477, t480, t481, t485, t486, t490, t492;
  double t500, t501, t504, t508, t509, t513, t515, t522;
  double t525, tv2rho21, t530, t534, t535, t539, t540, t546;
  double t547, t551, t555, t556, t566, t571, t573, t574;
  double t578, t579, t580, t587, t590, t592, t593, t596;
  double t606, t609, t613, t615, t618, t623, tv2rho22, t631;
  double t636, t637, t642, t651, t662, t664, t669, t674;
  double tv2rhosigma0, tv2rhosigma1, t681, t683, tv2rhosigma2, t689, tv2rhosigma3, tv2rhosigma4;
  double t698, t699, t704, t713, t724, t726, t731, t736;
  double tv2rhosigma5, t743, t753, t764, t766, t771, t775, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t781, t791, t802, t804;
  double t809, t813, tv2sigma25;

  gga_x_mpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_mpbe_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->c1 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = params->a * t28;
  t42 = t33 * sigma[0];
  t46 = 0.1e1 + t41 * t42 * t39 / 0.24e2;
  t47 = 0.1e1 / t46;
  t51 = t28 * t28;
  t52 = params->c2 * t51;
  t54 = 0.1e1 / t31 / t30;
  t55 = t52 * t54;
  t56 = sigma[0] * sigma[0];
  t57 = t35 * t35;
  t58 = t57 * rho[0];
  t60 = 0.1e1 / t36 / t58;
  t62 = t46 * t46;
  t63 = 0.1e1 / t62;
  t67 = t30 * t30;
  t68 = 0.1e1 / t67;
  t69 = params->c3 * t68;
  t70 = t56 * sigma[0];
  t71 = t57 * t57;
  t72 = 0.1e1 / t71;
  t74 = t62 * t46;
  t75 = 0.1e1 / t74;
  t79 = 0.1e1 + t34 * sigma[0] * t39 * t47 / 0.24e2 + t55 * t56 * t60 * t63 / 0.576e3 + t69 * t70 * t72 * t75 / 0.2304e4;
  t83 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t79);
  t84 = rho[1] <= p->dens_threshold;
  t85 = my_piecewise5(t14, t11, t10, t15, -t17);
  t86 = 0.1e1 + t85;
  t87 = t86 <= p->zeta_threshold;
  t88 = POW_1_3(t86);
  t90 = my_piecewise3(t87, t22, t88 * t86);
  t91 = t90 * t26;
  t92 = rho[1] * rho[1];
  t93 = POW_1_3(rho[1]);
  t94 = t93 * t93;
  t96 = 0.1e1 / t94 / t92;
  t98 = t33 * sigma[2];
  t102 = 0.1e1 + t41 * t98 * t96 / 0.24e2;
  t103 = 0.1e1 / t102;
  t107 = sigma[2] * sigma[2];
  t108 = t92 * t92;
  t109 = t108 * rho[1];
  t111 = 0.1e1 / t93 / t109;
  t113 = t102 * t102;
  t114 = 0.1e1 / t113;
  t118 = t107 * sigma[2];
  t119 = t108 * t108;
  t120 = 0.1e1 / t119;
  t122 = t113 * t102;
  t123 = 0.1e1 / t122;
  t127 = 0.1e1 + t34 * sigma[2] * t96 * t103 / 0.24e2 + t55 * t107 * t111 * t114 / 0.576e3 + t69 * t118 * t120 * t123 / 0.2304e4;
  t131 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t127);
  tzk0 = t83 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t132 = t6 * t6;
  t133 = 0.1e1 / t132;
  t134 = t16 * t133;
  t135 = t7 - t134;
  t136 = my_piecewise5(t10, 0, t14, 0, t135);
  t139 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t136);
  t140 = t139 * t26;
  t144 = t26 * t26;
  t145 = 0.1e1 / t144;
  t146 = t25 * t145;
  t149 = t5 * t146 * t79 / 0.8e1;
  t150 = t35 * rho[0];
  t152 = 0.1e1 / t37 / t150;
  t158 = params->c1 * t51 * t54;
  t159 = t57 * t35;
  t161 = 0.1e1 / t36 / t159;
  t162 = t56 * t161;
  t163 = t63 * params->a;
  t170 = params->c2 * t68;
  t171 = t170 * t70;
  t172 = t71 * rho[0];
  t173 = 0.1e1 / t172;
  t174 = t173 * t75;
  t175 = t174 * params->a;
  t182 = t56 * t56;
  t183 = t71 * t150;
  t185 = 0.1e1 / t37 / t183;
  t188 = t62 * t62;
  t189 = 0.1e1 / t188;
  t191 = t28 * t33;
  t192 = t189 * params->a * t191;
  t195 = -t34 * sigma[0] * t152 * t47 / 0.9e1 + t158 * t162 * t163 / 0.216e3 - t55 * t162 * t63 / 0.108e3 + t171 * t175 / 0.432e3 - t69 * t70 * t173 * t75 / 0.288e3 + t69 * t182 * t185 * t192 / 0.6912e4;
  t200 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t79 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t195);
  t202 = my_piecewise5(t14, 0, t10, 0, -t135);
  t205 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t88 * t202);
  t206 = t205 * t26;
  t210 = t90 * t145;
  t213 = t5 * t210 * t127 / 0.8e1;
  t215 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t206 * t127 - t213);
  tvrho0 = t83 + t131 + t6 * (t200 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t218 = -t7 - t134;
  t219 = my_piecewise5(t10, 0, t14, 0, t218);
  t222 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t219);
  t223 = t222 * t26;
  t228 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t79 - t149);
  t230 = my_piecewise5(t14, 0, t10, 0, -t218);
  t233 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t88 * t230);
  t234 = t233 * t26;
  t238 = t92 * rho[1];
  t240 = 0.1e1 / t94 / t238;
  t245 = t108 * t92;
  t247 = 0.1e1 / t93 / t245;
  t248 = t107 * t247;
  t249 = t114 * params->a;
  t256 = t170 * t118;
  t257 = t119 * rho[1];
  t258 = 0.1e1 / t257;
  t259 = t258 * t123;
  t260 = t259 * params->a;
  t267 = t107 * t107;
  t268 = t119 * t238;
  t270 = 0.1e1 / t94 / t268;
  t273 = t113 * t113;
  t274 = 0.1e1 / t273;
  t276 = t274 * params->a * t191;
  t279 = -t34 * sigma[2] * t240 * t103 / 0.9e1 + t158 * t248 * t249 / 0.216e3 - t55 * t248 * t114 / 0.108e3 + t256 * t260 / 0.432e3 - t69 * t118 * t258 * t123 / 0.288e3 + t69 * t267 * t270 * t276 / 0.6912e4;
  t284 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t234 * t127 - t213 - 0.3e1 / 0.8e1 * t5 * t91 * t279);
  tvrho1 = t83 + t131 + t6 * (t228 + t284);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t291 = sigma[0] * t60;
  t298 = t170 * t56;
  t299 = t72 * t75;
  t300 = t299 * params->a;
  t307 = t71 * t35;
  t309 = 0.1e1 / t37 / t307;
  t314 = t29 * t33 * t39 * t47 / 0.24e2 - t158 * t291 * t163 / 0.576e3 + t55 * t291 * t63 / 0.288e3 - t298 * t300 / 0.1152e4 + t69 * t56 * t72 * t75 / 0.768e3 - t69 * t70 * t309 * t192 / 0.18432e5;
  t318 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t314);
  tvsigma0 = t6 * t318;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t323 = sigma[2] * t111;
  t330 = t170 * t107;
  t331 = t120 * t123;
  t332 = t331 * params->a;
  t339 = t119 * t92;
  t341 = 0.1e1 / t94 / t339;
  t346 = t29 * t33 * t96 * t103 / 0.24e2 - t158 * t323 * t249 / 0.576e3 + t55 * t323 * t114 / 0.288e3 - t330 * t332 / 0.1152e4 + t69 * t107 * t120 * t123 / 0.768e3 - t69 * t118 * t341 * t276 / 0.18432e5;
  t350 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t346);
  tvsigma2 = t6 * t350;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t353 = t23 * t23;
  t354 = 0.1e1 / t353;
  t355 = t136 * t136;
  t358 = t132 * t6;
  t359 = 0.1e1 / t358;
  t360 = t16 * t359;
  t362 = -0.2e1 * t133 + 0.2e1 * t360;
  t363 = my_piecewise5(t10, 0, t14, 0, t362);
  t367 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t354 * t355 + 0.4e1 / 0.3e1 * t23 * t363);
  t368 = t367 * t26;
  t372 = t139 * t145;
  t374 = t5 * t372 * t79;
  t380 = 0.1e1 / t144 / t6;
  t381 = t25 * t380;
  t384 = t5 * t381 * t79 / 0.12e2;
  t386 = t5 * t146 * t195;
  t389 = 0.1e1 / t37 / t57;
  t394 = t57 * t150;
  t396 = 0.1e1 / t36 / t394;
  t397 = t56 * t396;
  t401 = params->c1 * t68;
  t402 = t401 * t70;
  t403 = 0.1e1 / t307;
  t404 = t403 * t75;
  t405 = params->a * params->a;
  t412 = t404 * params->a;
  t415 = t71 * t57;
  t417 = 0.1e1 / t37 / t415;
  t418 = t182 * t417;
  t421 = t189 * t405 * t191;
  t431 = t182 * sigma[0];
  t434 = 0.1e1 / t36 / t71 / t394;
  t438 = 0.1e1 / t188 / t46;
  t440 = t51 * t54;
  t441 = t438 * t405 * t440;
  t444 = 0.11e2 / 0.27e2 * t34 * sigma[0] * t389 * t47 - t158 * t397 * t163 / 0.24e2 + t402 * t404 * t405 / 0.162e3 + 0.19e2 / 0.324e3 * t55 * t397 * t63 - 0.43e2 / 0.1296e4 * t171 * t412 + t170 * t418 * t421 / 0.1296e4 + t69 * t70 * t403 * t75 / 0.32e2 - 0.59e2 / 0.20736e5 * t69 * t418 * t192 + t69 * t431 * t434 * t441 / 0.15552e5;
  t449 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t368 * t79 - t374 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t195 + t384 - t386 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t444);
  t450 = t88 * t88;
  t451 = 0.1e1 / t450;
  t452 = t202 * t202;
  t456 = my_piecewise5(t14, 0, t10, 0, -t362);
  t460 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t451 * t452 + 0.4e1 / 0.3e1 * t88 * t456);
  t461 = t460 * t26;
  t465 = t205 * t145;
  t467 = t5 * t465 * t127;
  t469 = t90 * t380;
  t472 = t5 * t469 * t127 / 0.12e2;
  t474 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t461 * t127 - t467 / 0.4e1 + t472);
  tv2rho20 = 0.2e1 * t200 + 0.2e1 * t215 + t6 * (t449 + t474);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t477 = t354 * t219;
  t480 = 0.2e1 * t360;
  t481 = my_piecewise5(t10, 0, t14, 0, t480);
  t485 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t477 * t136 + 0.4e1 / 0.3e1 * t23 * t481);
  t486 = t485 * t26;
  t490 = t222 * t145;
  t492 = t5 * t490 * t79;
  t500 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t486 * t79 - t492 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t195 - t374 / 0.8e1 + t384 - t386 / 0.8e1);
  t501 = t451 * t230;
  t504 = my_piecewise5(t14, 0, t10, 0, -t480);
  t508 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t501 * t202 + 0.4e1 / 0.3e1 * t88 * t504);
  t509 = t508 * t26;
  t513 = t233 * t145;
  t515 = t5 * t513 * t127;
  t522 = t5 * t210 * t279;
  t525 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t509 * t127 - t515 / 0.8e1 - t467 / 0.8e1 + t472 - 0.3e1 / 0.8e1 * t5 * t206 * t279 - t522 / 0.8e1);
  tv2rho21 = t200 + t215 + t228 + t284 + t6 * (t500 + t525);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t530 = t219 * t219;
  t534 = 0.2e1 * t133 + 0.2e1 * t360;
  t535 = my_piecewise5(t10, 0, t14, 0, t534);
  t539 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t354 * t530 + 0.4e1 / 0.3e1 * t23 * t535);
  t540 = t539 * t26;
  t546 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t540 * t79 - t492 / 0.4e1 + t384);
  t547 = t230 * t230;
  t551 = my_piecewise5(t14, 0, t10, 0, -t534);
  t555 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t451 * t547 + 0.4e1 / 0.3e1 * t88 * t551);
  t556 = t555 * t26;
  t566 = 0.1e1 / t94 / t108;
  t571 = t108 * t238;
  t573 = 0.1e1 / t93 / t571;
  t574 = t107 * t573;
  t578 = t401 * t118;
  t579 = 0.1e1 / t339;
  t580 = t579 * t123;
  t587 = t580 * params->a;
  t590 = t119 * t108;
  t592 = 0.1e1 / t94 / t590;
  t593 = t267 * t592;
  t596 = t274 * t405 * t191;
  t606 = t267 * sigma[2];
  t609 = 0.1e1 / t93 / t119 / t571;
  t613 = 0.1e1 / t273 / t102;
  t615 = t613 * t405 * t440;
  t618 = 0.11e2 / 0.27e2 * t34 * sigma[2] * t566 * t103 - t158 * t574 * t249 / 0.24e2 + t578 * t580 * t405 / 0.162e3 + 0.19e2 / 0.324e3 * t55 * t574 * t114 - 0.43e2 / 0.1296e4 * t256 * t587 + t170 * t593 * t596 / 0.1296e4 + t69 * t118 * t579 * t123 / 0.32e2 - 0.59e2 / 0.20736e5 * t69 * t593 * t276 + t69 * t606 * t609 * t615 / 0.15552e5;
  t623 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t556 * t127 - t515 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t279 + t472 - t522 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t91 * t618);
  tv2rho22 = 0.2e1 * t228 + 0.2e1 * t284 + t6 * (t546 + t623);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t631 = t5 * t146 * t314 / 0.8e1;
  t636 = t161 * t63;
  t637 = params->a * sigma[0];
  t642 = t174 * t405;
  t651 = t70 * t185;
  t662 = t71 * t159;
  t664 = 0.1e1 / t36 / t662;
  t669 = -t29 * t33 * t152 * t47 / 0.9e1 + t158 * t636 * t637 / 0.72e2 - t401 * t56 * t642 / 0.432e3 - t55 * sigma[0] * t161 * t63 / 0.54e2 + 0.5e1 / 0.432e3 * t298 * t175 - t170 * t651 * t421 / 0.3456e4 - t69 * t56 * t173 * t75 / 0.96e2 + 0.7e1 / 0.6912e4 * t69 * t651 * t192 - t69 * t182 * t664 * t441 / 0.41472e5;
  t674 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t314 - t631 - 0.3e1 / 0.8e1 * t5 * t27 * t669);
  tv2rhosigma0 = t6 * t674 + t318;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t681 = t5 * t210 * t346 / 0.8e1;
  t683 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t206 * t346 - t681);
  tv2rhosigma2 = t6 * t683 + t350;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t689 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t314 - t631);
  tv2rhosigma3 = t6 * t689 + t318;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t247 * t114;
  t699 = params->a * sigma[2];
  t704 = t259 * t405;
  t713 = t118 * t270;
  t724 = t119 * t245;
  t726 = 0.1e1 / t93 / t724;
  t731 = -t29 * t33 * t240 * t103 / 0.9e1 + t158 * t698 * t699 / 0.72e2 - t401 * t107 * t704 / 0.432e3 - t55 * sigma[2] * t247 * t114 / 0.54e2 + 0.5e1 / 0.432e3 * t330 * t260 - t170 * t713 * t596 / 0.3456e4 - t69 * t107 * t258 * t123 / 0.96e2 + 0.7e1 / 0.6912e4 * t69 * t713 * t276 - t69 * t267 * t726 * t615 / 0.41472e5;
  t736 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t234 * t346 - t681 - 0.3e1 / 0.8e1 * t5 * t91 * t731);
  tv2rhosigma5 = t6 * t736 + t350;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t743 = t299 * t405;
  t753 = t56 * t309;
  t764 = t71 * t58;
  t766 = 0.1e1 / t36 / t764;
  t771 = -t158 * t60 * t63 * params->a / 0.288e3 + t401 * sigma[0] * t743 / 0.1152e4 + t52 * t54 * t60 * t63 / 0.288e3 - t170 * sigma[0] * t300 / 0.288e3 + t170 * t753 * t421 / 0.9216e4 + t69 * sigma[0] * t72 * t75 / 0.384e3 - t69 * t753 * t192 / 0.3072e4 + t69 * t70 * t766 * t441 / 0.110592e6;
  t775 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t771);
  tv2sigma20 = t6 * t775;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t781 = t331 * t405;
  t791 = t107 * t341;
  t802 = t119 * t109;
  t804 = 0.1e1 / t93 / t802;
  t809 = -t158 * t111 * t114 * params->a / 0.288e3 + t401 * sigma[2] * t781 / 0.1152e4 + t52 * t54 * t111 * t114 / 0.288e3 - t170 * sigma[2] * t332 / 0.288e3 + t170 * t791 * t596 / 0.9216e4 + t69 * sigma[2] * t120 * t123 / 0.384e3 - t69 * t791 * t276 / 0.3072e4 + t69 * t118 * t804 * t615 / 0.110592e6;
  t813 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t809);
  tv2sigma25 = t6 * t813;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t41, t42, t46, t47, t51, t52, t54, t55;
  double t56, t57, t58, t60, t62, t63, t67, t68;
  double t69, t70, t71, t72, t74, t75, t79, t83;
  double t84, t85, t86, t87, t88, t90, t91, t92;
  double t93, t94, t96, t98, t102, t103, t107, t108;
  double t109, t111, t113, t114, t118, t119, t120, t122;
  double t123, t127, t131, tzk0;

  double t132, t133, t134, t135, t136, t139, t140, t144;
  double t145, t146, t149, t150, t152, t158, t159, t161;
  double t162, t163, t170, t171, t172, t173, t174, t175;
  double t182, t183, t185, t188, t189, t191, t192, t195;
  double t200, t202, t205, t206, t210, t213, t215, tvrho0;
  double t218, t219, t222, t223, t228, t230, t233, t234;
  double t238, t240, t245, t247, t248, t249, t256, t257;
  double t258, t259, t260, t267, t268, t270, t273, t274;
  double t276, t279, t284, tvrho1, t291, t298, t299, t300;
  double t307, t309, t314, t318, tvsigma0, tvsigma1, t323, t330;
  double t331, t332, t339, t341, t346, t350, tvsigma2;

  double t353, t354, t355, t358, t359, t360, t362, t363;
  double t367, t368, t372, t374, t380, t381, t384, t386;
  double t389, t394, t396, t397, t401, t402, t403, t404;
  double t405, t412, t415, t417, t418, t421, t431, t434;
  double t438, t440, t441, t444, t449, t450, t451, t452;
  double t456, t460, t461, t465, t467, t469, t472, t474;
  double tv2rho20, t477, t480, t481, t485, t486, t490, t492;
  double t500, t501, t504, t508, t509, t513, t515, t522;
  double t525, tv2rho21, t530, t534, t535, t539, t540, t546;
  double t547, t551, t555, t556, t566, t571, t573, t574;
  double t578, t579, t580, t587, t590, t592, t593, t596;
  double t606, t609, t613, t615, t618, t623, tv2rho22, t631;
  double t636, t637, t642, t651, t662, t664, t669, t674;
  double tv2rhosigma0, tv2rhosigma1, t681, t683, tv2rhosigma2, t689, tv2rhosigma3, tv2rhosigma4;
  double t698, t699, t704, t713, t724, t726, t731, t736;
  double tv2rhosigma5, t743, t753, t764, t766, t771, t775, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t781, t791, t802, t804;
  double t809, t813, tv2sigma25;

  double t817, t818, t821, t824, t825, t826, t828, t829;
  double t833, t834, t838, t840, t845, t847, t850, t856;
  double t857, t860, t862, t865, t868, t874, t875, t879;
  double t880, t885, t886, t888, t890, t896, t902, t904;
  double t905, t908, t921, t922, t923, t924, t925, t926;
  double t929, t930, t931, t934, t939, t941, t942, t945;
  double t949, t953, t954, t958, t960, t962, t964, t966;
  double t969, t971, tv3rho30, t974, t975, t976, t979, t984;
  double t985, t986, t987, t991, t992, t996, t999, t1003;
  double t1005, t1009, t1018, t1019, t1020, t1023, t1029, t1033;
  double t1034, t1038, t1041, t1042, t1044, t1053, t1055, t1058;
  double tv3rho31, t1061, t1066, t1069, t1070, t1074, t1075, t1079;
  double t1081, t1090, t1091, t1096, t1100, t1104, t1105, t1109;
  double t1111, t1118, t1126, t1128, t1129, tv3rho32, t1134, t1140;
  double t1141, t1145, t1146, t1153, t1154, t1160, t1164, t1165;
  double t1181, t1187, t1188, t1192, t1193, t1198, t1199, t1202;
  double t1208, t1214, t1216, t1217, t1220, t1233, t1234, t1235;
  double t1238, t1239, t1240, t1243, t1248, tv3rho33, t1256, t1263;
  double t1265, t1271, t1275, t1276, t1277, t1280, t1293, t1307;
  double t1308, t1310, t1311, t1314, t1319, tv3rho2sigma0, tv3rho2sigma1, t1326;
  double t1330, t1332, tv3rho2sigma2, t1338, t1346, tv3rho2sigma3, tv3rho2sigma4, t1352;
  double t1359, t1362, tv3rho2sigma5, t1370, tv3rho2sigma6, tv3rho2sigma7, t1385, t1389;
  double t1390, t1391, t1394, t1407, t1421, t1422, t1424, t1425;
  double t1428, t1433, tv3rho2sigma8, t1440, t1445, t1448, t1458, t1464;
  double t1478, t1479, t1481, t1482, t1485, t1490, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1497, t1499, tv3rhosigma25, t1505, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1514, t1517, t1527, t1533;
  double t1547, t1548, t1550, t1551, t1554, t1559, tv3rhosigma211, t1563;
  double t1572, t1584, t1586, t1587, t1590, t1594, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1597;
  double t1606, t1618, t1620, t1621, t1624, t1628, tv3sigma39;

  gga_x_mpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_mpbe_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->c1 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = params->a * t28;
  t42 = t33 * sigma[0];
  t46 = 0.1e1 + t41 * t42 * t39 / 0.24e2;
  t47 = 0.1e1 / t46;
  t51 = t28 * t28;
  t52 = params->c2 * t51;
  t54 = 0.1e1 / t31 / t30;
  t55 = t52 * t54;
  t56 = sigma[0] * sigma[0];
  t57 = t35 * t35;
  t58 = t57 * rho[0];
  t60 = 0.1e1 / t36 / t58;
  t62 = t46 * t46;
  t63 = 0.1e1 / t62;
  t67 = t30 * t30;
  t68 = 0.1e1 / t67;
  t69 = params->c3 * t68;
  t70 = t56 * sigma[0];
  t71 = t57 * t57;
  t72 = 0.1e1 / t71;
  t74 = t62 * t46;
  t75 = 0.1e1 / t74;
  t79 = 0.1e1 + t34 * sigma[0] * t39 * t47 / 0.24e2 + t55 * t56 * t60 * t63 / 0.576e3 + t69 * t70 * t72 * t75 / 0.2304e4;
  t83 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t79);
  t84 = rho[1] <= p->dens_threshold;
  t85 = my_piecewise5(t14, t11, t10, t15, -t17);
  t86 = 0.1e1 + t85;
  t87 = t86 <= p->zeta_threshold;
  t88 = POW_1_3(t86);
  t90 = my_piecewise3(t87, t22, t88 * t86);
  t91 = t90 * t26;
  t92 = rho[1] * rho[1];
  t93 = POW_1_3(rho[1]);
  t94 = t93 * t93;
  t96 = 0.1e1 / t94 / t92;
  t98 = t33 * sigma[2];
  t102 = 0.1e1 + t41 * t98 * t96 / 0.24e2;
  t103 = 0.1e1 / t102;
  t107 = sigma[2] * sigma[2];
  t108 = t92 * t92;
  t109 = t108 * rho[1];
  t111 = 0.1e1 / t93 / t109;
  t113 = t102 * t102;
  t114 = 0.1e1 / t113;
  t118 = t107 * sigma[2];
  t119 = t108 * t108;
  t120 = 0.1e1 / t119;
  t122 = t113 * t102;
  t123 = 0.1e1 / t122;
  t127 = 0.1e1 + t34 * sigma[2] * t96 * t103 / 0.24e2 + t55 * t107 * t111 * t114 / 0.576e3 + t69 * t118 * t120 * t123 / 0.2304e4;
  t131 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t127);
  tzk0 = t83 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t132 = t6 * t6;
  t133 = 0.1e1 / t132;
  t134 = t16 * t133;
  t135 = t7 - t134;
  t136 = my_piecewise5(t10, 0, t14, 0, t135);
  t139 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t136);
  t140 = t139 * t26;
  t144 = t26 * t26;
  t145 = 0.1e1 / t144;
  t146 = t25 * t145;
  t149 = t5 * t146 * t79 / 0.8e1;
  t150 = t35 * rho[0];
  t152 = 0.1e1 / t37 / t150;
  t158 = params->c1 * t51 * t54;
  t159 = t57 * t35;
  t161 = 0.1e1 / t36 / t159;
  t162 = t56 * t161;
  t163 = t63 * params->a;
  t170 = params->c2 * t68;
  t171 = t170 * t70;
  t172 = t71 * rho[0];
  t173 = 0.1e1 / t172;
  t174 = t173 * t75;
  t175 = t174 * params->a;
  t182 = t56 * t56;
  t183 = t71 * t150;
  t185 = 0.1e1 / t37 / t183;
  t188 = t62 * t62;
  t189 = 0.1e1 / t188;
  t191 = t28 * t33;
  t192 = t189 * params->a * t191;
  t195 = -t34 * sigma[0] * t152 * t47 / 0.9e1 + t158 * t162 * t163 / 0.216e3 - t55 * t162 * t63 / 0.108e3 + t171 * t175 / 0.432e3 - t69 * t70 * t173 * t75 / 0.288e3 + t69 * t182 * t185 * t192 / 0.6912e4;
  t200 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t79 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t195);
  t202 = my_piecewise5(t14, 0, t10, 0, -t135);
  t205 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t88 * t202);
  t206 = t205 * t26;
  t210 = t90 * t145;
  t213 = t5 * t210 * t127 / 0.8e1;
  t215 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t206 * t127 - t213);
  tvrho0 = t83 + t131 + t6 * (t200 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t218 = -t7 - t134;
  t219 = my_piecewise5(t10, 0, t14, 0, t218);
  t222 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t219);
  t223 = t222 * t26;
  t228 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t79 - t149);
  t230 = my_piecewise5(t14, 0, t10, 0, -t218);
  t233 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t88 * t230);
  t234 = t233 * t26;
  t238 = t92 * rho[1];
  t240 = 0.1e1 / t94 / t238;
  t245 = t108 * t92;
  t247 = 0.1e1 / t93 / t245;
  t248 = t107 * t247;
  t249 = t114 * params->a;
  t256 = t170 * t118;
  t257 = t119 * rho[1];
  t258 = 0.1e1 / t257;
  t259 = t258 * t123;
  t260 = t259 * params->a;
  t267 = t107 * t107;
  t268 = t119 * t238;
  t270 = 0.1e1 / t94 / t268;
  t273 = t113 * t113;
  t274 = 0.1e1 / t273;
  t276 = t274 * params->a * t191;
  t279 = -t34 * sigma[2] * t240 * t103 / 0.9e1 + t158 * t248 * t249 / 0.216e3 - t55 * t248 * t114 / 0.108e3 + t256 * t260 / 0.432e3 - t69 * t118 * t258 * t123 / 0.288e3 + t69 * t267 * t270 * t276 / 0.6912e4;
  t284 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t234 * t127 - t213 - 0.3e1 / 0.8e1 * t5 * t91 * t279);
  tvrho1 = t83 + t131 + t6 * (t228 + t284);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t291 = sigma[0] * t60;
  t298 = t170 * t56;
  t299 = t72 * t75;
  t300 = t299 * params->a;
  t307 = t71 * t35;
  t309 = 0.1e1 / t37 / t307;
  t314 = t29 * t33 * t39 * t47 / 0.24e2 - t158 * t291 * t163 / 0.576e3 + t55 * t291 * t63 / 0.288e3 - t298 * t300 / 0.1152e4 + t69 * t56 * t72 * t75 / 0.768e3 - t69 * t70 * t309 * t192 / 0.18432e5;
  t318 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t314);
  tvsigma0 = t6 * t318;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t323 = sigma[2] * t111;
  t330 = t170 * t107;
  t331 = t120 * t123;
  t332 = t331 * params->a;
  t339 = t119 * t92;
  t341 = 0.1e1 / t94 / t339;
  t346 = t29 * t33 * t96 * t103 / 0.24e2 - t158 * t323 * t249 / 0.576e3 + t55 * t323 * t114 / 0.288e3 - t330 * t332 / 0.1152e4 + t69 * t107 * t120 * t123 / 0.768e3 - t69 * t118 * t341 * t276 / 0.18432e5;
  t350 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t346);
  tvsigma2 = t6 * t350;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t353 = t23 * t23;
  t354 = 0.1e1 / t353;
  t355 = t136 * t136;
  t358 = t132 * t6;
  t359 = 0.1e1 / t358;
  t360 = t16 * t359;
  t362 = -0.2e1 * t133 + 0.2e1 * t360;
  t363 = my_piecewise5(t10, 0, t14, 0, t362);
  t367 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t354 * t355 + 0.4e1 / 0.3e1 * t23 * t363);
  t368 = t367 * t26;
  t372 = t139 * t145;
  t374 = t5 * t372 * t79;
  t380 = 0.1e1 / t144 / t6;
  t381 = t25 * t380;
  t384 = t5 * t381 * t79 / 0.12e2;
  t386 = t5 * t146 * t195;
  t389 = 0.1e1 / t37 / t57;
  t394 = t57 * t150;
  t396 = 0.1e1 / t36 / t394;
  t397 = t56 * t396;
  t401 = params->c1 * t68;
  t402 = t401 * t70;
  t403 = 0.1e1 / t307;
  t404 = t403 * t75;
  t405 = params->a * params->a;
  t412 = t404 * params->a;
  t415 = t71 * t57;
  t417 = 0.1e1 / t37 / t415;
  t418 = t182 * t417;
  t421 = t189 * t405 * t191;
  t431 = t182 * sigma[0];
  t434 = 0.1e1 / t36 / t71 / t394;
  t438 = 0.1e1 / t188 / t46;
  t440 = t51 * t54;
  t441 = t438 * t405 * t440;
  t444 = 0.11e2 / 0.27e2 * t34 * sigma[0] * t389 * t47 - t158 * t397 * t163 / 0.24e2 + t402 * t404 * t405 / 0.162e3 + 0.19e2 / 0.324e3 * t55 * t397 * t63 - 0.43e2 / 0.1296e4 * t171 * t412 + t170 * t418 * t421 / 0.1296e4 + t69 * t70 * t403 * t75 / 0.32e2 - 0.59e2 / 0.20736e5 * t69 * t418 * t192 + t69 * t431 * t434 * t441 / 0.15552e5;
  t449 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t368 * t79 - t374 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t195 + t384 - t386 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t444);
  t450 = t88 * t88;
  t451 = 0.1e1 / t450;
  t452 = t202 * t202;
  t456 = my_piecewise5(t14, 0, t10, 0, -t362);
  t460 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t451 * t452 + 0.4e1 / 0.3e1 * t88 * t456);
  t461 = t460 * t26;
  t465 = t205 * t145;
  t467 = t5 * t465 * t127;
  t469 = t90 * t380;
  t472 = t5 * t469 * t127 / 0.12e2;
  t474 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t461 * t127 - t467 / 0.4e1 + t472);
  tv2rho20 = 0.2e1 * t200 + 0.2e1 * t215 + t6 * (t449 + t474);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t477 = t354 * t219;
  t480 = 0.2e1 * t360;
  t481 = my_piecewise5(t10, 0, t14, 0, t480);
  t485 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t477 * t136 + 0.4e1 / 0.3e1 * t23 * t481);
  t486 = t485 * t26;
  t490 = t222 * t145;
  t492 = t5 * t490 * t79;
  t500 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t486 * t79 - t492 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t195 - t374 / 0.8e1 + t384 - t386 / 0.8e1);
  t501 = t451 * t230;
  t504 = my_piecewise5(t14, 0, t10, 0, -t480);
  t508 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t501 * t202 + 0.4e1 / 0.3e1 * t88 * t504);
  t509 = t508 * t26;
  t513 = t233 * t145;
  t515 = t5 * t513 * t127;
  t522 = t5 * t210 * t279;
  t525 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t509 * t127 - t515 / 0.8e1 - t467 / 0.8e1 + t472 - 0.3e1 / 0.8e1 * t5 * t206 * t279 - t522 / 0.8e1);
  tv2rho21 = t200 + t215 + t228 + t284 + t6 * (t500 + t525);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t530 = t219 * t219;
  t534 = 0.2e1 * t133 + 0.2e1 * t360;
  t535 = my_piecewise5(t10, 0, t14, 0, t534);
  t539 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t354 * t530 + 0.4e1 / 0.3e1 * t23 * t535);
  t540 = t539 * t26;
  t546 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t540 * t79 - t492 / 0.4e1 + t384);
  t547 = t230 * t230;
  t551 = my_piecewise5(t14, 0, t10, 0, -t534);
  t555 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t451 * t547 + 0.4e1 / 0.3e1 * t88 * t551);
  t556 = t555 * t26;
  t566 = 0.1e1 / t94 / t108;
  t571 = t108 * t238;
  t573 = 0.1e1 / t93 / t571;
  t574 = t107 * t573;
  t578 = t401 * t118;
  t579 = 0.1e1 / t339;
  t580 = t579 * t123;
  t587 = t580 * params->a;
  t590 = t119 * t108;
  t592 = 0.1e1 / t94 / t590;
  t593 = t267 * t592;
  t596 = t274 * t405 * t191;
  t606 = t267 * sigma[2];
  t609 = 0.1e1 / t93 / t119 / t571;
  t613 = 0.1e1 / t273 / t102;
  t615 = t613 * t405 * t440;
  t618 = 0.11e2 / 0.27e2 * t34 * sigma[2] * t566 * t103 - t158 * t574 * t249 / 0.24e2 + t578 * t580 * t405 / 0.162e3 + 0.19e2 / 0.324e3 * t55 * t574 * t114 - 0.43e2 / 0.1296e4 * t256 * t587 + t170 * t593 * t596 / 0.1296e4 + t69 * t118 * t579 * t123 / 0.32e2 - 0.59e2 / 0.20736e5 * t69 * t593 * t276 + t69 * t606 * t609 * t615 / 0.15552e5;
  t623 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t556 * t127 - t515 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t279 + t472 - t522 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t91 * t618);
  tv2rho22 = 0.2e1 * t228 + 0.2e1 * t284 + t6 * (t546 + t623);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t631 = t5 * t146 * t314 / 0.8e1;
  t636 = t161 * t63;
  t637 = params->a * sigma[0];
  t642 = t174 * t405;
  t651 = t70 * t185;
  t662 = t71 * t159;
  t664 = 0.1e1 / t36 / t662;
  t669 = -t29 * t33 * t152 * t47 / 0.9e1 + t158 * t636 * t637 / 0.72e2 - t401 * t56 * t642 / 0.432e3 - t55 * sigma[0] * t161 * t63 / 0.54e2 + 0.5e1 / 0.432e3 * t298 * t175 - t170 * t651 * t421 / 0.3456e4 - t69 * t56 * t173 * t75 / 0.96e2 + 0.7e1 / 0.6912e4 * t69 * t651 * t192 - t69 * t182 * t664 * t441 / 0.41472e5;
  t674 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t314 - t631 - 0.3e1 / 0.8e1 * t5 * t27 * t669);
  tv2rhosigma0 = t6 * t674 + t318;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t681 = t5 * t210 * t346 / 0.8e1;
  t683 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t206 * t346 - t681);
  tv2rhosigma2 = t6 * t683 + t350;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t689 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t314 - t631);
  tv2rhosigma3 = t6 * t689 + t318;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t247 * t114;
  t699 = params->a * sigma[2];
  t704 = t259 * t405;
  t713 = t118 * t270;
  t724 = t119 * t245;
  t726 = 0.1e1 / t93 / t724;
  t731 = -t29 * t33 * t240 * t103 / 0.9e1 + t158 * t698 * t699 / 0.72e2 - t401 * t107 * t704 / 0.432e3 - t55 * sigma[2] * t247 * t114 / 0.54e2 + 0.5e1 / 0.432e3 * t330 * t260 - t170 * t713 * t596 / 0.3456e4 - t69 * t107 * t258 * t123 / 0.96e2 + 0.7e1 / 0.6912e4 * t69 * t713 * t276 - t69 * t267 * t726 * t615 / 0.41472e5;
  t736 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t234 * t346 - t681 - 0.3e1 / 0.8e1 * t5 * t91 * t731);
  tv2rhosigma5 = t6 * t736 + t350;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t743 = t299 * t405;
  t753 = t56 * t309;
  t764 = t71 * t58;
  t766 = 0.1e1 / t36 / t764;
  t771 = -t158 * t60 * t63 * params->a / 0.288e3 + t401 * sigma[0] * t743 / 0.1152e4 + t52 * t54 * t60 * t63 / 0.288e3 - t170 * sigma[0] * t300 / 0.288e3 + t170 * t753 * t421 / 0.9216e4 + t69 * sigma[0] * t72 * t75 / 0.384e3 - t69 * t753 * t192 / 0.3072e4 + t69 * t70 * t766 * t441 / 0.110592e6;
  t775 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t771);
  tv2sigma20 = t6 * t775;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t781 = t331 * t405;
  t791 = t107 * t341;
  t802 = t119 * t109;
  t804 = 0.1e1 / t93 / t802;
  t809 = -t158 * t111 * t114 * params->a / 0.288e3 + t401 * sigma[2] * t781 / 0.1152e4 + t52 * t54 * t111 * t114 / 0.288e3 - t170 * sigma[2] * t332 / 0.288e3 + t170 * t791 * t596 / 0.9216e4 + t69 * sigma[2] * t120 * t123 / 0.384e3 - t69 * t791 * t276 / 0.3072e4 + t69 * t118 * t804 * t615 / 0.110592e6;
  t813 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t809);
  tv2sigma25 = t6 * t813;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t817 = 0.1e1 / t353 / t19;
  t818 = t355 * t136;
  t821 = t354 * t136;
  t824 = t132 * t132;
  t825 = 0.1e1 / t824;
  t826 = t16 * t825;
  t828 = 0.6e1 * t359 - 0.6e1 * t826;
  t829 = my_piecewise5(t10, 0, t14, 0, t828);
  t833 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t817 * t818 + 0.4e1 / 0.3e1 * t821 * t363 + 0.4e1 / 0.3e1 * t23 * t829);
  t834 = t833 * t26;
  t838 = t367 * t145;
  t840 = t5 * t838 * t79;
  t845 = t139 * t380;
  t847 = t5 * t845 * t79;
  t850 = t5 * t372 * t195;
  t856 = 0.1e1 / t144 / t132;
  t857 = t25 * t856;
  t860 = 0.5e1 / 0.36e2 * t5 * t857 * t79;
  t862 = t5 * t381 * t195;
  t865 = t5 * t146 * t444;
  t868 = 0.1e1 / t37 / t58;
  t874 = 0.1e1 / t36 / t71;
  t875 = t56 * t874;
  t879 = 0.1e1 / t183;
  t880 = t879 * t75;
  t885 = 0.1e1 / t37 / t764;
  t886 = t182 * t885;
  t888 = t405 * params->a;
  t890 = t189 * t888 * t191;
  t896 = t880 * params->a;
  t902 = t71 * t71;
  t904 = 0.1e1 / t36 / t902;
  t905 = t431 * t904;
  t908 = t438 * t888 * t440;
  t921 = t67 * t67;
  t922 = 0.1e1 / t921;
  t923 = params->c3 * t922;
  t924 = t182 * t56;
  t925 = t923 * t924;
  t926 = t902 * t150;
  t929 = 0.1e1 / t188 / t62;
  t930 = 0.1e1 / t926 * t929;
  t931 = t930 * t888;
  t934 = -0.154e3 / 0.81e2 * t34 * sigma[0] * t868 * t47 + 0.341e3 / 0.972e3 * t158 * t875 * t163 - 0.19e2 / 0.162e3 * t402 * t880 * t405 + t401 * t886 * t890 / 0.486e3 - 0.209e3 / 0.486e3 * t55 * t875 * t63 + 0.797e3 / 0.1944e4 * t171 * t896 - t170 * t886 * t421 / 0.48e2 + t170 * t905 * t908 / 0.2916e4 - 0.5e1 / 0.16e2 * t69 * t70 * t879 * t75 + 0.1445e4 / 0.31104e5 * t69 * t886 * t192 - 0.35e2 / 0.15552e5 * t69 * t905 * t441 + 0.5e1 / 0.23328e5 * t925 * t931;
  t939 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t834 * t79 - 0.3e1 / 0.8e1 * t840 - 0.9e1 / 0.8e1 * t5 * t368 * t195 + t847 / 0.4e1 - 0.3e1 / 0.4e1 * t850 - 0.9e1 / 0.8e1 * t5 * t140 * t444 - t860 + t862 / 0.4e1 - 0.3e1 / 0.8e1 * t865 - 0.3e1 / 0.8e1 * t5 * t27 * t934);
  t941 = 0.1e1 / t450 / t86;
  t942 = t452 * t202;
  t945 = t451 * t202;
  t949 = my_piecewise5(t14, 0, t10, 0, -t828);
  t953 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t941 * t942 + 0.4e1 / 0.3e1 * t945 * t456 + 0.4e1 / 0.3e1 * t88 * t949);
  t954 = t953 * t26;
  t958 = t460 * t145;
  t960 = t5 * t958 * t127;
  t962 = t205 * t380;
  t964 = t5 * t962 * t127;
  t966 = t90 * t856;
  t969 = 0.5e1 / 0.36e2 * t5 * t966 * t127;
  t971 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t954 * t127 - 0.3e1 / 0.8e1 * t960 + t964 / 0.4e1 - t969);
  tv3rho30 = 0.3e1 * t449 + 0.3e1 * t474 + t6 * (t939 + t971);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t974 = 0.2e1 * t500;
  t975 = 0.2e1 * t525;
  t976 = t817 * t219;
  t979 = t354 * t481;
  t984 = 0.2e1 * t359;
  t985 = 0.6e1 * t826;
  t986 = t984 - t985;
  t987 = my_piecewise5(t10, 0, t14, 0, t986);
  t991 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t976 * t355 + 0.8e1 / 0.9e1 * t979 * t136 + 0.4e1 / 0.9e1 * t477 * t363 + 0.4e1 / 0.3e1 * t23 * t987);
  t992 = t991 * t26;
  t996 = t485 * t145;
  t999 = t5 * t996 * t79 / 0.4e1;
  t1003 = t222 * t380;
  t1005 = t5 * t1003 * t79;
  t1009 = t5 * t490 * t195 / 0.4e1;
  t1018 = -0.3e1 / 0.8e1 * t5 * t992 * t79 - t999 - 0.3e1 / 0.4e1 * t5 * t486 * t195 + t1005 / 0.12e2 - t1009 - 0.3e1 / 0.8e1 * t5 * t223 * t444 - t840 / 0.8e1 + t847 / 0.6e1 - t850 / 0.4e1 - t860 + t862 / 0.6e1 - t865 / 0.8e1;
  t1019 = my_piecewise3(t1, 0, t1018);
  t1020 = t941 * t230;
  t1023 = t451 * t504;
  t1029 = my_piecewise5(t14, 0, t10, 0, -t986);
  t1033 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t1020 * t452 + 0.8e1 / 0.9e1 * t1023 * t202 + 0.4e1 / 0.9e1 * t501 * t456 + 0.4e1 / 0.3e1 * t88 * t1029);
  t1034 = t1033 * t26;
  t1038 = t508 * t145;
  t1041 = t5 * t1038 * t127 / 0.4e1;
  t1042 = t233 * t380;
  t1044 = t5 * t1042 * t127;
  t1053 = t5 * t465 * t279 / 0.4e1;
  t1055 = t5 * t469 * t279;
  t1058 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t1034 * t127 - t1041 + t1044 / 0.12e2 - t960 / 0.8e1 + t964 / 0.6e1 - t969 - 0.3e1 / 0.8e1 * t5 * t461 * t279 - t1053 + t1055 / 0.12e2);
  tv3rho31 = t449 + t474 + t974 + t975 + t6 * (t1019 + t1058);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1061 = t817 * t530;
  t1066 = t354 * t535;
  t1069 = -t984 - t985;
  t1070 = my_piecewise5(t10, 0, t14, 0, t1069);
  t1074 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1061 * t136 + 0.8e1 / 0.9e1 * t477 * t481 + 0.4e1 / 0.9e1 * t1066 * t136 + 0.4e1 / 0.3e1 * t23 * t1070);
  t1075 = t1074 * t26;
  t1079 = t539 * t145;
  t1081 = t5 * t1079 * t79;
  t1090 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1075 * t79 - t1081 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t540 * t195 - t999 + t1005 / 0.6e1 - t1009 + t847 / 0.12e2 - t860 + t862 / 0.12e2);
  t1091 = t941 * t547;
  t1096 = t451 * t551;
  t1100 = my_piecewise5(t14, 0, t10, 0, -t1069);
  t1104 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t1091 * t202 + 0.8e1 / 0.9e1 * t501 * t504 + 0.4e1 / 0.9e1 * t1096 * t202 + 0.4e1 / 0.3e1 * t88 * t1100);
  t1105 = t1104 * t26;
  t1109 = t555 * t145;
  t1111 = t5 * t1109 * t127;
  t1118 = t5 * t513 * t279;
  t1126 = t5 * t210 * t618;
  t1128 = -0.3e1 / 0.8e1 * t5 * t1105 * t127 - t1111 / 0.8e1 - t1041 + t1044 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t509 * t279 - t1118 / 0.4e1 + t964 / 0.12e2 - t969 - t1053 + t1055 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t206 * t618 - t1126 / 0.8e1;
  t1129 = my_piecewise3(t84, 0, t1128);
  tv3rho32 = t974 + t975 + t546 + t623 + t6 * (t1090 + t1129);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1134 = t530 * t219;
  t1140 = -0.6e1 * t359 - 0.6e1 * t826;
  t1141 = my_piecewise5(t10, 0, t14, 0, t1140);
  t1145 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t817 * t1134 + 0.4e1 / 0.3e1 * t477 * t535 + 0.4e1 / 0.3e1 * t23 * t1141);
  t1146 = t1145 * t26;
  t1153 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1146 * t79 - 0.3e1 / 0.8e1 * t1081 + t1005 / 0.4e1 - t860);
  t1154 = t547 * t230;
  t1160 = my_piecewise5(t14, 0, t10, 0, -t1140);
  t1164 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t941 * t1154 + 0.4e1 / 0.3e1 * t501 * t551 + 0.4e1 / 0.3e1 * t88 * t1160);
  t1165 = t1164 * t26;
  t1181 = 0.1e1 / t94 / t109;
  t1187 = 0.1e1 / t93 / t119;
  t1188 = t107 * t1187;
  t1192 = 0.1e1 / t268;
  t1193 = t1192 * t123;
  t1198 = 0.1e1 / t94 / t802;
  t1199 = t267 * t1198;
  t1202 = t274 * t888 * t191;
  t1208 = t1193 * params->a;
  t1214 = t119 * t119;
  t1216 = 0.1e1 / t93 / t1214;
  t1217 = t606 * t1216;
  t1220 = t613 * t888 * t440;
  t1233 = t267 * t107;
  t1234 = t923 * t1233;
  t1235 = t1214 * t238;
  t1238 = 0.1e1 / t273 / t113;
  t1239 = 0.1e1 / t1235 * t1238;
  t1240 = t1239 * t888;
  t1243 = -0.154e3 / 0.81e2 * t34 * sigma[2] * t1181 * t103 + 0.341e3 / 0.972e3 * t158 * t1188 * t249 - 0.19e2 / 0.162e3 * t578 * t1193 * t405 + t401 * t1199 * t1202 / 0.486e3 - 0.209e3 / 0.486e3 * t55 * t1188 * t114 + 0.797e3 / 0.1944e4 * t256 * t1208 - t170 * t1199 * t596 / 0.48e2 + t170 * t1217 * t1220 / 0.2916e4 - 0.5e1 / 0.16e2 * t69 * t118 * t1192 * t123 + 0.1445e4 / 0.31104e5 * t69 * t1199 * t276 - 0.35e2 / 0.15552e5 * t69 * t1217 * t615 + 0.5e1 / 0.23328e5 * t1234 * t1240;
  t1248 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t1165 * t127 - 0.3e1 / 0.8e1 * t1111 - 0.9e1 / 0.8e1 * t5 * t556 * t279 + t1044 / 0.4e1 - 0.3e1 / 0.4e1 * t1118 - 0.9e1 / 0.8e1 * t5 * t234 * t618 - t969 + t1055 / 0.4e1 - 0.3e1 / 0.8e1 * t1126 - 0.3e1 / 0.8e1 * t5 * t91 * t1243);
  tv3rho33 = 0.3e1 * t546 + 0.3e1 * t623 + t6 * (t1153 + t1248);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1256 = t5 * t372 * t314;
  t1263 = t5 * t381 * t314 / 0.12e2;
  t1265 = t5 * t146 * t669;
  t1271 = t396 * t63;
  t1275 = t401 * t403;
  t1276 = t75 * t405;
  t1277 = t1276 * t56;
  t1280 = t70 * t417;
  t1293 = t182 * t434;
  t1307 = t923 * t431;
  t1308 = t902 * t35;
  t1310 = 0.1e1 / t1308 * t929;
  t1311 = t1310 * t888;
  t1314 = 0.11e2 / 0.27e2 * t29 * t33 * t389 * t47 - 0.65e2 / 0.648e3 * t158 * t1271 * t637 + 0.17e2 / 0.432e3 * t1275 * t1277 - t401 * t1280 * t890 / 0.1296e4 + 0.19e2 / 0.162e3 * t55 * sigma[0] * t396 * t63 - 0.167e3 / 0.1296e4 * t298 * t412 + 0.25e2 / 0.3456e4 * t170 * t1280 * t421 - t170 * t1293 * t908 / 0.7776e4 + 0.3e1 / 0.32e2 * t69 * t56 * t403 * t75 - 0.317e3 / 0.20736e5 * t69 * t1280 * t192 + 0.11e2 / 0.13824e5 * t69 * t1293 * t441 - 0.5e1 / 0.62208e5 * t1307 * t1311;
  t1319 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t368 * t314 - t1256 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t669 + t1263 - t1265 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1314);
  tv3rho2sigma0 = t6 * t1319 + 0.2e1 * t674;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1326 = t5 * t465 * t346;
  t1330 = t5 * t469 * t346 / 0.12e2;
  t1332 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t461 * t346 - t1326 / 0.4e1 + t1330);
  tv3rho2sigma2 = t6 * t1332 + 0.2e1 * t683;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1338 = t5 * t490 * t314;
  t1346 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t486 * t314 - t1338 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t669 - t1256 / 0.8e1 + t1263 - t1265 / 0.8e1);
  tv3rho2sigma3 = t6 * t1346 + t674 + t689;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1352 = t5 * t513 * t346;
  t1359 = t5 * t210 * t731;
  t1362 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t509 * t346 - t1352 / 0.8e1 - t1326 / 0.8e1 + t1330 - 0.3e1 / 0.8e1 * t5 * t206 * t731 - t1359 / 0.8e1);
  tv3rho2sigma5 = t6 * t1362 + t683 + t736;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1370 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t540 * t314 - t1338 / 0.4e1 + t1263);
  tv3rho2sigma6 = t6 * t1370 + 0.2e1 * t689;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1385 = t573 * t114;
  t1389 = t401 * t579;
  t1390 = t123 * t405;
  t1391 = t1390 * t107;
  t1394 = t118 * t592;
  t1407 = t267 * t609;
  t1421 = t923 * t606;
  t1422 = t1214 * t92;
  t1424 = 0.1e1 / t1422 * t1238;
  t1425 = t1424 * t888;
  t1428 = 0.11e2 / 0.27e2 * t29 * t33 * t566 * t103 - 0.65e2 / 0.648e3 * t158 * t1385 * t699 + 0.17e2 / 0.432e3 * t1389 * t1391 - t401 * t1394 * t1202 / 0.1296e4 + 0.19e2 / 0.162e3 * t55 * sigma[2] * t573 * t114 - 0.167e3 / 0.1296e4 * t330 * t587 + 0.25e2 / 0.3456e4 * t170 * t1394 * t596 - t170 * t1407 * t1220 / 0.7776e4 + 0.3e1 / 0.32e2 * t69 * t107 * t579 * t123 - 0.317e3 / 0.20736e5 * t69 * t1394 * t276 + 0.11e2 / 0.13824e5 * t69 * t1407 * t615 - 0.5e1 / 0.62208e5 * t1421 * t1425;
  t1433 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t556 * t346 - t1352 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t731 + t1330 - t1359 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t91 * t1428);
  tv3rho2sigma8 = t6 * t1433 + 0.2e1 * t736;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1440 = t5 * t146 * t771 / 0.8e1;
  t1445 = t1276 * sigma[0];
  t1448 = t56 * t185;
  t1458 = t75 * params->a * sigma[0];
  t1464 = t70 * t664;
  t1478 = t923 * t182;
  t1479 = t902 * rho[0];
  t1481 = 0.1e1 / t1479 * t929;
  t1482 = t1481 * t888;
  t1485 = t158 * t636 * params->a / 0.54e2 - 0.5e1 / 0.432e3 * t401 * t173 * t1445 + t401 * t1448 * t890 / 0.3456e4 - t52 * t54 * t161 * t63 / 0.54e2 + 0.7e1 / 0.216e3 * t170 * t173 * t1458 - t170 * t1448 * t421 / 0.432e3 + t170 * t1464 * t908 / 0.20736e5 - t69 * sigma[0] * t173 * t75 / 0.48e2 + 0.5e1 / 0.1152e4 * t69 * t1448 * t192 - 0.11e2 / 0.41472e5 * t69 * t1464 * t441 + 0.5e1 / 0.165888e6 * t1478 * t1482;
  t1490 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t771 - t1440 - 0.3e1 / 0.8e1 * t5 * t27 * t1485);
  tv3rhosigma20 = t6 * t1490 + t775;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1497 = t5 * t210 * t809 / 0.8e1;
  t1499 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t206 * t809 - t1497);
  tv3rhosigma25 = t6 * t1499 + t813;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1505 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t771 - t1440);
  tv3rhosigma26 = t6 * t1505 + t775;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1514 = t1390 * sigma[2];
  t1517 = t107 * t270;
  t1527 = t123 * params->a * sigma[2];
  t1533 = t118 * t726;
  t1547 = t923 * t267;
  t1548 = t1214 * rho[1];
  t1550 = 0.1e1 / t1548 * t1238;
  t1551 = t1550 * t888;
  t1554 = t158 * t698 * params->a / 0.54e2 - 0.5e1 / 0.432e3 * t401 * t258 * t1514 + t401 * t1517 * t1202 / 0.3456e4 - t52 * t54 * t247 * t114 / 0.54e2 + 0.7e1 / 0.216e3 * t170 * t258 * t1527 - t170 * t1517 * t596 / 0.432e3 + t170 * t1533 * t1220 / 0.20736e5 - t69 * sigma[2] * t258 * t123 / 0.48e2 + 0.5e1 / 0.1152e4 * t69 * t1517 * t276 - 0.11e2 / 0.41472e5 * t69 * t1533 * t615 + 0.5e1 / 0.165888e6 * t1547 * t1551;
  t1559 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t234 * t809 - t1497 - 0.3e1 / 0.8e1 * t5 * t91 * t1554);
  tv3rhosigma211 = t6 * t1559 + t813;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1563 = sigma[0] * t309;
  t1572 = t56 * t766;
  t1584 = t923 * t70;
  t1586 = 0.1e1 / t902 * t929;
  t1587 = t1586 * t888;
  t1590 = t401 * t743 / 0.384e3 - t401 * t1563 * t890 / 0.9216e4 - t170 * t300 / 0.192e3 + t170 * t1563 * t421 / 0.1536e4 - t170 * t1572 * t908 / 0.55296e5 + t69 * t299 / 0.384e3 - t69 * t1563 * t192 / 0.1024e4 + t69 * t1572 * t441 / 0.12288e5 - 0.5e1 / 0.442368e6 * t1584 * t1587;
  t1594 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1590);
  tv3sigma30 = t6 * t1594;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1597 = sigma[2] * t341;
  t1606 = t107 * t804;
  t1618 = t923 * t118;
  t1620 = 0.1e1 / t1214 * t1238;
  t1621 = t1620 * t888;
  t1624 = t401 * t781 / 0.384e3 - t401 * t1597 * t1202 / 0.9216e4 - t170 * t332 / 0.192e3 + t170 * t1597 * t596 / 0.1536e4 - t170 * t1606 * t1220 / 0.55296e5 + t69 * t331 / 0.384e3 - t69 * t1597 * t276 / 0.1024e4 + t69 * t1606 * t615 / 0.12288e5 - 0.5e1 / 0.442368e6 * t1618 * t1621;
  t1628 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t1624);
  tv3sigma39 = t6 * t1628;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t41, t42, t46, t47, t51, t52, t54, t55;
  double t56, t57, t58, t60, t62, t63, t67, t68;
  double t69, t70, t71, t72, t74, t75, t79, t83;
  double t84, t85, t86, t87, t88, t90, t91, t92;
  double t93, t94, t96, t98, t102, t103, t107, t108;
  double t109, t111, t113, t114, t118, t119, t120, t122;
  double t123, t127, t131, tzk0;

  double t132, t133, t134, t135, t136, t139, t140, t144;
  double t145, t146, t149, t150, t152, t158, t159, t161;
  double t162, t163, t170, t171, t172, t173, t174, t175;
  double t182, t183, t185, t188, t189, t191, t192, t195;
  double t200, t202, t205, t206, t210, t213, t215, tvrho0;
  double t218, t219, t222, t223, t228, t230, t233, t234;
  double t238, t240, t245, t247, t248, t249, t256, t257;
  double t258, t259, t260, t267, t268, t270, t273, t274;
  double t276, t279, t284, tvrho1, t291, t298, t299, t300;
  double t307, t309, t314, t318, tvsigma0, tvsigma1, t323, t330;
  double t331, t332, t339, t341, t346, t350, tvsigma2;

  double t353, t354, t355, t358, t359, t360, t362, t363;
  double t367, t368, t372, t374, t380, t381, t384, t386;
  double t389, t394, t396, t397, t401, t402, t403, t404;
  double t405, t412, t415, t417, t418, t421, t431, t434;
  double t438, t440, t441, t444, t449, t450, t451, t452;
  double t456, t460, t461, t465, t467, t469, t472, t474;
  double tv2rho20, t477, t480, t481, t485, t486, t490, t492;
  double t500, t501, t504, t508, t509, t513, t515, t522;
  double t525, tv2rho21, t530, t534, t535, t539, t540, t546;
  double t547, t551, t555, t556, t566, t571, t573, t574;
  double t578, t579, t580, t587, t590, t592, t593, t596;
  double t606, t609, t613, t615, t618, t623, tv2rho22, t631;
  double t636, t637, t642, t651, t662, t664, t669, t674;
  double tv2rhosigma0, tv2rhosigma1, t681, t683, tv2rhosigma2, t689, tv2rhosigma3, tv2rhosigma4;
  double t698, t699, t704, t713, t724, t726, t731, t736;
  double tv2rhosigma5, t743, t753, t764, t766, t771, t775, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t781, t791, t802, t804;
  double t809, t813, tv2sigma25;

  double t817, t818, t821, t824, t825, t826, t828, t829;
  double t833, t834, t838, t840, t845, t847, t850, t856;
  double t857, t860, t862, t865, t868, t874, t875, t879;
  double t880, t885, t886, t888, t890, t896, t902, t904;
  double t905, t908, t921, t922, t923, t924, t925, t926;
  double t929, t930, t931, t934, t939, t941, t942, t945;
  double t949, t953, t954, t958, t960, t962, t964, t966;
  double t969, t971, tv3rho30, t974, t975, t976, t979, t984;
  double t985, t986, t987, t991, t992, t996, t999, t1003;
  double t1005, t1009, t1018, t1019, t1020, t1023, t1029, t1033;
  double t1034, t1038, t1041, t1042, t1044, t1053, t1055, t1058;
  double tv3rho31, t1061, t1066, t1069, t1070, t1074, t1075, t1079;
  double t1081, t1090, t1091, t1096, t1100, t1104, t1105, t1109;
  double t1111, t1118, t1126, t1128, t1129, tv3rho32, t1134, t1140;
  double t1141, t1145, t1146, t1153, t1154, t1160, t1164, t1165;
  double t1181, t1187, t1188, t1192, t1193, t1198, t1199, t1202;
  double t1208, t1214, t1216, t1217, t1220, t1233, t1234, t1235;
  double t1238, t1239, t1240, t1243, t1248, tv3rho33, t1256, t1263;
  double t1265, t1271, t1275, t1276, t1277, t1280, t1293, t1307;
  double t1308, t1310, t1311, t1314, t1319, tv3rho2sigma0, tv3rho2sigma1, t1326;
  double t1330, t1332, tv3rho2sigma2, t1338, t1346, tv3rho2sigma3, tv3rho2sigma4, t1352;
  double t1359, t1362, tv3rho2sigma5, t1370, tv3rho2sigma6, tv3rho2sigma7, t1385, t1389;
  double t1390, t1391, t1394, t1407, t1421, t1422, t1424, t1425;
  double t1428, t1433, tv3rho2sigma8, t1440, t1445, t1448, t1458, t1464;
  double t1478, t1479, t1481, t1482, t1485, t1490, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1497, t1499, tv3rhosigma25, t1505, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1514, t1517, t1527, t1533;
  double t1547, t1548, t1550, t1551, t1554, t1559, tv3rhosigma211, t1563;
  double t1572, t1584, t1586, t1587, t1590, t1594, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1597;
  double t1606, t1618, t1620, t1621, t1624, t1628, tv3sigma39;

  double t1633, t1636, t1640, t1642, t1645, t1648, t1658, t1662;
  double t1663, t1669, t1675, t1677, t1679, t1694, t1696, t1698;
  double t1724, t1727, t1731, t1733, t1734, t1740, t1747, t1749;
  double t1750, t1754, t1763, t1769, t1771, t1778, t1782, t1784;
  double t1785, t1786, t1788, t1789, t1795, t1801, t1805, t1812;
  double t1816, t1820, t1825, t1827, tv4rho40, t1834, t1838, t1839;
  double t1842, t1861, t1862, t1863, t1864, t1868, t1877, t1883;
  double t1884, t1886, t1899, t1900, t1918, t1922, t1929, t1933;
  double t1934, t1937, t1946, t1949, t1950, t1952, t1954, t1955;
  double tv4rho41, t1964, t1968, t1982, t1995, t1999, t2008, t2020;
  double t2021, t2030, t2043, t2047, t2054, t2058, t2067, t2070;
  double t2081, t2084, t2086, t2087, tv4rho42, t2107, t2108, t2112;
  double t2119, t2130, t2131, t2148, t2152, t2159, t2167, t2176;
  double t2186, t2188, t2189, tv4rho43, t2194, t2199, t2205, t2206;
  double t2210, t2219, t2245, t2249, t2250, t2256, t2262, t2265;
  double t2281, t2283, t2309, t2312, t2316, t2321, t2327, t2331;
  double t2336, t2337, tv4rho44, t2345, t2351, t2354, t2361, t2363;
  double t2366, t2385, t2395, t2425, t2430, tv4rho3sigma0, tv4rho3sigma1, t2437;
  double t2440, t2444, t2446, tv4rho3sigma2, t2448, t2454, t2459, t2463;
  double t2472, t2473, tv4rho3sigma3, tv4rho3sigma4, t2475, t2481, t2483, t2492;
  double t2494, t2497, tv4rho3sigma5, t2503, t2512, tv4rho3sigma6, tv4rho3sigma7, t2518;
  double t2525, t2533, t2535, t2536, tv4rho3sigma8, t2545, tv4rho3sigma9, tv4rho3sigma10;
  double t2579, t2589, t2619, t2624, tv4rho3sigma11, t2631, t2638, t2640;
  double t2647, t2653, t2695, t2700, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t2707, t2711, t2713, tv4rho2sigma25, t2719, t2727, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t2733, t2740, t2743, tv4rho2sigma211;
  double t2751, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t2767, t2773;
  double t2815, t2820, tv4rho2sigma217, t2827, t2830, t2832, t2836, t2843;
  double t2871, t2876, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35;
  double tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t2883, t2885, tv4rhosigma39, t2891, tv4rhosigma310;
  double tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318;
  double t2898, t2903, t2937, t2942, tv4rhosigma319, t2947, t2980, tv4sigma40;
  double tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48;
  double tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t2984, t3017, tv4sigma414;

  gga_x_mpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_mpbe_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->c1 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = params->a * t28;
  t42 = t33 * sigma[0];
  t46 = 0.1e1 + t41 * t42 * t39 / 0.24e2;
  t47 = 0.1e1 / t46;
  t51 = t28 * t28;
  t52 = params->c2 * t51;
  t54 = 0.1e1 / t31 / t30;
  t55 = t52 * t54;
  t56 = sigma[0] * sigma[0];
  t57 = t35 * t35;
  t58 = t57 * rho[0];
  t60 = 0.1e1 / t36 / t58;
  t62 = t46 * t46;
  t63 = 0.1e1 / t62;
  t67 = t30 * t30;
  t68 = 0.1e1 / t67;
  t69 = params->c3 * t68;
  t70 = t56 * sigma[0];
  t71 = t57 * t57;
  t72 = 0.1e1 / t71;
  t74 = t62 * t46;
  t75 = 0.1e1 / t74;
  t79 = 0.1e1 + t34 * sigma[0] * t39 * t47 / 0.24e2 + t55 * t56 * t60 * t63 / 0.576e3 + t69 * t70 * t72 * t75 / 0.2304e4;
  t83 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t79);
  t84 = rho[1] <= p->dens_threshold;
  t85 = my_piecewise5(t14, t11, t10, t15, -t17);
  t86 = 0.1e1 + t85;
  t87 = t86 <= p->zeta_threshold;
  t88 = POW_1_3(t86);
  t90 = my_piecewise3(t87, t22, t88 * t86);
  t91 = t90 * t26;
  t92 = rho[1] * rho[1];
  t93 = POW_1_3(rho[1]);
  t94 = t93 * t93;
  t96 = 0.1e1 / t94 / t92;
  t98 = t33 * sigma[2];
  t102 = 0.1e1 + t41 * t98 * t96 / 0.24e2;
  t103 = 0.1e1 / t102;
  t107 = sigma[2] * sigma[2];
  t108 = t92 * t92;
  t109 = t108 * rho[1];
  t111 = 0.1e1 / t93 / t109;
  t113 = t102 * t102;
  t114 = 0.1e1 / t113;
  t118 = t107 * sigma[2];
  t119 = t108 * t108;
  t120 = 0.1e1 / t119;
  t122 = t113 * t102;
  t123 = 0.1e1 / t122;
  t127 = 0.1e1 + t34 * sigma[2] * t96 * t103 / 0.24e2 + t55 * t107 * t111 * t114 / 0.576e3 + t69 * t118 * t120 * t123 / 0.2304e4;
  t131 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t127);
  tzk0 = t83 + t131;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t132 = t6 * t6;
  t133 = 0.1e1 / t132;
  t134 = t16 * t133;
  t135 = t7 - t134;
  t136 = my_piecewise5(t10, 0, t14, 0, t135);
  t139 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t136);
  t140 = t139 * t26;
  t144 = t26 * t26;
  t145 = 0.1e1 / t144;
  t146 = t25 * t145;
  t149 = t5 * t146 * t79 / 0.8e1;
  t150 = t35 * rho[0];
  t152 = 0.1e1 / t37 / t150;
  t158 = params->c1 * t51 * t54;
  t159 = t57 * t35;
  t161 = 0.1e1 / t36 / t159;
  t162 = t56 * t161;
  t163 = t63 * params->a;
  t170 = params->c2 * t68;
  t171 = t170 * t70;
  t172 = t71 * rho[0];
  t173 = 0.1e1 / t172;
  t174 = t173 * t75;
  t175 = t174 * params->a;
  t182 = t56 * t56;
  t183 = t71 * t150;
  t185 = 0.1e1 / t37 / t183;
  t188 = t62 * t62;
  t189 = 0.1e1 / t188;
  t191 = t28 * t33;
  t192 = t189 * params->a * t191;
  t195 = -t34 * sigma[0] * t152 * t47 / 0.9e1 + t158 * t162 * t163 / 0.216e3 - t55 * t162 * t63 / 0.108e3 + t171 * t175 / 0.432e3 - t69 * t70 * t173 * t75 / 0.288e3 + t69 * t182 * t185 * t192 / 0.6912e4;
  t200 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t79 - t149 - 0.3e1 / 0.8e1 * t5 * t27 * t195);
  t202 = my_piecewise5(t14, 0, t10, 0, -t135);
  t205 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t88 * t202);
  t206 = t205 * t26;
  t210 = t90 * t145;
  t213 = t5 * t210 * t127 / 0.8e1;
  t215 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t206 * t127 - t213);
  tvrho0 = t83 + t131 + t6 * (t200 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t218 = -t7 - t134;
  t219 = my_piecewise5(t10, 0, t14, 0, t218);
  t222 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t219);
  t223 = t222 * t26;
  t228 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t79 - t149);
  t230 = my_piecewise5(t14, 0, t10, 0, -t218);
  t233 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t88 * t230);
  t234 = t233 * t26;
  t238 = t92 * rho[1];
  t240 = 0.1e1 / t94 / t238;
  t245 = t108 * t92;
  t247 = 0.1e1 / t93 / t245;
  t248 = t107 * t247;
  t249 = t114 * params->a;
  t256 = t170 * t118;
  t257 = t119 * rho[1];
  t258 = 0.1e1 / t257;
  t259 = t258 * t123;
  t260 = t259 * params->a;
  t267 = t107 * t107;
  t268 = t119 * t238;
  t270 = 0.1e1 / t94 / t268;
  t273 = t113 * t113;
  t274 = 0.1e1 / t273;
  t276 = t274 * params->a * t191;
  t279 = -t34 * sigma[2] * t240 * t103 / 0.9e1 + t158 * t248 * t249 / 0.216e3 - t55 * t248 * t114 / 0.108e3 + t256 * t260 / 0.432e3 - t69 * t118 * t258 * t123 / 0.288e3 + t69 * t267 * t270 * t276 / 0.6912e4;
  t284 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t234 * t127 - t213 - 0.3e1 / 0.8e1 * t5 * t91 * t279);
  tvrho1 = t83 + t131 + t6 * (t228 + t284);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t291 = sigma[0] * t60;
  t298 = t170 * t56;
  t299 = t72 * t75;
  t300 = t299 * params->a;
  t307 = t71 * t35;
  t309 = 0.1e1 / t37 / t307;
  t314 = t29 * t33 * t39 * t47 / 0.24e2 - t158 * t291 * t163 / 0.576e3 + t55 * t291 * t63 / 0.288e3 - t298 * t300 / 0.1152e4 + t69 * t56 * t72 * t75 / 0.768e3 - t69 * t70 * t309 * t192 / 0.18432e5;
  t318 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t314);
  tvsigma0 = t6 * t318;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t323 = sigma[2] * t111;
  t330 = t170 * t107;
  t331 = t120 * t123;
  t332 = t331 * params->a;
  t339 = t119 * t92;
  t341 = 0.1e1 / t94 / t339;
  t346 = t29 * t33 * t96 * t103 / 0.24e2 - t158 * t323 * t249 / 0.576e3 + t55 * t323 * t114 / 0.288e3 - t330 * t332 / 0.1152e4 + t69 * t107 * t120 * t123 / 0.768e3 - t69 * t118 * t341 * t276 / 0.18432e5;
  t350 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t346);
  tvsigma2 = t6 * t350;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t353 = t23 * t23;
  t354 = 0.1e1 / t353;
  t355 = t136 * t136;
  t358 = t132 * t6;
  t359 = 0.1e1 / t358;
  t360 = t16 * t359;
  t362 = -0.2e1 * t133 + 0.2e1 * t360;
  t363 = my_piecewise5(t10, 0, t14, 0, t362);
  t367 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t354 * t355 + 0.4e1 / 0.3e1 * t23 * t363);
  t368 = t367 * t26;
  t372 = t139 * t145;
  t374 = t5 * t372 * t79;
  t380 = 0.1e1 / t144 / t6;
  t381 = t25 * t380;
  t384 = t5 * t381 * t79 / 0.12e2;
  t386 = t5 * t146 * t195;
  t389 = 0.1e1 / t37 / t57;
  t394 = t57 * t150;
  t396 = 0.1e1 / t36 / t394;
  t397 = t56 * t396;
  t401 = params->c1 * t68;
  t402 = t401 * t70;
  t403 = 0.1e1 / t307;
  t404 = t403 * t75;
  t405 = params->a * params->a;
  t412 = t404 * params->a;
  t415 = t71 * t57;
  t417 = 0.1e1 / t37 / t415;
  t418 = t182 * t417;
  t421 = t189 * t405 * t191;
  t431 = t182 * sigma[0];
  t434 = 0.1e1 / t36 / t71 / t394;
  t438 = 0.1e1 / t188 / t46;
  t440 = t51 * t54;
  t441 = t438 * t405 * t440;
  t444 = 0.11e2 / 0.27e2 * t34 * sigma[0] * t389 * t47 - t158 * t397 * t163 / 0.24e2 + t402 * t404 * t405 / 0.162e3 + 0.19e2 / 0.324e3 * t55 * t397 * t63 - 0.43e2 / 0.1296e4 * t171 * t412 + t170 * t418 * t421 / 0.1296e4 + t69 * t70 * t403 * t75 / 0.32e2 - 0.59e2 / 0.20736e5 * t69 * t418 * t192 + t69 * t431 * t434 * t441 / 0.15552e5;
  t449 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t368 * t79 - t374 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t195 + t384 - t386 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t444);
  t450 = t88 * t88;
  t451 = 0.1e1 / t450;
  t452 = t202 * t202;
  t456 = my_piecewise5(t14, 0, t10, 0, -t362);
  t460 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t451 * t452 + 0.4e1 / 0.3e1 * t88 * t456);
  t461 = t460 * t26;
  t465 = t205 * t145;
  t467 = t5 * t465 * t127;
  t469 = t90 * t380;
  t472 = t5 * t469 * t127 / 0.12e2;
  t474 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t461 * t127 - t467 / 0.4e1 + t472);
  tv2rho20 = 0.2e1 * t200 + 0.2e1 * t215 + t6 * (t449 + t474);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t477 = t354 * t219;
  t480 = 0.2e1 * t360;
  t481 = my_piecewise5(t10, 0, t14, 0, t480);
  t485 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t477 * t136 + 0.4e1 / 0.3e1 * t23 * t481);
  t486 = t485 * t26;
  t490 = t222 * t145;
  t492 = t5 * t490 * t79;
  t500 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t486 * t79 - t492 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t195 - t374 / 0.8e1 + t384 - t386 / 0.8e1);
  t501 = t451 * t230;
  t504 = my_piecewise5(t14, 0, t10, 0, -t480);
  t508 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t501 * t202 + 0.4e1 / 0.3e1 * t88 * t504);
  t509 = t508 * t26;
  t513 = t233 * t145;
  t515 = t5 * t513 * t127;
  t522 = t5 * t210 * t279;
  t525 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t509 * t127 - t515 / 0.8e1 - t467 / 0.8e1 + t472 - 0.3e1 / 0.8e1 * t5 * t206 * t279 - t522 / 0.8e1);
  tv2rho21 = t200 + t215 + t228 + t284 + t6 * (t500 + t525);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t530 = t219 * t219;
  t534 = 0.2e1 * t133 + 0.2e1 * t360;
  t535 = my_piecewise5(t10, 0, t14, 0, t534);
  t539 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t354 * t530 + 0.4e1 / 0.3e1 * t23 * t535);
  t540 = t539 * t26;
  t546 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t540 * t79 - t492 / 0.4e1 + t384);
  t547 = t230 * t230;
  t551 = my_piecewise5(t14, 0, t10, 0, -t534);
  t555 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t451 * t547 + 0.4e1 / 0.3e1 * t88 * t551);
  t556 = t555 * t26;
  t566 = 0.1e1 / t94 / t108;
  t571 = t108 * t238;
  t573 = 0.1e1 / t93 / t571;
  t574 = t107 * t573;
  t578 = t401 * t118;
  t579 = 0.1e1 / t339;
  t580 = t579 * t123;
  t587 = t580 * params->a;
  t590 = t119 * t108;
  t592 = 0.1e1 / t94 / t590;
  t593 = t267 * t592;
  t596 = t274 * t405 * t191;
  t606 = t267 * sigma[2];
  t609 = 0.1e1 / t93 / t119 / t571;
  t613 = 0.1e1 / t273 / t102;
  t615 = t613 * t405 * t440;
  t618 = 0.11e2 / 0.27e2 * t34 * sigma[2] * t566 * t103 - t158 * t574 * t249 / 0.24e2 + t578 * t580 * t405 / 0.162e3 + 0.19e2 / 0.324e3 * t55 * t574 * t114 - 0.43e2 / 0.1296e4 * t256 * t587 + t170 * t593 * t596 / 0.1296e4 + t69 * t118 * t579 * t123 / 0.32e2 - 0.59e2 / 0.20736e5 * t69 * t593 * t276 + t69 * t606 * t609 * t615 / 0.15552e5;
  t623 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t556 * t127 - t515 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t279 + t472 - t522 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t91 * t618);
  tv2rho22 = 0.2e1 * t228 + 0.2e1 * t284 + t6 * (t546 + t623);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t631 = t5 * t146 * t314 / 0.8e1;
  t636 = t161 * t63;
  t637 = params->a * sigma[0];
  t642 = t174 * t405;
  t651 = t70 * t185;
  t662 = t71 * t159;
  t664 = 0.1e1 / t36 / t662;
  t669 = -t29 * t33 * t152 * t47 / 0.9e1 + t158 * t636 * t637 / 0.72e2 - t401 * t56 * t642 / 0.432e3 - t55 * sigma[0] * t161 * t63 / 0.54e2 + 0.5e1 / 0.432e3 * t298 * t175 - t170 * t651 * t421 / 0.3456e4 - t69 * t56 * t173 * t75 / 0.96e2 + 0.7e1 / 0.6912e4 * t69 * t651 * t192 - t69 * t182 * t664 * t441 / 0.41472e5;
  t674 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t314 - t631 - 0.3e1 / 0.8e1 * t5 * t27 * t669);
  tv2rhosigma0 = t6 * t674 + t318;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t681 = t5 * t210 * t346 / 0.8e1;
  t683 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t206 * t346 - t681);
  tv2rhosigma2 = t6 * t683 + t350;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t689 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t314 - t631);
  tv2rhosigma3 = t6 * t689 + t318;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t698 = t247 * t114;
  t699 = params->a * sigma[2];
  t704 = t259 * t405;
  t713 = t118 * t270;
  t724 = t119 * t245;
  t726 = 0.1e1 / t93 / t724;
  t731 = -t29 * t33 * t240 * t103 / 0.9e1 + t158 * t698 * t699 / 0.72e2 - t401 * t107 * t704 / 0.432e3 - t55 * sigma[2] * t247 * t114 / 0.54e2 + 0.5e1 / 0.432e3 * t330 * t260 - t170 * t713 * t596 / 0.3456e4 - t69 * t107 * t258 * t123 / 0.96e2 + 0.7e1 / 0.6912e4 * t69 * t713 * t276 - t69 * t267 * t726 * t615 / 0.41472e5;
  t736 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t234 * t346 - t681 - 0.3e1 / 0.8e1 * t5 * t91 * t731);
  tv2rhosigma5 = t6 * t736 + t350;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t743 = t299 * t405;
  t753 = t56 * t309;
  t764 = t71 * t58;
  t766 = 0.1e1 / t36 / t764;
  t771 = -t158 * t60 * t63 * params->a / 0.288e3 + t401 * sigma[0] * t743 / 0.1152e4 + t52 * t54 * t60 * t63 / 0.288e3 - t170 * sigma[0] * t300 / 0.288e3 + t170 * t753 * t421 / 0.9216e4 + t69 * sigma[0] * t72 * t75 / 0.384e3 - t69 * t753 * t192 / 0.3072e4 + t69 * t70 * t766 * t441 / 0.110592e6;
  t775 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t771);
  tv2sigma20 = t6 * t775;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t781 = t331 * t405;
  t791 = t107 * t341;
  t802 = t119 * t109;
  t804 = 0.1e1 / t93 / t802;
  t809 = -t158 * t111 * t114 * params->a / 0.288e3 + t401 * sigma[2] * t781 / 0.1152e4 + t52 * t54 * t111 * t114 / 0.288e3 - t170 * sigma[2] * t332 / 0.288e3 + t170 * t791 * t596 / 0.9216e4 + t69 * sigma[2] * t120 * t123 / 0.384e3 - t69 * t791 * t276 / 0.3072e4 + t69 * t118 * t804 * t615 / 0.110592e6;
  t813 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t809);
  tv2sigma25 = t6 * t813;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t817 = 0.1e1 / t353 / t19;
  t818 = t355 * t136;
  t821 = t354 * t136;
  t824 = t132 * t132;
  t825 = 0.1e1 / t824;
  t826 = t16 * t825;
  t828 = 0.6e1 * t359 - 0.6e1 * t826;
  t829 = my_piecewise5(t10, 0, t14, 0, t828);
  t833 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t817 * t818 + 0.4e1 / 0.3e1 * t821 * t363 + 0.4e1 / 0.3e1 * t23 * t829);
  t834 = t833 * t26;
  t838 = t367 * t145;
  t840 = t5 * t838 * t79;
  t845 = t139 * t380;
  t847 = t5 * t845 * t79;
  t850 = t5 * t372 * t195;
  t856 = 0.1e1 / t144 / t132;
  t857 = t25 * t856;
  t860 = 0.5e1 / 0.36e2 * t5 * t857 * t79;
  t862 = t5 * t381 * t195;
  t865 = t5 * t146 * t444;
  t868 = 0.1e1 / t37 / t58;
  t874 = 0.1e1 / t36 / t71;
  t875 = t56 * t874;
  t879 = 0.1e1 / t183;
  t880 = t879 * t75;
  t885 = 0.1e1 / t37 / t764;
  t886 = t182 * t885;
  t888 = t405 * params->a;
  t890 = t189 * t888 * t191;
  t896 = t880 * params->a;
  t902 = t71 * t71;
  t904 = 0.1e1 / t36 / t902;
  t905 = t431 * t904;
  t908 = t438 * t888 * t440;
  t921 = t67 * t67;
  t922 = 0.1e1 / t921;
  t923 = params->c3 * t922;
  t924 = t182 * t56;
  t925 = t923 * t924;
  t926 = t902 * t150;
  t929 = 0.1e1 / t188 / t62;
  t930 = 0.1e1 / t926 * t929;
  t931 = t930 * t888;
  t934 = -0.154e3 / 0.81e2 * t34 * sigma[0] * t868 * t47 + 0.341e3 / 0.972e3 * t158 * t875 * t163 - 0.19e2 / 0.162e3 * t402 * t880 * t405 + t401 * t886 * t890 / 0.486e3 - 0.209e3 / 0.486e3 * t55 * t875 * t63 + 0.797e3 / 0.1944e4 * t171 * t896 - t170 * t886 * t421 / 0.48e2 + t170 * t905 * t908 / 0.2916e4 - 0.5e1 / 0.16e2 * t69 * t70 * t879 * t75 + 0.1445e4 / 0.31104e5 * t69 * t886 * t192 - 0.35e2 / 0.15552e5 * t69 * t905 * t441 + 0.5e1 / 0.23328e5 * t925 * t931;
  t939 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t834 * t79 - 0.3e1 / 0.8e1 * t840 - 0.9e1 / 0.8e1 * t5 * t368 * t195 + t847 / 0.4e1 - 0.3e1 / 0.4e1 * t850 - 0.9e1 / 0.8e1 * t5 * t140 * t444 - t860 + t862 / 0.4e1 - 0.3e1 / 0.8e1 * t865 - 0.3e1 / 0.8e1 * t5 * t27 * t934);
  t941 = 0.1e1 / t450 / t86;
  t942 = t452 * t202;
  t945 = t451 * t202;
  t949 = my_piecewise5(t14, 0, t10, 0, -t828);
  t953 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t941 * t942 + 0.4e1 / 0.3e1 * t945 * t456 + 0.4e1 / 0.3e1 * t88 * t949);
  t954 = t953 * t26;
  t958 = t460 * t145;
  t960 = t5 * t958 * t127;
  t962 = t205 * t380;
  t964 = t5 * t962 * t127;
  t966 = t90 * t856;
  t969 = 0.5e1 / 0.36e2 * t5 * t966 * t127;
  t971 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t954 * t127 - 0.3e1 / 0.8e1 * t960 + t964 / 0.4e1 - t969);
  tv3rho30 = 0.3e1 * t449 + 0.3e1 * t474 + t6 * (t939 + t971);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t974 = 0.2e1 * t500;
  t975 = 0.2e1 * t525;
  t976 = t817 * t219;
  t979 = t354 * t481;
  t984 = 0.2e1 * t359;
  t985 = 0.6e1 * t826;
  t986 = t984 - t985;
  t987 = my_piecewise5(t10, 0, t14, 0, t986);
  t991 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t976 * t355 + 0.8e1 / 0.9e1 * t979 * t136 + 0.4e1 / 0.9e1 * t477 * t363 + 0.4e1 / 0.3e1 * t23 * t987);
  t992 = t991 * t26;
  t996 = t485 * t145;
  t999 = t5 * t996 * t79 / 0.4e1;
  t1003 = t222 * t380;
  t1005 = t5 * t1003 * t79;
  t1009 = t5 * t490 * t195 / 0.4e1;
  t1018 = -0.3e1 / 0.8e1 * t5 * t992 * t79 - t999 - 0.3e1 / 0.4e1 * t5 * t486 * t195 + t1005 / 0.12e2 - t1009 - 0.3e1 / 0.8e1 * t5 * t223 * t444 - t840 / 0.8e1 + t847 / 0.6e1 - t850 / 0.4e1 - t860 + t862 / 0.6e1 - t865 / 0.8e1;
  t1019 = my_piecewise3(t1, 0, t1018);
  t1020 = t941 * t230;
  t1023 = t451 * t504;
  t1029 = my_piecewise5(t14, 0, t10, 0, -t986);
  t1033 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t1020 * t452 + 0.8e1 / 0.9e1 * t1023 * t202 + 0.4e1 / 0.9e1 * t501 * t456 + 0.4e1 / 0.3e1 * t88 * t1029);
  t1034 = t1033 * t26;
  t1038 = t508 * t145;
  t1041 = t5 * t1038 * t127 / 0.4e1;
  t1042 = t233 * t380;
  t1044 = t5 * t1042 * t127;
  t1053 = t5 * t465 * t279 / 0.4e1;
  t1055 = t5 * t469 * t279;
  t1058 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t1034 * t127 - t1041 + t1044 / 0.12e2 - t960 / 0.8e1 + t964 / 0.6e1 - t969 - 0.3e1 / 0.8e1 * t5 * t461 * t279 - t1053 + t1055 / 0.12e2);
  tv3rho31 = t449 + t474 + t974 + t975 + t6 * (t1019 + t1058);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1061 = t817 * t530;
  t1066 = t354 * t535;
  t1069 = -t984 - t985;
  t1070 = my_piecewise5(t10, 0, t14, 0, t1069);
  t1074 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1061 * t136 + 0.8e1 / 0.9e1 * t477 * t481 + 0.4e1 / 0.9e1 * t1066 * t136 + 0.4e1 / 0.3e1 * t23 * t1070);
  t1075 = t1074 * t26;
  t1079 = t539 * t145;
  t1081 = t5 * t1079 * t79;
  t1090 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1075 * t79 - t1081 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t540 * t195 - t999 + t1005 / 0.6e1 - t1009 + t847 / 0.12e2 - t860 + t862 / 0.12e2);
  t1091 = t941 * t547;
  t1096 = t451 * t551;
  t1100 = my_piecewise5(t14, 0, t10, 0, -t1069);
  t1104 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t1091 * t202 + 0.8e1 / 0.9e1 * t501 * t504 + 0.4e1 / 0.9e1 * t1096 * t202 + 0.4e1 / 0.3e1 * t88 * t1100);
  t1105 = t1104 * t26;
  t1109 = t555 * t145;
  t1111 = t5 * t1109 * t127;
  t1118 = t5 * t513 * t279;
  t1126 = t5 * t210 * t618;
  t1128 = -0.3e1 / 0.8e1 * t5 * t1105 * t127 - t1111 / 0.8e1 - t1041 + t1044 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t509 * t279 - t1118 / 0.4e1 + t964 / 0.12e2 - t969 - t1053 + t1055 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t206 * t618 - t1126 / 0.8e1;
  t1129 = my_piecewise3(t84, 0, t1128);
  tv3rho32 = t974 + t975 + t546 + t623 + t6 * (t1090 + t1129);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1134 = t530 * t219;
  t1140 = -0.6e1 * t359 - 0.6e1 * t826;
  t1141 = my_piecewise5(t10, 0, t14, 0, t1140);
  t1145 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t817 * t1134 + 0.4e1 / 0.3e1 * t477 * t535 + 0.4e1 / 0.3e1 * t23 * t1141);
  t1146 = t1145 * t26;
  t1153 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1146 * t79 - 0.3e1 / 0.8e1 * t1081 + t1005 / 0.4e1 - t860);
  t1154 = t547 * t230;
  t1160 = my_piecewise5(t14, 0, t10, 0, -t1140);
  t1164 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t941 * t1154 + 0.4e1 / 0.3e1 * t501 * t551 + 0.4e1 / 0.3e1 * t88 * t1160);
  t1165 = t1164 * t26;
  t1181 = 0.1e1 / t94 / t109;
  t1187 = 0.1e1 / t93 / t119;
  t1188 = t107 * t1187;
  t1192 = 0.1e1 / t268;
  t1193 = t1192 * t123;
  t1198 = 0.1e1 / t94 / t802;
  t1199 = t267 * t1198;
  t1202 = t274 * t888 * t191;
  t1208 = t1193 * params->a;
  t1214 = t119 * t119;
  t1216 = 0.1e1 / t93 / t1214;
  t1217 = t606 * t1216;
  t1220 = t613 * t888 * t440;
  t1233 = t267 * t107;
  t1234 = t923 * t1233;
  t1235 = t1214 * t238;
  t1238 = 0.1e1 / t273 / t113;
  t1239 = 0.1e1 / t1235 * t1238;
  t1240 = t1239 * t888;
  t1243 = -0.154e3 / 0.81e2 * t34 * sigma[2] * t1181 * t103 + 0.341e3 / 0.972e3 * t158 * t1188 * t249 - 0.19e2 / 0.162e3 * t578 * t1193 * t405 + t401 * t1199 * t1202 / 0.486e3 - 0.209e3 / 0.486e3 * t55 * t1188 * t114 + 0.797e3 / 0.1944e4 * t256 * t1208 - t170 * t1199 * t596 / 0.48e2 + t170 * t1217 * t1220 / 0.2916e4 - 0.5e1 / 0.16e2 * t69 * t118 * t1192 * t123 + 0.1445e4 / 0.31104e5 * t69 * t1199 * t276 - 0.35e2 / 0.15552e5 * t69 * t1217 * t615 + 0.5e1 / 0.23328e5 * t1234 * t1240;
  t1248 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t1165 * t127 - 0.3e1 / 0.8e1 * t1111 - 0.9e1 / 0.8e1 * t5 * t556 * t279 + t1044 / 0.4e1 - 0.3e1 / 0.4e1 * t1118 - 0.9e1 / 0.8e1 * t5 * t234 * t618 - t969 + t1055 / 0.4e1 - 0.3e1 / 0.8e1 * t1126 - 0.3e1 / 0.8e1 * t5 * t91 * t1243);
  tv3rho33 = 0.3e1 * t546 + 0.3e1 * t623 + t6 * (t1153 + t1248);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1256 = t5 * t372 * t314;
  t1263 = t5 * t381 * t314 / 0.12e2;
  t1265 = t5 * t146 * t669;
  t1271 = t396 * t63;
  t1275 = t401 * t403;
  t1276 = t75 * t405;
  t1277 = t1276 * t56;
  t1280 = t70 * t417;
  t1293 = t182 * t434;
  t1307 = t923 * t431;
  t1308 = t902 * t35;
  t1310 = 0.1e1 / t1308 * t929;
  t1311 = t1310 * t888;
  t1314 = 0.11e2 / 0.27e2 * t29 * t33 * t389 * t47 - 0.65e2 / 0.648e3 * t158 * t1271 * t637 + 0.17e2 / 0.432e3 * t1275 * t1277 - t401 * t1280 * t890 / 0.1296e4 + 0.19e2 / 0.162e3 * t55 * sigma[0] * t396 * t63 - 0.167e3 / 0.1296e4 * t298 * t412 + 0.25e2 / 0.3456e4 * t170 * t1280 * t421 - t170 * t1293 * t908 / 0.7776e4 + 0.3e1 / 0.32e2 * t69 * t56 * t403 * t75 - 0.317e3 / 0.20736e5 * t69 * t1280 * t192 + 0.11e2 / 0.13824e5 * t69 * t1293 * t441 - 0.5e1 / 0.62208e5 * t1307 * t1311;
  t1319 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t368 * t314 - t1256 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t669 + t1263 - t1265 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1314);
  tv3rho2sigma0 = t6 * t1319 + 0.2e1 * t674;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1326 = t5 * t465 * t346;
  t1330 = t5 * t469 * t346 / 0.12e2;
  t1332 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t461 * t346 - t1326 / 0.4e1 + t1330);
  tv3rho2sigma2 = t6 * t1332 + 0.2e1 * t683;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1338 = t5 * t490 * t314;
  t1346 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t486 * t314 - t1338 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t669 - t1256 / 0.8e1 + t1263 - t1265 / 0.8e1);
  tv3rho2sigma3 = t6 * t1346 + t674 + t689;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1352 = t5 * t513 * t346;
  t1359 = t5 * t210 * t731;
  t1362 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t509 * t346 - t1352 / 0.8e1 - t1326 / 0.8e1 + t1330 - 0.3e1 / 0.8e1 * t5 * t206 * t731 - t1359 / 0.8e1);
  tv3rho2sigma5 = t6 * t1362 + t683 + t736;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1370 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t540 * t314 - t1338 / 0.4e1 + t1263);
  tv3rho2sigma6 = t6 * t1370 + 0.2e1 * t689;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1385 = t573 * t114;
  t1389 = t401 * t579;
  t1390 = t123 * t405;
  t1391 = t1390 * t107;
  t1394 = t118 * t592;
  t1407 = t267 * t609;
  t1421 = t923 * t606;
  t1422 = t1214 * t92;
  t1424 = 0.1e1 / t1422 * t1238;
  t1425 = t1424 * t888;
  t1428 = 0.11e2 / 0.27e2 * t29 * t33 * t566 * t103 - 0.65e2 / 0.648e3 * t158 * t1385 * t699 + 0.17e2 / 0.432e3 * t1389 * t1391 - t401 * t1394 * t1202 / 0.1296e4 + 0.19e2 / 0.162e3 * t55 * sigma[2] * t573 * t114 - 0.167e3 / 0.1296e4 * t330 * t587 + 0.25e2 / 0.3456e4 * t170 * t1394 * t596 - t170 * t1407 * t1220 / 0.7776e4 + 0.3e1 / 0.32e2 * t69 * t107 * t579 * t123 - 0.317e3 / 0.20736e5 * t69 * t1394 * t276 + 0.11e2 / 0.13824e5 * t69 * t1407 * t615 - 0.5e1 / 0.62208e5 * t1421 * t1425;
  t1433 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t556 * t346 - t1352 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t731 + t1330 - t1359 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t91 * t1428);
  tv3rho2sigma8 = t6 * t1433 + 0.2e1 * t736;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1440 = t5 * t146 * t771 / 0.8e1;
  t1445 = t1276 * sigma[0];
  t1448 = t56 * t185;
  t1458 = t75 * params->a * sigma[0];
  t1464 = t70 * t664;
  t1478 = t923 * t182;
  t1479 = t902 * rho[0];
  t1481 = 0.1e1 / t1479 * t929;
  t1482 = t1481 * t888;
  t1485 = t158 * t636 * params->a / 0.54e2 - 0.5e1 / 0.432e3 * t401 * t173 * t1445 + t401 * t1448 * t890 / 0.3456e4 - t52 * t54 * t161 * t63 / 0.54e2 + 0.7e1 / 0.216e3 * t170 * t173 * t1458 - t170 * t1448 * t421 / 0.432e3 + t170 * t1464 * t908 / 0.20736e5 - t69 * sigma[0] * t173 * t75 / 0.48e2 + 0.5e1 / 0.1152e4 * t69 * t1448 * t192 - 0.11e2 / 0.41472e5 * t69 * t1464 * t441 + 0.5e1 / 0.165888e6 * t1478 * t1482;
  t1490 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t771 - t1440 - 0.3e1 / 0.8e1 * t5 * t27 * t1485);
  tv3rhosigma20 = t6 * t1490 + t775;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1497 = t5 * t210 * t809 / 0.8e1;
  t1499 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t206 * t809 - t1497);
  tv3rhosigma25 = t6 * t1499 + t813;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1505 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t771 - t1440);
  tv3rhosigma26 = t6 * t1505 + t775;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1514 = t1390 * sigma[2];
  t1517 = t107 * t270;
  t1527 = t123 * params->a * sigma[2];
  t1533 = t118 * t726;
  t1547 = t923 * t267;
  t1548 = t1214 * rho[1];
  t1550 = 0.1e1 / t1548 * t1238;
  t1551 = t1550 * t888;
  t1554 = t158 * t698 * params->a / 0.54e2 - 0.5e1 / 0.432e3 * t401 * t258 * t1514 + t401 * t1517 * t1202 / 0.3456e4 - t52 * t54 * t247 * t114 / 0.54e2 + 0.7e1 / 0.216e3 * t170 * t258 * t1527 - t170 * t1517 * t596 / 0.432e3 + t170 * t1533 * t1220 / 0.20736e5 - t69 * sigma[2] * t258 * t123 / 0.48e2 + 0.5e1 / 0.1152e4 * t69 * t1517 * t276 - 0.11e2 / 0.41472e5 * t69 * t1533 * t615 + 0.5e1 / 0.165888e6 * t1547 * t1551;
  t1559 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t234 * t809 - t1497 - 0.3e1 / 0.8e1 * t5 * t91 * t1554);
  tv3rhosigma211 = t6 * t1559 + t813;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1563 = sigma[0] * t309;
  t1572 = t56 * t766;
  t1584 = t923 * t70;
  t1586 = 0.1e1 / t902 * t929;
  t1587 = t1586 * t888;
  t1590 = t401 * t743 / 0.384e3 - t401 * t1563 * t890 / 0.9216e4 - t170 * t300 / 0.192e3 + t170 * t1563 * t421 / 0.1536e4 - t170 * t1572 * t908 / 0.55296e5 + t69 * t299 / 0.384e3 - t69 * t1563 * t192 / 0.1024e4 + t69 * t1572 * t441 / 0.12288e5 - 0.5e1 / 0.442368e6 * t1584 * t1587;
  t1594 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1590);
  tv3sigma30 = t6 * t1594;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1597 = sigma[2] * t341;
  t1606 = t107 * t804;
  t1618 = t923 * t118;
  t1620 = 0.1e1 / t1214 * t1238;
  t1621 = t1620 * t888;
  t1624 = t401 * t781 / 0.384e3 - t401 * t1597 * t1202 / 0.9216e4 - t170 * t332 / 0.192e3 + t170 * t1597 * t596 / 0.1536e4 - t170 * t1606 * t1220 / 0.55296e5 + t69 * t331 / 0.384e3 - t69 * t1597 * t276 / 0.1024e4 + t69 * t1606 * t615 / 0.12288e5 - 0.5e1 / 0.442368e6 * t1618 * t1621;
  t1628 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * t1624);
  tv3sigma39 = t6 * t1628;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1633 = t5 * t139 * t856 * t79;
  t1636 = 0.1e1 / t144 / t358;
  t1640 = 0.1e2 / 0.27e2 * t5 * t25 * t1636 * t79;
  t1642 = t5 * t857 * t195;
  t1645 = t5 * t381 * t444;
  t1648 = t5 * t146 * t934;
  t1658 = t56 / t36 / t172;
  t1662 = 0.1e1 / t415;
  t1663 = t1662 * t75;
  t1669 = t182 / t37 / t662;
  t1675 = t431 / t36 / t1479;
  t1677 = t405 * t405;
  t1679 = t438 * t1677 * t440;
  t1694 = params->c2 * t922;
  t1696 = t902 * t57;
  t1698 = 0.1e1 / t1696 * t929;
  t1724 = 0.1e1 / t188 / t74 * t1677 * t191;
  t1727 = 0.2618e4 / 0.243e3 * t34 * sigma[0] / t37 / t159 * t47 - 0.3047e4 / 0.972e3 * t158 * t1658 * t163 + 0.2563e4 / 0.1458e4 * t402 * t1663 * t405 - 0.49e2 / 0.729e3 * t401 * t1669 * t890 + 0.2e1 / 0.2187e4 * t401 * t1675 * t1679 + 0.5225e4 / 0.1458e4 * t55 * t1658 * t63 - 0.29645e5 / 0.5832e4 * t171 * t1663 * params->a + 0.4915e4 / 0.11664e5 * t170 * t1669 * t421 - 0.65e2 / 0.4374e4 * t170 * t1675 * t908 + 0.5e1 / 0.4374e4 * t1694 * t924 * t1698 * t1677 + 0.55e2 / 0.16e2 * t69 * t70 * t1662 * t75 - 0.68965e5 / 0.93312e5 * t69 * t1669 * t192 + 0.8035e4 / 0.139968e6 * t69 * t1675 * t441 - 0.5e1 / 0.432e3 * t925 * t1698 * t888 + 0.5e1 / 0.34992e5 * t923 * t182 * t70 / t37 / t902 / t159 * t1724;
  t1731 = t19 * t19;
  t1733 = 0.1e1 / t353 / t1731;
  t1734 = t355 * t355;
  t1740 = t363 * t363;
  t1747 = t16 / t824 / t6;
  t1749 = -0.24e2 * t825 + 0.24e2 * t1747;
  t1750 = my_piecewise5(t10, 0, t14, 0, t1749);
  t1754 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1733 * t1734 - 0.16e2 / 0.9e1 * t817 * t355 * t363 + 0.4e1 / 0.3e1 * t354 * t1740 + 0.16e2 / 0.9e1 * t821 * t829 + 0.4e1 / 0.3e1 * t23 * t1750);
  t1763 = t5 * t838 * t195;
  t1769 = t5 * t845 * t195;
  t1771 = t5 * t372 * t444;
  t1778 = t5 * t833 * t145 * t79;
  t1782 = t5 * t367 * t380 * t79;
  t1784 = -0.5e1 / 0.9e1 * t1633 + t1640 - 0.5e1 / 0.9e1 * t1642 + t1645 / 0.2e1 - t1648 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1727 - 0.3e1 / 0.8e1 * t5 * t1754 * t26 * t79 - 0.3e1 / 0.2e1 * t5 * t834 * t195 - 0.3e1 / 0.2e1 * t1763 - 0.9e1 / 0.4e1 * t5 * t368 * t444 + t1769 - 0.3e1 / 0.2e1 * t1771 - 0.3e1 / 0.2e1 * t5 * t140 * t934 - t1778 / 0.2e1 + t1782 / 0.2e1;
  t1785 = my_piecewise3(t1, 0, t1784);
  t1786 = t86 * t86;
  t1788 = 0.1e1 / t450 / t1786;
  t1789 = t452 * t452;
  t1795 = t456 * t456;
  t1801 = my_piecewise5(t14, 0, t10, 0, -t1749);
  t1805 = my_piecewise3(t87, 0, 0.4e2 / 0.81e2 * t1788 * t1789 - 0.16e2 / 0.9e1 * t941 * t452 * t456 + 0.4e1 / 0.3e1 * t451 * t1795 + 0.16e2 / 0.9e1 * t945 * t949 + 0.4e1 / 0.3e1 * t88 * t1801);
  t1812 = t5 * t953 * t145 * t127;
  t1816 = t5 * t460 * t380 * t127;
  t1820 = t5 * t205 * t856 * t127;
  t1825 = 0.1e2 / 0.27e2 * t5 * t90 * t1636 * t127;
  t1827 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t1805 * t26 * t127 - t1812 / 0.2e1 + t1816 / 0.2e1 - 0.5e1 / 0.9e1 * t1820 + t1825);
  tv4rho40 = 0.4e1 * t939 + 0.4e1 * t971 + t6 * (t1785 + t1827);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1834 = t5 * t991 * t145 * t79;
  t1838 = t5 * t485 * t380 * t79;
  t1839 = t1838 / 0.4e1;
  t1842 = t5 * t222 * t856 * t79;
  t1861 = 0.12e2 * t825;
  t1862 = 0.24e2 * t1747;
  t1863 = -t1861 + t1862;
  t1864 = my_piecewise5(t10, 0, t14, 0, t1863);
  t1868 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1733 * t219 * t818 - 0.8e1 / 0.9e1 * t817 * t481 * t355 - 0.8e1 / 0.9e1 * t976 * t136 * t363 + 0.4e1 / 0.3e1 * t354 * t987 * t136 + 0.4e1 / 0.3e1 * t979 * t363 + 0.4e1 / 0.9e1 * t477 * t829 + 0.4e1 / 0.3e1 * t23 * t1864);
  t1877 = t5 * t996 * t195;
  t1883 = t5 * t1003 * t195;
  t1884 = t1883 / 0.4e1;
  t1886 = t5 * t490 * t444;
  t1899 = -0.3e1 / 0.8e1 * t1834 + t1839 - 0.5e1 / 0.36e2 * t1842 - 0.5e1 / 0.12e2 * t1633 + t1640 - 0.3e1 / 0.8e1 * t5 * t1868 * t26 * t79 - 0.9e1 / 0.8e1 * t5 * t992 * t195 - 0.3e1 / 0.4e1 * t1877 - 0.9e1 / 0.8e1 * t5 * t486 * t444 + t1884 - 0.3e1 / 0.8e1 * t1886 - 0.3e1 / 0.8e1 * t5 * t223 * t934 - 0.5e1 / 0.12e2 * t1642 + t1645 / 0.4e1 - t1648 / 0.8e1 - 0.3e1 / 0.8e1 * t1763 + t1769 / 0.2e1 - 0.3e1 / 0.8e1 * t1771 - t1778 / 0.8e1 + t1782 / 0.4e1;
  t1900 = my_piecewise3(t1, 0, t1899);
  t1918 = my_piecewise5(t14, 0, t10, 0, -t1863);
  t1922 = my_piecewise3(t87, 0, 0.4e2 / 0.81e2 * t1788 * t230 * t942 - 0.8e1 / 0.9e1 * t941 * t504 * t452 - 0.8e1 / 0.9e1 * t1020 * t202 * t456 + 0.4e1 / 0.3e1 * t451 * t1029 * t202 + 0.4e1 / 0.3e1 * t1023 * t456 + 0.4e1 / 0.9e1 * t501 * t949 + 0.4e1 / 0.3e1 * t88 * t1918);
  t1929 = t5 * t1033 * t145 * t127;
  t1933 = t5 * t508 * t380 * t127;
  t1934 = t1933 / 0.4e1;
  t1937 = t5 * t233 * t856 * t127;
  t1946 = t5 * t958 * t279;
  t1949 = t5 * t962 * t279;
  t1950 = t1949 / 0.4e1;
  t1952 = t5 * t966 * t279;
  t1954 = -0.3e1 / 0.8e1 * t5 * t1922 * t26 * t127 - 0.3e1 / 0.8e1 * t1929 + t1934 - 0.5e1 / 0.36e2 * t1937 - t1812 / 0.8e1 + t1816 / 0.4e1 - 0.5e1 / 0.12e2 * t1820 + t1825 - 0.3e1 / 0.8e1 * t5 * t954 * t279 - 0.3e1 / 0.8e1 * t1946 + t1950 - 0.5e1 / 0.36e2 * t1952;
  t1955 = my_piecewise3(t84, 0, t1954);
  tv4rho41 = t939 + t971 + 0.3e1 * t1019 + 0.3e1 * t1058 + t6 * (t1900 + t1955);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1964 = t5 * t1074 * t145 * t79;
  t1968 = t5 * t539 * t380 * t79;
  t1982 = t481 * t481;
  t1995 = my_piecewise5(t10, 0, t14, 0, t1862);
  t1999 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1733 * t530 * t355 - 0.32e2 / 0.27e2 * t976 * t136 * t481 - 0.8e1 / 0.27e2 * t1061 * t363 + 0.8e1 / 0.9e1 * t354 * t1982 + 0.8e1 / 0.9e1 * t477 * t987 - 0.8e1 / 0.27e2 * t817 * t535 * t355 + 0.8e1 / 0.9e1 * t354 * t1070 * t136 + 0.4e1 / 0.9e1 * t1066 * t363 + 0.4e1 / 0.3e1 * t23 * t1995);
  t2008 = t5 * t1079 * t195;
  t2020 = -t1964 / 0.4e1 + t1968 / 0.12e2 - t1834 / 0.4e1 + t1838 / 0.3e1 - 0.5e1 / 0.18e2 * t1842 - 0.5e1 / 0.18e2 * t1633 + t1640 - 0.3e1 / 0.8e1 * t5 * t1999 * t26 * t79 - 0.3e1 / 0.4e1 * t5 * t1075 * t195 - t2008 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t540 * t444 - t1877 / 0.2e1 + t1883 / 0.3e1 - t1886 / 0.4e1 - 0.5e1 / 0.18e2 * t1642 + t1645 / 0.12e2 + t1769 / 0.6e1 + t1782 / 0.12e2;
  t2021 = my_piecewise3(t1, 0, t2020);
  t2030 = t504 * t504;
  t2043 = my_piecewise5(t14, 0, t10, 0, -t1862);
  t2047 = my_piecewise3(t87, 0, 0.4e2 / 0.81e2 * t1788 * t547 * t452 - 0.32e2 / 0.27e2 * t1020 * t202 * t504 - 0.8e1 / 0.27e2 * t1091 * t456 + 0.8e1 / 0.9e1 * t451 * t2030 + 0.8e1 / 0.9e1 * t501 * t1029 - 0.8e1 / 0.27e2 * t941 * t551 * t452 + 0.8e1 / 0.9e1 * t451 * t1100 * t202 + 0.4e1 / 0.9e1 * t1096 * t456 + 0.4e1 / 0.3e1 * t88 * t2043);
  t2054 = t5 * t1104 * t145 * t127;
  t2058 = t5 * t555 * t380 * t127;
  t2067 = t5 * t1038 * t279;
  t2070 = t5 * t1042 * t279;
  t2081 = t5 * t465 * t618;
  t2084 = t5 * t469 * t618;
  t2086 = -0.3e1 / 0.8e1 * t5 * t2047 * t26 * t127 - t2054 / 0.4e1 + t2058 / 0.12e2 - t1929 / 0.4e1 + t1933 / 0.3e1 - 0.5e1 / 0.18e2 * t1937 - 0.3e1 / 0.4e1 * t5 * t1034 * t279 - t2067 / 0.2e1 + t2070 / 0.6e1 + t1816 / 0.12e2 - 0.5e1 / 0.18e2 * t1820 + t1825 - t1946 / 0.4e1 + t1949 / 0.3e1 - 0.5e1 / 0.18e2 * t1952 - 0.3e1 / 0.8e1 * t5 * t461 * t618 - t2081 / 0.4e1 + t2084 / 0.12e2;
  t2087 = my_piecewise3(t84, 0, t2086);
  tv4rho42 = 0.2e1 * t1019 + 0.2e1 * t1058 + 0.2e1 * t1090 + 0.2e1 * t1129 + t6 * (t2021 + t2087);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2107 = t1861 + t1862;
  t2108 = my_piecewise5(t10, 0, t14, 0, t2107);
  t2112 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1733 * t1134 * t136 - 0.8e1 / 0.9e1 * t1061 * t481 - 0.8e1 / 0.9e1 * t976 * t535 * t136 + 0.4e1 / 0.3e1 * t979 * t535 + 0.4e1 / 0.3e1 * t477 * t1070 + 0.4e1 / 0.9e1 * t354 * t1141 * t136 + 0.4e1 / 0.3e1 * t23 * t2108);
  t2119 = t5 * t1145 * t145 * t79;
  t2130 = -0.3e1 / 0.8e1 * t5 * t2112 * t26 * t79 - t2119 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1146 * t195 - 0.3e1 / 0.8e1 * t1964 + t1968 / 0.4e1 - 0.3e1 / 0.8e1 * t2008 + t1839 - 0.5e1 / 0.12e2 * t1842 + t1884 - 0.5e1 / 0.36e2 * t1633 + t1640 - 0.5e1 / 0.36e2 * t1642;
  t2131 = my_piecewise3(t1, 0, t2130);
  t2148 = my_piecewise5(t14, 0, t10, 0, -t2107);
  t2152 = my_piecewise3(t87, 0, 0.4e2 / 0.81e2 * t1788 * t1154 * t202 - 0.8e1 / 0.9e1 * t1091 * t504 - 0.8e1 / 0.9e1 * t1020 * t551 * t202 + 0.4e1 / 0.3e1 * t1023 * t551 + 0.4e1 / 0.3e1 * t501 * t1100 + 0.4e1 / 0.9e1 * t451 * t1160 * t202 + 0.4e1 / 0.3e1 * t88 * t2148);
  t2159 = t5 * t1164 * t145 * t127;
  t2167 = t5 * t1109 * t279;
  t2176 = t5 * t513 * t618;
  t2186 = t5 * t210 * t1243;
  t2188 = -0.3e1 / 0.8e1 * t5 * t2152 * t26 * t127 - t2159 / 0.8e1 - 0.3e1 / 0.8e1 * t2054 + t2058 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1105 * t279 - 0.3e1 / 0.8e1 * t2167 + t1934 - 0.5e1 / 0.12e2 * t1937 - 0.3e1 / 0.4e1 * t2067 + t2070 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t509 * t618 - 0.3e1 / 0.8e1 * t2176 - 0.5e1 / 0.36e2 * t1820 + t1825 + t1950 - 0.5e1 / 0.12e2 * t1952 - 0.3e1 / 0.8e1 * t2081 + t2084 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t206 * t1243 - t2186 / 0.8e1;
  t2189 = my_piecewise3(t84, 0, t2188);
  tv4rho43 = 0.3e1 * t1090 + 0.3e1 * t1129 + t1153 + t1248 + t6 * (t2131 + t2189);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2194 = t530 * t530;
  t2199 = t535 * t535;
  t2205 = 0.24e2 * t825 + 0.24e2 * t1747;
  t2206 = my_piecewise5(t10, 0, t14, 0, t2205);
  t2210 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1733 * t2194 - 0.16e2 / 0.9e1 * t1061 * t535 + 0.4e1 / 0.3e1 * t354 * t2199 + 0.16e2 / 0.9e1 * t477 * t1141 + 0.4e1 / 0.3e1 * t23 * t2206);
  t2219 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2210 * t26 * t79 - t2119 / 0.2e1 + t1968 / 0.2e1 - 0.5e1 / 0.9e1 * t1842 + t1640);
  t2245 = t107 / t93 / t257;
  t2249 = 0.1e1 / t590;
  t2250 = t2249 * t123;
  t2256 = t267 / t94 / t724;
  t2262 = t606 / t93 / t1548;
  t2265 = t613 * t1677 * t440;
  t2281 = t1214 * t108;
  t2283 = 0.1e1 / t2281 * t1238;
  t2309 = 0.1e1 / t273 / t122 * t1677 * t191;
  t2312 = 0.2618e4 / 0.243e3 * t34 * sigma[2] / t94 / t245 * t103 - 0.3047e4 / 0.972e3 * t158 * t2245 * t249 + 0.2563e4 / 0.1458e4 * t578 * t2250 * t405 - 0.49e2 / 0.729e3 * t401 * t2256 * t1202 + 0.2e1 / 0.2187e4 * t401 * t2262 * t2265 + 0.5225e4 / 0.1458e4 * t55 * t2245 * t114 - 0.29645e5 / 0.5832e4 * t256 * t2250 * params->a + 0.4915e4 / 0.11664e5 * t170 * t2256 * t596 - 0.65e2 / 0.4374e4 * t170 * t2262 * t1220 + 0.5e1 / 0.4374e4 * t1694 * t1233 * t2283 * t1677 + 0.55e2 / 0.16e2 * t69 * t118 * t2249 * t123 - 0.68965e5 / 0.93312e5 * t69 * t2256 * t276 + 0.8035e4 / 0.139968e6 * t69 * t2262 * t615 - 0.5e1 / 0.432e3 * t1234 * t2283 * t888 + 0.5e1 / 0.34992e5 * t923 * t267 * t118 / t94 / t1214 / t245 * t2309;
  t2316 = t547 * t547;
  t2321 = t551 * t551;
  t2327 = my_piecewise5(t14, 0, t10, 0, -t2205);
  t2331 = my_piecewise3(t87, 0, 0.4e2 / 0.81e2 * t1788 * t2316 - 0.16e2 / 0.9e1 * t1091 * t551 + 0.4e1 / 0.3e1 * t451 * t2321 + 0.16e2 / 0.9e1 * t501 * t1160 + 0.4e1 / 0.3e1 * t88 * t2327);
  t2336 = -t2159 / 0.2e1 - 0.3e1 / 0.2e1 * t2167 - 0.3e1 / 0.2e1 * t2176 - t2186 / 0.2e1 + t2058 / 0.2e1 + t2070 + t2084 / 0.2e1 - 0.5e1 / 0.9e1 * t1937 - 0.5e1 / 0.9e1 * t1952 + t1825 - 0.3e1 / 0.2e1 * t5 * t1165 * t279 - 0.9e1 / 0.4e1 * t5 * t556 * t618 - 0.3e1 / 0.2e1 * t5 * t234 * t1243 - 0.3e1 / 0.8e1 * t5 * t91 * t2312 - 0.3e1 / 0.8e1 * t5 * t2331 * t26 * t127;
  t2337 = my_piecewise3(t84, 0, t2336);
  tv4rho44 = 0.4e1 * t1153 + 0.4e1 * t1248 + t6 * (t2219 + t2337);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t2345 = t5 * t838 * t314;
  t2351 = t5 * t845 * t314;
  t2354 = t5 * t372 * t669;
  t2361 = 0.5e1 / 0.36e2 * t5 * t857 * t314;
  t2363 = t5 * t381 * t669;
  t2366 = t5 * t146 * t1314;
  t2385 = t182 * t904;
  t2395 = t70 * t885;
  t2425 = -0.154e3 / 0.81e2 * t29 * t33 * t868 * t47 + 0.253e3 / 0.324e3 * t158 * t874 * t63 * t637 - 0.1025e4 / 0.1944e4 * t401 * t879 * t1277 + 0.89e2 / 0.3888e4 * t401 * t885 * t189 * t888 * t70 * t191 - t401 * t2385 * t1679 / 0.2916e4 - 0.209e3 / 0.243e3 * t55 * sigma[0] * t874 * t63 + 0.2809e4 / 0.1944e4 * t298 * t896 - 0.2093e4 / 0.15552e5 * t170 * t2395 * t421 + 0.121e3 / 0.23328e5 * t170 * t2385 * t908 - 0.5e1 / 0.11664e5 * t1694 * t431 * t930 * t1677 - 0.15e2 / 0.16e2 * t69 * t56 * t879 * t75 + 0.6995e4 / 0.31104e5 * t69 * t2395 * t192 - 0.3545e4 / 0.186624e6 * t69 * t2385 * t441 + 0.85e2 / 0.20736e5 * t1307 * t931 - 0.5e1 / 0.93312e5 * t923 * t924 / t37 / t902 / t58 * t1724;
  t2430 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t834 * t314 - 0.3e1 / 0.8e1 * t2345 - 0.9e1 / 0.8e1 * t5 * t368 * t669 + t2351 / 0.4e1 - 0.3e1 / 0.4e1 * t2354 - 0.9e1 / 0.8e1 * t5 * t140 * t1314 - t2361 + t2363 / 0.4e1 - 0.3e1 / 0.8e1 * t2366 - 0.3e1 / 0.8e1 * t5 * t27 * t2425);
  tv4rho3sigma0 = t6 * t2430 + 0.3e1 * t1319;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t2437 = t5 * t958 * t346;
  t2440 = t5 * t962 * t346;
  t2444 = 0.5e1 / 0.36e2 * t5 * t966 * t346;
  t2446 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t954 * t346 - 0.3e1 / 0.8e1 * t2437 + t2440 / 0.4e1 - t2444);
  tv4rho3sigma2 = t6 * t2446 + 0.3e1 * t1332;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t2448 = 0.2e1 * t1346;
  t2454 = t5 * t996 * t314 / 0.4e1;
  t2459 = t5 * t1003 * t314;
  t2463 = t5 * t490 * t669 / 0.4e1;
  t2472 = -0.3e1 / 0.8e1 * t5 * t992 * t314 - t2454 - 0.3e1 / 0.4e1 * t5 * t486 * t669 + t2459 / 0.12e2 - t2463 - 0.3e1 / 0.8e1 * t5 * t223 * t1314 - t2345 / 0.8e1 + t2351 / 0.6e1 - t2354 / 0.4e1 - t2361 + t2363 / 0.6e1 - t2366 / 0.8e1;
  t2473 = my_piecewise3(t1, 0, t2472);
  tv4rho3sigma3 = t6 * t2473 + t1319 + t2448;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t2475 = 0.2e1 * t1362;
  t2481 = t5 * t1038 * t346 / 0.4e1;
  t2483 = t5 * t1042 * t346;
  t2492 = t5 * t465 * t731 / 0.4e1;
  t2494 = t5 * t469 * t731;
  t2497 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t1034 * t346 - t2481 + t2483 / 0.12e2 - t2437 / 0.8e1 + t2440 / 0.6e1 - t2444 - 0.3e1 / 0.8e1 * t5 * t461 * t731 - t2492 + t2494 / 0.12e2);
  tv4rho3sigma5 = t6 * t2497 + t1332 + t2475;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2503 = t5 * t1079 * t314;
  t2512 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1075 * t314 - t2503 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t540 * t669 - t2454 + t2459 / 0.6e1 - t2463 + t2351 / 0.12e2 - t2361 + t2363 / 0.12e2);
  tv4rho3sigma6 = t6 * t2512 + t1370 + t2448;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2518 = t5 * t1109 * t346;
  t2525 = t5 * t513 * t731;
  t2533 = t5 * t210 * t1428;
  t2535 = -0.3e1 / 0.8e1 * t5 * t1105 * t346 - t2518 / 0.8e1 - t2481 + t2483 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t509 * t731 - t2525 / 0.4e1 + t2440 / 0.12e2 - t2444 - t2492 + t2494 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t206 * t1428 - t2533 / 0.8e1;
  t2536 = my_piecewise3(t84, 0, t2535);
  tv4rho3sigma8 = t6 * t2536 + t1433 + t2475;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2545 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1146 * t314 - 0.3e1 / 0.8e1 * t2503 + t2459 / 0.4e1 - t2361);
  tv4rho3sigma9 = t6 * t2545 + 0.3e1 * t1370;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2579 = t267 * t1216;
  t2589 = t118 * t1198;
  t2619 = -0.154e3 / 0.81e2 * t29 * t33 * t1181 * t103 + 0.253e3 / 0.324e3 * t158 * t1187 * t114 * t699 - 0.1025e4 / 0.1944e4 * t401 * t1192 * t1391 + 0.89e2 / 0.3888e4 * t401 * t1198 * t274 * t888 * t118 * t191 - t401 * t2579 * t2265 / 0.2916e4 - 0.209e3 / 0.243e3 * t55 * sigma[2] * t1187 * t114 + 0.2809e4 / 0.1944e4 * t330 * t1208 - 0.2093e4 / 0.15552e5 * t170 * t2589 * t596 + 0.121e3 / 0.23328e5 * t170 * t2579 * t1220 - 0.5e1 / 0.11664e5 * t1694 * t606 * t1239 * t1677 - 0.15e2 / 0.16e2 * t69 * t107 * t1192 * t123 + 0.6995e4 / 0.31104e5 * t69 * t2589 * t276 - 0.3545e4 / 0.186624e6 * t69 * t2579 * t615 + 0.85e2 / 0.20736e5 * t1421 * t1240 - 0.5e1 / 0.93312e5 * t923 * t1233 / t94 / t1214 / t109 * t2309;
  t2624 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t1165 * t346 - 0.3e1 / 0.8e1 * t2518 - 0.9e1 / 0.8e1 * t5 * t556 * t731 + t2483 / 0.4e1 - 0.3e1 / 0.4e1 * t2525 - 0.9e1 / 0.8e1 * t5 * t234 * t1428 - t2444 + t2494 / 0.4e1 - 0.3e1 / 0.8e1 * t2533 - 0.3e1 / 0.8e1 * t5 * t91 * t2619);
  tv4rho3sigma11 = t6 * t2624 + 0.3e1 * t1433;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2631 = t5 * t372 * t771;
  t2638 = t5 * t381 * t771 / 0.12e2;
  t2640 = t5 * t146 * t1485;
  t2647 = t417 * t189;
  t2653 = t70 * t434;
  t2695 = -0.19e2 / 0.162e3 * t158 * t1271 * params->a + 0.167e3 / 0.1296e4 * t1275 * t1445 - 0.25e2 / 0.3456e4 * t401 * t2647 * t888 * t56 * t191 + t401 * t2653 * t1679 / 0.7776e4 + 0.19e2 / 0.162e3 * t52 * t54 * t396 * t63 - 0.205e3 / 0.648e3 * t170 * t403 * t1458 + 0.49e2 / 0.1296e4 * t170 * t2647 * t405 * t56 * t191 - 0.107e3 / 0.62208e5 * t170 * t2653 * t908 + 0.5e1 / 0.31104e5 * t1694 * t182 * t1310 * t1677 + 0.3e1 / 0.16e2 * t69 * sigma[0] * t403 * t75 - 0.199e3 / 0.3456e4 * t69 * t56 * t417 * t192 + 0.713e3 / 0.124416e6 * t69 * t2653 * t441 - 0.695e3 / 0.497664e6 * t1478 * t1311 + 0.5e1 / 0.248832e6 * t923 * t431 / t37 / t1696 * t1724;
  t2700 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t368 * t771 - t2631 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t140 * t1485 + t2638 - t2640 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t2695);
  tv4rho2sigma20 = t6 * t2700 + 0.2e1 * t1490;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2707 = t5 * t465 * t809;
  t2711 = t5 * t469 * t809 / 0.12e2;
  t2713 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t461 * t809 - t2707 / 0.4e1 + t2711);
  tv4rho2sigma25 = t6 * t2713 + 0.2e1 * t1499;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2719 = t5 * t490 * t771;
  t2727 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t486 * t771 - t2719 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t223 * t1485 - t2631 / 0.8e1 + t2638 - t2640 / 0.8e1);
  tv4rho2sigma26 = t6 * t2727 + t1490 + t1505;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2733 = t5 * t513 * t809;
  t2740 = t5 * t210 * t1554;
  t2743 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t509 * t809 - t2733 / 0.8e1 - t2707 / 0.8e1 + t2711 - 0.3e1 / 0.8e1 * t5 * t206 * t1554 - t2740 / 0.8e1);
  tv4rho2sigma211 = t6 * t2743 + t1499 + t1559;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2751 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t540 * t771 - t2719 / 0.4e1 + t2638);
  tv4rho2sigma212 = t6 * t2751 + 0.2e1 * t1505;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2767 = t592 * t274;
  t2773 = t118 * t609;
  t2815 = -0.19e2 / 0.162e3 * t158 * t1385 * params->a + 0.167e3 / 0.1296e4 * t1389 * t1514 - 0.25e2 / 0.3456e4 * t401 * t2767 * t888 * t107 * t191 + t401 * t2773 * t2265 / 0.7776e4 + 0.19e2 / 0.162e3 * t52 * t54 * t573 * t114 - 0.205e3 / 0.648e3 * t170 * t579 * t1527 + 0.49e2 / 0.1296e4 * t170 * t2767 * t405 * t107 * t191 - 0.107e3 / 0.62208e5 * t170 * t2773 * t1220 + 0.5e1 / 0.31104e5 * t1694 * t267 * t1424 * t1677 + 0.3e1 / 0.16e2 * t69 * sigma[2] * t579 * t123 - 0.199e3 / 0.3456e4 * t69 * t107 * t592 * t276 + 0.713e3 / 0.124416e6 * t69 * t2773 * t615 - 0.695e3 / 0.497664e6 * t1547 * t1425 + 0.5e1 / 0.248832e6 * t923 * t606 / t94 / t2281 * t2309;
  t2820 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t556 * t809 - t2733 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t234 * t1554 + t2711 - t2740 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t91 * t2815);
  tv4rho2sigma217 = t6 * t2820 + 0.2e1 * t1559;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2827 = t5 * t146 * t1590 / 0.8e1;
  t2830 = t185 * t189;
  t2832 = t888 * t28;
  t2836 = t56 * t664;
  t2843 = t405 * t28;
  t2871 = -t401 * t642 / 0.48e2 + 0.7e1 / 0.3456e4 * t401 * t2830 * t2832 * t42 - t401 * t2836 * t1679 / 0.20736e5 + t170 * t175 / 0.24e2 - 0.5e1 / 0.576e3 * t170 * t2830 * t2843 * t42 + 0.11e2 / 0.20736e5 * t170 * t2836 * t908 - 0.5e1 / 0.82944e5 * t1694 * t70 * t1481 * t1677 - t69 * t174 / 0.48e2 + 0.13e2 / 0.1152e4 * t69 * t2830 * t41 * t42 - 0.7e1 / 0.4608e4 * t69 * t2836 * t441 + 0.25e2 / 0.55296e5 * t1584 * t1482 - 0.5e1 / 0.663552e6 * t923 * t182 / t37 / t926 * t1724;
  t2876 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t140 * t1590 - t2827 - 0.3e1 / 0.8e1 * t5 * t27 * t2871);
  tv4rhosigma30 = t6 * t2876 + t1594;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2883 = t5 * t210 * t1624 / 0.8e1;
  t2885 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t206 * t1624 - t2883);
  tv4rhosigma39 = t6 * t2885 + t1628;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2891 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t223 * t1590 - t2827);
  tv4rhosigma310 = t6 * t2891 + t1594;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2898 = t270 * t274;
  t2903 = t107 * t726;
  t2937 = -t401 * t704 / 0.48e2 + 0.7e1 / 0.3456e4 * t401 * t2898 * t2832 * t98 - t401 * t2903 * t2265 / 0.20736e5 + t170 * t260 / 0.24e2 - 0.5e1 / 0.576e3 * t170 * t2898 * t2843 * t98 + 0.11e2 / 0.20736e5 * t170 * t2903 * t1220 - 0.5e1 / 0.82944e5 * t1694 * t118 * t1550 * t1677 - t69 * t259 / 0.48e2 + 0.13e2 / 0.1152e4 * t69 * t2898 * t41 * t98 - 0.7e1 / 0.4608e4 * t69 * t2903 * t615 + 0.25e2 / 0.55296e5 * t1618 * t1551 - 0.5e1 / 0.663552e6 * t923 * t267 / t94 / t1235 * t2309;
  t2942 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t234 * t1624 - t2883 - 0.3e1 / 0.8e1 * t5 * t91 * t2937);
  tv4rhosigma319 = t6 * t2942 + t1628;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2947 = sigma[0] * t766;
  t2980 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (-t401 * t309 * t890 / 0.2304e4 + t401 * t2947 * t1679 / 0.55296e5 + t170 * t309 * t421 / 0.768e3 - t170 * t2947 * t908 / 0.6912e4 + 0.5e1 / 0.221184e6 * t1694 * t56 * t1586 * t1677 - t69 * t309 * t192 / 0.768e3 + t69 * t2947 * t441 / 0.3072e4 - 0.5e1 / 0.36864e5 * t923 * t56 * t1587 + 0.5e1 / 0.1769472e7 * t923 * t70 / t37 / t1308 * t1724));
  tv4sigma40 = t6 * t2980;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2984 = sigma[2] * t804;
  t3017 = my_piecewise3(t84, 0, -0.3e1 / 0.8e1 * t5 * t91 * (-t401 * t341 * t1202 / 0.2304e4 + t401 * t2984 * t2265 / 0.55296e5 + t170 * t341 * t596 / 0.768e3 - t170 * t2984 * t1220 / 0.6912e4 + 0.5e1 / 0.221184e6 * t1694 * t107 * t1620 * t1677 - t69 * t341 * t276 / 0.768e3 + t69 * t2984 * t615 / 0.3072e4 - 0.5e1 / 0.36864e5 * t923 * t107 * t1621 + 0.5e1 / 0.1769472e7 * t923 * t118 / t94 / t1422 * t2309));
  tv4sigma414 = t6 * t3017;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t39, t40, t45, t48, t49, t50;
  double t51, t52, t53, t55, t56, t57, t58, t62;
  double t63, t64, t65, t66, t67, t69, t70, t74;
  double t78, tzk0;

  gga_x_mpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_mpbe_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = params->c1 * t20 * t25;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = params->a * t20;
  t39 = 0.1e1 + t34 * t25 * t29 * t33 / 0.24e2;
  t40 = 0.1e1 / t39;
  t45 = t20 * t20;
  t48 = 0.1e1 / t23 / t22;
  t49 = params->c2 * t45 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t50 * t27;
  t52 = t30 * t30;
  t53 = t52 * rho[0];
  t55 = 0.1e1 / t18 / t53;
  t56 = t39 * t39;
  t57 = 0.1e1 / t56;
  t58 = t55 * t57;
  t62 = t22 * t22;
  t63 = 0.1e1 / t62;
  t64 = params->c3 * t63;
  t65 = t50 * sigma[0];
  t66 = t52 * t52;
  t67 = 0.1e1 / t66;
  t69 = t56 * t39;
  t70 = 0.1e1 / t69;
  t74 = 0.1e1 + t26 * t29 * t33 * t40 / 0.24e2 + t49 * t51 * t58 / 0.288e3 + t64 * t65 * t67 * t70 / 0.576e3;
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t39, t40, t45, t48, t49, t50;
  double t51, t52, t53, t55, t56, t57, t58, t62;
  double t63, t64, t65, t66, t67, t69, t70, t74;
  double t78, tzk0;

  double t80, t84, t86, t91, t93, t94, t96, t97;
  double t98, t99, t102, t106, t107, t108, t109, t110;
  double t111, t118, t119, t121, t124, t125, t128, t129;
  double t132, t137, tvrho0, t146, t147, t150, t154, t155;
  double t156, t163, t165, t170, t174, tvsigma0;

  gga_x_mpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_mpbe_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = params->c1 * t20 * t25;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = params->a * t20;
  t39 = 0.1e1 + t34 * t25 * t29 * t33 / 0.24e2;
  t40 = 0.1e1 / t39;
  t45 = t20 * t20;
  t48 = 0.1e1 / t23 / t22;
  t49 = params->c2 * t45 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t50 * t27;
  t52 = t30 * t30;
  t53 = t52 * rho[0];
  t55 = 0.1e1 / t18 / t53;
  t56 = t39 * t39;
  t57 = 0.1e1 / t56;
  t58 = t55 * t57;
  t62 = t22 * t22;
  t63 = 0.1e1 / t62;
  t64 = params->c3 * t63;
  t65 = t50 * sigma[0];
  t66 = t52 * t52;
  t67 = 0.1e1 / t66;
  t69 = t56 * t39;
  t70 = 0.1e1 / t69;
  t74 = 0.1e1 + t26 * t29 * t33 * t40 / 0.24e2 + t49 * t51 * t58 / 0.288e3 + t64 * t65 * t67 * t70 / 0.576e3;
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t31;
  t84 = t30 * rho[0];
  t86 = 0.1e1 / t31 / t84;
  t91 = params->c1 * t45;
  t93 = t91 * t48 * t50;
  t94 = t52 * t30;
  t96 = 0.1e1 / t18 / t94;
  t97 = t27 * t96;
  t98 = t57 * params->a;
  t99 = t97 * t98;
  t102 = t96 * t57;
  t106 = params->c2 * t63;
  t107 = t106 * t65;
  t108 = t66 * rho[0];
  t109 = 0.1e1 / t108;
  t110 = t109 * t70;
  t111 = t110 * params->a;
  t118 = t50 * t50;
  t119 = t66 * t84;
  t121 = 0.1e1 / t31 / t119;
  t124 = t56 * t56;
  t125 = 0.1e1 / t124;
  t128 = t20 * t25 * t28;
  t129 = t125 * params->a * t128;
  t132 = -t26 * t29 * t86 * t40 / 0.9e1 + t93 * t99 / 0.108e3 - t49 * t51 * t102 / 0.54e2 + t107 * t111 / 0.108e3 - t64 * t65 * t109 * t70 / 0.72e2 + t64 * t118 * t121 * t129 / 0.1728e4;
  t137 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t132);
  tvrho0 = 0.2e1 * rho[0] * t137 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = t27 * t55;
  t147 = t146 * t98;
  t150 = sigma[0] * t27;
  t154 = t106 * t50;
  t155 = t67 * t70;
  t156 = t155 * params->a;
  t163 = t66 * t30;
  t165 = 0.1e1 / t31 / t163;
  t170 = t26 * t28 * t33 * t40 / 0.24e2 - t91 * t48 * sigma[0] * t147 / 0.288e3 + t49 * t150 * t58 / 0.144e3 - t154 * t156 / 0.288e3 + t64 * t50 * t67 * t70 / 0.192e3 - t64 * t65 * t165 * t129 / 0.4608e4;
  t174 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t170);
  tvsigma0 = 0.2e1 * rho[0] * t174;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t39, t40, t45, t48, t49, t50;
  double t51, t52, t53, t55, t56, t57, t58, t62;
  double t63, t64, t65, t66, t67, t69, t70, t74;
  double t78, tzk0;

  double t80, t84, t86, t91, t93, t94, t96, t97;
  double t98, t99, t102, t106, t107, t108, t109, t110;
  double t111, t118, t119, t121, t124, t125, t128, t129;
  double t132, t137, tvrho0, t146, t147, t150, t154, t155;
  double t156, t163, t165, t170, t174, tvsigma0;

  double t179, t187, t192, t194, t195, t196, t199, t200;
  double t201, t202, t203, t207, t211, t214, t216, t217;
  double t220, t230, t233, t237, t240, t241, t244, t249;
  double tv2rho20, t260, t261, t266, t274, t285, t287, t292;
  double t297, tv2rhosigma0, t300, t304, t313, t324, t326, t331;
  double t335, tv2sigma20;

  gga_x_mpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_mpbe_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = params->c1 * t20 * t25;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = params->a * t20;
  t39 = 0.1e1 + t34 * t25 * t29 * t33 / 0.24e2;
  t40 = 0.1e1 / t39;
  t45 = t20 * t20;
  t48 = 0.1e1 / t23 / t22;
  t49 = params->c2 * t45 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t50 * t27;
  t52 = t30 * t30;
  t53 = t52 * rho[0];
  t55 = 0.1e1 / t18 / t53;
  t56 = t39 * t39;
  t57 = 0.1e1 / t56;
  t58 = t55 * t57;
  t62 = t22 * t22;
  t63 = 0.1e1 / t62;
  t64 = params->c3 * t63;
  t65 = t50 * sigma[0];
  t66 = t52 * t52;
  t67 = 0.1e1 / t66;
  t69 = t56 * t39;
  t70 = 0.1e1 / t69;
  t74 = 0.1e1 + t26 * t29 * t33 * t40 / 0.24e2 + t49 * t51 * t58 / 0.288e3 + t64 * t65 * t67 * t70 / 0.576e3;
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t31;
  t84 = t30 * rho[0];
  t86 = 0.1e1 / t31 / t84;
  t91 = params->c1 * t45;
  t93 = t91 * t48 * t50;
  t94 = t52 * t30;
  t96 = 0.1e1 / t18 / t94;
  t97 = t27 * t96;
  t98 = t57 * params->a;
  t99 = t97 * t98;
  t102 = t96 * t57;
  t106 = params->c2 * t63;
  t107 = t106 * t65;
  t108 = t66 * rho[0];
  t109 = 0.1e1 / t108;
  t110 = t109 * t70;
  t111 = t110 * params->a;
  t118 = t50 * t50;
  t119 = t66 * t84;
  t121 = 0.1e1 / t31 / t119;
  t124 = t56 * t56;
  t125 = 0.1e1 / t124;
  t128 = t20 * t25 * t28;
  t129 = t125 * params->a * t128;
  t132 = -t26 * t29 * t86 * t40 / 0.9e1 + t93 * t99 / 0.108e3 - t49 * t51 * t102 / 0.54e2 + t107 * t111 / 0.108e3 - t64 * t65 * t109 * t70 / 0.72e2 + t64 * t118 * t121 * t129 / 0.1728e4;
  t137 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t132);
  tvrho0 = 0.2e1 * rho[0] * t137 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = t27 * t55;
  t147 = t146 * t98;
  t150 = sigma[0] * t27;
  t154 = t106 * t50;
  t155 = t67 * t70;
  t156 = t155 * params->a;
  t163 = t66 * t30;
  t165 = 0.1e1 / t31 / t163;
  t170 = t26 * t28 * t33 * t40 / 0.24e2 - t91 * t48 * sigma[0] * t147 / 0.288e3 + t49 * t150 * t58 / 0.144e3 - t154 * t156 / 0.288e3 + t64 * t50 * t67 * t70 / 0.192e3 - t64 * t65 * t165 * t129 / 0.4608e4;
  t174 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t170);
  tvsigma0 = 0.2e1 * rho[0] * t174;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t179 = t17 / t31 / rho[0];
  t187 = 0.1e1 / t31 / t52;
  t192 = t52 * t84;
  t194 = 0.1e1 / t18 / t192;
  t195 = t27 * t194;
  t196 = t195 * t98;
  t199 = params->c1 * t63;
  t200 = t199 * t65;
  t201 = 0.1e1 / t163;
  t202 = t201 * t70;
  t203 = params->a * params->a;
  t207 = t194 * t57;
  t211 = t202 * params->a;
  t214 = t66 * t52;
  t216 = 0.1e1 / t31 / t214;
  t217 = t118 * t216;
  t220 = t125 * t203 * t128;
  t230 = t118 * sigma[0];
  t233 = 0.1e1 / t18 / t66 / t192;
  t237 = 0.1e1 / t124 / t39;
  t240 = t45 * t48 * t27;
  t241 = t237 * t203 * t240;
  t244 = 0.11e2 / 0.27e2 * t26 * t29 * t187 * t40 - t93 * t196 / 0.12e2 + 0.2e1 / 0.81e2 * t200 * t202 * t203 + 0.19e2 / 0.162e3 * t49 * t51 * t207 - 0.43e2 / 0.324e3 * t107 * t211 + t106 * t217 * t220 / 0.324e3 + t64 * t65 * t201 * t70 / 0.8e1 - 0.59e2 / 0.5184e4 * t64 * t217 * t129 + t64 * t230 * t233 * t241 / 0.1944e4;
  t249 = my_piecewise3(t2, 0, t6 * t179 * t74 / 0.12e2 - t6 * t80 * t132 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t244);
  tv2rho20 = 0.2e1 * rho[0] * t249 + 0.4e1 * t137;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t260 = t91 * t48 * t27;
  t261 = params->a * sigma[0];
  t266 = t110 * t203;
  t274 = t65 * t121;
  t285 = t66 * t94;
  t287 = 0.1e1 / t18 / t285;
  t292 = -t26 * t28 * t86 * t40 / 0.9e1 + t260 * t102 * t261 / 0.36e2 - t199 * t50 * t266 / 0.108e3 - t49 * t150 * t102 / 0.27e2 + 0.5e1 / 0.108e3 * t154 * t111 - t106 * t274 * t220 / 0.864e3 - t64 * t50 * t109 * t70 / 0.24e2 + 0.7e1 / 0.1728e4 * t64 * t274 * t129 - t64 * t118 * t287 * t241 / 0.5184e4;
  t297 = my_piecewise3(t2, 0, -t6 * t80 * t170 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t292);
  tv2rhosigma0 = 0.2e1 * rho[0] * t297 + 0.2e1 * t174;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t300 = t91 * t48;
  t304 = t155 * t203;
  t313 = t50 * t165;
  t324 = t66 * t53;
  t326 = 0.1e1 / t18 / t324;
  t331 = -t300 * t147 / 0.144e3 + t199 * sigma[0] * t304 / 0.288e3 + t49 * t146 * t57 / 0.144e3 - t106 * sigma[0] * t156 / 0.72e2 + t106 * t313 * t220 / 0.2304e4 + t64 * sigma[0] * t67 * t70 / 0.96e2 - t64 * t313 * t129 / 0.768e3 + t64 * t65 * t326 * t241 / 0.13824e5;
  t335 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t331);
  tv2sigma20 = 0.2e1 * rho[0] * t335;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t39, t40, t45, t48, t49, t50;
  double t51, t52, t53, t55, t56, t57, t58, t62;
  double t63, t64, t65, t66, t67, t69, t70, t74;
  double t78, tzk0;

  double t80, t84, t86, t91, t93, t94, t96, t97;
  double t98, t99, t102, t106, t107, t108, t109, t110;
  double t111, t118, t119, t121, t124, t125, t128, t129;
  double t132, t137, tvrho0, t146, t147, t150, t154, t155;
  double t156, t163, t165, t170, t174, tvsigma0;

  double t179, t187, t192, t194, t195, t196, t199, t200;
  double t201, t202, t203, t207, t211, t214, t216, t217;
  double t220, t230, t233, t237, t240, t241, t244, t249;
  double tv2rho20, t260, t261, t266, t274, t285, t287, t292;
  double t297, tv2rhosigma0, t300, t304, t313, t324, t326, t331;
  double t335, tv2sigma20;

  double t338, t349, t355, t360, t361, t366, t367, t369;
  double t371, t374, t378, t384, t386, t387, t390, t403;
  double t404, t405, t406, t407, t408, t411, t412, t413;
  double t416, t421, tv3rho30, t438, t439, t440, t443, t455;
  double t469, t470, t472, t473, t476, t481, tv3rho2sigma0, t490;
  double t493, t502, t508, t522, t523, t525, t526, t529;
  double t534, tv3rhosigma20, t539, t548, t560, t562, t563, t566;
  double t570, tv3sigma30;

  gga_x_mpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_mpbe_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = params->c1 * t20 * t25;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = params->a * t20;
  t39 = 0.1e1 + t34 * t25 * t29 * t33 / 0.24e2;
  t40 = 0.1e1 / t39;
  t45 = t20 * t20;
  t48 = 0.1e1 / t23 / t22;
  t49 = params->c2 * t45 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t50 * t27;
  t52 = t30 * t30;
  t53 = t52 * rho[0];
  t55 = 0.1e1 / t18 / t53;
  t56 = t39 * t39;
  t57 = 0.1e1 / t56;
  t58 = t55 * t57;
  t62 = t22 * t22;
  t63 = 0.1e1 / t62;
  t64 = params->c3 * t63;
  t65 = t50 * sigma[0];
  t66 = t52 * t52;
  t67 = 0.1e1 / t66;
  t69 = t56 * t39;
  t70 = 0.1e1 / t69;
  t74 = 0.1e1 + t26 * t29 * t33 * t40 / 0.24e2 + t49 * t51 * t58 / 0.288e3 + t64 * t65 * t67 * t70 / 0.576e3;
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t31;
  t84 = t30 * rho[0];
  t86 = 0.1e1 / t31 / t84;
  t91 = params->c1 * t45;
  t93 = t91 * t48 * t50;
  t94 = t52 * t30;
  t96 = 0.1e1 / t18 / t94;
  t97 = t27 * t96;
  t98 = t57 * params->a;
  t99 = t97 * t98;
  t102 = t96 * t57;
  t106 = params->c2 * t63;
  t107 = t106 * t65;
  t108 = t66 * rho[0];
  t109 = 0.1e1 / t108;
  t110 = t109 * t70;
  t111 = t110 * params->a;
  t118 = t50 * t50;
  t119 = t66 * t84;
  t121 = 0.1e1 / t31 / t119;
  t124 = t56 * t56;
  t125 = 0.1e1 / t124;
  t128 = t20 * t25 * t28;
  t129 = t125 * params->a * t128;
  t132 = -t26 * t29 * t86 * t40 / 0.9e1 + t93 * t99 / 0.108e3 - t49 * t51 * t102 / 0.54e2 + t107 * t111 / 0.108e3 - t64 * t65 * t109 * t70 / 0.72e2 + t64 * t118 * t121 * t129 / 0.1728e4;
  t137 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t132);
  tvrho0 = 0.2e1 * rho[0] * t137 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = t27 * t55;
  t147 = t146 * t98;
  t150 = sigma[0] * t27;
  t154 = t106 * t50;
  t155 = t67 * t70;
  t156 = t155 * params->a;
  t163 = t66 * t30;
  t165 = 0.1e1 / t31 / t163;
  t170 = t26 * t28 * t33 * t40 / 0.24e2 - t91 * t48 * sigma[0] * t147 / 0.288e3 + t49 * t150 * t58 / 0.144e3 - t154 * t156 / 0.288e3 + t64 * t50 * t67 * t70 / 0.192e3 - t64 * t65 * t165 * t129 / 0.4608e4;
  t174 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t170);
  tvsigma0 = 0.2e1 * rho[0] * t174;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t179 = t17 / t31 / rho[0];
  t187 = 0.1e1 / t31 / t52;
  t192 = t52 * t84;
  t194 = 0.1e1 / t18 / t192;
  t195 = t27 * t194;
  t196 = t195 * t98;
  t199 = params->c1 * t63;
  t200 = t199 * t65;
  t201 = 0.1e1 / t163;
  t202 = t201 * t70;
  t203 = params->a * params->a;
  t207 = t194 * t57;
  t211 = t202 * params->a;
  t214 = t66 * t52;
  t216 = 0.1e1 / t31 / t214;
  t217 = t118 * t216;
  t220 = t125 * t203 * t128;
  t230 = t118 * sigma[0];
  t233 = 0.1e1 / t18 / t66 / t192;
  t237 = 0.1e1 / t124 / t39;
  t240 = t45 * t48 * t27;
  t241 = t237 * t203 * t240;
  t244 = 0.11e2 / 0.27e2 * t26 * t29 * t187 * t40 - t93 * t196 / 0.12e2 + 0.2e1 / 0.81e2 * t200 * t202 * t203 + 0.19e2 / 0.162e3 * t49 * t51 * t207 - 0.43e2 / 0.324e3 * t107 * t211 + t106 * t217 * t220 / 0.324e3 + t64 * t65 * t201 * t70 / 0.8e1 - 0.59e2 / 0.5184e4 * t64 * t217 * t129 + t64 * t230 * t233 * t241 / 0.1944e4;
  t249 = my_piecewise3(t2, 0, t6 * t179 * t74 / 0.12e2 - t6 * t80 * t132 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t244);
  tv2rho20 = 0.2e1 * rho[0] * t249 + 0.4e1 * t137;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t260 = t91 * t48 * t27;
  t261 = params->a * sigma[0];
  t266 = t110 * t203;
  t274 = t65 * t121;
  t285 = t66 * t94;
  t287 = 0.1e1 / t18 / t285;
  t292 = -t26 * t28 * t86 * t40 / 0.9e1 + t260 * t102 * t261 / 0.36e2 - t199 * t50 * t266 / 0.108e3 - t49 * t150 * t102 / 0.27e2 + 0.5e1 / 0.108e3 * t154 * t111 - t106 * t274 * t220 / 0.864e3 - t64 * t50 * t109 * t70 / 0.24e2 + 0.7e1 / 0.1728e4 * t64 * t274 * t129 - t64 * t118 * t287 * t241 / 0.5184e4;
  t297 = my_piecewise3(t2, 0, -t6 * t80 * t170 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t292);
  tv2rhosigma0 = 0.2e1 * rho[0] * t297 + 0.2e1 * t174;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t300 = t91 * t48;
  t304 = t155 * t203;
  t313 = t50 * t165;
  t324 = t66 * t53;
  t326 = 0.1e1 / t18 / t324;
  t331 = -t300 * t147 / 0.144e3 + t199 * sigma[0] * t304 / 0.288e3 + t49 * t146 * t57 / 0.144e3 - t106 * sigma[0] * t156 / 0.72e2 + t106 * t313 * t220 / 0.2304e4 + t64 * sigma[0] * t67 * t70 / 0.96e2 - t64 * t313 * t129 / 0.768e3 + t64 * t65 * t326 * t241 / 0.13824e5;
  t335 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t331);
  tv2sigma20 = 0.2e1 * rho[0] * t335;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t338 = t17 * t33;
  t349 = 0.1e1 / t31 / t53;
  t355 = 0.1e1 / t18 / t66;
  t360 = 0.1e1 / t119;
  t361 = t360 * t70;
  t366 = 0.1e1 / t31 / t324;
  t367 = t118 * t366;
  t369 = t203 * params->a;
  t371 = t125 * t369 * t128;
  t374 = t355 * t57;
  t378 = t361 * params->a;
  t384 = t66 * t66;
  t386 = 0.1e1 / t18 / t384;
  t387 = t230 * t386;
  t390 = t237 * t369 * t240;
  t403 = t62 * t62;
  t404 = 0.1e1 / t403;
  t405 = params->c3 * t404;
  t406 = t118 * t50;
  t407 = t405 * t406;
  t408 = t384 * t84;
  t411 = 0.1e1 / t124 / t56;
  t412 = 0.1e1 / t408 * t411;
  t413 = t412 * t369;
  t416 = -0.154e3 / 0.81e2 * t26 * t29 * t349 * t40 + 0.341e3 / 0.486e3 * t93 * t27 * t355 * t98 - 0.38e2 / 0.81e2 * t200 * t361 * t203 + 0.2e1 / 0.243e3 * t199 * t367 * t371 - 0.209e3 / 0.243e3 * t49 * t51 * t374 + 0.797e3 / 0.486e3 * t107 * t378 - t106 * t367 * t220 / 0.12e2 + 0.2e1 / 0.729e3 * t106 * t387 * t390 - 0.5e1 / 0.4e1 * t64 * t65 * t360 * t70 + 0.1445e4 / 0.7776e4 * t64 * t367 * t129 - 0.35e2 / 0.1944e4 * t64 * t387 * t241 + 0.5e1 / 0.1458e4 * t407 * t413;
  t421 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t338 * t74 + t6 * t179 * t132 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t80 * t244 - 0.3e1 / 0.8e1 * t6 * t19 * t416);
  tv3rho30 = 0.2e1 * rho[0] * t421 + 0.6e1 * t249;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t438 = t199 * t201;
  t439 = t70 * t203;
  t440 = t439 * t50;
  t443 = t65 * t216;
  t455 = t118 * t233;
  t469 = t405 * t230;
  t470 = t384 * t30;
  t472 = 0.1e1 / t470 * t411;
  t473 = t472 * t369;
  t476 = 0.11e2 / 0.27e2 * t26 * t28 * t187 * t40 - 0.65e2 / 0.324e3 * t260 * t207 * t261 + 0.17e2 / 0.108e3 * t438 * t440 - t199 * t443 * t371 / 0.324e3 + 0.19e2 / 0.81e2 * t49 * t150 * t207 - 0.167e3 / 0.324e3 * t154 * t211 + 0.25e2 / 0.864e3 * t106 * t443 * t220 - t106 * t455 * t390 / 0.972e3 + 0.3e1 / 0.8e1 * t64 * t50 * t201 * t70 - 0.317e3 / 0.5184e4 * t64 * t443 * t129 + 0.11e2 / 0.1728e4 * t64 * t455 * t241 - 0.5e1 / 0.3888e4 * t469 * t473;
  t481 = my_piecewise3(t2, 0, t6 * t179 * t170 / 0.12e2 - t6 * t80 * t292 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t476);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t481 + 0.4e1 * t297;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t490 = t439 * sigma[0];
  t493 = t50 * t121;
  t502 = t70 * params->a * sigma[0];
  t508 = t65 * t287;
  t522 = t405 * t118;
  t523 = t384 * rho[0];
  t525 = 0.1e1 / t523 * t411;
  t526 = t525 * t369;
  t529 = t300 * t99 / 0.27e2 - 0.5e1 / 0.108e3 * t199 * t109 * t490 + t199 * t493 * t371 / 0.864e3 - t49 * t97 * t57 / 0.27e2 + 0.7e1 / 0.54e2 * t106 * t109 * t502 - t106 * t493 * t220 / 0.108e3 + t106 * t508 * t390 / 0.2592e4 - t64 * sigma[0] * t109 * t70 / 0.12e2 + 0.5e1 / 0.288e3 * t64 * t493 * t129 - 0.11e2 / 0.5184e4 * t64 * t508 * t241 + 0.5e1 / 0.10368e5 * t522 * t526;
  t534 = my_piecewise3(t2, 0, -t6 * t80 * t331 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t529);
  tv3rhosigma20 = 0.2e1 * rho[0] * t534 + 0.2e1 * t335;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t539 = sigma[0] * t165;
  t548 = t50 * t326;
  t560 = t405 * t65;
  t562 = 0.1e1 / t384 * t411;
  t563 = t562 * t369;
  t566 = t199 * t304 / 0.96e2 - t199 * t539 * t371 / 0.2304e4 - t106 * t156 / 0.48e2 + t106 * t539 * t220 / 0.384e3 - t106 * t548 * t390 / 0.6912e4 + t64 * t155 / 0.96e2 - t64 * t539 * t129 / 0.256e3 + t64 * t548 * t241 / 0.1536e4 - 0.5e1 / 0.27648e5 * t560 * t563;
  t570 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t566);
  tv3sigma30 = 0.2e1 * rho[0] * t570;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t31;
  double t33, t34, t39, t40, t45, t48, t49, t50;
  double t51, t52, t53, t55, t56, t57, t58, t62;
  double t63, t64, t65, t66, t67, t69, t70, t74;
  double t78, tzk0;

  double t80, t84, t86, t91, t93, t94, t96, t97;
  double t98, t99, t102, t106, t107, t108, t109, t110;
  double t111, t118, t119, t121, t124, t125, t128, t129;
  double t132, t137, tvrho0, t146, t147, t150, t154, t155;
  double t156, t163, t165, t170, t174, tvsigma0;

  double t179, t187, t192, t194, t195, t196, t199, t200;
  double t201, t202, t203, t207, t211, t214, t216, t217;
  double t220, t230, t233, t237, t240, t241, t244, t249;
  double tv2rho20, t260, t261, t266, t274, t285, t287, t292;
  double t297, tv2rhosigma0, t300, t304, t313, t324, t326, t331;
  double t335, tv2sigma20;

  double t338, t349, t355, t360, t361, t366, t367, t369;
  double t371, t374, t378, t384, t386, t387, t390, t403;
  double t404, t405, t406, t407, t408, t411, t412, t413;
  double t416, t421, tv3rho30, t438, t439, t440, t443, t455;
  double t469, t470, t472, t473, t476, t481, tv3rho2sigma0, t490;
  double t493, t502, t508, t522, t523, t525, t526, t529;
  double t534, tv3rhosigma20, t539, t548, t560, t562, t563, t566;
  double t570, tv3sigma30;

  double t593, t598, t599, t605, t611, t613, t615, t631;
  double t633, t635, t661, t664, t669, tv4rho40, t698, t707;
  double t737, t742, tv4rho3sigma0, t756, t762, t803, t808, tv4rho2sigma20;
  double t816, t818, t820, t824, t831, t859, t864, tv4rhosigma30;
  double t867, t869, t873, t908, tv4sigma40;

  gga_x_mpbe_params *params;

  assert(p->params != NULL);
  params = (gga_x_mpbe_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = params->c1 * t20 * t25;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = params->a * t20;
  t39 = 0.1e1 + t34 * t25 * t29 * t33 / 0.24e2;
  t40 = 0.1e1 / t39;
  t45 = t20 * t20;
  t48 = 0.1e1 / t23 / t22;
  t49 = params->c2 * t45 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t50 * t27;
  t52 = t30 * t30;
  t53 = t52 * rho[0];
  t55 = 0.1e1 / t18 / t53;
  t56 = t39 * t39;
  t57 = 0.1e1 / t56;
  t58 = t55 * t57;
  t62 = t22 * t22;
  t63 = 0.1e1 / t62;
  t64 = params->c3 * t63;
  t65 = t50 * sigma[0];
  t66 = t52 * t52;
  t67 = 0.1e1 / t66;
  t69 = t56 * t39;
  t70 = 0.1e1 / t69;
  t74 = 0.1e1 + t26 * t29 * t33 * t40 / 0.24e2 + t49 * t51 * t58 / 0.288e3 + t64 * t65 * t67 * t70 / 0.576e3;
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t31;
  t84 = t30 * rho[0];
  t86 = 0.1e1 / t31 / t84;
  t91 = params->c1 * t45;
  t93 = t91 * t48 * t50;
  t94 = t52 * t30;
  t96 = 0.1e1 / t18 / t94;
  t97 = t27 * t96;
  t98 = t57 * params->a;
  t99 = t97 * t98;
  t102 = t96 * t57;
  t106 = params->c2 * t63;
  t107 = t106 * t65;
  t108 = t66 * rho[0];
  t109 = 0.1e1 / t108;
  t110 = t109 * t70;
  t111 = t110 * params->a;
  t118 = t50 * t50;
  t119 = t66 * t84;
  t121 = 0.1e1 / t31 / t119;
  t124 = t56 * t56;
  t125 = 0.1e1 / t124;
  t128 = t20 * t25 * t28;
  t129 = t125 * params->a * t128;
  t132 = -t26 * t29 * t86 * t40 / 0.9e1 + t93 * t99 / 0.108e3 - t49 * t51 * t102 / 0.54e2 + t107 * t111 / 0.108e3 - t64 * t65 * t109 * t70 / 0.72e2 + t64 * t118 * t121 * t129 / 0.1728e4;
  t137 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t132);
  tvrho0 = 0.2e1 * rho[0] * t137 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t146 = t27 * t55;
  t147 = t146 * t98;
  t150 = sigma[0] * t27;
  t154 = t106 * t50;
  t155 = t67 * t70;
  t156 = t155 * params->a;
  t163 = t66 * t30;
  t165 = 0.1e1 / t31 / t163;
  t170 = t26 * t28 * t33 * t40 / 0.24e2 - t91 * t48 * sigma[0] * t147 / 0.288e3 + t49 * t150 * t58 / 0.144e3 - t154 * t156 / 0.288e3 + t64 * t50 * t67 * t70 / 0.192e3 - t64 * t65 * t165 * t129 / 0.4608e4;
  t174 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t170);
  tvsigma0 = 0.2e1 * rho[0] * t174;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t179 = t17 / t31 / rho[0];
  t187 = 0.1e1 / t31 / t52;
  t192 = t52 * t84;
  t194 = 0.1e1 / t18 / t192;
  t195 = t27 * t194;
  t196 = t195 * t98;
  t199 = params->c1 * t63;
  t200 = t199 * t65;
  t201 = 0.1e1 / t163;
  t202 = t201 * t70;
  t203 = params->a * params->a;
  t207 = t194 * t57;
  t211 = t202 * params->a;
  t214 = t66 * t52;
  t216 = 0.1e1 / t31 / t214;
  t217 = t118 * t216;
  t220 = t125 * t203 * t128;
  t230 = t118 * sigma[0];
  t233 = 0.1e1 / t18 / t66 / t192;
  t237 = 0.1e1 / t124 / t39;
  t240 = t45 * t48 * t27;
  t241 = t237 * t203 * t240;
  t244 = 0.11e2 / 0.27e2 * t26 * t29 * t187 * t40 - t93 * t196 / 0.12e2 + 0.2e1 / 0.81e2 * t200 * t202 * t203 + 0.19e2 / 0.162e3 * t49 * t51 * t207 - 0.43e2 / 0.324e3 * t107 * t211 + t106 * t217 * t220 / 0.324e3 + t64 * t65 * t201 * t70 / 0.8e1 - 0.59e2 / 0.5184e4 * t64 * t217 * t129 + t64 * t230 * t233 * t241 / 0.1944e4;
  t249 = my_piecewise3(t2, 0, t6 * t179 * t74 / 0.12e2 - t6 * t80 * t132 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t244);
  tv2rho20 = 0.2e1 * rho[0] * t249 + 0.4e1 * t137;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t260 = t91 * t48 * t27;
  t261 = params->a * sigma[0];
  t266 = t110 * t203;
  t274 = t65 * t121;
  t285 = t66 * t94;
  t287 = 0.1e1 / t18 / t285;
  t292 = -t26 * t28 * t86 * t40 / 0.9e1 + t260 * t102 * t261 / 0.36e2 - t199 * t50 * t266 / 0.108e3 - t49 * t150 * t102 / 0.27e2 + 0.5e1 / 0.108e3 * t154 * t111 - t106 * t274 * t220 / 0.864e3 - t64 * t50 * t109 * t70 / 0.24e2 + 0.7e1 / 0.1728e4 * t64 * t274 * t129 - t64 * t118 * t287 * t241 / 0.5184e4;
  t297 = my_piecewise3(t2, 0, -t6 * t80 * t170 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t292);
  tv2rhosigma0 = 0.2e1 * rho[0] * t297 + 0.2e1 * t174;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t300 = t91 * t48;
  t304 = t155 * t203;
  t313 = t50 * t165;
  t324 = t66 * t53;
  t326 = 0.1e1 / t18 / t324;
  t331 = -t300 * t147 / 0.144e3 + t199 * sigma[0] * t304 / 0.288e3 + t49 * t146 * t57 / 0.144e3 - t106 * sigma[0] * t156 / 0.72e2 + t106 * t313 * t220 / 0.2304e4 + t64 * sigma[0] * t67 * t70 / 0.96e2 - t64 * t313 * t129 / 0.768e3 + t64 * t65 * t326 * t241 / 0.13824e5;
  t335 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t331);
  tv2sigma20 = 0.2e1 * rho[0] * t335;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t338 = t17 * t33;
  t349 = 0.1e1 / t31 / t53;
  t355 = 0.1e1 / t18 / t66;
  t360 = 0.1e1 / t119;
  t361 = t360 * t70;
  t366 = 0.1e1 / t31 / t324;
  t367 = t118 * t366;
  t369 = t203 * params->a;
  t371 = t125 * t369 * t128;
  t374 = t355 * t57;
  t378 = t361 * params->a;
  t384 = t66 * t66;
  t386 = 0.1e1 / t18 / t384;
  t387 = t230 * t386;
  t390 = t237 * t369 * t240;
  t403 = t62 * t62;
  t404 = 0.1e1 / t403;
  t405 = params->c3 * t404;
  t406 = t118 * t50;
  t407 = t405 * t406;
  t408 = t384 * t84;
  t411 = 0.1e1 / t124 / t56;
  t412 = 0.1e1 / t408 * t411;
  t413 = t412 * t369;
  t416 = -0.154e3 / 0.81e2 * t26 * t29 * t349 * t40 + 0.341e3 / 0.486e3 * t93 * t27 * t355 * t98 - 0.38e2 / 0.81e2 * t200 * t361 * t203 + 0.2e1 / 0.243e3 * t199 * t367 * t371 - 0.209e3 / 0.243e3 * t49 * t51 * t374 + 0.797e3 / 0.486e3 * t107 * t378 - t106 * t367 * t220 / 0.12e2 + 0.2e1 / 0.729e3 * t106 * t387 * t390 - 0.5e1 / 0.4e1 * t64 * t65 * t360 * t70 + 0.1445e4 / 0.7776e4 * t64 * t367 * t129 - 0.35e2 / 0.1944e4 * t64 * t387 * t241 + 0.5e1 / 0.1458e4 * t407 * t413;
  t421 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t338 * t74 + t6 * t179 * t132 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t80 * t244 - 0.3e1 / 0.8e1 * t6 * t19 * t416);
  tv3rho30 = 0.2e1 * rho[0] * t421 + 0.6e1 * t249;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t438 = t199 * t201;
  t439 = t70 * t203;
  t440 = t439 * t50;
  t443 = t65 * t216;
  t455 = t118 * t233;
  t469 = t405 * t230;
  t470 = t384 * t30;
  t472 = 0.1e1 / t470 * t411;
  t473 = t472 * t369;
  t476 = 0.11e2 / 0.27e2 * t26 * t28 * t187 * t40 - 0.65e2 / 0.324e3 * t260 * t207 * t261 + 0.17e2 / 0.108e3 * t438 * t440 - t199 * t443 * t371 / 0.324e3 + 0.19e2 / 0.81e2 * t49 * t150 * t207 - 0.167e3 / 0.324e3 * t154 * t211 + 0.25e2 / 0.864e3 * t106 * t443 * t220 - t106 * t455 * t390 / 0.972e3 + 0.3e1 / 0.8e1 * t64 * t50 * t201 * t70 - 0.317e3 / 0.5184e4 * t64 * t443 * t129 + 0.11e2 / 0.1728e4 * t64 * t455 * t241 - 0.5e1 / 0.3888e4 * t469 * t473;
  t481 = my_piecewise3(t2, 0, t6 * t179 * t170 / 0.12e2 - t6 * t80 * t292 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t476);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t481 + 0.4e1 * t297;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t490 = t439 * sigma[0];
  t493 = t50 * t121;
  t502 = t70 * params->a * sigma[0];
  t508 = t65 * t287;
  t522 = t405 * t118;
  t523 = t384 * rho[0];
  t525 = 0.1e1 / t523 * t411;
  t526 = t525 * t369;
  t529 = t300 * t99 / 0.27e2 - 0.5e1 / 0.108e3 * t199 * t109 * t490 + t199 * t493 * t371 / 0.864e3 - t49 * t97 * t57 / 0.27e2 + 0.7e1 / 0.54e2 * t106 * t109 * t502 - t106 * t493 * t220 / 0.108e3 + t106 * t508 * t390 / 0.2592e4 - t64 * sigma[0] * t109 * t70 / 0.12e2 + 0.5e1 / 0.288e3 * t64 * t493 * t129 - 0.11e2 / 0.5184e4 * t64 * t508 * t241 + 0.5e1 / 0.10368e5 * t522 * t526;
  t534 = my_piecewise3(t2, 0, -t6 * t80 * t331 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t529);
  tv3rhosigma20 = 0.2e1 * rho[0] * t534 + 0.2e1 * t335;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t539 = sigma[0] * t165;
  t548 = t50 * t326;
  t560 = t405 * t65;
  t562 = 0.1e1 / t384 * t411;
  t563 = t562 * t369;
  t566 = t199 * t304 / 0.96e2 - t199 * t539 * t371 / 0.2304e4 - t106 * t156 / 0.48e2 + t106 * t539 * t220 / 0.384e3 - t106 * t548 * t390 / 0.6912e4 + t64 * t155 / 0.96e2 - t64 * t539 * t129 / 0.256e3 + t64 * t548 * t241 / 0.1536e4 - 0.5e1 / 0.27648e5 * t560 * t563;
  t570 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t566);
  tv3sigma30 = 0.2e1 * rho[0] * t570;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t593 = 0.1e1 / t18 / t108;
  t598 = 0.1e1 / t214;
  t599 = t598 * t70;
  t605 = t118 / t31 / t285;
  t611 = t230 / t18 / t523;
  t613 = t203 * t203;
  t615 = t237 * t613 * t240;
  t631 = params->c2 * t404;
  t633 = t384 * t52;
  t635 = 0.1e1 / t633 * t411;
  t661 = 0.1e1 / t124 / t69 * t613 * t128;
  t664 = 0.2618e4 / 0.243e3 * t26 * t29 / t31 / t94 * t40 - 0.3047e4 / 0.486e3 * t93 * t27 * t593 * t98 + 0.5126e4 / 0.729e3 * t200 * t599 * t203 - 0.196e3 / 0.729e3 * t199 * t605 * t371 + 0.16e2 / 0.2187e4 * t199 * t611 * t615 + 0.5225e4 / 0.729e3 * t49 * t51 * t593 * t57 - 0.29645e5 / 0.1458e4 * t107 * t599 * params->a + 0.4915e4 / 0.2916e4 * t106 * t605 * t220 - 0.26e3 / 0.2187e4 * t106 * t611 * t390 + 0.4e2 / 0.2187e4 * t631 * t406 * t635 * t613 + 0.55e2 / 0.4e1 * t64 * t65 * t598 * t70 - 0.68965e5 / 0.23328e5 * t64 * t605 * t129 + 0.8035e4 / 0.17496e5 * t64 * t611 * t241 - 0.5e1 / 0.27e2 * t407 * t635 * t369 + 0.5e1 / 0.2187e4 * t405 * t118 * t65 / t31 / t384 / t94 * t661;
  t669 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t86 * t74 - 0.5e1 / 0.9e1 * t6 * t338 * t132 + t6 * t179 * t244 / 0.2e1 - t6 * t80 * t416 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * t664);
  tv4rho40 = 0.2e1 * rho[0] * t669 + 0.8e1 * t421;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t698 = t118 * t386;
  t707 = t65 * t366;
  t737 = -0.154e3 / 0.81e2 * t26 * t28 * t349 * t40 + 0.253e3 / 0.162e3 * t260 * t374 * t261 - 0.1025e4 / 0.486e3 * t199 * t360 * t440 + 0.89e2 / 0.972e3 * t199 * t366 * t125 * t369 * t65 * t128 - 0.2e1 / 0.729e3 * t199 * t698 * t615 - 0.418e3 / 0.243e3 * t49 * t150 * t374 + 0.2809e4 / 0.486e3 * t154 * t378 - 0.2093e4 / 0.3888e4 * t106 * t707 * t220 + 0.121e3 / 0.2916e4 * t106 * t698 * t390 - 0.5e1 / 0.729e3 * t631 * t230 * t412 * t613 - 0.15e2 / 0.4e1 * t64 * t50 * t360 * t70 + 0.6995e4 / 0.7776e4 * t64 * t707 * t129 - 0.3545e4 / 0.23328e5 * t64 * t698 * t241 + 0.85e2 / 0.1296e4 * t469 * t413 - 0.5e1 / 0.5832e4 * t405 * t406 / t31 / t384 / t53 * t661;
  t742 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t338 * t170 + t6 * t179 * t292 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t80 * t476 - 0.3e1 / 0.8e1 * t6 * t19 * t737);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t742 + 0.6e1 * t481;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t756 = t216 * t125;
  t762 = t65 * t233;
  t803 = -0.19e2 / 0.81e2 * t300 * t196 + 0.167e3 / 0.324e3 * t438 * t490 - 0.25e2 / 0.864e3 * t199 * t756 * t369 * t50 * t128 + t199 * t762 * t615 / 0.972e3 + 0.19e2 / 0.81e2 * t49 * t195 * t57 - 0.205e3 / 0.162e3 * t106 * t201 * t502 + 0.49e2 / 0.324e3 * t106 * t756 * t203 * t50 * t128 - 0.107e3 / 0.7776e4 * t106 * t762 * t390 + 0.5e1 / 0.1944e4 * t631 * t118 * t472 * t613 + 0.3e1 / 0.4e1 * t64 * sigma[0] * t201 * t70 - 0.199e3 / 0.864e3 * t64 * t50 * t216 * t129 + 0.713e3 / 0.15552e5 * t64 * t762 * t241 - 0.695e3 / 0.31104e5 * t522 * t473 + 0.5e1 / 0.15552e5 * t405 * t230 / t31 / t633 * t661;
  t808 = my_piecewise3(t2, 0, t6 * t179 * t331 / 0.12e2 - t6 * t80 * t529 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t803);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t808 + 0.4e1 * t534;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t816 = t121 * t125;
  t818 = t369 * t20;
  t820 = t25 * sigma[0] * t28;
  t824 = t50 * t287;
  t831 = t203 * t20;
  t859 = -t199 * t266 / 0.12e2 + 0.7e1 / 0.864e3 * t199 * t816 * t818 * t820 - t199 * t824 * t615 / 0.2592e4 + t106 * t111 / 0.6e1 - 0.5e1 / 0.144e3 * t106 * t816 * t831 * t820 + 0.11e2 / 0.2592e4 * t106 * t824 * t390 - 0.5e1 / 0.5184e4 * t631 * t65 * t525 * t613 - t64 * t110 / 0.12e2 + 0.13e2 / 0.288e3 * t64 * t816 * t34 * t820 - 0.7e1 / 0.576e3 * t64 * t824 * t241 + 0.25e2 / 0.3456e4 * t560 * t526 - 0.5e1 / 0.41472e5 * t405 * t118 / t31 / t408 * t661;
  t864 = my_piecewise3(t2, 0, -t6 * t80 * t566 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t859);
  tv4rhosigma30 = 0.2e1 * rho[0] * t864 + 0.2e1 * t570;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t867 = t165 * t125;
  t869 = t25 * t28;
  t873 = sigma[0] * t326;
  t908 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (-t199 * t867 * t818 * t869 / 0.576e3 + t199 * t873 * t615 / 0.6912e4 + t106 * t867 * t831 * t869 / 0.192e3 - t106 * t873 * t390 / 0.864e3 + 0.5e1 / 0.13824e5 * t631 * t50 * t562 * t613 - t64 * t867 * t34 * t869 / 0.192e3 + t64 * t873 * t241 / 0.384e3 - 0.5e1 / 0.2304e4 * t405 * t50 * t563 + 0.5e1 / 0.110592e6 * t405 * t65 / t31 / t470 * t661));
  tv4sigma40 = 0.2e1 * rho[0] * t908;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif

