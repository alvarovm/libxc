/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_2d_b86_mgc.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t32, t36;
  double tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t25 = 0.1e1 + 0.16646e-1 * t23;
  t26 = POW_1_4(t25);
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = 0.1e1 / t28;
  t32 = 0.1e1 + 0.4409422067590197497e-2 * t23 * t29;
  t36 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t32);
  tzk0 = 0.2e1 * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t32, t36;
  double tzk0;

  double t38, t42, t43, t47, t48, t49, t52, t55;
  double t60, tvrho0, t65, t66, t67, t70, t74, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t25 = 0.1e1 + 0.16646e-1 * t23;
  t26 = POW_1_4(t25);
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = 0.1e1 / t28;
  t32 = 0.1e1 + 0.4409422067590197497e-2 * t23 * t29;
  t36 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t32);
  tzk0 = 0.2e1 * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t17 / t18;
  t42 = t20 * t20;
  t43 = 0.1e1 / t42;
  t47 = sigma[0] * sigma[0];
  t48 = t42 * t21;
  t49 = 0.1e1 / t48;
  t52 = 0.1e1 / t28 / t25;
  t55 = -0.13228266202770592491e-1 * sigma[0] * t43 * t29 + 0.16514828940848946195e-3 * t47 * t49 * t52;
  t60 = my_piecewise3(t2, 0, -t16 * t38 * t32 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t55);
  tvrho0 = 0.2e1 * rho[0] * t60 + 0.2e1 * t36;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t65 = t42 * t20;
  t66 = 0.1e1 / t65;
  t67 = sigma[0] * t66;
  t70 = 0.4409422067590197497e-2 * t22 * t29 - 0.55049429802829820651e-4 * t67 * t52;
  t74 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t70);
  tvsigma0 = 0.2e1 * rho[0] * t74;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t32, t36;
  double tzk0;

  double t38, t42, t43, t47, t48, t49, t52, t55;
  double t60, tvrho0, t65, t66, t67, t70, t74, tvsigma0;

  double t79, t86, t87, t91, t92, t96, t98, t100;
  double t102, t105, t110, tv2rho20, t118, t122, t123, t126;
  double t131, tv2rhosigma0, t137, t141, t145, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t25 = 0.1e1 + 0.16646e-1 * t23;
  t26 = POW_1_4(t25);
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = 0.1e1 / t28;
  t32 = 0.1e1 + 0.4409422067590197497e-2 * t23 * t29;
  t36 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t32);
  tzk0 = 0.2e1 * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t17 / t18;
  t42 = t20 * t20;
  t43 = 0.1e1 / t42;
  t47 = sigma[0] * sigma[0];
  t48 = t42 * t21;
  t49 = 0.1e1 / t48;
  t52 = 0.1e1 / t28 / t25;
  t55 = -0.13228266202770592491e-1 * sigma[0] * t43 * t29 + 0.16514828940848946195e-3 * t47 * t49 * t52;
  t60 = my_piecewise3(t2, 0, -t16 * t38 * t32 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t55);
  tvrho0 = 0.2e1 * rho[0] * t60 + 0.2e1 * t36;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t65 = t42 * t20;
  t66 = 0.1e1 / t65;
  t67 = sigma[0] * t66;
  t70 = 0.4409422067590197497e-2 * t22 * t29 - 0.55049429802829820651e-4 * t67 * t52;
  t74 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t70);
  tvsigma0 = 0.2e1 * rho[0] * t74;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t79 = t17 / t18 / rho[0];
  t86 = t42 * rho[0];
  t87 = 0.1e1 / t86;
  t91 = t42 * t42;
  t92 = 0.1e1 / t91;
  t96 = t47 * sigma[0];
  t98 = 0.1e1 / t91 / t21;
  t100 = t25 * t25;
  t102 = 0.1e1 / t28 / t100;
  t105 = 0.52913064811082369964e-1 * sigma[0] * t87 * t29 - 0.16514828940848946195e-2 * t47 * t92 * t52 + 0.14432556733842006814e-4 * t96 * t98 * t102;
  t110 = my_piecewise3(t2, 0, t16 * t79 * t32 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t55 - 0.2e1 / 0.3e1 * t16 * t19 * t105);
  tv2rho20 = 0.2e1 * rho[0] * t110 + 0.4e1 * t60;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t118 = t49 * t52;
  t122 = 0.1e1 / t91 / t20;
  t123 = t47 * t122;
  t126 = -0.13228266202770592491e-1 * t43 * t29 + 0.49544486822546838586e-3 * t118 * sigma[0] - 0.48108522446140022714e-5 * t123 * t102;
  t131 = my_piecewise3(t2, 0, -t16 * t38 * t70 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t126);
  tv2rhosigma0 = 0.2e1 * rho[0] * t131 + 0.2e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t137 = 0.1e1 / t91 / rho[0];
  t141 = -0.1100988596056596413e-3 * t66 * t52 + 0.16036174148713340905e-5 * sigma[0] * t137 * t102;
  t145 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t141);
  tv2sigma20 = 0.2e1 * rho[0] * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t32, t36;
  double tzk0;

  double t38, t42, t43, t47, t48, t49, t52, t55;
  double t60, tvrho0, t65, t66, t67, t70, t74, tvsigma0;

  double t79, t86, t87, t91, t92, t96, t98, t100;
  double t102, t105, t110, tv2rho20, t118, t122, t123, t126;
  double t131, tv2rhosigma0, t137, t141, t145, tv2sigma20;

  double t150, t165, t169, t171, t175, t178, t183, tv3rho30;
  double t195, t198, t202, t206, t211, tv3rho2sigma0, t218, t222;
  double t226, t231, tv3rhosigma20, t239, t243, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t25 = 0.1e1 + 0.16646e-1 * t23;
  t26 = POW_1_4(t25);
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = 0.1e1 / t28;
  t32 = 0.1e1 + 0.4409422067590197497e-2 * t23 * t29;
  t36 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t32);
  tzk0 = 0.2e1 * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t17 / t18;
  t42 = t20 * t20;
  t43 = 0.1e1 / t42;
  t47 = sigma[0] * sigma[0];
  t48 = t42 * t21;
  t49 = 0.1e1 / t48;
  t52 = 0.1e1 / t28 / t25;
  t55 = -0.13228266202770592491e-1 * sigma[0] * t43 * t29 + 0.16514828940848946195e-3 * t47 * t49 * t52;
  t60 = my_piecewise3(t2, 0, -t16 * t38 * t32 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t55);
  tvrho0 = 0.2e1 * rho[0] * t60 + 0.2e1 * t36;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t65 = t42 * t20;
  t66 = 0.1e1 / t65;
  t67 = sigma[0] * t66;
  t70 = 0.4409422067590197497e-2 * t22 * t29 - 0.55049429802829820651e-4 * t67 * t52;
  t74 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t70);
  tvsigma0 = 0.2e1 * rho[0] * t74;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t79 = t17 / t18 / rho[0];
  t86 = t42 * rho[0];
  t87 = 0.1e1 / t86;
  t91 = t42 * t42;
  t92 = 0.1e1 / t91;
  t96 = t47 * sigma[0];
  t98 = 0.1e1 / t91 / t21;
  t100 = t25 * t25;
  t102 = 0.1e1 / t28 / t100;
  t105 = 0.52913064811082369964e-1 * sigma[0] * t87 * t29 - 0.16514828940848946195e-2 * t47 * t92 * t52 + 0.14432556733842006814e-4 * t96 * t98 * t102;
  t110 = my_piecewise3(t2, 0, t16 * t79 * t32 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t55 - 0.2e1 / 0.3e1 * t16 * t19 * t105);
  tv2rho20 = 0.2e1 * rho[0] * t110 + 0.4e1 * t60;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t118 = t49 * t52;
  t122 = 0.1e1 / t91 / t20;
  t123 = t47 * t122;
  t126 = -0.13228266202770592491e-1 * t43 * t29 + 0.49544486822546838586e-3 * t118 * sigma[0] - 0.48108522446140022714e-5 * t123 * t102;
  t131 = my_piecewise3(t2, 0, -t16 * t38 * t70 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t126);
  tv2rhosigma0 = 0.2e1 * rho[0] * t131 + 0.2e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t137 = 0.1e1 / t91 / rho[0];
  t141 = -0.1100988596056596413e-3 * t66 * t52 + 0.16036174148713340905e-5 * sigma[0] * t137 * t102;
  t145 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t141);
  tv2sigma20 = 0.2e1 * rho[0] * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t150 = t17 / t18 / t20;
  t165 = 0.1e1 / t91 / t42;
  t169 = t47 * t47;
  t171 = 0.1e1 / t91 / t48;
  t175 = 0.1e1 / t28 / t100 / t25;
  t178 = -0.26456532405541184982e0 * t67 * t29 + 0.15193642625581030499e-1 * t47 * t137 * t52 - 0.30308369141068214309e-3 * t96 * t165 * t102 + 0.19820157999801558748e-5 * t169 * t171 * t175;
  t183 = my_piecewise3(t2, 0, -t16 * t150 * t32 / 0.4e1 + t16 * t79 * t55 / 0.2e1 - t16 * t38 * t105 - 0.2e1 / 0.3e1 * t16 * t19 * t178);
  tv3rho30 = 0.2e1 * rho[0] * t183 + 0.6e1 * t110;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t195 = t92 * t52;
  t198 = t98 * t102;
  t202 = 0.1e1 / t91 / t65;
  t206 = 0.52913064811082369964e-1 * t87 * t29 - 0.39635589458037470869e-2 * t195 * sigma[0] + 0.91406192647666043157e-4 * t198 * t47 - 0.66067193332671862493e-6 * t96 * t202 * t175;
  t211 = my_piecewise3(t2, 0, t16 * t79 * t70 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t126 - 0.2e1 / 0.3e1 * t16 * t19 * t206);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t211 + 0.4e1 * t131;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t218 = t122 * t102;
  t222 = 0.1e1 / t91 / t86;
  t226 = 0.6605931576339578478e-3 * t118 - 0.24054261223070011357e-4 * t218 * sigma[0] + 0.22022397777557287498e-6 * t47 * t222 * t175;
  t231 = my_piecewise3(t2, 0, -t16 * t38 * t141 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t226);
  tv3rhosigma20 = 0.2e1 * rho[0] * t231 + 0.2e1 * t145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t239 = 0.48108522446140022714e-5 * t137 * t102 - 0.73407992591857624994e-7 * sigma[0] * t165 * t175;
  t243 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t239);
  tv3sigma30 = 0.2e1 * rho[0] * t243;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t29, t32, t36;
  double tzk0;

  double t38, t42, t43, t47, t48, t49, t52, t55;
  double t60, tvrho0, t65, t66, t67, t70, t74, tvsigma0;

  double t79, t86, t87, t91, t92, t96, t98, t100;
  double t102, t105, t110, tv2rho20, t118, t122, t123, t126;
  double t131, tv2rhosigma0, t137, t141, t145, tv2sigma20;

  double t150, t165, t169, t171, t175, t178, t183, tv3rho30;
  double t195, t198, t202, t206, t211, tv3rho2sigma0, t218, t222;
  double t226, t231, tv3rhosigma20, t239, t243, tv3sigma30;

  double t267, t268, t276, t278, t286, tv4rho40, t319, tv4rho3sigma0;
  double t345, tv4rho2sigma20, t363, tv4rhosigma30, t375, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t19 = t17 * t18;
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t22 = 0.1e1 / t21;
  t23 = sigma[0] * t22;
  t25 = 0.1e1 + 0.16646e-1 * t23;
  t26 = POW_1_4(t25);
  t27 = t26 * t26;
  t28 = t27 * t26;
  t29 = 0.1e1 / t28;
  t32 = 0.1e1 + 0.4409422067590197497e-2 * t23 * t29;
  t36 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t32);
  tzk0 = 0.2e1 * t36;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t17 / t18;
  t42 = t20 * t20;
  t43 = 0.1e1 / t42;
  t47 = sigma[0] * sigma[0];
  t48 = t42 * t21;
  t49 = 0.1e1 / t48;
  t52 = 0.1e1 / t28 / t25;
  t55 = -0.13228266202770592491e-1 * sigma[0] * t43 * t29 + 0.16514828940848946195e-3 * t47 * t49 * t52;
  t60 = my_piecewise3(t2, 0, -t16 * t38 * t32 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t55);
  tvrho0 = 0.2e1 * rho[0] * t60 + 0.2e1 * t36;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t65 = t42 * t20;
  t66 = 0.1e1 / t65;
  t67 = sigma[0] * t66;
  t70 = 0.4409422067590197497e-2 * t22 * t29 - 0.55049429802829820651e-4 * t67 * t52;
  t74 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t70);
  tvsigma0 = 0.2e1 * rho[0] * t74;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t79 = t17 / t18 / rho[0];
  t86 = t42 * rho[0];
  t87 = 0.1e1 / t86;
  t91 = t42 * t42;
  t92 = 0.1e1 / t91;
  t96 = t47 * sigma[0];
  t98 = 0.1e1 / t91 / t21;
  t100 = t25 * t25;
  t102 = 0.1e1 / t28 / t100;
  t105 = 0.52913064811082369964e-1 * sigma[0] * t87 * t29 - 0.16514828940848946195e-2 * t47 * t92 * t52 + 0.14432556733842006814e-4 * t96 * t98 * t102;
  t110 = my_piecewise3(t2, 0, t16 * t79 * t32 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t55 - 0.2e1 / 0.3e1 * t16 * t19 * t105);
  tv2rho20 = 0.2e1 * rho[0] * t110 + 0.4e1 * t60;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t118 = t49 * t52;
  t122 = 0.1e1 / t91 / t20;
  t123 = t47 * t122;
  t126 = -0.13228266202770592491e-1 * t43 * t29 + 0.49544486822546838586e-3 * t118 * sigma[0] - 0.48108522446140022714e-5 * t123 * t102;
  t131 = my_piecewise3(t2, 0, -t16 * t38 * t70 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t126);
  tv2rhosigma0 = 0.2e1 * rho[0] * t131 + 0.2e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t137 = 0.1e1 / t91 / rho[0];
  t141 = -0.1100988596056596413e-3 * t66 * t52 + 0.16036174148713340905e-5 * sigma[0] * t137 * t102;
  t145 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t141);
  tv2sigma20 = 0.2e1 * rho[0] * t145;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t150 = t17 / t18 / t20;
  t165 = 0.1e1 / t91 / t42;
  t169 = t47 * t47;
  t171 = 0.1e1 / t91 / t48;
  t175 = 0.1e1 / t28 / t100 / t25;
  t178 = -0.26456532405541184982e0 * t67 * t29 + 0.15193642625581030499e-1 * t47 * t137 * t52 - 0.30308369141068214309e-3 * t96 * t165 * t102 + 0.19820157999801558748e-5 * t169 * t171 * t175;
  t183 = my_piecewise3(t2, 0, -t16 * t150 * t32 / 0.4e1 + t16 * t79 * t55 / 0.2e1 - t16 * t38 * t105 - 0.2e1 / 0.3e1 * t16 * t19 * t178);
  tv3rho30 = 0.2e1 * rho[0] * t183 + 0.6e1 * t110;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t195 = t92 * t52;
  t198 = t98 * t102;
  t202 = 0.1e1 / t91 / t65;
  t206 = 0.52913064811082369964e-1 * t87 * t29 - 0.39635589458037470869e-2 * t195 * sigma[0] + 0.91406192647666043157e-4 * t198 * t47 - 0.66067193332671862493e-6 * t96 * t202 * t175;
  t211 = my_piecewise3(t2, 0, t16 * t79 * t70 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t126 - 0.2e1 / 0.3e1 * t16 * t19 * t206);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t211 + 0.4e1 * t131;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t218 = t122 * t102;
  t222 = 0.1e1 / t91 / t86;
  t226 = 0.6605931576339578478e-3 * t118 - 0.24054261223070011357e-4 * t218 * sigma[0] + 0.22022397777557287498e-6 * t47 * t222 * t175;
  t231 = my_piecewise3(t2, 0, -t16 * t38 * t141 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * t226);
  tv3rhosigma20 = 0.2e1 * rho[0] * t231 + 0.2e1 * t145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t239 = 0.48108522446140022714e-5 * t137 * t102 - 0.73407992591857624994e-7 * sigma[0] * t165 * t175;
  t243 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * t239);
  tv3sigma30 = 0.2e1 * rho[0] * t243;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t267 = t91 * t91;
  t268 = 0.1e1 / t267;
  t276 = t100 * t100;
  t278 = 0.1e1 / t28 / t276;
  t286 = my_piecewise3(t2, 0, 0.5e1 / 0.8e1 * t16 * t17 / t18 / t21 * t32 - t16 * t150 * t55 + t16 * t79 * t105 - 0.4e1 / 0.3e1 * t16 * t38 * t178 - 0.2e1 / 0.3e1 * t16 * t19 * (0.15873919443324710989e1 * sigma[0] * t49 * t29 - 0.14665168099473864221e0 * t123 * t52 + 0.4964799516441650344e-2 * t96 * t222 * t102 - 0.71352568799285611491e-4 * t169 * t268 * t175 + 0.37116714382278384028e-6 * t169 * sigma[0] / t267 / t21 * t278));
  tv4rho40 = 0.2e1 * rho[0] * t286 + 0.8e1 * t183;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t319 = my_piecewise3(t2, 0, -t16 * t150 * t70 / 0.4e1 + t16 * t79 * t126 / 0.2e1 - t16 * t38 * t206 - 0.2e1 / 0.3e1 * t16 * t19 * (-0.26456532405541184982e0 * t66 * t29 + 0.33690251039331850238e-1 * t137 * t52 * sigma[0] - 0.13518494807365346382e-2 * t165 * t102 * t47 + 0.21802173799781714623e-4 * t171 * t175 * t96 - 0.12372238127426128009e-6 * t169 / t267 / t20 * t278));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t319 + 0.6e1 * t211;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t345 = my_piecewise3(t2, 0, t16 * t79 * t141 / 0.6e1 - 0.2e1 / 0.3e1 * t16 * t38 * t226 - 0.2e1 / 0.3e1 * t16 * t19 * (-0.46241521034377049346e-2 * t195 + 0.29827283916606814083e-3 * t198 * sigma[0] - 0.61662713777160404994e-5 * t202 * t175 * t47 + 0.41240793758087093365e-7 * t96 / t267 / rho[0] * t278));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t345 + 0.4e1 * t231;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t363 = my_piecewise3(t2, 0, -t16 * t38 * t239 / 0.3e1 - 0.2e1 / 0.3e1 * t16 * t19 * (-0.43297670201526020443e-4 * t218 + 0.15415678444290101249e-5 * t222 * t175 * sigma[0] - 0.13746931252695697789e-7 * t47 * t268 * t278));
  tv4rhosigma30 = 0.2e1 * rho[0] * t363 + 0.2e1 * t243;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t375 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t19 * (-0.29363197036743049997e-6 * t165 * t175 + 0.45823104175652325962e-8 * sigma[0] * t171 * t278));
  tv4sigma40 = 0.2e1 * rho[0] * t375;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t33, t34, t35, t36, t37;
  double t40, t41, t44, t45, t46, t47, t48, t49;
  double t50, t51, t52, t53, t54, t55, t56, t58;
  double t59, t60, t61, t62, t65, t66, t69, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t33 = 0.1e1 + 0.8323e-2 * t31;
  t34 = POW_1_4(t33);
  t35 = t34 * t34;
  t36 = t35 * t34;
  t37 = 0.1e1 / t36;
  t40 = 0.1e1 + 0.22047110337950987485e-2 * t31 * t37;
  t41 = t27 * t40;
  t44 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t41);
  t45 = rho[1] <= p->dens_threshold;
  t46 = my_piecewise5(t12, t9, t8, t13, -t15);
  t47 = 0.1e1 + t46;
  t48 = t47 <= p->zeta_threshold;
  t49 = sqrt(t47);
  t50 = t49 * t47;
  t51 = my_piecewise3(t48, t20, t50);
  t52 = t3 * t51;
  t53 = rho[1] * rho[1];
  t54 = t53 * rho[1];
  t55 = 0.1e1 / t54;
  t56 = sigma[2] * t55;
  t58 = 0.1e1 + 0.8323e-2 * t56;
  t59 = POW_1_4(t58);
  t60 = t59 * t59;
  t61 = t60 * t59;
  t62 = 0.1e1 / t61;
  t65 = 0.1e1 + 0.22047110337950987485e-2 * t56 * t62;
  t66 = t27 * t65;
  t69 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t66);
  tzk0 = t44 + t69;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t33, t34, t35, t36, t37;
  double t40, t41, t44, t45, t46, t47, t48, t49;
  double t50, t51, t52, t53, t54, t55, t56, t58;
  double t59, t60, t61, t62, t65, t66, t69, tzk0;

  double t70, t71, t72, t73, t74, t77, t78, t82;
  double t83, t85, t86, t87, t91, t92, t93, t96;
  double t99, t100, t104, t106, t109, t110, t113, t115;
  double t117, tvrho0, t120, t121, t124, t125, t129, t131;
  double t134, t135, t138, t139, t143, t144, t145, t148;
  double t151, t152, t156, tvrho1, t161, t162, t163, t166;
  double t167, t170, tvsigma0, tvsigma1, t173, t174, t175, t178;
  double t179, t182, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t33 = 0.1e1 + 0.8323e-2 * t31;
  t34 = POW_1_4(t33);
  t35 = t34 * t34;
  t36 = t35 * t34;
  t37 = 0.1e1 / t36;
  t40 = 0.1e1 + 0.22047110337950987485e-2 * t31 * t37;
  t41 = t27 * t40;
  t44 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t41);
  t45 = rho[1] <= p->dens_threshold;
  t46 = my_piecewise5(t12, t9, t8, t13, -t15);
  t47 = 0.1e1 + t46;
  t48 = t47 <= p->zeta_threshold;
  t49 = sqrt(t47);
  t50 = t49 * t47;
  t51 = my_piecewise3(t48, t20, t50);
  t52 = t3 * t51;
  t53 = rho[1] * rho[1];
  t54 = t53 * rho[1];
  t55 = 0.1e1 / t54;
  t56 = sigma[2] * t55;
  t58 = 0.1e1 + 0.8323e-2 * t56;
  t59 = POW_1_4(t58);
  t60 = t59 * t59;
  t61 = t60 * t59;
  t62 = 0.1e1 / t61;
  t65 = 0.1e1 + 0.22047110337950987485e-2 * t56 * t62;
  t66 = t27 * t65;
  t69 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t66);
  tzk0 = t44 + t69;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t70 = t4 * t4;
  t71 = 0.1e1 / t70;
  t72 = t14 * t71;
  t73 = t5 - t72;
  t74 = my_piecewise5(t8, 0, t12, 0, t73);
  t77 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t74);
  t78 = t3 * t77;
  t82 = t25 / t26;
  t83 = t82 * t40;
  t85 = t24 * t83 / 0.3e1;
  t86 = t28 * t28;
  t87 = 0.1e1 / t86;
  t91 = sigma[0] * sigma[0];
  t92 = t86 * t29;
  t93 = 0.1e1 / t92;
  t96 = 0.1e1 / t36 / t33;
  t99 = -0.66141331013852962455e-2 * sigma[0] * t87 * t37 + 0.41287072352122365488e-4 * t91 * t93 * t96;
  t100 = t27 * t99;
  t104 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t78 * t41 - t85 - 0.2e1 / 0.3e1 * t24 * t100);
  t106 = my_piecewise5(t12, 0, t8, 0, -t73);
  t109 = my_piecewise3(t48, 0, 0.3e1 / 0.2e1 * t49 * t106);
  t110 = t3 * t109;
  t113 = t82 * t65;
  t115 = t52 * t113 / 0.3e1;
  t117 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t110 * t66 - t115);
  tvrho0 = t44 + t69 + t4 * (t104 + t117);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t120 = -t5 - t72;
  t121 = my_piecewise5(t8, 0, t12, 0, t120);
  t124 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t121);
  t125 = t3 * t124;
  t129 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t125 * t41 - t85);
  t131 = my_piecewise5(t12, 0, t8, 0, -t120);
  t134 = my_piecewise3(t48, 0, 0.3e1 / 0.2e1 * t49 * t131);
  t135 = t3 * t134;
  t138 = t53 * t53;
  t139 = 0.1e1 / t138;
  t143 = sigma[2] * sigma[2];
  t144 = t138 * t54;
  t145 = 0.1e1 / t144;
  t148 = 0.1e1 / t61 / t58;
  t151 = -0.66141331013852962455e-2 * sigma[2] * t139 * t62 + 0.41287072352122365488e-4 * t143 * t145 * t148;
  t152 = t27 * t151;
  t156 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t135 * t66 - t115 - 0.2e1 / 0.3e1 * t52 * t152);
  tvrho1 = t44 + t69 + t4 * (t129 + t156);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t161 = t86 * t28;
  t162 = 0.1e1 / t161;
  t163 = sigma[0] * t162;
  t166 = 0.22047110337950987485e-2 * t30 * t37 - 0.13762357450707455163e-4 * t163 * t96;
  t167 = t27 * t166;
  t170 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t167);
  tvsigma0 = t4 * t170;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t173 = t138 * t53;
  t174 = 0.1e1 / t173;
  t175 = sigma[2] * t174;
  t178 = 0.22047110337950987485e-2 * t55 * t62 - 0.13762357450707455163e-4 * t175 * t148;
  t179 = t27 * t178;
  t182 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t179);
  tvsigma2 = t4 * t182;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t33, t34, t35, t36, t37;
  double t40, t41, t44, t45, t46, t47, t48, t49;
  double t50, t51, t52, t53, t54, t55, t56, t58;
  double t59, t60, t61, t62, t65, t66, t69, tzk0;

  double t70, t71, t72, t73, t74, t77, t78, t82;
  double t83, t85, t86, t87, t91, t92, t93, t96;
  double t99, t100, t104, t106, t109, t110, t113, t115;
  double t117, tvrho0, t120, t121, t124, t125, t129, t131;
  double t134, t135, t138, t139, t143, t144, t145, t148;
  double t151, t152, t156, tvrho1, t161, t162, t163, t166;
  double t167, t170, tvsigma0, tvsigma1, t173, t174, t175, t178;
  double t179, t182, tvsigma2;

  double t185, t186, t189, t190, t191, t193, t194, t198;
  double t199, t202, t208, t209, t211, t212, t213, t215;
  double t216, t220, t221, t225, t227, t229, t231, t234;
  double t235, t239, t240, t241, t245, t249, t250, t253;
  double t255, t257, t259, tv2rho20, t262, t265, t266, t270;
  double t271, t274, t281, t282, t285, t289, t290, t293;
  double t298, t299, t302, tv2rho21, t307, t311, t312, t316;
  double t317, t322, t323, t327, t331, t332, t339, t340;
  double t344, t345, t349, t351, t353, t355, t358, t359;
  double t363, tv2rho22, t368, t370, t373, t377, t378, t381;
  double t382, t386, tv2rhosigma0, tv2rhosigma1, t390, t392, t394, tv2rhosigma2;
  double t399, tv2rhosigma3, tv2rhosigma4, t405, t409, t410, t413, t414;
  double t418, tv2rhosigma5, t423, t427, t428, t431, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t435, t439, t440, t443, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t33 = 0.1e1 + 0.8323e-2 * t31;
  t34 = POW_1_4(t33);
  t35 = t34 * t34;
  t36 = t35 * t34;
  t37 = 0.1e1 / t36;
  t40 = 0.1e1 + 0.22047110337950987485e-2 * t31 * t37;
  t41 = t27 * t40;
  t44 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t41);
  t45 = rho[1] <= p->dens_threshold;
  t46 = my_piecewise5(t12, t9, t8, t13, -t15);
  t47 = 0.1e1 + t46;
  t48 = t47 <= p->zeta_threshold;
  t49 = sqrt(t47);
  t50 = t49 * t47;
  t51 = my_piecewise3(t48, t20, t50);
  t52 = t3 * t51;
  t53 = rho[1] * rho[1];
  t54 = t53 * rho[1];
  t55 = 0.1e1 / t54;
  t56 = sigma[2] * t55;
  t58 = 0.1e1 + 0.8323e-2 * t56;
  t59 = POW_1_4(t58);
  t60 = t59 * t59;
  t61 = t60 * t59;
  t62 = 0.1e1 / t61;
  t65 = 0.1e1 + 0.22047110337950987485e-2 * t56 * t62;
  t66 = t27 * t65;
  t69 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t66);
  tzk0 = t44 + t69;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t70 = t4 * t4;
  t71 = 0.1e1 / t70;
  t72 = t14 * t71;
  t73 = t5 - t72;
  t74 = my_piecewise5(t8, 0, t12, 0, t73);
  t77 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t74);
  t78 = t3 * t77;
  t82 = t25 / t26;
  t83 = t82 * t40;
  t85 = t24 * t83 / 0.3e1;
  t86 = t28 * t28;
  t87 = 0.1e1 / t86;
  t91 = sigma[0] * sigma[0];
  t92 = t86 * t29;
  t93 = 0.1e1 / t92;
  t96 = 0.1e1 / t36 / t33;
  t99 = -0.66141331013852962455e-2 * sigma[0] * t87 * t37 + 0.41287072352122365488e-4 * t91 * t93 * t96;
  t100 = t27 * t99;
  t104 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t78 * t41 - t85 - 0.2e1 / 0.3e1 * t24 * t100);
  t106 = my_piecewise5(t12, 0, t8, 0, -t73);
  t109 = my_piecewise3(t48, 0, 0.3e1 / 0.2e1 * t49 * t106);
  t110 = t3 * t109;
  t113 = t82 * t65;
  t115 = t52 * t113 / 0.3e1;
  t117 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t110 * t66 - t115);
  tvrho0 = t44 + t69 + t4 * (t104 + t117);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t120 = -t5 - t72;
  t121 = my_piecewise5(t8, 0, t12, 0, t120);
  t124 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t121);
  t125 = t3 * t124;
  t129 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t125 * t41 - t85);
  t131 = my_piecewise5(t12, 0, t8, 0, -t120);
  t134 = my_piecewise3(t48, 0, 0.3e1 / 0.2e1 * t49 * t131);
  t135 = t3 * t134;
  t138 = t53 * t53;
  t139 = 0.1e1 / t138;
  t143 = sigma[2] * sigma[2];
  t144 = t138 * t54;
  t145 = 0.1e1 / t144;
  t148 = 0.1e1 / t61 / t58;
  t151 = -0.66141331013852962455e-2 * sigma[2] * t139 * t62 + 0.41287072352122365488e-4 * t143 * t145 * t148;
  t152 = t27 * t151;
  t156 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t135 * t66 - t115 - 0.2e1 / 0.3e1 * t52 * t152);
  tvrho1 = t44 + t69 + t4 * (t129 + t156);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t161 = t86 * t28;
  t162 = 0.1e1 / t161;
  t163 = sigma[0] * t162;
  t166 = 0.22047110337950987485e-2 * t30 * t37 - 0.13762357450707455163e-4 * t163 * t96;
  t167 = t27 * t166;
  t170 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t167);
  tvsigma0 = t4 * t170;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t173 = t138 * t53;
  t174 = 0.1e1 / t173;
  t175 = sigma[2] * t174;
  t178 = 0.22047110337950987485e-2 * t55 * t62 - 0.13762357450707455163e-4 * t175 * t148;
  t179 = t27 * t178;
  t182 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t179);
  tvsigma2 = t4 * t182;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t185 = 0.1e1 / t21;
  t186 = t74 * t74;
  t189 = t70 * t4;
  t190 = 0.1e1 / t189;
  t191 = t14 * t190;
  t193 = -0.2e1 * t71 + 0.2e1 * t191;
  t194 = my_piecewise5(t8, 0, t12, 0, t193);
  t198 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t185 * t186 + 0.3e1 / 0.2e1 * t21 * t194);
  t199 = t3 * t198;
  t202 = t78 * t83;
  t208 = t25 / t26 / t4;
  t209 = t208 * t40;
  t211 = t24 * t209 / 0.6e1;
  t212 = t82 * t99;
  t213 = t24 * t212;
  t215 = t86 * rho[0];
  t216 = 0.1e1 / t215;
  t220 = t86 * t86;
  t221 = 0.1e1 / t220;
  t225 = t91 * sigma[0];
  t227 = 0.1e1 / t220 / t29;
  t229 = t33 * t33;
  t231 = 0.1e1 / t36 / t229;
  t234 = 0.26456532405541184982e-1 * sigma[0] * t216 * t37 - 0.41287072352122365489e-3 * t91 * t221 * t96 + 0.18040695917302508518e-5 * t225 * t227 * t231;
  t235 = t27 * t234;
  t239 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t199 * t41 - 0.2e1 / 0.3e1 * t202 - 0.4e1 / 0.3e1 * t78 * t100 + t211 - 0.2e1 / 0.3e1 * t213 - 0.2e1 / 0.3e1 * t24 * t235);
  t240 = 0.1e1 / t49;
  t241 = t106 * t106;
  t245 = my_piecewise5(t12, 0, t8, 0, -t193);
  t249 = my_piecewise3(t48, 0, 0.3e1 / 0.4e1 * t240 * t241 + 0.3e1 / 0.2e1 * t49 * t245);
  t250 = t3 * t249;
  t253 = t110 * t113;
  t255 = t208 * t65;
  t257 = t52 * t255 / 0.6e1;
  t259 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t250 * t66 - 0.2e1 / 0.3e1 * t253 + t257);
  tv2rho20 = 0.2e1 * t104 + 0.2e1 * t117 + t4 * (t239 + t259);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t262 = t185 * t121;
  t265 = 0.2e1 * t191;
  t266 = my_piecewise5(t8, 0, t12, 0, t265);
  t270 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t262 * t74 + 0.3e1 / 0.2e1 * t21 * t266);
  t271 = t3 * t270;
  t274 = t125 * t83;
  t281 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t271 * t41 - t274 / 0.3e1 - 0.2e1 / 0.3e1 * t125 * t100 - t202 / 0.3e1 + t211 - t213 / 0.3e1);
  t282 = t240 * t131;
  t285 = my_piecewise5(t12, 0, t8, 0, -t265);
  t289 = my_piecewise3(t48, 0, 0.3e1 / 0.4e1 * t282 * t106 + 0.3e1 / 0.2e1 * t49 * t285);
  t290 = t3 * t289;
  t293 = t135 * t113;
  t298 = t82 * t151;
  t299 = t52 * t298;
  t302 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t290 * t66 - t293 / 0.3e1 - t253 / 0.3e1 + t257 - 0.2e1 / 0.3e1 * t110 * t152 - t299 / 0.3e1);
  tv2rho21 = t104 + t117 + t129 + t156 + t4 * (t281 + t302);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t307 = t121 * t121;
  t311 = 0.2e1 * t71 + 0.2e1 * t191;
  t312 = my_piecewise5(t8, 0, t12, 0, t311);
  t316 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t185 * t307 + 0.3e1 / 0.2e1 * t21 * t312);
  t317 = t3 * t316;
  t322 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t317 * t41 - 0.2e1 / 0.3e1 * t274 + t211);
  t323 = t131 * t131;
  t327 = my_piecewise5(t12, 0, t8, 0, -t311);
  t331 = my_piecewise3(t48, 0, 0.3e1 / 0.4e1 * t240 * t323 + 0.3e1 / 0.2e1 * t49 * t327);
  t332 = t3 * t331;
  t339 = t138 * rho[1];
  t340 = 0.1e1 / t339;
  t344 = t138 * t138;
  t345 = 0.1e1 / t344;
  t349 = t143 * sigma[2];
  t351 = 0.1e1 / t344 / t54;
  t353 = t58 * t58;
  t355 = 0.1e1 / t61 / t353;
  t358 = 0.26456532405541184982e-1 * sigma[2] * t340 * t62 - 0.41287072352122365489e-3 * t143 * t345 * t148 + 0.18040695917302508518e-5 * t349 * t351 * t355;
  t359 = t27 * t358;
  t363 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t332 * t66 - 0.2e1 / 0.3e1 * t293 - 0.4e1 / 0.3e1 * t135 * t152 + t257 - 0.2e1 / 0.3e1 * t299 - 0.2e1 / 0.3e1 * t52 * t359);
  tv2rho22 = 0.2e1 * t129 + 0.2e1 * t156 + t4 * (t322 + t363);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t368 = t82 * t166;
  t370 = t24 * t368 / 0.3e1;
  t373 = t93 * t96;
  t377 = 0.1e1 / t220 / t28;
  t378 = t91 * t377;
  t381 = -0.66141331013852962455e-2 * t87 * t37 + 0.12386121705636709647e-3 * t373 * sigma[0] - 0.60135653057675028394e-6 * t378 * t231;
  t382 = t27 * t381;
  t386 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t78 * t167 - t370 - 0.2e1 / 0.3e1 * t24 * t382);
  tv2rhosigma0 = t386 * t4 + t170;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t390 = t82 * t178;
  t392 = t52 * t390 / 0.3e1;
  t394 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t110 * t179 - t392);
  tv2rhosigma2 = t394 * t4 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t399 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t125 * t167 - t370);
  tv2rhosigma3 = t399 * t4 + t170;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t405 = t145 * t148;
  t409 = 0.1e1 / t344 / t53;
  t410 = t143 * t409;
  t413 = -0.66141331013852962455e-2 * t139 * t62 + 0.12386121705636709647e-3 * t405 * sigma[2] - 0.60135653057675028394e-6 * t410 * t355;
  t414 = t27 * t413;
  t418 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t135 * t179 - t392 - 0.2e1 / 0.3e1 * t52 * t414);
  tv2rhosigma5 = t4 * t418 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t423 = 0.1e1 / t220 / rho[0];
  t427 = -0.27524714901414910326e-4 * t162 * t96 + 0.20045217685891676131e-6 * sigma[0] * t423 * t231;
  t428 = t27 * t427;
  t431 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t428);
  tv2sigma20 = t4 * t431;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t435 = 0.1e1 / t344 / rho[1];
  t439 = -0.27524714901414910326e-4 * t174 * t148 + 0.20045217685891676131e-6 * sigma[2] * t435 * t355;
  t440 = t27 * t439;
  t443 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t440);
  tv2sigma25 = t4 * t443;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t33, t34, t35, t36, t37;
  double t40, t41, t44, t45, t46, t47, t48, t49;
  double t50, t51, t52, t53, t54, t55, t56, t58;
  double t59, t60, t61, t62, t65, t66, t69, tzk0;

  double t70, t71, t72, t73, t74, t77, t78, t82;
  double t83, t85, t86, t87, t91, t92, t93, t96;
  double t99, t100, t104, t106, t109, t110, t113, t115;
  double t117, tvrho0, t120, t121, t124, t125, t129, t131;
  double t134, t135, t138, t139, t143, t144, t145, t148;
  double t151, t152, t156, tvrho1, t161, t162, t163, t166;
  double t167, t170, tvsigma0, tvsigma1, t173, t174, t175, t178;
  double t179, t182, tvsigma2;

  double t185, t186, t189, t190, t191, t193, t194, t198;
  double t199, t202, t208, t209, t211, t212, t213, t215;
  double t216, t220, t221, t225, t227, t229, t231, t234;
  double t235, t239, t240, t241, t245, t249, t250, t253;
  double t255, t257, t259, tv2rho20, t262, t265, t266, t270;
  double t271, t274, t281, t282, t285, t289, t290, t293;
  double t298, t299, t302, tv2rho21, t307, t311, t312, t316;
  double t317, t322, t323, t327, t331, t332, t339, t340;
  double t344, t345, t349, t351, t353, t355, t358, t359;
  double t363, tv2rho22, t368, t370, t373, t377, t378, t381;
  double t382, t386, tv2rhosigma0, tv2rhosigma1, t390, t392, t394, tv2rhosigma2;
  double t399, tv2rhosigma3, tv2rhosigma4, t405, t409, t410, t413, t414;
  double t418, tv2rhosigma5, t423, t427, t428, t431, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t435, t439, t440, t443, tv2sigma25;

  double t446, t447, t450, t453, t454, t455, t457, t458;
  double t462, t463, t466, t469, t471, t477, t478, t480;
  double t481, t482, t484, t485, t492, t496, t498, t502;
  double t505, t506, t510, t511, t512, t515, t519, t523;
  double t524, t527, t528, t530, t532, t534, tv3rho30, t537;
  double t538, t539, t542, t547, t548, t549, t550, t554;
  double t555, t559, t562, t565, t573, t574, t575, t578;
  double t584, t588, t589, t593, t594, t601, t602, t603;
  double t606, tv3rho31, t609, t614, t617, t618, t622, t623;
  double t626, t634, t635, t640, t644, t648, t649, t652;
  double t657, t663, t664, t666, t667, tv3rho32, t672, t678;
  double t679, t683, t684, t689, t690, t696, t700, t701;
  double t717, t721, t723, t727, t730, t731, t735, tv3rho33;
  double t741, t745, t747, t748, t749, t753, t756, t760;
  double t764, t765, t769, tv3rho2sigma0, tv3rho2sigma1, t774, t776, t778;
  double t780, tv3rho2sigma2, t784, t791, tv3rho2sigma3, tv3rho2sigma4, t795, t800;
  double t801, t804, tv3rho2sigma5, t811, tv3rho2sigma6, tv3rho2sigma7, t822, t825;
  double t829, t833, t834, t838, tv3rho2sigma8, t842, t844, t846;
  double t850, t854, t855, t859, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t863, t865, t867, tv3rhosigma25, t872, tv3rhosigma26, tv3rhosigma27;
  double tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t877, t881, t885, t886, t890;
  double tv3rhosigma211, t897, t898, t901, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t907, t908, t911;
  double tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t33 = 0.1e1 + 0.8323e-2 * t31;
  t34 = POW_1_4(t33);
  t35 = t34 * t34;
  t36 = t35 * t34;
  t37 = 0.1e1 / t36;
  t40 = 0.1e1 + 0.22047110337950987485e-2 * t31 * t37;
  t41 = t27 * t40;
  t44 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t41);
  t45 = rho[1] <= p->dens_threshold;
  t46 = my_piecewise5(t12, t9, t8, t13, -t15);
  t47 = 0.1e1 + t46;
  t48 = t47 <= p->zeta_threshold;
  t49 = sqrt(t47);
  t50 = t49 * t47;
  t51 = my_piecewise3(t48, t20, t50);
  t52 = t3 * t51;
  t53 = rho[1] * rho[1];
  t54 = t53 * rho[1];
  t55 = 0.1e1 / t54;
  t56 = sigma[2] * t55;
  t58 = 0.1e1 + 0.8323e-2 * t56;
  t59 = POW_1_4(t58);
  t60 = t59 * t59;
  t61 = t60 * t59;
  t62 = 0.1e1 / t61;
  t65 = 0.1e1 + 0.22047110337950987485e-2 * t56 * t62;
  t66 = t27 * t65;
  t69 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t66);
  tzk0 = t44 + t69;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t70 = t4 * t4;
  t71 = 0.1e1 / t70;
  t72 = t14 * t71;
  t73 = t5 - t72;
  t74 = my_piecewise5(t8, 0, t12, 0, t73);
  t77 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t74);
  t78 = t3 * t77;
  t82 = t25 / t26;
  t83 = t82 * t40;
  t85 = t24 * t83 / 0.3e1;
  t86 = t28 * t28;
  t87 = 0.1e1 / t86;
  t91 = sigma[0] * sigma[0];
  t92 = t86 * t29;
  t93 = 0.1e1 / t92;
  t96 = 0.1e1 / t36 / t33;
  t99 = -0.66141331013852962455e-2 * sigma[0] * t87 * t37 + 0.41287072352122365488e-4 * t91 * t93 * t96;
  t100 = t27 * t99;
  t104 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t78 * t41 - t85 - 0.2e1 / 0.3e1 * t24 * t100);
  t106 = my_piecewise5(t12, 0, t8, 0, -t73);
  t109 = my_piecewise3(t48, 0, 0.3e1 / 0.2e1 * t49 * t106);
  t110 = t3 * t109;
  t113 = t82 * t65;
  t115 = t52 * t113 / 0.3e1;
  t117 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t110 * t66 - t115);
  tvrho0 = t44 + t69 + t4 * (t104 + t117);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t120 = -t5 - t72;
  t121 = my_piecewise5(t8, 0, t12, 0, t120);
  t124 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t121);
  t125 = t3 * t124;
  t129 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t125 * t41 - t85);
  t131 = my_piecewise5(t12, 0, t8, 0, -t120);
  t134 = my_piecewise3(t48, 0, 0.3e1 / 0.2e1 * t49 * t131);
  t135 = t3 * t134;
  t138 = t53 * t53;
  t139 = 0.1e1 / t138;
  t143 = sigma[2] * sigma[2];
  t144 = t138 * t54;
  t145 = 0.1e1 / t144;
  t148 = 0.1e1 / t61 / t58;
  t151 = -0.66141331013852962455e-2 * sigma[2] * t139 * t62 + 0.41287072352122365488e-4 * t143 * t145 * t148;
  t152 = t27 * t151;
  t156 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t135 * t66 - t115 - 0.2e1 / 0.3e1 * t52 * t152);
  tvrho1 = t44 + t69 + t4 * (t129 + t156);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t161 = t86 * t28;
  t162 = 0.1e1 / t161;
  t163 = sigma[0] * t162;
  t166 = 0.22047110337950987485e-2 * t30 * t37 - 0.13762357450707455163e-4 * t163 * t96;
  t167 = t27 * t166;
  t170 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t167);
  tvsigma0 = t4 * t170;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t173 = t138 * t53;
  t174 = 0.1e1 / t173;
  t175 = sigma[2] * t174;
  t178 = 0.22047110337950987485e-2 * t55 * t62 - 0.13762357450707455163e-4 * t175 * t148;
  t179 = t27 * t178;
  t182 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t179);
  tvsigma2 = t4 * t182;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t185 = 0.1e1 / t21;
  t186 = t74 * t74;
  t189 = t70 * t4;
  t190 = 0.1e1 / t189;
  t191 = t14 * t190;
  t193 = -0.2e1 * t71 + 0.2e1 * t191;
  t194 = my_piecewise5(t8, 0, t12, 0, t193);
  t198 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t185 * t186 + 0.3e1 / 0.2e1 * t21 * t194);
  t199 = t3 * t198;
  t202 = t78 * t83;
  t208 = t25 / t26 / t4;
  t209 = t208 * t40;
  t211 = t24 * t209 / 0.6e1;
  t212 = t82 * t99;
  t213 = t24 * t212;
  t215 = t86 * rho[0];
  t216 = 0.1e1 / t215;
  t220 = t86 * t86;
  t221 = 0.1e1 / t220;
  t225 = t91 * sigma[0];
  t227 = 0.1e1 / t220 / t29;
  t229 = t33 * t33;
  t231 = 0.1e1 / t36 / t229;
  t234 = 0.26456532405541184982e-1 * sigma[0] * t216 * t37 - 0.41287072352122365489e-3 * t91 * t221 * t96 + 0.18040695917302508518e-5 * t225 * t227 * t231;
  t235 = t27 * t234;
  t239 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t199 * t41 - 0.2e1 / 0.3e1 * t202 - 0.4e1 / 0.3e1 * t78 * t100 + t211 - 0.2e1 / 0.3e1 * t213 - 0.2e1 / 0.3e1 * t24 * t235);
  t240 = 0.1e1 / t49;
  t241 = t106 * t106;
  t245 = my_piecewise5(t12, 0, t8, 0, -t193);
  t249 = my_piecewise3(t48, 0, 0.3e1 / 0.4e1 * t240 * t241 + 0.3e1 / 0.2e1 * t49 * t245);
  t250 = t3 * t249;
  t253 = t110 * t113;
  t255 = t208 * t65;
  t257 = t52 * t255 / 0.6e1;
  t259 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t250 * t66 - 0.2e1 / 0.3e1 * t253 + t257);
  tv2rho20 = 0.2e1 * t104 + 0.2e1 * t117 + t4 * (t239 + t259);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t262 = t185 * t121;
  t265 = 0.2e1 * t191;
  t266 = my_piecewise5(t8, 0, t12, 0, t265);
  t270 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t262 * t74 + 0.3e1 / 0.2e1 * t21 * t266);
  t271 = t3 * t270;
  t274 = t125 * t83;
  t281 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t271 * t41 - t274 / 0.3e1 - 0.2e1 / 0.3e1 * t125 * t100 - t202 / 0.3e1 + t211 - t213 / 0.3e1);
  t282 = t240 * t131;
  t285 = my_piecewise5(t12, 0, t8, 0, -t265);
  t289 = my_piecewise3(t48, 0, 0.3e1 / 0.4e1 * t282 * t106 + 0.3e1 / 0.2e1 * t49 * t285);
  t290 = t3 * t289;
  t293 = t135 * t113;
  t298 = t82 * t151;
  t299 = t52 * t298;
  t302 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t290 * t66 - t293 / 0.3e1 - t253 / 0.3e1 + t257 - 0.2e1 / 0.3e1 * t110 * t152 - t299 / 0.3e1);
  tv2rho21 = t104 + t117 + t129 + t156 + t4 * (t281 + t302);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t307 = t121 * t121;
  t311 = 0.2e1 * t71 + 0.2e1 * t191;
  t312 = my_piecewise5(t8, 0, t12, 0, t311);
  t316 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t185 * t307 + 0.3e1 / 0.2e1 * t21 * t312);
  t317 = t3 * t316;
  t322 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t317 * t41 - 0.2e1 / 0.3e1 * t274 + t211);
  t323 = t131 * t131;
  t327 = my_piecewise5(t12, 0, t8, 0, -t311);
  t331 = my_piecewise3(t48, 0, 0.3e1 / 0.4e1 * t240 * t323 + 0.3e1 / 0.2e1 * t49 * t327);
  t332 = t3 * t331;
  t339 = t138 * rho[1];
  t340 = 0.1e1 / t339;
  t344 = t138 * t138;
  t345 = 0.1e1 / t344;
  t349 = t143 * sigma[2];
  t351 = 0.1e1 / t344 / t54;
  t353 = t58 * t58;
  t355 = 0.1e1 / t61 / t353;
  t358 = 0.26456532405541184982e-1 * sigma[2] * t340 * t62 - 0.41287072352122365489e-3 * t143 * t345 * t148 + 0.18040695917302508518e-5 * t349 * t351 * t355;
  t359 = t27 * t358;
  t363 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t332 * t66 - 0.2e1 / 0.3e1 * t293 - 0.4e1 / 0.3e1 * t135 * t152 + t257 - 0.2e1 / 0.3e1 * t299 - 0.2e1 / 0.3e1 * t52 * t359);
  tv2rho22 = 0.2e1 * t129 + 0.2e1 * t156 + t4 * (t322 + t363);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t368 = t82 * t166;
  t370 = t24 * t368 / 0.3e1;
  t373 = t93 * t96;
  t377 = 0.1e1 / t220 / t28;
  t378 = t91 * t377;
  t381 = -0.66141331013852962455e-2 * t87 * t37 + 0.12386121705636709647e-3 * t373 * sigma[0] - 0.60135653057675028394e-6 * t378 * t231;
  t382 = t27 * t381;
  t386 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t78 * t167 - t370 - 0.2e1 / 0.3e1 * t24 * t382);
  tv2rhosigma0 = t386 * t4 + t170;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t390 = t82 * t178;
  t392 = t52 * t390 / 0.3e1;
  t394 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t110 * t179 - t392);
  tv2rhosigma2 = t394 * t4 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t399 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t125 * t167 - t370);
  tv2rhosigma3 = t399 * t4 + t170;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t405 = t145 * t148;
  t409 = 0.1e1 / t344 / t53;
  t410 = t143 * t409;
  t413 = -0.66141331013852962455e-2 * t139 * t62 + 0.12386121705636709647e-3 * t405 * sigma[2] - 0.60135653057675028394e-6 * t410 * t355;
  t414 = t27 * t413;
  t418 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t135 * t179 - t392 - 0.2e1 / 0.3e1 * t52 * t414);
  tv2rhosigma5 = t4 * t418 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t423 = 0.1e1 / t220 / rho[0];
  t427 = -0.27524714901414910326e-4 * t162 * t96 + 0.20045217685891676131e-6 * sigma[0] * t423 * t231;
  t428 = t27 * t427;
  t431 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t428);
  tv2sigma20 = t4 * t431;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t435 = 0.1e1 / t344 / rho[1];
  t439 = -0.27524714901414910326e-4 * t174 * t148 + 0.20045217685891676131e-6 * sigma[2] * t435 * t355;
  t440 = t27 * t439;
  t443 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t440);
  tv2sigma25 = t4 * t443;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t446 = 0.1e1 / t22;
  t447 = t186 * t74;
  t450 = t185 * t74;
  t453 = t70 * t70;
  t454 = 0.1e1 / t453;
  t455 = t14 * t454;
  t457 = 0.6e1 * t190 - 0.6e1 * t455;
  t458 = my_piecewise5(t8, 0, t12, 0, t457);
  t462 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t446 * t447 + 0.9e1 / 0.4e1 * t450 * t194 + 0.3e1 / 0.2e1 * t21 * t458);
  t463 = t3 * t462;
  t466 = t199 * t83;
  t469 = t78 * t209;
  t471 = t78 * t212;
  t477 = t25 / t26 / t70;
  t478 = t477 * t40;
  t480 = t24 * t478 / 0.4e1;
  t481 = t208 * t99;
  t482 = t24 * t481;
  t484 = t82 * t234;
  t485 = t24 * t484;
  t492 = 0.1e1 / t220 / t86;
  t496 = t91 * t91;
  t498 = 0.1e1 / t220 / t92;
  t502 = 0.1e1 / t36 / t229 / t33;
  t505 = -0.13228266202770592491e0 * t163 * t37 + 0.3798410656395257625e-2 * t91 * t423 * t96 - 0.37885461426335267888e-4 * t225 * t492 * t231 + 0.12387598749875974218e-6 * t496 * t498 * t502;
  t506 = t27 * t505;
  t510 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t463 * t41 - t466 - 0.2e1 * t199 * t100 + t469 / 0.2e1 - 0.2e1 * t471 - 0.2e1 * t78 * t235 - t480 + t482 / 0.2e1 - t485 - 0.2e1 / 0.3e1 * t24 * t506);
  t511 = 0.1e1 / t50;
  t512 = t241 * t106;
  t515 = t240 * t106;
  t519 = my_piecewise5(t12, 0, t8, 0, -t457);
  t523 = my_piecewise3(t48, 0, -0.3e1 / 0.8e1 * t511 * t512 + 0.9e1 / 0.4e1 * t515 * t245 + 0.3e1 / 0.2e1 * t49 * t519);
  t524 = t3 * t523;
  t527 = t250 * t113;
  t528 = t110 * t255;
  t530 = t477 * t65;
  t532 = t52 * t530 / 0.4e1;
  t534 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t524 * t66 - t527 + t528 / 0.2e1 - t532);
  tv3rho30 = 0.3e1 * t239 + 0.3e1 * t259 + t4 * (t510 + t534);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t537 = 0.2e1 * t281;
  t538 = 0.2e1 * t302;
  t539 = t446 * t121;
  t542 = t185 * t266;
  t547 = 0.2e1 * t190;
  t548 = 0.6e1 * t455;
  t549 = t547 - t548;
  t550 = my_piecewise5(t8, 0, t12, 0, t549);
  t554 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t539 * t186 + 0.3e1 / 0.2e1 * t542 * t74 + 0.3e1 / 0.4e1 * t262 * t194 + 0.3e1 / 0.2e1 * t21 * t550);
  t555 = t3 * t554;
  t559 = 0.2e1 / 0.3e1 * t271 * t83;
  t562 = t125 * t209;
  t565 = 0.2e1 / 0.3e1 * t125 * t212;
  t573 = -0.2e1 / 0.3e1 * t555 * t41 - t559 - 0.4e1 / 0.3e1 * t271 * t100 + t562 / 0.6e1 - t565 - 0.2e1 / 0.3e1 * t125 * t235 - t466 / 0.3e1 + t469 / 0.3e1 - 0.2e1 / 0.3e1 * t471 - t480 + t482 / 0.3e1 - t485 / 0.3e1;
  t574 = my_piecewise3(t1, 0, t573);
  t575 = t511 * t131;
  t578 = t240 * t285;
  t584 = my_piecewise5(t12, 0, t8, 0, -t549);
  t588 = my_piecewise3(t48, 0, -0.3e1 / 0.8e1 * t575 * t241 + 0.3e1 / 0.2e1 * t578 * t106 + 0.3e1 / 0.4e1 * t282 * t245 + 0.3e1 / 0.2e1 * t49 * t584);
  t589 = t3 * t588;
  t593 = 0.2e1 / 0.3e1 * t290 * t113;
  t594 = t135 * t255;
  t601 = 0.2e1 / 0.3e1 * t110 * t298;
  t602 = t208 * t151;
  t603 = t52 * t602;
  t606 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t589 * t66 - t593 + t594 / 0.6e1 - t527 / 0.3e1 + t528 / 0.3e1 - t532 - 0.2e1 / 0.3e1 * t250 * t152 - t601 + t603 / 0.6e1);
  tv3rho31 = t239 + t259 + t537 + t538 + t4 * (t574 + t606);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t609 = t446 * t307;
  t614 = t185 * t312;
  t617 = -t547 - t548;
  t618 = my_piecewise5(t8, 0, t12, 0, t617);
  t622 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t609 * t74 + 0.3e1 / 0.2e1 * t262 * t266 + 0.3e1 / 0.4e1 * t614 * t74 + 0.3e1 / 0.2e1 * t21 * t618);
  t623 = t3 * t622;
  t626 = t317 * t83;
  t634 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t623 * t41 - t626 / 0.3e1 - 0.2e1 / 0.3e1 * t317 * t100 - t559 + t562 / 0.3e1 - t565 + t469 / 0.6e1 - t480 + t482 / 0.6e1);
  t635 = t511 * t323;
  t640 = t240 * t327;
  t644 = my_piecewise5(t12, 0, t8, 0, -t617);
  t648 = my_piecewise3(t48, 0, -0.3e1 / 0.8e1 * t635 * t106 + 0.3e1 / 0.2e1 * t282 * t285 + 0.3e1 / 0.4e1 * t640 * t106 + 0.3e1 / 0.2e1 * t49 * t644);
  t649 = t3 * t648;
  t652 = t332 * t113;
  t657 = t135 * t298;
  t663 = t82 * t358;
  t664 = t52 * t663;
  t666 = -0.2e1 / 0.3e1 * t649 * t66 - t652 / 0.3e1 - t593 + t594 / 0.3e1 - 0.4e1 / 0.3e1 * t290 * t152 - 0.2e1 / 0.3e1 * t657 + t528 / 0.6e1 - t532 - t601 + t603 / 0.3e1 - 0.2e1 / 0.3e1 * t110 * t359 - t664 / 0.3e1;
  t667 = my_piecewise3(t45, 0, t666);
  tv3rho32 = t537 + t538 + t322 + t363 + t4 * (t634 + t667);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t672 = t307 * t121;
  t678 = -0.6e1 * t190 - 0.6e1 * t455;
  t679 = my_piecewise5(t8, 0, t12, 0, t678);
  t683 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t446 * t672 + 0.9e1 / 0.4e1 * t262 * t312 + 0.3e1 / 0.2e1 * t21 * t679);
  t684 = t3 * t683;
  t689 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t684 * t41 - t626 + t562 / 0.2e1 - t480);
  t690 = t323 * t131;
  t696 = my_piecewise5(t12, 0, t8, 0, -t678);
  t700 = my_piecewise3(t48, 0, -0.3e1 / 0.8e1 * t511 * t690 + 0.9e1 / 0.4e1 * t282 * t327 + 0.3e1 / 0.2e1 * t49 * t696);
  t701 = t3 * t700;
  t717 = 0.1e1 / t344 / t138;
  t721 = t143 * t143;
  t723 = 0.1e1 / t344 / t144;
  t727 = 0.1e1 / t61 / t353 / t58;
  t730 = -0.13228266202770592491e0 * t175 * t62 + 0.3798410656395257625e-2 * t143 * t435 * t148 - 0.37885461426335267888e-4 * t349 * t717 * t355 + 0.12387598749875974218e-6 * t721 * t723 * t727;
  t731 = t27 * t730;
  t735 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t701 * t66 - t652 - 0.2e1 * t332 * t152 + t594 / 0.2e1 - 0.2e1 * t657 - 0.2e1 * t135 * t359 - t532 + t603 / 0.2e1 - t664 - 0.2e1 / 0.3e1 * t52 * t731);
  tv3rho33 = 0.3e1 * t322 + 0.3e1 * t363 + t4 * (t689 + t735);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t741 = t78 * t368;
  t745 = t208 * t166;
  t747 = t24 * t745 / 0.6e1;
  t748 = t82 * t381;
  t749 = t24 * t748;
  t753 = t221 * t96;
  t756 = t227 * t231;
  t760 = 0.1e1 / t220 / t161;
  t764 = 0.26456532405541184982e-1 * t216 * t37 - 0.99088973645093677176e-3 * t753 * sigma[0] + 0.11425774080958255395e-4 * t756 * t91 - 0.41291995832919914059e-7 * t225 * t760 * t502;
  t765 = t27 * t764;
  t769 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t199 * t167 - 0.2e1 / 0.3e1 * t741 - 0.4e1 / 0.3e1 * t78 * t382 + t747 - 0.2e1 / 0.3e1 * t749 - 0.2e1 / 0.3e1 * t24 * t765);
  tv3rho2sigma0 = t4 * t769 + 0.2e1 * t386;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t774 = t110 * t390;
  t776 = t208 * t178;
  t778 = t52 * t776 / 0.6e1;
  t780 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t250 * t179 - 0.2e1 / 0.3e1 * t774 + t778);
  tv3rho2sigma2 = t4 * t780 + 0.2e1 * t394;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t784 = t125 * t368;
  t791 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t271 * t167 - t784 / 0.3e1 - 0.2e1 / 0.3e1 * t125 * t382 - t741 / 0.3e1 + t747 - t749 / 0.3e1);
  tv3rho2sigma3 = t4 * t791 + t386 + t399;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t795 = t135 * t390;
  t800 = t82 * t413;
  t801 = t52 * t800;
  t804 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t290 * t179 - t795 / 0.3e1 - t774 / 0.3e1 + t778 - 0.2e1 / 0.3e1 * t110 * t414 - t801 / 0.3e1);
  tv3rho2sigma5 = t4 * t804 + t394 + t418;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t811 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t317 * t167 - 0.2e1 / 0.3e1 * t784 + t747);
  tv3rho2sigma6 = t4 * t811 + 0.2e1 * t399;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t822 = t345 * t148;
  t825 = t351 * t355;
  t829 = 0.1e1 / t344 / t173;
  t833 = 0.26456532405541184982e-1 * t340 * t62 - 0.99088973645093677176e-3 * t822 * sigma[2] + 0.11425774080958255395e-4 * t825 * t143 - 0.41291995832919914059e-7 * t349 * t829 * t727;
  t834 = t27 * t833;
  t838 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t332 * t179 - 0.2e1 / 0.3e1 * t795 - 0.4e1 / 0.3e1 * t135 * t414 + t778 - 0.2e1 / 0.3e1 * t801 - 0.2e1 / 0.3e1 * t52 * t834);
  tv3rho2sigma8 = t4 * t838 + 0.2e1 * t418;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t842 = t82 * t427;
  t844 = t24 * t842 / 0.3e1;
  t846 = t377 * t231;
  t850 = 0.1e1 / t220 / t215;
  t854 = 0.16514828940848946196e-3 * t373 - 0.30067826528837514197e-5 * t846 * sigma[0] + 0.13763998610973304686e-7 * t91 * t850 * t502;
  t855 = t27 * t854;
  t859 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t78 * t428 - t844 - 0.2e1 / 0.3e1 * t24 * t855);
  tv3rhosigma20 = t4 * t859 + t431;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t863 = t82 * t439;
  t865 = t52 * t863 / 0.3e1;
  t867 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t110 * t440 - t865);
  tv3rhosigma25 = t4 * t867 + t443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t872 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t125 * t428 - t844);
  tv3rhosigma26 = t4 * t872 + t431;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t877 = t409 * t355;
  t881 = 0.1e1 / t344 / t339;
  t885 = 0.16514828940848946196e-3 * t405 - 0.30067826528837514197e-5 * t877 * sigma[2] + 0.13763998610973304686e-7 * t143 * t881 * t727;
  t886 = t27 * t885;
  t890 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t135 * t440 - t865 - 0.2e1 / 0.3e1 * t52 * t886);
  tv3rhosigma211 = t4 * t890 + t443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t897 = 0.60135653057675028394e-6 * t423 * t231 - 0.45879995369911015621e-8 * sigma[0] * t492 * t502;
  t898 = t27 * t897;
  t901 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t898);
  tv3sigma30 = t4 * t901;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t907 = 0.60135653057675028394e-6 * t435 * t355 - 0.45879995369911015621e-8 * sigma[2] * t717 * t727;
  t908 = t27 * t907;
  t911 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t908);
  tv3sigma39 = t4 * t911;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t33, t34, t35, t36, t37;
  double t40, t41, t44, t45, t46, t47, t48, t49;
  double t50, t51, t52, t53, t54, t55, t56, t58;
  double t59, t60, t61, t62, t65, t66, t69, tzk0;

  double t70, t71, t72, t73, t74, t77, t78, t82;
  double t83, t85, t86, t87, t91, t92, t93, t96;
  double t99, t100, t104, t106, t109, t110, t113, t115;
  double t117, tvrho0, t120, t121, t124, t125, t129, t131;
  double t134, t135, t138, t139, t143, t144, t145, t148;
  double t151, t152, t156, tvrho1, t161, t162, t163, t166;
  double t167, t170, tvsigma0, tvsigma1, t173, t174, t175, t178;
  double t179, t182, tvsigma2;

  double t185, t186, t189, t190, t191, t193, t194, t198;
  double t199, t202, t208, t209, t211, t212, t213, t215;
  double t216, t220, t221, t225, t227, t229, t231, t234;
  double t235, t239, t240, t241, t245, t249, t250, t253;
  double t255, t257, t259, tv2rho20, t262, t265, t266, t270;
  double t271, t274, t281, t282, t285, t289, t290, t293;
  double t298, t299, t302, tv2rho21, t307, t311, t312, t316;
  double t317, t322, t323, t327, t331, t332, t339, t340;
  double t344, t345, t349, t351, t353, t355, t358, t359;
  double t363, tv2rho22, t368, t370, t373, t377, t378, t381;
  double t382, t386, tv2rhosigma0, tv2rhosigma1, t390, t392, t394, tv2rhosigma2;
  double t399, tv2rhosigma3, tv2rhosigma4, t405, t409, t410, t413, t414;
  double t418, tv2rhosigma5, t423, t427, t428, t431, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t435, t439, t440, t443, tv2sigma25;

  double t446, t447, t450, t453, t454, t455, t457, t458;
  double t462, t463, t466, t469, t471, t477, t478, t480;
  double t481, t482, t484, t485, t492, t496, t498, t502;
  double t505, t506, t510, t511, t512, t515, t519, t523;
  double t524, t527, t528, t530, t532, t534, tv3rho30, t537;
  double t538, t539, t542, t547, t548, t549, t550, t554;
  double t555, t559, t562, t565, t573, t574, t575, t578;
  double t584, t588, t589, t593, t594, t601, t602, t603;
  double t606, tv3rho31, t609, t614, t617, t618, t622, t623;
  double t626, t634, t635, t640, t644, t648, t649, t652;
  double t657, t663, t664, t666, t667, tv3rho32, t672, t678;
  double t679, t683, t684, t689, t690, t696, t700, t701;
  double t717, t721, t723, t727, t730, t731, t735, tv3rho33;
  double t741, t745, t747, t748, t749, t753, t756, t760;
  double t764, t765, t769, tv3rho2sigma0, tv3rho2sigma1, t774, t776, t778;
  double t780, tv3rho2sigma2, t784, t791, tv3rho2sigma3, tv3rho2sigma4, t795, t800;
  double t801, t804, tv3rho2sigma5, t811, tv3rho2sigma6, tv3rho2sigma7, t822, t825;
  double t829, t833, t834, t838, tv3rho2sigma8, t842, t844, t846;
  double t850, t854, t855, t859, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23;
  double tv3rhosigma24, t863, t865, t867, tv3rhosigma25, t872, tv3rhosigma26, tv3rhosigma27;
  double tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t877, t881, t885, t886, t890;
  double tv3rhosigma211, t897, t898, t901, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t907, t908, t911;
  double tv3sigma39;

  double t916, t919, t920, t922, t923, t925, t927, t929;
  double t939, t940, t948, t950, t957, t959, t960, t966;
  double t973, t975, t976, t980, t986, t990, t992, t996;
  double t997, t998, t1000, t1001, t1007, t1013, t1017, t1021;
  double t1023, t1024, t1027, t1029, tv4rho40, t1034, t1035, t1036;
  double t1037, t1058, t1059, t1060, t1061, t1065, t1071, t1075;
  double t1076, t1077, t1083, t1084, t1102, t1106, t1110, t1111;
  double t1112, t1113, t1120, t1121, t1122, t1124, t1126, t1127;
  double tv4rho41, t1134, t1136, t1151, t1164, t1168, t1174, t1184;
  double t1185, t1194, t1207, t1211, t1215, t1217, t1224, t1226;
  double t1235, t1238, t1240, t1241, tv4rho42, t1261, t1262, t1266;
  double t1270, t1278, t1279, t1296, t1300, t1304, t1309, t1314;
  double t1321, t1323, t1324, tv4rho43, t1329, t1334, t1340, t1341;
  double t1345, t1351, t1360, t1361, t1369, t1371, t1378, t1383;
  double t1389, t1393, t1408, t1409, tv4rho44, t1415, t1418, t1420;
  double t1426, t1428, t1431, t1453, tv4rho3sigma0, tv4rho3sigma1, t1458, t1459;
  double t1463, t1465, tv4rho3sigma2, t1467, t1471, t1474, t1477, t1485;
  double t1486, tv4rho3sigma3, tv4rho3sigma4, t1488, t1492, t1493, t1500, t1502;
  double t1505, tv4rho3sigma5, t1509, t1517, tv4rho3sigma6, tv4rho3sigma7, t1521, t1526;
  double t1533, t1535, t1536, tv4rho3sigma8, t1543, tv4rho3sigma9, tv4rho3sigma10, t1576;
  double tv4rho3sigma11, t1581, t1587, t1589, t1607, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22;
  double tv4rho2sigma23, tv4rho2sigma24, t1612, t1616, t1618, tv4rho2sigma25, t1622, t1629;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t1633, t1639, t1642;
  double tv4rho2sigma211, t1649, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t1674;
  double tv4rho2sigma217, t1680, t1693, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34;
  double tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t1699, t1701, tv4rhosigma39, t1706;
  double tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317;
  double tv4rhosigma318, t1722, tv4rhosigma319, t1733, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43;
  double tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411;
  double tv4sigma412, tv4sigma413, t1743, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t31 = sigma[0] * t30;
  t33 = 0.1e1 + 0.8323e-2 * t31;
  t34 = POW_1_4(t33);
  t35 = t34 * t34;
  t36 = t35 * t34;
  t37 = 0.1e1 / t36;
  t40 = 0.1e1 + 0.22047110337950987485e-2 * t31 * t37;
  t41 = t27 * t40;
  t44 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t41);
  t45 = rho[1] <= p->dens_threshold;
  t46 = my_piecewise5(t12, t9, t8, t13, -t15);
  t47 = 0.1e1 + t46;
  t48 = t47 <= p->zeta_threshold;
  t49 = sqrt(t47);
  t50 = t49 * t47;
  t51 = my_piecewise3(t48, t20, t50);
  t52 = t3 * t51;
  t53 = rho[1] * rho[1];
  t54 = t53 * rho[1];
  t55 = 0.1e1 / t54;
  t56 = sigma[2] * t55;
  t58 = 0.1e1 + 0.8323e-2 * t56;
  t59 = POW_1_4(t58);
  t60 = t59 * t59;
  t61 = t60 * t59;
  t62 = 0.1e1 / t61;
  t65 = 0.1e1 + 0.22047110337950987485e-2 * t56 * t62;
  t66 = t27 * t65;
  t69 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t66);
  tzk0 = t44 + t69;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t70 = t4 * t4;
  t71 = 0.1e1 / t70;
  t72 = t14 * t71;
  t73 = t5 - t72;
  t74 = my_piecewise5(t8, 0, t12, 0, t73);
  t77 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t74);
  t78 = t3 * t77;
  t82 = t25 / t26;
  t83 = t82 * t40;
  t85 = t24 * t83 / 0.3e1;
  t86 = t28 * t28;
  t87 = 0.1e1 / t86;
  t91 = sigma[0] * sigma[0];
  t92 = t86 * t29;
  t93 = 0.1e1 / t92;
  t96 = 0.1e1 / t36 / t33;
  t99 = -0.66141331013852962455e-2 * sigma[0] * t87 * t37 + 0.41287072352122365488e-4 * t91 * t93 * t96;
  t100 = t27 * t99;
  t104 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t78 * t41 - t85 - 0.2e1 / 0.3e1 * t24 * t100);
  t106 = my_piecewise5(t12, 0, t8, 0, -t73);
  t109 = my_piecewise3(t48, 0, 0.3e1 / 0.2e1 * t49 * t106);
  t110 = t3 * t109;
  t113 = t82 * t65;
  t115 = t52 * t113 / 0.3e1;
  t117 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t110 * t66 - t115);
  tvrho0 = t44 + t69 + t4 * (t104 + t117);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t120 = -t5 - t72;
  t121 = my_piecewise5(t8, 0, t12, 0, t120);
  t124 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t121);
  t125 = t3 * t124;
  t129 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t125 * t41 - t85);
  t131 = my_piecewise5(t12, 0, t8, 0, -t120);
  t134 = my_piecewise3(t48, 0, 0.3e1 / 0.2e1 * t49 * t131);
  t135 = t3 * t134;
  t138 = t53 * t53;
  t139 = 0.1e1 / t138;
  t143 = sigma[2] * sigma[2];
  t144 = t138 * t54;
  t145 = 0.1e1 / t144;
  t148 = 0.1e1 / t61 / t58;
  t151 = -0.66141331013852962455e-2 * sigma[2] * t139 * t62 + 0.41287072352122365488e-4 * t143 * t145 * t148;
  t152 = t27 * t151;
  t156 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t135 * t66 - t115 - 0.2e1 / 0.3e1 * t52 * t152);
  tvrho1 = t44 + t69 + t4 * (t129 + t156);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t161 = t86 * t28;
  t162 = 0.1e1 / t161;
  t163 = sigma[0] * t162;
  t166 = 0.22047110337950987485e-2 * t30 * t37 - 0.13762357450707455163e-4 * t163 * t96;
  t167 = t27 * t166;
  t170 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t167);
  tvsigma0 = t4 * t170;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t173 = t138 * t53;
  t174 = 0.1e1 / t173;
  t175 = sigma[2] * t174;
  t178 = 0.22047110337950987485e-2 * t55 * t62 - 0.13762357450707455163e-4 * t175 * t148;
  t179 = t27 * t178;
  t182 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t179);
  tvsigma2 = t4 * t182;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t185 = 0.1e1 / t21;
  t186 = t74 * t74;
  t189 = t70 * t4;
  t190 = 0.1e1 / t189;
  t191 = t14 * t190;
  t193 = -0.2e1 * t71 + 0.2e1 * t191;
  t194 = my_piecewise5(t8, 0, t12, 0, t193);
  t198 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t185 * t186 + 0.3e1 / 0.2e1 * t21 * t194);
  t199 = t3 * t198;
  t202 = t78 * t83;
  t208 = t25 / t26 / t4;
  t209 = t208 * t40;
  t211 = t24 * t209 / 0.6e1;
  t212 = t82 * t99;
  t213 = t24 * t212;
  t215 = t86 * rho[0];
  t216 = 0.1e1 / t215;
  t220 = t86 * t86;
  t221 = 0.1e1 / t220;
  t225 = t91 * sigma[0];
  t227 = 0.1e1 / t220 / t29;
  t229 = t33 * t33;
  t231 = 0.1e1 / t36 / t229;
  t234 = 0.26456532405541184982e-1 * sigma[0] * t216 * t37 - 0.41287072352122365489e-3 * t91 * t221 * t96 + 0.18040695917302508518e-5 * t225 * t227 * t231;
  t235 = t27 * t234;
  t239 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t199 * t41 - 0.2e1 / 0.3e1 * t202 - 0.4e1 / 0.3e1 * t78 * t100 + t211 - 0.2e1 / 0.3e1 * t213 - 0.2e1 / 0.3e1 * t24 * t235);
  t240 = 0.1e1 / t49;
  t241 = t106 * t106;
  t245 = my_piecewise5(t12, 0, t8, 0, -t193);
  t249 = my_piecewise3(t48, 0, 0.3e1 / 0.4e1 * t240 * t241 + 0.3e1 / 0.2e1 * t49 * t245);
  t250 = t3 * t249;
  t253 = t110 * t113;
  t255 = t208 * t65;
  t257 = t52 * t255 / 0.6e1;
  t259 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t250 * t66 - 0.2e1 / 0.3e1 * t253 + t257);
  tv2rho20 = 0.2e1 * t104 + 0.2e1 * t117 + t4 * (t239 + t259);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t262 = t185 * t121;
  t265 = 0.2e1 * t191;
  t266 = my_piecewise5(t8, 0, t12, 0, t265);
  t270 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t262 * t74 + 0.3e1 / 0.2e1 * t21 * t266);
  t271 = t3 * t270;
  t274 = t125 * t83;
  t281 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t271 * t41 - t274 / 0.3e1 - 0.2e1 / 0.3e1 * t125 * t100 - t202 / 0.3e1 + t211 - t213 / 0.3e1);
  t282 = t240 * t131;
  t285 = my_piecewise5(t12, 0, t8, 0, -t265);
  t289 = my_piecewise3(t48, 0, 0.3e1 / 0.4e1 * t282 * t106 + 0.3e1 / 0.2e1 * t49 * t285);
  t290 = t3 * t289;
  t293 = t135 * t113;
  t298 = t82 * t151;
  t299 = t52 * t298;
  t302 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t290 * t66 - t293 / 0.3e1 - t253 / 0.3e1 + t257 - 0.2e1 / 0.3e1 * t110 * t152 - t299 / 0.3e1);
  tv2rho21 = t104 + t117 + t129 + t156 + t4 * (t281 + t302);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t307 = t121 * t121;
  t311 = 0.2e1 * t71 + 0.2e1 * t191;
  t312 = my_piecewise5(t8, 0, t12, 0, t311);
  t316 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t185 * t307 + 0.3e1 / 0.2e1 * t21 * t312);
  t317 = t3 * t316;
  t322 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t317 * t41 - 0.2e1 / 0.3e1 * t274 + t211);
  t323 = t131 * t131;
  t327 = my_piecewise5(t12, 0, t8, 0, -t311);
  t331 = my_piecewise3(t48, 0, 0.3e1 / 0.4e1 * t240 * t323 + 0.3e1 / 0.2e1 * t49 * t327);
  t332 = t3 * t331;
  t339 = t138 * rho[1];
  t340 = 0.1e1 / t339;
  t344 = t138 * t138;
  t345 = 0.1e1 / t344;
  t349 = t143 * sigma[2];
  t351 = 0.1e1 / t344 / t54;
  t353 = t58 * t58;
  t355 = 0.1e1 / t61 / t353;
  t358 = 0.26456532405541184982e-1 * sigma[2] * t340 * t62 - 0.41287072352122365489e-3 * t143 * t345 * t148 + 0.18040695917302508518e-5 * t349 * t351 * t355;
  t359 = t27 * t358;
  t363 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t332 * t66 - 0.2e1 / 0.3e1 * t293 - 0.4e1 / 0.3e1 * t135 * t152 + t257 - 0.2e1 / 0.3e1 * t299 - 0.2e1 / 0.3e1 * t52 * t359);
  tv2rho22 = 0.2e1 * t129 + 0.2e1 * t156 + t4 * (t322 + t363);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t368 = t82 * t166;
  t370 = t24 * t368 / 0.3e1;
  t373 = t93 * t96;
  t377 = 0.1e1 / t220 / t28;
  t378 = t91 * t377;
  t381 = -0.66141331013852962455e-2 * t87 * t37 + 0.12386121705636709647e-3 * t373 * sigma[0] - 0.60135653057675028394e-6 * t378 * t231;
  t382 = t27 * t381;
  t386 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t78 * t167 - t370 - 0.2e1 / 0.3e1 * t24 * t382);
  tv2rhosigma0 = t386 * t4 + t170;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t390 = t82 * t178;
  t392 = t52 * t390 / 0.3e1;
  t394 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t110 * t179 - t392);
  tv2rhosigma2 = t394 * t4 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t399 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t125 * t167 - t370);
  tv2rhosigma3 = t399 * t4 + t170;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t405 = t145 * t148;
  t409 = 0.1e1 / t344 / t53;
  t410 = t143 * t409;
  t413 = -0.66141331013852962455e-2 * t139 * t62 + 0.12386121705636709647e-3 * t405 * sigma[2] - 0.60135653057675028394e-6 * t410 * t355;
  t414 = t27 * t413;
  t418 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t135 * t179 - t392 - 0.2e1 / 0.3e1 * t52 * t414);
  tv2rhosigma5 = t4 * t418 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t423 = 0.1e1 / t220 / rho[0];
  t427 = -0.27524714901414910326e-4 * t162 * t96 + 0.20045217685891676131e-6 * sigma[0] * t423 * t231;
  t428 = t27 * t427;
  t431 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t428);
  tv2sigma20 = t4 * t431;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t435 = 0.1e1 / t344 / rho[1];
  t439 = -0.27524714901414910326e-4 * t174 * t148 + 0.20045217685891676131e-6 * sigma[2] * t435 * t355;
  t440 = t27 * t439;
  t443 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t440);
  tv2sigma25 = t4 * t443;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t446 = 0.1e1 / t22;
  t447 = t186 * t74;
  t450 = t185 * t74;
  t453 = t70 * t70;
  t454 = 0.1e1 / t453;
  t455 = t14 * t454;
  t457 = 0.6e1 * t190 - 0.6e1 * t455;
  t458 = my_piecewise5(t8, 0, t12, 0, t457);
  t462 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t446 * t447 + 0.9e1 / 0.4e1 * t450 * t194 + 0.3e1 / 0.2e1 * t21 * t458);
  t463 = t3 * t462;
  t466 = t199 * t83;
  t469 = t78 * t209;
  t471 = t78 * t212;
  t477 = t25 / t26 / t70;
  t478 = t477 * t40;
  t480 = t24 * t478 / 0.4e1;
  t481 = t208 * t99;
  t482 = t24 * t481;
  t484 = t82 * t234;
  t485 = t24 * t484;
  t492 = 0.1e1 / t220 / t86;
  t496 = t91 * t91;
  t498 = 0.1e1 / t220 / t92;
  t502 = 0.1e1 / t36 / t229 / t33;
  t505 = -0.13228266202770592491e0 * t163 * t37 + 0.3798410656395257625e-2 * t91 * t423 * t96 - 0.37885461426335267888e-4 * t225 * t492 * t231 + 0.12387598749875974218e-6 * t496 * t498 * t502;
  t506 = t27 * t505;
  t510 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t463 * t41 - t466 - 0.2e1 * t199 * t100 + t469 / 0.2e1 - 0.2e1 * t471 - 0.2e1 * t78 * t235 - t480 + t482 / 0.2e1 - t485 - 0.2e1 / 0.3e1 * t24 * t506);
  t511 = 0.1e1 / t50;
  t512 = t241 * t106;
  t515 = t240 * t106;
  t519 = my_piecewise5(t12, 0, t8, 0, -t457);
  t523 = my_piecewise3(t48, 0, -0.3e1 / 0.8e1 * t511 * t512 + 0.9e1 / 0.4e1 * t515 * t245 + 0.3e1 / 0.2e1 * t49 * t519);
  t524 = t3 * t523;
  t527 = t250 * t113;
  t528 = t110 * t255;
  t530 = t477 * t65;
  t532 = t52 * t530 / 0.4e1;
  t534 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t524 * t66 - t527 + t528 / 0.2e1 - t532);
  tv3rho30 = 0.3e1 * t239 + 0.3e1 * t259 + t4 * (t510 + t534);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t537 = 0.2e1 * t281;
  t538 = 0.2e1 * t302;
  t539 = t446 * t121;
  t542 = t185 * t266;
  t547 = 0.2e1 * t190;
  t548 = 0.6e1 * t455;
  t549 = t547 - t548;
  t550 = my_piecewise5(t8, 0, t12, 0, t549);
  t554 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t539 * t186 + 0.3e1 / 0.2e1 * t542 * t74 + 0.3e1 / 0.4e1 * t262 * t194 + 0.3e1 / 0.2e1 * t21 * t550);
  t555 = t3 * t554;
  t559 = 0.2e1 / 0.3e1 * t271 * t83;
  t562 = t125 * t209;
  t565 = 0.2e1 / 0.3e1 * t125 * t212;
  t573 = -0.2e1 / 0.3e1 * t555 * t41 - t559 - 0.4e1 / 0.3e1 * t271 * t100 + t562 / 0.6e1 - t565 - 0.2e1 / 0.3e1 * t125 * t235 - t466 / 0.3e1 + t469 / 0.3e1 - 0.2e1 / 0.3e1 * t471 - t480 + t482 / 0.3e1 - t485 / 0.3e1;
  t574 = my_piecewise3(t1, 0, t573);
  t575 = t511 * t131;
  t578 = t240 * t285;
  t584 = my_piecewise5(t12, 0, t8, 0, -t549);
  t588 = my_piecewise3(t48, 0, -0.3e1 / 0.8e1 * t575 * t241 + 0.3e1 / 0.2e1 * t578 * t106 + 0.3e1 / 0.4e1 * t282 * t245 + 0.3e1 / 0.2e1 * t49 * t584);
  t589 = t3 * t588;
  t593 = 0.2e1 / 0.3e1 * t290 * t113;
  t594 = t135 * t255;
  t601 = 0.2e1 / 0.3e1 * t110 * t298;
  t602 = t208 * t151;
  t603 = t52 * t602;
  t606 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t589 * t66 - t593 + t594 / 0.6e1 - t527 / 0.3e1 + t528 / 0.3e1 - t532 - 0.2e1 / 0.3e1 * t250 * t152 - t601 + t603 / 0.6e1);
  tv3rho31 = t239 + t259 + t537 + t538 + t4 * (t574 + t606);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t609 = t446 * t307;
  t614 = t185 * t312;
  t617 = -t547 - t548;
  t618 = my_piecewise5(t8, 0, t12, 0, t617);
  t622 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t609 * t74 + 0.3e1 / 0.2e1 * t262 * t266 + 0.3e1 / 0.4e1 * t614 * t74 + 0.3e1 / 0.2e1 * t21 * t618);
  t623 = t3 * t622;
  t626 = t317 * t83;
  t634 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t623 * t41 - t626 / 0.3e1 - 0.2e1 / 0.3e1 * t317 * t100 - t559 + t562 / 0.3e1 - t565 + t469 / 0.6e1 - t480 + t482 / 0.6e1);
  t635 = t511 * t323;
  t640 = t240 * t327;
  t644 = my_piecewise5(t12, 0, t8, 0, -t617);
  t648 = my_piecewise3(t48, 0, -0.3e1 / 0.8e1 * t635 * t106 + 0.3e1 / 0.2e1 * t282 * t285 + 0.3e1 / 0.4e1 * t640 * t106 + 0.3e1 / 0.2e1 * t49 * t644);
  t649 = t3 * t648;
  t652 = t332 * t113;
  t657 = t135 * t298;
  t663 = t82 * t358;
  t664 = t52 * t663;
  t666 = -0.2e1 / 0.3e1 * t649 * t66 - t652 / 0.3e1 - t593 + t594 / 0.3e1 - 0.4e1 / 0.3e1 * t290 * t152 - 0.2e1 / 0.3e1 * t657 + t528 / 0.6e1 - t532 - t601 + t603 / 0.3e1 - 0.2e1 / 0.3e1 * t110 * t359 - t664 / 0.3e1;
  t667 = my_piecewise3(t45, 0, t666);
  tv3rho32 = t537 + t538 + t322 + t363 + t4 * (t634 + t667);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t672 = t307 * t121;
  t678 = -0.6e1 * t190 - 0.6e1 * t455;
  t679 = my_piecewise5(t8, 0, t12, 0, t678);
  t683 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t446 * t672 + 0.9e1 / 0.4e1 * t262 * t312 + 0.3e1 / 0.2e1 * t21 * t679);
  t684 = t3 * t683;
  t689 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t684 * t41 - t626 + t562 / 0.2e1 - t480);
  t690 = t323 * t131;
  t696 = my_piecewise5(t12, 0, t8, 0, -t678);
  t700 = my_piecewise3(t48, 0, -0.3e1 / 0.8e1 * t511 * t690 + 0.9e1 / 0.4e1 * t282 * t327 + 0.3e1 / 0.2e1 * t49 * t696);
  t701 = t3 * t700;
  t717 = 0.1e1 / t344 / t138;
  t721 = t143 * t143;
  t723 = 0.1e1 / t344 / t144;
  t727 = 0.1e1 / t61 / t353 / t58;
  t730 = -0.13228266202770592491e0 * t175 * t62 + 0.3798410656395257625e-2 * t143 * t435 * t148 - 0.37885461426335267888e-4 * t349 * t717 * t355 + 0.12387598749875974218e-6 * t721 * t723 * t727;
  t731 = t27 * t730;
  t735 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t701 * t66 - t652 - 0.2e1 * t332 * t152 + t594 / 0.2e1 - 0.2e1 * t657 - 0.2e1 * t135 * t359 - t532 + t603 / 0.2e1 - t664 - 0.2e1 / 0.3e1 * t52 * t731);
  tv3rho33 = 0.3e1 * t322 + 0.3e1 * t363 + t4 * (t689 + t735);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t741 = t78 * t368;
  t745 = t208 * t166;
  t747 = t24 * t745 / 0.6e1;
  t748 = t82 * t381;
  t749 = t24 * t748;
  t753 = t221 * t96;
  t756 = t227 * t231;
  t760 = 0.1e1 / t220 / t161;
  t764 = 0.26456532405541184982e-1 * t216 * t37 - 0.99088973645093677176e-3 * t753 * sigma[0] + 0.11425774080958255395e-4 * t756 * t91 - 0.41291995832919914059e-7 * t225 * t760 * t502;
  t765 = t27 * t764;
  t769 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t199 * t167 - 0.2e1 / 0.3e1 * t741 - 0.4e1 / 0.3e1 * t78 * t382 + t747 - 0.2e1 / 0.3e1 * t749 - 0.2e1 / 0.3e1 * t24 * t765);
  tv3rho2sigma0 = t4 * t769 + 0.2e1 * t386;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t774 = t110 * t390;
  t776 = t208 * t178;
  t778 = t52 * t776 / 0.6e1;
  t780 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t250 * t179 - 0.2e1 / 0.3e1 * t774 + t778);
  tv3rho2sigma2 = t4 * t780 + 0.2e1 * t394;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t784 = t125 * t368;
  t791 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t271 * t167 - t784 / 0.3e1 - 0.2e1 / 0.3e1 * t125 * t382 - t741 / 0.3e1 + t747 - t749 / 0.3e1);
  tv3rho2sigma3 = t4 * t791 + t386 + t399;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t795 = t135 * t390;
  t800 = t82 * t413;
  t801 = t52 * t800;
  t804 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t290 * t179 - t795 / 0.3e1 - t774 / 0.3e1 + t778 - 0.2e1 / 0.3e1 * t110 * t414 - t801 / 0.3e1);
  tv3rho2sigma5 = t4 * t804 + t394 + t418;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t811 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t317 * t167 - 0.2e1 / 0.3e1 * t784 + t747);
  tv3rho2sigma6 = t4 * t811 + 0.2e1 * t399;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t822 = t345 * t148;
  t825 = t351 * t355;
  t829 = 0.1e1 / t344 / t173;
  t833 = 0.26456532405541184982e-1 * t340 * t62 - 0.99088973645093677176e-3 * t822 * sigma[2] + 0.11425774080958255395e-4 * t825 * t143 - 0.41291995832919914059e-7 * t349 * t829 * t727;
  t834 = t27 * t833;
  t838 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t332 * t179 - 0.2e1 / 0.3e1 * t795 - 0.4e1 / 0.3e1 * t135 * t414 + t778 - 0.2e1 / 0.3e1 * t801 - 0.2e1 / 0.3e1 * t52 * t834);
  tv3rho2sigma8 = t4 * t838 + 0.2e1 * t418;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t842 = t82 * t427;
  t844 = t24 * t842 / 0.3e1;
  t846 = t377 * t231;
  t850 = 0.1e1 / t220 / t215;
  t854 = 0.16514828940848946196e-3 * t373 - 0.30067826528837514197e-5 * t846 * sigma[0] + 0.13763998610973304686e-7 * t91 * t850 * t502;
  t855 = t27 * t854;
  t859 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t78 * t428 - t844 - 0.2e1 / 0.3e1 * t24 * t855);
  tv3rhosigma20 = t4 * t859 + t431;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t863 = t82 * t439;
  t865 = t52 * t863 / 0.3e1;
  t867 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t110 * t440 - t865);
  tv3rhosigma25 = t4 * t867 + t443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t872 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t125 * t428 - t844);
  tv3rhosigma26 = t4 * t872 + t431;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t877 = t409 * t355;
  t881 = 0.1e1 / t344 / t339;
  t885 = 0.16514828940848946196e-3 * t405 - 0.30067826528837514197e-5 * t877 * sigma[2] + 0.13763998610973304686e-7 * t143 * t881 * t727;
  t886 = t27 * t885;
  t890 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t135 * t440 - t865 - 0.2e1 / 0.3e1 * t52 * t886);
  tv3rhosigma211 = t4 * t890 + t443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t897 = 0.60135653057675028394e-6 * t423 * t231 - 0.45879995369911015621e-8 * sigma[0] * t492 * t502;
  t898 = t27 * t897;
  t901 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t898);
  tv3sigma30 = t4 * t901;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t907 = 0.60135653057675028394e-6 * t435 * t355 - 0.45879995369911015621e-8 * sigma[2] * t717 * t727;
  t908 = t27 * t907;
  t911 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t908);
  tv3sigma39 = t4 * t911;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t916 = t25 / t26 / t189;
  t919 = 0.5e1 / 0.8e1 * t24 * t916 * t40;
  t920 = t463 * t83;
  t922 = t199 * t209;
  t923 = t78 * t478;
  t925 = t24 * t477 * t99;
  t927 = t24 * t208 * t234;
  t929 = t24 * t82 * t505;
  t939 = t220 * t220;
  t940 = 0.1e1 / t939;
  t948 = t229 * t229;
  t950 = 0.1e1 / t36 / t948;
  t957 = t17 * t17;
  t959 = 0.1e1 / t21 / t957;
  t960 = t186 * t186;
  t966 = t194 * t194;
  t973 = t14 / t453 / t4;
  t975 = -0.24e2 * t454 + 0.24e2 * t973;
  t976 = my_piecewise5(t8, 0, t12, 0, t975);
  t980 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t959 * t960 - 0.9e1 / 0.4e1 * t446 * t186 * t194 + 0.9e1 / 0.4e1 * t185 * t966 + 0.3e1 * t450 * t458 + 0.3e1 / 0.2e1 * t21 * t976);
  t986 = t199 * t212;
  t990 = t78 * t481;
  t992 = t78 * t484;
  t996 = t919 - 0.4e1 / 0.3e1 * t920 + t922 - t923 - t925 + t927 - 0.4e1 / 0.3e1 * t929 - 0.2e1 / 0.3e1 * t24 * t27 * (0.79369597216623554946e0 * sigma[0] * t93 * t37 - 0.36662920248684660554e-1 * t378 * t96 + 0.62059993955520629303e-3 * t225 * t850 * t231 - 0.44595355499553507184e-5 * t496 * t940 * t502 + 0.11598973244461995009e-7 * t496 * sigma[0] / t939 / t29 * t950) - 0.2e1 / 0.3e1 * t3 * t980 * t41 - 0.8e1 / 0.3e1 * t463 * t100 - 0.4e1 * t986 - 0.4e1 * t199 * t235 + 0.2e1 * t990 - 0.4e1 * t992 - 0.8e1 / 0.3e1 * t78 * t506;
  t997 = my_piecewise3(t1, 0, t996);
  t998 = t47 * t47;
  t1000 = 0.1e1 / t49 / t998;
  t1001 = t241 * t241;
  t1007 = t245 * t245;
  t1013 = my_piecewise5(t12, 0, t8, 0, -t975);
  t1017 = my_piecewise3(t48, 0, 0.9e1 / 0.16e2 * t1000 * t1001 - 0.9e1 / 0.4e1 * t511 * t241 * t245 + 0.9e1 / 0.4e1 * t240 * t1007 + 0.3e1 * t515 * t519 + 0.3e1 / 0.2e1 * t49 * t1013);
  t1021 = t524 * t113;
  t1023 = t250 * t255;
  t1024 = t110 * t530;
  t1027 = 0.5e1 / 0.8e1 * t52 * t916 * t65;
  t1029 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t3 * t1017 * t66 - 0.4e1 / 0.3e1 * t1021 + t1023 - t1024 + t1027);
  tv4rho40 = 0.4e1 * t510 + 0.4e1 * t534 + t4 * (t997 + t1029);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1034 = t555 * t83;
  t1035 = t271 * t209;
  t1036 = t1035 / 0.2e1;
  t1037 = t125 * t478;
  t1058 = 0.12e2 * t454;
  t1059 = 0.24e2 * t973;
  t1060 = -t1058 + t1059;
  t1061 = my_piecewise5(t8, 0, t12, 0, t1060);
  t1065 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t959 * t121 * t447 - 0.9e1 / 0.8e1 * t446 * t266 * t186 - 0.9e1 / 0.8e1 * t539 * t74 * t194 + 0.9e1 / 0.4e1 * t185 * t550 * t74 + 0.9e1 / 0.4e1 * t542 * t194 + 0.3e1 / 0.4e1 * t262 * t458 + 0.3e1 / 0.2e1 * t21 * t1061);
  t1071 = t271 * t212;
  t1075 = t125 * t481;
  t1076 = t1075 / 0.2e1;
  t1077 = t125 * t484;
  t1083 = -t1034 + t1036 - t1037 / 0.4e1 + t919 - t920 / 0.3e1 + t922 / 0.2e1 - 0.3e1 / 0.4e1 * t923 - 0.2e1 / 0.3e1 * t3 * t1065 * t41 - 0.2e1 * t555 * t100 - 0.2e1 * t1071 - 0.2e1 * t271 * t235 + t1076 - t1077 - 0.2e1 / 0.3e1 * t125 * t506 - 0.3e1 / 0.4e1 * t925 + t927 / 0.2e1 - t929 / 0.3e1 - t986 + t990 - t992;
  t1084 = my_piecewise3(t1, 0, t1083);
  t1102 = my_piecewise5(t12, 0, t8, 0, -t1060);
  t1106 = my_piecewise3(t48, 0, 0.9e1 / 0.16e2 * t1000 * t131 * t512 - 0.9e1 / 0.8e1 * t511 * t285 * t241 - 0.9e1 / 0.8e1 * t575 * t106 * t245 + 0.9e1 / 0.4e1 * t240 * t584 * t106 + 0.9e1 / 0.4e1 * t578 * t245 + 0.3e1 / 0.4e1 * t282 * t519 + 0.3e1 / 0.2e1 * t49 * t1102);
  t1110 = t589 * t113;
  t1111 = t290 * t255;
  t1112 = t1111 / 0.2e1;
  t1113 = t135 * t530;
  t1120 = t250 * t298;
  t1121 = t110 * t602;
  t1122 = t1121 / 0.2e1;
  t1124 = t52 * t477 * t151;
  t1126 = -0.2e1 / 0.3e1 * t3 * t1106 * t66 - t1110 + t1112 - t1113 / 0.4e1 - t1021 / 0.3e1 + t1023 / 0.2e1 - 0.3e1 / 0.4e1 * t1024 + t1027 - 0.2e1 / 0.3e1 * t524 * t152 - t1120 + t1122 - t1124 / 0.4e1;
  t1127 = my_piecewise3(t45, 0, t1126);
  tv4rho41 = t510 + t534 + 0.3e1 * t574 + 0.3e1 * t606 + t4 * (t1084 + t1127);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1134 = t623 * t83;
  t1136 = t317 * t209;
  t1151 = t266 * t266;
  t1164 = my_piecewise5(t8, 0, t12, 0, t1059);
  t1168 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t959 * t307 * t186 - 0.3e1 / 0.2e1 * t539 * t74 * t266 - 0.3e1 / 0.8e1 * t609 * t194 + 0.3e1 / 0.2e1 * t185 * t1151 + 0.3e1 / 0.2e1 * t262 * t550 - 0.3e1 / 0.8e1 * t446 * t312 * t186 + 0.3e1 / 0.2e1 * t185 * t618 * t74 + 0.3e1 / 0.4e1 * t614 * t194 + 0.3e1 / 0.2e1 * t21 * t1164);
  t1174 = t317 * t212;
  t1184 = -0.2e1 / 0.3e1 * t1134 + t1136 / 0.6e1 - 0.2e1 / 0.3e1 * t1034 + 0.2e1 / 0.3e1 * t1035 - t1037 / 0.2e1 + t919 + t922 / 0.6e1 - t923 / 0.2e1 - 0.2e1 / 0.3e1 * t3 * t1168 * t41 - 0.4e1 / 0.3e1 * t623 * t100 - 0.2e1 / 0.3e1 * t1174 - 0.2e1 / 0.3e1 * t317 * t235 - 0.4e1 / 0.3e1 * t1071 + 0.2e1 / 0.3e1 * t1075 - 0.2e1 / 0.3e1 * t1077 - t925 / 0.2e1 + t927 / 0.6e1 + t990 / 0.3e1;
  t1185 = my_piecewise3(t1, 0, t1184);
  t1194 = t285 * t285;
  t1207 = my_piecewise5(t12, 0, t8, 0, -t1059);
  t1211 = my_piecewise3(t48, 0, 0.9e1 / 0.16e2 * t1000 * t323 * t241 - 0.3e1 / 0.2e1 * t575 * t106 * t285 - 0.3e1 / 0.8e1 * t635 * t245 + 0.3e1 / 0.2e1 * t240 * t1194 + 0.3e1 / 0.2e1 * t282 * t584 - 0.3e1 / 0.8e1 * t511 * t327 * t241 + 0.3e1 / 0.2e1 * t240 * t644 * t106 + 0.3e1 / 0.4e1 * t640 * t245 + 0.3e1 / 0.2e1 * t49 * t1207);
  t1215 = t649 * t113;
  t1217 = t332 * t255;
  t1224 = t290 * t298;
  t1226 = t135 * t602;
  t1235 = t110 * t663;
  t1238 = t52 * t208 * t358;
  t1240 = -0.2e1 / 0.3e1 * t3 * t1211 * t66 - 0.2e1 / 0.3e1 * t1215 + t1217 / 0.6e1 - 0.2e1 / 0.3e1 * t1110 + 0.2e1 / 0.3e1 * t1111 - t1113 / 0.2e1 - 0.4e1 / 0.3e1 * t589 * t152 - 0.4e1 / 0.3e1 * t1224 + t1226 / 0.3e1 + t1023 / 0.6e1 - t1024 / 0.2e1 + t1027 - 0.2e1 / 0.3e1 * t1120 + 0.2e1 / 0.3e1 * t1121 - t1124 / 0.2e1 - 0.2e1 / 0.3e1 * t250 * t359 - 0.2e1 / 0.3e1 * t1235 + t1238 / 0.6e1;
  t1241 = my_piecewise3(t45, 0, t1240);
  tv4rho42 = 0.2e1 * t574 + 0.2e1 * t606 + 0.2e1 * t634 + 0.2e1 * t667 + t4 * (t1185 + t1241);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1261 = t1058 + t1059;
  t1262 = my_piecewise5(t8, 0, t12, 0, t1261);
  t1266 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t959 * t672 * t74 - 0.9e1 / 0.8e1 * t609 * t266 - 0.9e1 / 0.8e1 * t539 * t312 * t74 + 0.9e1 / 0.4e1 * t542 * t312 + 0.9e1 / 0.4e1 * t262 * t618 + 0.3e1 / 0.4e1 * t185 * t679 * t74 + 0.3e1 / 0.2e1 * t21 * t1262);
  t1270 = t684 * t83;
  t1278 = -0.2e1 / 0.3e1 * t3 * t1266 * t41 - t1270 / 0.3e1 - 0.2e1 / 0.3e1 * t684 * t100 - t1134 + t1136 / 0.2e1 - t1174 + t1036 - 0.3e1 / 0.4e1 * t1037 + t1076 - t923 / 0.4e1 + t919 - t925 / 0.4e1;
  t1279 = my_piecewise3(t1, 0, t1278);
  t1296 = my_piecewise5(t12, 0, t8, 0, -t1261);
  t1300 = my_piecewise3(t48, 0, 0.9e1 / 0.16e2 * t1000 * t690 * t106 - 0.9e1 / 0.8e1 * t635 * t285 - 0.9e1 / 0.8e1 * t575 * t327 * t106 + 0.9e1 / 0.4e1 * t578 * t327 + 0.9e1 / 0.4e1 * t282 * t644 + 0.3e1 / 0.4e1 * t240 * t696 * t106 + 0.3e1 / 0.2e1 * t49 * t1296);
  t1304 = t701 * t113;
  t1309 = t332 * t298;
  t1314 = t135 * t663;
  t1321 = t52 * t82 * t730;
  t1323 = -0.2e1 / 0.3e1 * t3 * t1300 * t66 - t1304 / 0.3e1 - t1215 + t1217 / 0.2e1 - 0.2e1 * t649 * t152 - t1309 + t1112 - 0.3e1 / 0.4e1 * t1113 - 0.2e1 * t1224 + t1226 - 0.2e1 * t290 * t359 - t1314 - t1024 / 0.4e1 + t1027 + t1122 - 0.3e1 / 0.4e1 * t1124 - t1235 + t1238 / 0.2e1 - 0.2e1 / 0.3e1 * t110 * t731 - t1321 / 0.3e1;
  t1324 = my_piecewise3(t45, 0, t1323);
  tv4rho43 = 0.3e1 * t634 + 0.3e1 * t667 + t689 + t735 + t4 * (t1279 + t1324);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1329 = t307 * t307;
  t1334 = t312 * t312;
  t1340 = 0.24e2 * t454 + 0.24e2 * t973;
  t1341 = my_piecewise5(t8, 0, t12, 0, t1340);
  t1345 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t959 * t1329 - 0.9e1 / 0.4e1 * t609 * t312 + 0.9e1 / 0.4e1 * t185 * t1334 + 0.3e1 * t262 * t679 + 0.3e1 / 0.2e1 * t21 * t1341);
  t1351 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t3 * t1345 * t41 - 0.4e1 / 0.3e1 * t1270 + t1136 - t1037 + t919);
  t1360 = t344 * t344;
  t1361 = 0.1e1 / t1360;
  t1369 = t353 * t353;
  t1371 = 0.1e1 / t61 / t1369;
  t1378 = t323 * t323;
  t1383 = t327 * t327;
  t1389 = my_piecewise5(t12, 0, t8, 0, -t1340);
  t1393 = my_piecewise3(t48, 0, 0.9e1 / 0.16e2 * t1000 * t1378 - 0.9e1 / 0.4e1 * t635 * t327 + 0.9e1 / 0.4e1 * t240 * t1383 + 0.3e1 * t282 * t696 + 0.3e1 / 0.2e1 * t49 * t1389);
  t1408 = -0.2e1 / 0.3e1 * t52 * t27 * (0.79369597216623554946e0 * sigma[2] * t145 * t62 - 0.36662920248684660554e-1 * t410 * t148 + 0.62059993955520629303e-3 * t349 * t881 * t355 - 0.44595355499553507184e-5 * t721 * t1361 * t727 + 0.11598973244461995009e-7 * t721 * sigma[2] / t1360 / t54 * t1371) - 0.2e1 / 0.3e1 * t3 * t1393 * t66 - 0.8e1 / 0.3e1 * t701 * t152 - 0.4e1 * t332 * t359 - 0.8e1 / 0.3e1 * t135 * t731 - 0.4e1 * t1314 - 0.4e1 / 0.3e1 * t1321 - 0.4e1 / 0.3e1 * t1304 - 0.4e1 * t1309 + t1217 + 0.2e1 * t1226 + t1238 - t1113 - t1124 + t1027;
  t1409 = my_piecewise3(t45, 0, t1408);
  tv4rho44 = 0.4e1 * t689 + 0.4e1 * t735 + t4 * (t1351 + t1409);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1415 = t199 * t368;
  t1418 = t78 * t745;
  t1420 = t78 * t748;
  t1426 = t24 * t477 * t166 / 0.4e1;
  t1428 = t24 * t208 * t381;
  t1431 = t24 * t82 * t764;
  t1453 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t463 * t167 - t1415 - 0.2e1 * t199 * t382 + t1418 / 0.2e1 - 0.2e1 * t1420 - 0.2e1 * t78 * t765 - t1426 + t1428 / 0.2e1 - t1431 - 0.2e1 / 0.3e1 * t24 * t27 * (-0.13228266202770592491e0 * t162 * t37 + 0.842256275983296256e-2 * t423 * t96 * sigma[0] - 0.16898118509206682978e-3 * t492 * t231 * t91 + 0.1362635862486357164e-5 * t498 * t502 * t225 - 0.3866324414820665003e-8 * t496 / t939 / t28 * t950));
  tv4rho3sigma0 = t4 * t1453 + 0.3e1 * t769;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1458 = t250 * t390;
  t1459 = t110 * t776;
  t1463 = t52 * t477 * t178 / 0.4e1;
  t1465 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t524 * t179 - t1458 + t1459 / 0.2e1 - t1463);
  tv4rho3sigma2 = t4 * t1465 + 0.3e1 * t780;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1467 = 0.2e1 * t791;
  t1471 = 0.2e1 / 0.3e1 * t271 * t368;
  t1474 = t125 * t745;
  t1477 = 0.2e1 / 0.3e1 * t125 * t748;
  t1485 = -0.2e1 / 0.3e1 * t555 * t167 - t1471 - 0.4e1 / 0.3e1 * t271 * t382 + t1474 / 0.6e1 - t1477 - 0.2e1 / 0.3e1 * t125 * t765 - t1415 / 0.3e1 + t1418 / 0.3e1 - 0.2e1 / 0.3e1 * t1420 - t1426 + t1428 / 0.3e1 - t1431 / 0.3e1;
  t1486 = my_piecewise3(t1, 0, t1485);
  tv4rho3sigma3 = t4 * t1486 + t1467 + t769;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1488 = 0.2e1 * t804;
  t1492 = 0.2e1 / 0.3e1 * t290 * t390;
  t1493 = t135 * t776;
  t1500 = 0.2e1 / 0.3e1 * t110 * t800;
  t1502 = t52 * t208 * t413;
  t1505 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t589 * t179 - t1492 + t1493 / 0.6e1 - t1458 / 0.3e1 + t1459 / 0.3e1 - t1463 - 0.2e1 / 0.3e1 * t250 * t414 - t1500 + t1502 / 0.6e1);
  tv4rho3sigma5 = t4 * t1505 + t1488 + t780;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t1509 = t317 * t368;
  t1517 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t623 * t167 - t1509 / 0.3e1 - 0.2e1 / 0.3e1 * t317 * t382 - t1471 + t1474 / 0.3e1 - t1477 + t1418 / 0.6e1 - t1426 + t1428 / 0.6e1);
  tv4rho3sigma6 = t4 * t1517 + t1467 + t811;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t1521 = t332 * t390;
  t1526 = t135 * t800;
  t1533 = t52 * t82 * t833;
  t1535 = -0.2e1 / 0.3e1 * t649 * t179 - t1521 / 0.3e1 - t1492 + t1493 / 0.3e1 - 0.4e1 / 0.3e1 * t290 * t414 - 0.2e1 / 0.3e1 * t1526 + t1459 / 0.6e1 - t1463 - t1500 + t1502 / 0.3e1 - 0.2e1 / 0.3e1 * t110 * t834 - t1533 / 0.3e1;
  t1536 = my_piecewise3(t45, 0, t1535);
  tv4rho3sigma8 = t4 * t1536 + t1488 + t838;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t1543 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t684 * t167 - t1509 + t1474 / 0.2e1 - t1426);
  tv4rho3sigma9 = t4 * t1543 + 0.3e1 * t811;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t1576 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t701 * t179 - t1521 - 0.2e1 * t332 * t414 + t1493 / 0.2e1 - 0.2e1 * t1526 - 0.2e1 * t135 * t834 - t1463 + t1502 / 0.2e1 - t1533 - 0.2e1 / 0.3e1 * t52 * t27 * (-0.13228266202770592491e0 * t174 * t62 + 0.842256275983296256e-2 * t435 * t148 * sigma[2] - 0.16898118509206682978e-3 * t717 * t355 * t143 + 0.1362635862486357164e-5 * t723 * t727 * t349 - 0.3866324414820665003e-8 * t721 / t1360 / t53 * t1371));
  tv4rho3sigma11 = t4 * t1576 + 0.3e1 * t838;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t1581 = t78 * t842;
  t1587 = t24 * t208 * t427 / 0.6e1;
  t1589 = t24 * t82 * t854;
  t1607 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t199 * t428 - 0.2e1 / 0.3e1 * t1581 - 0.4e1 / 0.3e1 * t78 * t855 + t1587 - 0.2e1 / 0.3e1 * t1589 - 0.2e1 / 0.3e1 * t24 * t27 * (-0.11560380258594262337e-2 * t753 + 0.37284104895758517604e-4 * t756 * sigma[0] - 0.38539196110725253122e-6 * t760 * t502 * t91 + 0.12887748049402216676e-8 * t225 / t939 / rho[0] * t950));
  tv4rho2sigma20 = t4 * t1607 + 0.2e1 * t859;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t1612 = t110 * t863;
  t1616 = t52 * t208 * t439 / 0.6e1;
  t1618 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t250 * t440 - 0.2e1 / 0.3e1 * t1612 + t1616);
  tv4rho2sigma25 = t4 * t1618 + 0.2e1 * t867;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t1622 = t125 * t842;
  t1629 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t271 * t428 - t1622 / 0.3e1 - 0.2e1 / 0.3e1 * t125 * t855 - t1581 / 0.3e1 + t1587 - t1589 / 0.3e1);
  tv4rho2sigma26 = t4 * t1629 + t859 + t872;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t1633 = t135 * t863;
  t1639 = t52 * t82 * t885;
  t1642 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t290 * t440 - t1633 / 0.3e1 - t1612 / 0.3e1 + t1616 - 0.2e1 / 0.3e1 * t110 * t886 - t1639 / 0.3e1);
  tv4rho2sigma211 = t4 * t1642 + t867 + t890;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t1649 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t317 * t428 - 0.2e1 / 0.3e1 * t1622 + t1587);
  tv4rho2sigma212 = t4 * t1649 + 0.2e1 * t872;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t1674 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t332 * t440 - 0.2e1 / 0.3e1 * t1633 - 0.4e1 / 0.3e1 * t135 * t886 + t1616 - 0.2e1 / 0.3e1 * t1639 - 0.2e1 / 0.3e1 * t52 * t27 * (-0.11560380258594262337e-2 * t822 + 0.37284104895758517604e-4 * t825 * sigma[2] - 0.38539196110725253122e-6 * t829 * t727 * t143 + 0.12887748049402216676e-8 * t349 / t1360 / rho[1] * t1371));
  tv4rho2sigma217 = t4 * t1674 + 0.2e1 * t890;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t1680 = t24 * t82 * t897 / 0.3e1;
  t1693 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t78 * t898 - t1680 - 0.2e1 / 0.3e1 * t24 * t27 * (-0.54122087751907525555e-5 * t846 + 0.96347990276813132804e-7 * t850 * t502 * sigma[0] - 0.42959160164674055589e-9 * t91 * t940 * t950));
  tv4rhosigma30 = t4 * t1693 + t901;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t1699 = t52 * t82 * t907 / 0.3e1;
  t1701 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t110 * t908 - t1699);
  tv4rhosigma39 = t4 * t1701 + t911;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t1706 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t125 * t898 - t1680);
  tv4rhosigma310 = t4 * t1706 + t901;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t1722 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t135 * t908 - t1699 - 0.2e1 / 0.3e1 * t52 * t27 * (-0.54122087751907525555e-5 * t877 + 0.96347990276813132804e-7 * t881 * t727 * sigma[2] - 0.42959160164674055589e-9 * t143 * t1361 * t1371));
  tv4rhosigma319 = t4 * t1722 + t911;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t1733 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t27 * (-0.18351998147964406248e-7 * t492 * t502 + 0.14319720054891351863e-9 * sigma[0] * t498 * t950));
  tv4sigma40 = t4 * t1733;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t1743 = my_piecewise3(t45, 0, -0.2e1 / 0.3e1 * t52 * t27 * (-0.18351998147964406248e-7 * t717 * t727 + 0.14319720054891351863e-9 * sigma[2] * t723 * t1371));
  tv4sigma414 = t4 * t1743;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

