/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : hyb_gga_xc_case21.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t16, t18, t19, t20, t21;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t38, t39, t43, t44, t48;
  double t50, t51, t52, t53, t54, t55, t57, t58;
  double t59, t63, t64, t65, t66, t67, t70, t72;
  double t73, t76, t78, t79, t80, t82, t84, t87;
  double t88, t91, t97, t99, t104, t107, t108, t112;
  double t114, t115, t118, t119, t120, tzk0;

  hyb_gga_xc_case21_params *params;

  assert(p->params != NULL);
  params = (hyb_gga_xc_case21_params * )(p->params);

  t1 = 0.1e1 - params->ax;
  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * p->zeta_threshold;
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t15, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = M_CBRT6;
  t23 = M_PI * M_PI;
  t24 = POW_1_3(t23);
  t25 = t24 * t24;
  t26 = 0.1e1 / t25;
  t27 = params->gammax * t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = sigma[0] * t29;
  t31 = rho[0] * rho[0];
  t32 = t19 * t19;
  t34 = 0.1e1 / t32 / t31;
  t38 = 0.1e1 + t27 * t30 * t34 / 0.24e2;
  t39 = 0.1e1 / t38;
  t43 = t27 * t30 * t34 * t39 / 0.24e2;
  t44 = xbspline(t43, 0, params);
  t48 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t44);
  t50 = 0.2e1 * t1 * t48;
  t51 = t14 * t14;
  t52 = my_piecewise3(t8, t51, 1);
  t53 = t4 * t4;
  t54 = t52 * t53;
  t55 = t54 * t5;
  t57 = 0.1e1 / t19 / t31;
  t58 = sigma[0] * t57;
  t59 = t5 * sigma[0];
  t63 = 0.1e1 / M_PI;
  t64 = POW_1_3(t63);
  t65 = t4 * t64;
  t66 = M_CBRT4;
  t67 = t66 * t66;
  t70 = t65 * t67 / t19;
  t72 = 0.1e1 + 0.53425e-1 * t70;
  t73 = sqrt(t70);
  t76 = POW_3_2(t70);
  t78 = t64 * t64;
  t79 = t53 * t78;
  t80 = 0.1e1 / t32;
  t82 = t79 * t66 * t80;
  t84 = 0.379785e1 * t73 + 0.8969e0 * t70 + 0.204775e0 * t76 + 0.123235e0 * t82;
  t87 = 0.1e1 + 0.16081979498692535067e2 / t84;
  t88 = log(t87);
  t91 = my_piecewise3(t8, t15, 1);
  t97 = (0.2e1 * t91 - 0.2e1) / (0.2e1 * t28 - 0.2e1);
  t99 = 0.1e1 + 0.278125e-1 * t70;
  t104 = 0.51785e1 * t73 + 0.905775e0 * t70 + 0.1100325e0 * t76 + 0.1241775e0 * t82;
  t107 = 0.1e1 + 0.29608749977793437516e2 / t104;
  t108 = log(t107);
  t112 = -0.621814e-1 * t72 * t88 + 0.19751673498613801407e-1 * t97 * t99 * t108;
  t114 = -t54 * t59 * t57 / 0.48e2 + params->gammac * t112;
  t115 = 0.1e1 / t114;
  t118 = t55 * t58 * t115 / 0.48e2;
  t119 = cbspline(-t118, 0, params);
  t120 = t119 * t112;
  tzk0 = t50 + t120;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t16, t18, t19, t20, t21;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t38, t39, t43, t44, t48;
  double t50, t51, t52, t53, t54, t55, t57, t58;
  double t59, t63, t64, t65, t66, t67, t70, t72;
  double t73, t76, t78, t79, t80, t82, t84, t87;
  double t88, t91, t97, t99, t104, t107, t108, t112;
  double t114, t115, t118, t119, t120, tzk0;

  double t125, t126, t127, t128, t130, t135, t136, t139;
  double t140, t141, t142, t143, t144, t146, t147, t148;
  double t153, t158, t159, t161, t163, t164, t168, t169;
  double t174, t175, t179, t180, t181, t183, t184, t185;
  double t186, t188, t190, t191, t192, t195, t197, t199;
  double t200, t201, t204, t209, t210, t211, t216, t218;
  double t219, t222, t224, t225, t229, t230, t231, t232;
  double tvrho0, t240, t242, t247, t251, t253, t258, t259;
  double t260, t261, t263, t264, t268, t269, t270, tvsigma0;

  hyb_gga_xc_case21_params *params;

  assert(p->params != NULL);
  params = (hyb_gga_xc_case21_params * )(p->params);

  t1 = 0.1e1 - params->ax;
  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * p->zeta_threshold;
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t15, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = M_CBRT6;
  t23 = M_PI * M_PI;
  t24 = POW_1_3(t23);
  t25 = t24 * t24;
  t26 = 0.1e1 / t25;
  t27 = params->gammax * t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = sigma[0] * t29;
  t31 = rho[0] * rho[0];
  t32 = t19 * t19;
  t34 = 0.1e1 / t32 / t31;
  t38 = 0.1e1 + t27 * t30 * t34 / 0.24e2;
  t39 = 0.1e1 / t38;
  t43 = t27 * t30 * t34 * t39 / 0.24e2;
  t44 = xbspline(t43, 0, params);
  t48 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t44);
  t50 = 0.2e1 * t1 * t48;
  t51 = t14 * t14;
  t52 = my_piecewise3(t8, t51, 1);
  t53 = t4 * t4;
  t54 = t52 * t53;
  t55 = t54 * t5;
  t57 = 0.1e1 / t19 / t31;
  t58 = sigma[0] * t57;
  t59 = t5 * sigma[0];
  t63 = 0.1e1 / M_PI;
  t64 = POW_1_3(t63);
  t65 = t4 * t64;
  t66 = M_CBRT4;
  t67 = t66 * t66;
  t70 = t65 * t67 / t19;
  t72 = 0.1e1 + 0.53425e-1 * t70;
  t73 = sqrt(t70);
  t76 = POW_3_2(t70);
  t78 = t64 * t64;
  t79 = t53 * t78;
  t80 = 0.1e1 / t32;
  t82 = t79 * t66 * t80;
  t84 = 0.379785e1 * t73 + 0.8969e0 * t70 + 0.204775e0 * t76 + 0.123235e0 * t82;
  t87 = 0.1e1 + 0.16081979498692535067e2 / t84;
  t88 = log(t87);
  t91 = my_piecewise3(t8, t15, 1);
  t97 = (0.2e1 * t91 - 0.2e1) / (0.2e1 * t28 - 0.2e1);
  t99 = 0.1e1 + 0.278125e-1 * t70;
  t104 = 0.51785e1 * t73 + 0.905775e0 * t70 + 0.1100325e0 * t76 + 0.1241775e0 * t82;
  t107 = 0.1e1 + 0.29608749977793437516e2 / t104;
  t108 = log(t107);
  t112 = -0.621814e-1 * t72 * t88 + 0.19751673498613801407e-1 * t97 * t99 * t108;
  t114 = -t54 * t59 * t57 / 0.48e2 + params->gammac * t112;
  t115 = 0.1e1 / t114;
  t118 = t55 * t58 * t115 / 0.48e2;
  t119 = cbspline(-t118, 0, params);
  t120 = t119 * t112;
  tzk0 = t50 + t120;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = t7 * t18;
  t126 = xbspline(t43, 1, params);
  t127 = t19 * t126;
  t128 = t31 * rho[0];
  t130 = 0.1e1 / t32 / t128;
  t135 = params->gammax * params->gammax;
  t136 = t21 * t21;
  t139 = 0.1e1 / t24 / t23;
  t140 = t135 * t136 * t139;
  t141 = sigma[0] * sigma[0];
  t142 = t141 * t28;
  t143 = t31 * t31;
  t144 = t143 * t31;
  t146 = 0.1e1 / t19 / t144;
  t147 = t38 * t38;
  t148 = 0.1e1 / t147;
  t153 = -t27 * t30 * t130 * t39 / 0.9e1 + t140 * t142 * t146 * t148 / 0.108e3;
  t158 = my_piecewise3(t3, 0, -t7 * t18 * t80 * t44 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t127 * t153);
  t159 = t1 * t158;
  t161 = cbspline(-t118, 1, params);
  t163 = 0.1e1 / t19 / t128;
  t164 = sigma[0] * t163;
  t168 = t114 * t114;
  t169 = 0.1e1 / t168;
  t174 = 0.1e1 / t19 / rho[0];
  t175 = t67 * t174;
  t179 = t84 * t84;
  t180 = 0.1e1 / t179;
  t181 = t72 * t180;
  t183 = 0.1e1 / t73 * t4;
  t184 = t64 * t67;
  t185 = t184 * t174;
  t186 = t183 * t185;
  t188 = t65 * t175;
  t190 = sqrt(t70);
  t191 = t190 * t4;
  t192 = t191 * t185;
  t195 = 0.1e1 / t32 / rho[0];
  t197 = t79 * t66 * t195;
  t199 = -0.632975e0 * t186 - 0.29896666666666666667e0 * t188 - 0.1023875e0 * t192 - 0.82156666666666666667e-1 * t197;
  t200 = 0.1e1 / t87;
  t201 = t199 * t200;
  t204 = t97 * t4;
  t209 = t97 * t99;
  t210 = t104 * t104;
  t211 = 0.1e1 / t210;
  t216 = -0.86308333333333333334e0 * t186 - 0.301925e0 * t188 - 0.5501625e-1 * t192 - 0.82785e-1 * t197;
  t218 = 0.1e1 / t107;
  t219 = t211 * t216 * t218;
  t222 = 0.11073470983333333333e-2 * t65 * t175 * t88 + 0.1e1 * t181 * t201 - 0.18311447306006545054e-3 * t204 * t184 * t174 * t108 - 0.5848223622634646207e0 * t209 * t219;
  t224 = 0.7e1 / 0.144e3 * t54 * t59 * t163 + params->gammac * t222;
  t225 = t169 * t224;
  t229 = 0.7e1 / 0.144e3 * t55 * t164 * t115 + t55 * t58 * t225 / 0.48e2;
  t230 = t161 * t229;
  t231 = t230 * t112;
  t232 = t119 * t222;
  tvrho0 = t50 + t120 + rho[0] * (0.2e1 * t159 + t231 + t232);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t240 = t143 * rho[0];
  t242 = 0.1e1 / t19 / t240;
  t247 = t27 * t29 * t34 * t39 / 0.24e2 - t140 * sigma[0] * t28 * t242 * t148 / 0.288e3;
  t251 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t125 * t127 * t247);
  t253 = 0.2e1 * t1 * t251;
  t258 = t52 * t52;
  t259 = t258 * t4;
  t260 = t5 * t5;
  t261 = t259 * t260;
  t263 = 0.1e1 / t32 / t143;
  t264 = sigma[0] * t263;
  t268 = -t54 * t5 * t57 * t115 / 0.48e2 - t261 * t264 * t169 / 0.768e3;
  t269 = t161 * t268;
  t270 = t269 * t112;
  tvsigma0 = rho[0] * (t253 + t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t16, t18, t19, t20, t21;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t38, t39, t43, t44, t48;
  double t50, t51, t52, t53, t54, t55, t57, t58;
  double t59, t63, t64, t65, t66, t67, t70, t72;
  double t73, t76, t78, t79, t80, t82, t84, t87;
  double t88, t91, t97, t99, t104, t107, t108, t112;
  double t114, t115, t118, t119, t120, tzk0;

  double t125, t126, t127, t128, t130, t135, t136, t139;
  double t140, t141, t142, t143, t144, t146, t147, t148;
  double t153, t158, t159, t161, t163, t164, t168, t169;
  double t174, t175, t179, t180, t181, t183, t184, t185;
  double t186, t188, t190, t191, t192, t195, t197, t199;
  double t200, t201, t204, t209, t210, t211, t216, t218;
  double t219, t222, t224, t225, t229, t230, t231, t232;
  double tvrho0, t240, t242, t247, t251, t253, t258, t259;
  double t260, t261, t263, t264, t268, t269, t270, tvsigma0;

  double t279, t283, t284, t285, t293, t295, t301, t302;
  double t303, t304, t305, t306, t307, t310, t314, t319;
  double t320, t322, t323, t324, t325, t327, t328, t336;
  double t337, t338, t345, t349, t350, t354, t355, t356;
  double t357, t358, t363, t364, t365, t366, t368, t369;
  double t371, t373, t374, t375, t377, t380, t382, t383;
  double t386, t387, t388, t389, t390, t391, t398, t402;
  double t403, t404, t406, t415, t417, t420, t421, t422;
  double t423, t424, t425, t428, t430, t431, t435, t436;
  double t437, t438, t440, tv2rho20, t446, t454, t455, t459;
  double t460, t465, t470, t471, t473, t474, t475, t480;
  double t485, t486, t490, t494, t495, t496, t497, tv2rhosigma0;
  double t500, t507, t508, t512, t517, t519, t520, t521;
  double t522, t528, t529, t534, t535, t536, tv2sigma20;

  hyb_gga_xc_case21_params *params;

  assert(p->params != NULL);
  params = (hyb_gga_xc_case21_params * )(p->params);

  t1 = 0.1e1 - params->ax;
  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * p->zeta_threshold;
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t15, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = M_CBRT6;
  t23 = M_PI * M_PI;
  t24 = POW_1_3(t23);
  t25 = t24 * t24;
  t26 = 0.1e1 / t25;
  t27 = params->gammax * t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = sigma[0] * t29;
  t31 = rho[0] * rho[0];
  t32 = t19 * t19;
  t34 = 0.1e1 / t32 / t31;
  t38 = 0.1e1 + t27 * t30 * t34 / 0.24e2;
  t39 = 0.1e1 / t38;
  t43 = t27 * t30 * t34 * t39 / 0.24e2;
  t44 = xbspline(t43, 0, params);
  t48 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t44);
  t50 = 0.2e1 * t1 * t48;
  t51 = t14 * t14;
  t52 = my_piecewise3(t8, t51, 1);
  t53 = t4 * t4;
  t54 = t52 * t53;
  t55 = t54 * t5;
  t57 = 0.1e1 / t19 / t31;
  t58 = sigma[0] * t57;
  t59 = t5 * sigma[0];
  t63 = 0.1e1 / M_PI;
  t64 = POW_1_3(t63);
  t65 = t4 * t64;
  t66 = M_CBRT4;
  t67 = t66 * t66;
  t70 = t65 * t67 / t19;
  t72 = 0.1e1 + 0.53425e-1 * t70;
  t73 = sqrt(t70);
  t76 = POW_3_2(t70);
  t78 = t64 * t64;
  t79 = t53 * t78;
  t80 = 0.1e1 / t32;
  t82 = t79 * t66 * t80;
  t84 = 0.379785e1 * t73 + 0.8969e0 * t70 + 0.204775e0 * t76 + 0.123235e0 * t82;
  t87 = 0.1e1 + 0.16081979498692535067e2 / t84;
  t88 = log(t87);
  t91 = my_piecewise3(t8, t15, 1);
  t97 = (0.2e1 * t91 - 0.2e1) / (0.2e1 * t28 - 0.2e1);
  t99 = 0.1e1 + 0.278125e-1 * t70;
  t104 = 0.51785e1 * t73 + 0.905775e0 * t70 + 0.1100325e0 * t76 + 0.1241775e0 * t82;
  t107 = 0.1e1 + 0.29608749977793437516e2 / t104;
  t108 = log(t107);
  t112 = -0.621814e-1 * t72 * t88 + 0.19751673498613801407e-1 * t97 * t99 * t108;
  t114 = -t54 * t59 * t57 / 0.48e2 + params->gammac * t112;
  t115 = 0.1e1 / t114;
  t118 = t55 * t58 * t115 / 0.48e2;
  t119 = cbspline(-t118, 0, params);
  t120 = t119 * t112;
  tzk0 = t50 + t120;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = t7 * t18;
  t126 = xbspline(t43, 1, params);
  t127 = t19 * t126;
  t128 = t31 * rho[0];
  t130 = 0.1e1 / t32 / t128;
  t135 = params->gammax * params->gammax;
  t136 = t21 * t21;
  t139 = 0.1e1 / t24 / t23;
  t140 = t135 * t136 * t139;
  t141 = sigma[0] * sigma[0];
  t142 = t141 * t28;
  t143 = t31 * t31;
  t144 = t143 * t31;
  t146 = 0.1e1 / t19 / t144;
  t147 = t38 * t38;
  t148 = 0.1e1 / t147;
  t153 = -t27 * t30 * t130 * t39 / 0.9e1 + t140 * t142 * t146 * t148 / 0.108e3;
  t158 = my_piecewise3(t3, 0, -t7 * t18 * t80 * t44 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t127 * t153);
  t159 = t1 * t158;
  t161 = cbspline(-t118, 1, params);
  t163 = 0.1e1 / t19 / t128;
  t164 = sigma[0] * t163;
  t168 = t114 * t114;
  t169 = 0.1e1 / t168;
  t174 = 0.1e1 / t19 / rho[0];
  t175 = t67 * t174;
  t179 = t84 * t84;
  t180 = 0.1e1 / t179;
  t181 = t72 * t180;
  t183 = 0.1e1 / t73 * t4;
  t184 = t64 * t67;
  t185 = t184 * t174;
  t186 = t183 * t185;
  t188 = t65 * t175;
  t190 = sqrt(t70);
  t191 = t190 * t4;
  t192 = t191 * t185;
  t195 = 0.1e1 / t32 / rho[0];
  t197 = t79 * t66 * t195;
  t199 = -0.632975e0 * t186 - 0.29896666666666666667e0 * t188 - 0.1023875e0 * t192 - 0.82156666666666666667e-1 * t197;
  t200 = 0.1e1 / t87;
  t201 = t199 * t200;
  t204 = t97 * t4;
  t209 = t97 * t99;
  t210 = t104 * t104;
  t211 = 0.1e1 / t210;
  t216 = -0.86308333333333333334e0 * t186 - 0.301925e0 * t188 - 0.5501625e-1 * t192 - 0.82785e-1 * t197;
  t218 = 0.1e1 / t107;
  t219 = t211 * t216 * t218;
  t222 = 0.11073470983333333333e-2 * t65 * t175 * t88 + 0.1e1 * t181 * t201 - 0.18311447306006545054e-3 * t204 * t184 * t174 * t108 - 0.5848223622634646207e0 * t209 * t219;
  t224 = 0.7e1 / 0.144e3 * t54 * t59 * t163 + params->gammac * t222;
  t225 = t169 * t224;
  t229 = 0.7e1 / 0.144e3 * t55 * t164 * t115 + t55 * t58 * t225 / 0.48e2;
  t230 = t161 * t229;
  t231 = t230 * t112;
  t232 = t119 * t222;
  tvrho0 = t50 + t120 + rho[0] * (0.2e1 * t159 + t231 + t232);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t240 = t143 * rho[0];
  t242 = 0.1e1 / t19 / t240;
  t247 = t27 * t29 * t34 * t39 / 0.24e2 - t140 * sigma[0] * t28 * t242 * t148 / 0.288e3;
  t251 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t125 * t127 * t247);
  t253 = 0.2e1 * t1 * t251;
  t258 = t52 * t52;
  t259 = t258 * t4;
  t260 = t5 * t5;
  t261 = t259 * t260;
  t263 = 0.1e1 / t32 / t143;
  t264 = sigma[0] * t263;
  t268 = -t54 * t5 * t57 * t115 / 0.48e2 - t261 * t264 * t169 / 0.768e3;
  t269 = t161 * t268;
  t270 = t269 * t112;
  tvsigma0 = rho[0] * (t253 + t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t279 = t80 * t126;
  t283 = xbspline(t43, 2, params);
  t284 = t19 * t283;
  t285 = t153 * t153;
  t293 = t143 * t128;
  t295 = 0.1e1 / t19 / t293;
  t301 = t23 * t23;
  t302 = 0.1e1 / t301;
  t303 = t135 * params->gammax * t302;
  t304 = t141 * sigma[0];
  t305 = t143 * t143;
  t306 = t305 * t31;
  t307 = 0.1e1 / t306;
  t310 = 0.1e1 / t147 / t38;
  t314 = 0.11e2 / 0.27e2 * t27 * t30 * t263 * t39 - t140 * t142 * t295 * t148 / 0.12e2 + 0.2e1 / 0.81e2 * t303 * t304 * t307 * t310;
  t319 = my_piecewise3(t3, 0, t7 * t18 * t195 * t44 / 0.12e2 - t125 * t279 * t153 / 0.4e1 - 0.3e1 / 0.8e1 * t125 * t284 * t285 - 0.3e1 / 0.8e1 * t125 * t127 * t314);
  t320 = t1 * t319;
  t322 = cbspline(-t118, 2, params);
  t323 = t229 * t229;
  t324 = t322 * t323;
  t325 = t324 * t112;
  t327 = 0.1e1 / t19 / t143;
  t328 = sigma[0] * t327;
  t336 = 0.1e1 / t168 / t114;
  t337 = t224 * t224;
  t338 = t336 * t337;
  t345 = t67 * t57;
  t349 = t65 * t67;
  t350 = t174 * t180;
  t354 = t179 * t84;
  t355 = 0.1e1 / t354;
  t356 = t72 * t355;
  t357 = t199 * t199;
  t358 = t357 * t200;
  t363 = 0.1e1 / t73 / t70 * t53;
  t364 = t78 * t66;
  t365 = t364 * t34;
  t366 = t363 * t365;
  t368 = t184 * t57;
  t369 = t183 * t368;
  t371 = t65 * t345;
  t373 = 0.1e1/sqrt(t70);
  t374 = t373 * t53;
  t375 = t374 * t365;
  t377 = t191 * t368;
  t380 = t79 * t66 * t34;
  t382 = -0.42198333333333333333e0 * t366 + 0.84396666666666666666e0 * t369 + 0.39862222222222222223e0 * t371 + 0.68258333333333333333e-1 * t375 + 0.13651666666666666667e0 * t377 + 0.13692777777777777778e0 * t380;
  t383 = t382 * t200;
  t386 = t179 * t179;
  t387 = 0.1e1 / t386;
  t388 = t72 * t387;
  t389 = t87 * t87;
  t390 = 0.1e1 / t389;
  t391 = t357 * t390;
  t398 = t97 * t65;
  t402 = t210 * t104;
  t403 = 0.1e1 / t402;
  t404 = t216 * t216;
  t406 = t403 * t404 * t218;
  t415 = -0.57538888888888888889e0 * t366 + 0.11507777777777777778e1 * t369 + 0.40256666666666666667e0 * t371 + 0.366775e-1 * t375 + 0.73355e-1 * t377 + 0.137975e0 * t380;
  t417 = t211 * t415 * t218;
  t420 = t210 * t210;
  t421 = 0.1e1 / t420;
  t422 = t421 * t404;
  t423 = t107 * t107;
  t424 = 0.1e1 / t423;
  t425 = t422 * t424;
  t428 = -0.14764627977777777777e-2 * t65 * t345 * t88 - 0.35616666666666666666e-1 * t349 * t350 * t201 - 0.2e1 * t356 * t358 + 0.1e1 * t181 * t383 + 0.16081979498692535067e2 * t388 * t391 + 0.24415263074675393405e-3 * t204 * t184 * t57 * t108 + 0.10843581300301739842e-1 * t398 * t175 * t219 + 0.11696447245269292414e1 * t209 * t406 - 0.5848223622634646207e0 * t209 * t417 - 0.17315859105681463759e2 * t209 * t425;
  t430 = -0.35e2 / 0.216e3 * t54 * t59 * t327 + params->gammac * t428;
  t431 = t169 * t430;
  t435 = -0.35e2 / 0.216e3 * t55 * t328 * t115 - 0.7e1 / 0.72e2 * t55 * t164 * t225 - t55 * t58 * t338 / 0.24e2 + t55 * t58 * t431 / 0.48e2;
  t436 = t161 * t435;
  t437 = t436 * t112;
  t438 = t230 * t222;
  t440 = t119 * t428;
  tv2rho20 = 0.4e1 * t159 + 0.2e1 * t231 + 0.2e1 * t232 + rho[0] * (0.2e1 * t320 + t325 + t437 + 0.2e1 * t438 + t440);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t446 = t153 * t247;
  t454 = t28 * t146;
  t455 = t148 * sigma[0];
  t459 = t305 * rho[0];
  t460 = 0.1e1 / t459;
  t465 = -t27 * t29 * t130 * t39 / 0.9e1 + t140 * t454 * t455 / 0.36e2 - t303 * t141 * t460 * t310 / 0.108e3;
  t470 = my_piecewise3(t3, 0, -t125 * t279 * t247 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t284 * t446 - 0.3e1 / 0.8e1 * t125 * t127 * t465);
  t471 = t1 * t470;
  t473 = t322 * t229;
  t474 = t268 * t112;
  t475 = t473 * t474;
  t480 = t57 * t169;
  t485 = 0.1e1 / t32 / t240;
  t486 = sigma[0] * t485;
  t490 = t336 * t224;
  t494 = 0.7e1 / 0.144e3 * t54 * t5 * t163 * t115 + t55 * t480 * t224 / 0.48e2 + 0.7e1 / 0.1152e4 * t261 * t486 * t169 + t261 * t264 * t490 / 0.384e3;
  t495 = t161 * t494;
  t496 = t495 * t112;
  t497 = t269 * t222;
  tv2rhosigma0 = t253 + t270 + rho[0] * (0.2e1 * t471 + t475 + t496 + t497);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t500 = t247 * t247;
  t507 = 0.1e1 / t305;
  t508 = sigma[0] * t507;
  t512 = -t140 * t28 * t242 * t148 / 0.144e3 + t303 * t508 * t310 / 0.288e3;
  t517 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t125 * t127 * t512 - 0.3e1 / 0.8e1 * t125 * t284 * t500);
  t519 = 0.2e1 * t1 * t517;
  t520 = t268 * t268;
  t521 = t322 * t520;
  t522 = t521 * t112;
  t528 = t258 * t52 * M_PI;
  t529 = 0.1e1 / t293;
  t534 = -t259 * t260 * t263 * t169 / 0.384e3 - t528 * sigma[0] * t529 * t336 / 0.6144e4;
  t535 = t161 * t534;
  t536 = t535 * t112;
  tv2sigma20 = rho[0] * (t519 + t522 + t536);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t16, t18, t19, t20, t21;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t38, t39, t43, t44, t48;
  double t50, t51, t52, t53, t54, t55, t57, t58;
  double t59, t63, t64, t65, t66, t67, t70, t72;
  double t73, t76, t78, t79, t80, t82, t84, t87;
  double t88, t91, t97, t99, t104, t107, t108, t112;
  double t114, t115, t118, t119, t120, tzk0;

  double t125, t126, t127, t128, t130, t135, t136, t139;
  double t140, t141, t142, t143, t144, t146, t147, t148;
  double t153, t158, t159, t161, t163, t164, t168, t169;
  double t174, t175, t179, t180, t181, t183, t184, t185;
  double t186, t188, t190, t191, t192, t195, t197, t199;
  double t200, t201, t204, t209, t210, t211, t216, t218;
  double t219, t222, t224, t225, t229, t230, t231, t232;
  double tvrho0, t240, t242, t247, t251, t253, t258, t259;
  double t260, t261, t263, t264, t268, t269, t270, tvsigma0;

  double t279, t283, t284, t285, t293, t295, t301, t302;
  double t303, t304, t305, t306, t307, t310, t314, t319;
  double t320, t322, t323, t324, t325, t327, t328, t336;
  double t337, t338, t345, t349, t350, t354, t355, t356;
  double t357, t358, t363, t364, t365, t366, t368, t369;
  double t371, t373, t374, t375, t377, t380, t382, t383;
  double t386, t387, t388, t389, t390, t391, t398, t402;
  double t403, t404, t406, t415, t417, t420, t421, t422;
  double t423, t424, t425, t428, t430, t431, t435, t436;
  double t437, t438, t440, tv2rho20, t446, t454, t455, t459;
  double t460, t465, t470, t471, t473, t474, t475, t480;
  double t485, t486, t490, t494, t495, t496, t497, tv2rhosigma0;
  double t500, t507, t508, t512, t517, t519, t520, t521;
  double t522, t528, t529, t534, t535, t536, tv2sigma20;

  double t547, t551, t558, t559, t560, t564, t573, t578;
  double t579, t584, t585, t586, t587, t589, t592, t593;
  double t595, t596, t599, t604, t605, t607, t608, t609;
  double t610, t611, t612, t614, t616, t629, t630, t631;
  double t632, t636, t637, t638, t639, t646, t647, t650;
  double t651, t657, t658, t659, t661, t662, t664, t665;
  double t667, t668, t670, t671, t672, t674, t676, t679;
  double t681, t683, t687, t689, t696, t701, t705, t709;
  double t716, t720, t724, t728, t729, t733, t734, t735;
  double t746, t747, t751, t752, t754, t755, t778, t779;
  double t781, t782, t786, t787, t788, t789, t791, t793;
  double tv3rho30, t809, t813, t817, t825, t829, t833, t835;
  double t840, t845, t846, t848, t849, t850, t851, t852;
  double t853, t855, t856, t862, t873, t874, t881, t885;
  double t889, t890, t891, t892, t894, tv3rho2sigma0, t900, t904;
  double t911, t918, t923, t928, t933, t934, t936, t937;
  double t938, t939, t940, t942, t943, t944, t949, t956;
  double t957, t958, t961, t962, t963, t964, tv3rhosigma20, t967;
  double t971, t979, t984, t989, t991, t992, t993, t994;
  double t996, t1000, t1002, t1003, t1005, t1007, t1010, t1011;
  double t1012, tv3sigma30;

  hyb_gga_xc_case21_params *params;

  assert(p->params != NULL);
  params = (hyb_gga_xc_case21_params * )(p->params);

  t1 = 0.1e1 - params->ax;
  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * p->zeta_threshold;
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t15, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = M_CBRT6;
  t23 = M_PI * M_PI;
  t24 = POW_1_3(t23);
  t25 = t24 * t24;
  t26 = 0.1e1 / t25;
  t27 = params->gammax * t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = sigma[0] * t29;
  t31 = rho[0] * rho[0];
  t32 = t19 * t19;
  t34 = 0.1e1 / t32 / t31;
  t38 = 0.1e1 + t27 * t30 * t34 / 0.24e2;
  t39 = 0.1e1 / t38;
  t43 = t27 * t30 * t34 * t39 / 0.24e2;
  t44 = xbspline(t43, 0, params);
  t48 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t44);
  t50 = 0.2e1 * t1 * t48;
  t51 = t14 * t14;
  t52 = my_piecewise3(t8, t51, 1);
  t53 = t4 * t4;
  t54 = t52 * t53;
  t55 = t54 * t5;
  t57 = 0.1e1 / t19 / t31;
  t58 = sigma[0] * t57;
  t59 = t5 * sigma[0];
  t63 = 0.1e1 / M_PI;
  t64 = POW_1_3(t63);
  t65 = t4 * t64;
  t66 = M_CBRT4;
  t67 = t66 * t66;
  t70 = t65 * t67 / t19;
  t72 = 0.1e1 + 0.53425e-1 * t70;
  t73 = sqrt(t70);
  t76 = POW_3_2(t70);
  t78 = t64 * t64;
  t79 = t53 * t78;
  t80 = 0.1e1 / t32;
  t82 = t79 * t66 * t80;
  t84 = 0.379785e1 * t73 + 0.8969e0 * t70 + 0.204775e0 * t76 + 0.123235e0 * t82;
  t87 = 0.1e1 + 0.16081979498692535067e2 / t84;
  t88 = log(t87);
  t91 = my_piecewise3(t8, t15, 1);
  t97 = (0.2e1 * t91 - 0.2e1) / (0.2e1 * t28 - 0.2e1);
  t99 = 0.1e1 + 0.278125e-1 * t70;
  t104 = 0.51785e1 * t73 + 0.905775e0 * t70 + 0.1100325e0 * t76 + 0.1241775e0 * t82;
  t107 = 0.1e1 + 0.29608749977793437516e2 / t104;
  t108 = log(t107);
  t112 = -0.621814e-1 * t72 * t88 + 0.19751673498613801407e-1 * t97 * t99 * t108;
  t114 = -t54 * t59 * t57 / 0.48e2 + params->gammac * t112;
  t115 = 0.1e1 / t114;
  t118 = t55 * t58 * t115 / 0.48e2;
  t119 = cbspline(-t118, 0, params);
  t120 = t119 * t112;
  tzk0 = t50 + t120;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = t7 * t18;
  t126 = xbspline(t43, 1, params);
  t127 = t19 * t126;
  t128 = t31 * rho[0];
  t130 = 0.1e1 / t32 / t128;
  t135 = params->gammax * params->gammax;
  t136 = t21 * t21;
  t139 = 0.1e1 / t24 / t23;
  t140 = t135 * t136 * t139;
  t141 = sigma[0] * sigma[0];
  t142 = t141 * t28;
  t143 = t31 * t31;
  t144 = t143 * t31;
  t146 = 0.1e1 / t19 / t144;
  t147 = t38 * t38;
  t148 = 0.1e1 / t147;
  t153 = -t27 * t30 * t130 * t39 / 0.9e1 + t140 * t142 * t146 * t148 / 0.108e3;
  t158 = my_piecewise3(t3, 0, -t7 * t18 * t80 * t44 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t127 * t153);
  t159 = t1 * t158;
  t161 = cbspline(-t118, 1, params);
  t163 = 0.1e1 / t19 / t128;
  t164 = sigma[0] * t163;
  t168 = t114 * t114;
  t169 = 0.1e1 / t168;
  t174 = 0.1e1 / t19 / rho[0];
  t175 = t67 * t174;
  t179 = t84 * t84;
  t180 = 0.1e1 / t179;
  t181 = t72 * t180;
  t183 = 0.1e1 / t73 * t4;
  t184 = t64 * t67;
  t185 = t184 * t174;
  t186 = t183 * t185;
  t188 = t65 * t175;
  t190 = sqrt(t70);
  t191 = t190 * t4;
  t192 = t191 * t185;
  t195 = 0.1e1 / t32 / rho[0];
  t197 = t79 * t66 * t195;
  t199 = -0.632975e0 * t186 - 0.29896666666666666667e0 * t188 - 0.1023875e0 * t192 - 0.82156666666666666667e-1 * t197;
  t200 = 0.1e1 / t87;
  t201 = t199 * t200;
  t204 = t97 * t4;
  t209 = t97 * t99;
  t210 = t104 * t104;
  t211 = 0.1e1 / t210;
  t216 = -0.86308333333333333334e0 * t186 - 0.301925e0 * t188 - 0.5501625e-1 * t192 - 0.82785e-1 * t197;
  t218 = 0.1e1 / t107;
  t219 = t211 * t216 * t218;
  t222 = 0.11073470983333333333e-2 * t65 * t175 * t88 + 0.1e1 * t181 * t201 - 0.18311447306006545054e-3 * t204 * t184 * t174 * t108 - 0.5848223622634646207e0 * t209 * t219;
  t224 = 0.7e1 / 0.144e3 * t54 * t59 * t163 + params->gammac * t222;
  t225 = t169 * t224;
  t229 = 0.7e1 / 0.144e3 * t55 * t164 * t115 + t55 * t58 * t225 / 0.48e2;
  t230 = t161 * t229;
  t231 = t230 * t112;
  t232 = t119 * t222;
  tvrho0 = t50 + t120 + rho[0] * (0.2e1 * t159 + t231 + t232);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t240 = t143 * rho[0];
  t242 = 0.1e1 / t19 / t240;
  t247 = t27 * t29 * t34 * t39 / 0.24e2 - t140 * sigma[0] * t28 * t242 * t148 / 0.288e3;
  t251 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t125 * t127 * t247);
  t253 = 0.2e1 * t1 * t251;
  t258 = t52 * t52;
  t259 = t258 * t4;
  t260 = t5 * t5;
  t261 = t259 * t260;
  t263 = 0.1e1 / t32 / t143;
  t264 = sigma[0] * t263;
  t268 = -t54 * t5 * t57 * t115 / 0.48e2 - t261 * t264 * t169 / 0.768e3;
  t269 = t161 * t268;
  t270 = t269 * t112;
  tvsigma0 = rho[0] * (t253 + t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t279 = t80 * t126;
  t283 = xbspline(t43, 2, params);
  t284 = t19 * t283;
  t285 = t153 * t153;
  t293 = t143 * t128;
  t295 = 0.1e1 / t19 / t293;
  t301 = t23 * t23;
  t302 = 0.1e1 / t301;
  t303 = t135 * params->gammax * t302;
  t304 = t141 * sigma[0];
  t305 = t143 * t143;
  t306 = t305 * t31;
  t307 = 0.1e1 / t306;
  t310 = 0.1e1 / t147 / t38;
  t314 = 0.11e2 / 0.27e2 * t27 * t30 * t263 * t39 - t140 * t142 * t295 * t148 / 0.12e2 + 0.2e1 / 0.81e2 * t303 * t304 * t307 * t310;
  t319 = my_piecewise3(t3, 0, t7 * t18 * t195 * t44 / 0.12e2 - t125 * t279 * t153 / 0.4e1 - 0.3e1 / 0.8e1 * t125 * t284 * t285 - 0.3e1 / 0.8e1 * t125 * t127 * t314);
  t320 = t1 * t319;
  t322 = cbspline(-t118, 2, params);
  t323 = t229 * t229;
  t324 = t322 * t323;
  t325 = t324 * t112;
  t327 = 0.1e1 / t19 / t143;
  t328 = sigma[0] * t327;
  t336 = 0.1e1 / t168 / t114;
  t337 = t224 * t224;
  t338 = t336 * t337;
  t345 = t67 * t57;
  t349 = t65 * t67;
  t350 = t174 * t180;
  t354 = t179 * t84;
  t355 = 0.1e1 / t354;
  t356 = t72 * t355;
  t357 = t199 * t199;
  t358 = t357 * t200;
  t363 = 0.1e1 / t73 / t70 * t53;
  t364 = t78 * t66;
  t365 = t364 * t34;
  t366 = t363 * t365;
  t368 = t184 * t57;
  t369 = t183 * t368;
  t371 = t65 * t345;
  t373 = 0.1e1/sqrt(t70);
  t374 = t373 * t53;
  t375 = t374 * t365;
  t377 = t191 * t368;
  t380 = t79 * t66 * t34;
  t382 = -0.42198333333333333333e0 * t366 + 0.84396666666666666666e0 * t369 + 0.39862222222222222223e0 * t371 + 0.68258333333333333333e-1 * t375 + 0.13651666666666666667e0 * t377 + 0.13692777777777777778e0 * t380;
  t383 = t382 * t200;
  t386 = t179 * t179;
  t387 = 0.1e1 / t386;
  t388 = t72 * t387;
  t389 = t87 * t87;
  t390 = 0.1e1 / t389;
  t391 = t357 * t390;
  t398 = t97 * t65;
  t402 = t210 * t104;
  t403 = 0.1e1 / t402;
  t404 = t216 * t216;
  t406 = t403 * t404 * t218;
  t415 = -0.57538888888888888889e0 * t366 + 0.11507777777777777778e1 * t369 + 0.40256666666666666667e0 * t371 + 0.366775e-1 * t375 + 0.73355e-1 * t377 + 0.137975e0 * t380;
  t417 = t211 * t415 * t218;
  t420 = t210 * t210;
  t421 = 0.1e1 / t420;
  t422 = t421 * t404;
  t423 = t107 * t107;
  t424 = 0.1e1 / t423;
  t425 = t422 * t424;
  t428 = -0.14764627977777777777e-2 * t65 * t345 * t88 - 0.35616666666666666666e-1 * t349 * t350 * t201 - 0.2e1 * t356 * t358 + 0.1e1 * t181 * t383 + 0.16081979498692535067e2 * t388 * t391 + 0.24415263074675393405e-3 * t204 * t184 * t57 * t108 + 0.10843581300301739842e-1 * t398 * t175 * t219 + 0.11696447245269292414e1 * t209 * t406 - 0.5848223622634646207e0 * t209 * t417 - 0.17315859105681463759e2 * t209 * t425;
  t430 = -0.35e2 / 0.216e3 * t54 * t59 * t327 + params->gammac * t428;
  t431 = t169 * t430;
  t435 = -0.35e2 / 0.216e3 * t55 * t328 * t115 - 0.7e1 / 0.72e2 * t55 * t164 * t225 - t55 * t58 * t338 / 0.24e2 + t55 * t58 * t431 / 0.48e2;
  t436 = t161 * t435;
  t437 = t436 * t112;
  t438 = t230 * t222;
  t440 = t119 * t428;
  tv2rho20 = 0.4e1 * t159 + 0.2e1 * t231 + 0.2e1 * t232 + rho[0] * (0.2e1 * t320 + t325 + t437 + 0.2e1 * t438 + t440);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t446 = t153 * t247;
  t454 = t28 * t146;
  t455 = t148 * sigma[0];
  t459 = t305 * rho[0];
  t460 = 0.1e1 / t459;
  t465 = -t27 * t29 * t130 * t39 / 0.9e1 + t140 * t454 * t455 / 0.36e2 - t303 * t141 * t460 * t310 / 0.108e3;
  t470 = my_piecewise3(t3, 0, -t125 * t279 * t247 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t284 * t446 - 0.3e1 / 0.8e1 * t125 * t127 * t465);
  t471 = t1 * t470;
  t473 = t322 * t229;
  t474 = t268 * t112;
  t475 = t473 * t474;
  t480 = t57 * t169;
  t485 = 0.1e1 / t32 / t240;
  t486 = sigma[0] * t485;
  t490 = t336 * t224;
  t494 = 0.7e1 / 0.144e3 * t54 * t5 * t163 * t115 + t55 * t480 * t224 / 0.48e2 + 0.7e1 / 0.1152e4 * t261 * t486 * t169 + t261 * t264 * t490 / 0.384e3;
  t495 = t161 * t494;
  t496 = t495 * t112;
  t497 = t269 * t222;
  tv2rhosigma0 = t253 + t270 + rho[0] * (0.2e1 * t471 + t475 + t496 + t497);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t500 = t247 * t247;
  t507 = 0.1e1 / t305;
  t508 = sigma[0] * t507;
  t512 = -t140 * t28 * t242 * t148 / 0.144e3 + t303 * t508 * t310 / 0.288e3;
  t517 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t125 * t127 * t512 - 0.3e1 / 0.8e1 * t125 * t284 * t500);
  t519 = 0.2e1 * t1 * t517;
  t520 = t268 * t268;
  t521 = t322 * t520;
  t522 = t521 * t112;
  t528 = t258 * t52 * M_PI;
  t529 = 0.1e1 / t293;
  t534 = -t259 * t260 * t263 * t169 / 0.384e3 - t528 * sigma[0] * t529 * t336 / 0.6144e4;
  t535 = t161 * t534;
  t536 = t535 * t112;
  tv2sigma20 = rho[0] * (t519 + t522 + t536);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t547 = t195 * t126;
  t551 = t80 * t283;
  t558 = xbspline(t43, 3, params);
  t559 = t19 * t558;
  t560 = t285 * t153;
  t564 = t153 * t314;
  t573 = 0.1e1 / t19 / t305;
  t578 = t305 * t128;
  t579 = 0.1e1 / t578;
  t584 = t135 * t135;
  t585 = t584 * t302;
  t586 = t141 * t141;
  t587 = t305 * t240;
  t589 = 0.1e1 / t32 / t587;
  t592 = t147 * t147;
  t593 = 0.1e1 / t592;
  t595 = t26 * t29;
  t596 = t593 * t21 * t595;
  t599 = -0.154e3 / 0.81e2 * t27 * t30 * t485 * t39 + 0.341e3 / 0.486e3 * t140 * t142 * t573 * t148 - 0.38e2 / 0.81e2 * t303 * t304 * t579 * t310 + 0.2e1 / 0.243e3 * t585 * t586 * t589 * t596;
  t604 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t18 * t34 * t44 + t125 * t547 * t153 / 0.4e1 - 0.3e1 / 0.8e1 * t125 * t551 * t285 - 0.3e1 / 0.8e1 * t125 * t279 * t314 - 0.3e1 / 0.8e1 * t125 * t559 * t560 - 0.9e1 / 0.8e1 * t125 * t284 * t564 - 0.3e1 / 0.8e1 * t125 * t127 * t599);
  t605 = t1 * t604;
  t607 = cbspline(-t118, 3, params);
  t608 = t323 * t229;
  t609 = t607 * t608;
  t610 = t609 * t112;
  t611 = t112 * t435;
  t612 = t473 * t611;
  t614 = t324 * t222;
  t616 = sigma[0] * t242;
  t629 = t168 * t168;
  t630 = 0.1e1 / t629;
  t631 = t337 * t224;
  t632 = t630 * t631;
  t636 = t54 * t59;
  t637 = t57 * t336;
  t638 = t224 * t430;
  t639 = t637 * t638;
  t646 = 0.1e1 / t420 / t210;
  t647 = t404 * t216;
  t650 = 0.1e1 / t423 / t107;
  t651 = t646 * t647 * t650;
  t657 = 0.1e1 / t73 / t82 * t63 / 0.4e1;
  t658 = 0.1e1 / t143;
  t659 = t657 * t658;
  t661 = t364 * t130;
  t662 = t363 * t661;
  t664 = t184 * t163;
  t665 = t183 * t664;
  t667 = t67 * t163;
  t668 = t65 * t667;
  t670 = 0.1e1/POW_3_2(t70);
  t671 = t670 * t63;
  t672 = t671 * t658;
  t674 = t374 * t661;
  t676 = t191 * t664;
  t679 = t79 * t66 * t130;
  t681 = -0.34523333333333333333e1 * t659 + 0.23015555555555555556e1 * t662 - 0.26851481481481481482e1 * t665 - 0.93932222222222222223e0 * t668 + 0.73355e-1 * t672 - 0.14671e0 * t674 - 0.17116166666666666667e0 * t676 - 0.36793333333333333333e0 * t679;
  t683 = t211 * t681 * t218;
  t687 = 0.1e1 / t420 / t104;
  t689 = t687 * t647 * t424;
  t696 = t424 * t216;
  t701 = t421 * t647 * t218;
  t705 = t218 * t415;
  t709 = t57 * t180;
  t716 = t174 * t387;
  t720 = t382 * t390;
  t724 = -0.10254018858216406658e4 * t209 * t651 - 0.5848223622634646207e0 * t209 * t683 + 0.10389515463408878255e3 * t209 * t689 + 0.34450798614814814813e-2 * t65 * t667 * t88 - 0.51947577317044391277e2 * t209 * t421 * t415 * t696 - 0.35089341735807877242e1 * t209 * t701 + 0.35089341735807877242e1 * t209 * t403 * t216 * t705 + 0.71233333333333333332e-1 * t349 * t709 * t201 - 0.53424999999999999999e-1 * t349 * t350 * t383 - 0.85917975471764868594e0 * t349 * t716 * t391 + 0.48245938496077605201e2 * t388 * t720 * t199;
  t728 = t357 * t199;
  t729 = t728 * t200;
  t733 = 0.1e1 / t386 / t84;
  t734 = t72 * t733;
  t735 = t728 * t390;
  t746 = -0.25319e1 * t659 + 0.16879333333333333333e1 * t662 - 0.19692555555555555555e1 * t665 - 0.93011851851851851854e0 * t668 + 0.13651666666666666667e0 * t672 - 0.27303333333333333333e0 * t674 - 0.3185388888888888889e0 * t676 - 0.36514074074074074075e0 * t679;
  t747 = t746 * t200;
  t751 = 0.1e1 / t386 / t179;
  t752 = t72 * t751;
  t754 = 0.1e1 / t389 / t87;
  t755 = t728 * t754;
  t778 = -0.6e1 * t356 * t201 * t382 + 0.6e1 * t388 * t729 - 0.96491876992155210402e2 * t734 * t735 + 0.1e1 * t181 * t747 + 0.51726012919273400301e3 * t752 * t755 - 0.32530743900905219526e-1 * t398 * t175 * t406 + 0.10685e0 * t349 * t174 * t355 * t358 - 0.56968947174242584612e-3 * t204 * t184 * t163 * t108 - 0.21687162600603479684e-1 * t398 * t345 * t219 + 0.16265371950452609763e-1 * t398 * t175 * t417 + 0.48159733137676571078e0 * t398 * t175 * t425;
  t779 = t724 + t778;
  t781 = 0.455e3 / 0.648e3 * t54 * t59 * t242 + params->gammac * t779;
  t782 = t169 * t781;
  t786 = 0.455e3 / 0.648e3 * t55 * t616 * t115 + 0.35e2 / 0.72e2 * t55 * t328 * t225 + 0.7e1 / 0.24e2 * t55 * t164 * t338 - 0.7e1 / 0.48e2 * t55 * t164 * t431 + t55 * t58 * t632 / 0.8e1 - t636 * t639 / 0.8e1 + t55 * t58 * t782 / 0.48e2;
  t787 = t161 * t786;
  t788 = t787 * t112;
  t789 = t436 * t222;
  t791 = t230 * t428;
  t793 = t119 * t779;
  tv3rho30 = 0.6e1 * t320 + 0.3e1 * t325 + 0.3e1 * t437 + 0.6e1 * t438 + 0.3e1 * t440 + rho[0] * (0.2e1 * t605 + t610 + 0.3e1 * t612 + 0.3e1 * t614 + t788 + 0.3e1 * t789 + 0.3e1 * t791 + t793);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t809 = t285 * t247;
  t813 = t314 * t247;
  t817 = t153 * t465;
  t825 = t28 * t295;
  t829 = t307 * t310;
  t833 = t305 * t143;
  t835 = 0.1e1 / t32 / t833;
  t840 = 0.11e2 / 0.27e2 * t27 * t29 * t263 * t39 - 0.65e2 / 0.324e3 * t140 * t825 * t455 + 0.17e2 / 0.108e3 * t303 * t829 * t141 - t585 * t304 * t835 * t596 / 0.324e3;
  t845 = my_piecewise3(t3, 0, t125 * t547 * t247 / 0.12e2 - t125 * t551 * t446 / 0.4e1 - t125 * t279 * t465 / 0.4e1 - 0.3e1 / 0.8e1 * t125 * t559 * t809 - 0.3e1 / 0.8e1 * t125 * t284 * t813 - 0.3e1 / 0.4e1 * t125 * t284 * t817 - 0.3e1 / 0.8e1 * t125 * t127 * t840);
  t846 = t1 * t845;
  t848 = t607 * t323;
  t849 = t848 * t474;
  t850 = t322 * t435;
  t851 = t850 * t474;
  t852 = t494 * t112;
  t853 = t473 * t852;
  t855 = t268 * t222;
  t856 = t473 * t855;
  t862 = t163 * t169;
  t873 = 0.1e1 / t32 / t144;
  t874 = sigma[0] * t873;
  t881 = t630 * t337;
  t885 = t336 * t430;
  t889 = -0.35e2 / 0.216e3 * t54 * t5 * t327 * t115 - 0.7e1 / 0.72e2 * t55 * t862 * t224 - t55 * t637 * t337 / 0.24e2 + t55 * t480 * t430 / 0.48e2 - 0.119e3 / 0.3456e4 * t261 * t874 * t169 - 0.7e1 / 0.288e3 * t261 * t486 * t490 - t261 * t264 * t881 / 0.128e3 + t261 * t264 * t885 / 0.384e3;
  t890 = t161 * t889;
  t891 = t890 * t112;
  t892 = t495 * t222;
  t894 = t269 * t428;
  tv3rho2sigma0 = 0.4e1 * t471 + 0.2e1 * t475 + 0.2e1 * t496 + 0.2e1 * t497 + rho[0] * (0.2e1 * t846 + t849 + t851 + 0.2e1 * t853 + 0.2e1 * t856 + t891 + 0.2e1 * t892 + t894);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t900 = t153 * t500;
  t904 = t247 * t465;
  t911 = t153 * t512;
  t918 = t460 * t310;
  t923 = 0.1e1 / t32 / t578;
  t928 = t140 * t454 * t148 / 0.27e2 - 0.5e1 / 0.108e3 * t303 * t918 * sigma[0] + t585 * t141 * t923 * t596 / 0.864e3;
  t933 = my_piecewise3(t3, 0, -t125 * t551 * t500 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t559 * t900 - 0.3e1 / 0.4e1 * t125 * t284 * t904 - t125 * t279 * t512 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t284 * t911 - 0.3e1 / 0.8e1 * t125 * t127 * t928);
  t934 = t1 * t933;
  t936 = t607 * t229;
  t937 = t520 * t112;
  t938 = t936 * t937;
  t939 = t322 * t268;
  t940 = t939 * t852;
  t942 = t521 * t222;
  t943 = t534 * t112;
  t944 = t473 * t943;
  t949 = t263 * t336;
  t956 = t528 * sigma[0];
  t957 = t529 * t630;
  t958 = t957 * t224;
  t961 = 0.7e1 / 0.576e3 * t259 * t260 * t485 * t169 + t261 * t949 * t224 / 0.192e3 + 0.7e1 / 0.6144e4 * t528 * t508 * t336 + t956 * t958 / 0.2048e4;
  t962 = t161 * t961;
  t963 = t962 * t112;
  t964 = t535 * t222;
  tv3rhosigma20 = t519 + t522 + t536 + rho[0] * (0.2e1 * t934 + t938 + 0.2e1 * t940 + t942 + t944 + t963 + t964);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t967 = t500 * t247;
  t971 = t247 * t512;
  t979 = 0.1e1 / t32 / t306;
  t984 = t303 * t507 * t310 / 0.96e2 - t585 * sigma[0] * t979 * t596 / 0.2304e4;
  t989 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t125 * t559 * t967 - 0.9e1 / 0.8e1 * t125 * t284 * t971 - 0.3e1 / 0.8e1 * t125 * t127 * t984);
  t991 = 0.2e1 * t1 * t989;
  t992 = t520 * t268;
  t993 = t607 * t992;
  t994 = t993 * t112;
  t996 = 0.3e1 * t939 * t943;
  t1000 = t258 * t258;
  t1002 = t1000 * t5 * M_PI;
  t1003 = t1002 * sigma[0];
  t1005 = 0.1e1 / t19 / t459;
  t1007 = t1005 * t630 * t53;
  t1010 = -t528 * t529 * t336 / 0.2048e4 - t1003 * t1007 / 0.98304e5;
  t1011 = t161 * t1010;
  t1012 = t1011 * t112;
  tv3sigma30 = rho[0] * (t991 + t994 + t996 + t1012);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t16, t18, t19, t20, t21;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t38, t39, t43, t44, t48;
  double t50, t51, t52, t53, t54, t55, t57, t58;
  double t59, t63, t64, t65, t66, t67, t70, t72;
  double t73, t76, t78, t79, t80, t82, t84, t87;
  double t88, t91, t97, t99, t104, t107, t108, t112;
  double t114, t115, t118, t119, t120, tzk0;

  double t125, t126, t127, t128, t130, t135, t136, t139;
  double t140, t141, t142, t143, t144, t146, t147, t148;
  double t153, t158, t159, t161, t163, t164, t168, t169;
  double t174, t175, t179, t180, t181, t183, t184, t185;
  double t186, t188, t190, t191, t192, t195, t197, t199;
  double t200, t201, t204, t209, t210, t211, t216, t218;
  double t219, t222, t224, t225, t229, t230, t231, t232;
  double tvrho0, t240, t242, t247, t251, t253, t258, t259;
  double t260, t261, t263, t264, t268, t269, t270, tvsigma0;

  double t279, t283, t284, t285, t293, t295, t301, t302;
  double t303, t304, t305, t306, t307, t310, t314, t319;
  double t320, t322, t323, t324, t325, t327, t328, t336;
  double t337, t338, t345, t349, t350, t354, t355, t356;
  double t357, t358, t363, t364, t365, t366, t368, t369;
  double t371, t373, t374, t375, t377, t380, t382, t383;
  double t386, t387, t388, t389, t390, t391, t398, t402;
  double t403, t404, t406, t415, t417, t420, t421, t422;
  double t423, t424, t425, t428, t430, t431, t435, t436;
  double t437, t438, t440, tv2rho20, t446, t454, t455, t459;
  double t460, t465, t470, t471, t473, t474, t475, t480;
  double t485, t486, t490, t494, t495, t496, t497, tv2rhosigma0;
  double t500, t507, t508, t512, t517, t519, t520, t521;
  double t522, t528, t529, t534, t535, t536, tv2sigma20;

  double t547, t551, t558, t559, t560, t564, t573, t578;
  double t579, t584, t585, t586, t587, t589, t592, t593;
  double t595, t596, t599, t604, t605, t607, t608, t609;
  double t610, t611, t612, t614, t616, t629, t630, t631;
  double t632, t636, t637, t638, t639, t646, t647, t650;
  double t651, t657, t658, t659, t661, t662, t664, t665;
  double t667, t668, t670, t671, t672, t674, t676, t679;
  double t681, t683, t687, t689, t696, t701, t705, t709;
  double t716, t720, t724, t728, t729, t733, t734, t735;
  double t746, t747, t751, t752, t754, t755, t778, t779;
  double t781, t782, t786, t787, t788, t789, t791, t793;
  double tv3rho30, t809, t813, t817, t825, t829, t833, t835;
  double t840, t845, t846, t848, t849, t850, t851, t852;
  double t853, t855, t856, t862, t873, t874, t881, t885;
  double t889, t890, t891, t892, t894, tv3rho2sigma0, t900, t904;
  double t911, t918, t923, t928, t933, t934, t936, t937;
  double t938, t939, t940, t942, t943, t944, t949, t956;
  double t957, t958, t961, t962, t963, t964, tv3rhosigma20, t967;
  double t971, t979, t984, t989, t991, t992, t993, t994;
  double t996, t1000, t1002, t1003, t1005, t1007, t1010, t1011;
  double t1012, tv3sigma30;

  double t1026, t1030, t1037, t1047, t1048, t1049, t1057, t1078;
  double t1086, t1088, t1098, t1105, t1106, t1109, t1110, t1117;
  double t1145, t1153, t1154, t1159, t1164, t1176, t1180, t1187;
  double t1190, t1216, t1224, t1258, t1268, t1282, t1311, t1313;
  double t1314, t1316, t1317, t1319, t1320, t1322, t1324, t1327;
  double t1329, t1331, t1333, t1336, t1342, t1346, t1348, t1350;
  double t1380, t1393, t1413, t1415, t1422, t1432, tv4rho40, t1450;
  double t1496, t1504, t1507, t1554, t1555, t1594, t1595, t1603;
  double tv4rho3sigma0, t1632, t1684, t1685, t1698, t1709, t1712, t1750;
  double tv4rho2sigma20, t1803, t1809, t1823, t1845, tv4rhosigma30, t1847, t1855;
  double t1877, t1880, t1885, tv4sigma40;

  hyb_gga_xc_case21_params *params;

  assert(p->params != NULL);
  params = (hyb_gga_xc_case21_params * )(p->params);

  t1 = 0.1e1 - params->ax;
  t3 = rho[0] / 0.2e1 <= p->dens_threshold;
  t4 = M_CBRT3;
  t5 = M_CBRTPI;
  t7 = t4 / t5;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * p->zeta_threshold;
  t16 = POW_1_3(t12);
  t18 = my_piecewise3(t12 <= p->zeta_threshold, t15, t16 * t12);
  t19 = POW_1_3(rho[0]);
  t20 = t18 * t19;
  t21 = M_CBRT6;
  t23 = M_PI * M_PI;
  t24 = POW_1_3(t23);
  t25 = t24 * t24;
  t26 = 0.1e1 / t25;
  t27 = params->gammax * t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = sigma[0] * t29;
  t31 = rho[0] * rho[0];
  t32 = t19 * t19;
  t34 = 0.1e1 / t32 / t31;
  t38 = 0.1e1 + t27 * t30 * t34 / 0.24e2;
  t39 = 0.1e1 / t38;
  t43 = t27 * t30 * t34 * t39 / 0.24e2;
  t44 = xbspline(t43, 0, params);
  t48 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t7 * t20 * t44);
  t50 = 0.2e1 * t1 * t48;
  t51 = t14 * t14;
  t52 = my_piecewise3(t8, t51, 1);
  t53 = t4 * t4;
  t54 = t52 * t53;
  t55 = t54 * t5;
  t57 = 0.1e1 / t19 / t31;
  t58 = sigma[0] * t57;
  t59 = t5 * sigma[0];
  t63 = 0.1e1 / M_PI;
  t64 = POW_1_3(t63);
  t65 = t4 * t64;
  t66 = M_CBRT4;
  t67 = t66 * t66;
  t70 = t65 * t67 / t19;
  t72 = 0.1e1 + 0.53425e-1 * t70;
  t73 = sqrt(t70);
  t76 = POW_3_2(t70);
  t78 = t64 * t64;
  t79 = t53 * t78;
  t80 = 0.1e1 / t32;
  t82 = t79 * t66 * t80;
  t84 = 0.379785e1 * t73 + 0.8969e0 * t70 + 0.204775e0 * t76 + 0.123235e0 * t82;
  t87 = 0.1e1 + 0.16081979498692535067e2 / t84;
  t88 = log(t87);
  t91 = my_piecewise3(t8, t15, 1);
  t97 = (0.2e1 * t91 - 0.2e1) / (0.2e1 * t28 - 0.2e1);
  t99 = 0.1e1 + 0.278125e-1 * t70;
  t104 = 0.51785e1 * t73 + 0.905775e0 * t70 + 0.1100325e0 * t76 + 0.1241775e0 * t82;
  t107 = 0.1e1 + 0.29608749977793437516e2 / t104;
  t108 = log(t107);
  t112 = -0.621814e-1 * t72 * t88 + 0.19751673498613801407e-1 * t97 * t99 * t108;
  t114 = -t54 * t59 * t57 / 0.48e2 + params->gammac * t112;
  t115 = 0.1e1 / t114;
  t118 = t55 * t58 * t115 / 0.48e2;
  t119 = cbspline(-t118, 0, params);
  t120 = t119 * t112;
  tzk0 = t50 + t120;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t125 = t7 * t18;
  t126 = xbspline(t43, 1, params);
  t127 = t19 * t126;
  t128 = t31 * rho[0];
  t130 = 0.1e1 / t32 / t128;
  t135 = params->gammax * params->gammax;
  t136 = t21 * t21;
  t139 = 0.1e1 / t24 / t23;
  t140 = t135 * t136 * t139;
  t141 = sigma[0] * sigma[0];
  t142 = t141 * t28;
  t143 = t31 * t31;
  t144 = t143 * t31;
  t146 = 0.1e1 / t19 / t144;
  t147 = t38 * t38;
  t148 = 0.1e1 / t147;
  t153 = -t27 * t30 * t130 * t39 / 0.9e1 + t140 * t142 * t146 * t148 / 0.108e3;
  t158 = my_piecewise3(t3, 0, -t7 * t18 * t80 * t44 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t127 * t153);
  t159 = t1 * t158;
  t161 = cbspline(-t118, 1, params);
  t163 = 0.1e1 / t19 / t128;
  t164 = sigma[0] * t163;
  t168 = t114 * t114;
  t169 = 0.1e1 / t168;
  t174 = 0.1e1 / t19 / rho[0];
  t175 = t67 * t174;
  t179 = t84 * t84;
  t180 = 0.1e1 / t179;
  t181 = t72 * t180;
  t183 = 0.1e1 / t73 * t4;
  t184 = t64 * t67;
  t185 = t184 * t174;
  t186 = t183 * t185;
  t188 = t65 * t175;
  t190 = sqrt(t70);
  t191 = t190 * t4;
  t192 = t191 * t185;
  t195 = 0.1e1 / t32 / rho[0];
  t197 = t79 * t66 * t195;
  t199 = -0.632975e0 * t186 - 0.29896666666666666667e0 * t188 - 0.1023875e0 * t192 - 0.82156666666666666667e-1 * t197;
  t200 = 0.1e1 / t87;
  t201 = t199 * t200;
  t204 = t97 * t4;
  t209 = t97 * t99;
  t210 = t104 * t104;
  t211 = 0.1e1 / t210;
  t216 = -0.86308333333333333334e0 * t186 - 0.301925e0 * t188 - 0.5501625e-1 * t192 - 0.82785e-1 * t197;
  t218 = 0.1e1 / t107;
  t219 = t211 * t216 * t218;
  t222 = 0.11073470983333333333e-2 * t65 * t175 * t88 + 0.1e1 * t181 * t201 - 0.18311447306006545054e-3 * t204 * t184 * t174 * t108 - 0.5848223622634646207e0 * t209 * t219;
  t224 = 0.7e1 / 0.144e3 * t54 * t59 * t163 + params->gammac * t222;
  t225 = t169 * t224;
  t229 = 0.7e1 / 0.144e3 * t55 * t164 * t115 + t55 * t58 * t225 / 0.48e2;
  t230 = t161 * t229;
  t231 = t230 * t112;
  t232 = t119 * t222;
  tvrho0 = t50 + t120 + rho[0] * (0.2e1 * t159 + t231 + t232);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t240 = t143 * rho[0];
  t242 = 0.1e1 / t19 / t240;
  t247 = t27 * t29 * t34 * t39 / 0.24e2 - t140 * sigma[0] * t28 * t242 * t148 / 0.288e3;
  t251 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t125 * t127 * t247);
  t253 = 0.2e1 * t1 * t251;
  t258 = t52 * t52;
  t259 = t258 * t4;
  t260 = t5 * t5;
  t261 = t259 * t260;
  t263 = 0.1e1 / t32 / t143;
  t264 = sigma[0] * t263;
  t268 = -t54 * t5 * t57 * t115 / 0.48e2 - t261 * t264 * t169 / 0.768e3;
  t269 = t161 * t268;
  t270 = t269 * t112;
  tvsigma0 = rho[0] * (t253 + t270);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t279 = t80 * t126;
  t283 = xbspline(t43, 2, params);
  t284 = t19 * t283;
  t285 = t153 * t153;
  t293 = t143 * t128;
  t295 = 0.1e1 / t19 / t293;
  t301 = t23 * t23;
  t302 = 0.1e1 / t301;
  t303 = t135 * params->gammax * t302;
  t304 = t141 * sigma[0];
  t305 = t143 * t143;
  t306 = t305 * t31;
  t307 = 0.1e1 / t306;
  t310 = 0.1e1 / t147 / t38;
  t314 = 0.11e2 / 0.27e2 * t27 * t30 * t263 * t39 - t140 * t142 * t295 * t148 / 0.12e2 + 0.2e1 / 0.81e2 * t303 * t304 * t307 * t310;
  t319 = my_piecewise3(t3, 0, t7 * t18 * t195 * t44 / 0.12e2 - t125 * t279 * t153 / 0.4e1 - 0.3e1 / 0.8e1 * t125 * t284 * t285 - 0.3e1 / 0.8e1 * t125 * t127 * t314);
  t320 = t1 * t319;
  t322 = cbspline(-t118, 2, params);
  t323 = t229 * t229;
  t324 = t322 * t323;
  t325 = t324 * t112;
  t327 = 0.1e1 / t19 / t143;
  t328 = sigma[0] * t327;
  t336 = 0.1e1 / t168 / t114;
  t337 = t224 * t224;
  t338 = t336 * t337;
  t345 = t67 * t57;
  t349 = t65 * t67;
  t350 = t174 * t180;
  t354 = t179 * t84;
  t355 = 0.1e1 / t354;
  t356 = t72 * t355;
  t357 = t199 * t199;
  t358 = t357 * t200;
  t363 = 0.1e1 / t73 / t70 * t53;
  t364 = t78 * t66;
  t365 = t364 * t34;
  t366 = t363 * t365;
  t368 = t184 * t57;
  t369 = t183 * t368;
  t371 = t65 * t345;
  t373 = 0.1e1/sqrt(t70);
  t374 = t373 * t53;
  t375 = t374 * t365;
  t377 = t191 * t368;
  t380 = t79 * t66 * t34;
  t382 = -0.42198333333333333333e0 * t366 + 0.84396666666666666666e0 * t369 + 0.39862222222222222223e0 * t371 + 0.68258333333333333333e-1 * t375 + 0.13651666666666666667e0 * t377 + 0.13692777777777777778e0 * t380;
  t383 = t382 * t200;
  t386 = t179 * t179;
  t387 = 0.1e1 / t386;
  t388 = t72 * t387;
  t389 = t87 * t87;
  t390 = 0.1e1 / t389;
  t391 = t357 * t390;
  t398 = t97 * t65;
  t402 = t210 * t104;
  t403 = 0.1e1 / t402;
  t404 = t216 * t216;
  t406 = t403 * t404 * t218;
  t415 = -0.57538888888888888889e0 * t366 + 0.11507777777777777778e1 * t369 + 0.40256666666666666667e0 * t371 + 0.366775e-1 * t375 + 0.73355e-1 * t377 + 0.137975e0 * t380;
  t417 = t211 * t415 * t218;
  t420 = t210 * t210;
  t421 = 0.1e1 / t420;
  t422 = t421 * t404;
  t423 = t107 * t107;
  t424 = 0.1e1 / t423;
  t425 = t422 * t424;
  t428 = -0.14764627977777777777e-2 * t65 * t345 * t88 - 0.35616666666666666666e-1 * t349 * t350 * t201 - 0.2e1 * t356 * t358 + 0.1e1 * t181 * t383 + 0.16081979498692535067e2 * t388 * t391 + 0.24415263074675393405e-3 * t204 * t184 * t57 * t108 + 0.10843581300301739842e-1 * t398 * t175 * t219 + 0.11696447245269292414e1 * t209 * t406 - 0.5848223622634646207e0 * t209 * t417 - 0.17315859105681463759e2 * t209 * t425;
  t430 = -0.35e2 / 0.216e3 * t54 * t59 * t327 + params->gammac * t428;
  t431 = t169 * t430;
  t435 = -0.35e2 / 0.216e3 * t55 * t328 * t115 - 0.7e1 / 0.72e2 * t55 * t164 * t225 - t55 * t58 * t338 / 0.24e2 + t55 * t58 * t431 / 0.48e2;
  t436 = t161 * t435;
  t437 = t436 * t112;
  t438 = t230 * t222;
  t440 = t119 * t428;
  tv2rho20 = 0.4e1 * t159 + 0.2e1 * t231 + 0.2e1 * t232 + rho[0] * (0.2e1 * t320 + t325 + t437 + 0.2e1 * t438 + t440);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t446 = t153 * t247;
  t454 = t28 * t146;
  t455 = t148 * sigma[0];
  t459 = t305 * rho[0];
  t460 = 0.1e1 / t459;
  t465 = -t27 * t29 * t130 * t39 / 0.9e1 + t140 * t454 * t455 / 0.36e2 - t303 * t141 * t460 * t310 / 0.108e3;
  t470 = my_piecewise3(t3, 0, -t125 * t279 * t247 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t284 * t446 - 0.3e1 / 0.8e1 * t125 * t127 * t465);
  t471 = t1 * t470;
  t473 = t322 * t229;
  t474 = t268 * t112;
  t475 = t473 * t474;
  t480 = t57 * t169;
  t485 = 0.1e1 / t32 / t240;
  t486 = sigma[0] * t485;
  t490 = t336 * t224;
  t494 = 0.7e1 / 0.144e3 * t54 * t5 * t163 * t115 + t55 * t480 * t224 / 0.48e2 + 0.7e1 / 0.1152e4 * t261 * t486 * t169 + t261 * t264 * t490 / 0.384e3;
  t495 = t161 * t494;
  t496 = t495 * t112;
  t497 = t269 * t222;
  tv2rhosigma0 = t253 + t270 + rho[0] * (0.2e1 * t471 + t475 + t496 + t497);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t500 = t247 * t247;
  t507 = 0.1e1 / t305;
  t508 = sigma[0] * t507;
  t512 = -t140 * t28 * t242 * t148 / 0.144e3 + t303 * t508 * t310 / 0.288e3;
  t517 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t125 * t127 * t512 - 0.3e1 / 0.8e1 * t125 * t284 * t500);
  t519 = 0.2e1 * t1 * t517;
  t520 = t268 * t268;
  t521 = t322 * t520;
  t522 = t521 * t112;
  t528 = t258 * t52 * M_PI;
  t529 = 0.1e1 / t293;
  t534 = -t259 * t260 * t263 * t169 / 0.384e3 - t528 * sigma[0] * t529 * t336 / 0.6144e4;
  t535 = t161 * t534;
  t536 = t535 * t112;
  tv2sigma20 = rho[0] * (t519 + t522 + t536);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t547 = t195 * t126;
  t551 = t80 * t283;
  t558 = xbspline(t43, 3, params);
  t559 = t19 * t558;
  t560 = t285 * t153;
  t564 = t153 * t314;
  t573 = 0.1e1 / t19 / t305;
  t578 = t305 * t128;
  t579 = 0.1e1 / t578;
  t584 = t135 * t135;
  t585 = t584 * t302;
  t586 = t141 * t141;
  t587 = t305 * t240;
  t589 = 0.1e1 / t32 / t587;
  t592 = t147 * t147;
  t593 = 0.1e1 / t592;
  t595 = t26 * t29;
  t596 = t593 * t21 * t595;
  t599 = -0.154e3 / 0.81e2 * t27 * t30 * t485 * t39 + 0.341e3 / 0.486e3 * t140 * t142 * t573 * t148 - 0.38e2 / 0.81e2 * t303 * t304 * t579 * t310 + 0.2e1 / 0.243e3 * t585 * t586 * t589 * t596;
  t604 = my_piecewise3(t3, 0, -0.5e1 / 0.36e2 * t7 * t18 * t34 * t44 + t125 * t547 * t153 / 0.4e1 - 0.3e1 / 0.8e1 * t125 * t551 * t285 - 0.3e1 / 0.8e1 * t125 * t279 * t314 - 0.3e1 / 0.8e1 * t125 * t559 * t560 - 0.9e1 / 0.8e1 * t125 * t284 * t564 - 0.3e1 / 0.8e1 * t125 * t127 * t599);
  t605 = t1 * t604;
  t607 = cbspline(-t118, 3, params);
  t608 = t323 * t229;
  t609 = t607 * t608;
  t610 = t609 * t112;
  t611 = t112 * t435;
  t612 = t473 * t611;
  t614 = t324 * t222;
  t616 = sigma[0] * t242;
  t629 = t168 * t168;
  t630 = 0.1e1 / t629;
  t631 = t337 * t224;
  t632 = t630 * t631;
  t636 = t54 * t59;
  t637 = t57 * t336;
  t638 = t224 * t430;
  t639 = t637 * t638;
  t646 = 0.1e1 / t420 / t210;
  t647 = t404 * t216;
  t650 = 0.1e1 / t423 / t107;
  t651 = t646 * t647 * t650;
  t657 = 0.1e1 / t73 / t82 * t63 / 0.4e1;
  t658 = 0.1e1 / t143;
  t659 = t657 * t658;
  t661 = t364 * t130;
  t662 = t363 * t661;
  t664 = t184 * t163;
  t665 = t183 * t664;
  t667 = t67 * t163;
  t668 = t65 * t667;
  t670 = 0.1e1/POW_3_2(t70);
  t671 = t670 * t63;
  t672 = t671 * t658;
  t674 = t374 * t661;
  t676 = t191 * t664;
  t679 = t79 * t66 * t130;
  t681 = -0.34523333333333333333e1 * t659 + 0.23015555555555555556e1 * t662 - 0.26851481481481481482e1 * t665 - 0.93932222222222222223e0 * t668 + 0.73355e-1 * t672 - 0.14671e0 * t674 - 0.17116166666666666667e0 * t676 - 0.36793333333333333333e0 * t679;
  t683 = t211 * t681 * t218;
  t687 = 0.1e1 / t420 / t104;
  t689 = t687 * t647 * t424;
  t696 = t424 * t216;
  t701 = t421 * t647 * t218;
  t705 = t218 * t415;
  t709 = t57 * t180;
  t716 = t174 * t387;
  t720 = t382 * t390;
  t724 = -0.10254018858216406658e4 * t209 * t651 - 0.5848223622634646207e0 * t209 * t683 + 0.10389515463408878255e3 * t209 * t689 + 0.34450798614814814813e-2 * t65 * t667 * t88 - 0.51947577317044391277e2 * t209 * t421 * t415 * t696 - 0.35089341735807877242e1 * t209 * t701 + 0.35089341735807877242e1 * t209 * t403 * t216 * t705 + 0.71233333333333333332e-1 * t349 * t709 * t201 - 0.53424999999999999999e-1 * t349 * t350 * t383 - 0.85917975471764868594e0 * t349 * t716 * t391 + 0.48245938496077605201e2 * t388 * t720 * t199;
  t728 = t357 * t199;
  t729 = t728 * t200;
  t733 = 0.1e1 / t386 / t84;
  t734 = t72 * t733;
  t735 = t728 * t390;
  t746 = -0.25319e1 * t659 + 0.16879333333333333333e1 * t662 - 0.19692555555555555555e1 * t665 - 0.93011851851851851854e0 * t668 + 0.13651666666666666667e0 * t672 - 0.27303333333333333333e0 * t674 - 0.3185388888888888889e0 * t676 - 0.36514074074074074075e0 * t679;
  t747 = t746 * t200;
  t751 = 0.1e1 / t386 / t179;
  t752 = t72 * t751;
  t754 = 0.1e1 / t389 / t87;
  t755 = t728 * t754;
  t778 = -0.6e1 * t356 * t201 * t382 + 0.6e1 * t388 * t729 - 0.96491876992155210402e2 * t734 * t735 + 0.1e1 * t181 * t747 + 0.51726012919273400301e3 * t752 * t755 - 0.32530743900905219526e-1 * t398 * t175 * t406 + 0.10685e0 * t349 * t174 * t355 * t358 - 0.56968947174242584612e-3 * t204 * t184 * t163 * t108 - 0.21687162600603479684e-1 * t398 * t345 * t219 + 0.16265371950452609763e-1 * t398 * t175 * t417 + 0.48159733137676571078e0 * t398 * t175 * t425;
  t779 = t724 + t778;
  t781 = 0.455e3 / 0.648e3 * t54 * t59 * t242 + params->gammac * t779;
  t782 = t169 * t781;
  t786 = 0.455e3 / 0.648e3 * t55 * t616 * t115 + 0.35e2 / 0.72e2 * t55 * t328 * t225 + 0.7e1 / 0.24e2 * t55 * t164 * t338 - 0.7e1 / 0.48e2 * t55 * t164 * t431 + t55 * t58 * t632 / 0.8e1 - t636 * t639 / 0.8e1 + t55 * t58 * t782 / 0.48e2;
  t787 = t161 * t786;
  t788 = t787 * t112;
  t789 = t436 * t222;
  t791 = t230 * t428;
  t793 = t119 * t779;
  tv3rho30 = 0.6e1 * t320 + 0.3e1 * t325 + 0.3e1 * t437 + 0.6e1 * t438 + 0.3e1 * t440 + rho[0] * (0.2e1 * t605 + t610 + 0.3e1 * t612 + 0.3e1 * t614 + t788 + 0.3e1 * t789 + 0.3e1 * t791 + t793);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t809 = t285 * t247;
  t813 = t314 * t247;
  t817 = t153 * t465;
  t825 = t28 * t295;
  t829 = t307 * t310;
  t833 = t305 * t143;
  t835 = 0.1e1 / t32 / t833;
  t840 = 0.11e2 / 0.27e2 * t27 * t29 * t263 * t39 - 0.65e2 / 0.324e3 * t140 * t825 * t455 + 0.17e2 / 0.108e3 * t303 * t829 * t141 - t585 * t304 * t835 * t596 / 0.324e3;
  t845 = my_piecewise3(t3, 0, t125 * t547 * t247 / 0.12e2 - t125 * t551 * t446 / 0.4e1 - t125 * t279 * t465 / 0.4e1 - 0.3e1 / 0.8e1 * t125 * t559 * t809 - 0.3e1 / 0.8e1 * t125 * t284 * t813 - 0.3e1 / 0.4e1 * t125 * t284 * t817 - 0.3e1 / 0.8e1 * t125 * t127 * t840);
  t846 = t1 * t845;
  t848 = t607 * t323;
  t849 = t848 * t474;
  t850 = t322 * t435;
  t851 = t850 * t474;
  t852 = t494 * t112;
  t853 = t473 * t852;
  t855 = t268 * t222;
  t856 = t473 * t855;
  t862 = t163 * t169;
  t873 = 0.1e1 / t32 / t144;
  t874 = sigma[0] * t873;
  t881 = t630 * t337;
  t885 = t336 * t430;
  t889 = -0.35e2 / 0.216e3 * t54 * t5 * t327 * t115 - 0.7e1 / 0.72e2 * t55 * t862 * t224 - t55 * t637 * t337 / 0.24e2 + t55 * t480 * t430 / 0.48e2 - 0.119e3 / 0.3456e4 * t261 * t874 * t169 - 0.7e1 / 0.288e3 * t261 * t486 * t490 - t261 * t264 * t881 / 0.128e3 + t261 * t264 * t885 / 0.384e3;
  t890 = t161 * t889;
  t891 = t890 * t112;
  t892 = t495 * t222;
  t894 = t269 * t428;
  tv3rho2sigma0 = 0.4e1 * t471 + 0.2e1 * t475 + 0.2e1 * t496 + 0.2e1 * t497 + rho[0] * (0.2e1 * t846 + t849 + t851 + 0.2e1 * t853 + 0.2e1 * t856 + t891 + 0.2e1 * t892 + t894);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t900 = t153 * t500;
  t904 = t247 * t465;
  t911 = t153 * t512;
  t918 = t460 * t310;
  t923 = 0.1e1 / t32 / t578;
  t928 = t140 * t454 * t148 / 0.27e2 - 0.5e1 / 0.108e3 * t303 * t918 * sigma[0] + t585 * t141 * t923 * t596 / 0.864e3;
  t933 = my_piecewise3(t3, 0, -t125 * t551 * t500 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t559 * t900 - 0.3e1 / 0.4e1 * t125 * t284 * t904 - t125 * t279 * t512 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t284 * t911 - 0.3e1 / 0.8e1 * t125 * t127 * t928);
  t934 = t1 * t933;
  t936 = t607 * t229;
  t937 = t520 * t112;
  t938 = t936 * t937;
  t939 = t322 * t268;
  t940 = t939 * t852;
  t942 = t521 * t222;
  t943 = t534 * t112;
  t944 = t473 * t943;
  t949 = t263 * t336;
  t956 = t528 * sigma[0];
  t957 = t529 * t630;
  t958 = t957 * t224;
  t961 = 0.7e1 / 0.576e3 * t259 * t260 * t485 * t169 + t261 * t949 * t224 / 0.192e3 + 0.7e1 / 0.6144e4 * t528 * t508 * t336 + t956 * t958 / 0.2048e4;
  t962 = t161 * t961;
  t963 = t962 * t112;
  t964 = t535 * t222;
  tv3rhosigma20 = t519 + t522 + t536 + rho[0] * (0.2e1 * t934 + t938 + 0.2e1 * t940 + t942 + t944 + t963 + t964);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t967 = t500 * t247;
  t971 = t247 * t512;
  t979 = 0.1e1 / t32 / t306;
  t984 = t303 * t507 * t310 / 0.96e2 - t585 * sigma[0] * t979 * t596 / 0.2304e4;
  t989 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t125 * t559 * t967 - 0.9e1 / 0.8e1 * t125 * t284 * t971 - 0.3e1 / 0.8e1 * t125 * t127 * t984);
  t991 = 0.2e1 * t1 * t989;
  t992 = t520 * t268;
  t993 = t607 * t992;
  t994 = t993 * t112;
  t996 = 0.3e1 * t939 * t943;
  t1000 = t258 * t258;
  t1002 = t1000 * t5 * M_PI;
  t1003 = t1002 * sigma[0];
  t1005 = 0.1e1 / t19 / t459;
  t1007 = t1005 * t630 * t53;
  t1010 = -t528 * t529 * t336 / 0.2048e4 - t1003 * t1007 / 0.98304e5;
  t1011 = t161 * t1010;
  t1012 = t1011 * t112;
  tv3sigma30 = rho[0] * (t991 + t994 + t996 + t1012);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t1026 = t34 * t126;
  t1030 = t195 * t283;
  t1037 = t80 * t558;
  t1047 = xbspline(t43, 4, params);
  t1048 = t19 * t1047;
  t1049 = t285 * t285;
  t1057 = t314 * t314;
  t1078 = t305 * t144;
  t1086 = t584 * params->gammax * t302;
  t1088 = t305 * t305;
  t1098 = 0.1e1 / t592 / t38 * t136 * t139 * t28;
  t1105 = 0.1e2 / 0.27e2 * t7 * t18 * t130 * t44 - 0.5e1 / 0.9e1 * t125 * t1026 * t153 + t125 * t1030 * t285 / 0.2e1 + t125 * t547 * t314 / 0.2e1 - t125 * t1037 * t560 / 0.2e1 - 0.3e1 / 0.2e1 * t125 * t551 * t564 - t125 * t279 * t599 / 0.2e1 - 0.3e1 / 0.8e1 * t125 * t1048 * t1049 - 0.9e1 / 0.4e1 * t125 * t559 * t285 * t314 - 0.9e1 / 0.8e1 * t125 * t284 * t1057 - 0.3e1 / 0.2e1 * t125 * t284 * t153 * t599 - 0.3e1 / 0.8e1 * t125 * t127 * (0.2618e4 / 0.243e3 * t27 * t30 * t873 * t39 - 0.3047e4 / 0.486e3 * t140 * t142 * t1005 * t148 + 0.5126e4 / 0.729e3 * t303 * t304 / t833 * t310 - 0.196e3 / 0.729e3 * t585 * t586 / t32 / t1078 * t596 + 0.16e2 / 0.2187e4 * t1086 * t586 * sigma[0] / t19 / t1088 / rho[0] * t1098);
  t1106 = my_piecewise3(t3, 0, t1105);
  t1109 = cbspline(-t118, 4, params);
  t1110 = t323 * t323;
  t1117 = t435 * t435;
  t1145 = t163 * t336;
  t1153 = 0.1e1 / t629 / t114;
  t1154 = t337 * t337;
  t1159 = t57 * t630;
  t1164 = t430 * t430;
  t1176 = t382 * t382;
  t1180 = t357 * t357;
  t1187 = t386 * t386;
  t1190 = t389 * t389;
  t1216 = 0.48245938496077605201e2 * t388 * t1176 * t390 - 0.24e2 * t734 * t1180 * t200 - 0.6e1 * t356 * t1176 * t200 + 0.24955700379505800916e5 * t72 / t1187 * t1180 / t1190 + 0.86748650402413918736e-1 * t398 * t345 * t406 + 0.67471172535210825684e-1 * t398 * t667 * t219 - 0.43374325201206959368e-1 * t398 * t345 * t417 - 0.12842595503380418954e1 * t398 * t345 * t425 + 0.38025319932552508021e2 * t398 * t175 * t651 + 0.21687162600603479684e-1 * t398 * t175 * t683 - 0.38527786510141256862e1 * t398 * t175 * t689;
  t1224 = t67 * t327;
  t1258 = 0.1301229756036208781e0 * t398 * t175 * t701 + 0.64327917994770140268e2 * t388 * t746 * t390 * t199 - 0.11483599538271604938e-1 * t65 * t1224 * t88 - 0.57895126195293126241e3 * t734 * t720 * t357 + 0.3103560775156404018e4 * t752 * t382 * t754 * t357 + 0.36e2 * t388 * t358 * t382 - 0.8e1 * t356 * t201 * t746 - 0.4274e0 * t349 * t716 * t729 - 0.3684616320282908548e2 * t349 * t174 * t751 * t755 + 0.22911460125803964958e1 * t349 * t57 * t387 * t391 - 0.71233333333333333332e-1 * t349 * t350 * t747 + 0.14246666666666666666e0 * t349 * t709 * t383;
  t1268 = t424 * t415;
  t1282 = t218 * t216;
  t1311 = 0.1e1 / t73 * rho[0] * t242 * t349 / 0.48e2;
  t1313 = 0.1e1 / t240;
  t1314 = t657 * t1313;
  t1316 = t364 * t263;
  t1317 = t363 * t1316;
  t1319 = t184 * t327;
  t1320 = t183 * t1319;
  t1322 = t65 * t1224;
  t1324 = pow(t70, -0.25e1);
  t1327 = t1324 * t63 * t242 * t349;
  t1329 = t671 * t1313;
  t1331 = t374 * t1316;
  t1333 = t191 * t1319;
  t1336 = t79 * t66 * t263;
  t1342 = -0.21053605041484726346e2 * t209 * t422 * t705 - 0.69263436422725855036e2 * t209 * t421 * t681 * t696 + 0.62337092780453269531e3 * t209 * t687 * t404 * t1268 - 0.22161481481481481481e0 * t349 * t163 * t180 * t201 - 0.61524113149298439947e4 * t209 * t646 * t404 * t650 * t415 + 0.46785788981077169656e1 * t209 * t403 * t681 * t1282 + 0.18989649058080861537e-2 * t204 * t184 * t327 * t108 + 0.68734380377411894876e1 * t349 * t174 * t733 * t735 - 0.28493333333333333333e0 * t349 * t57 * t355 * t358 - 0.62071215503128080361e4 * t72 / t386 / t354 * t1180 * t754 + 0.1e1 * t181 * (-0.21099166666666666667e1 * t1311 + 0.202552e2 * t1314 - 0.75019259259259259258e1 * t1317 + 0.6564185185185185185e1 * t1320 + 0.31003950617283950618e1 * t1322 + 0.68258333333333333335e-1 * t1327 - 0.10921333333333333333e1 * t1329 + 0.12134814814814814815e1 * t1331 + 0.10617962962962962963e1 * t1333 + 0.13388493827160493828e1 * t1336) * t200;
  t1346 = t420 * t420;
  t1348 = t404 * t404;
  t1350 = t423 * t423;
  t1380 = t415 * t415;
  t1393 = t97 * t349;
  t1413 = 0.57895126195293126241e3 * t752 * t1180 * t390 - 0.91082604192152556044e5 * t209 / t1346 * t1348 / t1350 - 0.5848223622634646207e0 * t209 * t211 * (-0.28769444444444444444e1 * t1311 + 0.27618666666666666667e2 * t1314 - 0.10229135802469135803e2 * t1317 + 0.89504938271604938273e1 * t1320 + 0.31310740740740740741e1 * t1322 + 0.366775e-1 * t1327 - 0.58684e0 * t1329 + 0.65204444444444444445e0 * t1331 + 0.5705388888888888889e0 * t1333 + 0.13490888888888888889e1 * t1336) * t218 - 0.6233709278045326953e3 * t209 * t646 * t1348 * t424 + 0.12304822629859687989e5 * t209 / t420 / t402 * t1348 * t650 + 0.35089341735807877242e1 * t209 * t403 * t1380 * t218 - 0.51947577317044391277e2 * t209 * t421 * t1380 * t424 + 0.14035736694323150897e2 * t209 * t687 * t1348 * t218 + 0.19263893255070628431e1 * t1393 * t174 * t421 * t1268 * t216 - 0.1301229756036208781e0 * t1393 * t174 * t403 * t1282 * t415 - 0.34367190188705947437e1 * t188 * t387 * t382 * t390 * t199 + 0.4274e0 * t188 * t355 * t382 * t201;
  t1415 = t1216 + t1258 + t1342 + t1413;
  t1422 = -0.91e3 / 0.243e3 * t55 * sigma[0] * t146 * t115 - 0.455e3 / 0.162e3 * t55 * t616 * t225 - 0.35e2 / 0.18e2 * t55 * t328 * t338 + 0.35e2 / 0.36e2 * t55 * t328 * t431 - 0.7e1 / 0.6e1 * t55 * t164 * t632 + 0.7e1 / 0.6e1 * t636 * t1145 * t638 - 0.7e1 / 0.36e2 * t55 * t164 * t782 - t55 * t58 * t1153 * t1154 / 0.2e1 + 0.3e1 / 0.4e1 * t636 * t1159 * t337 * t430 - t55 * t58 * t336 * t1164 / 0.8e1 - t636 * t637 * t224 * t781 / 0.6e1 + t55 * t58 * t169 * (-0.91e3 / 0.243e3 * t54 * t59 * t146 + params->gammac * t1415) / 0.48e2;
  t1432 = t1109 * t1110 * t112 + 0.3e1 * t1117 * t112 * t322 + t112 * t1422 * t161 + 0.4e1 * t112 * t473 * t786 + 0.12e2 * t222 * t435 * t473 + 0.2e1 * t1 * t1106 + t119 * t1415 + 0.4e1 * t222 * t609 + 0.4e1 * t222 * t787 + 0.4e1 * t230 * t779 + 0.6e1 * t324 * t428 + 0.6e1 * t428 * t436 + 0.6e1 * t611 * t848;
  tv4rho40 = rho[0] * t1432 + 0.8e1 * t605 + 0.4e1 * t610 + 0.12e2 * t612 + 0.12e2 * t614 + 0.4e1 * t788 + 0.12e2 * t789 + 0.12e2 * t791 + 0.4e1 * t793;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1450 = t494 * t222;
  t1496 = t263 * t630;
  t1504 = 0.455e3 / 0.648e3 * t54 * t5 * t242 * t115 + 0.35e2 / 0.72e2 * t55 * t327 * t169 * t224 + 0.7e1 / 0.24e2 * t55 * t1145 * t337 - 0.7e1 / 0.48e2 * t55 * t862 * t430 + t55 * t1159 * t631 / 0.8e1 - t55 * t639 / 0.8e1 + t55 * t480 * t781 / 0.48e2 + 0.595e3 / 0.2592e4 * t261 * sigma[0] / t32 / t293 * t169 + 0.119e3 / 0.576e3 * t261 * t874 * t490 + 0.7e1 / 0.64e2 * t261 * t486 * t881 - 0.7e1 / 0.192e3 * t261 * t486 * t885 + t261 * t264 * t1153 * t631 / 0.32e2 - 0.3e1 / 0.128e3 * t259 * t260 * sigma[0] * t1496 * t638 + t261 * t264 * t336 * t781 / 0.384e3;
  t1507 = t889 * t112;
  t1554 = t7 * t20;
  t1555 = t558 * t153;
  t1594 = t125 * t547 * t465 / 0.4e1 - 0.3e1 / 0.8e1 * t125 * t279 * t840 - 0.3e1 / 0.8e1 * t125 * t127 * (-0.154e3 / 0.81e2 * t27 * t29 * t485 * t39 + 0.253e3 / 0.162e3 * t140 * t28 * t573 * t455 - 0.1025e4 / 0.486e3 * t303 * t579 * t310 * t141 + 0.89e2 / 0.972e3 * t585 * t589 * t593 * t304 * t21 * t595 - 0.2e1 / 0.729e3 * t1086 * t586 / t19 / t1088 * t1098) - 0.9e1 / 0.8e1 * t1554 * t1555 * t813 - 0.3e1 / 0.8e1 * t125 * t1048 * t560 * t247 - 0.3e1 / 0.8e1 * t125 * t1037 * t809 - 0.5e1 / 0.36e2 * t125 * t1026 * t247 + t125 * t1030 * t446 / 0.4e1 - 0.3e1 / 0.8e1 * t125 * t551 * t813 - 0.3e1 / 0.4e1 * t125 * t551 * t817 - 0.9e1 / 0.8e1 * t125 * t559 * t285 * t465 - 0.3e1 / 0.8e1 * t125 * t284 * t599 * t247 - 0.9e1 / 0.8e1 * t125 * t284 * t314 * t465 - 0.9e1 / 0.8e1 * t125 * t284 * t153 * t840;
  t1595 = my_piecewise3(t3, 0, t1594);
  t1603 = t1109 * t474 * t608 + t112 * t1504 * t161 + 0.3e1 * t268 * t428 * t473 + t322 * t474 * t786 + 0.3e1 * t435 * t474 * t936 + 0.2e1 * t1 * t1595 + 0.6e1 * t1450 * t473 + 0.3e1 * t1507 * t473 + 0.3e1 * t222 * t890 + t269 * t779 + 0.3e1 * t428 * t495 + 0.3e1 * t848 * t852 + 0.3e1 * t848 * t855 + 0.3e1 * t850 * t852 + 0.3e1 * t850 * t855;
  tv4rho3sigma0 = rho[0] * t1603 + 0.6e1 * t846 + 0.3e1 * t849 + 0.3e1 * t851 + 0.6e1 * t853 + 0.6e1 * t856 + 0.3e1 * t891 + 0.6e1 * t892 + 0.3e1 * t894;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1632 = t465 * t465;
  t1684 = t125 * t1030 * t500 / 0.12e2 - t125 * t1037 * t900 / 0.4e1 - t125 * t551 * t904 / 0.2e1 - 0.3e1 / 0.8e1 * t125 * t1048 * t285 * t500 - 0.3e1 / 0.8e1 * t125 * t559 * t314 * t500 - 0.3e1 / 0.2e1 * t1554 * t1555 * t904 - 0.3e1 / 0.4e1 * t125 * t284 * t1632 - 0.3e1 / 0.4e1 * t125 * t284 * t247 * t840 + t125 * t547 * t512 / 0.12e2 - t125 * t551 * t911 / 0.4e1 - t125 * t279 * t928 / 0.4e1 - 0.3e1 / 0.8e1 * t125 * t559 * t285 * t512 - 0.3e1 / 0.8e1 * t125 * t284 * t314 * t512 - 0.3e1 / 0.4e1 * t125 * t284 * t153 * t928 - 0.3e1 / 0.8e1 * t125 * t127 * (-0.19e2 / 0.81e2 * t140 * t825 * t148 + 0.167e3 / 0.324e3 * t303 * t829 * sigma[0] - 0.25e2 / 0.864e3 * t585 * t835 * t593 * t141 * t21 * t595 + t1086 * t304 / t19 / t305 / t293 * t1098 / 0.972e3);
  t1685 = my_piecewise3(t3, 0, t1684);
  t1698 = t494 * t494;
  t1709 = t961 * t112;
  t1712 = t534 * t222;
  t1750 = 0.2e1 * t1 * t1685 + t1109 * t323 * t937 + t607 * t435 * t937 + 0.4e1 * t936 * t474 * t494 + 0.2e1 * t936 * t520 * t222 + 0.2e1 * t322 * t1698 * t112 + 0.4e1 * t939 * t1450 + 0.2e1 * t939 * t1507 + t521 * t428 + t848 * t943 + t850 * t943 + 0.2e1 * t473 * t1709 + 0.2e1 * t473 * t1712 + t161 * (-0.119e3 / 0.1728e4 * t259 * t260 * t873 * t169 - 0.7e1 / 0.144e3 * t261 * t485 * t336 * t224 - t261 * t1496 * t337 / 0.64e2 + t261 * t949 * t430 / 0.192e3 - 0.7e1 / 0.768e3 * t528 * sigma[0] * t460 * t336 - 0.7e1 / 0.1024e4 * t956 * t507 * t630 * t224 - t956 * t529 * t1153 * t337 / 0.512e3 + t956 * t957 * t430 / 0.2048e4) * t112 + 0.2e1 * t962 * t222 + t535 * t428;
  tv4rho2sigma20 = rho[0] * t1750 + 0.4e1 * t934 + 0.2e1 * t938 + 0.4e1 * t940 + 0.2e1 * t942 + 0.2e1 * t944 + 0.2e1 * t963 + 0.2e1 * t964;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1803 = my_piecewise3(t3, 0, -t125 * t1037 * t967 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t1048 * t153 * t967 - 0.9e1 / 0.8e1 * t125 * t559 * t500 * t465 - 0.3e1 / 0.8e1 * t125 * t551 * t971 - 0.9e1 / 0.8e1 * t1554 * t1555 * t971 - 0.9e1 / 0.8e1 * t125 * t284 * t465 * t512 - 0.9e1 / 0.8e1 * t125 * t284 * t247 * t928 - t125 * t279 * t984 / 0.8e1 - 0.3e1 / 0.8e1 * t125 * t284 * t153 * t984 - 0.3e1 / 0.8e1 * t125 * t127 * (-t303 * t918 / 0.12e2 + 0.7e1 / 0.864e3 * t585 * t923 * t593 * t21 * t26 * t30 - t1086 * t141 / t19 / t1078 * t1098 / 0.2592e4));
  t1809 = t607 * t520;
  t1823 = t1010 * t112;
  t1845 = 0.2e1 * t1 * t1803 + t1109 * t229 * t992 * t112 + 0.3e1 * t1809 * t852 + t993 * t222 + 0.3e1 * t936 * t474 * t534 + 0.3e1 * t322 * t494 * t943 + 0.3e1 * t939 * t1712 + 0.3e1 * t939 * t1709 + t473 * t1823 + t161 * (0.7e1 / 0.2048e4 * t528 * t507 * t336 + 0.3e1 / 0.2048e4 * t528 * t958 + 0.7e1 / 0.73728e5 * t1003 / t19 / t306 * t630 * t53 + t1003 * t1005 * t1153 * t53 * t224 / 0.24576e5) * t112 + t1011 * t222;
  tv4rhosigma30 = rho[0] * t1845 + t1012 + t991 + t994 + t996;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1847 = t500 * t500;
  t1855 = t512 * t512;
  t1877 = my_piecewise3(t3, 0, -0.3e1 / 0.8e1 * t125 * t1048 * t1847 - 0.9e1 / 0.4e1 * t125 * t559 * t500 * t512 - 0.9e1 / 0.8e1 * t125 * t284 * t1855 - 0.3e1 / 0.2e1 * t125 * t284 * t247 * t984 - 0.3e1 / 0.8e1 * t125 * t127 * (-t585 * t979 * t596 / 0.576e3 + t1086 * sigma[0] / t19 / t587 * t1098 / 0.6912e4));
  t1880 = t520 * t520;
  t1885 = t534 * t534;
  tv4sigma40 = rho[0] * (0.2e1 * t1 * t1877 + t1109 * t1880 * t112 + 0.6e1 * t1809 * t943 + 0.3e1 * t322 * t1885 * t112 + 0.4e1 * t939 * t1823 + t161 * (-t1002 * t1007 / 0.24576e5 - t1000 * t52 * t260 * M_PI * sigma[0] * t923 * t1153 * t4 / 0.393216e6) * t112);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t40, t42, t46, t47, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t63, t64, t65;
  double t66, t68, t70, t74, t75, t78, t79, t83;
  double t85, t86, t87, t88, t89, t90, t91, t92;
  double t93, t94, t95, t96, t98, t99, t100, t101;
  double t102, t103, t104, t105, t106, t108, t109, t110;
  double t111, t114, t115, t116, t117, t118, t121, t123;
  double t124, t127, t129, t130, t131, t132, t134, t136;
  double t139, t140, t142, t143, t144, t145, t146, t147;
  double t148, t149, t150, t151, t152, t153, t156, t157;
  double t159, t164, t167, t168, t172, t177, t180, t181;
  double t182, t184, t185, t189, t191, t192, t193, t195;
  double t196, t197, tzk0;

  hyb_gga_xc_case21_params *params;

  assert(p->params != NULL);
  params = (hyb_gga_xc_case21_params * )(p->params);

  t1 = 0.1e1 - params->ax;
  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = M_CBRT6;
  t30 = params->gammax * t29;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = t32 * t32;
  t34 = 0.1e1 / t33;
  t35 = t30 * t34;
  t36 = rho[0] * rho[0];
  t37 = POW_1_3(rho[0]);
  t38 = t37 * t37;
  t40 = 0.1e1 / t38 / t36;
  t42 = t34 * sigma[0];
  t46 = 0.1e1 + t30 * t42 * t40 / 0.24e2;
  t47 = 0.1e1 / t46;
  t50 = t35 * sigma[0] * t40 * t47 / 0.24e2;
  t51 = xbspline(t50, 0, params);
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t51);
  t56 = rho[1] <= p->dens_threshold;
  t57 = my_piecewise5(t15, t12, t11, t16, -t18);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t23, t60 * t58);
  t63 = t62 * t27;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t70 = t34 * sigma[2];
  t74 = 0.1e1 + t30 * t70 * t68 / 0.24e2;
  t75 = 0.1e1 / t74;
  t78 = t35 * sigma[2] * t68 * t75 / 0.24e2;
  t79 = xbspline(t78, 0, params);
  t83 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t63 * t79);
  t85 = t1 * (t55 + t83);
  t86 = t18 + 0.1e1;
  t87 = t86 <= p->zeta_threshold;
  t88 = t22 * t22;
  t89 = POW_1_3(t86);
  t90 = t89 * t89;
  t91 = my_piecewise3(t87, t88, t90);
  t92 = 0.1e1 - t18;
  t93 = t92 <= p->zeta_threshold;
  t94 = POW_1_3(t92);
  t95 = t94 * t94;
  t96 = my_piecewise3(t93, t88, t95);
  t98 = t91 / 0.2e1 + t96 / 0.2e1;
  t99 = t3 * t3;
  t100 = t98 * t99;
  t101 = t100 * t4;
  t102 = sqrt(sigma[0]);
  t103 = sqrt(sigma[2]);
  t104 = t102 + t103;
  t105 = t104 * t104;
  t106 = t7 * t7;
  t108 = 0.1e1 / t27 / t106;
  t109 = t105 * t108;
  t110 = t4 * t105;
  t111 = t110 * t108;
  t114 = 0.1e1 / M_PI;
  t115 = POW_1_3(t114);
  t116 = t3 * t115;
  t117 = M_CBRT4;
  t118 = t117 * t117;
  t121 = t116 * t118 / t27;
  t123 = 0.1e1 + 0.53425e-1 * t121;
  t124 = sqrt(t121);
  t127 = POW_3_2(t121);
  t129 = t115 * t115;
  t130 = t99 * t129;
  t131 = t27 * t27;
  t132 = 0.1e1 / t131;
  t134 = t130 * t117 * t132;
  t136 = 0.379785e1 * t124 + 0.8969e0 * t121 + 0.204775e0 * t127 + 0.123235e0 * t134;
  t139 = 0.1e1 + 0.16081979498692535067e2 / t136;
  t140 = log(t139);
  t142 = 0.621814e-1 * t123 * t140;
  t143 = t17 * t17;
  t144 = t143 * t143;
  t145 = t106 * t106;
  t146 = 0.1e1 / t145;
  t147 = t144 * t146;
  t148 = t89 * t86;
  t149 = my_piecewise3(t87, t23, t148);
  t150 = t94 * t92;
  t151 = my_piecewise3(t93, t23, t150);
  t152 = t149 + t151 - 0.2e1;
  t153 = M_CBRT2;
  t156 = 0.1e1 / (0.2e1 * t153 - 0.2e1);
  t157 = t152 * t156;
  t159 = 0.1e1 + 0.5137e-1 * t121;
  t164 = 0.705945e1 * t124 + 0.1549425e1 * t121 + 0.420775e0 * t127 + 0.1562925e0 * t134;
  t167 = 0.1e1 + 0.32163958997385070134e2 / t164;
  t168 = log(t167);
  t172 = 0.1e1 + 0.278125e-1 * t121;
  t177 = 0.51785e1 * t124 + 0.905775e0 * t121 + 0.1100325e0 * t127 + 0.1241775e0 * t134;
  t180 = 0.1e1 + 0.29608749977793437516e2 / t177;
  t181 = log(t180);
  t182 = t172 * t181;
  t184 = -0.310907e-1 * t159 * t168 + t142 - 0.19751673498613801407e-1 * t182;
  t185 = t157 * t184;
  t189 = -t142 + t147 * t185 + 0.19751673498613801407e-1 * t157 * t182;
  t191 = -t100 * t111 / 0.48e2 + params->gammac * t189;
  t192 = 0.1e1 / t191;
  t193 = t109 * t192;
  t195 = t101 * t193 / 0.48e2;
  t196 = cbspline(-t195, 0, params);
  t197 = t196 * t189;
  tzk0 = t85 + t197;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t40, t42, t46, t47, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t63, t64, t65;
  double t66, t68, t70, t74, t75, t78, t79, t83;
  double t85, t86, t87, t88, t89, t90, t91, t92;
  double t93, t94, t95, t96, t98, t99, t100, t101;
  double t102, t103, t104, t105, t106, t108, t109, t110;
  double t111, t114, t115, t116, t117, t118, t121, t123;
  double t124, t127, t129, t130, t131, t132, t134, t136;
  double t139, t140, t142, t143, t144, t145, t146, t147;
  double t148, t149, t150, t151, t152, t153, t156, t157;
  double t159, t164, t167, t168, t172, t177, t180, t181;
  double t182, t184, t185, t189, t191, t192, t193, t195;
  double t196, t197, tzk0;

  double t198, t199, t200, t201, t204, t212, t213, t214;
  double t215, t216, t218, t223, t224, t225, t227, t228;
  double t229, t230, t231, t233, t235, t236, t240, t241;
  double t245, t246, t247, t250, t258, t260, t262, t263;
  double t264, t267, t268, t271, t273, t274, t275, t278;
  double t280, t281, t282, t284, t285, t286, t289, t291;
  double t293, t294, t297, t298, t299, t300, t302, t303;
  double t304, t305, t307, t309, t310, t311, t314, t316;
  double t318, t319, t320, t322, t323, t324, t326, t327;
  double t328, t329, t331, t334, t337, t339, t340, t345;
  double t346, t347, t352, t353, t354, t360, t361, t362;
  double t367, t368, t369, t372, t373, t374, t377, t379;
  double t381, t382, t384, t386, t387, t389, t390, t391;
  double t394, t395, t396, t397, tvrho0, t400, t401, t404;
  double t410, t411, t412, t415, t420, t421, t422, t423;
  double t425, t430, t431, t432, t434, t436, t437, t441;
  double t442, t446, t448, t451, t454, t456, t457, t458;
  double t465, t468, t470, t471, t475, t477, t478, t479;
  double t482, t483, t484, t485, tvrho1, t492, t494, t499;
  double t500, t503, t504, t505, t506, t507, t508, t511;
  double t512, t513, t514, t515, t517, t518, t519, t520;
  double t523, t524, t525, tvsigma0, tvsigma1, t531, t533, t538;
  double t539, t542, t543, t544, t545, t546, t549, t550;
  double t553, t554, t555, tvsigma2;

  hyb_gga_xc_case21_params *params;

  assert(p->params != NULL);
  params = (hyb_gga_xc_case21_params * )(p->params);

  t1 = 0.1e1 - params->ax;
  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = M_CBRT6;
  t30 = params->gammax * t29;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = t32 * t32;
  t34 = 0.1e1 / t33;
  t35 = t30 * t34;
  t36 = rho[0] * rho[0];
  t37 = POW_1_3(rho[0]);
  t38 = t37 * t37;
  t40 = 0.1e1 / t38 / t36;
  t42 = t34 * sigma[0];
  t46 = 0.1e1 + t30 * t42 * t40 / 0.24e2;
  t47 = 0.1e1 / t46;
  t50 = t35 * sigma[0] * t40 * t47 / 0.24e2;
  t51 = xbspline(t50, 0, params);
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t51);
  t56 = rho[1] <= p->dens_threshold;
  t57 = my_piecewise5(t15, t12, t11, t16, -t18);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t23, t60 * t58);
  t63 = t62 * t27;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t70 = t34 * sigma[2];
  t74 = 0.1e1 + t30 * t70 * t68 / 0.24e2;
  t75 = 0.1e1 / t74;
  t78 = t35 * sigma[2] * t68 * t75 / 0.24e2;
  t79 = xbspline(t78, 0, params);
  t83 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t63 * t79);
  t85 = t1 * (t55 + t83);
  t86 = t18 + 0.1e1;
  t87 = t86 <= p->zeta_threshold;
  t88 = t22 * t22;
  t89 = POW_1_3(t86);
  t90 = t89 * t89;
  t91 = my_piecewise3(t87, t88, t90);
  t92 = 0.1e1 - t18;
  t93 = t92 <= p->zeta_threshold;
  t94 = POW_1_3(t92);
  t95 = t94 * t94;
  t96 = my_piecewise3(t93, t88, t95);
  t98 = t91 / 0.2e1 + t96 / 0.2e1;
  t99 = t3 * t3;
  t100 = t98 * t99;
  t101 = t100 * t4;
  t102 = sqrt(sigma[0]);
  t103 = sqrt(sigma[2]);
  t104 = t102 + t103;
  t105 = t104 * t104;
  t106 = t7 * t7;
  t108 = 0.1e1 / t27 / t106;
  t109 = t105 * t108;
  t110 = t4 * t105;
  t111 = t110 * t108;
  t114 = 0.1e1 / M_PI;
  t115 = POW_1_3(t114);
  t116 = t3 * t115;
  t117 = M_CBRT4;
  t118 = t117 * t117;
  t121 = t116 * t118 / t27;
  t123 = 0.1e1 + 0.53425e-1 * t121;
  t124 = sqrt(t121);
  t127 = POW_3_2(t121);
  t129 = t115 * t115;
  t130 = t99 * t129;
  t131 = t27 * t27;
  t132 = 0.1e1 / t131;
  t134 = t130 * t117 * t132;
  t136 = 0.379785e1 * t124 + 0.8969e0 * t121 + 0.204775e0 * t127 + 0.123235e0 * t134;
  t139 = 0.1e1 + 0.16081979498692535067e2 / t136;
  t140 = log(t139);
  t142 = 0.621814e-1 * t123 * t140;
  t143 = t17 * t17;
  t144 = t143 * t143;
  t145 = t106 * t106;
  t146 = 0.1e1 / t145;
  t147 = t144 * t146;
  t148 = t89 * t86;
  t149 = my_piecewise3(t87, t23, t148);
  t150 = t94 * t92;
  t151 = my_piecewise3(t93, t23, t150);
  t152 = t149 + t151 - 0.2e1;
  t153 = M_CBRT2;
  t156 = 0.1e1 / (0.2e1 * t153 - 0.2e1);
  t157 = t152 * t156;
  t159 = 0.1e1 + 0.5137e-1 * t121;
  t164 = 0.705945e1 * t124 + 0.1549425e1 * t121 + 0.420775e0 * t127 + 0.1562925e0 * t134;
  t167 = 0.1e1 + 0.32163958997385070134e2 / t164;
  t168 = log(t167);
  t172 = 0.1e1 + 0.278125e-1 * t121;
  t177 = 0.51785e1 * t124 + 0.905775e0 * t121 + 0.1100325e0 * t127 + 0.1241775e0 * t134;
  t180 = 0.1e1 + 0.29608749977793437516e2 / t177;
  t181 = log(t180);
  t182 = t172 * t181;
  t184 = -0.310907e-1 * t159 * t168 + t142 - 0.19751673498613801407e-1 * t182;
  t185 = t157 * t184;
  t189 = -t142 + t147 * t185 + 0.19751673498613801407e-1 * t157 * t182;
  t191 = -t100 * t111 / 0.48e2 + params->gammac * t189;
  t192 = 0.1e1 / t191;
  t193 = t109 * t192;
  t195 = t101 * t193 / 0.48e2;
  t196 = cbspline(-t195, 0, params);
  t197 = t196 * t189;
  tzk0 = t85 + t197;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t198 = 0.1e1 / t106;
  t199 = t17 * t198;
  t200 = t8 - t199;
  t201 = my_piecewise5(t11, 0, t15, 0, t200);
  t204 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t201);
  t212 = t6 * t26 * t132 * t51 / 0.8e1;
  t213 = t6 * t26;
  t214 = xbspline(t50, 1, params);
  t215 = t27 * t214;
  t216 = t36 * rho[0];
  t218 = 0.1e1 / t38 / t216;
  t223 = params->gammax * params->gammax;
  t224 = t29 * t29;
  t225 = t223 * t224;
  t227 = 0.1e1 / t32 / t31;
  t228 = t225 * t227;
  t229 = sigma[0] * sigma[0];
  t230 = t36 * t36;
  t231 = t230 * t36;
  t233 = 0.1e1 / t37 / t231;
  t235 = t46 * t46;
  t236 = 0.1e1 / t235;
  t240 = -t35 * sigma[0] * t218 * t47 / 0.9e1 + t228 * t229 * t233 * t236 / 0.216e3;
  t241 = t215 * t240;
  t245 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t27 * t51 - t212 - 0.3e1 / 0.8e1 * t213 * t241);
  t246 = -t200;
  t247 = my_piecewise5(t15, 0, t11, 0, t246);
  t250 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t247);
  t258 = t6 * t62 * t132 * t79 / 0.8e1;
  t260 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t250 * t27 * t79 - t258);
  t262 = t1 * (t245 + t260);
  t263 = cbspline(-t195, 1, params);
  t264 = 0.1e1 / t89;
  t267 = my_piecewise3(t87, 0, 0.2e1 / 0.3e1 * t264 * t200);
  t268 = 0.1e1 / t94;
  t271 = my_piecewise3(t93, 0, 0.2e1 / 0.3e1 * t268 * t246);
  t273 = t267 / 0.2e1 + t271 / 0.2e1;
  t274 = t273 * t99;
  t275 = t274 * t4;
  t278 = t106 * t7;
  t280 = 0.1e1 / t27 / t278;
  t281 = t105 * t280;
  t282 = t281 * t192;
  t284 = 0.7e1 / 0.144e3 * t101 * t282;
  t285 = t191 * t191;
  t286 = 0.1e1 / t285;
  t289 = t110 * t280;
  t291 = 0.7e1 / 0.144e3 * t100 * t289;
  t293 = 0.1e1 / t27 / t7;
  t294 = t118 * t293;
  t297 = 0.11073470983333333333e-2 * t116 * t294 * t140;
  t298 = t136 * t136;
  t299 = 0.1e1 / t298;
  t300 = t123 * t299;
  t302 = 0.1e1 / t124 * t3;
  t303 = t115 * t118;
  t304 = t303 * t293;
  t305 = t302 * t304;
  t307 = t116 * t294;
  t309 = sqrt(t121);
  t310 = t309 * t3;
  t311 = t310 * t304;
  t314 = 0.1e1 / t131 / t7;
  t316 = t130 * t117 * t314;
  t318 = -0.632975e0 * t305 - 0.29896666666666666667e0 * t307 - 0.1023875e0 * t311 - 0.82156666666666666667e-1 * t316;
  t319 = 0.1e1 / t139;
  t320 = t318 * t319;
  t322 = 0.1e1 * t300 * t320;
  t323 = t143 * t17;
  t324 = t323 * t146;
  t326 = 0.4e1 * t324 * t185;
  t327 = t145 * t7;
  t328 = 0.1e1 / t327;
  t329 = t144 * t328;
  t331 = 0.4e1 * t329 * t185;
  t334 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t89 * t200);
  t337 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t246);
  t339 = (t334 + t337) * t156;
  t340 = t339 * t184;
  t345 = t164 * t164;
  t346 = 0.1e1 / t345;
  t347 = t159 * t346;
  t352 = -0.1176575e1 * t305 - 0.516475e0 * t307 - 0.2103875e0 * t311 - 0.104195e0 * t316;
  t353 = 0.1e1 / t167;
  t354 = t352 * t353;
  t360 = t177 * t177;
  t361 = 0.1e1 / t360;
  t362 = t172 * t361;
  t367 = -0.86308333333333333334e0 * t305 - 0.301925e0 * t307 - 0.5501625e-1 * t311 - 0.82785e-1 * t316;
  t368 = 0.1e1 / t180;
  t369 = t367 * t368;
  t372 = 0.53237641966666666666e-3 * t116 * t294 * t168 + 0.1e1 * t347 * t354 - t297 - t322 + 0.18311447306006545054e-3 * t116 * t294 * t181 + 0.5848223622634646207e0 * t362 * t369;
  t373 = t157 * t372;
  t374 = t147 * t373;
  t377 = t157 * t3;
  t379 = t303 * t293 * t181;
  t381 = 0.18311447306006545054e-3 * t377 * t379;
  t382 = t157 * t172;
  t384 = t361 * t367 * t368;
  t386 = 0.5848223622634646207e0 * t382 * t384;
  t387 = t297 + t322 + t326 - t331 + t147 * t340 + t374 + 0.19751673498613801407e-1 * t339 * t182 - t381 - t386;
  t389 = -t274 * t111 / 0.48e2 + t291 + params->gammac * t387;
  t390 = t286 * t389;
  t391 = t109 * t390;
  t394 = -t275 * t193 / 0.48e2 + t284 + t101 * t391 / 0.48e2;
  t395 = t263 * t394;
  t396 = t395 * t189;
  t397 = t196 * t387;
  tvrho0 = t85 + t197 + t7 * (t262 + t396 + t397);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t400 = -t8 - t199;
  t401 = my_piecewise5(t11, 0, t15, 0, t400);
  t404 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t401);
  t410 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t404 * t27 * t51 - t212);
  t411 = -t400;
  t412 = my_piecewise5(t15, 0, t11, 0, t411);
  t415 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t412);
  t420 = t6 * t62;
  t421 = xbspline(t78, 1, params);
  t422 = t27 * t421;
  t423 = t64 * rho[1];
  t425 = 0.1e1 / t66 / t423;
  t430 = sigma[2] * sigma[2];
  t431 = t64 * t64;
  t432 = t431 * t64;
  t434 = 0.1e1 / t65 / t432;
  t436 = t74 * t74;
  t437 = 0.1e1 / t436;
  t441 = -t35 * sigma[2] * t425 * t75 / 0.9e1 + t228 * t430 * t434 * t437 / 0.216e3;
  t442 = t422 * t441;
  t446 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t415 * t27 * t79 - t258 - 0.3e1 / 0.8e1 * t420 * t442);
  t448 = t1 * (t410 + t446);
  t451 = my_piecewise3(t87, 0, 0.2e1 / 0.3e1 * t264 * t400);
  t454 = my_piecewise3(t93, 0, 0.2e1 / 0.3e1 * t268 * t411);
  t456 = t451 / 0.2e1 + t454 / 0.2e1;
  t457 = t456 * t99;
  t458 = t457 * t4;
  t465 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t89 * t400);
  t468 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t411);
  t470 = (t465 + t468) * t156;
  t471 = t470 * t184;
  t475 = t297 + t322 - t326 - t331 + t147 * t471 + t374 + 0.19751673498613801407e-1 * t470 * t182 - t381 - t386;
  t477 = -t457 * t111 / 0.48e2 + t291 + params->gammac * t475;
  t478 = t286 * t477;
  t479 = t109 * t478;
  t482 = -t458 * t193 / 0.48e2 + t284 + t101 * t479 / 0.48e2;
  t483 = t263 * t482;
  t484 = t483 * t189;
  t485 = t196 * t475;
  tvrho1 = t85 + t197 + t7 * (t448 + t484 + t485);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t492 = t230 * rho[0];
  t494 = 0.1e1 / t37 / t492;
  t499 = t30 * t34 * t40 * t47 / 0.24e2 - t228 * sigma[0] * t494 * t236 / 0.576e3;
  t500 = t215 * t499;
  t503 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t213 * t500);
  t504 = t1 * t503;
  t505 = t104 * t108;
  t506 = 0.1e1 / t102;
  t507 = t192 * t506;
  t508 = t505 * t507;
  t511 = t98 * t98;
  t512 = t511 * t3;
  t513 = t4 * t4;
  t514 = t512 * t513;
  t515 = t105 * t104;
  t517 = 0.1e1 / t131 / t145;
  t518 = t515 * t517;
  t519 = t286 * t506;
  t520 = t518 * t519;
  t523 = -t101 * t508 / 0.48e2 - t514 * t520 / 0.768e3;
  t524 = t263 * t523;
  t525 = t524 * t189;
  tvsigma0 = t7 * (t504 + t525);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t531 = t431 * rho[1];
  t533 = 0.1e1 / t65 / t531;
  t538 = t30 * t34 * t68 * t75 / 0.24e2 - t228 * sigma[2] * t533 * t437 / 0.576e3;
  t539 = t422 * t538;
  t542 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t420 * t539);
  t543 = t1 * t542;
  t544 = 0.1e1 / t103;
  t545 = t192 * t544;
  t546 = t505 * t545;
  t549 = t286 * t544;
  t550 = t518 * t549;
  t553 = -t101 * t546 / 0.48e2 - t514 * t550 / 0.768e3;
  t554 = t263 * t553;
  t555 = t554 * t189;
  tvsigma2 = t7 * (t543 + t555);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t40, t42, t46, t47, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t63, t64, t65;
  double t66, t68, t70, t74, t75, t78, t79, t83;
  double t85, t86, t87, t88, t89, t90, t91, t92;
  double t93, t94, t95, t96, t98, t99, t100, t101;
  double t102, t103, t104, t105, t106, t108, t109, t110;
  double t111, t114, t115, t116, t117, t118, t121, t123;
  double t124, t127, t129, t130, t131, t132, t134, t136;
  double t139, t140, t142, t143, t144, t145, t146, t147;
  double t148, t149, t150, t151, t152, t153, t156, t157;
  double t159, t164, t167, t168, t172, t177, t180, t181;
  double t182, t184, t185, t189, t191, t192, t193, t195;
  double t196, t197, tzk0;

  double t198, t199, t200, t201, t204, t212, t213, t214;
  double t215, t216, t218, t223, t224, t225, t227, t228;
  double t229, t230, t231, t233, t235, t236, t240, t241;
  double t245, t246, t247, t250, t258, t260, t262, t263;
  double t264, t267, t268, t271, t273, t274, t275, t278;
  double t280, t281, t282, t284, t285, t286, t289, t291;
  double t293, t294, t297, t298, t299, t300, t302, t303;
  double t304, t305, t307, t309, t310, t311, t314, t316;
  double t318, t319, t320, t322, t323, t324, t326, t327;
  double t328, t329, t331, t334, t337, t339, t340, t345;
  double t346, t347, t352, t353, t354, t360, t361, t362;
  double t367, t368, t369, t372, t373, t374, t377, t379;
  double t381, t382, t384, t386, t387, t389, t390, t391;
  double t394, t395, t396, t397, tvrho0, t400, t401, t404;
  double t410, t411, t412, t415, t420, t421, t422, t423;
  double t425, t430, t431, t432, t434, t436, t437, t441;
  double t442, t446, t448, t451, t454, t456, t457, t458;
  double t465, t468, t470, t471, t475, t477, t478, t479;
  double t482, t483, t484, t485, tvrho1, t492, t494, t499;
  double t500, t503, t504, t505, t506, t507, t508, t511;
  double t512, t513, t514, t515, t517, t518, t519, t520;
  double t523, t524, t525, tvsigma0, tvsigma1, t531, t533, t538;
  double t539, t542, t543, t544, t545, t546, t549, t550;
  double t553, t554, t555, tvsigma2;

  double t560, t561, t562, t565, t566, t568, t569, t573;
  double t580, t582, t588, t589, t590, t591, t593, t594;
  double t595, t596, t600, t605, t607, t613, t614, t615;
  double t616, t617, t618, t619, t622, t626, t627, t631;
  double t632, t633, t634, t637, t638, t642, t649, t654;
  double t656, t658, t659, t660, t661, t662, t663, t664;
  double t670, t671, t672, t678, t680, t681, t682, t685;
  double t690, t691, t692, t694, t695, t696, t699, t700;
  double t701, t702, t707, t709, t711, t712, t713, t714;
  double t715, t716, t717, t718, t720, t723, t724, t726;
  double t727, t728, t730, t731, t733, t734, t736, t737;
  double t738, t740, t743, t745, t747, t749, t750, t751;
  double t753, t754, t755, t757, t761, t762, t766, t767;
  double t768, t769, t770, t779, t780, t783, t784, t785;
  double t786, t787, t788, t793, t794, t797, t798, t799;
  double t800, t801, t802, t804, t811, t812, t814, t815;
  double t816, t817, t818, t819, t820, t822, t826, t830;
  double t831, t832, t833, t836, t839, t840, t843, t844;
  double t845, t846, t852, t853, t859, t861, t862, t864;
  double t865, t867, t870, t871, t874, t875, t876, t878;
  double t879, t881, t885, t887, t888, t889, t892, t894;
  double t895, t896, t898, t899, t900, t902, t903, t904;
  double t907, t908, t909, t910, t911, t912, tv2rho20, t915;
  double t918, t919, t923, t930, t932, t938, t939, t942;
  double t946, t953, t956, t959, t960, t961, t964, t966;
  double t967, t968, t969, t970, t973, t977, t978, t981;
  double t985, t987, t988, t989, t992, t1000, t1001, t1003;
  double t1004, t1005, t1006, t1011, t1014, t1015, t1018, t1020;
  double t1023, t1024, t1027, t1031, t1032, t1035, t1039, t1041;
  double t1042, t1044, t1045, t1050, t1051, t1053, t1054, t1056;
  double t1057, t1058, t1061, t1062, t1063, t1064, t1065, t1066;
  double tv2rho21, t1072, t1076, t1077, t1081, t1088, t1089, t1092;
  double t1093, t1097, t1103, t1107, t1108, t1109, t1110, t1114;
  double t1119, t1121, t1126, t1127, t1128, t1129, t1132, t1136;
  double t1137, t1141, t1143, t1144, t1145, t1146, t1147, t1153;
  double t1154, t1160, t1162, t1163, t1164, t1171, t1172, t1173;
  double t1184, t1190, t1192, t1193, t1201, t1203, t1204, t1206;
  double t1207, t1208, t1211, t1212, t1213, t1214, t1215, t1216;
  double tv2rho22, t1221, t1223, t1224, t1225, t1236, t1237, t1242;
  double t1243, t1247, t1248, t1249, t1250, t1253, t1254, t1256;
  double t1257, t1258, t1259, t1260, t1261, t1264, t1265, t1266;
  double t1267, t1268, t1273, t1274, t1275, t1277, t1278, t1279;
  double t1280, t1283, t1284, t1285, t1286, tv2rhosigma0, tv2rhosigma1, t1291;
  double t1293, t1295, t1296, t1297, t1298, t1301, t1303, t1304;
  double t1305, t1308, t1312, t1314, t1315, t1318, t1319, t1320;
  double t1321, tv2rhosigma2, t1327, t1328, t1329, t1330, t1333, t1334;
  double t1337, t1338, t1341, t1344, t1345, t1346, t1347, tv2rhosigma3;
  double tv2rhosigma4, t1352, t1353, t1364, t1365, t1370, t1371, t1375;
  double t1376, t1377, t1380, t1381, t1384, t1385, t1388, t1391;
  double t1392, t1393, t1394, tv2rhosigma5, t1397, t1398, t1404, t1409;
  double t1410, t1414, t1415, t1416, t1417, t1418, t1419, t1420;
  double t1421, t1424, t1425, t1426, t1430, t1431, t1432, t1435;
  double t1436, t1437, t1438, t1439, t1440, t1441, t1445, t1446;
  double t1449, t1450, t1451, tv2sigma20, tv2sigma21, t1453, t1454, t1455;
  double t1456, t1459, t1460, t1461, t1462, t1468, t1469, t1470;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1472, t1473, t1479, t1484, t1485;
  double t1489, t1490, t1491, t1492, t1493, t1494, t1495, t1496;
  double t1499, t1500, t1504, t1505, t1506, t1512, t1513, t1516;
  double t1517, t1518, tv2sigma25;

  hyb_gga_xc_case21_params *params;

  assert(p->params != NULL);
  params = (hyb_gga_xc_case21_params * )(p->params);

  t1 = 0.1e1 - params->ax;
  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = M_CBRT6;
  t30 = params->gammax * t29;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = t32 * t32;
  t34 = 0.1e1 / t33;
  t35 = t30 * t34;
  t36 = rho[0] * rho[0];
  t37 = POW_1_3(rho[0]);
  t38 = t37 * t37;
  t40 = 0.1e1 / t38 / t36;
  t42 = t34 * sigma[0];
  t46 = 0.1e1 + t30 * t42 * t40 / 0.24e2;
  t47 = 0.1e1 / t46;
  t50 = t35 * sigma[0] * t40 * t47 / 0.24e2;
  t51 = xbspline(t50, 0, params);
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t51);
  t56 = rho[1] <= p->dens_threshold;
  t57 = my_piecewise5(t15, t12, t11, t16, -t18);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t23, t60 * t58);
  t63 = t62 * t27;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t70 = t34 * sigma[2];
  t74 = 0.1e1 + t30 * t70 * t68 / 0.24e2;
  t75 = 0.1e1 / t74;
  t78 = t35 * sigma[2] * t68 * t75 / 0.24e2;
  t79 = xbspline(t78, 0, params);
  t83 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t63 * t79);
  t85 = t1 * (t55 + t83);
  t86 = t18 + 0.1e1;
  t87 = t86 <= p->zeta_threshold;
  t88 = t22 * t22;
  t89 = POW_1_3(t86);
  t90 = t89 * t89;
  t91 = my_piecewise3(t87, t88, t90);
  t92 = 0.1e1 - t18;
  t93 = t92 <= p->zeta_threshold;
  t94 = POW_1_3(t92);
  t95 = t94 * t94;
  t96 = my_piecewise3(t93, t88, t95);
  t98 = t91 / 0.2e1 + t96 / 0.2e1;
  t99 = t3 * t3;
  t100 = t98 * t99;
  t101 = t100 * t4;
  t102 = sqrt(sigma[0]);
  t103 = sqrt(sigma[2]);
  t104 = t102 + t103;
  t105 = t104 * t104;
  t106 = t7 * t7;
  t108 = 0.1e1 / t27 / t106;
  t109 = t105 * t108;
  t110 = t4 * t105;
  t111 = t110 * t108;
  t114 = 0.1e1 / M_PI;
  t115 = POW_1_3(t114);
  t116 = t3 * t115;
  t117 = M_CBRT4;
  t118 = t117 * t117;
  t121 = t116 * t118 / t27;
  t123 = 0.1e1 + 0.53425e-1 * t121;
  t124 = sqrt(t121);
  t127 = POW_3_2(t121);
  t129 = t115 * t115;
  t130 = t99 * t129;
  t131 = t27 * t27;
  t132 = 0.1e1 / t131;
  t134 = t130 * t117 * t132;
  t136 = 0.379785e1 * t124 + 0.8969e0 * t121 + 0.204775e0 * t127 + 0.123235e0 * t134;
  t139 = 0.1e1 + 0.16081979498692535067e2 / t136;
  t140 = log(t139);
  t142 = 0.621814e-1 * t123 * t140;
  t143 = t17 * t17;
  t144 = t143 * t143;
  t145 = t106 * t106;
  t146 = 0.1e1 / t145;
  t147 = t144 * t146;
  t148 = t89 * t86;
  t149 = my_piecewise3(t87, t23, t148);
  t150 = t94 * t92;
  t151 = my_piecewise3(t93, t23, t150);
  t152 = t149 + t151 - 0.2e1;
  t153 = M_CBRT2;
  t156 = 0.1e1 / (0.2e1 * t153 - 0.2e1);
  t157 = t152 * t156;
  t159 = 0.1e1 + 0.5137e-1 * t121;
  t164 = 0.705945e1 * t124 + 0.1549425e1 * t121 + 0.420775e0 * t127 + 0.1562925e0 * t134;
  t167 = 0.1e1 + 0.32163958997385070134e2 / t164;
  t168 = log(t167);
  t172 = 0.1e1 + 0.278125e-1 * t121;
  t177 = 0.51785e1 * t124 + 0.905775e0 * t121 + 0.1100325e0 * t127 + 0.1241775e0 * t134;
  t180 = 0.1e1 + 0.29608749977793437516e2 / t177;
  t181 = log(t180);
  t182 = t172 * t181;
  t184 = -0.310907e-1 * t159 * t168 + t142 - 0.19751673498613801407e-1 * t182;
  t185 = t157 * t184;
  t189 = -t142 + t147 * t185 + 0.19751673498613801407e-1 * t157 * t182;
  t191 = -t100 * t111 / 0.48e2 + params->gammac * t189;
  t192 = 0.1e1 / t191;
  t193 = t109 * t192;
  t195 = t101 * t193 / 0.48e2;
  t196 = cbspline(-t195, 0, params);
  t197 = t196 * t189;
  tzk0 = t85 + t197;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t198 = 0.1e1 / t106;
  t199 = t17 * t198;
  t200 = t8 - t199;
  t201 = my_piecewise5(t11, 0, t15, 0, t200);
  t204 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t201);
  t212 = t6 * t26 * t132 * t51 / 0.8e1;
  t213 = t6 * t26;
  t214 = xbspline(t50, 1, params);
  t215 = t27 * t214;
  t216 = t36 * rho[0];
  t218 = 0.1e1 / t38 / t216;
  t223 = params->gammax * params->gammax;
  t224 = t29 * t29;
  t225 = t223 * t224;
  t227 = 0.1e1 / t32 / t31;
  t228 = t225 * t227;
  t229 = sigma[0] * sigma[0];
  t230 = t36 * t36;
  t231 = t230 * t36;
  t233 = 0.1e1 / t37 / t231;
  t235 = t46 * t46;
  t236 = 0.1e1 / t235;
  t240 = -t35 * sigma[0] * t218 * t47 / 0.9e1 + t228 * t229 * t233 * t236 / 0.216e3;
  t241 = t215 * t240;
  t245 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t27 * t51 - t212 - 0.3e1 / 0.8e1 * t213 * t241);
  t246 = -t200;
  t247 = my_piecewise5(t15, 0, t11, 0, t246);
  t250 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t247);
  t258 = t6 * t62 * t132 * t79 / 0.8e1;
  t260 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t250 * t27 * t79 - t258);
  t262 = t1 * (t245 + t260);
  t263 = cbspline(-t195, 1, params);
  t264 = 0.1e1 / t89;
  t267 = my_piecewise3(t87, 0, 0.2e1 / 0.3e1 * t264 * t200);
  t268 = 0.1e1 / t94;
  t271 = my_piecewise3(t93, 0, 0.2e1 / 0.3e1 * t268 * t246);
  t273 = t267 / 0.2e1 + t271 / 0.2e1;
  t274 = t273 * t99;
  t275 = t274 * t4;
  t278 = t106 * t7;
  t280 = 0.1e1 / t27 / t278;
  t281 = t105 * t280;
  t282 = t281 * t192;
  t284 = 0.7e1 / 0.144e3 * t101 * t282;
  t285 = t191 * t191;
  t286 = 0.1e1 / t285;
  t289 = t110 * t280;
  t291 = 0.7e1 / 0.144e3 * t100 * t289;
  t293 = 0.1e1 / t27 / t7;
  t294 = t118 * t293;
  t297 = 0.11073470983333333333e-2 * t116 * t294 * t140;
  t298 = t136 * t136;
  t299 = 0.1e1 / t298;
  t300 = t123 * t299;
  t302 = 0.1e1 / t124 * t3;
  t303 = t115 * t118;
  t304 = t303 * t293;
  t305 = t302 * t304;
  t307 = t116 * t294;
  t309 = sqrt(t121);
  t310 = t309 * t3;
  t311 = t310 * t304;
  t314 = 0.1e1 / t131 / t7;
  t316 = t130 * t117 * t314;
  t318 = -0.632975e0 * t305 - 0.29896666666666666667e0 * t307 - 0.1023875e0 * t311 - 0.82156666666666666667e-1 * t316;
  t319 = 0.1e1 / t139;
  t320 = t318 * t319;
  t322 = 0.1e1 * t300 * t320;
  t323 = t143 * t17;
  t324 = t323 * t146;
  t326 = 0.4e1 * t324 * t185;
  t327 = t145 * t7;
  t328 = 0.1e1 / t327;
  t329 = t144 * t328;
  t331 = 0.4e1 * t329 * t185;
  t334 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t89 * t200);
  t337 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t246);
  t339 = (t334 + t337) * t156;
  t340 = t339 * t184;
  t345 = t164 * t164;
  t346 = 0.1e1 / t345;
  t347 = t159 * t346;
  t352 = -0.1176575e1 * t305 - 0.516475e0 * t307 - 0.2103875e0 * t311 - 0.104195e0 * t316;
  t353 = 0.1e1 / t167;
  t354 = t352 * t353;
  t360 = t177 * t177;
  t361 = 0.1e1 / t360;
  t362 = t172 * t361;
  t367 = -0.86308333333333333334e0 * t305 - 0.301925e0 * t307 - 0.5501625e-1 * t311 - 0.82785e-1 * t316;
  t368 = 0.1e1 / t180;
  t369 = t367 * t368;
  t372 = 0.53237641966666666666e-3 * t116 * t294 * t168 + 0.1e1 * t347 * t354 - t297 - t322 + 0.18311447306006545054e-3 * t116 * t294 * t181 + 0.5848223622634646207e0 * t362 * t369;
  t373 = t157 * t372;
  t374 = t147 * t373;
  t377 = t157 * t3;
  t379 = t303 * t293 * t181;
  t381 = 0.18311447306006545054e-3 * t377 * t379;
  t382 = t157 * t172;
  t384 = t361 * t367 * t368;
  t386 = 0.5848223622634646207e0 * t382 * t384;
  t387 = t297 + t322 + t326 - t331 + t147 * t340 + t374 + 0.19751673498613801407e-1 * t339 * t182 - t381 - t386;
  t389 = -t274 * t111 / 0.48e2 + t291 + params->gammac * t387;
  t390 = t286 * t389;
  t391 = t109 * t390;
  t394 = -t275 * t193 / 0.48e2 + t284 + t101 * t391 / 0.48e2;
  t395 = t263 * t394;
  t396 = t395 * t189;
  t397 = t196 * t387;
  tvrho0 = t85 + t197 + t7 * (t262 + t396 + t397);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t400 = -t8 - t199;
  t401 = my_piecewise5(t11, 0, t15, 0, t400);
  t404 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t401);
  t410 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t404 * t27 * t51 - t212);
  t411 = -t400;
  t412 = my_piecewise5(t15, 0, t11, 0, t411);
  t415 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t412);
  t420 = t6 * t62;
  t421 = xbspline(t78, 1, params);
  t422 = t27 * t421;
  t423 = t64 * rho[1];
  t425 = 0.1e1 / t66 / t423;
  t430 = sigma[2] * sigma[2];
  t431 = t64 * t64;
  t432 = t431 * t64;
  t434 = 0.1e1 / t65 / t432;
  t436 = t74 * t74;
  t437 = 0.1e1 / t436;
  t441 = -t35 * sigma[2] * t425 * t75 / 0.9e1 + t228 * t430 * t434 * t437 / 0.216e3;
  t442 = t422 * t441;
  t446 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t415 * t27 * t79 - t258 - 0.3e1 / 0.8e1 * t420 * t442);
  t448 = t1 * (t410 + t446);
  t451 = my_piecewise3(t87, 0, 0.2e1 / 0.3e1 * t264 * t400);
  t454 = my_piecewise3(t93, 0, 0.2e1 / 0.3e1 * t268 * t411);
  t456 = t451 / 0.2e1 + t454 / 0.2e1;
  t457 = t456 * t99;
  t458 = t457 * t4;
  t465 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t89 * t400);
  t468 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t411);
  t470 = (t465 + t468) * t156;
  t471 = t470 * t184;
  t475 = t297 + t322 - t326 - t331 + t147 * t471 + t374 + 0.19751673498613801407e-1 * t470 * t182 - t381 - t386;
  t477 = -t457 * t111 / 0.48e2 + t291 + params->gammac * t475;
  t478 = t286 * t477;
  t479 = t109 * t478;
  t482 = -t458 * t193 / 0.48e2 + t284 + t101 * t479 / 0.48e2;
  t483 = t263 * t482;
  t484 = t483 * t189;
  t485 = t196 * t475;
  tvrho1 = t85 + t197 + t7 * (t448 + t484 + t485);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t492 = t230 * rho[0];
  t494 = 0.1e1 / t37 / t492;
  t499 = t30 * t34 * t40 * t47 / 0.24e2 - t228 * sigma[0] * t494 * t236 / 0.576e3;
  t500 = t215 * t499;
  t503 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t213 * t500);
  t504 = t1 * t503;
  t505 = t104 * t108;
  t506 = 0.1e1 / t102;
  t507 = t192 * t506;
  t508 = t505 * t507;
  t511 = t98 * t98;
  t512 = t511 * t3;
  t513 = t4 * t4;
  t514 = t512 * t513;
  t515 = t105 * t104;
  t517 = 0.1e1 / t131 / t145;
  t518 = t515 * t517;
  t519 = t286 * t506;
  t520 = t518 * t519;
  t523 = -t101 * t508 / 0.48e2 - t514 * t520 / 0.768e3;
  t524 = t263 * t523;
  t525 = t524 * t189;
  tvsigma0 = t7 * (t504 + t525);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t531 = t431 * rho[1];
  t533 = 0.1e1 / t65 / t531;
  t538 = t30 * t34 * t68 * t75 / 0.24e2 - t228 * sigma[2] * t533 * t437 / 0.576e3;
  t539 = t422 * t538;
  t542 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t420 * t539);
  t543 = t1 * t542;
  t544 = 0.1e1 / t103;
  t545 = t192 * t544;
  t546 = t505 * t545;
  t549 = t286 * t544;
  t550 = t518 * t549;
  t553 = -t101 * t546 / 0.48e2 - t514 * t550 / 0.768e3;
  t554 = t263 * t553;
  t555 = t554 * t189;
  tvsigma2 = t7 * (t543 + t555);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t560 = t24 * t24;
  t561 = 0.1e1 / t560;
  t562 = t201 * t201;
  t565 = 0.1e1 / t278;
  t566 = t17 * t565;
  t568 = -0.2e1 * t198 + 0.2e1 * t566;
  t569 = my_piecewise5(t11, 0, t15, 0, t568);
  t573 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t561 * t562 + 0.4e1 / 0.3e1 * t24 * t569);
  t580 = t6 * t204 * t132 * t51;
  t582 = t6 * t204;
  t588 = t6 * t26 * t314 * t51 / 0.12e2;
  t589 = t132 * t214;
  t590 = t589 * t240;
  t591 = t213 * t590;
  t593 = xbspline(t50, 2, params);
  t594 = t27 * t593;
  t595 = t240 * t240;
  t596 = t594 * t595;
  t600 = 0.1e1 / t38 / t230;
  t605 = t230 * t216;
  t607 = 0.1e1 / t37 / t605;
  t613 = t31 * t31;
  t614 = 0.1e1 / t613;
  t615 = t223 * params->gammax * t614;
  t616 = t229 * sigma[0];
  t617 = t230 * t230;
  t618 = t617 * t36;
  t619 = 0.1e1 / t618;
  t622 = 0.1e1 / t235 / t46;
  t626 = 0.11e2 / 0.27e2 * t35 * sigma[0] * t600 * t47 - t228 * t229 * t607 * t236 / 0.24e2 + t615 * t616 * t619 * t622 / 0.162e3;
  t627 = t215 * t626;
  t631 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t573 * t27 * t51 - t580 / 0.4e1 - 0.3e1 / 0.4e1 * t582 * t241 + t588 - t591 / 0.4e1 - 0.3e1 / 0.8e1 * t213 * t596 - 0.3e1 / 0.8e1 * t213 * t627);
  t632 = t60 * t60;
  t633 = 0.1e1 / t632;
  t634 = t247 * t247;
  t637 = -t568;
  t638 = my_piecewise5(t15, 0, t11, 0, t637);
  t642 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t633 * t634 + 0.4e1 / 0.3e1 * t60 * t638);
  t649 = t6 * t250 * t132 * t79;
  t654 = t6 * t62 * t314 * t79 / 0.12e2;
  t656 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t642 * t27 * t79 - t649 / 0.4e1 + t654);
  t658 = t1 * (t631 + t656);
  t659 = cbspline(-t195, 2, params);
  t660 = t394 * t394;
  t661 = t659 * t660;
  t662 = t661 * t189;
  t663 = 0.1e1 / t148;
  t664 = t200 * t200;
  t670 = my_piecewise3(t87, 0, -0.2e1 / 0.9e1 * t663 * t664 + 0.2e1 / 0.3e1 * t264 * t568);
  t671 = 0.1e1 / t150;
  t672 = t246 * t246;
  t678 = my_piecewise3(t93, 0, -0.2e1 / 0.9e1 * t671 * t672 + 0.2e1 / 0.3e1 * t268 * t637);
  t680 = t670 / 0.2e1 + t678 / 0.2e1;
  t681 = t680 * t99;
  t682 = t681 * t4;
  t685 = t275 * t282;
  t690 = 0.1e1 / t27 / t145;
  t691 = t105 * t690;
  t692 = t691 * t192;
  t694 = 0.35e2 / 0.216e3 * t101 * t692;
  t695 = t281 * t390;
  t696 = t101 * t695;
  t699 = 0.1e1 / t285 / t191;
  t700 = t389 * t389;
  t701 = t699 * t700;
  t702 = t109 * t701;
  t707 = t274 * t289;
  t709 = t110 * t690;
  t711 = 0.35e2 / 0.216e3 * t100 * t709;
  t712 = t360 * t360;
  t713 = 0.1e1 / t712;
  t714 = t367 * t367;
  t715 = t713 * t714;
  t716 = t180 * t180;
  t717 = 0.1e1 / t716;
  t718 = t715 * t717;
  t720 = 0.17315859105681463759e2 * t382 * t718;
  t723 = 0.1e1 / t124 / t121 * t99;
  t724 = t129 * t117;
  t726 = 0.1e1 / t131 / t106;
  t727 = t724 * t726;
  t728 = t723 * t727;
  t730 = t303 * t108;
  t731 = t302 * t730;
  t733 = t118 * t108;
  t734 = t116 * t733;
  t736 = 0.1e1/sqrt(t121);
  t737 = t736 * t99;
  t738 = t737 * t727;
  t740 = t310 * t730;
  t743 = t130 * t117 * t726;
  t745 = -0.57538888888888888889e0 * t728 + 0.11507777777777777778e1 * t731 + 0.40256666666666666667e0 * t734 + 0.366775e-1 * t738 + 0.73355e-1 * t740 + 0.137975e0 * t743;
  t747 = t361 * t745 * t368;
  t749 = 0.5848223622634646207e0 * t382 * t747;
  t750 = t339 * t172;
  t751 = t750 * t384;
  t753 = t145 * t106;
  t754 = 0.1e1 / t753;
  t755 = t144 * t754;
  t757 = 0.2e2 * t755 * t185;
  t761 = t116 * t118;
  t762 = t293 * t346;
  t766 = t345 * t164;
  t767 = 0.1e1 / t766;
  t768 = t159 * t767;
  t769 = t352 * t352;
  t770 = t769 * t353;
  t779 = -0.78438333333333333333e0 * t728 + 0.15687666666666666667e1 * t731 + 0.68863333333333333333e0 * t734 + 0.14025833333333333333e0 * t738 + 0.28051666666666666667e0 * t740 + 0.17365833333333333333e0 * t743;
  t780 = t779 * t353;
  t783 = t345 * t345;
  t784 = 0.1e1 / t783;
  t785 = t159 * t784;
  t786 = t167 * t167;
  t787 = 0.1e1 / t786;
  t788 = t769 * t787;
  t793 = 0.14764627977777777777e-2 * t116 * t733 * t140;
  t794 = t293 * t299;
  t797 = 0.35616666666666666666e-1 * t761 * t794 * t320;
  t798 = t298 * t136;
  t799 = 0.1e1 / t798;
  t800 = t123 * t799;
  t801 = t318 * t318;
  t802 = t801 * t319;
  t804 = 0.2e1 * t800 * t802;
  t811 = -0.42198333333333333333e0 * t728 + 0.84396666666666666666e0 * t731 + 0.39862222222222222223e0 * t734 + 0.68258333333333333333e-1 * t738 + 0.13651666666666666667e0 * t740 + 0.13692777777777777778e0 * t743;
  t812 = t811 * t319;
  t814 = 0.1e1 * t300 * t812;
  t815 = t298 * t298;
  t816 = 0.1e1 / t815;
  t817 = t123 * t816;
  t818 = t139 * t139;
  t819 = 0.1e1 / t818;
  t820 = t801 * t819;
  t822 = 0.16081979498692535067e2 * t817 * t820;
  t826 = t293 * t361;
  t830 = t360 * t177;
  t831 = 0.1e1 / t830;
  t832 = t172 * t831;
  t833 = t714 * t368;
  t836 = t745 * t368;
  t839 = t172 * t713;
  t840 = t714 * t717;
  t843 = -0.70983522622222222221e-3 * t116 * t733 * t168 - 0.34246666666666666666e-1 * t761 * t762 * t354 - 0.2e1 * t768 * t770 + 0.1e1 * t347 * t780 + 0.32163958997385070134e2 * t785 * t788 + t793 + t797 + t804 - t814 - t822 - 0.24415263074675393405e-3 * t116 * t733 * t181 - 0.10843581300301739842e-1 * t761 * t826 * t369 - 0.11696447245269292414e1 * t832 * t833 + 0.5848223622634646207e0 * t362 * t836 + 0.17315859105681463759e2 * t839 * t840;
  t844 = t157 * t843;
  t845 = t147 * t844;
  t846 = 0.1e1 / t90;
  t852 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t846 * t664 + 0.4e1 / 0.3e1 * t89 * t568);
  t853 = 0.1e1 / t95;
  t859 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t853 * t672 + 0.4e1 / 0.3e1 * t94 * t637);
  t861 = (t852 + t859) * t156;
  t862 = t861 * t184;
  t864 = t339 * t372;
  t865 = t147 * t864;
  t867 = t329 * t340;
  t870 = 0.8e1 * t329 * t373;
  t871 = t324 * t340;
  t874 = 0.8e1 * t324 * t373;
  t875 = -t720 - t749 - 0.11696447245269292414e1 * t751 + t757 + t845 + t147 * t862 + 0.2e1 * t865 - 0.8e1 * t867 - t870 + 0.8e1 * t871 + t874;
  t876 = t143 * t146;
  t878 = 0.12e2 * t876 * t185;
  t879 = t323 * t328;
  t881 = 0.32e2 * t879 * t185;
  t885 = t303 * t108 * t181;
  t887 = 0.24415263074675393405e-3 * t377 * t885;
  t888 = t339 * t3;
  t889 = t888 * t379;
  t892 = t831 * t714 * t368;
  t894 = 0.11696447245269292414e1 * t382 * t892;
  t895 = t157 * t116;
  t896 = t294 * t384;
  t898 = 0.10843581300301739842e-1 * t895 * t896;
  t899 = -t804 + t878 - t881 - t793 + 0.19751673498613801407e-1 * t861 * t182 + t814 + t822 + t887 - 0.36622894612013090108e-3 * t889 + t894 - t797 + t898;
  t900 = t875 + t899;
  t902 = -t681 * t111 / 0.48e2 + 0.7e1 / 0.72e2 * t707 - t711 + params->gammac * t900;
  t903 = t286 * t902;
  t904 = t109 * t903;
  t907 = -t682 * t193 / 0.48e2 + 0.7e1 / 0.72e2 * t685 + t275 * t391 / 0.24e2 - t694 - 0.7e1 / 0.72e2 * t696 - t101 * t702 / 0.24e2 + t101 * t904 / 0.48e2;
  t908 = t263 * t907;
  t909 = t908 * t189;
  t910 = t395 * t387;
  t911 = 0.2e1 * t910;
  t912 = t196 * t900;
  tv2rho20 = 0.2e1 * t262 + 0.2e1 * t396 + 0.2e1 * t397 + t7 * (t658 + t662 + t909 + t911 + t912);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t915 = t561 * t401;
  t918 = 0.2e1 * t566;
  t919 = my_piecewise5(t11, 0, t15, 0, t918);
  t923 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t915 * t201 + 0.4e1 / 0.3e1 * t24 * t919);
  t930 = t6 * t404 * t132 * t51;
  t932 = t6 * t404;
  t938 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t923 * t27 * t51 - t930 / 0.8e1 - 0.3e1 / 0.8e1 * t932 * t241 - t580 / 0.8e1 + t588 - t591 / 0.8e1);
  t939 = t633 * t412;
  t942 = my_piecewise5(t15, 0, t11, 0, -t918);
  t946 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t939 * t247 + 0.4e1 / 0.3e1 * t60 * t942);
  t953 = t6 * t415 * t132 * t79;
  t956 = t6 * t250;
  t959 = t132 * t421;
  t960 = t959 * t441;
  t961 = t420 * t960;
  t964 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t946 * t27 * t79 - t953 / 0.8e1 - t649 / 0.8e1 + t654 - 0.3e1 / 0.8e1 * t956 * t442 - t961 / 0.8e1);
  t966 = t1 * (t938 + t964);
  t967 = t659 * t394;
  t968 = t482 * t189;
  t969 = t967 * t968;
  t970 = t663 * t400;
  t973 = t264 * t17;
  t977 = my_piecewise3(t87, 0, -0.2e1 / 0.9e1 * t970 * t200 + 0.4e1 / 0.3e1 * t973 * t565);
  t978 = t671 * t411;
  t981 = t268 * t17;
  t985 = my_piecewise3(t93, 0, -0.2e1 / 0.9e1 * t978 * t246 - 0.4e1 / 0.3e1 * t981 * t565);
  t987 = t977 / 0.2e1 + t985 / 0.2e1;
  t988 = t987 * t99;
  t989 = t988 * t4;
  t992 = t458 * t282;
  t1000 = t281 * t478;
  t1001 = t101 * t1000;
  t1003 = t100 * t110;
  t1004 = t108 * t699;
  t1005 = t477 * t389;
  t1006 = t1004 * t1005;
  t1011 = t457 * t289;
  t1014 = t470 * t3;
  t1015 = t1014 * t379;
  t1018 = t324 * t471;
  t1020 = t329 * t471;
  t1023 = -0.18311447306006545054e-3 * t1015 - t797 + t887 - 0.18311447306006545054e-3 * t889 + t898 + 0.4e1 * t1018 - 0.4e1 * t1020 - t720 - t749 - 0.5848223622634646207e0 * t751 - t804 + t814 + t822;
  t1024 = t846 * t400;
  t1027 = t89 * t17;
  t1031 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t1024 * t200 + 0.8e1 / 0.3e1 * t1027 * t565);
  t1032 = t853 * t411;
  t1035 = t94 * t17;
  t1039 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t1032 * t246 - 0.8e1 / 0.3e1 * t1035 * t565);
  t1041 = (t1031 + t1039) * t156;
  t1042 = t1041 * t184;
  t1044 = t470 * t372;
  t1045 = t147 * t1044;
  t1050 = t470 * t172;
  t1051 = t1050 * t384;
  t1053 = t147 * t1042 + t1045 + 0.19751673498613801407e-1 * t1041 * t182 - t878 - t870 - 0.4e1 * t871 + t865 - 0.4e1 * t867 - t793 + t757 + t845 - 0.5848223622634646207e0 * t1051 + t894;
  t1054 = t1023 + t1053;
  t1056 = -t988 * t111 / 0.48e2 + 0.7e1 / 0.144e3 * t1011 + 0.7e1 / 0.144e3 * t707 - t711 + params->gammac * t1054;
  t1057 = t286 * t1056;
  t1058 = t109 * t1057;
  t1061 = -t989 * t193 / 0.48e2 + 0.7e1 / 0.144e3 * t992 + t458 * t391 / 0.48e2 + 0.7e1 / 0.144e3 * t685 - t694 - 0.7e1 / 0.144e3 * t696 + t275 * t479 / 0.48e2 - 0.7e1 / 0.144e3 * t1001 - t1003 * t1006 / 0.24e2 + t101 * t1058 / 0.48e2;
  t1062 = t263 * t1061;
  t1063 = t1062 * t189;
  t1064 = t483 * t387;
  t1065 = t395 * t475;
  t1066 = t196 * t1054;
  tv2rho21 = t262 + t396 + t397 + t448 + t484 + t485 + t7 * (t966 + t969 + t1063 + t1064 + t1065 + t1066);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1072 = t401 * t401;
  t1076 = 0.2e1 * t198 + 0.2e1 * t566;
  t1077 = my_piecewise5(t11, 0, t15, 0, t1076);
  t1081 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t561 * t1072 + 0.4e1 / 0.3e1 * t24 * t1077);
  t1088 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1081 * t27 * t51 - t930 / 0.4e1 + t588);
  t1089 = t412 * t412;
  t1092 = -t1076;
  t1093 = my_piecewise5(t15, 0, t11, 0, t1092);
  t1097 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t633 * t1089 + 0.4e1 / 0.3e1 * t60 * t1093);
  t1103 = t6 * t415;
  t1107 = xbspline(t78, 2, params);
  t1108 = t27 * t1107;
  t1109 = t441 * t441;
  t1110 = t1108 * t1109;
  t1114 = 0.1e1 / t66 / t431;
  t1119 = t431 * t423;
  t1121 = 0.1e1 / t65 / t1119;
  t1126 = t430 * sigma[2];
  t1127 = t431 * t431;
  t1128 = t1127 * t64;
  t1129 = 0.1e1 / t1128;
  t1132 = 0.1e1 / t436 / t74;
  t1136 = 0.11e2 / 0.27e2 * t35 * sigma[2] * t1114 * t75 - t228 * t430 * t1121 * t437 / 0.24e2 + t615 * t1126 * t1129 * t1132 / 0.162e3;
  t1137 = t422 * t1136;
  t1141 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t1097 * t27 * t79 - t953 / 0.4e1 - 0.3e1 / 0.4e1 * t1103 * t442 + t654 - t961 / 0.4e1 - 0.3e1 / 0.8e1 * t420 * t1110 - 0.3e1 / 0.8e1 * t420 * t1137);
  t1143 = t1 * (t1088 + t1141);
  t1144 = t482 * t482;
  t1145 = t659 * t1144;
  t1146 = t1145 * t189;
  t1147 = t400 * t400;
  t1153 = my_piecewise3(t87, 0, -0.2e1 / 0.9e1 * t663 * t1147 + 0.2e1 / 0.3e1 * t264 * t1076);
  t1154 = t411 * t411;
  t1160 = my_piecewise3(t93, 0, -0.2e1 / 0.9e1 * t671 * t1154 + 0.2e1 / 0.3e1 * t268 * t1092);
  t1162 = t1153 / 0.2e1 + t1160 / 0.2e1;
  t1163 = t1162 * t99;
  t1164 = t1163 * t4;
  t1171 = t477 * t477;
  t1172 = t699 * t1171;
  t1173 = t109 * t1172;
  t1184 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t846 * t1147 + 0.4e1 / 0.3e1 * t89 * t1076);
  t1190 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t853 * t1154 + 0.4e1 / 0.3e1 * t94 * t1092);
  t1192 = (t1184 + t1190) * t156;
  t1193 = t1192 * t184;
  t1201 = t147 * t1193 + 0.19751673498613801407e-1 * t1192 * t182 - 0.11696447245269292414e1 * t1051 + 0.2e1 * t1045 - 0.8e1 * t1018 - 0.8e1 * t1020 - t720 - t749 + t757 + t845 - t870;
  t1203 = -t874 - t804 + t878 + t881 - t793 + t814 + t822 + t887 - 0.36622894612013090108e-3 * t1015 + t894 - t797 + t898;
  t1204 = t1201 + t1203;
  t1206 = -t1163 * t111 / 0.48e2 + 0.7e1 / 0.72e2 * t1011 - t711 + params->gammac * t1204;
  t1207 = t286 * t1206;
  t1208 = t109 * t1207;
  t1211 = -t1164 * t193 / 0.48e2 + 0.7e1 / 0.72e2 * t992 + t458 * t479 / 0.24e2 - t694 - 0.7e1 / 0.72e2 * t1001 - t101 * t1173 / 0.24e2 + t101 * t1208 / 0.48e2;
  t1212 = t263 * t1211;
  t1213 = t1212 * t189;
  t1214 = t483 * t475;
  t1215 = 0.2e1 * t1214;
  t1216 = t196 * t1204;
  tv2rho22 = 0.2e1 * t448 + 0.2e1 * t484 + 0.2e1 * t485 + t7 * (t1143 + t1146 + t1213 + t1215 + t1216);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1221 = t589 * t499;
  t1223 = t213 * t1221 / 0.8e1;
  t1224 = t240 * t499;
  t1225 = t594 * t1224;
  t1236 = t617 * rho[0];
  t1237 = 0.1e1 / t1236;
  t1242 = -t30 * t34 * t218 * t47 / 0.9e1 + t228 * t233 * t236 * sigma[0] / 0.72e2 - t615 * t229 * t1237 * t622 / 0.432e3;
  t1243 = t215 * t1242;
  t1247 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t582 * t500 - t1223 - 0.3e1 / 0.8e1 * t213 * t1225 - 0.3e1 / 0.8e1 * t213 * t1243);
  t1248 = t1 * t1247;
  t1249 = t523 * t189;
  t1250 = t967 * t1249;
  t1253 = t104 * t280;
  t1254 = t1253 * t507;
  t1256 = 0.7e1 / 0.144e3 * t101 * t1254;
  t1257 = t4 * t104;
  t1258 = t100 * t1257;
  t1259 = t108 * t286;
  t1260 = t506 * t389;
  t1261 = t1259 * t1260;
  t1264 = t98 * t3;
  t1265 = t513 * t515;
  t1266 = t1264 * t1265;
  t1267 = t517 * t286;
  t1268 = t506 * t273;
  t1273 = 0.1e1 / t131 / t327;
  t1274 = t515 * t1273;
  t1275 = t1274 * t519;
  t1277 = 0.7e1 / 0.1152e4 * t514 * t1275;
  t1278 = t512 * t1265;
  t1279 = t517 * t699;
  t1280 = t1279 * t1260;
  t1283 = -t275 * t508 / 0.48e2 + t1256 + t1258 * t1261 / 0.48e2 - t1266 * t1267 * t1268 / 0.384e3 + t1277 + t1278 * t1280 / 0.384e3;
  t1284 = t263 * t1283;
  t1285 = t1284 * t189;
  t1286 = t524 * t387;
  tv2rhosigma0 = t504 + t525 + t7 * (t1248 + t1250 + t1285 + t1286);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1291 = t959 * t538;
  t1293 = t420 * t1291 / 0.8e1;
  t1295 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t956 * t539 - t1293);
  t1296 = t1 * t1295;
  t1297 = t553 * t189;
  t1298 = t967 * t1297;
  t1301 = t1253 * t545;
  t1303 = 0.7e1 / 0.144e3 * t101 * t1301;
  t1304 = t544 * t389;
  t1305 = t1259 * t1304;
  t1308 = t544 * t273;
  t1312 = t1274 * t549;
  t1314 = 0.7e1 / 0.1152e4 * t514 * t1312;
  t1315 = t1279 * t1304;
  t1318 = -t275 * t546 / 0.48e2 + t1303 + t1258 * t1305 / 0.48e2 - t1266 * t1267 * t1308 / 0.384e3 + t1314 + t1278 * t1315 / 0.384e3;
  t1319 = t263 * t1318;
  t1320 = t1319 * t189;
  t1321 = t554 * t387;
  tv2rhosigma2 = t543 + t555 + t7 * (t1296 + t1298 + t1320 + t1321);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1327 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t932 * t500 - t1223);
  t1328 = t1 * t1327;
  t1329 = t659 * t482;
  t1330 = t1329 * t1249;
  t1333 = t506 * t477;
  t1334 = t1259 * t1333;
  t1337 = t506 * t456;
  t1338 = t1267 * t1337;
  t1341 = t1279 * t1333;
  t1344 = -t458 * t508 / 0.48e2 + t1256 + t1258 * t1334 / 0.48e2 - t1266 * t1338 / 0.384e3 + t1277 + t1278 * t1341 / 0.384e3;
  t1345 = t263 * t1344;
  t1346 = t1345 * t189;
  t1347 = t524 * t475;
  tv2rhosigma3 = t504 + t525 + t7 * (t1328 + t1330 + t1346 + t1347);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1352 = t441 * t538;
  t1353 = t1108 * t1352;
  t1364 = t1127 * rho[1];
  t1365 = 0.1e1 / t1364;
  t1370 = -t30 * t34 * t425 * t75 / 0.9e1 + t228 * t434 * t437 * sigma[2] / 0.72e2 - t615 * t430 * t1365 * t1132 / 0.432e3;
  t1371 = t422 * t1370;
  t1375 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t1103 * t539 - t1293 - 0.3e1 / 0.8e1 * t420 * t1353 - 0.3e1 / 0.8e1 * t420 * t1371);
  t1376 = t1 * t1375;
  t1377 = t1329 * t1297;
  t1380 = t544 * t477;
  t1381 = t1259 * t1380;
  t1384 = t544 * t456;
  t1385 = t1267 * t1384;
  t1388 = t1279 * t1380;
  t1391 = -t458 * t546 / 0.48e2 + t1303 + t1258 * t1381 / 0.48e2 - t1266 * t1385 / 0.384e3 + t1314 + t1278 * t1388 / 0.384e3;
  t1392 = t263 * t1391;
  t1393 = t1392 * t189;
  t1394 = t554 * t475;
  tv2rhosigma5 = t543 + t555 + t7 * (t1376 + t1377 + t1393 + t1394);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1397 = t499 * t499;
  t1398 = t594 * t1397;
  t1404 = 0.1e1 / t617;
  t1409 = -t225 * t227 * t494 * t236 / 0.288e3 + t615 * sigma[0] * t1404 * t622 / 0.1152e4;
  t1410 = t215 * t1409;
  t1414 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t213 * t1398 - 0.3e1 / 0.8e1 * t213 * t1410);
  t1415 = t1 * t1414;
  t1416 = t523 * t523;
  t1417 = t659 * t1416;
  t1418 = t1417 * t189;
  t1419 = 0.1e1 / sigma[0];
  t1420 = t1419 * t108;
  t1421 = t1420 * t192;
  t1424 = t105 * t517;
  t1425 = t286 * t1419;
  t1426 = t1424 * t1425;
  t1430 = 0.1e1 / t102 / sigma[0];
  t1431 = t192 * t1430;
  t1432 = t505 * t1431;
  t1435 = t511 * t98;
  t1436 = t1435 * M_PI;
  t1437 = t105 * t105;
  t1438 = t1436 * t1437;
  t1439 = t145 * t278;
  t1440 = 0.1e1 / t1439;
  t1441 = t1440 * t699;
  t1445 = t286 * t1430;
  t1446 = t518 * t1445;
  t1449 = -t101 * t1421 / 0.96e2 - 0.5e1 / 0.1536e4 * t514 * t1426 + t101 * t1432 / 0.96e2 - t1438 * t1441 * t1419 / 0.6144e4 + t514 * t1446 / 0.1536e4;
  t1450 = t263 * t1449;
  t1451 = t1450 * t189;
  tv2sigma20 = t7 * (t1415 + t1418 + t1451);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  t1453 = t659 * t523;
  t1454 = t1453 * t1297;
  t1455 = t506 * t108;
  t1456 = t1455 * t545;
  t1459 = t513 * t105;
  t1460 = t512 * t1459;
  t1461 = t544 * t506;
  t1462 = t1267 * t1461;
  t1468 = -t101 * t1456 / 0.96e2 - 0.5e1 / 0.1536e4 * t1460 * t1462 - t1438 * t1441 * t1461 / 0.6144e4;
  t1469 = t263 * t1468;
  t1470 = t1469 * t189;
  tv2sigma22 = t7 * (t1454 + t1470);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1472 = t538 * t538;
  t1473 = t1108 * t1472;
  t1479 = 0.1e1 / t1127;
  t1484 = -t225 * t227 * t533 * t437 / 0.288e3 + t615 * sigma[2] * t1479 * t1132 / 0.1152e4;
  t1485 = t422 * t1484;
  t1489 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t420 * t1473 - 0.3e1 / 0.8e1 * t420 * t1485);
  t1490 = t1 * t1489;
  t1491 = t553 * t553;
  t1492 = t659 * t1491;
  t1493 = t1492 * t189;
  t1494 = 0.1e1 / sigma[2];
  t1495 = t1494 * t108;
  t1496 = t1495 * t192;
  t1499 = t286 * t1494;
  t1500 = t1424 * t1499;
  t1504 = 0.1e1 / t103 / sigma[2];
  t1505 = t192 * t1504;
  t1506 = t505 * t1505;
  t1512 = t286 * t1504;
  t1513 = t518 * t1512;
  t1516 = -t101 * t1496 / 0.96e2 - 0.5e1 / 0.1536e4 * t514 * t1500 + t101 * t1506 / 0.96e2 - t1438 * t1441 * t1494 / 0.6144e4 + t514 * t1513 / 0.1536e4;
  t1517 = t263 * t1516;
  t1518 = t1517 * t189;
  tv2sigma25 = t7 * (t1490 + t1493 + t1518);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t40, t42, t46, t47, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t63, t64, t65;
  double t66, t68, t70, t74, t75, t78, t79, t83;
  double t85, t86, t87, t88, t89, t90, t91, t92;
  double t93, t94, t95, t96, t98, t99, t100, t101;
  double t102, t103, t104, t105, t106, t108, t109, t110;
  double t111, t114, t115, t116, t117, t118, t121, t123;
  double t124, t127, t129, t130, t131, t132, t134, t136;
  double t139, t140, t142, t143, t144, t145, t146, t147;
  double t148, t149, t150, t151, t152, t153, t156, t157;
  double t159, t164, t167, t168, t172, t177, t180, t181;
  double t182, t184, t185, t189, t191, t192, t193, t195;
  double t196, t197, tzk0;

  double t198, t199, t200, t201, t204, t212, t213, t214;
  double t215, t216, t218, t223, t224, t225, t227, t228;
  double t229, t230, t231, t233, t235, t236, t240, t241;
  double t245, t246, t247, t250, t258, t260, t262, t263;
  double t264, t267, t268, t271, t273, t274, t275, t278;
  double t280, t281, t282, t284, t285, t286, t289, t291;
  double t293, t294, t297, t298, t299, t300, t302, t303;
  double t304, t305, t307, t309, t310, t311, t314, t316;
  double t318, t319, t320, t322, t323, t324, t326, t327;
  double t328, t329, t331, t334, t337, t339, t340, t345;
  double t346, t347, t352, t353, t354, t360, t361, t362;
  double t367, t368, t369, t372, t373, t374, t377, t379;
  double t381, t382, t384, t386, t387, t389, t390, t391;
  double t394, t395, t396, t397, tvrho0, t400, t401, t404;
  double t410, t411, t412, t415, t420, t421, t422, t423;
  double t425, t430, t431, t432, t434, t436, t437, t441;
  double t442, t446, t448, t451, t454, t456, t457, t458;
  double t465, t468, t470, t471, t475, t477, t478, t479;
  double t482, t483, t484, t485, tvrho1, t492, t494, t499;
  double t500, t503, t504, t505, t506, t507, t508, t511;
  double t512, t513, t514, t515, t517, t518, t519, t520;
  double t523, t524, t525, tvsigma0, tvsigma1, t531, t533, t538;
  double t539, t542, t543, t544, t545, t546, t549, t550;
  double t553, t554, t555, tvsigma2;

  double t560, t561, t562, t565, t566, t568, t569, t573;
  double t580, t582, t588, t589, t590, t591, t593, t594;
  double t595, t596, t600, t605, t607, t613, t614, t615;
  double t616, t617, t618, t619, t622, t626, t627, t631;
  double t632, t633, t634, t637, t638, t642, t649, t654;
  double t656, t658, t659, t660, t661, t662, t663, t664;
  double t670, t671, t672, t678, t680, t681, t682, t685;
  double t690, t691, t692, t694, t695, t696, t699, t700;
  double t701, t702, t707, t709, t711, t712, t713, t714;
  double t715, t716, t717, t718, t720, t723, t724, t726;
  double t727, t728, t730, t731, t733, t734, t736, t737;
  double t738, t740, t743, t745, t747, t749, t750, t751;
  double t753, t754, t755, t757, t761, t762, t766, t767;
  double t768, t769, t770, t779, t780, t783, t784, t785;
  double t786, t787, t788, t793, t794, t797, t798, t799;
  double t800, t801, t802, t804, t811, t812, t814, t815;
  double t816, t817, t818, t819, t820, t822, t826, t830;
  double t831, t832, t833, t836, t839, t840, t843, t844;
  double t845, t846, t852, t853, t859, t861, t862, t864;
  double t865, t867, t870, t871, t874, t875, t876, t878;
  double t879, t881, t885, t887, t888, t889, t892, t894;
  double t895, t896, t898, t899, t900, t902, t903, t904;
  double t907, t908, t909, t910, t911, t912, tv2rho20, t915;
  double t918, t919, t923, t930, t932, t938, t939, t942;
  double t946, t953, t956, t959, t960, t961, t964, t966;
  double t967, t968, t969, t970, t973, t977, t978, t981;
  double t985, t987, t988, t989, t992, t1000, t1001, t1003;
  double t1004, t1005, t1006, t1011, t1014, t1015, t1018, t1020;
  double t1023, t1024, t1027, t1031, t1032, t1035, t1039, t1041;
  double t1042, t1044, t1045, t1050, t1051, t1053, t1054, t1056;
  double t1057, t1058, t1061, t1062, t1063, t1064, t1065, t1066;
  double tv2rho21, t1072, t1076, t1077, t1081, t1088, t1089, t1092;
  double t1093, t1097, t1103, t1107, t1108, t1109, t1110, t1114;
  double t1119, t1121, t1126, t1127, t1128, t1129, t1132, t1136;
  double t1137, t1141, t1143, t1144, t1145, t1146, t1147, t1153;
  double t1154, t1160, t1162, t1163, t1164, t1171, t1172, t1173;
  double t1184, t1190, t1192, t1193, t1201, t1203, t1204, t1206;
  double t1207, t1208, t1211, t1212, t1213, t1214, t1215, t1216;
  double tv2rho22, t1221, t1223, t1224, t1225, t1236, t1237, t1242;
  double t1243, t1247, t1248, t1249, t1250, t1253, t1254, t1256;
  double t1257, t1258, t1259, t1260, t1261, t1264, t1265, t1266;
  double t1267, t1268, t1273, t1274, t1275, t1277, t1278, t1279;
  double t1280, t1283, t1284, t1285, t1286, tv2rhosigma0, tv2rhosigma1, t1291;
  double t1293, t1295, t1296, t1297, t1298, t1301, t1303, t1304;
  double t1305, t1308, t1312, t1314, t1315, t1318, t1319, t1320;
  double t1321, tv2rhosigma2, t1327, t1328, t1329, t1330, t1333, t1334;
  double t1337, t1338, t1341, t1344, t1345, t1346, t1347, tv2rhosigma3;
  double tv2rhosigma4, t1352, t1353, t1364, t1365, t1370, t1371, t1375;
  double t1376, t1377, t1380, t1381, t1384, t1385, t1388, t1391;
  double t1392, t1393, t1394, tv2rhosigma5, t1397, t1398, t1404, t1409;
  double t1410, t1414, t1415, t1416, t1417, t1418, t1419, t1420;
  double t1421, t1424, t1425, t1426, t1430, t1431, t1432, t1435;
  double t1436, t1437, t1438, t1439, t1440, t1441, t1445, t1446;
  double t1449, t1450, t1451, tv2sigma20, tv2sigma21, t1453, t1454, t1455;
  double t1456, t1459, t1460, t1461, t1462, t1468, t1469, t1470;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1472, t1473, t1479, t1484, t1485;
  double t1489, t1490, t1491, t1492, t1493, t1494, t1495, t1496;
  double t1499, t1500, t1504, t1505, t1506, t1512, t1513, t1516;
  double t1517, t1518, tv2sigma25;

  double t1526, t1527, t1530, t1533, t1535, t1536, t1540, t1548;
  double t1549, t1550, t1551, t1553, t1554, t1557, t1563, t1568;
  double t1569, t1574, t1575, t1576, t1577, t1578, t1580, t1581;
  double t1582, t1584, t1588, t1589, t1594, t1596, t1601, t1603;
  double t1607, t1608, t1609, t1611, t1612, t1615, t1616, t1617;
  double t1618, t1623, t1624, t1626, t1627, t1630, t1633, t1634;
  double t1638, t1645, t1649, t1654, t1656, t1658, t1659, t1660;
  double t1661, t1662, t1663, t1664, t1665, t1666, t1667, t1668;
  double t1670, t1671, t1674, t1680, t1681, t1683, t1684, t1687;
  double t1693, t1695, t1696, t1699, t1701, t1704, t1705, t1707;
  double t1708, t1709, t1712, t1714, t1716, t1717, t1719, t1721;
  double t1723, t1724, t1725, t1727, t1731, t1732, t1735, t1736;
  double t1737, t1739, t1740, t1742, t1743, t1745, t1746, t1747;
  double t1749, t1751, t1754, t1756, t1757, t1759, t1761, t1762;
  double t1764, t1765, t1767, t1769, t1770, t1771, t1773, t1775;
  double t1778, t1784, t1786, t1789, t1795, t1797, t1800, t1801;
  double t1802, t1804, t1806, t1807, t1809, t1811, t1812, t1813;
  double t1815, t1817, t1818, t1820, t1821, t1823, t1824, t1826;
  double t1835, t1837, t1839, t1841, t1844, t1845, t1847, t1848;
  double t1850, t1852, t1853, t1856, t1857, t1858, t1859, t1860;
  double t1862, t1864, t1867, t1868, t1871, t1874, t1878, t1879;
  double t1880, t1881, t1883, t1884, t1886, t1889, t1892, t1893;
  double t1895, t1897, t1899, t1901, t1903, t1904, t1906, t1908;
  double t1912, t1914, t1915, t1916, t1917, t1918, t1920, t1921;
  double t1922, t1923, t1926, t1927, t1928, t1931, t1932, t1933;
  double t1934, t1945, t1946, t1950, t1951, t1953, t1954, t1957;
  double t1958, t1961, t1964, t1967, t1968, t1971, t1974, t1981;
  double t1985, t1986, t1993, t1997, t2008, t2011, t2014, t2024;
  double t2025, t2026, t2027, t2028, t2030, t2032, t2033, t2034;
  double t2037, t2038, t2040, t2041, t2043, t2044, t2045, t2047;
  double t2050, t2054, t2056, t2060, t2061, t2062, t2063, t2064;
  double t2067, t2068, t2071, t2072, t2076, t2077, t2078, t2079;
  double t2080, t2081, t2082, t2083, tv3rho30, t2086, t2087, t2088;
  double t2089, t2090, t2091, t2092, t2095, t2100, t2101, t2102;
  double t2103, t2107, t2115, t2116, t2121, t2124, t2135, t2136;
  double t2137, t2140, t2146, t2150, t2158, t2161, t2165, t2169;
  double t2170, t2171, t2172, t2175, t2177, t2178, t2179, t2180;
  double t2181, t2182, t2183, t2185, t2186, t2189, t2193, t2194;
  double t2199, t2202, t2203, t2213, t2214, t2217, t2218, t2228;
  double t2230, t2231, t2232, t2239, t2243, t2245, t2249, t2250;
  double t2255, t2256, t2258, t2260, t2262, t2263, t2266, t2276;
  double t2277, t2280, t2290, t2292, t2293, t2296, t2297, t2300;
  double t2302, t2303, t2305, t2307, t2309, t2311, t2312, t2316;
  double t2318, t2319, t2321, t2322, t2325, t2327, t2328, t2330;
  double t2332, t2333, t2335, t2342, t2343, t2346, t2348, t2350;
  double t2351, t2352, t2355, t2357, t2361, t2364, t2365, t2366;
  double t2369, t2370, t2373, t2374, t2376, t2377, t2378, t2381;
  double t2384, t2385, t2386, t2387, t2388, t2390, t2391, t2392;
  double t2393, t2395, t2396, tv3rho31, t2398, t2403, t2406, t2407;
  double t2411, t2418, t2420, t2427, t2428, t2433, t2436, t2437;
  double t2441, t2448, t2451, t2454, t2460, t2461, t2462, t2466;
  double t2467, t2469, t2470, t2472, t2473, t2474, t2475, t2476;
  double t2478, t2479, t2480, t2485, t2490, t2496, t2497, t2502;
  double t2508, t2510, t2511, t2514, t2518, t2519, t2521, t2523;
  double t2525, t2526, t2527, t2528, t2533, t2540, t2548, t2549;
  double t2554, t2560, t2561, t2566, t2572, t2574, t2581, t2583;
  double t2585, t2587, t2588, t2589, t2598, t2599, t2600, t2603;
  double t2606, t2607, t2610, t2611, t2614, t2616, t2617, t2619;
  double t2620, t2626, t2629, t2631, t2632, t2633, t2634, t2635;
  double t2636, t2637, t2639, t2641, t2643, t2644, t2645, tv3rho32;
  double t2652, t2658, t2659, t2663, t2671, t2677, t2682, t2683;
  double t2687, t2694, t2700, t2705, t2706, t2711, t2712, t2713;
  double t2715, t2716, t2717, t2722, t2723, t2726, t2733, t2734;
  double t2737, t2738, t2739, t2740, t2743, t2744, t2746, t2747;
  double t2748, t2749, t2750, t2751, t2752, t2753, t2759, t2767;
  double t2768, t2776, t2778, t2779, t2789, t2797, t2805, t2807;
  double t2812, t2817, t2823, t2826, t2828, t2830, t2831, t2832;
  double t2840, t2845, t2846, t2847, t2850, t2851, t2854, t2855;
  double t2856, t2857, t2858, t2859, t2860, t2861, tv3rho33, t2870;
  double t2876, t2878, t2879, t2880, t2882, t2883, t2885, t2886;
  double t2889, t2890, t2893, t2894, t2905, t2910, t2912, t2917;
  double t2918, t2921, t2922, t2923, t2924, t2925, t2926, t2927;
  double t2928, t2929, t2930, t2931, t2934, t2936, t2939, t2940;
  double t2942, t2943, t2944, t2945, t2947, t2948, t2951, t2952;
  double t2955, t2956, t2957, t2960, t2962, t2964, t2968, t2969;
  double t2973, t2974, t2977, t2978, t2980, t2982, t2989, t2990;
  double t2991, t2992, t2993, t2994, tv3rho2sigma0, tv3rho2sigma1, t3003, t3005;
  double t3007, t3009, t3010, t3011, t3012, t3013, t3014, t3015;
  double t3016, t3017, t3018, t3021, t3025, t3027, t3028, t3029;
  double t3031, t3032, t3035, t3036, t3042, t3044, t3048, t3049;
  double t3054, t3056, t3064, t3065, t3066, t3067, t3068, t3069;
  double tv3rho2sigma2, t3074, t3084, t3085, t3086, t3087, t3088, t3089;
  double t3090, t3091, t3092, t3093, t3094, t3097, t3099, t3106;
  double t3107, t3109, t3110, t3113, t3114, t3118, t3119, t3122;
  double t3123, t3125, t3126, t3129, t3130, t3135, t3140, t3148;
  double t3149, t3150, t3151, t3152, t3153, t3154, t3155, t3156;
  double t3157, tv3rho2sigma3, tv3rho2sigma4, t3161, t3166, t3167, t3171, t3172;
  double t3175, t3176, t3177, t3178, t3179, t3180, t3181, t3182;
  double t3183, t3184, t3187, t3195, t3196, t3198, t3199, t3202;
  double t3203, t3209, t3210, t3212, t3213, t3216, t3217, t3222;
  double t3227, t3235, t3236, t3237, t3238, t3239, t3240, t3241;
  double t3242, t3243, t3244, tv3rho2sigma5, t3254, t3255, t3256, t3257;
  double t3258, t3259, t3260, t3261, t3262, t3263, t3270, t3271;
  double t3274, t3275, t3278, t3279, t3280, t3284, t3285, t3288;
  double t3289, t3299, t3300, t3301, t3302, t3303, t3304, tv3rho2sigma6;
  double tv3rho2sigma7, t3320, t3321, t3324, t3325, t3328, t3329, t3340;
  double t3345, t3347, t3352, t3353, t3356, t3357, t3358, t3359;
  double t3360, t3361, t3362, t3363, t3364, t3371, t3372, t3375;
  double t3376, t3382, t3383, t3386, t3387, t3397, t3398, t3399;
  double t3400, t3401, t3402, tv3rho2sigma8, t3407, t3409, t3410, t3411;
  double t3414, t3415, t3420, t3422, t3423, t3424, t3431, t3437;
  double t3442, t3443, t3447, t3448, t3449, t3450, t3451, t3452;
  double t3453, t3454, t3455, t3458, t3459, t3461, t3462, t3465;
  double t3466, t3470, t3473, t3474, t3480, t3482, t3483, t3484;
  double t3487, t3488, t3492, t3493, t3494, t3497, t3498, t3502;
  double t3508, t3512, t3513, t3514, t3515, tv3rhosigma20, tv3rhosigma21, t3518;
  double t3519, t3520, t3521, t3522, t3523, t3524, t3525, t3526;
  double t3529, t3530, t3532, t3533, t3534, t3537, t3543, t3544;
  double t3548, t3549, t3550, t3551, t3556, t3557, t3558, t3559;
  double t3562, t3563, t3564, t3565, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t3570;
  double t3572, t3575, t3577, t3579, t3580, t3581, t3582, t3583;
  double t3584, t3585, t3586, t3587, t3588, t3591, t3592, t3594;
  double t3595, t3598, t3604, t3605, t3611, t3613, t3614, t3615;
  double t3623, t3627, t3633, t3637, t3638, t3639, t3640, tv3rhosigma25;
  double t3648, t3649, t3650, t3651, t3652, t3653, t3654, t3655;
  double t3658, t3661, t3662, t3665, t3671, t3672, t3681, t3682;
  double t3688, t3689, t3690, t3691, tv3rhosigma26, tv3rhosigma27, t3694, t3695;
  double t3696, t3697, t3698, t3699, t3704, t3705, t3708, t3712;
  double t3715, t3718, t3719, t3720, t3721, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t3726, t3727, t3730, t3731, t3736, t3737, t3744, t3750;
  double t3755, t3756, t3760, t3761, t3762, t3763, t3764, t3765;
  double t3766, t3769, t3772, t3773, t3776, t3782, t3783, t3792;
  double t3793, t3799, t3800, t3801, t3802, tv3rhosigma211, t3805, t3806;
  double t3809, t3810, t3818, t3823, t3824, t3828, t3829, t3830;
  double t3831, t3832, t3834, t3835, t3836, t3837, t3841, t3842;
  double t3845, t3849, t3854, t3855, t3856, t3859, t3860, t3861;
  double t3862, t3863, t3864, t3866, t3867, t3868, t3875, t3879;
  double t3880, t3881, tv3sigma30, tv3sigma31, t3883, t3884, t3885, t3886;
  double t3888, t3889, t3890, t3893, t3894, t3895, t3896, t3899;
  double t3903, t3904, t3907, t3908, t3909, t3910, t3916, t3917;
  double t3918, tv3sigma32, tv3sigma33, tv3sigma34, t3920, t3921, t3923, t3924;
  double t3925, t3926, t3927, t3928, t3931, t3935, t3938, t3939;
  double t3942, t3943, t3944, t3950, t3951, t3952, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t3954, t3955, t3958, t3959, t3967, t3972;
  double t3973, t3977, t3978, t3979, t3980, t3981, t3983, t3984;
  double t3985, t3986, t3990, t3996, t4001, t4002, t4003, t4006;
  double t4013, t4017, t4018, t4019, tv3sigma39;

  hyb_gga_xc_case21_params *params;

  assert(p->params != NULL);
  params = (hyb_gga_xc_case21_params * )(p->params);

  t1 = 0.1e1 - params->ax;
  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = M_CBRT6;
  t30 = params->gammax * t29;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = t32 * t32;
  t34 = 0.1e1 / t33;
  t35 = t30 * t34;
  t36 = rho[0] * rho[0];
  t37 = POW_1_3(rho[0]);
  t38 = t37 * t37;
  t40 = 0.1e1 / t38 / t36;
  t42 = t34 * sigma[0];
  t46 = 0.1e1 + t30 * t42 * t40 / 0.24e2;
  t47 = 0.1e1 / t46;
  t50 = t35 * sigma[0] * t40 * t47 / 0.24e2;
  t51 = xbspline(t50, 0, params);
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t51);
  t56 = rho[1] <= p->dens_threshold;
  t57 = my_piecewise5(t15, t12, t11, t16, -t18);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t23, t60 * t58);
  t63 = t62 * t27;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t70 = t34 * sigma[2];
  t74 = 0.1e1 + t30 * t70 * t68 / 0.24e2;
  t75 = 0.1e1 / t74;
  t78 = t35 * sigma[2] * t68 * t75 / 0.24e2;
  t79 = xbspline(t78, 0, params);
  t83 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t63 * t79);
  t85 = t1 * (t55 + t83);
  t86 = t18 + 0.1e1;
  t87 = t86 <= p->zeta_threshold;
  t88 = t22 * t22;
  t89 = POW_1_3(t86);
  t90 = t89 * t89;
  t91 = my_piecewise3(t87, t88, t90);
  t92 = 0.1e1 - t18;
  t93 = t92 <= p->zeta_threshold;
  t94 = POW_1_3(t92);
  t95 = t94 * t94;
  t96 = my_piecewise3(t93, t88, t95);
  t98 = t91 / 0.2e1 + t96 / 0.2e1;
  t99 = t3 * t3;
  t100 = t98 * t99;
  t101 = t100 * t4;
  t102 = sqrt(sigma[0]);
  t103 = sqrt(sigma[2]);
  t104 = t102 + t103;
  t105 = t104 * t104;
  t106 = t7 * t7;
  t108 = 0.1e1 / t27 / t106;
  t109 = t105 * t108;
  t110 = t4 * t105;
  t111 = t110 * t108;
  t114 = 0.1e1 / M_PI;
  t115 = POW_1_3(t114);
  t116 = t3 * t115;
  t117 = M_CBRT4;
  t118 = t117 * t117;
  t121 = t116 * t118 / t27;
  t123 = 0.1e1 + 0.53425e-1 * t121;
  t124 = sqrt(t121);
  t127 = POW_3_2(t121);
  t129 = t115 * t115;
  t130 = t99 * t129;
  t131 = t27 * t27;
  t132 = 0.1e1 / t131;
  t134 = t130 * t117 * t132;
  t136 = 0.379785e1 * t124 + 0.8969e0 * t121 + 0.204775e0 * t127 + 0.123235e0 * t134;
  t139 = 0.1e1 + 0.16081979498692535067e2 / t136;
  t140 = log(t139);
  t142 = 0.621814e-1 * t123 * t140;
  t143 = t17 * t17;
  t144 = t143 * t143;
  t145 = t106 * t106;
  t146 = 0.1e1 / t145;
  t147 = t144 * t146;
  t148 = t89 * t86;
  t149 = my_piecewise3(t87, t23, t148);
  t150 = t94 * t92;
  t151 = my_piecewise3(t93, t23, t150);
  t152 = t149 + t151 - 0.2e1;
  t153 = M_CBRT2;
  t156 = 0.1e1 / (0.2e1 * t153 - 0.2e1);
  t157 = t152 * t156;
  t159 = 0.1e1 + 0.5137e-1 * t121;
  t164 = 0.705945e1 * t124 + 0.1549425e1 * t121 + 0.420775e0 * t127 + 0.1562925e0 * t134;
  t167 = 0.1e1 + 0.32163958997385070134e2 / t164;
  t168 = log(t167);
  t172 = 0.1e1 + 0.278125e-1 * t121;
  t177 = 0.51785e1 * t124 + 0.905775e0 * t121 + 0.1100325e0 * t127 + 0.1241775e0 * t134;
  t180 = 0.1e1 + 0.29608749977793437516e2 / t177;
  t181 = log(t180);
  t182 = t172 * t181;
  t184 = -0.310907e-1 * t159 * t168 + t142 - 0.19751673498613801407e-1 * t182;
  t185 = t157 * t184;
  t189 = -t142 + t147 * t185 + 0.19751673498613801407e-1 * t157 * t182;
  t191 = -t100 * t111 / 0.48e2 + params->gammac * t189;
  t192 = 0.1e1 / t191;
  t193 = t109 * t192;
  t195 = t101 * t193 / 0.48e2;
  t196 = cbspline(-t195, 0, params);
  t197 = t196 * t189;
  tzk0 = t85 + t197;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t198 = 0.1e1 / t106;
  t199 = t17 * t198;
  t200 = t8 - t199;
  t201 = my_piecewise5(t11, 0, t15, 0, t200);
  t204 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t201);
  t212 = t6 * t26 * t132 * t51 / 0.8e1;
  t213 = t6 * t26;
  t214 = xbspline(t50, 1, params);
  t215 = t27 * t214;
  t216 = t36 * rho[0];
  t218 = 0.1e1 / t38 / t216;
  t223 = params->gammax * params->gammax;
  t224 = t29 * t29;
  t225 = t223 * t224;
  t227 = 0.1e1 / t32 / t31;
  t228 = t225 * t227;
  t229 = sigma[0] * sigma[0];
  t230 = t36 * t36;
  t231 = t230 * t36;
  t233 = 0.1e1 / t37 / t231;
  t235 = t46 * t46;
  t236 = 0.1e1 / t235;
  t240 = -t35 * sigma[0] * t218 * t47 / 0.9e1 + t228 * t229 * t233 * t236 / 0.216e3;
  t241 = t215 * t240;
  t245 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t27 * t51 - t212 - 0.3e1 / 0.8e1 * t213 * t241);
  t246 = -t200;
  t247 = my_piecewise5(t15, 0, t11, 0, t246);
  t250 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t247);
  t258 = t6 * t62 * t132 * t79 / 0.8e1;
  t260 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t250 * t27 * t79 - t258);
  t262 = t1 * (t245 + t260);
  t263 = cbspline(-t195, 1, params);
  t264 = 0.1e1 / t89;
  t267 = my_piecewise3(t87, 0, 0.2e1 / 0.3e1 * t264 * t200);
  t268 = 0.1e1 / t94;
  t271 = my_piecewise3(t93, 0, 0.2e1 / 0.3e1 * t268 * t246);
  t273 = t267 / 0.2e1 + t271 / 0.2e1;
  t274 = t273 * t99;
  t275 = t274 * t4;
  t278 = t106 * t7;
  t280 = 0.1e1 / t27 / t278;
  t281 = t105 * t280;
  t282 = t281 * t192;
  t284 = 0.7e1 / 0.144e3 * t101 * t282;
  t285 = t191 * t191;
  t286 = 0.1e1 / t285;
  t289 = t110 * t280;
  t291 = 0.7e1 / 0.144e3 * t100 * t289;
  t293 = 0.1e1 / t27 / t7;
  t294 = t118 * t293;
  t297 = 0.11073470983333333333e-2 * t116 * t294 * t140;
  t298 = t136 * t136;
  t299 = 0.1e1 / t298;
  t300 = t123 * t299;
  t302 = 0.1e1 / t124 * t3;
  t303 = t115 * t118;
  t304 = t303 * t293;
  t305 = t302 * t304;
  t307 = t116 * t294;
  t309 = sqrt(t121);
  t310 = t309 * t3;
  t311 = t310 * t304;
  t314 = 0.1e1 / t131 / t7;
  t316 = t130 * t117 * t314;
  t318 = -0.632975e0 * t305 - 0.29896666666666666667e0 * t307 - 0.1023875e0 * t311 - 0.82156666666666666667e-1 * t316;
  t319 = 0.1e1 / t139;
  t320 = t318 * t319;
  t322 = 0.1e1 * t300 * t320;
  t323 = t143 * t17;
  t324 = t323 * t146;
  t326 = 0.4e1 * t324 * t185;
  t327 = t145 * t7;
  t328 = 0.1e1 / t327;
  t329 = t144 * t328;
  t331 = 0.4e1 * t329 * t185;
  t334 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t89 * t200);
  t337 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t246);
  t339 = (t334 + t337) * t156;
  t340 = t339 * t184;
  t345 = t164 * t164;
  t346 = 0.1e1 / t345;
  t347 = t159 * t346;
  t352 = -0.1176575e1 * t305 - 0.516475e0 * t307 - 0.2103875e0 * t311 - 0.104195e0 * t316;
  t353 = 0.1e1 / t167;
  t354 = t352 * t353;
  t360 = t177 * t177;
  t361 = 0.1e1 / t360;
  t362 = t172 * t361;
  t367 = -0.86308333333333333334e0 * t305 - 0.301925e0 * t307 - 0.5501625e-1 * t311 - 0.82785e-1 * t316;
  t368 = 0.1e1 / t180;
  t369 = t367 * t368;
  t372 = 0.53237641966666666666e-3 * t116 * t294 * t168 + 0.1e1 * t347 * t354 - t297 - t322 + 0.18311447306006545054e-3 * t116 * t294 * t181 + 0.5848223622634646207e0 * t362 * t369;
  t373 = t157 * t372;
  t374 = t147 * t373;
  t377 = t157 * t3;
  t379 = t303 * t293 * t181;
  t381 = 0.18311447306006545054e-3 * t377 * t379;
  t382 = t157 * t172;
  t384 = t361 * t367 * t368;
  t386 = 0.5848223622634646207e0 * t382 * t384;
  t387 = t297 + t322 + t326 - t331 + t147 * t340 + t374 + 0.19751673498613801407e-1 * t339 * t182 - t381 - t386;
  t389 = -t274 * t111 / 0.48e2 + t291 + params->gammac * t387;
  t390 = t286 * t389;
  t391 = t109 * t390;
  t394 = -t275 * t193 / 0.48e2 + t284 + t101 * t391 / 0.48e2;
  t395 = t263 * t394;
  t396 = t395 * t189;
  t397 = t196 * t387;
  tvrho0 = t85 + t197 + t7 * (t262 + t396 + t397);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t400 = -t8 - t199;
  t401 = my_piecewise5(t11, 0, t15, 0, t400);
  t404 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t401);
  t410 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t404 * t27 * t51 - t212);
  t411 = -t400;
  t412 = my_piecewise5(t15, 0, t11, 0, t411);
  t415 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t412);
  t420 = t6 * t62;
  t421 = xbspline(t78, 1, params);
  t422 = t27 * t421;
  t423 = t64 * rho[1];
  t425 = 0.1e1 / t66 / t423;
  t430 = sigma[2] * sigma[2];
  t431 = t64 * t64;
  t432 = t431 * t64;
  t434 = 0.1e1 / t65 / t432;
  t436 = t74 * t74;
  t437 = 0.1e1 / t436;
  t441 = -t35 * sigma[2] * t425 * t75 / 0.9e1 + t228 * t430 * t434 * t437 / 0.216e3;
  t442 = t422 * t441;
  t446 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t415 * t27 * t79 - t258 - 0.3e1 / 0.8e1 * t420 * t442);
  t448 = t1 * (t410 + t446);
  t451 = my_piecewise3(t87, 0, 0.2e1 / 0.3e1 * t264 * t400);
  t454 = my_piecewise3(t93, 0, 0.2e1 / 0.3e1 * t268 * t411);
  t456 = t451 / 0.2e1 + t454 / 0.2e1;
  t457 = t456 * t99;
  t458 = t457 * t4;
  t465 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t89 * t400);
  t468 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t411);
  t470 = (t465 + t468) * t156;
  t471 = t470 * t184;
  t475 = t297 + t322 - t326 - t331 + t147 * t471 + t374 + 0.19751673498613801407e-1 * t470 * t182 - t381 - t386;
  t477 = -t457 * t111 / 0.48e2 + t291 + params->gammac * t475;
  t478 = t286 * t477;
  t479 = t109 * t478;
  t482 = -t458 * t193 / 0.48e2 + t284 + t101 * t479 / 0.48e2;
  t483 = t263 * t482;
  t484 = t483 * t189;
  t485 = t196 * t475;
  tvrho1 = t85 + t197 + t7 * (t448 + t484 + t485);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t492 = t230 * rho[0];
  t494 = 0.1e1 / t37 / t492;
  t499 = t30 * t34 * t40 * t47 / 0.24e2 - t228 * sigma[0] * t494 * t236 / 0.576e3;
  t500 = t215 * t499;
  t503 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t213 * t500);
  t504 = t1 * t503;
  t505 = t104 * t108;
  t506 = 0.1e1 / t102;
  t507 = t192 * t506;
  t508 = t505 * t507;
  t511 = t98 * t98;
  t512 = t511 * t3;
  t513 = t4 * t4;
  t514 = t512 * t513;
  t515 = t105 * t104;
  t517 = 0.1e1 / t131 / t145;
  t518 = t515 * t517;
  t519 = t286 * t506;
  t520 = t518 * t519;
  t523 = -t101 * t508 / 0.48e2 - t514 * t520 / 0.768e3;
  t524 = t263 * t523;
  t525 = t524 * t189;
  tvsigma0 = t7 * (t504 + t525);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t531 = t431 * rho[1];
  t533 = 0.1e1 / t65 / t531;
  t538 = t30 * t34 * t68 * t75 / 0.24e2 - t228 * sigma[2] * t533 * t437 / 0.576e3;
  t539 = t422 * t538;
  t542 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t420 * t539);
  t543 = t1 * t542;
  t544 = 0.1e1 / t103;
  t545 = t192 * t544;
  t546 = t505 * t545;
  t549 = t286 * t544;
  t550 = t518 * t549;
  t553 = -t101 * t546 / 0.48e2 - t514 * t550 / 0.768e3;
  t554 = t263 * t553;
  t555 = t554 * t189;
  tvsigma2 = t7 * (t543 + t555);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t560 = t24 * t24;
  t561 = 0.1e1 / t560;
  t562 = t201 * t201;
  t565 = 0.1e1 / t278;
  t566 = t17 * t565;
  t568 = -0.2e1 * t198 + 0.2e1 * t566;
  t569 = my_piecewise5(t11, 0, t15, 0, t568);
  t573 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t561 * t562 + 0.4e1 / 0.3e1 * t24 * t569);
  t580 = t6 * t204 * t132 * t51;
  t582 = t6 * t204;
  t588 = t6 * t26 * t314 * t51 / 0.12e2;
  t589 = t132 * t214;
  t590 = t589 * t240;
  t591 = t213 * t590;
  t593 = xbspline(t50, 2, params);
  t594 = t27 * t593;
  t595 = t240 * t240;
  t596 = t594 * t595;
  t600 = 0.1e1 / t38 / t230;
  t605 = t230 * t216;
  t607 = 0.1e1 / t37 / t605;
  t613 = t31 * t31;
  t614 = 0.1e1 / t613;
  t615 = t223 * params->gammax * t614;
  t616 = t229 * sigma[0];
  t617 = t230 * t230;
  t618 = t617 * t36;
  t619 = 0.1e1 / t618;
  t622 = 0.1e1 / t235 / t46;
  t626 = 0.11e2 / 0.27e2 * t35 * sigma[0] * t600 * t47 - t228 * t229 * t607 * t236 / 0.24e2 + t615 * t616 * t619 * t622 / 0.162e3;
  t627 = t215 * t626;
  t631 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t573 * t27 * t51 - t580 / 0.4e1 - 0.3e1 / 0.4e1 * t582 * t241 + t588 - t591 / 0.4e1 - 0.3e1 / 0.8e1 * t213 * t596 - 0.3e1 / 0.8e1 * t213 * t627);
  t632 = t60 * t60;
  t633 = 0.1e1 / t632;
  t634 = t247 * t247;
  t637 = -t568;
  t638 = my_piecewise5(t15, 0, t11, 0, t637);
  t642 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t633 * t634 + 0.4e1 / 0.3e1 * t60 * t638);
  t649 = t6 * t250 * t132 * t79;
  t654 = t6 * t62 * t314 * t79 / 0.12e2;
  t656 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t642 * t27 * t79 - t649 / 0.4e1 + t654);
  t658 = t1 * (t631 + t656);
  t659 = cbspline(-t195, 2, params);
  t660 = t394 * t394;
  t661 = t659 * t660;
  t662 = t661 * t189;
  t663 = 0.1e1 / t148;
  t664 = t200 * t200;
  t670 = my_piecewise3(t87, 0, -0.2e1 / 0.9e1 * t663 * t664 + 0.2e1 / 0.3e1 * t264 * t568);
  t671 = 0.1e1 / t150;
  t672 = t246 * t246;
  t678 = my_piecewise3(t93, 0, -0.2e1 / 0.9e1 * t671 * t672 + 0.2e1 / 0.3e1 * t268 * t637);
  t680 = t670 / 0.2e1 + t678 / 0.2e1;
  t681 = t680 * t99;
  t682 = t681 * t4;
  t685 = t275 * t282;
  t690 = 0.1e1 / t27 / t145;
  t691 = t105 * t690;
  t692 = t691 * t192;
  t694 = 0.35e2 / 0.216e3 * t101 * t692;
  t695 = t281 * t390;
  t696 = t101 * t695;
  t699 = 0.1e1 / t285 / t191;
  t700 = t389 * t389;
  t701 = t699 * t700;
  t702 = t109 * t701;
  t707 = t274 * t289;
  t709 = t110 * t690;
  t711 = 0.35e2 / 0.216e3 * t100 * t709;
  t712 = t360 * t360;
  t713 = 0.1e1 / t712;
  t714 = t367 * t367;
  t715 = t713 * t714;
  t716 = t180 * t180;
  t717 = 0.1e1 / t716;
  t718 = t715 * t717;
  t720 = 0.17315859105681463759e2 * t382 * t718;
  t723 = 0.1e1 / t124 / t121 * t99;
  t724 = t129 * t117;
  t726 = 0.1e1 / t131 / t106;
  t727 = t724 * t726;
  t728 = t723 * t727;
  t730 = t303 * t108;
  t731 = t302 * t730;
  t733 = t118 * t108;
  t734 = t116 * t733;
  t736 = 0.1e1/sqrt(t121);
  t737 = t736 * t99;
  t738 = t737 * t727;
  t740 = t310 * t730;
  t743 = t130 * t117 * t726;
  t745 = -0.57538888888888888889e0 * t728 + 0.11507777777777777778e1 * t731 + 0.40256666666666666667e0 * t734 + 0.366775e-1 * t738 + 0.73355e-1 * t740 + 0.137975e0 * t743;
  t747 = t361 * t745 * t368;
  t749 = 0.5848223622634646207e0 * t382 * t747;
  t750 = t339 * t172;
  t751 = t750 * t384;
  t753 = t145 * t106;
  t754 = 0.1e1 / t753;
  t755 = t144 * t754;
  t757 = 0.2e2 * t755 * t185;
  t761 = t116 * t118;
  t762 = t293 * t346;
  t766 = t345 * t164;
  t767 = 0.1e1 / t766;
  t768 = t159 * t767;
  t769 = t352 * t352;
  t770 = t769 * t353;
  t779 = -0.78438333333333333333e0 * t728 + 0.15687666666666666667e1 * t731 + 0.68863333333333333333e0 * t734 + 0.14025833333333333333e0 * t738 + 0.28051666666666666667e0 * t740 + 0.17365833333333333333e0 * t743;
  t780 = t779 * t353;
  t783 = t345 * t345;
  t784 = 0.1e1 / t783;
  t785 = t159 * t784;
  t786 = t167 * t167;
  t787 = 0.1e1 / t786;
  t788 = t769 * t787;
  t793 = 0.14764627977777777777e-2 * t116 * t733 * t140;
  t794 = t293 * t299;
  t797 = 0.35616666666666666666e-1 * t761 * t794 * t320;
  t798 = t298 * t136;
  t799 = 0.1e1 / t798;
  t800 = t123 * t799;
  t801 = t318 * t318;
  t802 = t801 * t319;
  t804 = 0.2e1 * t800 * t802;
  t811 = -0.42198333333333333333e0 * t728 + 0.84396666666666666666e0 * t731 + 0.39862222222222222223e0 * t734 + 0.68258333333333333333e-1 * t738 + 0.13651666666666666667e0 * t740 + 0.13692777777777777778e0 * t743;
  t812 = t811 * t319;
  t814 = 0.1e1 * t300 * t812;
  t815 = t298 * t298;
  t816 = 0.1e1 / t815;
  t817 = t123 * t816;
  t818 = t139 * t139;
  t819 = 0.1e1 / t818;
  t820 = t801 * t819;
  t822 = 0.16081979498692535067e2 * t817 * t820;
  t826 = t293 * t361;
  t830 = t360 * t177;
  t831 = 0.1e1 / t830;
  t832 = t172 * t831;
  t833 = t714 * t368;
  t836 = t745 * t368;
  t839 = t172 * t713;
  t840 = t714 * t717;
  t843 = -0.70983522622222222221e-3 * t116 * t733 * t168 - 0.34246666666666666666e-1 * t761 * t762 * t354 - 0.2e1 * t768 * t770 + 0.1e1 * t347 * t780 + 0.32163958997385070134e2 * t785 * t788 + t793 + t797 + t804 - t814 - t822 - 0.24415263074675393405e-3 * t116 * t733 * t181 - 0.10843581300301739842e-1 * t761 * t826 * t369 - 0.11696447245269292414e1 * t832 * t833 + 0.5848223622634646207e0 * t362 * t836 + 0.17315859105681463759e2 * t839 * t840;
  t844 = t157 * t843;
  t845 = t147 * t844;
  t846 = 0.1e1 / t90;
  t852 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t846 * t664 + 0.4e1 / 0.3e1 * t89 * t568);
  t853 = 0.1e1 / t95;
  t859 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t853 * t672 + 0.4e1 / 0.3e1 * t94 * t637);
  t861 = (t852 + t859) * t156;
  t862 = t861 * t184;
  t864 = t339 * t372;
  t865 = t147 * t864;
  t867 = t329 * t340;
  t870 = 0.8e1 * t329 * t373;
  t871 = t324 * t340;
  t874 = 0.8e1 * t324 * t373;
  t875 = -t720 - t749 - 0.11696447245269292414e1 * t751 + t757 + t845 + t147 * t862 + 0.2e1 * t865 - 0.8e1 * t867 - t870 + 0.8e1 * t871 + t874;
  t876 = t143 * t146;
  t878 = 0.12e2 * t876 * t185;
  t879 = t323 * t328;
  t881 = 0.32e2 * t879 * t185;
  t885 = t303 * t108 * t181;
  t887 = 0.24415263074675393405e-3 * t377 * t885;
  t888 = t339 * t3;
  t889 = t888 * t379;
  t892 = t831 * t714 * t368;
  t894 = 0.11696447245269292414e1 * t382 * t892;
  t895 = t157 * t116;
  t896 = t294 * t384;
  t898 = 0.10843581300301739842e-1 * t895 * t896;
  t899 = -t804 + t878 - t881 - t793 + 0.19751673498613801407e-1 * t861 * t182 + t814 + t822 + t887 - 0.36622894612013090108e-3 * t889 + t894 - t797 + t898;
  t900 = t875 + t899;
  t902 = -t681 * t111 / 0.48e2 + 0.7e1 / 0.72e2 * t707 - t711 + params->gammac * t900;
  t903 = t286 * t902;
  t904 = t109 * t903;
  t907 = -t682 * t193 / 0.48e2 + 0.7e1 / 0.72e2 * t685 + t275 * t391 / 0.24e2 - t694 - 0.7e1 / 0.72e2 * t696 - t101 * t702 / 0.24e2 + t101 * t904 / 0.48e2;
  t908 = t263 * t907;
  t909 = t908 * t189;
  t910 = t395 * t387;
  t911 = 0.2e1 * t910;
  t912 = t196 * t900;
  tv2rho20 = 0.2e1 * t262 + 0.2e1 * t396 + 0.2e1 * t397 + t7 * (t658 + t662 + t909 + t911 + t912);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t915 = t561 * t401;
  t918 = 0.2e1 * t566;
  t919 = my_piecewise5(t11, 0, t15, 0, t918);
  t923 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t915 * t201 + 0.4e1 / 0.3e1 * t24 * t919);
  t930 = t6 * t404 * t132 * t51;
  t932 = t6 * t404;
  t938 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t923 * t27 * t51 - t930 / 0.8e1 - 0.3e1 / 0.8e1 * t932 * t241 - t580 / 0.8e1 + t588 - t591 / 0.8e1);
  t939 = t633 * t412;
  t942 = my_piecewise5(t15, 0, t11, 0, -t918);
  t946 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t939 * t247 + 0.4e1 / 0.3e1 * t60 * t942);
  t953 = t6 * t415 * t132 * t79;
  t956 = t6 * t250;
  t959 = t132 * t421;
  t960 = t959 * t441;
  t961 = t420 * t960;
  t964 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t946 * t27 * t79 - t953 / 0.8e1 - t649 / 0.8e1 + t654 - 0.3e1 / 0.8e1 * t956 * t442 - t961 / 0.8e1);
  t966 = t1 * (t938 + t964);
  t967 = t659 * t394;
  t968 = t482 * t189;
  t969 = t967 * t968;
  t970 = t663 * t400;
  t973 = t264 * t17;
  t977 = my_piecewise3(t87, 0, -0.2e1 / 0.9e1 * t970 * t200 + 0.4e1 / 0.3e1 * t973 * t565);
  t978 = t671 * t411;
  t981 = t268 * t17;
  t985 = my_piecewise3(t93, 0, -0.2e1 / 0.9e1 * t978 * t246 - 0.4e1 / 0.3e1 * t981 * t565);
  t987 = t977 / 0.2e1 + t985 / 0.2e1;
  t988 = t987 * t99;
  t989 = t988 * t4;
  t992 = t458 * t282;
  t1000 = t281 * t478;
  t1001 = t101 * t1000;
  t1003 = t100 * t110;
  t1004 = t108 * t699;
  t1005 = t477 * t389;
  t1006 = t1004 * t1005;
  t1011 = t457 * t289;
  t1014 = t470 * t3;
  t1015 = t1014 * t379;
  t1018 = t324 * t471;
  t1020 = t329 * t471;
  t1023 = -0.18311447306006545054e-3 * t1015 - t797 + t887 - 0.18311447306006545054e-3 * t889 + t898 + 0.4e1 * t1018 - 0.4e1 * t1020 - t720 - t749 - 0.5848223622634646207e0 * t751 - t804 + t814 + t822;
  t1024 = t846 * t400;
  t1027 = t89 * t17;
  t1031 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t1024 * t200 + 0.8e1 / 0.3e1 * t1027 * t565);
  t1032 = t853 * t411;
  t1035 = t94 * t17;
  t1039 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t1032 * t246 - 0.8e1 / 0.3e1 * t1035 * t565);
  t1041 = (t1031 + t1039) * t156;
  t1042 = t1041 * t184;
  t1044 = t470 * t372;
  t1045 = t147 * t1044;
  t1050 = t470 * t172;
  t1051 = t1050 * t384;
  t1053 = t147 * t1042 + t1045 + 0.19751673498613801407e-1 * t1041 * t182 - t878 - t870 - 0.4e1 * t871 + t865 - 0.4e1 * t867 - t793 + t757 + t845 - 0.5848223622634646207e0 * t1051 + t894;
  t1054 = t1023 + t1053;
  t1056 = -t988 * t111 / 0.48e2 + 0.7e1 / 0.144e3 * t1011 + 0.7e1 / 0.144e3 * t707 - t711 + params->gammac * t1054;
  t1057 = t286 * t1056;
  t1058 = t109 * t1057;
  t1061 = -t989 * t193 / 0.48e2 + 0.7e1 / 0.144e3 * t992 + t458 * t391 / 0.48e2 + 0.7e1 / 0.144e3 * t685 - t694 - 0.7e1 / 0.144e3 * t696 + t275 * t479 / 0.48e2 - 0.7e1 / 0.144e3 * t1001 - t1003 * t1006 / 0.24e2 + t101 * t1058 / 0.48e2;
  t1062 = t263 * t1061;
  t1063 = t1062 * t189;
  t1064 = t483 * t387;
  t1065 = t395 * t475;
  t1066 = t196 * t1054;
  tv2rho21 = t262 + t396 + t397 + t448 + t484 + t485 + t7 * (t966 + t969 + t1063 + t1064 + t1065 + t1066);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1072 = t401 * t401;
  t1076 = 0.2e1 * t198 + 0.2e1 * t566;
  t1077 = my_piecewise5(t11, 0, t15, 0, t1076);
  t1081 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t561 * t1072 + 0.4e1 / 0.3e1 * t24 * t1077);
  t1088 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1081 * t27 * t51 - t930 / 0.4e1 + t588);
  t1089 = t412 * t412;
  t1092 = -t1076;
  t1093 = my_piecewise5(t15, 0, t11, 0, t1092);
  t1097 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t633 * t1089 + 0.4e1 / 0.3e1 * t60 * t1093);
  t1103 = t6 * t415;
  t1107 = xbspline(t78, 2, params);
  t1108 = t27 * t1107;
  t1109 = t441 * t441;
  t1110 = t1108 * t1109;
  t1114 = 0.1e1 / t66 / t431;
  t1119 = t431 * t423;
  t1121 = 0.1e1 / t65 / t1119;
  t1126 = t430 * sigma[2];
  t1127 = t431 * t431;
  t1128 = t1127 * t64;
  t1129 = 0.1e1 / t1128;
  t1132 = 0.1e1 / t436 / t74;
  t1136 = 0.11e2 / 0.27e2 * t35 * sigma[2] * t1114 * t75 - t228 * t430 * t1121 * t437 / 0.24e2 + t615 * t1126 * t1129 * t1132 / 0.162e3;
  t1137 = t422 * t1136;
  t1141 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t1097 * t27 * t79 - t953 / 0.4e1 - 0.3e1 / 0.4e1 * t1103 * t442 + t654 - t961 / 0.4e1 - 0.3e1 / 0.8e1 * t420 * t1110 - 0.3e1 / 0.8e1 * t420 * t1137);
  t1143 = t1 * (t1088 + t1141);
  t1144 = t482 * t482;
  t1145 = t659 * t1144;
  t1146 = t1145 * t189;
  t1147 = t400 * t400;
  t1153 = my_piecewise3(t87, 0, -0.2e1 / 0.9e1 * t663 * t1147 + 0.2e1 / 0.3e1 * t264 * t1076);
  t1154 = t411 * t411;
  t1160 = my_piecewise3(t93, 0, -0.2e1 / 0.9e1 * t671 * t1154 + 0.2e1 / 0.3e1 * t268 * t1092);
  t1162 = t1153 / 0.2e1 + t1160 / 0.2e1;
  t1163 = t1162 * t99;
  t1164 = t1163 * t4;
  t1171 = t477 * t477;
  t1172 = t699 * t1171;
  t1173 = t109 * t1172;
  t1184 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t846 * t1147 + 0.4e1 / 0.3e1 * t89 * t1076);
  t1190 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t853 * t1154 + 0.4e1 / 0.3e1 * t94 * t1092);
  t1192 = (t1184 + t1190) * t156;
  t1193 = t1192 * t184;
  t1201 = t147 * t1193 + 0.19751673498613801407e-1 * t1192 * t182 - 0.11696447245269292414e1 * t1051 + 0.2e1 * t1045 - 0.8e1 * t1018 - 0.8e1 * t1020 - t720 - t749 + t757 + t845 - t870;
  t1203 = -t874 - t804 + t878 + t881 - t793 + t814 + t822 + t887 - 0.36622894612013090108e-3 * t1015 + t894 - t797 + t898;
  t1204 = t1201 + t1203;
  t1206 = -t1163 * t111 / 0.48e2 + 0.7e1 / 0.72e2 * t1011 - t711 + params->gammac * t1204;
  t1207 = t286 * t1206;
  t1208 = t109 * t1207;
  t1211 = -t1164 * t193 / 0.48e2 + 0.7e1 / 0.72e2 * t992 + t458 * t479 / 0.24e2 - t694 - 0.7e1 / 0.72e2 * t1001 - t101 * t1173 / 0.24e2 + t101 * t1208 / 0.48e2;
  t1212 = t263 * t1211;
  t1213 = t1212 * t189;
  t1214 = t483 * t475;
  t1215 = 0.2e1 * t1214;
  t1216 = t196 * t1204;
  tv2rho22 = 0.2e1 * t448 + 0.2e1 * t484 + 0.2e1 * t485 + t7 * (t1143 + t1146 + t1213 + t1215 + t1216);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1221 = t589 * t499;
  t1223 = t213 * t1221 / 0.8e1;
  t1224 = t240 * t499;
  t1225 = t594 * t1224;
  t1236 = t617 * rho[0];
  t1237 = 0.1e1 / t1236;
  t1242 = -t30 * t34 * t218 * t47 / 0.9e1 + t228 * t233 * t236 * sigma[0] / 0.72e2 - t615 * t229 * t1237 * t622 / 0.432e3;
  t1243 = t215 * t1242;
  t1247 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t582 * t500 - t1223 - 0.3e1 / 0.8e1 * t213 * t1225 - 0.3e1 / 0.8e1 * t213 * t1243);
  t1248 = t1 * t1247;
  t1249 = t523 * t189;
  t1250 = t967 * t1249;
  t1253 = t104 * t280;
  t1254 = t1253 * t507;
  t1256 = 0.7e1 / 0.144e3 * t101 * t1254;
  t1257 = t4 * t104;
  t1258 = t100 * t1257;
  t1259 = t108 * t286;
  t1260 = t506 * t389;
  t1261 = t1259 * t1260;
  t1264 = t98 * t3;
  t1265 = t513 * t515;
  t1266 = t1264 * t1265;
  t1267 = t517 * t286;
  t1268 = t506 * t273;
  t1273 = 0.1e1 / t131 / t327;
  t1274 = t515 * t1273;
  t1275 = t1274 * t519;
  t1277 = 0.7e1 / 0.1152e4 * t514 * t1275;
  t1278 = t512 * t1265;
  t1279 = t517 * t699;
  t1280 = t1279 * t1260;
  t1283 = -t275 * t508 / 0.48e2 + t1256 + t1258 * t1261 / 0.48e2 - t1266 * t1267 * t1268 / 0.384e3 + t1277 + t1278 * t1280 / 0.384e3;
  t1284 = t263 * t1283;
  t1285 = t1284 * t189;
  t1286 = t524 * t387;
  tv2rhosigma0 = t504 + t525 + t7 * (t1248 + t1250 + t1285 + t1286);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1291 = t959 * t538;
  t1293 = t420 * t1291 / 0.8e1;
  t1295 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t956 * t539 - t1293);
  t1296 = t1 * t1295;
  t1297 = t553 * t189;
  t1298 = t967 * t1297;
  t1301 = t1253 * t545;
  t1303 = 0.7e1 / 0.144e3 * t101 * t1301;
  t1304 = t544 * t389;
  t1305 = t1259 * t1304;
  t1308 = t544 * t273;
  t1312 = t1274 * t549;
  t1314 = 0.7e1 / 0.1152e4 * t514 * t1312;
  t1315 = t1279 * t1304;
  t1318 = -t275 * t546 / 0.48e2 + t1303 + t1258 * t1305 / 0.48e2 - t1266 * t1267 * t1308 / 0.384e3 + t1314 + t1278 * t1315 / 0.384e3;
  t1319 = t263 * t1318;
  t1320 = t1319 * t189;
  t1321 = t554 * t387;
  tv2rhosigma2 = t543 + t555 + t7 * (t1296 + t1298 + t1320 + t1321);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1327 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t932 * t500 - t1223);
  t1328 = t1 * t1327;
  t1329 = t659 * t482;
  t1330 = t1329 * t1249;
  t1333 = t506 * t477;
  t1334 = t1259 * t1333;
  t1337 = t506 * t456;
  t1338 = t1267 * t1337;
  t1341 = t1279 * t1333;
  t1344 = -t458 * t508 / 0.48e2 + t1256 + t1258 * t1334 / 0.48e2 - t1266 * t1338 / 0.384e3 + t1277 + t1278 * t1341 / 0.384e3;
  t1345 = t263 * t1344;
  t1346 = t1345 * t189;
  t1347 = t524 * t475;
  tv2rhosigma3 = t504 + t525 + t7 * (t1328 + t1330 + t1346 + t1347);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1352 = t441 * t538;
  t1353 = t1108 * t1352;
  t1364 = t1127 * rho[1];
  t1365 = 0.1e1 / t1364;
  t1370 = -t30 * t34 * t425 * t75 / 0.9e1 + t228 * t434 * t437 * sigma[2] / 0.72e2 - t615 * t430 * t1365 * t1132 / 0.432e3;
  t1371 = t422 * t1370;
  t1375 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t1103 * t539 - t1293 - 0.3e1 / 0.8e1 * t420 * t1353 - 0.3e1 / 0.8e1 * t420 * t1371);
  t1376 = t1 * t1375;
  t1377 = t1329 * t1297;
  t1380 = t544 * t477;
  t1381 = t1259 * t1380;
  t1384 = t544 * t456;
  t1385 = t1267 * t1384;
  t1388 = t1279 * t1380;
  t1391 = -t458 * t546 / 0.48e2 + t1303 + t1258 * t1381 / 0.48e2 - t1266 * t1385 / 0.384e3 + t1314 + t1278 * t1388 / 0.384e3;
  t1392 = t263 * t1391;
  t1393 = t1392 * t189;
  t1394 = t554 * t475;
  tv2rhosigma5 = t543 + t555 + t7 * (t1376 + t1377 + t1393 + t1394);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1397 = t499 * t499;
  t1398 = t594 * t1397;
  t1404 = 0.1e1 / t617;
  t1409 = -t225 * t227 * t494 * t236 / 0.288e3 + t615 * sigma[0] * t1404 * t622 / 0.1152e4;
  t1410 = t215 * t1409;
  t1414 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t213 * t1398 - 0.3e1 / 0.8e1 * t213 * t1410);
  t1415 = t1 * t1414;
  t1416 = t523 * t523;
  t1417 = t659 * t1416;
  t1418 = t1417 * t189;
  t1419 = 0.1e1 / sigma[0];
  t1420 = t1419 * t108;
  t1421 = t1420 * t192;
  t1424 = t105 * t517;
  t1425 = t286 * t1419;
  t1426 = t1424 * t1425;
  t1430 = 0.1e1 / t102 / sigma[0];
  t1431 = t192 * t1430;
  t1432 = t505 * t1431;
  t1435 = t511 * t98;
  t1436 = t1435 * M_PI;
  t1437 = t105 * t105;
  t1438 = t1436 * t1437;
  t1439 = t145 * t278;
  t1440 = 0.1e1 / t1439;
  t1441 = t1440 * t699;
  t1445 = t286 * t1430;
  t1446 = t518 * t1445;
  t1449 = -t101 * t1421 / 0.96e2 - 0.5e1 / 0.1536e4 * t514 * t1426 + t101 * t1432 / 0.96e2 - t1438 * t1441 * t1419 / 0.6144e4 + t514 * t1446 / 0.1536e4;
  t1450 = t263 * t1449;
  t1451 = t1450 * t189;
  tv2sigma20 = t7 * (t1415 + t1418 + t1451);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  t1453 = t659 * t523;
  t1454 = t1453 * t1297;
  t1455 = t506 * t108;
  t1456 = t1455 * t545;
  t1459 = t513 * t105;
  t1460 = t512 * t1459;
  t1461 = t544 * t506;
  t1462 = t1267 * t1461;
  t1468 = -t101 * t1456 / 0.96e2 - 0.5e1 / 0.1536e4 * t1460 * t1462 - t1438 * t1441 * t1461 / 0.6144e4;
  t1469 = t263 * t1468;
  t1470 = t1469 * t189;
  tv2sigma22 = t7 * (t1454 + t1470);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1472 = t538 * t538;
  t1473 = t1108 * t1472;
  t1479 = 0.1e1 / t1127;
  t1484 = -t225 * t227 * t533 * t437 / 0.288e3 + t615 * sigma[2] * t1479 * t1132 / 0.1152e4;
  t1485 = t422 * t1484;
  t1489 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t420 * t1473 - 0.3e1 / 0.8e1 * t420 * t1485);
  t1490 = t1 * t1489;
  t1491 = t553 * t553;
  t1492 = t659 * t1491;
  t1493 = t1492 * t189;
  t1494 = 0.1e1 / sigma[2];
  t1495 = t1494 * t108;
  t1496 = t1495 * t192;
  t1499 = t286 * t1494;
  t1500 = t1424 * t1499;
  t1504 = 0.1e1 / t103 / sigma[2];
  t1505 = t192 * t1504;
  t1506 = t505 * t1505;
  t1512 = t286 * t1504;
  t1513 = t518 * t1512;
  t1516 = -t101 * t1496 / 0.96e2 - 0.5e1 / 0.1536e4 * t514 * t1500 + t101 * t1506 / 0.96e2 - t1438 * t1441 * t1494 / 0.6144e4 + t514 * t1513 / 0.1536e4;
  t1517 = t263 * t1516;
  t1518 = t1517 * t189;
  tv2sigma25 = t7 * (t1490 + t1493 + t1518);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1526 = 0.1e1 / t560 / t20;
  t1527 = t562 * t201;
  t1530 = t561 * t201;
  t1533 = t17 * t146;
  t1535 = 0.6e1 * t565 - 0.6e1 * t1533;
  t1536 = my_piecewise5(t11, 0, t15, 0, t1535);
  t1540 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1526 * t1527 + 0.4e1 / 0.3e1 * t1530 * t569 + 0.4e1 / 0.3e1 * t24 * t1536);
  t1548 = 0.5e1 / 0.36e2 * t6 * t26 * t726 * t51;
  t1549 = t314 * t214;
  t1550 = t1549 * t240;
  t1551 = t213 * t1550;
  t1553 = t589 * t626;
  t1554 = t213 * t1553;
  t1557 = 0.1e1 / t38 / t492;
  t1563 = 0.1e1 / t37 / t617;
  t1568 = t617 * t216;
  t1569 = 0.1e1 / t1568;
  t1574 = t223 * t223;
  t1575 = t1574 * t614;
  t1576 = t229 * t229;
  t1577 = t1575 * t1576;
  t1578 = t617 * t492;
  t1580 = 0.1e1 / t38 / t1578;
  t1581 = t235 * t235;
  t1582 = 0.1e1 / t1581;
  t1584 = t29 * t34;
  t1588 = -0.154e3 / 0.81e2 * t35 * sigma[0] * t1557 * t47 + 0.341e3 / 0.972e3 * t228 * t229 * t1563 * t236 - 0.19e2 / 0.162e3 * t615 * t616 * t1569 * t622 + t1577 * t1580 * t1582 * t1584 / 0.486e3;
  t1589 = t215 * t1588;
  t1594 = t6 * t573 * t132 * t51;
  t1596 = t6 * t573;
  t1601 = t6 * t204 * t314 * t51;
  t1603 = t582 * t590;
  t1607 = t132 * t593;
  t1608 = t1607 * t595;
  t1609 = t213 * t1608;
  t1611 = t240 * t626;
  t1612 = t594 * t1611;
  t1615 = xbspline(t50, 3, params);
  t1616 = t27 * t1615;
  t1617 = t595 * t240;
  t1618 = t1616 * t1617;
  t1623 = -0.3e1 / 0.8e1 * t6 * t1540 * t27 * t51 - t1548 + t1551 / 0.4e1 - 0.3e1 / 0.8e1 * t1554 - 0.3e1 / 0.8e1 * t213 * t1589 - 0.3e1 / 0.8e1 * t1594 - 0.9e1 / 0.8e1 * t1596 * t241 + t1601 / 0.4e1 - 0.3e1 / 0.4e1 * t1603 - 0.9e1 / 0.8e1 * t582 * t627 - 0.3e1 / 0.8e1 * t1609 - 0.9e1 / 0.8e1 * t213 * t1612 - 0.3e1 / 0.8e1 * t213 * t1618 - 0.9e1 / 0.8e1 * t582 * t596;
  t1624 = my_piecewise3(t2, 0, t1623);
  t1626 = 0.1e1 / t632 / t58;
  t1627 = t634 * t247;
  t1630 = t633 * t247;
  t1633 = -t1535;
  t1634 = my_piecewise5(t15, 0, t11, 0, t1633);
  t1638 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t1626 * t1627 + 0.4e1 / 0.3e1 * t1630 * t638 + 0.4e1 / 0.3e1 * t60 * t1634);
  t1645 = t6 * t642 * t132 * t79;
  t1649 = t6 * t250 * t314 * t79;
  t1654 = 0.5e1 / 0.36e2 * t6 * t62 * t726 * t79;
  t1656 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t1638 * t27 * t79 - 0.3e1 / 0.8e1 * t1645 + t1649 / 0.4e1 - t1654);
  t1658 = t1 * (t1624 + t1656);
  t1659 = cbspline(-t195, 3, params);
  t1660 = t660 * t394;
  t1661 = t1659 * t1660;
  t1662 = t1661 * t189;
  t1663 = t189 * t907;
  t1664 = t967 * t1663;
  t1665 = 0.3e1 * t1664;
  t1666 = t661 * t387;
  t1667 = 0.3e1 * t1666;
  t1668 = t86 * t86;
  t1670 = 0.1e1 / t89 / t1668;
  t1671 = t664 * t200;
  t1674 = t663 * t200;
  t1680 = my_piecewise3(t87, 0, 0.8e1 / 0.27e2 * t1670 * t1671 - 0.2e1 / 0.3e1 * t1674 * t568 + 0.2e1 / 0.3e1 * t264 * t1535);
  t1681 = t92 * t92;
  t1683 = 0.1e1 / t94 / t1681;
  t1684 = t672 * t246;
  t1687 = t671 * t246;
  t1693 = my_piecewise3(t93, 0, 0.8e1 / 0.27e2 * t1683 * t1684 - 0.2e1 / 0.3e1 * t1687 * t637 + 0.2e1 / 0.3e1 * t268 * t1633);
  t1695 = t1680 / 0.2e1 + t1693 / 0.2e1;
  t1696 = t1695 * t99;
  t1699 = t681 * t289;
  t1701 = t274 * t709;
  t1704 = 0.1e1 / t27 / t327;
  t1705 = t110 * t1704;
  t1707 = 0.455e3 / 0.648e3 * t100 * t1705;
  t1708 = t861 * t3;
  t1709 = t1708 * t379;
  t1712 = t831 * t745 * t369;
  t1714 = 0.35089341735807877242e1 * t382 * t1712;
  t1716 = t717 * t745;
  t1717 = t713 * t367 * t1716;
  t1719 = 0.51947577317044391277e2 * t382 * t1717;
  t1721 = t303 * t280 * t181;
  t1723 = 0.56968947174242584612e-3 * t377 * t1721;
  t1724 = t801 * t318;
  t1725 = t1724 * t319;
  t1727 = 0.6e1 * t817 * t1725;
  t1731 = 0.1e1 / t124 / t134 * t114 / 0.4e1;
  t1732 = t1731 * t146;
  t1735 = 0.1e1 / t131 / t278;
  t1736 = t724 * t1735;
  t1737 = t723 * t1736;
  t1739 = t303 * t280;
  t1740 = t302 * t1739;
  t1742 = t118 * t280;
  t1743 = t116 * t1742;
  t1745 = 0.1e1/POW_3_2(t121);
  t1746 = t1745 * t114;
  t1747 = t1746 * t146;
  t1749 = t737 * t1736;
  t1751 = t310 * t1739;
  t1754 = t130 * t117 * t1735;
  t1756 = -0.25319e1 * t1732 + 0.16879333333333333333e1 * t1737 - 0.19692555555555555555e1 * t1740 - 0.93011851851851851854e0 * t1743 + 0.13651666666666666667e0 * t1747 - 0.27303333333333333333e0 * t1749 - 0.3185388888888888889e0 * t1751 - 0.36514074074074074075e0 * t1754;
  t1757 = t1756 * t319;
  t1759 = 0.1e1 * t300 * t1757;
  t1761 = 0.1e1 / t815 / t298;
  t1762 = t123 * t1761;
  t1764 = 0.1e1 / t818 / t139;
  t1765 = t1724 * t1764;
  t1767 = 0.51726012919273400301e3 * t1762 * t1765;
  t1769 = 0.1e1 / t815 / t136;
  t1770 = t123 * t1769;
  t1771 = t1724 * t819;
  t1773 = 0.96491876992155210402e2 * t1770 * t1771;
  t1775 = 0.1e1 / t90 / t86;
  t1778 = t846 * t200;
  t1784 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t1775 * t1671 + 0.4e1 / 0.3e1 * t1778 * t568 + 0.4e1 / 0.3e1 * t89 * t1535);
  t1786 = 0.1e1 / t95 / t92;
  t1789 = t853 * t246;
  t1795 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1786 * t1684 + 0.4e1 / 0.3e1 * t1789 * t637 + 0.4e1 / 0.3e1 * t94 * t1633);
  t1797 = (t1784 + t1795) * t156;
  t1800 = t879 * t373;
  t1801 = 0.96e2 * t1800;
  t1802 = t879 * t340;
  t1804 = t1797 * t184;
  t1806 = -0.54934341918019635162e-3 * t1709 + t1714 - t1719 - t1723 + t1727 + t1759 + t1767 - t1773 + 0.19751673498613801407e-1 * t1797 * t182 - t1801 - 0.96e2 * t1802 + t147 * t1804;
  t1807 = t714 * t367;
  t1809 = t713 * t1807 * t368;
  t1811 = 0.35089341735807877242e1 * t382 * t1809;
  t1812 = t339 * t116;
  t1813 = t1812 * t896;
  t1815 = t733 * t384;
  t1817 = 0.21687162600603479684e-1 * t895 * t1815;
  t1818 = t294 * t892;
  t1820 = 0.32530743900905219526e-1 * t895 * t1818;
  t1821 = t294 * t718;
  t1823 = 0.48159733137676571078e0 * t895 * t1821;
  t1824 = t294 * t747;
  t1826 = 0.16265371950452609763e-1 * t895 * t1824;
  t1835 = -0.34523333333333333333e1 * t1732 + 0.23015555555555555556e1 * t1737 - 0.26851481481481481482e1 * t1740 - 0.93932222222222222223e0 * t1743 + 0.73355e-1 * t1747 - 0.14671e0 * t1749 - 0.17116166666666666667e0 * t1751 - 0.36793333333333333333e0 * t1754;
  t1837 = t361 * t1835 * t368;
  t1839 = 0.5848223622634646207e0 * t382 * t1837;
  t1841 = 0.1e1 / t712 / t360;
  t1844 = 0.1e1 / t716 / t180;
  t1845 = t1841 * t1807 * t1844;
  t1847 = 0.10254018858216406658e4 * t382 * t1845;
  t1848 = t750 * t747;
  t1850 = t750 * t718;
  t1852 = t861 * t172;
  t1853 = t1852 * t384;
  t1856 = 0.24e2 * t1533 * t185;
  t1857 = t143 * t328;
  t1858 = t1857 * t185;
  t1859 = 0.144e3 * t1858;
  t1860 = -t1811 + 0.32530743900905219526e-1 * t1813 - t1817 - t1820 + t1823 + t1826 - t1839 - t1847 - 0.17544670867903938621e1 * t1848 - 0.51947577317044391276e2 * t1850 - 0.17544670867903938621e1 * t1853 + t1856 - t1859;
  t1862 = t888 * t885;
  t1864 = t293 * t816;
  t1867 = 0.85917975471764868594e0 * t761 * t1864 * t820;
  t1868 = t108 * t299;
  t1871 = 0.71233333333333333332e-1 * t761 * t1868 * t320;
  t1874 = 0.53424999999999999999e-1 * t761 * t794 * t812;
  t1878 = 0.10685e0 * t761 * t293 * t799 * t802;
  t1879 = t876 * t373;
  t1880 = 0.36e2 * t1879;
  t1881 = t876 * t340;
  t1883 = t861 * t372;
  t1884 = t147 * t1883;
  t1886 = t811 * t819;
  t1889 = 0.48245938496077605201e2 * t817 * t1886 * t318;
  t1892 = 0.6e1 * t800 * t320 * t811;
  t1893 = t324 * t864;
  t1895 = t750 * t892;
  t1897 = 0.73245789224026180216e-3 * t1862 - t1867 + t1871 - t1874 + t1878 + t1880 + 0.36e2 * t1881 + 0.3e1 * t1884 + t1889 - t1892 + 0.24e2 * t1893 + 0.35089341735807877242e1 * t1895;
  t1899 = 0.1e1 / t712 / t177;
  t1901 = t1899 * t1807 * t717;
  t1903 = 0.10389515463408878255e3 * t382 * t1901;
  t1904 = t329 * t864;
  t1906 = t324 * t862;
  t1908 = t329 * t862;
  t1912 = 0.34450798614814814813e-2 * t116 * t1742 * t140;
  t1914 = 0.12e2 * t329 * t844;
  t1915 = t323 * t754;
  t1916 = t1915 * t185;
  t1917 = 0.24e3 * t1916;
  t1918 = t144 * t1440;
  t1920 = 0.12e3 * t1918 * t185;
  t1921 = t324 * t844;
  t1922 = 0.12e2 * t1921;
  t1923 = t755 * t340;
  t1926 = 0.6e2 * t755 * t373;
  t1927 = t339 * t843;
  t1928 = t147 * t1927;
  t1931 = 0.1e1 / t783 / t164;
  t1932 = t159 * t1931;
  t1933 = t769 * t352;
  t1934 = t1933 * t787;
  t1945 = -0.47063e1 * t1732 + 0.31375333333333333334e1 * t1737 - 0.36604555555555555556e1 * t1740 - 0.16068111111111111111e1 * t1743 + 0.28051666666666666666e0 * t1747 - 0.56103333333333333332e0 * t1749 - 0.6545388888888888889e0 * t1751 - 0.46308888888888888888e0 * t1754;
  t1946 = t1945 * t353;
  t1950 = 0.1e1 / t783 / t345;
  t1951 = t159 * t1950;
  t1953 = 0.1e1 / t786 / t167;
  t1954 = t1933 * t1953;
  t1957 = t172 * t1899;
  t1958 = t1807 * t717;
  t1961 = t1835 * t368;
  t1964 = t1807 * t368;
  t1967 = t172 * t1841;
  t1968 = t1807 * t1844;
  t1971 = t369 * t745;
  t1974 = t108 * t361;
  t1981 = t293 * t713;
  t1985 = -t1727 - 0.19298375398431042081e3 * t1932 * t1934 + 0.1e1 * t347 * t1946 - t1759 - t1767 + 0.2069040516770936012e4 * t1951 * t1954 - 0.10389515463408878255e3 * t1957 * t1958 + 0.5848223622634646207e0 * t362 * t1961 + t1773 + 0.35089341735807877242e1 * t839 * t1964 + 0.10254018858216406658e4 * t1967 * t1968 - 0.35089341735807877242e1 * t832 * t1971 + 0.21687162600603479684e-1 * t761 * t1974 * t369 - 0.16265371950452609763e-1 * t761 * t826 * t836 - 0.48159733137676571078e0 * t761 * t1981 * t840 + t1867;
  t1986 = t108 * t346;
  t1993 = t293 * t784;
  t1997 = t293 * t831;
  t2008 = t1933 * t353;
  t2011 = t1716 * t367;
  t2014 = t779 * t787;
  t2024 = -t1871 + t1874 + 0.68493333333333333332e-1 * t761 * t1986 * t354 - 0.51369999999999999999e-1 * t761 * t762 * t780 - 0.16522625736956710527e1 * t761 * t1993 * t788 + 0.32530743900905219526e-1 * t761 * t1997 * t833 + 0.10274e0 * t761 * t293 * t767 * t770 - t1878 - t1889 + t1892 + 0.56968947174242584612e-3 * t116 * t1742 * t181 - t1912 + 0.6e1 * t785 * t2008 + 0.51947577317044391277e2 * t839 * t2011 + 0.96491876992155210402e2 * t785 * t2014 * t352 - 0.6e1 * t768 * t354 * t779 + 0.16562821945185185185e-2 * t116 * t1742 * t168;
  t2025 = t1985 + t2024;
  t2026 = t157 * t2025;
  t2027 = t147 * t2026;
  t2028 = t1903 - 0.24e2 * t1904 + 0.12e2 * t1906 - 0.12e2 * t1908 + t1912 - t1914 + t1917 - t1920 + t1922 + 0.6e2 * t1923 + t1926 + 0.3e1 * t1928 + t2027;
  t2030 = t1806 + t1860 + t1897 + t2028;
  t2032 = -t1696 * t111 / 0.48e2 + 0.7e1 / 0.48e2 * t1699 - 0.35e2 / 0.72e2 * t1701 + t1707 + params->gammac * t2030;
  t2033 = t286 * t2032;
  t2034 = t109 * t2033;
  t2037 = t281 * t903;
  t2038 = t101 * t2037;
  t2040 = t105 * t1704;
  t2041 = t2040 * t192;
  t2043 = 0.455e3 / 0.648e3 * t101 * t2041;
  t2044 = t691 * t390;
  t2045 = t101 * t2044;
  t2047 = t1696 * t4;
  t2050 = t682 * t282;
  t2054 = t275 * t692;
  t2056 = t275 * t695;
  t2060 = t285 * t285;
  t2061 = 0.1e1 / t2060;
  t2062 = t700 * t389;
  t2063 = t2061 * t2062;
  t2064 = t109 * t2063;
  t2067 = t389 * t902;
  t2068 = t1004 * t2067;
  t2071 = t281 * t701;
  t2072 = t101 * t2071;
  t2076 = t101 * t2034 / 0.48e2 - 0.7e1 / 0.48e2 * t2038 + t2043 + 0.35e2 / 0.72e2 * t2045 - t2047 * t193 / 0.48e2 + 0.7e1 / 0.48e2 * t2050 + t682 * t391 / 0.16e2 - 0.35e2 / 0.72e2 * t2054 - 0.7e1 / 0.24e2 * t2056 + t275 * t904 / 0.16e2 + t101 * t2064 / 0.8e1 - t1003 * t2068 / 0.8e1 + 0.7e1 / 0.24e2 * t2072 - t275 * t702 / 0.8e1;
  t2077 = t263 * t2076;
  t2078 = t2077 * t189;
  t2079 = t908 * t387;
  t2080 = 0.3e1 * t2079;
  t2081 = t395 * t900;
  t2082 = 0.3e1 * t2081;
  t2083 = t196 * t2030;
  tv3rho30 = 0.3e1 * t658 + 0.3e1 * t662 + 0.3e1 * t909 + 0.6e1 * t910 + 0.3e1 * t912 + t7 * (t1658 + t1662 + t1665 + t1667 + t2078 + t2080 + t2082 + t2083);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t2086 = 0.2e1 * t966;
  t2087 = 0.2e1 * t969;
  t2088 = 0.2e1 * t1063;
  t2089 = 0.2e1 * t1064;
  t2090 = 0.2e1 * t1065;
  t2091 = 0.2e1 * t1066;
  t2092 = t1526 * t401;
  t2095 = t561 * t919;
  t2100 = 0.2e1 * t565;
  t2101 = 0.6e1 * t1533;
  t2102 = t2100 - t2101;
  t2103 = my_piecewise5(t11, 0, t15, 0, t2102);
  t2107 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t2092 * t562 + 0.8e1 / 0.9e1 * t2095 * t201 + 0.4e1 / 0.9e1 * t915 * t569 + 0.4e1 / 0.3e1 * t24 * t2103);
  t2115 = t6 * t923 * t132 * t51 / 0.4e1;
  t2116 = t6 * t923;
  t2121 = t6 * t404 * t314 * t51;
  t2124 = t932 * t590 / 0.4e1;
  t2135 = -0.3e1 / 0.8e1 * t6 * t2107 * t27 * t51 - t2115 - 0.3e1 / 0.4e1 * t2116 * t241 + t2121 / 0.12e2 - t2124 - 0.3e1 / 0.8e1 * t932 * t596 - 0.3e1 / 0.8e1 * t932 * t627 - t1594 / 0.8e1 + t1601 / 0.6e1 - t1603 / 0.4e1 - t1548 + t1551 / 0.6e1 - t1609 / 0.8e1 - t1554 / 0.8e1;
  t2136 = my_piecewise3(t2, 0, t2135);
  t2137 = t1626 * t412;
  t2140 = t633 * t942;
  t2146 = my_piecewise5(t15, 0, t11, 0, -t2102);
  t2150 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t2137 * t634 + 0.8e1 / 0.9e1 * t2140 * t247 + 0.4e1 / 0.9e1 * t939 * t638 + 0.4e1 / 0.3e1 * t60 * t2146);
  t2158 = t6 * t946 * t132 * t79 / 0.4e1;
  t2161 = t6 * t415 * t314 * t79;
  t2165 = t6 * t642;
  t2169 = t956 * t960 / 0.4e1;
  t2170 = t314 * t421;
  t2171 = t2170 * t441;
  t2172 = t420 * t2171;
  t2175 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t2150 * t27 * t79 - t2158 + t2161 / 0.12e2 - t1645 / 0.8e1 + t1649 / 0.6e1 - t1654 - 0.3e1 / 0.8e1 * t2165 * t442 - t2169 + t2172 / 0.12e2);
  t2177 = t1 * (t2136 + t2175);
  t2178 = t1659 * t660;
  t2179 = t2178 * t968;
  t2180 = t659 * t907;
  t2181 = t2180 * t968;
  t2182 = t1061 * t189;
  t2183 = t967 * t2182;
  t2185 = t482 * t387;
  t2186 = t967 * t2185;
  t2189 = t458 * t692;
  t2193 = t691 * t478;
  t2194 = t101 * t2193;
  t2199 = t1670 * t400;
  t2202 = t663 * t17;
  t2203 = t565 * t200;
  t2213 = my_piecewise3(t87, 0, 0.8e1 / 0.27e2 * t2199 * t664 - 0.8e1 / 0.9e1 * t2202 * t2203 - 0.2e1 / 0.9e1 * t970 * t568 + 0.4e1 / 0.3e1 * t264 * t565 - 0.4e1 * t973 * t146);
  t2214 = t1683 * t411;
  t2217 = t671 * t17;
  t2218 = t565 * t246;
  t2228 = my_piecewise3(t93, 0, 0.8e1 / 0.27e2 * t2214 * t672 + 0.8e1 / 0.9e1 * t2217 * t2218 - 0.2e1 / 0.9e1 * t978 * t637 - 0.4e1 / 0.3e1 * t268 * t565 + 0.4e1 * t981 * t146);
  t2230 = t2213 / 0.2e1 + t2228 / 0.2e1;
  t2231 = t2230 * t99;
  t2232 = t2231 * t4;
  t2239 = -0.7e1 / 0.144e3 * t2038 - 0.35e2 / 0.216e3 * t2189 + t2043 + t458 * t904 / 0.48e2 + 0.35e2 / 0.216e3 * t2194 + 0.7e1 / 0.72e2 * t2072 + 0.35e2 / 0.108e3 * t2045 - 0.7e1 / 0.72e2 * t2056 - t2232 * t193 / 0.48e2 + 0.7e1 / 0.144e3 * t2050 - 0.35e2 / 0.108e3 * t2054 + t275 * t1058 / 0.24e2;
  t2243 = 0.7e1 / 0.72e2 * t458 * t695;
  t2245 = 0.7e1 / 0.72e2 * t989 * t282;
  t2249 = 0.7e1 / 0.72e2 * t988 * t289;
  t2250 = t457 * t709;
  t2255 = 0.32e2 * t1800;
  t2256 = t1050 * t747;
  t2258 = t1050 * t892;
  t2260 = t1041 * t372;
  t2262 = 0.2e1 * t147 * t2260;
  t2263 = t1775 * t400;
  t2266 = t846 * t17;
  t2276 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t2263 * t664 + 0.16e2 / 0.9e1 * t2266 * t2203 + 0.4e1 / 0.9e1 * t1024 * t568 + 0.8e1 / 0.3e1 * t89 * t565 - 0.8e1 * t1027 * t146);
  t2277 = t1786 * t411;
  t2280 = t853 * t17;
  t2290 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t2277 * t672 - 0.16e2 / 0.9e1 * t2280 * t2218 + 0.4e1 / 0.9e1 * t1032 * t637 - 0.8e1 / 0.3e1 * t94 * t565 + 0.8e1 * t1035 * t146);
  t2292 = (t2276 + t2290) * t156;
  t2293 = t2292 * t184;
  t2296 = -0.18311447306006545054e-3 * t1709 + t1714 - t1719 - t1723 + t1727 + t1759 + t1767 - t1773 - t2255 - 0.5848223622634646207e0 * t2256 + 0.11696447245269292414e1 * t2258 + t2262 + t147 * t2293 - t1811 + 0.21687162600603479684e-1 * t1813 - t1817;
  t2297 = t329 * t1044;
  t2300 = 0.8e1 * t324 * t1042;
  t2302 = 0.8e1 * t329 * t1042;
  t2303 = t324 * t1044;
  t2305 = t755 * t471;
  t2307 = t879 * t471;
  t2309 = t876 * t471;
  t2311 = t470 * t843;
  t2312 = t147 * t2311;
  t2316 = -t1820 + t1823 + t1826 - 0.8e1 * t2297 + t2300 - t2302 + 0.8e1 * t2303 + 0.2e2 * t2305 - 0.32e2 * t2307 + 0.12e2 * t2309 + t2312 - t1839 - t1847 - 0.11696447245269292414e1 * t1848 - 0.34631718211362927518e2 * t1850 - 0.5848223622634646207e0 * t1853;
  t2318 = 0.48e2 * t1858;
  t2319 = t1041 * t3;
  t2321 = 0.36622894612013090108e-3 * t2319 * t379;
  t2322 = t1014 * t885;
  t2325 = 0.12e2 * t1879;
  t2327 = t470 * t116;
  t2328 = t2327 * t896;
  t2330 = t1050 * t718;
  t2332 = -t1856 + t2318 - t2321 + 0.24415263074675393405e-3 * t2322 + 0.4883052614935078681e-3 * t1862 - t1867 + t1871 - t1874 + t1878 - t2325 - 0.24e2 * t1881 + t1884 + t1889 - t1892 + 0.10843581300301739842e-1 * t2328 - 0.17315859105681463759e2 * t2330;
  t2333 = t1041 * t172;
  t2335 = 0.11696447245269292414e1 * t2333 * t384;
  t2342 = 0.8e2 * t1916;
  t2343 = 0.4e1 * t1921;
  t2346 = -t2335 + 0.19751673498613801407e-1 * t2292 * t182 + 0.23392894490538584828e1 * t1895 + t1903 - 0.16e2 * t1904 - 0.4e1 * t1906 - 0.4e1 * t1908 + t1912 - t1914 + t2342 - t1920 + t2343 + 0.4e2 * t1923 + t1926 + 0.2e1 * t1928 + t2027;
  t2348 = t2296 + t2316 + t2332 + t2346;
  t2350 = -t2231 * t111 / 0.48e2 + t2249 - 0.35e2 / 0.216e3 * t2250 + 0.7e1 / 0.144e3 * t1699 - 0.35e2 / 0.108e3 * t1701 + t1707 + params->gammac * t2348;
  t2351 = t286 * t2350;
  t2352 = t109 * t2351;
  t2355 = t281 * t1057;
  t2357 = 0.7e1 / 0.72e2 * t101 * t2355;
  t2361 = 0.7e1 / 0.72e2 * t275 * t1000;
  t2364 = t108 * t2061;
  t2365 = t477 * t700;
  t2366 = t2364 * t2365;
  t2369 = t477 * t902;
  t2370 = t1004 * t2369;
  t2373 = t280 * t699;
  t2374 = t2373 * t1005;
  t2376 = 0.7e1 / 0.36e2 * t1003 * t2374;
  t2377 = t1056 * t389;
  t2378 = t1004 * t2377;
  t2381 = t274 * t110;
  t2384 = t989 * t391 / 0.24e2 - t2243 + t2245 + t101 * t2352 / 0.48e2 - t2357 + t682 * t479 / 0.48e2 - t2361 - t458 * t702 / 0.24e2 + t1003 * t2366 / 0.8e1 - t1003 * t2370 / 0.24e2 + t2376 - t1003 * t2378 / 0.12e2 - t2381 * t1006 / 0.12e2;
  t2385 = t2239 + t2384;
  t2386 = t263 * t2385;
  t2387 = t2386 * t189;
  t2388 = t1062 * t387;
  t2390 = t483 * t900;
  t2391 = t661 * t475;
  t2392 = t908 * t475;
  t2393 = t395 * t1054;
  t2395 = t196 * t2348;
  t2396 = t2177 + t2179 + t2181 + 0.2e1 * t2183 + 0.2e1 * t2186 + t2387 + 0.2e1 * t2388 + t2390 + t2391 + t2392 + 0.2e1 * t2393 + t2395;
  tv3rho31 = t7 * t2396 + t2086 + t2087 + t2088 + t2089 + t2090 + t2091 + t658 + t662 + t909 + t911 + t912;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2398 = t1526 * t1072;
  t2403 = t561 * t1077;
  t2406 = -t2100 - t2101;
  t2407 = my_piecewise5(t11, 0, t15, 0, t2406);
  t2411 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t2398 * t201 + 0.8e1 / 0.9e1 * t915 * t919 + 0.4e1 / 0.9e1 * t2403 * t201 + 0.4e1 / 0.3e1 * t24 * t2407);
  t2418 = t6 * t1081 * t132 * t51;
  t2420 = t6 * t1081;
  t2427 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2411 * t27 * t51 - t2418 / 0.8e1 - 0.3e1 / 0.8e1 * t2420 * t241 - t2115 + t2121 / 0.6e1 - t2124 + t1601 / 0.12e2 - t1548 + t1551 / 0.12e2);
  t2428 = t1626 * t1089;
  t2433 = t633 * t1093;
  t2436 = -t2406;
  t2437 = my_piecewise5(t15, 0, t11, 0, t2436);
  t2441 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t2428 * t247 + 0.8e1 / 0.9e1 * t939 * t942 + 0.4e1 / 0.9e1 * t2433 * t247 + 0.4e1 / 0.3e1 * t60 * t2437);
  t2448 = t6 * t1097 * t132 * t79;
  t2451 = t6 * t946;
  t2454 = t1103 * t960;
  t2460 = t132 * t1107;
  t2461 = t2460 * t1109;
  t2462 = t420 * t2461;
  t2466 = t959 * t1136;
  t2467 = t420 * t2466;
  t2469 = -0.3e1 / 0.8e1 * t6 * t2441 * t27 * t79 - t2448 / 0.8e1 - t2158 + t2161 / 0.6e1 - 0.3e1 / 0.4e1 * t2451 * t442 - t2454 / 0.4e1 + t1649 / 0.12e2 - t1654 - t2169 + t2172 / 0.6e1 - 0.3e1 / 0.8e1 * t956 * t1110 - t2462 / 0.8e1 - 0.3e1 / 0.8e1 * t956 * t1137 - t2467 / 0.8e1;
  t2470 = my_piecewise3(t56, 0, t2469);
  t2472 = t1 * (t2427 + t2470);
  t2473 = t1659 * t394;
  t2474 = t1144 * t189;
  t2475 = t2473 * t2474;
  t2476 = t1329 * t2182;
  t2478 = t1145 * t387;
  t2479 = t1211 * t189;
  t2480 = t967 * t2479;
  t2485 = t1670 * t1147;
  t2490 = t663 * t1076;
  t2496 = my_piecewise3(t87, 0, 0.8e1 / 0.27e2 * t2485 * t200 - 0.8e1 / 0.9e1 * t970 * t566 - 0.2e1 / 0.9e1 * t2490 * t200 + 0.2e1 / 0.3e1 * t264 * t2406);
  t2497 = t1683 * t1154;
  t2502 = t671 * t1092;
  t2508 = my_piecewise3(t93, 0, 0.8e1 / 0.27e2 * t2497 * t246 + 0.8e1 / 0.9e1 * t978 * t566 - 0.2e1 / 0.9e1 * t2502 * t246 + 0.2e1 / 0.3e1 * t268 * t2436);
  t2510 = t2496 / 0.2e1 + t2508 / 0.2e1;
  t2511 = t2510 * t99;
  t2514 = t1163 * t289;
  t2518 = t1192 * t3;
  t2519 = t2518 * t379;
  t2521 = t324 * t1193;
  t2523 = t329 * t1193;
  t2525 = t1192 * t372;
  t2526 = t147 * t2525;
  t2527 = t1192 * t172;
  t2528 = t2527 * t384;
  t2533 = t1714 - t1719 - t1723 + t1727 - 0.18311447306006545054e-3 * t2519 + 0.4e1 * t2521 - 0.4e1 * t2523 + t2526 - 0.5848223622634646207e0 * t2528 + t1759 + t1767 - t1773 + t2255 + 0.32e2 * t1802 - 0.11696447245269292414e1 * t2256 + 0.23392894490538584828e1 * t2258;
  t2540 = t2262 - t1811 + 0.10843581300301739842e-1 * t1813 - t1817 - t1820 + t1823 + t1826 - 0.16e2 * t2297 - t2300 - t2302 + 0.4e2 * t2305 - 0.24e2 * t2309 + 0.2e1 * t2312 - t1839 - t1847 - 0.5848223622634646207e0 * t1848;
  t2548 = -0.17315859105681463759e2 * t1850 + t1856 + t2318 - t2321 + 0.48830526149350786811e-3 * t2322 + 0.24415263074675393405e-3 * t1862 - t1867 + t1871 - t1874 + t1878 - t2325 + 0.12e2 * t1881 + t1889 - t1892 - 0.8e1 * t1893 + 0.21687162600603479684e-1 * t2328;
  t2549 = t1775 * t1147;
  t2554 = t846 * t1076;
  t2560 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t2549 * t200 + 0.16e2 / 0.9e1 * t1024 * t566 + 0.4e1 / 0.9e1 * t2554 * t200 + 0.4e1 / 0.3e1 * t89 * t2406);
  t2561 = t1786 * t1154;
  t2566 = t853 * t1092;
  t2572 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t2561 * t246 - 0.16e2 / 0.9e1 * t1032 * t566 + 0.4e1 / 0.9e1 * t2566 * t246 + 0.4e1 / 0.3e1 * t94 * t2436);
  t2574 = (t2560 + t2572) * t156;
  t2581 = t2574 * t184;
  t2583 = 0.19751673498613801407e-1 * t2574 * t182 - 0.34631718211362927517e2 * t2330 - t2335 + 0.11696447245269292414e1 * t1895 + t1903 - 0.8e1 * t1904 + t1912 - t1914 - t2342 - t1920 - t2343 + 0.2e2 * t1923 + t1926 + t1928 + t2027 + t147 * t2581;
  t2585 = t2533 + t2540 + t2548 + t2583;
  t2587 = -t2511 * t111 / 0.48e2 + 0.7e1 / 0.144e3 * t2514 + t2249 - 0.35e2 / 0.108e3 * t2250 - 0.35e2 / 0.216e3 * t1701 + t1707 + params->gammac * t2585;
  t2588 = t286 * t2587;
  t2589 = t109 * t2588;
  t2598 = t275 * t1208 / 0.48e2 - 0.35e2 / 0.108e3 * t2189 + t2043 + 0.35e2 / 0.108e3 * t2194 + t101 * t2589 / 0.48e2 + 0.35e2 / 0.216e3 * t2045 - 0.35e2 / 0.216e3 * t2054 - t2243 + t2245 - t2357 - t275 * t1173 / 0.24e2 + t1164 * t391 / 0.48e2;
  t2599 = t477 * t1056;
  t2600 = t1004 * t2599;
  t2603 = t457 * t110;
  t2606 = t1206 * t389;
  t2607 = t1004 * t2606;
  t2610 = t1171 * t389;
  t2611 = t2364 * t2610;
  t2614 = t458 * t1000;
  t2616 = t281 * t1207;
  t2617 = t101 * t2616;
  t2619 = t281 * t1172;
  t2620 = t101 * t2619;
  t2626 = t2511 * t4;
  t2629 = t1164 * t282;
  t2631 = -t2361 - t1003 * t2600 / 0.12e2 - t2603 * t1006 / 0.12e2 - t1003 * t2607 / 0.24e2 + t1003 * t2611 / 0.8e1 - 0.7e1 / 0.72e2 * t2614 - 0.7e1 / 0.144e3 * t2617 + 0.7e1 / 0.72e2 * t2620 + t989 * t479 / 0.24e2 + t458 * t1058 / 0.24e2 + t2376 - t2626 * t193 / 0.48e2 + 0.7e1 / 0.144e3 * t2629;
  t2632 = t2598 + t2631;
  t2633 = t263 * t2632;
  t2634 = t2633 * t189;
  t2635 = t1212 * t387;
  t2636 = t482 * t475;
  t2637 = t967 * t2636;
  t2639 = t1062 * t475;
  t2641 = t483 * t1054;
  t2643 = t395 * t1204;
  t2644 = t196 * t2585;
  t2645 = t2472 + t2475 + 0.2e1 * t2476 + t2478 + t2480 + t2634 + t2635 + 0.2e1 * t2637 + 0.2e1 * t2639 + 0.2e1 * t2641 + t2643 + t2644;
  tv3rho32 = t7 * t2645 + t1143 + t1146 + t1213 + t1215 + t1216 + t2086 + t2087 + t2088 + t2089 + t2090 + t2091;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2652 = t1072 * t401;
  t2658 = -0.6e1 * t565 - 0.6e1 * t1533;
  t2659 = my_piecewise5(t11, 0, t15, 0, t2658);
  t2663 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1526 * t2652 + 0.4e1 / 0.3e1 * t915 * t1077 + 0.4e1 / 0.3e1 * t24 * t2659);
  t2671 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2663 * t27 * t51 - 0.3e1 / 0.8e1 * t2418 + t2121 / 0.4e1 - t1548);
  t2677 = t1089 * t412;
  t2682 = -t2658;
  t2683 = my_piecewise5(t15, 0, t11, 0, t2682);
  t2687 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t1626 * t2677 + 0.4e1 / 0.3e1 * t939 * t1093 + 0.4e1 / 0.3e1 * t60 * t2683);
  t2694 = 0.1e1 / t66 / t531;
  t2700 = 0.1e1 / t65 / t1127;
  t2705 = t1127 * t423;
  t2706 = 0.1e1 / t2705;
  t2711 = t430 * t430;
  t2712 = t1575 * t2711;
  t2713 = t1127 * t531;
  t2715 = 0.1e1 / t66 / t2713;
  t2716 = t436 * t436;
  t2717 = 0.1e1 / t2716;
  t2722 = -0.154e3 / 0.81e2 * t35 * sigma[2] * t2694 * t75 + 0.341e3 / 0.972e3 * t228 * t430 * t2700 * t437 - 0.19e2 / 0.162e3 * t615 * t1126 * t2706 * t1132 + t2712 * t2715 * t2717 * t1584 / 0.486e3;
  t2723 = t422 * t2722;
  t2726 = t6 * t1097;
  t2733 = t441 * t1136;
  t2734 = t1108 * t2733;
  t2737 = xbspline(t78, 3, params);
  t2738 = t27 * t2737;
  t2739 = t1109 * t441;
  t2740 = t2738 * t2739;
  t2743 = -0.3e1 / 0.8e1 * t2448 - 0.3e1 / 0.4e1 * t2454 - 0.3e1 / 0.8e1 * t2462 - 0.3e1 / 0.8e1 * t2467 + t2161 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t2687 * t27 * t79 + t2172 / 0.4e1 - 0.3e1 / 0.8e1 * t420 * t2723 - 0.9e1 / 0.8e1 * t2726 * t442 - 0.9e1 / 0.8e1 * t1103 * t1137 - 0.9e1 / 0.8e1 * t1103 * t1110 - 0.9e1 / 0.8e1 * t420 * t2734 - 0.3e1 / 0.8e1 * t420 * t2740 - t1654;
  t2744 = my_piecewise3(t56, 0, t2743);
  t2746 = t1 * (t2671 + t2744);
  t2747 = t1144 * t482;
  t2748 = t1659 * t2747;
  t2749 = t2748 * t189;
  t2750 = t1329 * t2479;
  t2751 = 0.3e1 * t2750;
  t2752 = t1145 * t475;
  t2753 = 0.3e1 * t2752;
  t2759 = t1147 * t400;
  t2767 = my_piecewise3(t87, 0, 0.8e1 / 0.27e2 * t1670 * t2759 - 0.2e1 / 0.3e1 * t970 * t1076 + 0.2e1 / 0.3e1 * t264 * t2658);
  t2768 = t1154 * t411;
  t2776 = my_piecewise3(t93, 0, 0.8e1 / 0.27e2 * t1683 * t2768 - 0.2e1 / 0.3e1 * t978 * t1092 + 0.2e1 / 0.3e1 * t268 * t2682);
  t2778 = t2767 / 0.2e1 + t2776 / 0.2e1;
  t2779 = t2778 * t99;
  t2789 = t1714 - t1719 - t1723 + t1727 - 0.54934341918019635162e-3 * t2519 - 0.12e2 * t2521 - 0.12e2 * t2523 + 0.3e1 * t2526 - 0.17544670867903938621e1 * t2528 + t1759 + t1767 - t1773;
  t2797 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t1775 * t2759 + 0.4e1 / 0.3e1 * t1024 * t1076 + 0.4e1 / 0.3e1 * t89 * t2658);
  t2805 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1786 * t2768 + 0.4e1 / 0.3e1 * t1032 * t1092 + 0.4e1 / 0.3e1 * t94 * t2682);
  t2807 = (t2797 + t2805) * t156;
  t2812 = t2807 * t184;
  t2817 = 0.19751673498613801407e-1 * t2807 * t182 + t1801 - 0.17544670867903938621e1 * t2256 + 0.35089341735807877242e1 * t2258 - t1811 - t1817 - t1820 + t1823 + t1826 + t147 * t2812 - 0.24e2 * t2297 - 0.24e2 * t2303 + 0.6e2 * t2305;
  t2823 = 0.96e2 * t2307 + 0.36e2 * t2309 + 0.3e1 * t2312 - t1839 - t1847 - t1856 - t1859 + 0.73245789224026180216e-3 * t2322 - t1867 + t1871 - t1874 + t1878;
  t2826 = t1880 + t1889 - t1892 + 0.32530743900905219526e-1 * t2328 - 0.51947577317044391276e2 * t2330 + t1903 + t1912 - t1914 - t1917 - t1920 - t1922 + t1926 + t2027;
  t2828 = t2789 + t2817 + t2823 + t2826;
  t2830 = -t2779 * t111 / 0.48e2 + 0.7e1 / 0.48e2 * t2514 - 0.35e2 / 0.72e2 * t2250 + t1707 + params->gammac * t2828;
  t2831 = t286 * t2830;
  t2832 = t109 * t2831;
  t2840 = t2779 * t4;
  t2845 = t1171 * t477;
  t2846 = t2061 * t2845;
  t2847 = t109 * t2846;
  t2850 = t477 * t1206;
  t2851 = t1004 * t2850;
  t2854 = 0.7e1 / 0.48e2 * t2629 - 0.7e1 / 0.48e2 * t2617 + 0.7e1 / 0.24e2 * t2620 - 0.7e1 / 0.24e2 * t2614 - 0.35e2 / 0.72e2 * t2189 + t101 * t2832 / 0.48e2 + 0.35e2 / 0.72e2 * t2194 + t458 * t1208 / 0.16e2 + t1164 * t479 / 0.16e2 + t2043 - t2840 * t193 / 0.48e2 - t458 * t1173 / 0.8e1 + t101 * t2847 / 0.8e1 - t1003 * t2851 / 0.8e1;
  t2855 = t263 * t2854;
  t2856 = t2855 * t189;
  t2857 = t1212 * t475;
  t2858 = 0.3e1 * t2857;
  t2859 = t483 * t1204;
  t2860 = 0.3e1 * t2859;
  t2861 = t196 * t2828;
  tv3rho33 = 0.3e1 * t1143 + 0.3e1 * t1146 + 0.3e1 * t1213 + 0.6e1 * t1214 + 0.3e1 * t1216 + t7 * (t2746 + t2749 + t2751 + t2753 + t2856 + t2858 + t2860 + t2861);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2870 = t582 * t1221;
  t2876 = t1549 * t499;
  t2878 = t213 * t2876 / 0.12e2;
  t2879 = t1607 * t1224;
  t2880 = t213 * t2879;
  t2882 = t589 * t1242;
  t2883 = t213 * t2882;
  t2885 = t595 * t499;
  t2886 = t1616 * t2885;
  t2889 = t626 * t499;
  t2890 = t594 * t2889;
  t2893 = t240 * t1242;
  t2894 = t594 * t2893;
  t2905 = t619 * t622;
  t2910 = t617 * t230;
  t2912 = 0.1e1 / t38 / t2910;
  t2917 = 0.11e2 / 0.27e2 * t30 * t34 * t600 * t47 - 0.65e2 / 0.648e3 * t228 * t607 * t236 * sigma[0] + 0.17e2 / 0.432e3 * t615 * t2905 * t229 - t1575 * t616 * t2912 * t1582 * t1584 / 0.1296e4;
  t2918 = t215 * t2917;
  t2921 = -0.3e1 / 0.8e1 * t1596 * t500 - t2870 / 0.4e1 - 0.3e1 / 0.4e1 * t582 * t1225 - 0.3e1 / 0.4e1 * t582 * t1243 + t2878 - t2880 / 0.4e1 - t2883 / 0.4e1 - 0.3e1 / 0.8e1 * t213 * t2886 - 0.3e1 / 0.8e1 * t213 * t2890 - 0.3e1 / 0.4e1 * t213 * t2894 - 0.3e1 / 0.8e1 * t213 * t2918;
  t2922 = my_piecewise3(t2, 0, t2921);
  t2923 = t1 * t2922;
  t2924 = t2178 * t1249;
  t2925 = t2180 * t1249;
  t2926 = t1283 * t189;
  t2927 = t967 * t2926;
  t2928 = 0.2e1 * t2927;
  t2929 = t523 * t387;
  t2930 = t967 * t2929;
  t2931 = 0.2e1 * t2930;
  t2934 = t275 * t1254;
  t2936 = t274 * t1257;
  t2939 = t104 * t690;
  t2940 = t2939 * t507;
  t2942 = 0.35e2 / 0.216e3 * t101 * t2940;
  t2943 = t280 * t286;
  t2944 = t2943 * t1260;
  t2945 = t1258 * t2944;
  t2947 = t506 * t700;
  t2948 = t1004 * t2947;
  t2951 = t506 * t902;
  t2952 = t1259 * t2951;
  t2955 = t273 * t273;
  t2956 = t2955 * t3;
  t2957 = t2956 * t513;
  t2960 = t1273 * t286;
  t2962 = t1266 * t2960 * t1268;
  t2964 = t1268 * t389;
  t2968 = t506 * t680;
  t2969 = t1267 * t2968;
  t2973 = 0.1e1 / t131 / t753;
  t2974 = t515 * t2973;
  t2977 = 0.119e3 / 0.3456e4 * t514 * t2974 * t519;
  t2978 = t1273 * t699;
  t2980 = t1278 * t2978 * t1260;
  t2982 = t517 * t2061;
  t2989 = -t682 * t508 / 0.48e2 + 0.7e1 / 0.72e2 * t2934 + t2936 * t1261 / 0.24e2 - t2942 - 0.7e1 / 0.72e2 * t2945 - t1258 * t2948 / 0.24e2 + t1258 * t2952 / 0.48e2 - t2957 * t520 / 0.384e3 + 0.7e1 / 0.288e3 * t2962 + t1266 * t1279 * t2964 / 0.96e2 - t1266 * t2969 / 0.384e3 - t2977 - 0.7e1 / 0.288e3 * t2980 - t1278 * t2982 * t2947 / 0.128e3 + t1278 * t1279 * t2951 / 0.384e3;
  t2990 = t263 * t2989;
  t2991 = t2990 * t189;
  t2992 = t1284 * t387;
  t2993 = 0.2e1 * t2992;
  t2994 = t524 * t900;
  tv3rho2sigma0 = 0.2e1 * t1248 + 0.2e1 * t1250 + 0.2e1 * t1285 + 0.2e1 * t1286 + t7 * (t2923 + t2924 + t2925 + t2928 + t2931 + t2991 + t2993 + t2994);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t3003 = t956 * t1291;
  t3005 = t2170 * t538;
  t3007 = t420 * t3005 / 0.12e2;
  t3009 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t2165 * t539 - t3003 / 0.4e1 + t3007);
  t3010 = t1 * t3009;
  t3011 = t2178 * t1297;
  t3012 = t2180 * t1297;
  t3013 = t1318 * t189;
  t3014 = t967 * t3013;
  t3015 = 0.2e1 * t3014;
  t3016 = t553 * t387;
  t3017 = t967 * t3016;
  t3018 = 0.2e1 * t3017;
  t3021 = t275 * t1301;
  t3025 = t2939 * t545;
  t3027 = 0.35e2 / 0.216e3 * t101 * t3025;
  t3028 = t2943 * t1304;
  t3029 = t1258 * t3028;
  t3031 = t544 * t700;
  t3032 = t1004 * t3031;
  t3035 = t544 * t902;
  t3036 = t1259 * t3035;
  t3042 = t1266 * t2960 * t1308;
  t3044 = t1308 * t389;
  t3048 = t544 * t680;
  t3049 = t1267 * t3048;
  t3054 = 0.119e3 / 0.3456e4 * t514 * t2974 * t549;
  t3056 = t1278 * t2978 * t1304;
  t3064 = -t682 * t546 / 0.48e2 + 0.7e1 / 0.72e2 * t3021 + t2936 * t1305 / 0.24e2 - t3027 - 0.7e1 / 0.72e2 * t3029 - t1258 * t3032 / 0.24e2 + t1258 * t3036 / 0.48e2 - t2957 * t550 / 0.384e3 + 0.7e1 / 0.288e3 * t3042 + t1266 * t1279 * t3044 / 0.96e2 - t1266 * t3049 / 0.384e3 - t3054 - 0.7e1 / 0.288e3 * t3056 - t1278 * t2982 * t3031 / 0.128e3 + t1278 * t1279 * t3035 / 0.384e3;
  t3065 = t263 * t3064;
  t3066 = t3065 * t189;
  t3067 = t1319 * t387;
  t3068 = 0.2e1 * t3067;
  t3069 = t554 * t900;
  tv3rho2sigma2 = 0.2e1 * t1296 + 0.2e1 * t1298 + 0.2e1 * t1320 + 0.2e1 * t1321 + t7 * (t3010 + t3011 + t3012 + t3015 + t3018 + t3066 + t3068 + t3069);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t3074 = t932 * t1221;
  t3084 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t2116 * t500 - t3074 / 0.8e1 - 0.3e1 / 0.8e1 * t932 * t1225 - 0.3e1 / 0.8e1 * t932 * t1243 - t2870 / 0.8e1 + t2878 - t2880 / 0.8e1 - t2883 / 0.8e1);
  t3085 = t1 * t3084;
  t3086 = t482 * t523;
  t3087 = t3086 * t189;
  t3088 = t2473 * t3087;
  t3089 = t659 * t1061;
  t3090 = t3089 * t1249;
  t3091 = t1329 * t2926;
  t3092 = t1329 * t2929;
  t3093 = t1344 * t189;
  t3094 = t967 * t3093;
  t3097 = t458 * t1254;
  t3099 = t457 * t1257;
  t3106 = t2943 * t1333;
  t3107 = t1258 * t3106;
  t3109 = t1333 * t389;
  t3110 = t1004 * t3109;
  t3113 = t506 * t1056;
  t3114 = t1259 * t3113;
  t3118 = t273 * t3;
  t3119 = t3118 * t1265;
  t3122 = t2960 * t1337;
  t3123 = t1266 * t3122;
  t3125 = t1337 * t389;
  t3126 = t1279 * t3125;
  t3129 = t506 * t987;
  t3130 = t1267 * t3129;
  t3135 = t1333 * t273;
  t3140 = t1278 * t2978 * t1333;
  t3148 = -t3119 * t1338 / 0.384e3 + 0.7e1 / 0.576e3 * t3123 + t1266 * t3126 / 0.192e3 - t1266 * t3130 / 0.384e3 + 0.7e1 / 0.576e3 * t2962 - t2977 - 0.7e1 / 0.576e3 * t2980 + t1266 * t1279 * t3135 / 0.192e3 - 0.7e1 / 0.576e3 * t3140 - t1278 * t2982 * t3109 / 0.128e3 + t1278 * t1279 * t3113 / 0.384e3;
  t3149 = -t989 * t508 / 0.48e2 + 0.7e1 / 0.144e3 * t3097 + t3099 * t1261 / 0.48e2 + 0.7e1 / 0.144e3 * t2934 - t2942 - 0.7e1 / 0.144e3 * t2945 + t2936 * t1334 / 0.48e2 - 0.7e1 / 0.144e3 * t3107 - t1258 * t3110 / 0.24e2 + t1258 * t3114 / 0.48e2 + t3148;
  t3150 = t263 * t3149;
  t3151 = t3150 * t189;
  t3152 = t1345 * t387;
  t3153 = t523 * t475;
  t3154 = t967 * t3153;
  t3155 = t1284 * t475;
  t3156 = t524 * t1054;
  t3157 = t3085 + t3088 + t3090 + t3091 + t3092 + t3094 + t3151 + t3152 + t3154 + t3155 + t3156;
  tv3rho2sigma3 = t7 * t3157 + t1248 + t1250 + t1285 + t1286 + t1328 + t1330 + t1346 + t1347;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t3161 = t1103 * t1291;
  t3166 = t2460 * t1352;
  t3167 = t420 * t3166;
  t3171 = t959 * t1370;
  t3172 = t420 * t3171;
  t3175 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t2451 * t539 - t3161 / 0.8e1 - t3003 / 0.8e1 + t3007 - 0.3e1 / 0.8e1 * t956 * t1353 - t3167 / 0.8e1 - 0.3e1 / 0.8e1 * t956 * t1371 - t3172 / 0.8e1);
  t3176 = t1 * t3175;
  t3177 = t482 * t553;
  t3178 = t3177 * t189;
  t3179 = t2473 * t3178;
  t3180 = t3089 * t1297;
  t3181 = t1329 * t3013;
  t3182 = t1329 * t3016;
  t3183 = t1391 * t189;
  t3184 = t967 * t3183;
  t3187 = t458 * t1301;
  t3195 = t2943 * t1380;
  t3196 = t1258 * t3195;
  t3198 = t1380 * t389;
  t3199 = t1004 * t3198;
  t3202 = t544 * t1056;
  t3203 = t1259 * t3202;
  t3209 = t2960 * t1384;
  t3210 = t1266 * t3209;
  t3212 = t1384 * t389;
  t3213 = t1279 * t3212;
  t3216 = t544 * t987;
  t3217 = t1267 * t3216;
  t3222 = t1380 * t273;
  t3227 = t1278 * t2978 * t1380;
  t3235 = -t3119 * t1385 / 0.384e3 + 0.7e1 / 0.576e3 * t3210 + t1266 * t3213 / 0.192e3 - t1266 * t3217 / 0.384e3 + 0.7e1 / 0.576e3 * t3042 - t3054 - 0.7e1 / 0.576e3 * t3056 + t1266 * t1279 * t3222 / 0.192e3 - 0.7e1 / 0.576e3 * t3227 - t1278 * t2982 * t3198 / 0.128e3 + t1278 * t1279 * t3202 / 0.384e3;
  t3236 = -t989 * t546 / 0.48e2 + 0.7e1 / 0.144e3 * t3187 + t3099 * t1305 / 0.48e2 + 0.7e1 / 0.144e3 * t3021 - t3027 - 0.7e1 / 0.144e3 * t3029 + t2936 * t1381 / 0.48e2 - 0.7e1 / 0.144e3 * t3196 - t1258 * t3199 / 0.24e2 + t1258 * t3203 / 0.48e2 + t3235;
  t3237 = t263 * t3236;
  t3238 = t3237 * t189;
  t3239 = t1392 * t387;
  t3240 = t553 * t475;
  t3241 = t967 * t3240;
  t3242 = t1319 * t475;
  t3243 = t554 * t1054;
  t3244 = t3176 + t3179 + t3180 + t3181 + t3182 + t3184 + t3238 + t3239 + t3241 + t3242 + t3243;
  tv3rho2sigma5 = t7 * t3244 + t1296 + t1298 + t1320 + t1321 + t1376 + t1377 + t1393 + t1394;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t3254 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t2420 * t500 - t3074 / 0.4e1 + t2878);
  t3255 = t1 * t3254;
  t3256 = t1659 * t1144;
  t3257 = t3256 * t1249;
  t3258 = t659 * t1211;
  t3259 = t3258 * t1249;
  t3260 = t1329 * t3093;
  t3261 = 0.2e1 * t3260;
  t3262 = t1329 * t3153;
  t3263 = 0.2e1 * t3262;
  t3270 = t506 * t1171;
  t3271 = t1004 * t3270;
  t3274 = t506 * t1206;
  t3275 = t1259 * t3274;
  t3278 = t456 * t456;
  t3279 = t3278 * t3;
  t3280 = t3279 * t513;
  t3284 = t1337 * t477;
  t3285 = t1279 * t3284;
  t3288 = t506 * t1162;
  t3289 = t1267 * t3288;
  t3299 = -t1164 * t508 / 0.48e2 + 0.7e1 / 0.72e2 * t3097 + t3099 * t1334 / 0.24e2 - t2942 - 0.7e1 / 0.72e2 * t3107 - t1258 * t3271 / 0.24e2 + t1258 * t3275 / 0.48e2 - t3280 * t520 / 0.384e3 + 0.7e1 / 0.288e3 * t3123 + t1266 * t3285 / 0.96e2 - t1266 * t3289 / 0.384e3 - t2977 - 0.7e1 / 0.288e3 * t3140 - t1278 * t2982 * t3270 / 0.128e3 + t1278 * t1279 * t3274 / 0.384e3;
  t3300 = t263 * t3299;
  t3301 = t3300 * t189;
  t3302 = t1345 * t475;
  t3303 = 0.2e1 * t3302;
  t3304 = t524 * t1204;
  tv3rho2sigma6 = 0.2e1 * t1328 + 0.2e1 * t1330 + 0.2e1 * t1346 + 0.2e1 * t1347 + t7 * (t3255 + t3257 + t3259 + t3261 + t3263 + t3301 + t3303 + t3304);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t3320 = t1109 * t538;
  t3321 = t2738 * t3320;
  t3324 = t1136 * t538;
  t3325 = t1108 * t3324;
  t3328 = t441 * t1370;
  t3329 = t1108 * t3328;
  t3340 = t1129 * t1132;
  t3345 = t1127 * t431;
  t3347 = 0.1e1 / t66 / t3345;
  t3352 = 0.11e2 / 0.27e2 * t30 * t34 * t1114 * t75 - 0.65e2 / 0.648e3 * t228 * t1121 * t437 * sigma[2] + 0.17e2 / 0.432e3 * t615 * t3340 * t430 - t1575 * t1126 * t3347 * t2717 * t1584 / 0.1296e4;
  t3353 = t422 * t3352;
  t3356 = -0.3e1 / 0.8e1 * t2726 * t539 - t3161 / 0.4e1 - 0.3e1 / 0.4e1 * t1103 * t1353 - 0.3e1 / 0.4e1 * t1103 * t1371 + t3007 - t3167 / 0.4e1 - t3172 / 0.4e1 - 0.3e1 / 0.8e1 * t420 * t3321 - 0.3e1 / 0.8e1 * t420 * t3325 - 0.3e1 / 0.4e1 * t420 * t3329 - 0.3e1 / 0.8e1 * t420 * t3353;
  t3357 = my_piecewise3(t56, 0, t3356);
  t3358 = t1 * t3357;
  t3359 = t3256 * t1297;
  t3360 = t3258 * t1297;
  t3361 = t1329 * t3183;
  t3362 = 0.2e1 * t3361;
  t3363 = t1329 * t3240;
  t3364 = 0.2e1 * t3363;
  t3371 = t544 * t1171;
  t3372 = t1004 * t3371;
  t3375 = t544 * t1206;
  t3376 = t1259 * t3375;
  t3382 = t1384 * t477;
  t3383 = t1279 * t3382;
  t3386 = t544 * t1162;
  t3387 = t1267 * t3386;
  t3397 = -t1164 * t546 / 0.48e2 + 0.7e1 / 0.72e2 * t3187 + t3099 * t1381 / 0.24e2 - t3027 - 0.7e1 / 0.72e2 * t3196 - t1258 * t3372 / 0.24e2 + t1258 * t3376 / 0.48e2 - t3280 * t550 / 0.384e3 + 0.7e1 / 0.288e3 * t3210 + t1266 * t3383 / 0.96e2 - t1266 * t3387 / 0.384e3 - t3054 - 0.7e1 / 0.288e3 * t3227 - t1278 * t2982 * t3371 / 0.128e3 + t1278 * t1279 * t3375 / 0.384e3;
  t3398 = t263 * t3397;
  t3399 = t3398 * t189;
  t3400 = t1392 * t475;
  t3401 = 0.2e1 * t3400;
  t3402 = t554 * t1204;
  tv3rho2sigma8 = 0.2e1 * t1376 + 0.2e1 * t1377 + 0.2e1 * t1393 + 0.2e1 * t1394 + t7 * (t3358 + t3359 + t3360 + t3362 + t3364 + t3399 + t3401 + t3402);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t3407 = t1607 * t1397;
  t3409 = t213 * t3407 / 0.8e1;
  t3410 = t240 * t1397;
  t3411 = t1616 * t3410;
  t3414 = t499 * t1242;
  t3415 = t594 * t3414;
  t3420 = t589 * t1409;
  t3422 = t213 * t3420 / 0.8e1;
  t3423 = t240 * t1409;
  t3424 = t594 * t3423;
  t3431 = t1237 * t622;
  t3437 = 0.1e1 / t38 / t1568;
  t3442 = t225 * t227 * t233 * t236 / 0.54e2 - 0.5e1 / 0.432e3 * t615 * t3431 * sigma[0] + t1575 * t229 * t3437 * t1582 * t1584 / 0.3456e4;
  t3443 = t215 * t3442;
  t3447 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t582 * t1398 - t3409 - 0.3e1 / 0.8e1 * t213 * t3411 - 0.3e1 / 0.4e1 * t213 * t3415 - 0.3e1 / 0.8e1 * t582 * t1410 - t3422 - 0.3e1 / 0.8e1 * t213 * t3424 - 0.3e1 / 0.8e1 * t213 * t3443);
  t3448 = t1 * t3447;
  t3449 = t1416 * t189;
  t3450 = t2473 * t3449;
  t3451 = t1453 * t2926;
  t3452 = 0.2e1 * t3451;
  t3453 = t1417 * t387;
  t3454 = t1449 * t189;
  t3455 = t967 * t3454;
  t3458 = t1419 * t280;
  t3459 = t3458 * t192;
  t3461 = 0.7e1 / 0.288e3 * t101 * t3459;
  t3462 = t1420 * t390;
  t3465 = t1264 * t1459;
  t3466 = t1419 * t273;
  t3470 = t105 * t1273;
  t3473 = 0.35e2 / 0.2304e4 * t514 * t3470 * t1425;
  t3474 = t1419 * t389;
  t3480 = t1253 * t1431;
  t3482 = 0.7e1 / 0.288e3 * t101 * t3480;
  t3483 = t1430 * t389;
  t3484 = t1259 * t3483;
  t3487 = t511 * M_PI;
  t3488 = t3487 * t1437;
  t3492 = t145 * t145;
  t3493 = 0.1e1 / t3492;
  t3494 = t3493 * t699;
  t3497 = 0.7e1 / 0.6144e4 * t1438 * t3494 * t1419;
  t3498 = t1440 * t2061;
  t3502 = t1430 * t273;
  t3508 = 0.7e1 / 0.2304e4 * t514 * t1274 * t1445;
  t3512 = -t275 * t1421 / 0.96e2 + t3461 + t101 * t3462 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t1267 * t3466 + t3473 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3474 + t275 * t1432 / 0.96e2 - t3482 - t1258 * t3484 / 0.96e2 - t3488 * t1441 * t3466 / 0.2048e4 + t3497 + t1438 * t3498 * t3474 / 0.2048e4 + t1266 * t1267 * t3502 / 0.768e3 - t3508 - t1278 * t1279 * t3483 / 0.768e3;
  t3513 = t263 * t3512;
  t3514 = t3513 * t189;
  t3515 = t1450 * t387;
  tv3rhosigma20 = t1415 + t1418 + t1451 + t7 * (t3448 + t3450 + t3452 + t3453 + t3455 + t3514 + t3515);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  t3518 = t523 * t553;
  t3519 = t3518 * t189;
  t3520 = t2473 * t3519;
  t3521 = t659 * t1283;
  t3522 = t3521 * t1297;
  t3523 = t1453 * t3013;
  t3524 = t1453 * t3016;
  t3525 = t1468 * t189;
  t3526 = t967 * t3525;
  t3529 = t506 * t280;
  t3530 = t3529 * t545;
  t3532 = 0.7e1 / 0.288e3 * t101 * t3530;
  t3533 = t4 * t506;
  t3534 = t100 * t3533;
  t3537 = t1461 * t273;
  t3543 = 0.35e2 / 0.2304e4 * t1460 * t2960 * t1461;
  t3544 = t1461 * t389;
  t3548 = t1437 * t1440;
  t3549 = t3487 * t3548;
  t3550 = t699 * t544;
  t3551 = t3550 * t1268;
  t3556 = 0.7e1 / 0.6144e4 * t1438 * t3494 * t1461;
  t3557 = t1436 * t3548;
  t3558 = t2061 * t544;
  t3559 = t3558 * t1260;
  t3562 = -t275 * t1456 / 0.96e2 + t3532 + t3534 * t1305 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t1267 * t3537 + t3543 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3544 - t3549 * t3551 / 0.2048e4 + t3556 + t3557 * t3559 / 0.2048e4;
  t3563 = t263 * t3562;
  t3564 = t3563 * t189;
  t3565 = t1469 * t387;
  tv3rhosigma22 = t1454 + t1470 + t7 * (t3520 + t3522 + t3523 + t3524 + t3526 + t3564 + t3565);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t3570 = t2460 * t1472;
  t3572 = t420 * t3570 / 0.8e1;
  t3575 = t959 * t1484;
  t3577 = t420 * t3575 / 0.8e1;
  t3579 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t956 * t1473 - t3572 - 0.3e1 / 0.8e1 * t956 * t1485 - t3577);
  t3580 = t1 * t3579;
  t3581 = t1491 * t189;
  t3582 = t2473 * t3581;
  t3583 = t659 * t553;
  t3584 = t3583 * t3013;
  t3585 = 0.2e1 * t3584;
  t3586 = t1492 * t387;
  t3587 = t1516 * t189;
  t3588 = t967 * t3587;
  t3591 = t1494 * t280;
  t3592 = t3591 * t192;
  t3594 = 0.7e1 / 0.288e3 * t101 * t3592;
  t3595 = t1495 * t390;
  t3598 = t1494 * t273;
  t3604 = 0.35e2 / 0.2304e4 * t514 * t3470 * t1499;
  t3605 = t1494 * t389;
  t3611 = t1253 * t1505;
  t3613 = 0.7e1 / 0.288e3 * t101 * t3611;
  t3614 = t1504 * t389;
  t3615 = t1259 * t3614;
  t3623 = 0.7e1 / 0.6144e4 * t1438 * t3494 * t1494;
  t3627 = t1504 * t273;
  t3633 = 0.7e1 / 0.2304e4 * t514 * t1274 * t1512;
  t3637 = -t275 * t1496 / 0.96e2 + t3594 + t101 * t3595 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t1267 * t3598 + t3604 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3605 + t275 * t1506 / 0.96e2 - t3613 - t1258 * t3615 / 0.96e2 - t3488 * t1441 * t3598 / 0.2048e4 + t3623 + t1438 * t3498 * t3605 / 0.2048e4 + t1266 * t1267 * t3627 / 0.768e3 - t3633 - t1278 * t1279 * t3614 / 0.768e3;
  t3638 = t263 * t3637;
  t3639 = t3638 * t189;
  t3640 = t1517 * t387;
  tv3rhosigma25 = t1490 + t1493 + t1518 + t7 * (t3580 + t3582 + t3585 + t3586 + t3588 + t3639 + t3640);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t3648 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t932 * t1398 - t3409 - 0.3e1 / 0.8e1 * t932 * t1410 - t3422);
  t3649 = t1 * t3648;
  t3650 = t1659 * t482;
  t3651 = t3650 * t3449;
  t3652 = t1453 * t3093;
  t3653 = 0.2e1 * t3652;
  t3654 = t1417 * t475;
  t3655 = t1329 * t3454;
  t3658 = t1420 * t478;
  t3661 = t1419 * t456;
  t3662 = t1267 * t3661;
  t3665 = t1419 * t477;
  t3671 = t1430 * t477;
  t3672 = t1259 * t3671;
  t3681 = t1430 * t456;
  t3682 = t1267 * t3681;
  t3688 = -t458 * t1421 / 0.96e2 + t3461 + t101 * t3658 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t3662 + t3473 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3665 + t458 * t1432 / 0.96e2 - t3482 - t1258 * t3672 / 0.96e2 - t3488 * t1441 * t3661 / 0.2048e4 + t3497 + t1438 * t3498 * t3665 / 0.2048e4 + t1266 * t3682 / 0.768e3 - t3508 - t1278 * t1279 * t3671 / 0.768e3;
  t3689 = t263 * t3688;
  t3690 = t3689 * t189;
  t3691 = t1450 * t475;
  tv3rhosigma26 = t1415 + t1418 + t1451 + t7 * (t3649 + t3651 + t3653 + t3654 + t3655 + t3690 + t3691);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  t3694 = t3650 * t3519;
  t3695 = t659 * t1344;
  t3696 = t3695 * t1297;
  t3697 = t1453 * t3183;
  t3698 = t1453 * t3240;
  t3699 = t1329 * t3525;
  t3704 = t1461 * t456;
  t3705 = t1267 * t3704;
  t3708 = t1461 * t477;
  t3712 = t3550 * t1337;
  t3715 = t3558 * t1333;
  t3718 = -t458 * t1456 / 0.96e2 + t3532 + t3534 * t1381 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t3705 + t3543 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3708 - t3549 * t3712 / 0.2048e4 + t3556 + t3557 * t3715 / 0.2048e4;
  t3719 = t263 * t3718;
  t3720 = t3719 * t189;
  t3721 = t1469 * t475;
  tv3rhosigma28 = t1454 + t1470 + t7 * (t3694 + t3696 + t3697 + t3698 + t3699 + t3720 + t3721);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t3726 = t441 * t1472;
  t3727 = t2738 * t3726;
  t3730 = t538 * t1370;
  t3731 = t1108 * t3730;
  t3736 = t441 * t1484;
  t3737 = t1108 * t3736;
  t3744 = t1365 * t1132;
  t3750 = 0.1e1 / t66 / t2705;
  t3755 = t225 * t227 * t434 * t437 / 0.54e2 - 0.5e1 / 0.432e3 * t615 * t3744 * sigma[2] + t1575 * t430 * t3750 * t2717 * t1584 / 0.3456e4;
  t3756 = t422 * t3755;
  t3760 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t1103 * t1473 - t3572 - 0.3e1 / 0.8e1 * t420 * t3727 - 0.3e1 / 0.4e1 * t420 * t3731 - 0.3e1 / 0.8e1 * t1103 * t1485 - t3577 - 0.3e1 / 0.8e1 * t420 * t3737 - 0.3e1 / 0.8e1 * t420 * t3756);
  t3761 = t1 * t3760;
  t3762 = t3650 * t3581;
  t3763 = t3583 * t3183;
  t3764 = 0.2e1 * t3763;
  t3765 = t1492 * t475;
  t3766 = t1329 * t3587;
  t3769 = t1495 * t478;
  t3772 = t1494 * t456;
  t3773 = t1267 * t3772;
  t3776 = t1494 * t477;
  t3782 = t1504 * t477;
  t3783 = t1259 * t3782;
  t3792 = t1504 * t456;
  t3793 = t1267 * t3792;
  t3799 = -t458 * t1496 / 0.96e2 + t3594 + t101 * t3769 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t3773 + t3604 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3776 + t458 * t1506 / 0.96e2 - t3613 - t1258 * t3783 / 0.96e2 - t3488 * t1441 * t3772 / 0.2048e4 + t3623 + t1438 * t3498 * t3776 / 0.2048e4 + t1266 * t3793 / 0.768e3 - t3633 - t1278 * t1279 * t3782 / 0.768e3;
  t3800 = t263 * t3799;
  t3801 = t3800 * t189;
  t3802 = t1517 * t475;
  tv3rhosigma211 = t1490 + t1493 + t1518 + t7 * (t3761 + t3762 + t3764 + t3765 + t3766 + t3801 + t3802);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t3805 = t1397 * t499;
  t3806 = t1616 * t3805;
  t3809 = t499 * t1409;
  t3810 = t594 * t3809;
  t3818 = 0.1e1 / t38 / t618;
  t3823 = t615 * t1404 * t622 / 0.384e3 - t1575 * sigma[0] * t3818 * t1582 * t1584 / 0.9216e4;
  t3824 = t215 * t3823;
  t3828 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t213 * t3806 - 0.9e1 / 0.8e1 * t213 * t3810 - 0.3e1 / 0.8e1 * t213 * t3824);
  t3829 = t1 * t3828;
  t3830 = t1416 * t523;
  t3831 = t1659 * t3830;
  t3832 = t3831 * t189;
  t3834 = 0.3e1 * t1453 * t3454;
  t3835 = 0.1e1 / t229;
  t3836 = t3835 * t108;
  t3837 = t3836 * t192;
  t3841 = t286 * t104;
  t3842 = t1430 * t517 * t3841;
  t3845 = t1436 * t515;
  t3849 = t286 * t3835;
  t3854 = 0.1e1 / t102 / t229;
  t3855 = t192 * t3854;
  t3856 = t505 * t3855;
  t3859 = t511 * t511;
  t3860 = t4 * M_PI;
  t3861 = t3859 * t3860;
  t3862 = t1437 * t104;
  t3863 = t3861 * t3862;
  t3864 = t3492 * t7;
  t3866 = 0.1e1 / t27 / t3864;
  t3867 = t3866 * t2061;
  t3868 = t1430 * t99;
  t3875 = t286 * t3854;
  t3879 = t101 * t3837 / 0.64e2 - t514 * t3842 / 0.256e3 - 0.3e1 / 0.4096e4 * t3845 * t1441 * t1430 + 0.5e1 / 0.1024e4 * t514 * t1424 * t3849 - t101 * t3856 / 0.64e2 - t3863 * t3867 * t3868 / 0.98304e5 + t1438 * t1441 * t3835 / 0.4096e4 - t514 * t518 * t3875 / 0.1024e4;
  t3880 = t263 * t3879;
  t3881 = t3880 * t189;
  tv3sigma30 = t7 * (t3829 + t3832 + t3834 + t3881);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  t3883 = t1659 * t1416;
  t3884 = t3883 * t1297;
  t3885 = t659 * t1449;
  t3886 = t3885 * t1297;
  t3888 = 0.2e1 * t1453 * t3525;
  t3889 = t1430 * t108;
  t3890 = t3889 * t545;
  t3893 = t513 * t1419;
  t3894 = t512 * t3893;
  t3895 = t544 * t104;
  t3896 = t1267 * t3895;
  t3899 = t544 * t1419;
  t3903 = t544 * t1430;
  t3904 = t1267 * t3903;
  t3907 = t3862 * t3866;
  t3908 = t3861 * t3907;
  t3909 = t1419 * t99;
  t3910 = t3558 * t3909;
  t3916 = t101 * t3890 / 0.192e3 - t3894 * t3896 / 0.256e3 - 0.3e1 / 0.4096e4 * t3845 * t1441 * t3899 + 0.5e1 / 0.3072e4 * t1460 * t3904 - t3908 * t3910 / 0.98304e5 + t1438 * t1441 * t3903 / 0.12288e5;
  t3917 = t263 * t3916;
  t3918 = t3917 * t189;
  tv3sigma32 = t7 * (t3884 + t3886 + t3888 + t3918);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  t3920 = t1659 * t523;
  t3921 = t3920 * t3581;
  t3923 = 0.2e1 * t3583 * t3525;
  t3924 = t1453 * t3587;
  t3925 = t513 * t1494;
  t3926 = t512 * t3925;
  t3927 = t104 * t506;
  t3928 = t1267 * t3927;
  t3931 = t1494 * t506;
  t3935 = t1455 * t1505;
  t3938 = t1504 * t506;
  t3939 = t1267 * t3938;
  t3942 = t2061 * t1494;
  t3943 = t99 * t506;
  t3944 = t3942 * t3943;
  t3950 = -t3926 * t3928 / 0.256e3 - 0.3e1 / 0.4096e4 * t3845 * t1441 * t3931 + t101 * t3935 / 0.192e3 + 0.5e1 / 0.3072e4 * t1460 * t3939 - t3908 * t3944 / 0.98304e5 + t1438 * t1441 * t3938 / 0.12288e5;
  t3951 = t263 * t3950;
  t3952 = t3951 * t189;
  tv3sigma35 = t7 * (t3921 + t3923 + t3924 + t3952);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t3954 = t1472 * t538;
  t3955 = t2738 * t3954;
  t3958 = t538 * t1484;
  t3959 = t1108 * t3958;
  t3967 = 0.1e1 / t66 / t1128;
  t3972 = t615 * t1479 * t1132 / 0.384e3 - t1575 * sigma[2] * t3967 * t2717 * t1584 / 0.9216e4;
  t3973 = t422 * t3972;
  t3977 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t420 * t3955 - 0.9e1 / 0.8e1 * t420 * t3959 - 0.3e1 / 0.8e1 * t420 * t3973);
  t3978 = t1 * t3977;
  t3979 = t1491 * t553;
  t3980 = t1659 * t3979;
  t3981 = t3980 * t189;
  t3983 = 0.3e1 * t3583 * t3587;
  t3984 = 0.1e1 / t430;
  t3985 = t3984 * t108;
  t3986 = t3985 * t192;
  t3990 = t1504 * t517 * t3841;
  t3996 = t286 * t3984;
  t4001 = 0.1e1 / t103 / t430;
  t4002 = t192 * t4001;
  t4003 = t505 * t4002;
  t4006 = t1504 * t99;
  t4013 = t286 * t4001;
  t4017 = t101 * t3986 / 0.64e2 - t514 * t3990 / 0.256e3 - 0.3e1 / 0.4096e4 * t3845 * t1441 * t1504 + 0.5e1 / 0.1024e4 * t514 * t1424 * t3996 - t101 * t4003 / 0.64e2 - t3863 * t3867 * t4006 / 0.98304e5 + t1438 * t1441 * t3984 / 0.4096e4 - t514 * t518 * t4013 / 0.1024e4;
  t4018 = t263 * t4017;
  t4019 = t4018 * t189;
  tv3sigma39 = t7 * (t3978 + t3981 + t3983 + t4019);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t40, t42, t46, t47, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t63, t64, t65;
  double t66, t68, t70, t74, t75, t78, t79, t83;
  double t85, t86, t87, t88, t89, t90, t91, t92;
  double t93, t94, t95, t96, t98, t99, t100, t101;
  double t102, t103, t104, t105, t106, t108, t109, t110;
  double t111, t114, t115, t116, t117, t118, t121, t123;
  double t124, t127, t129, t130, t131, t132, t134, t136;
  double t139, t140, t142, t143, t144, t145, t146, t147;
  double t148, t149, t150, t151, t152, t153, t156, t157;
  double t159, t164, t167, t168, t172, t177, t180, t181;
  double t182, t184, t185, t189, t191, t192, t193, t195;
  double t196, t197, tzk0;

  double t198, t199, t200, t201, t204, t212, t213, t214;
  double t215, t216, t218, t223, t224, t225, t227, t228;
  double t229, t230, t231, t233, t235, t236, t240, t241;
  double t245, t246, t247, t250, t258, t260, t262, t263;
  double t264, t267, t268, t271, t273, t274, t275, t278;
  double t280, t281, t282, t284, t285, t286, t289, t291;
  double t293, t294, t297, t298, t299, t300, t302, t303;
  double t304, t305, t307, t309, t310, t311, t314, t316;
  double t318, t319, t320, t322, t323, t324, t326, t327;
  double t328, t329, t331, t334, t337, t339, t340, t345;
  double t346, t347, t352, t353, t354, t360, t361, t362;
  double t367, t368, t369, t372, t373, t374, t377, t379;
  double t381, t382, t384, t386, t387, t389, t390, t391;
  double t394, t395, t396, t397, tvrho0, t400, t401, t404;
  double t410, t411, t412, t415, t420, t421, t422, t423;
  double t425, t430, t431, t432, t434, t436, t437, t441;
  double t442, t446, t448, t451, t454, t456, t457, t458;
  double t465, t468, t470, t471, t475, t477, t478, t479;
  double t482, t483, t484, t485, tvrho1, t492, t494, t499;
  double t500, t503, t504, t505, t506, t507, t508, t511;
  double t512, t513, t514, t515, t517, t518, t519, t520;
  double t523, t524, t525, tvsigma0, tvsigma1, t531, t533, t538;
  double t539, t542, t543, t544, t545, t546, t549, t550;
  double t553, t554, t555, tvsigma2;

  double t560, t561, t562, t565, t566, t568, t569, t573;
  double t580, t582, t588, t589, t590, t591, t593, t594;
  double t595, t596, t600, t605, t607, t613, t614, t615;
  double t616, t617, t618, t619, t622, t626, t627, t631;
  double t632, t633, t634, t637, t638, t642, t649, t654;
  double t656, t658, t659, t660, t661, t662, t663, t664;
  double t670, t671, t672, t678, t680, t681, t682, t685;
  double t690, t691, t692, t694, t695, t696, t699, t700;
  double t701, t702, t707, t709, t711, t712, t713, t714;
  double t715, t716, t717, t718, t720, t723, t724, t726;
  double t727, t728, t730, t731, t733, t734, t736, t737;
  double t738, t740, t743, t745, t747, t749, t750, t751;
  double t753, t754, t755, t757, t761, t762, t766, t767;
  double t768, t769, t770, t779, t780, t783, t784, t785;
  double t786, t787, t788, t793, t794, t797, t798, t799;
  double t800, t801, t802, t804, t811, t812, t814, t815;
  double t816, t817, t818, t819, t820, t822, t826, t830;
  double t831, t832, t833, t836, t839, t840, t843, t844;
  double t845, t846, t852, t853, t859, t861, t862, t864;
  double t865, t867, t870, t871, t874, t875, t876, t878;
  double t879, t881, t885, t887, t888, t889, t892, t894;
  double t895, t896, t898, t899, t900, t902, t903, t904;
  double t907, t908, t909, t910, t911, t912, tv2rho20, t915;
  double t918, t919, t923, t930, t932, t938, t939, t942;
  double t946, t953, t956, t959, t960, t961, t964, t966;
  double t967, t968, t969, t970, t973, t977, t978, t981;
  double t985, t987, t988, t989, t992, t1000, t1001, t1003;
  double t1004, t1005, t1006, t1011, t1014, t1015, t1018, t1020;
  double t1023, t1024, t1027, t1031, t1032, t1035, t1039, t1041;
  double t1042, t1044, t1045, t1050, t1051, t1053, t1054, t1056;
  double t1057, t1058, t1061, t1062, t1063, t1064, t1065, t1066;
  double tv2rho21, t1072, t1076, t1077, t1081, t1088, t1089, t1092;
  double t1093, t1097, t1103, t1107, t1108, t1109, t1110, t1114;
  double t1119, t1121, t1126, t1127, t1128, t1129, t1132, t1136;
  double t1137, t1141, t1143, t1144, t1145, t1146, t1147, t1153;
  double t1154, t1160, t1162, t1163, t1164, t1171, t1172, t1173;
  double t1184, t1190, t1192, t1193, t1201, t1203, t1204, t1206;
  double t1207, t1208, t1211, t1212, t1213, t1214, t1215, t1216;
  double tv2rho22, t1221, t1223, t1224, t1225, t1236, t1237, t1242;
  double t1243, t1247, t1248, t1249, t1250, t1253, t1254, t1256;
  double t1257, t1258, t1259, t1260, t1261, t1264, t1265, t1266;
  double t1267, t1268, t1273, t1274, t1275, t1277, t1278, t1279;
  double t1280, t1283, t1284, t1285, t1286, tv2rhosigma0, tv2rhosigma1, t1291;
  double t1293, t1295, t1296, t1297, t1298, t1301, t1303, t1304;
  double t1305, t1308, t1312, t1314, t1315, t1318, t1319, t1320;
  double t1321, tv2rhosigma2, t1327, t1328, t1329, t1330, t1333, t1334;
  double t1337, t1338, t1341, t1344, t1345, t1346, t1347, tv2rhosigma3;
  double tv2rhosigma4, t1352, t1353, t1364, t1365, t1370, t1371, t1375;
  double t1376, t1377, t1380, t1381, t1384, t1385, t1388, t1391;
  double t1392, t1393, t1394, tv2rhosigma5, t1397, t1398, t1404, t1409;
  double t1410, t1414, t1415, t1416, t1417, t1418, t1419, t1420;
  double t1421, t1424, t1425, t1426, t1430, t1431, t1432, t1435;
  double t1436, t1437, t1438, t1439, t1440, t1441, t1445, t1446;
  double t1449, t1450, t1451, tv2sigma20, tv2sigma21, t1453, t1454, t1455;
  double t1456, t1459, t1460, t1461, t1462, t1468, t1469, t1470;
  double tv2sigma22, tv2sigma23, tv2sigma24, t1472, t1473, t1479, t1484, t1485;
  double t1489, t1490, t1491, t1492, t1493, t1494, t1495, t1496;
  double t1499, t1500, t1504, t1505, t1506, t1512, t1513, t1516;
  double t1517, t1518, tv2sigma25;

  double t1526, t1527, t1530, t1533, t1535, t1536, t1540, t1548;
  double t1549, t1550, t1551, t1553, t1554, t1557, t1563, t1568;
  double t1569, t1574, t1575, t1576, t1577, t1578, t1580, t1581;
  double t1582, t1584, t1588, t1589, t1594, t1596, t1601, t1603;
  double t1607, t1608, t1609, t1611, t1612, t1615, t1616, t1617;
  double t1618, t1623, t1624, t1626, t1627, t1630, t1633, t1634;
  double t1638, t1645, t1649, t1654, t1656, t1658, t1659, t1660;
  double t1661, t1662, t1663, t1664, t1665, t1666, t1667, t1668;
  double t1670, t1671, t1674, t1680, t1681, t1683, t1684, t1687;
  double t1693, t1695, t1696, t1699, t1701, t1704, t1705, t1707;
  double t1708, t1709, t1712, t1714, t1716, t1717, t1719, t1721;
  double t1723, t1724, t1725, t1727, t1731, t1732, t1735, t1736;
  double t1737, t1739, t1740, t1742, t1743, t1745, t1746, t1747;
  double t1749, t1751, t1754, t1756, t1757, t1759, t1761, t1762;
  double t1764, t1765, t1767, t1769, t1770, t1771, t1773, t1775;
  double t1778, t1784, t1786, t1789, t1795, t1797, t1800, t1801;
  double t1802, t1804, t1806, t1807, t1809, t1811, t1812, t1813;
  double t1815, t1817, t1818, t1820, t1821, t1823, t1824, t1826;
  double t1835, t1837, t1839, t1841, t1844, t1845, t1847, t1848;
  double t1850, t1852, t1853, t1856, t1857, t1858, t1859, t1860;
  double t1862, t1864, t1867, t1868, t1871, t1874, t1878, t1879;
  double t1880, t1881, t1883, t1884, t1886, t1889, t1892, t1893;
  double t1895, t1897, t1899, t1901, t1903, t1904, t1906, t1908;
  double t1912, t1914, t1915, t1916, t1917, t1918, t1920, t1921;
  double t1922, t1923, t1926, t1927, t1928, t1931, t1932, t1933;
  double t1934, t1945, t1946, t1950, t1951, t1953, t1954, t1957;
  double t1958, t1961, t1964, t1967, t1968, t1971, t1974, t1981;
  double t1985, t1986, t1993, t1997, t2008, t2011, t2014, t2024;
  double t2025, t2026, t2027, t2028, t2030, t2032, t2033, t2034;
  double t2037, t2038, t2040, t2041, t2043, t2044, t2045, t2047;
  double t2050, t2054, t2056, t2060, t2061, t2062, t2063, t2064;
  double t2067, t2068, t2071, t2072, t2076, t2077, t2078, t2079;
  double t2080, t2081, t2082, t2083, tv3rho30, t2086, t2087, t2088;
  double t2089, t2090, t2091, t2092, t2095, t2100, t2101, t2102;
  double t2103, t2107, t2115, t2116, t2121, t2124, t2135, t2136;
  double t2137, t2140, t2146, t2150, t2158, t2161, t2165, t2169;
  double t2170, t2171, t2172, t2175, t2177, t2178, t2179, t2180;
  double t2181, t2182, t2183, t2185, t2186, t2189, t2193, t2194;
  double t2199, t2202, t2203, t2213, t2214, t2217, t2218, t2228;
  double t2230, t2231, t2232, t2239, t2243, t2245, t2249, t2250;
  double t2255, t2256, t2258, t2260, t2262, t2263, t2266, t2276;
  double t2277, t2280, t2290, t2292, t2293, t2296, t2297, t2300;
  double t2302, t2303, t2305, t2307, t2309, t2311, t2312, t2316;
  double t2318, t2319, t2321, t2322, t2325, t2327, t2328, t2330;
  double t2332, t2333, t2335, t2342, t2343, t2346, t2348, t2350;
  double t2351, t2352, t2355, t2357, t2361, t2364, t2365, t2366;
  double t2369, t2370, t2373, t2374, t2376, t2377, t2378, t2381;
  double t2384, t2385, t2386, t2387, t2388, t2390, t2391, t2392;
  double t2393, t2395, t2396, tv3rho31, t2398, t2403, t2406, t2407;
  double t2411, t2418, t2420, t2427, t2428, t2433, t2436, t2437;
  double t2441, t2448, t2451, t2454, t2460, t2461, t2462, t2466;
  double t2467, t2469, t2470, t2472, t2473, t2474, t2475, t2476;
  double t2478, t2479, t2480, t2485, t2490, t2496, t2497, t2502;
  double t2508, t2510, t2511, t2514, t2518, t2519, t2521, t2523;
  double t2525, t2526, t2527, t2528, t2533, t2540, t2548, t2549;
  double t2554, t2560, t2561, t2566, t2572, t2574, t2581, t2583;
  double t2585, t2587, t2588, t2589, t2598, t2599, t2600, t2603;
  double t2606, t2607, t2610, t2611, t2614, t2616, t2617, t2619;
  double t2620, t2626, t2629, t2631, t2632, t2633, t2634, t2635;
  double t2636, t2637, t2639, t2641, t2643, t2644, t2645, tv3rho32;
  double t2652, t2658, t2659, t2663, t2671, t2677, t2682, t2683;
  double t2687, t2694, t2700, t2705, t2706, t2711, t2712, t2713;
  double t2715, t2716, t2717, t2722, t2723, t2726, t2733, t2734;
  double t2737, t2738, t2739, t2740, t2743, t2744, t2746, t2747;
  double t2748, t2749, t2750, t2751, t2752, t2753, t2759, t2767;
  double t2768, t2776, t2778, t2779, t2789, t2797, t2805, t2807;
  double t2812, t2817, t2823, t2826, t2828, t2830, t2831, t2832;
  double t2840, t2845, t2846, t2847, t2850, t2851, t2854, t2855;
  double t2856, t2857, t2858, t2859, t2860, t2861, tv3rho33, t2870;
  double t2876, t2878, t2879, t2880, t2882, t2883, t2885, t2886;
  double t2889, t2890, t2893, t2894, t2905, t2910, t2912, t2917;
  double t2918, t2921, t2922, t2923, t2924, t2925, t2926, t2927;
  double t2928, t2929, t2930, t2931, t2934, t2936, t2939, t2940;
  double t2942, t2943, t2944, t2945, t2947, t2948, t2951, t2952;
  double t2955, t2956, t2957, t2960, t2962, t2964, t2968, t2969;
  double t2973, t2974, t2977, t2978, t2980, t2982, t2989, t2990;
  double t2991, t2992, t2993, t2994, tv3rho2sigma0, tv3rho2sigma1, t3003, t3005;
  double t3007, t3009, t3010, t3011, t3012, t3013, t3014, t3015;
  double t3016, t3017, t3018, t3021, t3025, t3027, t3028, t3029;
  double t3031, t3032, t3035, t3036, t3042, t3044, t3048, t3049;
  double t3054, t3056, t3064, t3065, t3066, t3067, t3068, t3069;
  double tv3rho2sigma2, t3074, t3084, t3085, t3086, t3087, t3088, t3089;
  double t3090, t3091, t3092, t3093, t3094, t3097, t3099, t3106;
  double t3107, t3109, t3110, t3113, t3114, t3118, t3119, t3122;
  double t3123, t3125, t3126, t3129, t3130, t3135, t3140, t3148;
  double t3149, t3150, t3151, t3152, t3153, t3154, t3155, t3156;
  double t3157, tv3rho2sigma3, tv3rho2sigma4, t3161, t3166, t3167, t3171, t3172;
  double t3175, t3176, t3177, t3178, t3179, t3180, t3181, t3182;
  double t3183, t3184, t3187, t3195, t3196, t3198, t3199, t3202;
  double t3203, t3209, t3210, t3212, t3213, t3216, t3217, t3222;
  double t3227, t3235, t3236, t3237, t3238, t3239, t3240, t3241;
  double t3242, t3243, t3244, tv3rho2sigma5, t3254, t3255, t3256, t3257;
  double t3258, t3259, t3260, t3261, t3262, t3263, t3270, t3271;
  double t3274, t3275, t3278, t3279, t3280, t3284, t3285, t3288;
  double t3289, t3299, t3300, t3301, t3302, t3303, t3304, tv3rho2sigma6;
  double tv3rho2sigma7, t3320, t3321, t3324, t3325, t3328, t3329, t3340;
  double t3345, t3347, t3352, t3353, t3356, t3357, t3358, t3359;
  double t3360, t3361, t3362, t3363, t3364, t3371, t3372, t3375;
  double t3376, t3382, t3383, t3386, t3387, t3397, t3398, t3399;
  double t3400, t3401, t3402, tv3rho2sigma8, t3407, t3409, t3410, t3411;
  double t3414, t3415, t3420, t3422, t3423, t3424, t3431, t3437;
  double t3442, t3443, t3447, t3448, t3449, t3450, t3451, t3452;
  double t3453, t3454, t3455, t3458, t3459, t3461, t3462, t3465;
  double t3466, t3470, t3473, t3474, t3480, t3482, t3483, t3484;
  double t3487, t3488, t3492, t3493, t3494, t3497, t3498, t3502;
  double t3508, t3512, t3513, t3514, t3515, tv3rhosigma20, tv3rhosigma21, t3518;
  double t3519, t3520, t3521, t3522, t3523, t3524, t3525, t3526;
  double t3529, t3530, t3532, t3533, t3534, t3537, t3543, t3544;
  double t3548, t3549, t3550, t3551, t3556, t3557, t3558, t3559;
  double t3562, t3563, t3564, t3565, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t3570;
  double t3572, t3575, t3577, t3579, t3580, t3581, t3582, t3583;
  double t3584, t3585, t3586, t3587, t3588, t3591, t3592, t3594;
  double t3595, t3598, t3604, t3605, t3611, t3613, t3614, t3615;
  double t3623, t3627, t3633, t3637, t3638, t3639, t3640, tv3rhosigma25;
  double t3648, t3649, t3650, t3651, t3652, t3653, t3654, t3655;
  double t3658, t3661, t3662, t3665, t3671, t3672, t3681, t3682;
  double t3688, t3689, t3690, t3691, tv3rhosigma26, tv3rhosigma27, t3694, t3695;
  double t3696, t3697, t3698, t3699, t3704, t3705, t3708, t3712;
  double t3715, t3718, t3719, t3720, t3721, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t3726, t3727, t3730, t3731, t3736, t3737, t3744, t3750;
  double t3755, t3756, t3760, t3761, t3762, t3763, t3764, t3765;
  double t3766, t3769, t3772, t3773, t3776, t3782, t3783, t3792;
  double t3793, t3799, t3800, t3801, t3802, tv3rhosigma211, t3805, t3806;
  double t3809, t3810, t3818, t3823, t3824, t3828, t3829, t3830;
  double t3831, t3832, t3834, t3835, t3836, t3837, t3841, t3842;
  double t3845, t3849, t3854, t3855, t3856, t3859, t3860, t3861;
  double t3862, t3863, t3864, t3866, t3867, t3868, t3875, t3879;
  double t3880, t3881, tv3sigma30, tv3sigma31, t3883, t3884, t3885, t3886;
  double t3888, t3889, t3890, t3893, t3894, t3895, t3896, t3899;
  double t3903, t3904, t3907, t3908, t3909, t3910, t3916, t3917;
  double t3918, tv3sigma32, tv3sigma33, tv3sigma34, t3920, t3921, t3923, t3924;
  double t3925, t3926, t3927, t3928, t3931, t3935, t3938, t3939;
  double t3942, t3943, t3944, t3950, t3951, t3952, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t3954, t3955, t3958, t3959, t3967, t3972;
  double t3973, t3977, t3978, t3979, t3980, t3981, t3983, t3984;
  double t3985, t3986, t3990, t3996, t4001, t4002, t4003, t4006;
  double t4013, t4017, t4018, t4019, tv3sigma39;

  double t4031, t4033, t4035, t4038, t4059, t4067, t4070, t4075;
  double t4077, t4085, t4091, t4094, t4096, t4098, t4100, t4102;
  double t4104, t4105, t4107, t4109, t4113, t4114, t4115, t4121;
  double t4123, t4125, t4126, t4132, t4137, t4139, t4140, t4144;
  double t4151, t4155, t4160, t4164, t4174, t4176, t4177, t4179;
  double t4180, t4186, t4191, t4192, t4196, t4203, t4207, t4211;
  double t4216, t4218, t4221, t4222, t4229, t4241, t4243, t4247;
  double t4248, t4254, t4262, t4265, t4266, t4272, t4280, t4283;
  double t4286, t4288, t4290, t4293, t4296, t4298, t4299, t4302;
  double t4303, t4307, t4308, t4312, t4316, t4317, t4319, t4324;
  double t4329, t4331, t4334, t4335, t4337, t4339, t4342, t4344;
  double t4349, t4353, t4357, t4360, t4364, t4367, t4370, t4374;
  double t4378, t4380, t4382, t4384, t4386, t4390, t4393, t4396;
  double t4399, t4401, t4405, t4408, t4409, t4411, t4413, t4415;
  double t4417, t4420, t4422, t4423, t4424, t4425, t4428, t4435;
  double t4437, t4439, t4440, t4442, t4443, t4445, t4446, t4448;
  double t4451, t4453, t4455, t4457, t4460, t4469, t4502, t4532;
  double t4536, t4559, t4560, t4562, t4563, t4565, t4566, t4573;
  double t4576, t4591, t4600, t4618, t4622, t4625, t4626, t4629;
  double t4632, t4636, t4643, t4649, t4672, t4676, t4680, t4690;
  double t4701, t4706, t4710, t4711, t4712, t4713, t4714, t4718;
  double t4719, t4723, t4736, t4738, t4751, t4753, t4759, t4761;
  double t4763, t4768, t4769, t4774, t4778, t4779, t4781, t4783;
  double t4785, t4786, t4789, t4791, t4794, t4801, t4802, t4807;
  double t4808, t4810, t4812, t4817, t4819, t4820, t4822, t4823;
  double t4824, t4826, t4828, t4830, t4831, t4832, t4834, t4835;
  double t4837, t4838, t4839, t4841, t4843, t4845, t4846, t4848;
  double t4851, t4854, t4855, t4856, t4857, t4861, t4862, t4866;
  double t4867, t4870, t4877, t4879, t4891, t4895, t4900, t4904;
  double t4908, t4910, t4913, t4916, t4917, t4922, t4931, t4936;
  double t4937, t4943, t4945, t4956, tv4rho40, t4966, t4988, t4989;
  double t4990, t4991, t4995, t5002, t5003, t5014, t5018, t5021;
  double t5024, t5026, t5030, t5031, t5040, t5044, t5047, t5049;
  double t5067, t5071, t5078, t5082, t5083, t5086, t5091, t5094;
  double t5096, t5097, t5098, t5100, t5102, t5103, t5106, t5107;
  double t5108, t5109, t5110, t5112, t5113, t5114, t5116, t5119;
  double t5121, t5122, t5123, t5126, t5132, t5142, t5145, t5151;
  double t5154, t5162, t5164, t5169, t5172, t5178, t5181, t5189;
  double t5191, t5193, t5197, t5199, t5202, t5203, t5204, t5206;
  double t5207, t5209, t5210, t5211, t5212, t5213, t5215, t5217;
  double t5218, t5219, t5220, t5222, t5223, t5226, t5227, t5228;
  double t5234, t5235, t5238, t5241, t5242, t5243, t5251, t5253;
  double t5255, t5257, t5259, t5261, t5262, t5263, t5264, t5265;
  double t5268, t5269, t5271, t5272, t5274, t5276, t5277, t5278;
  double t5279, t5280, t5283, t5286, t5287, t5289, t5291, t5293;
  double t5296, t5299, t5310, t5313, t5320, t5329, t5343, t5344;
  double t5351, t5352, t5356, t5358, t5359, t5369, t5372, t5374;
  double t5376, t5381, t5383, t5405, t5407, t5428, t5430, t5433;
  double t5438, t5439, t5440, t5444, t5448, t5449, t5450, t5452;
  double t5453, t5455, t5457, t5463, t5468, t5470, t5471, t5472;
  double t5497, t5504, t5510, t5515, t5522, t5532, tv4rho41, t5545;
  double t5553, t5555, t5560, t5562, t5575, t5588, t5592, t5612;
  double t5614, t5616, t5626, t5639, t5643, t5654, t5658, t5660;
  double t5667, t5669, t5671, t5673, t5675, t5677, t5684, t5686;
  double t5689, t5699, t5720, t5725, t5746, t5748, t5757, t5759;
  double t5762, t5767, t5769, t5772, t5779, t5781, t5786, t5787;
  double t5793, t5796, t5798, t5806, t5810, t5813, t5815, t5821;
  double t5833, t5839, t5842, t5854, t5856, t5866, t5869, t5871;
  double t5873, t5891, t5899, t5905, t5908, t5911, t5915, t5921;
  double t5936, t5964, t5988, t5991, t5999, t6004, t6010, t6014;
  double t6018, t6020, t6036, t6042, t6054, t6066, t6069, t6085;
  double t6088, t6096, t6103, t6108, t6110, t6112, t6125, t6135;
  double tv4rho42, t6164, t6165, t6169, t6176, t6178, t6187, t6188;
  double t6208, t6209, t6213, t6220, t6226, t6228, t6230, t6232;
  double t6236, t6238, t6249, t6255, t6257, t6259, t6261, t6264;
  double t6286, t6287, t6292, t6294, t6309, t6312, t6323, t6329;
  double t6332, t6343, t6346, t6349, t6362, t6366, t6373, t6393;
  double t6411, t6413, t6419, t6428, t6434, t6436, t6440, t6444;
  double t6448, t6457, t6463, t6465, t6468, t6475, t6477, t6490;
  double t6506, t6509, t6512, t6525, t6540, t6554, t6560, t6576;
  double t6579, tv4rho43, t6588, t6593, t6599, t6600, t6604, t6613;
  double t6630, t6631, t6632, t6638, t6643, t6648, t6649, t6653;
  double t6658, t6663, t6673, t6695, t6704, t6709, t6718, t6720;
  double t6723, t6730, t6747, t6752, t6760, t6761, t6766, t6774;
  double t6777, t6787, t6794, t6809, t6811, t6819, t6827, t6835;
  double t6838, t6854, t6866, t6868, t6876, t6880, t6883, t6899;
  double t6911, t6922, tv4rho44, t6936, t6939, t6943, t6948, t6961;
  double t6963, t6969, t6972, t6976, t6978, t6980, t6982, t6987;
  double t6989, t6991, t6993, t6995, t6998, t7001, t7009, t7012;
  double t7014, t7018, t7020, t7023, t7024, t7028, t7031, t7032;
  double t7041, t7049, t7057, t7058, t7065, t7068, t7102, t7106;
  double t7107, t7109, t7111, t7113, t7119, t7122, t7125, t7138;
  double t7154, t7156, t7158, t7166, tv4rho3sigma0, tv4rho3sigma1, t7185, t7187;
  double t7191, t7193, t7201, t7204, t7209, t7212, t7215, t7218;
  double t7220, t7227, t7239, t7240, t7242, t7246, t7247, t7248;
  double t7254, t7261, t7272, t7274, t7284, t7287, t7295, t7299;
  double t7307, t7310, tv4rho3sigma2, t7321, t7322, t7326, t7333, t7347;
  double t7353, t7356, t7373, t7374, t7377, t7386, t7387, t7388;
  double t7389, t7394, t7399, t7402, t7405, t7411, t7417, t7419;
  double t7421, t7422, t7426, t7435, t7440, t7447, t7454, t7458;
  double t7466, t7469, t7475, t7480, t7494, t7498, t7501, t7504;
  double t7507, t7519, t7521, t7523, t7537, t7540, t7543, t7546;
  double t7547, t7548, t7549, t7550, t7551, t7552, t7553, t7554;
  double t7555, t7556, tv4rho3sigma3, tv4rho3sigma4, t7557, t7558, t7559, t7567;
  double t7575, t7586, t7592, t7599, t7600, t7607, t7609, t7614;
  double t7616, t7618, t7619, t7621, t7630, t7634, t7635, t7643;
  double t7649, t7657, t7664, t7667, t7671, t7682, t7698, t7701;
  double t7702, t7706, t7712, t7721, t7725, t7735, t7740, t7743;
  double t7745, t7749, t7762, t7769, t7772, t7773, t7774, t7775;
  double t7776, t7777, t7778, t7779, t7780, tv4rho3sigma5, t7785, t7789;
  double t7799, t7800, t7805, t7817, t7819, t7832, t7838, t7848;
  double t7851, t7856, t7858, t7863, t7872, t7875, t7877, t7881;
  double t7882, t7888, t7895, t7898, t7899, t7904, t7907, t7909;
  double t7911, t7936, t7943, t7955, t7960, t7968, tv4rho3sigma6, tv4rho3sigma7;
  double t7979, t7983, t7988, t7995, t8002, t8009, t8025, t8028;
  double t8030, t8033, t8036, t8038, t8051, t8056, t8059, t8066;
  double t8088, t8098, t8103, t8107, t8110, t8116, t8121, t8126;
  double t8131, t8133, t8135, t8137, t8142, t8151, t8152, t8167;
  double t8177, tv4rho3sigma8, t8200, t8202, t8209, t8222, t8229, t8247;
  double t8251, t8274, t8287, tv4rho3sigma9, tv4rho3sigma10, t8322, t8323, t8337;
  double t8388, t8390, t8400, t8405, t8426, t8430, t8458, t8469;
  double tv4rho3sigma11, t8481, t8526, t8534, t8535, t8541, t8543, t8553;
  double t8561, t8563, t8566, t8568, t8570, t8574, t8577, t8580;
  double t8591, t8594, t8600, t8603, t8607, t8616, t8618, t8623;
  double t8625, t8629, t8634, t8640, t8644, t8645, t8649, t8654;
  double t8664, t8666, t8668, t8669, t8675, t8679, t8682, t8688;
  double t8690, t8695, t8704, t8709, t8713, t8719, t8721, t8723;
  double t8730, tv4rho2sigma20, tv4rho2sigma21, t8742, t8746, t8750, t8754, t8774;
  double t8776, t8777, t8788, t8789, t8790, t8791, t8799, t8800;
  double t8804, t8805, t8807, t8810, t8816, t8818, t8824, t8829;
  double t8830, t8844, t8848, t8852, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t8863;
  double t8867, t8870, t8874, t8876, t8880, t8883, t8886, t8897;
  double t8900, t8905, t8910, t8916, t8925, t8927, t8930, t8933;
  double t8935, t8939, t8947, t8953, t8959, t8966, t8970, t8978;
  double t8980, t8993, t8999, t9004, t9009, t9018, t9020, t9027;
  double tv4rho2sigma25, t9031, t9042, t9051, t9052, t9057, t9062, t9071;
  double t9075, t9083, t9098, t9113, t9117, t9130, t9132, t9135;
  double t9137, t9141, t9148, t9150, t9160, t9169, t9174, t9178;
  double t9183, t9186, t9189, t9194, t9203, t9206, t9219, t9225;
  double t9229, tv4rho2sigma26, tv4rho2sigma27, t9234, t9237, t9248, t9250, t9253;
  double t9257, t9287, t9290, t9305, t9312, t9313, t9315, t9318;
  double t9320, t9338, t9345, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t9350, t9356;
  double t9361, t9365, t9371, t9376, t9378, t9379, t9388, t9391;
  double t9398, t9402, t9410, t9418, t9426, t9429, t9431, t9438;
  double t9449, t9452, t9454, t9456, t9464, t9468, t9470, t9482;
  double t9513, t9521, t9526, t9529, t9532, t9534, t9543, t9549;
  double t9553, tv4rho2sigma211, t9570, t9572, t9574, t9580, t9597, t9601;
  double t9613, t9639, t9661, t9665, t9678, t9685, tv4rho2sigma212, tv4rho2sigma213;
  double t9720, t9747, t9774, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t9791, t9820;
  double t9857, t9859, t9867, t9900, t9906, t9912, t9919, t9937;
  double t9946, t9965, t9972, tv4rho2sigma217, t9978, t9991, t10007, t10015;
  double t10030, t10031, t10033, t10038, t10047, t10054, t10058, t10059;
  double t10061, t10067, t10068, t10070, t10073, t10079, t10083, t10089;
  double t10090, t10094, t10099, t10100, t10105, t10106, t10112, t10113;
  double t10116, t10117, t10118, t10127, t10137, t10141, t10146, tv4rhosigma30;
  double tv4rhosigma31, t10149, t10156, t10163, t10172, t10179, t10181, t10184;
  double t10191, t10196, t10197, t10203, t10204, t10214, t10224, t10226;
  double t10236, t10240, t10244, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, t10247, t10254;
  double t10264, t10269, t10271, t10278, t10288, t10296, t10305, t10315;
  double t10320, t10326, t10327, t10331, t10335, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37;
  double tv4rhosigma38, t10341, t10346, t10351, t10353, t10355, t10357, t10361;
  double t10370, t10377, t10381, t10382, t10388, t10389, t10397, t10401;
  double t10407, t10408, t10412, t10417, t10418, t10427, t10428, t10437;
  double t10447, t10451, t10456, tv4rhosigma39, t10465, t10467, t10487, t10491;
  double t10500, t10504, t10508, t10511, t10518, t10535, t10540, tv4rhosigma310;
  double tv4rhosigma311, t10601, t10605, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, t10615, t10667;
  double t10671, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t10705, t10720, t10721;
  double t10751, t10755, t10759, t10762, t10785, t10790, tv4rhosigma319, t10792;
  double t10800, t10824, t10826, t10831, t10837, t10847, t10854, t10855;
  double t10867, t10874, t10875, t10876, t10879, t10880, t10896, tv4sigma40;
  double tv4sigma41, t10928, t10936, t10941, tv4sigma42, tv4sigma43, tv4sigma44, t10962;
  double t10999, t11016, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, t11053, tv4sigma49;
  double tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t11072, t11080, t11104, t11106;
  double t11111, t11117, t11145, t11165, tv4sigma414;

  hyb_gga_xc_case21_params *params;

  assert(p->params != NULL);
  params = (hyb_gga_xc_case21_params * )(p->params);

  t1 = 0.1e1 - params->ax;
  t2 = rho[0] <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * p->zeta_threshold;
  t24 = POW_1_3(t20);
  t26 = my_piecewise3(t21, t23, t24 * t20);
  t27 = POW_1_3(t7);
  t28 = t26 * t27;
  t29 = M_CBRT6;
  t30 = params->gammax * t29;
  t31 = M_PI * M_PI;
  t32 = POW_1_3(t31);
  t33 = t32 * t32;
  t34 = 0.1e1 / t33;
  t35 = t30 * t34;
  t36 = rho[0] * rho[0];
  t37 = POW_1_3(rho[0]);
  t38 = t37 * t37;
  t40 = 0.1e1 / t38 / t36;
  t42 = t34 * sigma[0];
  t46 = 0.1e1 + t30 * t42 * t40 / 0.24e2;
  t47 = 0.1e1 / t46;
  t50 = t35 * sigma[0] * t40 * t47 / 0.24e2;
  t51 = xbspline(t50, 0, params);
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t28 * t51);
  t56 = rho[1] <= p->dens_threshold;
  t57 = my_piecewise5(t15, t12, t11, t16, -t18);
  t58 = 0.1e1 + t57;
  t59 = t58 <= p->zeta_threshold;
  t60 = POW_1_3(t58);
  t62 = my_piecewise3(t59, t23, t60 * t58);
  t63 = t62 * t27;
  t64 = rho[1] * rho[1];
  t65 = POW_1_3(rho[1]);
  t66 = t65 * t65;
  t68 = 0.1e1 / t66 / t64;
  t70 = t34 * sigma[2];
  t74 = 0.1e1 + t30 * t70 * t68 / 0.24e2;
  t75 = 0.1e1 / t74;
  t78 = t35 * sigma[2] * t68 * t75 / 0.24e2;
  t79 = xbspline(t78, 0, params);
  t83 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t63 * t79);
  t85 = t1 * (t55 + t83);
  t86 = t18 + 0.1e1;
  t87 = t86 <= p->zeta_threshold;
  t88 = t22 * t22;
  t89 = POW_1_3(t86);
  t90 = t89 * t89;
  t91 = my_piecewise3(t87, t88, t90);
  t92 = 0.1e1 - t18;
  t93 = t92 <= p->zeta_threshold;
  t94 = POW_1_3(t92);
  t95 = t94 * t94;
  t96 = my_piecewise3(t93, t88, t95);
  t98 = t91 / 0.2e1 + t96 / 0.2e1;
  t99 = t3 * t3;
  t100 = t98 * t99;
  t101 = t100 * t4;
  t102 = sqrt(sigma[0]);
  t103 = sqrt(sigma[2]);
  t104 = t102 + t103;
  t105 = t104 * t104;
  t106 = t7 * t7;
  t108 = 0.1e1 / t27 / t106;
  t109 = t105 * t108;
  t110 = t4 * t105;
  t111 = t110 * t108;
  t114 = 0.1e1 / M_PI;
  t115 = POW_1_3(t114);
  t116 = t3 * t115;
  t117 = M_CBRT4;
  t118 = t117 * t117;
  t121 = t116 * t118 / t27;
  t123 = 0.1e1 + 0.53425e-1 * t121;
  t124 = sqrt(t121);
  t127 = POW_3_2(t121);
  t129 = t115 * t115;
  t130 = t99 * t129;
  t131 = t27 * t27;
  t132 = 0.1e1 / t131;
  t134 = t130 * t117 * t132;
  t136 = 0.379785e1 * t124 + 0.8969e0 * t121 + 0.204775e0 * t127 + 0.123235e0 * t134;
  t139 = 0.1e1 + 0.16081979498692535067e2 / t136;
  t140 = log(t139);
  t142 = 0.621814e-1 * t123 * t140;
  t143 = t17 * t17;
  t144 = t143 * t143;
  t145 = t106 * t106;
  t146 = 0.1e1 / t145;
  t147 = t144 * t146;
  t148 = t89 * t86;
  t149 = my_piecewise3(t87, t23, t148);
  t150 = t94 * t92;
  t151 = my_piecewise3(t93, t23, t150);
  t152 = t149 + t151 - 0.2e1;
  t153 = M_CBRT2;
  t156 = 0.1e1 / (0.2e1 * t153 - 0.2e1);
  t157 = t152 * t156;
  t159 = 0.1e1 + 0.5137e-1 * t121;
  t164 = 0.705945e1 * t124 + 0.1549425e1 * t121 + 0.420775e0 * t127 + 0.1562925e0 * t134;
  t167 = 0.1e1 + 0.32163958997385070134e2 / t164;
  t168 = log(t167);
  t172 = 0.1e1 + 0.278125e-1 * t121;
  t177 = 0.51785e1 * t124 + 0.905775e0 * t121 + 0.1100325e0 * t127 + 0.1241775e0 * t134;
  t180 = 0.1e1 + 0.29608749977793437516e2 / t177;
  t181 = log(t180);
  t182 = t172 * t181;
  t184 = -0.310907e-1 * t159 * t168 + t142 - 0.19751673498613801407e-1 * t182;
  t185 = t157 * t184;
  t189 = -t142 + t147 * t185 + 0.19751673498613801407e-1 * t157 * t182;
  t191 = -t100 * t111 / 0.48e2 + params->gammac * t189;
  t192 = 0.1e1 / t191;
  t193 = t109 * t192;
  t195 = t101 * t193 / 0.48e2;
  t196 = cbspline(-t195, 0, params);
  t197 = t196 * t189;
  tzk0 = t85 + t197;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t198 = 0.1e1 / t106;
  t199 = t17 * t198;
  t200 = t8 - t199;
  t201 = my_piecewise5(t11, 0, t15, 0, t200);
  t204 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t201);
  t212 = t6 * t26 * t132 * t51 / 0.8e1;
  t213 = t6 * t26;
  t214 = xbspline(t50, 1, params);
  t215 = t27 * t214;
  t216 = t36 * rho[0];
  t218 = 0.1e1 / t38 / t216;
  t223 = params->gammax * params->gammax;
  t224 = t29 * t29;
  t225 = t223 * t224;
  t227 = 0.1e1 / t32 / t31;
  t228 = t225 * t227;
  t229 = sigma[0] * sigma[0];
  t230 = t36 * t36;
  t231 = t230 * t36;
  t233 = 0.1e1 / t37 / t231;
  t235 = t46 * t46;
  t236 = 0.1e1 / t235;
  t240 = -t35 * sigma[0] * t218 * t47 / 0.9e1 + t228 * t229 * t233 * t236 / 0.216e3;
  t241 = t215 * t240;
  t245 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t204 * t27 * t51 - t212 - 0.3e1 / 0.8e1 * t213 * t241);
  t246 = -t200;
  t247 = my_piecewise5(t15, 0, t11, 0, t246);
  t250 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t247);
  t258 = t6 * t62 * t132 * t79 / 0.8e1;
  t260 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t250 * t27 * t79 - t258);
  t262 = t1 * (t245 + t260);
  t263 = cbspline(-t195, 1, params);
  t264 = 0.1e1 / t89;
  t267 = my_piecewise3(t87, 0, 0.2e1 / 0.3e1 * t264 * t200);
  t268 = 0.1e1 / t94;
  t271 = my_piecewise3(t93, 0, 0.2e1 / 0.3e1 * t268 * t246);
  t273 = t267 / 0.2e1 + t271 / 0.2e1;
  t274 = t273 * t99;
  t275 = t274 * t4;
  t278 = t106 * t7;
  t280 = 0.1e1 / t27 / t278;
  t281 = t105 * t280;
  t282 = t281 * t192;
  t284 = 0.7e1 / 0.144e3 * t101 * t282;
  t285 = t191 * t191;
  t286 = 0.1e1 / t285;
  t289 = t110 * t280;
  t291 = 0.7e1 / 0.144e3 * t100 * t289;
  t293 = 0.1e1 / t27 / t7;
  t294 = t118 * t293;
  t297 = 0.11073470983333333333e-2 * t116 * t294 * t140;
  t298 = t136 * t136;
  t299 = 0.1e1 / t298;
  t300 = t123 * t299;
  t302 = 0.1e1 / t124 * t3;
  t303 = t115 * t118;
  t304 = t303 * t293;
  t305 = t302 * t304;
  t307 = t116 * t294;
  t309 = sqrt(t121);
  t310 = t309 * t3;
  t311 = t310 * t304;
  t314 = 0.1e1 / t131 / t7;
  t316 = t130 * t117 * t314;
  t318 = -0.632975e0 * t305 - 0.29896666666666666667e0 * t307 - 0.1023875e0 * t311 - 0.82156666666666666667e-1 * t316;
  t319 = 0.1e1 / t139;
  t320 = t318 * t319;
  t322 = 0.1e1 * t300 * t320;
  t323 = t143 * t17;
  t324 = t323 * t146;
  t326 = 0.4e1 * t324 * t185;
  t327 = t145 * t7;
  t328 = 0.1e1 / t327;
  t329 = t144 * t328;
  t331 = 0.4e1 * t329 * t185;
  t334 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t89 * t200);
  t337 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t246);
  t339 = (t334 + t337) * t156;
  t340 = t339 * t184;
  t345 = t164 * t164;
  t346 = 0.1e1 / t345;
  t347 = t159 * t346;
  t352 = -0.1176575e1 * t305 - 0.516475e0 * t307 - 0.2103875e0 * t311 - 0.104195e0 * t316;
  t353 = 0.1e1 / t167;
  t354 = t352 * t353;
  t360 = t177 * t177;
  t361 = 0.1e1 / t360;
  t362 = t172 * t361;
  t367 = -0.86308333333333333334e0 * t305 - 0.301925e0 * t307 - 0.5501625e-1 * t311 - 0.82785e-1 * t316;
  t368 = 0.1e1 / t180;
  t369 = t367 * t368;
  t372 = 0.53237641966666666666e-3 * t116 * t294 * t168 + 0.1e1 * t347 * t354 - t297 - t322 + 0.18311447306006545054e-3 * t116 * t294 * t181 + 0.5848223622634646207e0 * t362 * t369;
  t373 = t157 * t372;
  t374 = t147 * t373;
  t377 = t157 * t3;
  t379 = t303 * t293 * t181;
  t381 = 0.18311447306006545054e-3 * t377 * t379;
  t382 = t157 * t172;
  t384 = t361 * t367 * t368;
  t386 = 0.5848223622634646207e0 * t382 * t384;
  t387 = t297 + t322 + t326 - t331 + t147 * t340 + t374 + 0.19751673498613801407e-1 * t339 * t182 - t381 - t386;
  t389 = -t274 * t111 / 0.48e2 + t291 + params->gammac * t387;
  t390 = t286 * t389;
  t391 = t109 * t390;
  t394 = -t275 * t193 / 0.48e2 + t284 + t101 * t391 / 0.48e2;
  t395 = t263 * t394;
  t396 = t395 * t189;
  t397 = t196 * t387;
  tvrho0 = t85 + t197 + t7 * (t262 + t396 + t397);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t400 = -t8 - t199;
  t401 = my_piecewise5(t11, 0, t15, 0, t400);
  t404 = my_piecewise3(t21, 0, 0.4e1 / 0.3e1 * t24 * t401);
  t410 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t404 * t27 * t51 - t212);
  t411 = -t400;
  t412 = my_piecewise5(t15, 0, t11, 0, t411);
  t415 = my_piecewise3(t59, 0, 0.4e1 / 0.3e1 * t60 * t412);
  t420 = t6 * t62;
  t421 = xbspline(t78, 1, params);
  t422 = t27 * t421;
  t423 = t64 * rho[1];
  t425 = 0.1e1 / t66 / t423;
  t430 = sigma[2] * sigma[2];
  t431 = t64 * t64;
  t432 = t431 * t64;
  t434 = 0.1e1 / t65 / t432;
  t436 = t74 * t74;
  t437 = 0.1e1 / t436;
  t441 = -t35 * sigma[2] * t425 * t75 / 0.9e1 + t228 * t430 * t434 * t437 / 0.216e3;
  t442 = t422 * t441;
  t446 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t415 * t27 * t79 - t258 - 0.3e1 / 0.8e1 * t420 * t442);
  t448 = t1 * (t410 + t446);
  t451 = my_piecewise3(t87, 0, 0.2e1 / 0.3e1 * t264 * t400);
  t454 = my_piecewise3(t93, 0, 0.2e1 / 0.3e1 * t268 * t411);
  t456 = t451 / 0.2e1 + t454 / 0.2e1;
  t457 = t456 * t99;
  t458 = t457 * t4;
  t465 = my_piecewise3(t87, 0, 0.4e1 / 0.3e1 * t89 * t400);
  t468 = my_piecewise3(t93, 0, 0.4e1 / 0.3e1 * t94 * t411);
  t470 = (t465 + t468) * t156;
  t471 = t470 * t184;
  t475 = t297 + t322 - t326 - t331 + t147 * t471 + t374 + 0.19751673498613801407e-1 * t470 * t182 - t381 - t386;
  t477 = -t457 * t111 / 0.48e2 + t291 + params->gammac * t475;
  t478 = t286 * t477;
  t479 = t109 * t478;
  t482 = -t458 * t193 / 0.48e2 + t284 + t101 * t479 / 0.48e2;
  t483 = t263 * t482;
  t484 = t483 * t189;
  t485 = t196 * t475;
  tvrho1 = t85 + t197 + t7 * (t448 + t484 + t485);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t492 = t230 * rho[0];
  t494 = 0.1e1 / t37 / t492;
  t499 = t30 * t34 * t40 * t47 / 0.24e2 - t228 * sigma[0] * t494 * t236 / 0.576e3;
  t500 = t215 * t499;
  t503 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t213 * t500);
  t504 = t1 * t503;
  t505 = t104 * t108;
  t506 = 0.1e1 / t102;
  t507 = t192 * t506;
  t508 = t505 * t507;
  t511 = t98 * t98;
  t512 = t511 * t3;
  t513 = t4 * t4;
  t514 = t512 * t513;
  t515 = t105 * t104;
  t517 = 0.1e1 / t131 / t145;
  t518 = t515 * t517;
  t519 = t286 * t506;
  t520 = t518 * t519;
  t523 = -t101 * t508 / 0.48e2 - t514 * t520 / 0.768e3;
  t524 = t263 * t523;
  t525 = t524 * t189;
  tvsigma0 = t7 * (t504 + t525);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t531 = t431 * rho[1];
  t533 = 0.1e1 / t65 / t531;
  t538 = t30 * t34 * t68 * t75 / 0.24e2 - t228 * sigma[2] * t533 * t437 / 0.576e3;
  t539 = t422 * t538;
  t542 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t420 * t539);
  t543 = t1 * t542;
  t544 = 0.1e1 / t103;
  t545 = t192 * t544;
  t546 = t505 * t545;
  t549 = t286 * t544;
  t550 = t518 * t549;
  t553 = -t101 * t546 / 0.48e2 - t514 * t550 / 0.768e3;
  t554 = t263 * t553;
  t555 = t554 * t189;
  tvsigma2 = t7 * (t543 + t555);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t560 = t24 * t24;
  t561 = 0.1e1 / t560;
  t562 = t201 * t201;
  t565 = 0.1e1 / t278;
  t566 = t17 * t565;
  t568 = -0.2e1 * t198 + 0.2e1 * t566;
  t569 = my_piecewise5(t11, 0, t15, 0, t568);
  t573 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t561 * t562 + 0.4e1 / 0.3e1 * t24 * t569);
  t580 = t6 * t204 * t132 * t51;
  t582 = t6 * t204;
  t588 = t6 * t26 * t314 * t51 / 0.12e2;
  t589 = t132 * t214;
  t590 = t589 * t240;
  t591 = t213 * t590;
  t593 = xbspline(t50, 2, params);
  t594 = t27 * t593;
  t595 = t240 * t240;
  t596 = t594 * t595;
  t600 = 0.1e1 / t38 / t230;
  t605 = t230 * t216;
  t607 = 0.1e1 / t37 / t605;
  t613 = t31 * t31;
  t614 = 0.1e1 / t613;
  t615 = t223 * params->gammax * t614;
  t616 = t229 * sigma[0];
  t617 = t230 * t230;
  t618 = t617 * t36;
  t619 = 0.1e1 / t618;
  t622 = 0.1e1 / t235 / t46;
  t626 = 0.11e2 / 0.27e2 * t35 * sigma[0] * t600 * t47 - t228 * t229 * t607 * t236 / 0.24e2 + t615 * t616 * t619 * t622 / 0.162e3;
  t627 = t215 * t626;
  t631 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t573 * t27 * t51 - t580 / 0.4e1 - 0.3e1 / 0.4e1 * t582 * t241 + t588 - t591 / 0.4e1 - 0.3e1 / 0.8e1 * t213 * t596 - 0.3e1 / 0.8e1 * t213 * t627);
  t632 = t60 * t60;
  t633 = 0.1e1 / t632;
  t634 = t247 * t247;
  t637 = -t568;
  t638 = my_piecewise5(t15, 0, t11, 0, t637);
  t642 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t633 * t634 + 0.4e1 / 0.3e1 * t60 * t638);
  t649 = t6 * t250 * t132 * t79;
  t654 = t6 * t62 * t314 * t79 / 0.12e2;
  t656 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t642 * t27 * t79 - t649 / 0.4e1 + t654);
  t658 = t1 * (t631 + t656);
  t659 = cbspline(-t195, 2, params);
  t660 = t394 * t394;
  t661 = t659 * t660;
  t662 = t661 * t189;
  t663 = 0.1e1 / t148;
  t664 = t200 * t200;
  t670 = my_piecewise3(t87, 0, -0.2e1 / 0.9e1 * t663 * t664 + 0.2e1 / 0.3e1 * t264 * t568);
  t671 = 0.1e1 / t150;
  t672 = t246 * t246;
  t678 = my_piecewise3(t93, 0, -0.2e1 / 0.9e1 * t671 * t672 + 0.2e1 / 0.3e1 * t268 * t637);
  t680 = t670 / 0.2e1 + t678 / 0.2e1;
  t681 = t680 * t99;
  t682 = t681 * t4;
  t685 = t275 * t282;
  t690 = 0.1e1 / t27 / t145;
  t691 = t105 * t690;
  t692 = t691 * t192;
  t694 = 0.35e2 / 0.216e3 * t101 * t692;
  t695 = t281 * t390;
  t696 = t101 * t695;
  t699 = 0.1e1 / t285 / t191;
  t700 = t389 * t389;
  t701 = t699 * t700;
  t702 = t109 * t701;
  t707 = t274 * t289;
  t709 = t110 * t690;
  t711 = 0.35e2 / 0.216e3 * t100 * t709;
  t712 = t360 * t360;
  t713 = 0.1e1 / t712;
  t714 = t367 * t367;
  t715 = t713 * t714;
  t716 = t180 * t180;
  t717 = 0.1e1 / t716;
  t718 = t715 * t717;
  t720 = 0.17315859105681463759e2 * t382 * t718;
  t723 = 0.1e1 / t124 / t121 * t99;
  t724 = t129 * t117;
  t726 = 0.1e1 / t131 / t106;
  t727 = t724 * t726;
  t728 = t723 * t727;
  t730 = t303 * t108;
  t731 = t302 * t730;
  t733 = t118 * t108;
  t734 = t116 * t733;
  t736 = 0.1e1/sqrt(t121);
  t737 = t736 * t99;
  t738 = t737 * t727;
  t740 = t310 * t730;
  t743 = t130 * t117 * t726;
  t745 = -0.57538888888888888889e0 * t728 + 0.11507777777777777778e1 * t731 + 0.40256666666666666667e0 * t734 + 0.366775e-1 * t738 + 0.73355e-1 * t740 + 0.137975e0 * t743;
  t747 = t361 * t745 * t368;
  t749 = 0.5848223622634646207e0 * t382 * t747;
  t750 = t339 * t172;
  t751 = t750 * t384;
  t753 = t145 * t106;
  t754 = 0.1e1 / t753;
  t755 = t144 * t754;
  t757 = 0.2e2 * t755 * t185;
  t761 = t116 * t118;
  t762 = t293 * t346;
  t766 = t345 * t164;
  t767 = 0.1e1 / t766;
  t768 = t159 * t767;
  t769 = t352 * t352;
  t770 = t769 * t353;
  t779 = -0.78438333333333333333e0 * t728 + 0.15687666666666666667e1 * t731 + 0.68863333333333333333e0 * t734 + 0.14025833333333333333e0 * t738 + 0.28051666666666666667e0 * t740 + 0.17365833333333333333e0 * t743;
  t780 = t779 * t353;
  t783 = t345 * t345;
  t784 = 0.1e1 / t783;
  t785 = t159 * t784;
  t786 = t167 * t167;
  t787 = 0.1e1 / t786;
  t788 = t769 * t787;
  t793 = 0.14764627977777777777e-2 * t116 * t733 * t140;
  t794 = t293 * t299;
  t797 = 0.35616666666666666666e-1 * t761 * t794 * t320;
  t798 = t298 * t136;
  t799 = 0.1e1 / t798;
  t800 = t123 * t799;
  t801 = t318 * t318;
  t802 = t801 * t319;
  t804 = 0.2e1 * t800 * t802;
  t811 = -0.42198333333333333333e0 * t728 + 0.84396666666666666666e0 * t731 + 0.39862222222222222223e0 * t734 + 0.68258333333333333333e-1 * t738 + 0.13651666666666666667e0 * t740 + 0.13692777777777777778e0 * t743;
  t812 = t811 * t319;
  t814 = 0.1e1 * t300 * t812;
  t815 = t298 * t298;
  t816 = 0.1e1 / t815;
  t817 = t123 * t816;
  t818 = t139 * t139;
  t819 = 0.1e1 / t818;
  t820 = t801 * t819;
  t822 = 0.16081979498692535067e2 * t817 * t820;
  t826 = t293 * t361;
  t830 = t360 * t177;
  t831 = 0.1e1 / t830;
  t832 = t172 * t831;
  t833 = t714 * t368;
  t836 = t745 * t368;
  t839 = t172 * t713;
  t840 = t714 * t717;
  t843 = -0.70983522622222222221e-3 * t116 * t733 * t168 - 0.34246666666666666666e-1 * t761 * t762 * t354 - 0.2e1 * t768 * t770 + 0.1e1 * t347 * t780 + 0.32163958997385070134e2 * t785 * t788 + t793 + t797 + t804 - t814 - t822 - 0.24415263074675393405e-3 * t116 * t733 * t181 - 0.10843581300301739842e-1 * t761 * t826 * t369 - 0.11696447245269292414e1 * t832 * t833 + 0.5848223622634646207e0 * t362 * t836 + 0.17315859105681463759e2 * t839 * t840;
  t844 = t157 * t843;
  t845 = t147 * t844;
  t846 = 0.1e1 / t90;
  t852 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t846 * t664 + 0.4e1 / 0.3e1 * t89 * t568);
  t853 = 0.1e1 / t95;
  t859 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t853 * t672 + 0.4e1 / 0.3e1 * t94 * t637);
  t861 = (t852 + t859) * t156;
  t862 = t861 * t184;
  t864 = t339 * t372;
  t865 = t147 * t864;
  t867 = t329 * t340;
  t870 = 0.8e1 * t329 * t373;
  t871 = t324 * t340;
  t874 = 0.8e1 * t324 * t373;
  t875 = -t720 - t749 - 0.11696447245269292414e1 * t751 + t757 + t845 + t147 * t862 + 0.2e1 * t865 - 0.8e1 * t867 - t870 + 0.8e1 * t871 + t874;
  t876 = t143 * t146;
  t878 = 0.12e2 * t876 * t185;
  t879 = t323 * t328;
  t881 = 0.32e2 * t879 * t185;
  t885 = t303 * t108 * t181;
  t887 = 0.24415263074675393405e-3 * t377 * t885;
  t888 = t339 * t3;
  t889 = t888 * t379;
  t892 = t831 * t714 * t368;
  t894 = 0.11696447245269292414e1 * t382 * t892;
  t895 = t157 * t116;
  t896 = t294 * t384;
  t898 = 0.10843581300301739842e-1 * t895 * t896;
  t899 = -t804 + t878 - t881 - t793 + 0.19751673498613801407e-1 * t861 * t182 + t814 + t822 + t887 - 0.36622894612013090108e-3 * t889 + t894 - t797 + t898;
  t900 = t875 + t899;
  t902 = -t681 * t111 / 0.48e2 + 0.7e1 / 0.72e2 * t707 - t711 + params->gammac * t900;
  t903 = t286 * t902;
  t904 = t109 * t903;
  t907 = -t682 * t193 / 0.48e2 + 0.7e1 / 0.72e2 * t685 + t275 * t391 / 0.24e2 - t694 - 0.7e1 / 0.72e2 * t696 - t101 * t702 / 0.24e2 + t101 * t904 / 0.48e2;
  t908 = t263 * t907;
  t909 = t908 * t189;
  t910 = t395 * t387;
  t911 = 0.2e1 * t910;
  t912 = t196 * t900;
  tv2rho20 = 0.2e1 * t262 + 0.2e1 * t396 + 0.2e1 * t397 + t7 * (t658 + t662 + t909 + t911 + t912);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t915 = t561 * t401;
  t918 = 0.2e1 * t566;
  t919 = my_piecewise5(t11, 0, t15, 0, t918);
  t923 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t915 * t201 + 0.4e1 / 0.3e1 * t24 * t919);
  t930 = t6 * t404 * t132 * t51;
  t932 = t6 * t404;
  t938 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t923 * t27 * t51 - t930 / 0.8e1 - 0.3e1 / 0.8e1 * t932 * t241 - t580 / 0.8e1 + t588 - t591 / 0.8e1);
  t939 = t633 * t412;
  t942 = my_piecewise5(t15, 0, t11, 0, -t918);
  t946 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t939 * t247 + 0.4e1 / 0.3e1 * t60 * t942);
  t953 = t6 * t415 * t132 * t79;
  t956 = t6 * t250;
  t959 = t132 * t421;
  t960 = t959 * t441;
  t961 = t420 * t960;
  t964 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t946 * t27 * t79 - t953 / 0.8e1 - t649 / 0.8e1 + t654 - 0.3e1 / 0.8e1 * t956 * t442 - t961 / 0.8e1);
  t966 = t1 * (t938 + t964);
  t967 = t659 * t394;
  t968 = t482 * t189;
  t969 = t967 * t968;
  t970 = t663 * t400;
  t973 = t264 * t17;
  t977 = my_piecewise3(t87, 0, -0.2e1 / 0.9e1 * t970 * t200 + 0.4e1 / 0.3e1 * t973 * t565);
  t978 = t671 * t411;
  t981 = t268 * t17;
  t985 = my_piecewise3(t93, 0, -0.2e1 / 0.9e1 * t978 * t246 - 0.4e1 / 0.3e1 * t981 * t565);
  t987 = t977 / 0.2e1 + t985 / 0.2e1;
  t988 = t987 * t99;
  t989 = t988 * t4;
  t992 = t458 * t282;
  t1000 = t281 * t478;
  t1001 = t101 * t1000;
  t1003 = t100 * t110;
  t1004 = t108 * t699;
  t1005 = t477 * t389;
  t1006 = t1004 * t1005;
  t1011 = t457 * t289;
  t1014 = t470 * t3;
  t1015 = t1014 * t379;
  t1018 = t324 * t471;
  t1020 = t329 * t471;
  t1023 = -0.18311447306006545054e-3 * t1015 - t797 + t887 - 0.18311447306006545054e-3 * t889 + t898 + 0.4e1 * t1018 - 0.4e1 * t1020 - t720 - t749 - 0.5848223622634646207e0 * t751 - t804 + t814 + t822;
  t1024 = t846 * t400;
  t1027 = t89 * t17;
  t1031 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t1024 * t200 + 0.8e1 / 0.3e1 * t1027 * t565);
  t1032 = t853 * t411;
  t1035 = t94 * t17;
  t1039 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t1032 * t246 - 0.8e1 / 0.3e1 * t1035 * t565);
  t1041 = (t1031 + t1039) * t156;
  t1042 = t1041 * t184;
  t1044 = t470 * t372;
  t1045 = t147 * t1044;
  t1050 = t470 * t172;
  t1051 = t1050 * t384;
  t1053 = t147 * t1042 + t1045 + 0.19751673498613801407e-1 * t1041 * t182 - t878 - t870 - 0.4e1 * t871 + t865 - 0.4e1 * t867 - t793 + t757 + t845 - 0.5848223622634646207e0 * t1051 + t894;
  t1054 = t1023 + t1053;
  t1056 = -t988 * t111 / 0.48e2 + 0.7e1 / 0.144e3 * t1011 + 0.7e1 / 0.144e3 * t707 - t711 + params->gammac * t1054;
  t1057 = t286 * t1056;
  t1058 = t109 * t1057;
  t1061 = -t989 * t193 / 0.48e2 + 0.7e1 / 0.144e3 * t992 + t458 * t391 / 0.48e2 + 0.7e1 / 0.144e3 * t685 - t694 - 0.7e1 / 0.144e3 * t696 + t275 * t479 / 0.48e2 - 0.7e1 / 0.144e3 * t1001 - t1003 * t1006 / 0.24e2 + t101 * t1058 / 0.48e2;
  t1062 = t263 * t1061;
  t1063 = t1062 * t189;
  t1064 = t483 * t387;
  t1065 = t395 * t475;
  t1066 = t196 * t1054;
  tv2rho21 = t262 + t396 + t397 + t448 + t484 + t485 + t7 * (t966 + t969 + t1063 + t1064 + t1065 + t1066);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1072 = t401 * t401;
  t1076 = 0.2e1 * t198 + 0.2e1 * t566;
  t1077 = my_piecewise5(t11, 0, t15, 0, t1076);
  t1081 = my_piecewise3(t21, 0, 0.4e1 / 0.9e1 * t561 * t1072 + 0.4e1 / 0.3e1 * t24 * t1077);
  t1088 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t1081 * t27 * t51 - t930 / 0.4e1 + t588);
  t1089 = t412 * t412;
  t1092 = -t1076;
  t1093 = my_piecewise5(t15, 0, t11, 0, t1092);
  t1097 = my_piecewise3(t59, 0, 0.4e1 / 0.9e1 * t633 * t1089 + 0.4e1 / 0.3e1 * t60 * t1093);
  t1103 = t6 * t415;
  t1107 = xbspline(t78, 2, params);
  t1108 = t27 * t1107;
  t1109 = t441 * t441;
  t1110 = t1108 * t1109;
  t1114 = 0.1e1 / t66 / t431;
  t1119 = t431 * t423;
  t1121 = 0.1e1 / t65 / t1119;
  t1126 = t430 * sigma[2];
  t1127 = t431 * t431;
  t1128 = t1127 * t64;
  t1129 = 0.1e1 / t1128;
  t1132 = 0.1e1 / t436 / t74;
  t1136 = 0.11e2 / 0.27e2 * t35 * sigma[2] * t1114 * t75 - t228 * t430 * t1121 * t437 / 0.24e2 + t615 * t1126 * t1129 * t1132 / 0.162e3;
  t1137 = t422 * t1136;
  t1141 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t1097 * t27 * t79 - t953 / 0.4e1 - 0.3e1 / 0.4e1 * t1103 * t442 + t654 - t961 / 0.4e1 - 0.3e1 / 0.8e1 * t420 * t1110 - 0.3e1 / 0.8e1 * t420 * t1137);
  t1143 = t1 * (t1088 + t1141);
  t1144 = t482 * t482;
  t1145 = t659 * t1144;
  t1146 = t1145 * t189;
  t1147 = t400 * t400;
  t1153 = my_piecewise3(t87, 0, -0.2e1 / 0.9e1 * t663 * t1147 + 0.2e1 / 0.3e1 * t264 * t1076);
  t1154 = t411 * t411;
  t1160 = my_piecewise3(t93, 0, -0.2e1 / 0.9e1 * t671 * t1154 + 0.2e1 / 0.3e1 * t268 * t1092);
  t1162 = t1153 / 0.2e1 + t1160 / 0.2e1;
  t1163 = t1162 * t99;
  t1164 = t1163 * t4;
  t1171 = t477 * t477;
  t1172 = t699 * t1171;
  t1173 = t109 * t1172;
  t1184 = my_piecewise3(t87, 0, 0.4e1 / 0.9e1 * t846 * t1147 + 0.4e1 / 0.3e1 * t89 * t1076);
  t1190 = my_piecewise3(t93, 0, 0.4e1 / 0.9e1 * t853 * t1154 + 0.4e1 / 0.3e1 * t94 * t1092);
  t1192 = (t1184 + t1190) * t156;
  t1193 = t1192 * t184;
  t1201 = t147 * t1193 + 0.19751673498613801407e-1 * t1192 * t182 - 0.11696447245269292414e1 * t1051 + 0.2e1 * t1045 - 0.8e1 * t1018 - 0.8e1 * t1020 - t720 - t749 + t757 + t845 - t870;
  t1203 = -t874 - t804 + t878 + t881 - t793 + t814 + t822 + t887 - 0.36622894612013090108e-3 * t1015 + t894 - t797 + t898;
  t1204 = t1201 + t1203;
  t1206 = -t1163 * t111 / 0.48e2 + 0.7e1 / 0.72e2 * t1011 - t711 + params->gammac * t1204;
  t1207 = t286 * t1206;
  t1208 = t109 * t1207;
  t1211 = -t1164 * t193 / 0.48e2 + 0.7e1 / 0.72e2 * t992 + t458 * t479 / 0.24e2 - t694 - 0.7e1 / 0.72e2 * t1001 - t101 * t1173 / 0.24e2 + t101 * t1208 / 0.48e2;
  t1212 = t263 * t1211;
  t1213 = t1212 * t189;
  t1214 = t483 * t475;
  t1215 = 0.2e1 * t1214;
  t1216 = t196 * t1204;
  tv2rho22 = 0.2e1 * t448 + 0.2e1 * t484 + 0.2e1 * t485 + t7 * (t1143 + t1146 + t1213 + t1215 + t1216);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1221 = t589 * t499;
  t1223 = t213 * t1221 / 0.8e1;
  t1224 = t240 * t499;
  t1225 = t594 * t1224;
  t1236 = t617 * rho[0];
  t1237 = 0.1e1 / t1236;
  t1242 = -t30 * t34 * t218 * t47 / 0.9e1 + t228 * t233 * t236 * sigma[0] / 0.72e2 - t615 * t229 * t1237 * t622 / 0.432e3;
  t1243 = t215 * t1242;
  t1247 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t582 * t500 - t1223 - 0.3e1 / 0.8e1 * t213 * t1225 - 0.3e1 / 0.8e1 * t213 * t1243);
  t1248 = t1 * t1247;
  t1249 = t523 * t189;
  t1250 = t967 * t1249;
  t1253 = t104 * t280;
  t1254 = t1253 * t507;
  t1256 = 0.7e1 / 0.144e3 * t101 * t1254;
  t1257 = t4 * t104;
  t1258 = t100 * t1257;
  t1259 = t108 * t286;
  t1260 = t506 * t389;
  t1261 = t1259 * t1260;
  t1264 = t98 * t3;
  t1265 = t513 * t515;
  t1266 = t1264 * t1265;
  t1267 = t517 * t286;
  t1268 = t506 * t273;
  t1273 = 0.1e1 / t131 / t327;
  t1274 = t515 * t1273;
  t1275 = t1274 * t519;
  t1277 = 0.7e1 / 0.1152e4 * t514 * t1275;
  t1278 = t512 * t1265;
  t1279 = t517 * t699;
  t1280 = t1279 * t1260;
  t1283 = -t275 * t508 / 0.48e2 + t1256 + t1258 * t1261 / 0.48e2 - t1266 * t1267 * t1268 / 0.384e3 + t1277 + t1278 * t1280 / 0.384e3;
  t1284 = t263 * t1283;
  t1285 = t1284 * t189;
  t1286 = t524 * t387;
  tv2rhosigma0 = t504 + t525 + t7 * (t1248 + t1250 + t1285 + t1286);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1291 = t959 * t538;
  t1293 = t420 * t1291 / 0.8e1;
  t1295 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t956 * t539 - t1293);
  t1296 = t1 * t1295;
  t1297 = t553 * t189;
  t1298 = t967 * t1297;
  t1301 = t1253 * t545;
  t1303 = 0.7e1 / 0.144e3 * t101 * t1301;
  t1304 = t544 * t389;
  t1305 = t1259 * t1304;
  t1308 = t544 * t273;
  t1312 = t1274 * t549;
  t1314 = 0.7e1 / 0.1152e4 * t514 * t1312;
  t1315 = t1279 * t1304;
  t1318 = -t275 * t546 / 0.48e2 + t1303 + t1258 * t1305 / 0.48e2 - t1266 * t1267 * t1308 / 0.384e3 + t1314 + t1278 * t1315 / 0.384e3;
  t1319 = t263 * t1318;
  t1320 = t1319 * t189;
  t1321 = t554 * t387;
  tv2rhosigma2 = t543 + t555 + t7 * (t1296 + t1298 + t1320 + t1321);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1327 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t932 * t500 - t1223);
  t1328 = t1 * t1327;
  t1329 = t659 * t482;
  t1330 = t1329 * t1249;
  t1333 = t506 * t477;
  t1334 = t1259 * t1333;
  t1337 = t506 * t456;
  t1338 = t1267 * t1337;
  t1341 = t1279 * t1333;
  t1344 = -t458 * t508 / 0.48e2 + t1256 + t1258 * t1334 / 0.48e2 - t1266 * t1338 / 0.384e3 + t1277 + t1278 * t1341 / 0.384e3;
  t1345 = t263 * t1344;
  t1346 = t1345 * t189;
  t1347 = t524 * t475;
  tv2rhosigma3 = t504 + t525 + t7 * (t1328 + t1330 + t1346 + t1347);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1352 = t441 * t538;
  t1353 = t1108 * t1352;
  t1364 = t1127 * rho[1];
  t1365 = 0.1e1 / t1364;
  t1370 = -t30 * t34 * t425 * t75 / 0.9e1 + t228 * t434 * t437 * sigma[2] / 0.72e2 - t615 * t430 * t1365 * t1132 / 0.432e3;
  t1371 = t422 * t1370;
  t1375 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t1103 * t539 - t1293 - 0.3e1 / 0.8e1 * t420 * t1353 - 0.3e1 / 0.8e1 * t420 * t1371);
  t1376 = t1 * t1375;
  t1377 = t1329 * t1297;
  t1380 = t544 * t477;
  t1381 = t1259 * t1380;
  t1384 = t544 * t456;
  t1385 = t1267 * t1384;
  t1388 = t1279 * t1380;
  t1391 = -t458 * t546 / 0.48e2 + t1303 + t1258 * t1381 / 0.48e2 - t1266 * t1385 / 0.384e3 + t1314 + t1278 * t1388 / 0.384e3;
  t1392 = t263 * t1391;
  t1393 = t1392 * t189;
  t1394 = t554 * t475;
  tv2rhosigma5 = t543 + t555 + t7 * (t1376 + t1377 + t1393 + t1394);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1397 = t499 * t499;
  t1398 = t594 * t1397;
  t1404 = 0.1e1 / t617;
  t1409 = -t225 * t227 * t494 * t236 / 0.288e3 + t615 * sigma[0] * t1404 * t622 / 0.1152e4;
  t1410 = t215 * t1409;
  t1414 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t213 * t1398 - 0.3e1 / 0.8e1 * t213 * t1410);
  t1415 = t1 * t1414;
  t1416 = t523 * t523;
  t1417 = t659 * t1416;
  t1418 = t1417 * t189;
  t1419 = 0.1e1 / sigma[0];
  t1420 = t1419 * t108;
  t1421 = t1420 * t192;
  t1424 = t105 * t517;
  t1425 = t286 * t1419;
  t1426 = t1424 * t1425;
  t1430 = 0.1e1 / t102 / sigma[0];
  t1431 = t192 * t1430;
  t1432 = t505 * t1431;
  t1435 = t511 * t98;
  t1436 = t1435 * M_PI;
  t1437 = t105 * t105;
  t1438 = t1436 * t1437;
  t1439 = t145 * t278;
  t1440 = 0.1e1 / t1439;
  t1441 = t1440 * t699;
  t1445 = t286 * t1430;
  t1446 = t518 * t1445;
  t1449 = -t101 * t1421 / 0.96e2 - 0.5e1 / 0.1536e4 * t514 * t1426 + t101 * t1432 / 0.96e2 - t1438 * t1441 * t1419 / 0.6144e4 + t514 * t1446 / 0.1536e4;
  t1450 = t263 * t1449;
  t1451 = t1450 * t189;
  tv2sigma20 = t7 * (t1415 + t1418 + t1451);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  t1453 = t659 * t523;
  t1454 = t1453 * t1297;
  t1455 = t506 * t108;
  t1456 = t1455 * t545;
  t1459 = t513 * t105;
  t1460 = t512 * t1459;
  t1461 = t544 * t506;
  t1462 = t1267 * t1461;
  t1468 = -t101 * t1456 / 0.96e2 - 0.5e1 / 0.1536e4 * t1460 * t1462 - t1438 * t1441 * t1461 / 0.6144e4;
  t1469 = t263 * t1468;
  t1470 = t1469 * t189;
  tv2sigma22 = t7 * (t1454 + t1470);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1472 = t538 * t538;
  t1473 = t1108 * t1472;
  t1479 = 0.1e1 / t1127;
  t1484 = -t225 * t227 * t533 * t437 / 0.288e3 + t615 * sigma[2] * t1479 * t1132 / 0.1152e4;
  t1485 = t422 * t1484;
  t1489 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t420 * t1473 - 0.3e1 / 0.8e1 * t420 * t1485);
  t1490 = t1 * t1489;
  t1491 = t553 * t553;
  t1492 = t659 * t1491;
  t1493 = t1492 * t189;
  t1494 = 0.1e1 / sigma[2];
  t1495 = t1494 * t108;
  t1496 = t1495 * t192;
  t1499 = t286 * t1494;
  t1500 = t1424 * t1499;
  t1504 = 0.1e1 / t103 / sigma[2];
  t1505 = t192 * t1504;
  t1506 = t505 * t1505;
  t1512 = t286 * t1504;
  t1513 = t518 * t1512;
  t1516 = -t101 * t1496 / 0.96e2 - 0.5e1 / 0.1536e4 * t514 * t1500 + t101 * t1506 / 0.96e2 - t1438 * t1441 * t1494 / 0.6144e4 + t514 * t1513 / 0.1536e4;
  t1517 = t263 * t1516;
  t1518 = t1517 * t189;
  tv2sigma25 = t7 * (t1490 + t1493 + t1518);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1526 = 0.1e1 / t560 / t20;
  t1527 = t562 * t201;
  t1530 = t561 * t201;
  t1533 = t17 * t146;
  t1535 = 0.6e1 * t565 - 0.6e1 * t1533;
  t1536 = my_piecewise5(t11, 0, t15, 0, t1535);
  t1540 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1526 * t1527 + 0.4e1 / 0.3e1 * t1530 * t569 + 0.4e1 / 0.3e1 * t24 * t1536);
  t1548 = 0.5e1 / 0.36e2 * t6 * t26 * t726 * t51;
  t1549 = t314 * t214;
  t1550 = t1549 * t240;
  t1551 = t213 * t1550;
  t1553 = t589 * t626;
  t1554 = t213 * t1553;
  t1557 = 0.1e1 / t38 / t492;
  t1563 = 0.1e1 / t37 / t617;
  t1568 = t617 * t216;
  t1569 = 0.1e1 / t1568;
  t1574 = t223 * t223;
  t1575 = t1574 * t614;
  t1576 = t229 * t229;
  t1577 = t1575 * t1576;
  t1578 = t617 * t492;
  t1580 = 0.1e1 / t38 / t1578;
  t1581 = t235 * t235;
  t1582 = 0.1e1 / t1581;
  t1584 = t29 * t34;
  t1588 = -0.154e3 / 0.81e2 * t35 * sigma[0] * t1557 * t47 + 0.341e3 / 0.972e3 * t228 * t229 * t1563 * t236 - 0.19e2 / 0.162e3 * t615 * t616 * t1569 * t622 + t1577 * t1580 * t1582 * t1584 / 0.486e3;
  t1589 = t215 * t1588;
  t1594 = t6 * t573 * t132 * t51;
  t1596 = t6 * t573;
  t1601 = t6 * t204 * t314 * t51;
  t1603 = t582 * t590;
  t1607 = t132 * t593;
  t1608 = t1607 * t595;
  t1609 = t213 * t1608;
  t1611 = t240 * t626;
  t1612 = t594 * t1611;
  t1615 = xbspline(t50, 3, params);
  t1616 = t27 * t1615;
  t1617 = t595 * t240;
  t1618 = t1616 * t1617;
  t1623 = -0.3e1 / 0.8e1 * t6 * t1540 * t27 * t51 - t1548 + t1551 / 0.4e1 - 0.3e1 / 0.8e1 * t1554 - 0.3e1 / 0.8e1 * t213 * t1589 - 0.3e1 / 0.8e1 * t1594 - 0.9e1 / 0.8e1 * t1596 * t241 + t1601 / 0.4e1 - 0.3e1 / 0.4e1 * t1603 - 0.9e1 / 0.8e1 * t582 * t627 - 0.3e1 / 0.8e1 * t1609 - 0.9e1 / 0.8e1 * t213 * t1612 - 0.3e1 / 0.8e1 * t213 * t1618 - 0.9e1 / 0.8e1 * t582 * t596;
  t1624 = my_piecewise3(t2, 0, t1623);
  t1626 = 0.1e1 / t632 / t58;
  t1627 = t634 * t247;
  t1630 = t633 * t247;
  t1633 = -t1535;
  t1634 = my_piecewise5(t15, 0, t11, 0, t1633);
  t1638 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t1626 * t1627 + 0.4e1 / 0.3e1 * t1630 * t638 + 0.4e1 / 0.3e1 * t60 * t1634);
  t1645 = t6 * t642 * t132 * t79;
  t1649 = t6 * t250 * t314 * t79;
  t1654 = 0.5e1 / 0.36e2 * t6 * t62 * t726 * t79;
  t1656 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t1638 * t27 * t79 - 0.3e1 / 0.8e1 * t1645 + t1649 / 0.4e1 - t1654);
  t1658 = t1 * (t1624 + t1656);
  t1659 = cbspline(-t195, 3, params);
  t1660 = t660 * t394;
  t1661 = t1659 * t1660;
  t1662 = t1661 * t189;
  t1663 = t189 * t907;
  t1664 = t967 * t1663;
  t1665 = 0.3e1 * t1664;
  t1666 = t661 * t387;
  t1667 = 0.3e1 * t1666;
  t1668 = t86 * t86;
  t1670 = 0.1e1 / t89 / t1668;
  t1671 = t664 * t200;
  t1674 = t663 * t200;
  t1680 = my_piecewise3(t87, 0, 0.8e1 / 0.27e2 * t1670 * t1671 - 0.2e1 / 0.3e1 * t1674 * t568 + 0.2e1 / 0.3e1 * t264 * t1535);
  t1681 = t92 * t92;
  t1683 = 0.1e1 / t94 / t1681;
  t1684 = t672 * t246;
  t1687 = t671 * t246;
  t1693 = my_piecewise3(t93, 0, 0.8e1 / 0.27e2 * t1683 * t1684 - 0.2e1 / 0.3e1 * t1687 * t637 + 0.2e1 / 0.3e1 * t268 * t1633);
  t1695 = t1680 / 0.2e1 + t1693 / 0.2e1;
  t1696 = t1695 * t99;
  t1699 = t681 * t289;
  t1701 = t274 * t709;
  t1704 = 0.1e1 / t27 / t327;
  t1705 = t110 * t1704;
  t1707 = 0.455e3 / 0.648e3 * t100 * t1705;
  t1708 = t861 * t3;
  t1709 = t1708 * t379;
  t1712 = t831 * t745 * t369;
  t1714 = 0.35089341735807877242e1 * t382 * t1712;
  t1716 = t717 * t745;
  t1717 = t713 * t367 * t1716;
  t1719 = 0.51947577317044391277e2 * t382 * t1717;
  t1721 = t303 * t280 * t181;
  t1723 = 0.56968947174242584612e-3 * t377 * t1721;
  t1724 = t801 * t318;
  t1725 = t1724 * t319;
  t1727 = 0.6e1 * t817 * t1725;
  t1731 = 0.1e1 / t124 / t134 * t114 / 0.4e1;
  t1732 = t1731 * t146;
  t1735 = 0.1e1 / t131 / t278;
  t1736 = t724 * t1735;
  t1737 = t723 * t1736;
  t1739 = t303 * t280;
  t1740 = t302 * t1739;
  t1742 = t118 * t280;
  t1743 = t116 * t1742;
  t1745 = 0.1e1/POW_3_2(t121);
  t1746 = t1745 * t114;
  t1747 = t1746 * t146;
  t1749 = t737 * t1736;
  t1751 = t310 * t1739;
  t1754 = t130 * t117 * t1735;
  t1756 = -0.25319e1 * t1732 + 0.16879333333333333333e1 * t1737 - 0.19692555555555555555e1 * t1740 - 0.93011851851851851854e0 * t1743 + 0.13651666666666666667e0 * t1747 - 0.27303333333333333333e0 * t1749 - 0.3185388888888888889e0 * t1751 - 0.36514074074074074075e0 * t1754;
  t1757 = t1756 * t319;
  t1759 = 0.1e1 * t300 * t1757;
  t1761 = 0.1e1 / t815 / t298;
  t1762 = t123 * t1761;
  t1764 = 0.1e1 / t818 / t139;
  t1765 = t1724 * t1764;
  t1767 = 0.51726012919273400301e3 * t1762 * t1765;
  t1769 = 0.1e1 / t815 / t136;
  t1770 = t123 * t1769;
  t1771 = t1724 * t819;
  t1773 = 0.96491876992155210402e2 * t1770 * t1771;
  t1775 = 0.1e1 / t90 / t86;
  t1778 = t846 * t200;
  t1784 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t1775 * t1671 + 0.4e1 / 0.3e1 * t1778 * t568 + 0.4e1 / 0.3e1 * t89 * t1535);
  t1786 = 0.1e1 / t95 / t92;
  t1789 = t853 * t246;
  t1795 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1786 * t1684 + 0.4e1 / 0.3e1 * t1789 * t637 + 0.4e1 / 0.3e1 * t94 * t1633);
  t1797 = (t1784 + t1795) * t156;
  t1800 = t879 * t373;
  t1801 = 0.96e2 * t1800;
  t1802 = t879 * t340;
  t1804 = t1797 * t184;
  t1806 = -0.54934341918019635162e-3 * t1709 + t1714 - t1719 - t1723 + t1727 + t1759 + t1767 - t1773 + 0.19751673498613801407e-1 * t1797 * t182 - t1801 - 0.96e2 * t1802 + t147 * t1804;
  t1807 = t714 * t367;
  t1809 = t713 * t1807 * t368;
  t1811 = 0.35089341735807877242e1 * t382 * t1809;
  t1812 = t339 * t116;
  t1813 = t1812 * t896;
  t1815 = t733 * t384;
  t1817 = 0.21687162600603479684e-1 * t895 * t1815;
  t1818 = t294 * t892;
  t1820 = 0.32530743900905219526e-1 * t895 * t1818;
  t1821 = t294 * t718;
  t1823 = 0.48159733137676571078e0 * t895 * t1821;
  t1824 = t294 * t747;
  t1826 = 0.16265371950452609763e-1 * t895 * t1824;
  t1835 = -0.34523333333333333333e1 * t1732 + 0.23015555555555555556e1 * t1737 - 0.26851481481481481482e1 * t1740 - 0.93932222222222222223e0 * t1743 + 0.73355e-1 * t1747 - 0.14671e0 * t1749 - 0.17116166666666666667e0 * t1751 - 0.36793333333333333333e0 * t1754;
  t1837 = t361 * t1835 * t368;
  t1839 = 0.5848223622634646207e0 * t382 * t1837;
  t1841 = 0.1e1 / t712 / t360;
  t1844 = 0.1e1 / t716 / t180;
  t1845 = t1841 * t1807 * t1844;
  t1847 = 0.10254018858216406658e4 * t382 * t1845;
  t1848 = t750 * t747;
  t1850 = t750 * t718;
  t1852 = t861 * t172;
  t1853 = t1852 * t384;
  t1856 = 0.24e2 * t1533 * t185;
  t1857 = t143 * t328;
  t1858 = t1857 * t185;
  t1859 = 0.144e3 * t1858;
  t1860 = -t1811 + 0.32530743900905219526e-1 * t1813 - t1817 - t1820 + t1823 + t1826 - t1839 - t1847 - 0.17544670867903938621e1 * t1848 - 0.51947577317044391276e2 * t1850 - 0.17544670867903938621e1 * t1853 + t1856 - t1859;
  t1862 = t888 * t885;
  t1864 = t293 * t816;
  t1867 = 0.85917975471764868594e0 * t761 * t1864 * t820;
  t1868 = t108 * t299;
  t1871 = 0.71233333333333333332e-1 * t761 * t1868 * t320;
  t1874 = 0.53424999999999999999e-1 * t761 * t794 * t812;
  t1878 = 0.10685e0 * t761 * t293 * t799 * t802;
  t1879 = t876 * t373;
  t1880 = 0.36e2 * t1879;
  t1881 = t876 * t340;
  t1883 = t861 * t372;
  t1884 = t147 * t1883;
  t1886 = t811 * t819;
  t1889 = 0.48245938496077605201e2 * t817 * t1886 * t318;
  t1892 = 0.6e1 * t800 * t320 * t811;
  t1893 = t324 * t864;
  t1895 = t750 * t892;
  t1897 = 0.73245789224026180216e-3 * t1862 - t1867 + t1871 - t1874 + t1878 + t1880 + 0.36e2 * t1881 + 0.3e1 * t1884 + t1889 - t1892 + 0.24e2 * t1893 + 0.35089341735807877242e1 * t1895;
  t1899 = 0.1e1 / t712 / t177;
  t1901 = t1899 * t1807 * t717;
  t1903 = 0.10389515463408878255e3 * t382 * t1901;
  t1904 = t329 * t864;
  t1906 = t324 * t862;
  t1908 = t329 * t862;
  t1912 = 0.34450798614814814813e-2 * t116 * t1742 * t140;
  t1914 = 0.12e2 * t329 * t844;
  t1915 = t323 * t754;
  t1916 = t1915 * t185;
  t1917 = 0.24e3 * t1916;
  t1918 = t144 * t1440;
  t1920 = 0.12e3 * t1918 * t185;
  t1921 = t324 * t844;
  t1922 = 0.12e2 * t1921;
  t1923 = t755 * t340;
  t1926 = 0.6e2 * t755 * t373;
  t1927 = t339 * t843;
  t1928 = t147 * t1927;
  t1931 = 0.1e1 / t783 / t164;
  t1932 = t159 * t1931;
  t1933 = t769 * t352;
  t1934 = t1933 * t787;
  t1945 = -0.47063e1 * t1732 + 0.31375333333333333334e1 * t1737 - 0.36604555555555555556e1 * t1740 - 0.16068111111111111111e1 * t1743 + 0.28051666666666666666e0 * t1747 - 0.56103333333333333332e0 * t1749 - 0.6545388888888888889e0 * t1751 - 0.46308888888888888888e0 * t1754;
  t1946 = t1945 * t353;
  t1950 = 0.1e1 / t783 / t345;
  t1951 = t159 * t1950;
  t1953 = 0.1e1 / t786 / t167;
  t1954 = t1933 * t1953;
  t1957 = t172 * t1899;
  t1958 = t1807 * t717;
  t1961 = t1835 * t368;
  t1964 = t1807 * t368;
  t1967 = t172 * t1841;
  t1968 = t1807 * t1844;
  t1971 = t369 * t745;
  t1974 = t108 * t361;
  t1981 = t293 * t713;
  t1985 = -t1727 - 0.19298375398431042081e3 * t1932 * t1934 + 0.1e1 * t347 * t1946 - t1759 - t1767 + 0.2069040516770936012e4 * t1951 * t1954 - 0.10389515463408878255e3 * t1957 * t1958 + 0.5848223622634646207e0 * t362 * t1961 + t1773 + 0.35089341735807877242e1 * t839 * t1964 + 0.10254018858216406658e4 * t1967 * t1968 - 0.35089341735807877242e1 * t832 * t1971 + 0.21687162600603479684e-1 * t761 * t1974 * t369 - 0.16265371950452609763e-1 * t761 * t826 * t836 - 0.48159733137676571078e0 * t761 * t1981 * t840 + t1867;
  t1986 = t108 * t346;
  t1993 = t293 * t784;
  t1997 = t293 * t831;
  t2008 = t1933 * t353;
  t2011 = t1716 * t367;
  t2014 = t779 * t787;
  t2024 = -t1871 + t1874 + 0.68493333333333333332e-1 * t761 * t1986 * t354 - 0.51369999999999999999e-1 * t761 * t762 * t780 - 0.16522625736956710527e1 * t761 * t1993 * t788 + 0.32530743900905219526e-1 * t761 * t1997 * t833 + 0.10274e0 * t761 * t293 * t767 * t770 - t1878 - t1889 + t1892 + 0.56968947174242584612e-3 * t116 * t1742 * t181 - t1912 + 0.6e1 * t785 * t2008 + 0.51947577317044391277e2 * t839 * t2011 + 0.96491876992155210402e2 * t785 * t2014 * t352 - 0.6e1 * t768 * t354 * t779 + 0.16562821945185185185e-2 * t116 * t1742 * t168;
  t2025 = t1985 + t2024;
  t2026 = t157 * t2025;
  t2027 = t147 * t2026;
  t2028 = t1903 - 0.24e2 * t1904 + 0.12e2 * t1906 - 0.12e2 * t1908 + t1912 - t1914 + t1917 - t1920 + t1922 + 0.6e2 * t1923 + t1926 + 0.3e1 * t1928 + t2027;
  t2030 = t1806 + t1860 + t1897 + t2028;
  t2032 = -t1696 * t111 / 0.48e2 + 0.7e1 / 0.48e2 * t1699 - 0.35e2 / 0.72e2 * t1701 + t1707 + params->gammac * t2030;
  t2033 = t286 * t2032;
  t2034 = t109 * t2033;
  t2037 = t281 * t903;
  t2038 = t101 * t2037;
  t2040 = t105 * t1704;
  t2041 = t2040 * t192;
  t2043 = 0.455e3 / 0.648e3 * t101 * t2041;
  t2044 = t691 * t390;
  t2045 = t101 * t2044;
  t2047 = t1696 * t4;
  t2050 = t682 * t282;
  t2054 = t275 * t692;
  t2056 = t275 * t695;
  t2060 = t285 * t285;
  t2061 = 0.1e1 / t2060;
  t2062 = t700 * t389;
  t2063 = t2061 * t2062;
  t2064 = t109 * t2063;
  t2067 = t389 * t902;
  t2068 = t1004 * t2067;
  t2071 = t281 * t701;
  t2072 = t101 * t2071;
  t2076 = t101 * t2034 / 0.48e2 - 0.7e1 / 0.48e2 * t2038 + t2043 + 0.35e2 / 0.72e2 * t2045 - t2047 * t193 / 0.48e2 + 0.7e1 / 0.48e2 * t2050 + t682 * t391 / 0.16e2 - 0.35e2 / 0.72e2 * t2054 - 0.7e1 / 0.24e2 * t2056 + t275 * t904 / 0.16e2 + t101 * t2064 / 0.8e1 - t1003 * t2068 / 0.8e1 + 0.7e1 / 0.24e2 * t2072 - t275 * t702 / 0.8e1;
  t2077 = t263 * t2076;
  t2078 = t2077 * t189;
  t2079 = t908 * t387;
  t2080 = 0.3e1 * t2079;
  t2081 = t395 * t900;
  t2082 = 0.3e1 * t2081;
  t2083 = t196 * t2030;
  tv3rho30 = 0.3e1 * t658 + 0.3e1 * t662 + 0.3e1 * t909 + 0.6e1 * t910 + 0.3e1 * t912 + t7 * (t1658 + t1662 + t1665 + t1667 + t2078 + t2080 + t2082 + t2083);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t2086 = 0.2e1 * t966;
  t2087 = 0.2e1 * t969;
  t2088 = 0.2e1 * t1063;
  t2089 = 0.2e1 * t1064;
  t2090 = 0.2e1 * t1065;
  t2091 = 0.2e1 * t1066;
  t2092 = t1526 * t401;
  t2095 = t561 * t919;
  t2100 = 0.2e1 * t565;
  t2101 = 0.6e1 * t1533;
  t2102 = t2100 - t2101;
  t2103 = my_piecewise5(t11, 0, t15, 0, t2102);
  t2107 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t2092 * t562 + 0.8e1 / 0.9e1 * t2095 * t201 + 0.4e1 / 0.9e1 * t915 * t569 + 0.4e1 / 0.3e1 * t24 * t2103);
  t2115 = t6 * t923 * t132 * t51 / 0.4e1;
  t2116 = t6 * t923;
  t2121 = t6 * t404 * t314 * t51;
  t2124 = t932 * t590 / 0.4e1;
  t2135 = -0.3e1 / 0.8e1 * t6 * t2107 * t27 * t51 - t2115 - 0.3e1 / 0.4e1 * t2116 * t241 + t2121 / 0.12e2 - t2124 - 0.3e1 / 0.8e1 * t932 * t596 - 0.3e1 / 0.8e1 * t932 * t627 - t1594 / 0.8e1 + t1601 / 0.6e1 - t1603 / 0.4e1 - t1548 + t1551 / 0.6e1 - t1609 / 0.8e1 - t1554 / 0.8e1;
  t2136 = my_piecewise3(t2, 0, t2135);
  t2137 = t1626 * t412;
  t2140 = t633 * t942;
  t2146 = my_piecewise5(t15, 0, t11, 0, -t2102);
  t2150 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t2137 * t634 + 0.8e1 / 0.9e1 * t2140 * t247 + 0.4e1 / 0.9e1 * t939 * t638 + 0.4e1 / 0.3e1 * t60 * t2146);
  t2158 = t6 * t946 * t132 * t79 / 0.4e1;
  t2161 = t6 * t415 * t314 * t79;
  t2165 = t6 * t642;
  t2169 = t956 * t960 / 0.4e1;
  t2170 = t314 * t421;
  t2171 = t2170 * t441;
  t2172 = t420 * t2171;
  t2175 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t2150 * t27 * t79 - t2158 + t2161 / 0.12e2 - t1645 / 0.8e1 + t1649 / 0.6e1 - t1654 - 0.3e1 / 0.8e1 * t2165 * t442 - t2169 + t2172 / 0.12e2);
  t2177 = t1 * (t2136 + t2175);
  t2178 = t1659 * t660;
  t2179 = t2178 * t968;
  t2180 = t659 * t907;
  t2181 = t2180 * t968;
  t2182 = t1061 * t189;
  t2183 = t967 * t2182;
  t2185 = t482 * t387;
  t2186 = t967 * t2185;
  t2189 = t458 * t692;
  t2193 = t691 * t478;
  t2194 = t101 * t2193;
  t2199 = t1670 * t400;
  t2202 = t663 * t17;
  t2203 = t565 * t200;
  t2213 = my_piecewise3(t87, 0, 0.8e1 / 0.27e2 * t2199 * t664 - 0.8e1 / 0.9e1 * t2202 * t2203 - 0.2e1 / 0.9e1 * t970 * t568 + 0.4e1 / 0.3e1 * t264 * t565 - 0.4e1 * t973 * t146);
  t2214 = t1683 * t411;
  t2217 = t671 * t17;
  t2218 = t565 * t246;
  t2228 = my_piecewise3(t93, 0, 0.8e1 / 0.27e2 * t2214 * t672 + 0.8e1 / 0.9e1 * t2217 * t2218 - 0.2e1 / 0.9e1 * t978 * t637 - 0.4e1 / 0.3e1 * t268 * t565 + 0.4e1 * t981 * t146);
  t2230 = t2213 / 0.2e1 + t2228 / 0.2e1;
  t2231 = t2230 * t99;
  t2232 = t2231 * t4;
  t2239 = -0.7e1 / 0.144e3 * t2038 - 0.35e2 / 0.216e3 * t2189 + t2043 + t458 * t904 / 0.48e2 + 0.35e2 / 0.216e3 * t2194 + 0.7e1 / 0.72e2 * t2072 + 0.35e2 / 0.108e3 * t2045 - 0.7e1 / 0.72e2 * t2056 - t2232 * t193 / 0.48e2 + 0.7e1 / 0.144e3 * t2050 - 0.35e2 / 0.108e3 * t2054 + t275 * t1058 / 0.24e2;
  t2243 = 0.7e1 / 0.72e2 * t458 * t695;
  t2245 = 0.7e1 / 0.72e2 * t989 * t282;
  t2249 = 0.7e1 / 0.72e2 * t988 * t289;
  t2250 = t457 * t709;
  t2255 = 0.32e2 * t1800;
  t2256 = t1050 * t747;
  t2258 = t1050 * t892;
  t2260 = t1041 * t372;
  t2262 = 0.2e1 * t147 * t2260;
  t2263 = t1775 * t400;
  t2266 = t846 * t17;
  t2276 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t2263 * t664 + 0.16e2 / 0.9e1 * t2266 * t2203 + 0.4e1 / 0.9e1 * t1024 * t568 + 0.8e1 / 0.3e1 * t89 * t565 - 0.8e1 * t1027 * t146);
  t2277 = t1786 * t411;
  t2280 = t853 * t17;
  t2290 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t2277 * t672 - 0.16e2 / 0.9e1 * t2280 * t2218 + 0.4e1 / 0.9e1 * t1032 * t637 - 0.8e1 / 0.3e1 * t94 * t565 + 0.8e1 * t1035 * t146);
  t2292 = (t2276 + t2290) * t156;
  t2293 = t2292 * t184;
  t2296 = -0.18311447306006545054e-3 * t1709 + t1714 - t1719 - t1723 + t1727 + t1759 + t1767 - t1773 - t2255 - 0.5848223622634646207e0 * t2256 + 0.11696447245269292414e1 * t2258 + t2262 + t147 * t2293 - t1811 + 0.21687162600603479684e-1 * t1813 - t1817;
  t2297 = t329 * t1044;
  t2300 = 0.8e1 * t324 * t1042;
  t2302 = 0.8e1 * t329 * t1042;
  t2303 = t324 * t1044;
  t2305 = t755 * t471;
  t2307 = t879 * t471;
  t2309 = t876 * t471;
  t2311 = t470 * t843;
  t2312 = t147 * t2311;
  t2316 = -t1820 + t1823 + t1826 - 0.8e1 * t2297 + t2300 - t2302 + 0.8e1 * t2303 + 0.2e2 * t2305 - 0.32e2 * t2307 + 0.12e2 * t2309 + t2312 - t1839 - t1847 - 0.11696447245269292414e1 * t1848 - 0.34631718211362927518e2 * t1850 - 0.5848223622634646207e0 * t1853;
  t2318 = 0.48e2 * t1858;
  t2319 = t1041 * t3;
  t2321 = 0.36622894612013090108e-3 * t2319 * t379;
  t2322 = t1014 * t885;
  t2325 = 0.12e2 * t1879;
  t2327 = t470 * t116;
  t2328 = t2327 * t896;
  t2330 = t1050 * t718;
  t2332 = -t1856 + t2318 - t2321 + 0.24415263074675393405e-3 * t2322 + 0.4883052614935078681e-3 * t1862 - t1867 + t1871 - t1874 + t1878 - t2325 - 0.24e2 * t1881 + t1884 + t1889 - t1892 + 0.10843581300301739842e-1 * t2328 - 0.17315859105681463759e2 * t2330;
  t2333 = t1041 * t172;
  t2335 = 0.11696447245269292414e1 * t2333 * t384;
  t2342 = 0.8e2 * t1916;
  t2343 = 0.4e1 * t1921;
  t2346 = -t2335 + 0.19751673498613801407e-1 * t2292 * t182 + 0.23392894490538584828e1 * t1895 + t1903 - 0.16e2 * t1904 - 0.4e1 * t1906 - 0.4e1 * t1908 + t1912 - t1914 + t2342 - t1920 + t2343 + 0.4e2 * t1923 + t1926 + 0.2e1 * t1928 + t2027;
  t2348 = t2296 + t2316 + t2332 + t2346;
  t2350 = -t2231 * t111 / 0.48e2 + t2249 - 0.35e2 / 0.216e3 * t2250 + 0.7e1 / 0.144e3 * t1699 - 0.35e2 / 0.108e3 * t1701 + t1707 + params->gammac * t2348;
  t2351 = t286 * t2350;
  t2352 = t109 * t2351;
  t2355 = t281 * t1057;
  t2357 = 0.7e1 / 0.72e2 * t101 * t2355;
  t2361 = 0.7e1 / 0.72e2 * t275 * t1000;
  t2364 = t108 * t2061;
  t2365 = t477 * t700;
  t2366 = t2364 * t2365;
  t2369 = t477 * t902;
  t2370 = t1004 * t2369;
  t2373 = t280 * t699;
  t2374 = t2373 * t1005;
  t2376 = 0.7e1 / 0.36e2 * t1003 * t2374;
  t2377 = t1056 * t389;
  t2378 = t1004 * t2377;
  t2381 = t274 * t110;
  t2384 = t989 * t391 / 0.24e2 - t2243 + t2245 + t101 * t2352 / 0.48e2 - t2357 + t682 * t479 / 0.48e2 - t2361 - t458 * t702 / 0.24e2 + t1003 * t2366 / 0.8e1 - t1003 * t2370 / 0.24e2 + t2376 - t1003 * t2378 / 0.12e2 - t2381 * t1006 / 0.12e2;
  t2385 = t2239 + t2384;
  t2386 = t263 * t2385;
  t2387 = t2386 * t189;
  t2388 = t1062 * t387;
  t2390 = t483 * t900;
  t2391 = t661 * t475;
  t2392 = t908 * t475;
  t2393 = t395 * t1054;
  t2395 = t196 * t2348;
  t2396 = t2177 + t2179 + t2181 + 0.2e1 * t2183 + 0.2e1 * t2186 + t2387 + 0.2e1 * t2388 + t2390 + t2391 + t2392 + 0.2e1 * t2393 + t2395;
  tv3rho31 = t7 * t2396 + t2086 + t2087 + t2088 + t2089 + t2090 + t2091 + t658 + t662 + t909 + t911 + t912;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t2398 = t1526 * t1072;
  t2403 = t561 * t1077;
  t2406 = -t2100 - t2101;
  t2407 = my_piecewise5(t11, 0, t15, 0, t2406);
  t2411 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t2398 * t201 + 0.8e1 / 0.9e1 * t915 * t919 + 0.4e1 / 0.9e1 * t2403 * t201 + 0.4e1 / 0.3e1 * t24 * t2407);
  t2418 = t6 * t1081 * t132 * t51;
  t2420 = t6 * t1081;
  t2427 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2411 * t27 * t51 - t2418 / 0.8e1 - 0.3e1 / 0.8e1 * t2420 * t241 - t2115 + t2121 / 0.6e1 - t2124 + t1601 / 0.12e2 - t1548 + t1551 / 0.12e2);
  t2428 = t1626 * t1089;
  t2433 = t633 * t1093;
  t2436 = -t2406;
  t2437 = my_piecewise5(t15, 0, t11, 0, t2436);
  t2441 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t2428 * t247 + 0.8e1 / 0.9e1 * t939 * t942 + 0.4e1 / 0.9e1 * t2433 * t247 + 0.4e1 / 0.3e1 * t60 * t2437);
  t2448 = t6 * t1097 * t132 * t79;
  t2451 = t6 * t946;
  t2454 = t1103 * t960;
  t2460 = t132 * t1107;
  t2461 = t2460 * t1109;
  t2462 = t420 * t2461;
  t2466 = t959 * t1136;
  t2467 = t420 * t2466;
  t2469 = -0.3e1 / 0.8e1 * t6 * t2441 * t27 * t79 - t2448 / 0.8e1 - t2158 + t2161 / 0.6e1 - 0.3e1 / 0.4e1 * t2451 * t442 - t2454 / 0.4e1 + t1649 / 0.12e2 - t1654 - t2169 + t2172 / 0.6e1 - 0.3e1 / 0.8e1 * t956 * t1110 - t2462 / 0.8e1 - 0.3e1 / 0.8e1 * t956 * t1137 - t2467 / 0.8e1;
  t2470 = my_piecewise3(t56, 0, t2469);
  t2472 = t1 * (t2427 + t2470);
  t2473 = t1659 * t394;
  t2474 = t1144 * t189;
  t2475 = t2473 * t2474;
  t2476 = t1329 * t2182;
  t2478 = t1145 * t387;
  t2479 = t1211 * t189;
  t2480 = t967 * t2479;
  t2485 = t1670 * t1147;
  t2490 = t663 * t1076;
  t2496 = my_piecewise3(t87, 0, 0.8e1 / 0.27e2 * t2485 * t200 - 0.8e1 / 0.9e1 * t970 * t566 - 0.2e1 / 0.9e1 * t2490 * t200 + 0.2e1 / 0.3e1 * t264 * t2406);
  t2497 = t1683 * t1154;
  t2502 = t671 * t1092;
  t2508 = my_piecewise3(t93, 0, 0.8e1 / 0.27e2 * t2497 * t246 + 0.8e1 / 0.9e1 * t978 * t566 - 0.2e1 / 0.9e1 * t2502 * t246 + 0.2e1 / 0.3e1 * t268 * t2436);
  t2510 = t2496 / 0.2e1 + t2508 / 0.2e1;
  t2511 = t2510 * t99;
  t2514 = t1163 * t289;
  t2518 = t1192 * t3;
  t2519 = t2518 * t379;
  t2521 = t324 * t1193;
  t2523 = t329 * t1193;
  t2525 = t1192 * t372;
  t2526 = t147 * t2525;
  t2527 = t1192 * t172;
  t2528 = t2527 * t384;
  t2533 = t1714 - t1719 - t1723 + t1727 - 0.18311447306006545054e-3 * t2519 + 0.4e1 * t2521 - 0.4e1 * t2523 + t2526 - 0.5848223622634646207e0 * t2528 + t1759 + t1767 - t1773 + t2255 + 0.32e2 * t1802 - 0.11696447245269292414e1 * t2256 + 0.23392894490538584828e1 * t2258;
  t2540 = t2262 - t1811 + 0.10843581300301739842e-1 * t1813 - t1817 - t1820 + t1823 + t1826 - 0.16e2 * t2297 - t2300 - t2302 + 0.4e2 * t2305 - 0.24e2 * t2309 + 0.2e1 * t2312 - t1839 - t1847 - 0.5848223622634646207e0 * t1848;
  t2548 = -0.17315859105681463759e2 * t1850 + t1856 + t2318 - t2321 + 0.48830526149350786811e-3 * t2322 + 0.24415263074675393405e-3 * t1862 - t1867 + t1871 - t1874 + t1878 - t2325 + 0.12e2 * t1881 + t1889 - t1892 - 0.8e1 * t1893 + 0.21687162600603479684e-1 * t2328;
  t2549 = t1775 * t1147;
  t2554 = t846 * t1076;
  t2560 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t2549 * t200 + 0.16e2 / 0.9e1 * t1024 * t566 + 0.4e1 / 0.9e1 * t2554 * t200 + 0.4e1 / 0.3e1 * t89 * t2406);
  t2561 = t1786 * t1154;
  t2566 = t853 * t1092;
  t2572 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t2561 * t246 - 0.16e2 / 0.9e1 * t1032 * t566 + 0.4e1 / 0.9e1 * t2566 * t246 + 0.4e1 / 0.3e1 * t94 * t2436);
  t2574 = (t2560 + t2572) * t156;
  t2581 = t2574 * t184;
  t2583 = 0.19751673498613801407e-1 * t2574 * t182 - 0.34631718211362927517e2 * t2330 - t2335 + 0.11696447245269292414e1 * t1895 + t1903 - 0.8e1 * t1904 + t1912 - t1914 - t2342 - t1920 - t2343 + 0.2e2 * t1923 + t1926 + t1928 + t2027 + t147 * t2581;
  t2585 = t2533 + t2540 + t2548 + t2583;
  t2587 = -t2511 * t111 / 0.48e2 + 0.7e1 / 0.144e3 * t2514 + t2249 - 0.35e2 / 0.108e3 * t2250 - 0.35e2 / 0.216e3 * t1701 + t1707 + params->gammac * t2585;
  t2588 = t286 * t2587;
  t2589 = t109 * t2588;
  t2598 = t275 * t1208 / 0.48e2 - 0.35e2 / 0.108e3 * t2189 + t2043 + 0.35e2 / 0.108e3 * t2194 + t101 * t2589 / 0.48e2 + 0.35e2 / 0.216e3 * t2045 - 0.35e2 / 0.216e3 * t2054 - t2243 + t2245 - t2357 - t275 * t1173 / 0.24e2 + t1164 * t391 / 0.48e2;
  t2599 = t477 * t1056;
  t2600 = t1004 * t2599;
  t2603 = t457 * t110;
  t2606 = t1206 * t389;
  t2607 = t1004 * t2606;
  t2610 = t1171 * t389;
  t2611 = t2364 * t2610;
  t2614 = t458 * t1000;
  t2616 = t281 * t1207;
  t2617 = t101 * t2616;
  t2619 = t281 * t1172;
  t2620 = t101 * t2619;
  t2626 = t2511 * t4;
  t2629 = t1164 * t282;
  t2631 = -t2361 - t1003 * t2600 / 0.12e2 - t2603 * t1006 / 0.12e2 - t1003 * t2607 / 0.24e2 + t1003 * t2611 / 0.8e1 - 0.7e1 / 0.72e2 * t2614 - 0.7e1 / 0.144e3 * t2617 + 0.7e1 / 0.72e2 * t2620 + t989 * t479 / 0.24e2 + t458 * t1058 / 0.24e2 + t2376 - t2626 * t193 / 0.48e2 + 0.7e1 / 0.144e3 * t2629;
  t2632 = t2598 + t2631;
  t2633 = t263 * t2632;
  t2634 = t2633 * t189;
  t2635 = t1212 * t387;
  t2636 = t482 * t475;
  t2637 = t967 * t2636;
  t2639 = t1062 * t475;
  t2641 = t483 * t1054;
  t2643 = t395 * t1204;
  t2644 = t196 * t2585;
  t2645 = t2472 + t2475 + 0.2e1 * t2476 + t2478 + t2480 + t2634 + t2635 + 0.2e1 * t2637 + 0.2e1 * t2639 + 0.2e1 * t2641 + t2643 + t2644;
  tv3rho32 = t7 * t2645 + t1143 + t1146 + t1213 + t1215 + t1216 + t2086 + t2087 + t2088 + t2089 + t2090 + t2091;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t2652 = t1072 * t401;
  t2658 = -0.6e1 * t565 - 0.6e1 * t1533;
  t2659 = my_piecewise5(t11, 0, t15, 0, t2658);
  t2663 = my_piecewise3(t21, 0, -0.8e1 / 0.27e2 * t1526 * t2652 + 0.4e1 / 0.3e1 * t915 * t1077 + 0.4e1 / 0.3e1 * t24 * t2659);
  t2671 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t2663 * t27 * t51 - 0.3e1 / 0.8e1 * t2418 + t2121 / 0.4e1 - t1548);
  t2677 = t1089 * t412;
  t2682 = -t2658;
  t2683 = my_piecewise5(t15, 0, t11, 0, t2682);
  t2687 = my_piecewise3(t59, 0, -0.8e1 / 0.27e2 * t1626 * t2677 + 0.4e1 / 0.3e1 * t939 * t1093 + 0.4e1 / 0.3e1 * t60 * t2683);
  t2694 = 0.1e1 / t66 / t531;
  t2700 = 0.1e1 / t65 / t1127;
  t2705 = t1127 * t423;
  t2706 = 0.1e1 / t2705;
  t2711 = t430 * t430;
  t2712 = t1575 * t2711;
  t2713 = t1127 * t531;
  t2715 = 0.1e1 / t66 / t2713;
  t2716 = t436 * t436;
  t2717 = 0.1e1 / t2716;
  t2722 = -0.154e3 / 0.81e2 * t35 * sigma[2] * t2694 * t75 + 0.341e3 / 0.972e3 * t228 * t430 * t2700 * t437 - 0.19e2 / 0.162e3 * t615 * t1126 * t2706 * t1132 + t2712 * t2715 * t2717 * t1584 / 0.486e3;
  t2723 = t422 * t2722;
  t2726 = t6 * t1097;
  t2733 = t441 * t1136;
  t2734 = t1108 * t2733;
  t2737 = xbspline(t78, 3, params);
  t2738 = t27 * t2737;
  t2739 = t1109 * t441;
  t2740 = t2738 * t2739;
  t2743 = -0.3e1 / 0.8e1 * t2448 - 0.3e1 / 0.4e1 * t2454 - 0.3e1 / 0.8e1 * t2462 - 0.3e1 / 0.8e1 * t2467 + t2161 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t2687 * t27 * t79 + t2172 / 0.4e1 - 0.3e1 / 0.8e1 * t420 * t2723 - 0.9e1 / 0.8e1 * t2726 * t442 - 0.9e1 / 0.8e1 * t1103 * t1137 - 0.9e1 / 0.8e1 * t1103 * t1110 - 0.9e1 / 0.8e1 * t420 * t2734 - 0.3e1 / 0.8e1 * t420 * t2740 - t1654;
  t2744 = my_piecewise3(t56, 0, t2743);
  t2746 = t1 * (t2671 + t2744);
  t2747 = t1144 * t482;
  t2748 = t1659 * t2747;
  t2749 = t2748 * t189;
  t2750 = t1329 * t2479;
  t2751 = 0.3e1 * t2750;
  t2752 = t1145 * t475;
  t2753 = 0.3e1 * t2752;
  t2759 = t1147 * t400;
  t2767 = my_piecewise3(t87, 0, 0.8e1 / 0.27e2 * t1670 * t2759 - 0.2e1 / 0.3e1 * t970 * t1076 + 0.2e1 / 0.3e1 * t264 * t2658);
  t2768 = t1154 * t411;
  t2776 = my_piecewise3(t93, 0, 0.8e1 / 0.27e2 * t1683 * t2768 - 0.2e1 / 0.3e1 * t978 * t1092 + 0.2e1 / 0.3e1 * t268 * t2682);
  t2778 = t2767 / 0.2e1 + t2776 / 0.2e1;
  t2779 = t2778 * t99;
  t2789 = t1714 - t1719 - t1723 + t1727 - 0.54934341918019635162e-3 * t2519 - 0.12e2 * t2521 - 0.12e2 * t2523 + 0.3e1 * t2526 - 0.17544670867903938621e1 * t2528 + t1759 + t1767 - t1773;
  t2797 = my_piecewise3(t87, 0, -0.8e1 / 0.27e2 * t1775 * t2759 + 0.4e1 / 0.3e1 * t1024 * t1076 + 0.4e1 / 0.3e1 * t89 * t2658);
  t2805 = my_piecewise3(t93, 0, -0.8e1 / 0.27e2 * t1786 * t2768 + 0.4e1 / 0.3e1 * t1032 * t1092 + 0.4e1 / 0.3e1 * t94 * t2682);
  t2807 = (t2797 + t2805) * t156;
  t2812 = t2807 * t184;
  t2817 = 0.19751673498613801407e-1 * t2807 * t182 + t1801 - 0.17544670867903938621e1 * t2256 + 0.35089341735807877242e1 * t2258 - t1811 - t1817 - t1820 + t1823 + t1826 + t147 * t2812 - 0.24e2 * t2297 - 0.24e2 * t2303 + 0.6e2 * t2305;
  t2823 = 0.96e2 * t2307 + 0.36e2 * t2309 + 0.3e1 * t2312 - t1839 - t1847 - t1856 - t1859 + 0.73245789224026180216e-3 * t2322 - t1867 + t1871 - t1874 + t1878;
  t2826 = t1880 + t1889 - t1892 + 0.32530743900905219526e-1 * t2328 - 0.51947577317044391276e2 * t2330 + t1903 + t1912 - t1914 - t1917 - t1920 - t1922 + t1926 + t2027;
  t2828 = t2789 + t2817 + t2823 + t2826;
  t2830 = -t2779 * t111 / 0.48e2 + 0.7e1 / 0.48e2 * t2514 - 0.35e2 / 0.72e2 * t2250 + t1707 + params->gammac * t2828;
  t2831 = t286 * t2830;
  t2832 = t109 * t2831;
  t2840 = t2779 * t4;
  t2845 = t1171 * t477;
  t2846 = t2061 * t2845;
  t2847 = t109 * t2846;
  t2850 = t477 * t1206;
  t2851 = t1004 * t2850;
  t2854 = 0.7e1 / 0.48e2 * t2629 - 0.7e1 / 0.48e2 * t2617 + 0.7e1 / 0.24e2 * t2620 - 0.7e1 / 0.24e2 * t2614 - 0.35e2 / 0.72e2 * t2189 + t101 * t2832 / 0.48e2 + 0.35e2 / 0.72e2 * t2194 + t458 * t1208 / 0.16e2 + t1164 * t479 / 0.16e2 + t2043 - t2840 * t193 / 0.48e2 - t458 * t1173 / 0.8e1 + t101 * t2847 / 0.8e1 - t1003 * t2851 / 0.8e1;
  t2855 = t263 * t2854;
  t2856 = t2855 * t189;
  t2857 = t1212 * t475;
  t2858 = 0.3e1 * t2857;
  t2859 = t483 * t1204;
  t2860 = 0.3e1 * t2859;
  t2861 = t196 * t2828;
  tv3rho33 = 0.3e1 * t1143 + 0.3e1 * t1146 + 0.3e1 * t1213 + 0.6e1 * t1214 + 0.3e1 * t1216 + t7 * (t2746 + t2749 + t2751 + t2753 + t2856 + t2858 + t2860 + t2861);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t2870 = t582 * t1221;
  t2876 = t1549 * t499;
  t2878 = t213 * t2876 / 0.12e2;
  t2879 = t1607 * t1224;
  t2880 = t213 * t2879;
  t2882 = t589 * t1242;
  t2883 = t213 * t2882;
  t2885 = t595 * t499;
  t2886 = t1616 * t2885;
  t2889 = t626 * t499;
  t2890 = t594 * t2889;
  t2893 = t240 * t1242;
  t2894 = t594 * t2893;
  t2905 = t619 * t622;
  t2910 = t617 * t230;
  t2912 = 0.1e1 / t38 / t2910;
  t2917 = 0.11e2 / 0.27e2 * t30 * t34 * t600 * t47 - 0.65e2 / 0.648e3 * t228 * t607 * t236 * sigma[0] + 0.17e2 / 0.432e3 * t615 * t2905 * t229 - t1575 * t616 * t2912 * t1582 * t1584 / 0.1296e4;
  t2918 = t215 * t2917;
  t2921 = -0.3e1 / 0.8e1 * t1596 * t500 - t2870 / 0.4e1 - 0.3e1 / 0.4e1 * t582 * t1225 - 0.3e1 / 0.4e1 * t582 * t1243 + t2878 - t2880 / 0.4e1 - t2883 / 0.4e1 - 0.3e1 / 0.8e1 * t213 * t2886 - 0.3e1 / 0.8e1 * t213 * t2890 - 0.3e1 / 0.4e1 * t213 * t2894 - 0.3e1 / 0.8e1 * t213 * t2918;
  t2922 = my_piecewise3(t2, 0, t2921);
  t2923 = t1 * t2922;
  t2924 = t2178 * t1249;
  t2925 = t2180 * t1249;
  t2926 = t1283 * t189;
  t2927 = t967 * t2926;
  t2928 = 0.2e1 * t2927;
  t2929 = t523 * t387;
  t2930 = t967 * t2929;
  t2931 = 0.2e1 * t2930;
  t2934 = t275 * t1254;
  t2936 = t274 * t1257;
  t2939 = t104 * t690;
  t2940 = t2939 * t507;
  t2942 = 0.35e2 / 0.216e3 * t101 * t2940;
  t2943 = t280 * t286;
  t2944 = t2943 * t1260;
  t2945 = t1258 * t2944;
  t2947 = t506 * t700;
  t2948 = t1004 * t2947;
  t2951 = t506 * t902;
  t2952 = t1259 * t2951;
  t2955 = t273 * t273;
  t2956 = t2955 * t3;
  t2957 = t2956 * t513;
  t2960 = t1273 * t286;
  t2962 = t1266 * t2960 * t1268;
  t2964 = t1268 * t389;
  t2968 = t506 * t680;
  t2969 = t1267 * t2968;
  t2973 = 0.1e1 / t131 / t753;
  t2974 = t515 * t2973;
  t2977 = 0.119e3 / 0.3456e4 * t514 * t2974 * t519;
  t2978 = t1273 * t699;
  t2980 = t1278 * t2978 * t1260;
  t2982 = t517 * t2061;
  t2989 = -t682 * t508 / 0.48e2 + 0.7e1 / 0.72e2 * t2934 + t2936 * t1261 / 0.24e2 - t2942 - 0.7e1 / 0.72e2 * t2945 - t1258 * t2948 / 0.24e2 + t1258 * t2952 / 0.48e2 - t2957 * t520 / 0.384e3 + 0.7e1 / 0.288e3 * t2962 + t1266 * t1279 * t2964 / 0.96e2 - t1266 * t2969 / 0.384e3 - t2977 - 0.7e1 / 0.288e3 * t2980 - t1278 * t2982 * t2947 / 0.128e3 + t1278 * t1279 * t2951 / 0.384e3;
  t2990 = t263 * t2989;
  t2991 = t2990 * t189;
  t2992 = t1284 * t387;
  t2993 = 0.2e1 * t2992;
  t2994 = t524 * t900;
  tv3rho2sigma0 = 0.2e1 * t1248 + 0.2e1 * t1250 + 0.2e1 * t1285 + 0.2e1 * t1286 + t7 * (t2923 + t2924 + t2925 + t2928 + t2931 + t2991 + t2993 + t2994);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t3003 = t956 * t1291;
  t3005 = t2170 * t538;
  t3007 = t420 * t3005 / 0.12e2;
  t3009 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t2165 * t539 - t3003 / 0.4e1 + t3007);
  t3010 = t1 * t3009;
  t3011 = t2178 * t1297;
  t3012 = t2180 * t1297;
  t3013 = t1318 * t189;
  t3014 = t967 * t3013;
  t3015 = 0.2e1 * t3014;
  t3016 = t553 * t387;
  t3017 = t967 * t3016;
  t3018 = 0.2e1 * t3017;
  t3021 = t275 * t1301;
  t3025 = t2939 * t545;
  t3027 = 0.35e2 / 0.216e3 * t101 * t3025;
  t3028 = t2943 * t1304;
  t3029 = t1258 * t3028;
  t3031 = t544 * t700;
  t3032 = t1004 * t3031;
  t3035 = t544 * t902;
  t3036 = t1259 * t3035;
  t3042 = t1266 * t2960 * t1308;
  t3044 = t1308 * t389;
  t3048 = t544 * t680;
  t3049 = t1267 * t3048;
  t3054 = 0.119e3 / 0.3456e4 * t514 * t2974 * t549;
  t3056 = t1278 * t2978 * t1304;
  t3064 = -t682 * t546 / 0.48e2 + 0.7e1 / 0.72e2 * t3021 + t2936 * t1305 / 0.24e2 - t3027 - 0.7e1 / 0.72e2 * t3029 - t1258 * t3032 / 0.24e2 + t1258 * t3036 / 0.48e2 - t2957 * t550 / 0.384e3 + 0.7e1 / 0.288e3 * t3042 + t1266 * t1279 * t3044 / 0.96e2 - t1266 * t3049 / 0.384e3 - t3054 - 0.7e1 / 0.288e3 * t3056 - t1278 * t2982 * t3031 / 0.128e3 + t1278 * t1279 * t3035 / 0.384e3;
  t3065 = t263 * t3064;
  t3066 = t3065 * t189;
  t3067 = t1319 * t387;
  t3068 = 0.2e1 * t3067;
  t3069 = t554 * t900;
  tv3rho2sigma2 = 0.2e1 * t1296 + 0.2e1 * t1298 + 0.2e1 * t1320 + 0.2e1 * t1321 + t7 * (t3010 + t3011 + t3012 + t3015 + t3018 + t3066 + t3068 + t3069);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t3074 = t932 * t1221;
  t3084 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t2116 * t500 - t3074 / 0.8e1 - 0.3e1 / 0.8e1 * t932 * t1225 - 0.3e1 / 0.8e1 * t932 * t1243 - t2870 / 0.8e1 + t2878 - t2880 / 0.8e1 - t2883 / 0.8e1);
  t3085 = t1 * t3084;
  t3086 = t482 * t523;
  t3087 = t3086 * t189;
  t3088 = t2473 * t3087;
  t3089 = t659 * t1061;
  t3090 = t3089 * t1249;
  t3091 = t1329 * t2926;
  t3092 = t1329 * t2929;
  t3093 = t1344 * t189;
  t3094 = t967 * t3093;
  t3097 = t458 * t1254;
  t3099 = t457 * t1257;
  t3106 = t2943 * t1333;
  t3107 = t1258 * t3106;
  t3109 = t1333 * t389;
  t3110 = t1004 * t3109;
  t3113 = t506 * t1056;
  t3114 = t1259 * t3113;
  t3118 = t273 * t3;
  t3119 = t3118 * t1265;
  t3122 = t2960 * t1337;
  t3123 = t1266 * t3122;
  t3125 = t1337 * t389;
  t3126 = t1279 * t3125;
  t3129 = t506 * t987;
  t3130 = t1267 * t3129;
  t3135 = t1333 * t273;
  t3140 = t1278 * t2978 * t1333;
  t3148 = -t3119 * t1338 / 0.384e3 + 0.7e1 / 0.576e3 * t3123 + t1266 * t3126 / 0.192e3 - t1266 * t3130 / 0.384e3 + 0.7e1 / 0.576e3 * t2962 - t2977 - 0.7e1 / 0.576e3 * t2980 + t1266 * t1279 * t3135 / 0.192e3 - 0.7e1 / 0.576e3 * t3140 - t1278 * t2982 * t3109 / 0.128e3 + t1278 * t1279 * t3113 / 0.384e3;
  t3149 = -t989 * t508 / 0.48e2 + 0.7e1 / 0.144e3 * t3097 + t3099 * t1261 / 0.48e2 + 0.7e1 / 0.144e3 * t2934 - t2942 - 0.7e1 / 0.144e3 * t2945 + t2936 * t1334 / 0.48e2 - 0.7e1 / 0.144e3 * t3107 - t1258 * t3110 / 0.24e2 + t1258 * t3114 / 0.48e2 + t3148;
  t3150 = t263 * t3149;
  t3151 = t3150 * t189;
  t3152 = t1345 * t387;
  t3153 = t523 * t475;
  t3154 = t967 * t3153;
  t3155 = t1284 * t475;
  t3156 = t524 * t1054;
  t3157 = t3085 + t3088 + t3090 + t3091 + t3092 + t3094 + t3151 + t3152 + t3154 + t3155 + t3156;
  tv3rho2sigma3 = t7 * t3157 + t1248 + t1250 + t1285 + t1286 + t1328 + t1330 + t1346 + t1347;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t3161 = t1103 * t1291;
  t3166 = t2460 * t1352;
  t3167 = t420 * t3166;
  t3171 = t959 * t1370;
  t3172 = t420 * t3171;
  t3175 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t2451 * t539 - t3161 / 0.8e1 - t3003 / 0.8e1 + t3007 - 0.3e1 / 0.8e1 * t956 * t1353 - t3167 / 0.8e1 - 0.3e1 / 0.8e1 * t956 * t1371 - t3172 / 0.8e1);
  t3176 = t1 * t3175;
  t3177 = t482 * t553;
  t3178 = t3177 * t189;
  t3179 = t2473 * t3178;
  t3180 = t3089 * t1297;
  t3181 = t1329 * t3013;
  t3182 = t1329 * t3016;
  t3183 = t1391 * t189;
  t3184 = t967 * t3183;
  t3187 = t458 * t1301;
  t3195 = t2943 * t1380;
  t3196 = t1258 * t3195;
  t3198 = t1380 * t389;
  t3199 = t1004 * t3198;
  t3202 = t544 * t1056;
  t3203 = t1259 * t3202;
  t3209 = t2960 * t1384;
  t3210 = t1266 * t3209;
  t3212 = t1384 * t389;
  t3213 = t1279 * t3212;
  t3216 = t544 * t987;
  t3217 = t1267 * t3216;
  t3222 = t1380 * t273;
  t3227 = t1278 * t2978 * t1380;
  t3235 = -t3119 * t1385 / 0.384e3 + 0.7e1 / 0.576e3 * t3210 + t1266 * t3213 / 0.192e3 - t1266 * t3217 / 0.384e3 + 0.7e1 / 0.576e3 * t3042 - t3054 - 0.7e1 / 0.576e3 * t3056 + t1266 * t1279 * t3222 / 0.192e3 - 0.7e1 / 0.576e3 * t3227 - t1278 * t2982 * t3198 / 0.128e3 + t1278 * t1279 * t3202 / 0.384e3;
  t3236 = -t989 * t546 / 0.48e2 + 0.7e1 / 0.144e3 * t3187 + t3099 * t1305 / 0.48e2 + 0.7e1 / 0.144e3 * t3021 - t3027 - 0.7e1 / 0.144e3 * t3029 + t2936 * t1381 / 0.48e2 - 0.7e1 / 0.144e3 * t3196 - t1258 * t3199 / 0.24e2 + t1258 * t3203 / 0.48e2 + t3235;
  t3237 = t263 * t3236;
  t3238 = t3237 * t189;
  t3239 = t1392 * t387;
  t3240 = t553 * t475;
  t3241 = t967 * t3240;
  t3242 = t1319 * t475;
  t3243 = t554 * t1054;
  t3244 = t3176 + t3179 + t3180 + t3181 + t3182 + t3184 + t3238 + t3239 + t3241 + t3242 + t3243;
  tv3rho2sigma5 = t7 * t3244 + t1296 + t1298 + t1320 + t1321 + t1376 + t1377 + t1393 + t1394;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t3254 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t2420 * t500 - t3074 / 0.4e1 + t2878);
  t3255 = t1 * t3254;
  t3256 = t1659 * t1144;
  t3257 = t3256 * t1249;
  t3258 = t659 * t1211;
  t3259 = t3258 * t1249;
  t3260 = t1329 * t3093;
  t3261 = 0.2e1 * t3260;
  t3262 = t1329 * t3153;
  t3263 = 0.2e1 * t3262;
  t3270 = t506 * t1171;
  t3271 = t1004 * t3270;
  t3274 = t506 * t1206;
  t3275 = t1259 * t3274;
  t3278 = t456 * t456;
  t3279 = t3278 * t3;
  t3280 = t3279 * t513;
  t3284 = t1337 * t477;
  t3285 = t1279 * t3284;
  t3288 = t506 * t1162;
  t3289 = t1267 * t3288;
  t3299 = -t1164 * t508 / 0.48e2 + 0.7e1 / 0.72e2 * t3097 + t3099 * t1334 / 0.24e2 - t2942 - 0.7e1 / 0.72e2 * t3107 - t1258 * t3271 / 0.24e2 + t1258 * t3275 / 0.48e2 - t3280 * t520 / 0.384e3 + 0.7e1 / 0.288e3 * t3123 + t1266 * t3285 / 0.96e2 - t1266 * t3289 / 0.384e3 - t2977 - 0.7e1 / 0.288e3 * t3140 - t1278 * t2982 * t3270 / 0.128e3 + t1278 * t1279 * t3274 / 0.384e3;
  t3300 = t263 * t3299;
  t3301 = t3300 * t189;
  t3302 = t1345 * t475;
  t3303 = 0.2e1 * t3302;
  t3304 = t524 * t1204;
  tv3rho2sigma6 = 0.2e1 * t1328 + 0.2e1 * t1330 + 0.2e1 * t1346 + 0.2e1 * t1347 + t7 * (t3255 + t3257 + t3259 + t3261 + t3263 + t3301 + t3303 + t3304);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t3320 = t1109 * t538;
  t3321 = t2738 * t3320;
  t3324 = t1136 * t538;
  t3325 = t1108 * t3324;
  t3328 = t441 * t1370;
  t3329 = t1108 * t3328;
  t3340 = t1129 * t1132;
  t3345 = t1127 * t431;
  t3347 = 0.1e1 / t66 / t3345;
  t3352 = 0.11e2 / 0.27e2 * t30 * t34 * t1114 * t75 - 0.65e2 / 0.648e3 * t228 * t1121 * t437 * sigma[2] + 0.17e2 / 0.432e3 * t615 * t3340 * t430 - t1575 * t1126 * t3347 * t2717 * t1584 / 0.1296e4;
  t3353 = t422 * t3352;
  t3356 = -0.3e1 / 0.8e1 * t2726 * t539 - t3161 / 0.4e1 - 0.3e1 / 0.4e1 * t1103 * t1353 - 0.3e1 / 0.4e1 * t1103 * t1371 + t3007 - t3167 / 0.4e1 - t3172 / 0.4e1 - 0.3e1 / 0.8e1 * t420 * t3321 - 0.3e1 / 0.8e1 * t420 * t3325 - 0.3e1 / 0.4e1 * t420 * t3329 - 0.3e1 / 0.8e1 * t420 * t3353;
  t3357 = my_piecewise3(t56, 0, t3356);
  t3358 = t1 * t3357;
  t3359 = t3256 * t1297;
  t3360 = t3258 * t1297;
  t3361 = t1329 * t3183;
  t3362 = 0.2e1 * t3361;
  t3363 = t1329 * t3240;
  t3364 = 0.2e1 * t3363;
  t3371 = t544 * t1171;
  t3372 = t1004 * t3371;
  t3375 = t544 * t1206;
  t3376 = t1259 * t3375;
  t3382 = t1384 * t477;
  t3383 = t1279 * t3382;
  t3386 = t544 * t1162;
  t3387 = t1267 * t3386;
  t3397 = -t1164 * t546 / 0.48e2 + 0.7e1 / 0.72e2 * t3187 + t3099 * t1381 / 0.24e2 - t3027 - 0.7e1 / 0.72e2 * t3196 - t1258 * t3372 / 0.24e2 + t1258 * t3376 / 0.48e2 - t3280 * t550 / 0.384e3 + 0.7e1 / 0.288e3 * t3210 + t1266 * t3383 / 0.96e2 - t1266 * t3387 / 0.384e3 - t3054 - 0.7e1 / 0.288e3 * t3227 - t1278 * t2982 * t3371 / 0.128e3 + t1278 * t1279 * t3375 / 0.384e3;
  t3398 = t263 * t3397;
  t3399 = t3398 * t189;
  t3400 = t1392 * t475;
  t3401 = 0.2e1 * t3400;
  t3402 = t554 * t1204;
  tv3rho2sigma8 = 0.2e1 * t1376 + 0.2e1 * t1377 + 0.2e1 * t1393 + 0.2e1 * t1394 + t7 * (t3358 + t3359 + t3360 + t3362 + t3364 + t3399 + t3401 + t3402);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t3407 = t1607 * t1397;
  t3409 = t213 * t3407 / 0.8e1;
  t3410 = t240 * t1397;
  t3411 = t1616 * t3410;
  t3414 = t499 * t1242;
  t3415 = t594 * t3414;
  t3420 = t589 * t1409;
  t3422 = t213 * t3420 / 0.8e1;
  t3423 = t240 * t1409;
  t3424 = t594 * t3423;
  t3431 = t1237 * t622;
  t3437 = 0.1e1 / t38 / t1568;
  t3442 = t225 * t227 * t233 * t236 / 0.54e2 - 0.5e1 / 0.432e3 * t615 * t3431 * sigma[0] + t1575 * t229 * t3437 * t1582 * t1584 / 0.3456e4;
  t3443 = t215 * t3442;
  t3447 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t582 * t1398 - t3409 - 0.3e1 / 0.8e1 * t213 * t3411 - 0.3e1 / 0.4e1 * t213 * t3415 - 0.3e1 / 0.8e1 * t582 * t1410 - t3422 - 0.3e1 / 0.8e1 * t213 * t3424 - 0.3e1 / 0.8e1 * t213 * t3443);
  t3448 = t1 * t3447;
  t3449 = t1416 * t189;
  t3450 = t2473 * t3449;
  t3451 = t1453 * t2926;
  t3452 = 0.2e1 * t3451;
  t3453 = t1417 * t387;
  t3454 = t1449 * t189;
  t3455 = t967 * t3454;
  t3458 = t1419 * t280;
  t3459 = t3458 * t192;
  t3461 = 0.7e1 / 0.288e3 * t101 * t3459;
  t3462 = t1420 * t390;
  t3465 = t1264 * t1459;
  t3466 = t1419 * t273;
  t3470 = t105 * t1273;
  t3473 = 0.35e2 / 0.2304e4 * t514 * t3470 * t1425;
  t3474 = t1419 * t389;
  t3480 = t1253 * t1431;
  t3482 = 0.7e1 / 0.288e3 * t101 * t3480;
  t3483 = t1430 * t389;
  t3484 = t1259 * t3483;
  t3487 = t511 * M_PI;
  t3488 = t3487 * t1437;
  t3492 = t145 * t145;
  t3493 = 0.1e1 / t3492;
  t3494 = t3493 * t699;
  t3497 = 0.7e1 / 0.6144e4 * t1438 * t3494 * t1419;
  t3498 = t1440 * t2061;
  t3502 = t1430 * t273;
  t3508 = 0.7e1 / 0.2304e4 * t514 * t1274 * t1445;
  t3512 = -t275 * t1421 / 0.96e2 + t3461 + t101 * t3462 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t1267 * t3466 + t3473 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3474 + t275 * t1432 / 0.96e2 - t3482 - t1258 * t3484 / 0.96e2 - t3488 * t1441 * t3466 / 0.2048e4 + t3497 + t1438 * t3498 * t3474 / 0.2048e4 + t1266 * t1267 * t3502 / 0.768e3 - t3508 - t1278 * t1279 * t3483 / 0.768e3;
  t3513 = t263 * t3512;
  t3514 = t3513 * t189;
  t3515 = t1450 * t387;
  tv3rhosigma20 = t1415 + t1418 + t1451 + t7 * (t3448 + t3450 + t3452 + t3453 + t3455 + t3514 + t3515);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  t3518 = t523 * t553;
  t3519 = t3518 * t189;
  t3520 = t2473 * t3519;
  t3521 = t659 * t1283;
  t3522 = t3521 * t1297;
  t3523 = t1453 * t3013;
  t3524 = t1453 * t3016;
  t3525 = t1468 * t189;
  t3526 = t967 * t3525;
  t3529 = t506 * t280;
  t3530 = t3529 * t545;
  t3532 = 0.7e1 / 0.288e3 * t101 * t3530;
  t3533 = t4 * t506;
  t3534 = t100 * t3533;
  t3537 = t1461 * t273;
  t3543 = 0.35e2 / 0.2304e4 * t1460 * t2960 * t1461;
  t3544 = t1461 * t389;
  t3548 = t1437 * t1440;
  t3549 = t3487 * t3548;
  t3550 = t699 * t544;
  t3551 = t3550 * t1268;
  t3556 = 0.7e1 / 0.6144e4 * t1438 * t3494 * t1461;
  t3557 = t1436 * t3548;
  t3558 = t2061 * t544;
  t3559 = t3558 * t1260;
  t3562 = -t275 * t1456 / 0.96e2 + t3532 + t3534 * t1305 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t1267 * t3537 + t3543 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3544 - t3549 * t3551 / 0.2048e4 + t3556 + t3557 * t3559 / 0.2048e4;
  t3563 = t263 * t3562;
  t3564 = t3563 * t189;
  t3565 = t1469 * t387;
  tv3rhosigma22 = t1454 + t1470 + t7 * (t3520 + t3522 + t3523 + t3524 + t3526 + t3564 + t3565);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t3570 = t2460 * t1472;
  t3572 = t420 * t3570 / 0.8e1;
  t3575 = t959 * t1484;
  t3577 = t420 * t3575 / 0.8e1;
  t3579 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t956 * t1473 - t3572 - 0.3e1 / 0.8e1 * t956 * t1485 - t3577);
  t3580 = t1 * t3579;
  t3581 = t1491 * t189;
  t3582 = t2473 * t3581;
  t3583 = t659 * t553;
  t3584 = t3583 * t3013;
  t3585 = 0.2e1 * t3584;
  t3586 = t1492 * t387;
  t3587 = t1516 * t189;
  t3588 = t967 * t3587;
  t3591 = t1494 * t280;
  t3592 = t3591 * t192;
  t3594 = 0.7e1 / 0.288e3 * t101 * t3592;
  t3595 = t1495 * t390;
  t3598 = t1494 * t273;
  t3604 = 0.35e2 / 0.2304e4 * t514 * t3470 * t1499;
  t3605 = t1494 * t389;
  t3611 = t1253 * t1505;
  t3613 = 0.7e1 / 0.288e3 * t101 * t3611;
  t3614 = t1504 * t389;
  t3615 = t1259 * t3614;
  t3623 = 0.7e1 / 0.6144e4 * t1438 * t3494 * t1494;
  t3627 = t1504 * t273;
  t3633 = 0.7e1 / 0.2304e4 * t514 * t1274 * t1512;
  t3637 = -t275 * t1496 / 0.96e2 + t3594 + t101 * t3595 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t1267 * t3598 + t3604 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3605 + t275 * t1506 / 0.96e2 - t3613 - t1258 * t3615 / 0.96e2 - t3488 * t1441 * t3598 / 0.2048e4 + t3623 + t1438 * t3498 * t3605 / 0.2048e4 + t1266 * t1267 * t3627 / 0.768e3 - t3633 - t1278 * t1279 * t3614 / 0.768e3;
  t3638 = t263 * t3637;
  t3639 = t3638 * t189;
  t3640 = t1517 * t387;
  tv3rhosigma25 = t1490 + t1493 + t1518 + t7 * (t3580 + t3582 + t3585 + t3586 + t3588 + t3639 + t3640);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t3648 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t932 * t1398 - t3409 - 0.3e1 / 0.8e1 * t932 * t1410 - t3422);
  t3649 = t1 * t3648;
  t3650 = t1659 * t482;
  t3651 = t3650 * t3449;
  t3652 = t1453 * t3093;
  t3653 = 0.2e1 * t3652;
  t3654 = t1417 * t475;
  t3655 = t1329 * t3454;
  t3658 = t1420 * t478;
  t3661 = t1419 * t456;
  t3662 = t1267 * t3661;
  t3665 = t1419 * t477;
  t3671 = t1430 * t477;
  t3672 = t1259 * t3671;
  t3681 = t1430 * t456;
  t3682 = t1267 * t3681;
  t3688 = -t458 * t1421 / 0.96e2 + t3461 + t101 * t3658 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t3662 + t3473 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3665 + t458 * t1432 / 0.96e2 - t3482 - t1258 * t3672 / 0.96e2 - t3488 * t1441 * t3661 / 0.2048e4 + t3497 + t1438 * t3498 * t3665 / 0.2048e4 + t1266 * t3682 / 0.768e3 - t3508 - t1278 * t1279 * t3671 / 0.768e3;
  t3689 = t263 * t3688;
  t3690 = t3689 * t189;
  t3691 = t1450 * t475;
  tv3rhosigma26 = t1415 + t1418 + t1451 + t7 * (t3649 + t3651 + t3653 + t3654 + t3655 + t3690 + t3691);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  t3694 = t3650 * t3519;
  t3695 = t659 * t1344;
  t3696 = t3695 * t1297;
  t3697 = t1453 * t3183;
  t3698 = t1453 * t3240;
  t3699 = t1329 * t3525;
  t3704 = t1461 * t456;
  t3705 = t1267 * t3704;
  t3708 = t1461 * t477;
  t3712 = t3550 * t1337;
  t3715 = t3558 * t1333;
  t3718 = -t458 * t1456 / 0.96e2 + t3532 + t3534 * t1381 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t3705 + t3543 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3708 - t3549 * t3712 / 0.2048e4 + t3556 + t3557 * t3715 / 0.2048e4;
  t3719 = t263 * t3718;
  t3720 = t3719 * t189;
  t3721 = t1469 * t475;
  tv3rhosigma28 = t1454 + t1470 + t7 * (t3694 + t3696 + t3697 + t3698 + t3699 + t3720 + t3721);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t3726 = t441 * t1472;
  t3727 = t2738 * t3726;
  t3730 = t538 * t1370;
  t3731 = t1108 * t3730;
  t3736 = t441 * t1484;
  t3737 = t1108 * t3736;
  t3744 = t1365 * t1132;
  t3750 = 0.1e1 / t66 / t2705;
  t3755 = t225 * t227 * t434 * t437 / 0.54e2 - 0.5e1 / 0.432e3 * t615 * t3744 * sigma[2] + t1575 * t430 * t3750 * t2717 * t1584 / 0.3456e4;
  t3756 = t422 * t3755;
  t3760 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t1103 * t1473 - t3572 - 0.3e1 / 0.8e1 * t420 * t3727 - 0.3e1 / 0.4e1 * t420 * t3731 - 0.3e1 / 0.8e1 * t1103 * t1485 - t3577 - 0.3e1 / 0.8e1 * t420 * t3737 - 0.3e1 / 0.8e1 * t420 * t3756);
  t3761 = t1 * t3760;
  t3762 = t3650 * t3581;
  t3763 = t3583 * t3183;
  t3764 = 0.2e1 * t3763;
  t3765 = t1492 * t475;
  t3766 = t1329 * t3587;
  t3769 = t1495 * t478;
  t3772 = t1494 * t456;
  t3773 = t1267 * t3772;
  t3776 = t1494 * t477;
  t3782 = t1504 * t477;
  t3783 = t1259 * t3782;
  t3792 = t1504 * t456;
  t3793 = t1267 * t3792;
  t3799 = -t458 * t1496 / 0.96e2 + t3594 + t101 * t3769 / 0.96e2 - 0.5e1 / 0.768e3 * t3465 * t3773 + t3604 + 0.5e1 / 0.768e3 * t1460 * t1279 * t3776 + t458 * t1506 / 0.96e2 - t3613 - t1258 * t3783 / 0.96e2 - t3488 * t1441 * t3772 / 0.2048e4 + t3623 + t1438 * t3498 * t3776 / 0.2048e4 + t1266 * t3793 / 0.768e3 - t3633 - t1278 * t1279 * t3782 / 0.768e3;
  t3800 = t263 * t3799;
  t3801 = t3800 * t189;
  t3802 = t1517 * t475;
  tv3rhosigma211 = t1490 + t1493 + t1518 + t7 * (t3761 + t3762 + t3764 + t3765 + t3766 + t3801 + t3802);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t3805 = t1397 * t499;
  t3806 = t1616 * t3805;
  t3809 = t499 * t1409;
  t3810 = t594 * t3809;
  t3818 = 0.1e1 / t38 / t618;
  t3823 = t615 * t1404 * t622 / 0.384e3 - t1575 * sigma[0] * t3818 * t1582 * t1584 / 0.9216e4;
  t3824 = t215 * t3823;
  t3828 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t213 * t3806 - 0.9e1 / 0.8e1 * t213 * t3810 - 0.3e1 / 0.8e1 * t213 * t3824);
  t3829 = t1 * t3828;
  t3830 = t1416 * t523;
  t3831 = t1659 * t3830;
  t3832 = t3831 * t189;
  t3834 = 0.3e1 * t1453 * t3454;
  t3835 = 0.1e1 / t229;
  t3836 = t3835 * t108;
  t3837 = t3836 * t192;
  t3841 = t286 * t104;
  t3842 = t1430 * t517 * t3841;
  t3845 = t1436 * t515;
  t3849 = t286 * t3835;
  t3854 = 0.1e1 / t102 / t229;
  t3855 = t192 * t3854;
  t3856 = t505 * t3855;
  t3859 = t511 * t511;
  t3860 = t4 * M_PI;
  t3861 = t3859 * t3860;
  t3862 = t1437 * t104;
  t3863 = t3861 * t3862;
  t3864 = t3492 * t7;
  t3866 = 0.1e1 / t27 / t3864;
  t3867 = t3866 * t2061;
  t3868 = t1430 * t99;
  t3875 = t286 * t3854;
  t3879 = t101 * t3837 / 0.64e2 - t514 * t3842 / 0.256e3 - 0.3e1 / 0.4096e4 * t3845 * t1441 * t1430 + 0.5e1 / 0.1024e4 * t514 * t1424 * t3849 - t101 * t3856 / 0.64e2 - t3863 * t3867 * t3868 / 0.98304e5 + t1438 * t1441 * t3835 / 0.4096e4 - t514 * t518 * t3875 / 0.1024e4;
  t3880 = t263 * t3879;
  t3881 = t3880 * t189;
  tv3sigma30 = t7 * (t3829 + t3832 + t3834 + t3881);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  t3883 = t1659 * t1416;
  t3884 = t3883 * t1297;
  t3885 = t659 * t1449;
  t3886 = t3885 * t1297;
  t3888 = 0.2e1 * t1453 * t3525;
  t3889 = t1430 * t108;
  t3890 = t3889 * t545;
  t3893 = t513 * t1419;
  t3894 = t512 * t3893;
  t3895 = t544 * t104;
  t3896 = t1267 * t3895;
  t3899 = t544 * t1419;
  t3903 = t544 * t1430;
  t3904 = t1267 * t3903;
  t3907 = t3862 * t3866;
  t3908 = t3861 * t3907;
  t3909 = t1419 * t99;
  t3910 = t3558 * t3909;
  t3916 = t101 * t3890 / 0.192e3 - t3894 * t3896 / 0.256e3 - 0.3e1 / 0.4096e4 * t3845 * t1441 * t3899 + 0.5e1 / 0.3072e4 * t1460 * t3904 - t3908 * t3910 / 0.98304e5 + t1438 * t1441 * t3903 / 0.12288e5;
  t3917 = t263 * t3916;
  t3918 = t3917 * t189;
  tv3sigma32 = t7 * (t3884 + t3886 + t3888 + t3918);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  t3920 = t1659 * t523;
  t3921 = t3920 * t3581;
  t3923 = 0.2e1 * t3583 * t3525;
  t3924 = t1453 * t3587;
  t3925 = t513 * t1494;
  t3926 = t512 * t3925;
  t3927 = t104 * t506;
  t3928 = t1267 * t3927;
  t3931 = t1494 * t506;
  t3935 = t1455 * t1505;
  t3938 = t1504 * t506;
  t3939 = t1267 * t3938;
  t3942 = t2061 * t1494;
  t3943 = t99 * t506;
  t3944 = t3942 * t3943;
  t3950 = -t3926 * t3928 / 0.256e3 - 0.3e1 / 0.4096e4 * t3845 * t1441 * t3931 + t101 * t3935 / 0.192e3 + 0.5e1 / 0.3072e4 * t1460 * t3939 - t3908 * t3944 / 0.98304e5 + t1438 * t1441 * t3938 / 0.12288e5;
  t3951 = t263 * t3950;
  t3952 = t3951 * t189;
  tv3sigma35 = t7 * (t3921 + t3923 + t3924 + t3952);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t3954 = t1472 * t538;
  t3955 = t2738 * t3954;
  t3958 = t538 * t1484;
  t3959 = t1108 * t3958;
  t3967 = 0.1e1 / t66 / t1128;
  t3972 = t615 * t1479 * t1132 / 0.384e3 - t1575 * sigma[2] * t3967 * t2717 * t1584 / 0.9216e4;
  t3973 = t422 * t3972;
  t3977 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t420 * t3955 - 0.9e1 / 0.8e1 * t420 * t3959 - 0.3e1 / 0.8e1 * t420 * t3973);
  t3978 = t1 * t3977;
  t3979 = t1491 * t553;
  t3980 = t1659 * t3979;
  t3981 = t3980 * t189;
  t3983 = 0.3e1 * t3583 * t3587;
  t3984 = 0.1e1 / t430;
  t3985 = t3984 * t108;
  t3986 = t3985 * t192;
  t3990 = t1504 * t517 * t3841;
  t3996 = t286 * t3984;
  t4001 = 0.1e1 / t103 / t430;
  t4002 = t192 * t4001;
  t4003 = t505 * t4002;
  t4006 = t1504 * t99;
  t4013 = t286 * t4001;
  t4017 = t101 * t3986 / 0.64e2 - t514 * t3990 / 0.256e3 - 0.3e1 / 0.4096e4 * t3845 * t1441 * t1504 + 0.5e1 / 0.1024e4 * t514 * t1424 * t3996 - t101 * t4003 / 0.64e2 - t3863 * t3867 * t4006 / 0.98304e5 + t1438 * t1441 * t3984 / 0.4096e4 - t514 * t518 * t4013 / 0.1024e4;
  t4018 = t263 * t4017;
  t4019 = t4018 * t189;
  tv3sigma39 = t7 * (t3978 + t3981 + t3983 + t4019);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t4031 = t6 * t573 * t314 * t51;
  t4033 = t314 * t593;
  t4035 = t213 * t4033 * t595;
  t4038 = t213 * t589 * t1588;
  t4059 = t617 * t231;
  t4067 = t1574 * params->gammax * t614;
  t4070 = t617 * t617;
  t4075 = 0.1e1 / t1581 / t46;
  t4077 = t224 * t227;
  t4085 = t1596 * t590;
  t4091 = t6 * t1540;
  t4094 = t726 * t214;
  t4096 = t213 * t4094 * t240;
  t4098 = t582 * t1550;
  t4100 = t213 * t1549 * t626;
  t4102 = t582 * t1553;
  t4104 = t4031 / 0.2e1 + t4035 / 0.2e1 - t4038 / 0.2e1 - 0.3e1 / 0.2e1 * t582 * t1589 - 0.3e1 / 0.8e1 * t213 * t215 * (0.2618e4 / 0.243e3 * t35 * sigma[0] / t38 / t231 * t47 - 0.3047e4 / 0.972e3 * t228 * t229 / t37 / t1236 * t236 + 0.2563e4 / 0.1458e4 * t615 * t616 / t2910 * t622 - 0.49e2 / 0.729e3 * t1577 / t38 / t4059 * t1582 * t1584 + 0.2e1 / 0.2187e4 * t4067 * t1576 * sigma[0] / t37 / t4070 / rho[0] * t4075 * t4077) - 0.3e1 / 0.2e1 * t4085 - 0.9e1 / 0.4e1 * t1596 * t627 - 0.3e1 / 0.2e1 * t582 * t1618 - 0.3e1 / 0.2e1 * t4091 * t241 - 0.5e1 / 0.9e1 * t4096 + t4098 + t4100 / 0.2e1 - 0.3e1 / 0.2e1 * t4102;
  t4105 = t132 * t1615;
  t4107 = t213 * t4105 * t1617;
  t4109 = t626 * t626;
  t4113 = xbspline(t50, 4, params);
  t4114 = t27 * t4113;
  t4115 = t595 * t595;
  t4121 = t582 * t1608;
  t4123 = t20 * t20;
  t4125 = 0.1e1 / t560 / t4123;
  t4126 = t562 * t562;
  t4132 = t569 * t569;
  t4137 = t17 * t328;
  t4139 = -0.24e2 * t146 + 0.24e2 * t4137;
  t4140 = my_piecewise5(t11, 0, t15, 0, t4139);
  t4144 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t4125 * t4126 - 0.16e2 / 0.9e1 * t1526 * t562 * t569 + 0.4e1 / 0.3e1 * t561 * t4132 + 0.16e2 / 0.9e1 * t1530 * t1536 + 0.4e1 / 0.3e1 * t24 * t4140);
  t4151 = t6 * t204 * t726 * t51;
  t4155 = t6 * t1540 * t132 * t51;
  t4160 = 0.1e2 / 0.27e2 * t6 * t26 * t1735 * t51;
  t4164 = t213 * t1607 * t1611;
  t4174 = -t4107 / 0.2e1 - 0.9e1 / 0.8e1 * t213 * t594 * t4109 - 0.3e1 / 0.8e1 * t213 * t4114 * t4115 - 0.9e1 / 0.4e1 * t1596 * t596 - 0.3e1 / 0.2e1 * t4121 - 0.3e1 / 0.8e1 * t6 * t4144 * t27 * t51 - 0.5e1 / 0.9e1 * t4151 - t4155 / 0.2e1 + t4160 - 0.9e1 / 0.2e1 * t582 * t1612 - 0.3e1 / 0.2e1 * t4164 - 0.3e1 / 0.2e1 * t213 * t594 * t240 * t1588 - 0.9e1 / 0.4e1 * t213 * t1616 * t595 * t626;
  t4176 = my_piecewise3(t2, 0, t4104 + t4174);
  t4177 = t58 * t58;
  t4179 = 0.1e1 / t632 / t4177;
  t4180 = t634 * t634;
  t4186 = t638 * t638;
  t4191 = -t4139;
  t4192 = my_piecewise5(t15, 0, t11, 0, t4191);
  t4196 = my_piecewise3(t59, 0, 0.4e2 / 0.81e2 * t4179 * t4180 - 0.16e2 / 0.9e1 * t1626 * t634 * t638 + 0.4e1 / 0.3e1 * t633 * t4186 + 0.16e2 / 0.9e1 * t1630 * t1634 + 0.4e1 / 0.3e1 * t60 * t4192);
  t4203 = t6 * t1638 * t132 * t79;
  t4207 = t6 * t642 * t314 * t79;
  t4211 = t6 * t250 * t726 * t79;
  t4216 = 0.1e2 / 0.27e2 * t6 * t62 * t1735 * t79;
  t4218 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t6 * t4196 * t27 * t79 - t4203 / 0.2e1 + t4207 / 0.2e1 - 0.5e1 / 0.9e1 * t4211 + t4216);
  t4221 = cbspline(-t195, 4, params);
  t4222 = t660 * t660;
  t4229 = t907 * t907;
  t4241 = t2047 * t282;
  t4243 = t682 * t692;
  t4247 = 0.1e1 / t89 / t1668 / t86;
  t4248 = t664 * t664;
  t4254 = t568 * t568;
  t4262 = my_piecewise3(t87, 0, -0.56e2 / 0.81e2 * t4247 * t4248 + 0.16e2 / 0.9e1 * t1670 * t664 * t568 - 0.2e1 / 0.3e1 * t663 * t4254 - 0.8e1 / 0.9e1 * t1674 * t1535 + 0.2e1 / 0.3e1 * t264 * t4139);
  t4265 = 0.1e1 / t94 / t1681 / t92;
  t4266 = t672 * t672;
  t4272 = t637 * t637;
  t4280 = my_piecewise3(t93, 0, -0.56e2 / 0.81e2 * t4265 * t4266 + 0.16e2 / 0.9e1 * t1683 * t672 * t637 - 0.2e1 / 0.3e1 * t671 * t4272 - 0.8e1 / 0.9e1 * t1687 * t1633 + 0.2e1 / 0.3e1 * t268 * t4191);
  t4283 = (t4262 / 0.2e1 + t4280 / 0.2e1) * t99;
  t4286 = t1696 * t289;
  t4288 = t681 * t709;
  t4290 = t274 * t1705;
  t4293 = 0.1e1 / t27 / t753;
  t4296 = 0.91e3 / 0.243e3 * t100 * t110 * t4293;
  t4298 = 0.12e3 * t755 * t844;
  t4299 = t815 * t815;
  t4302 = t801 * t801;
  t4303 = t818 * t818;
  t4307 = 0.24955700379505800916e5 * t123 / t4299 * t4302 / t4303;
  t4308 = t324 * t1927;
  t4312 = 0.24e2 * t1770 * t4302 * t319;
  t4316 = 0.62337092780453269531e3 * t382 * t1899 * t745 * t840;
  t4317 = t750 * t1712;
  t4319 = t750 * t1717;
  t4324 = 0.46785788981077169656e1 * t382 * t831 * t1835 * t369;
  t4329 = 0.69263436422725855036e2 * t382 * t713 * t1835 * t717 * t367;
  t4331 = t1844 * t745;
  t4334 = 0.61524113149298439947e4 * t382 * t1841 * t714 * t4331;
  t4335 = t888 * t1721;
  t4337 = t1708 * t885;
  t4339 = t4298 + t4307 + 0.48e2 * t4308 - t4312 + t4316 + 0.14035736694323150897e2 * t4317 - 0.20779030926817756511e3 * t4319 + t4324 - t4329 - t4334 - 0.22787578869697033845e-2 * t4335 + 0.14649157844805236043e-2 * t4337;
  t4342 = 0.21053605041484726346e2 * t382 * t715 * t836;
  t4344 = t1797 * t3 * t379;
  t4349 = 0.22911460125803964958e1 * t761 * t108 * t816 * t820;
  t4353 = 0.28493333333333333333e0 * t761 * t108 * t799 * t802;
  t4357 = 0.22161481481481481481e0 * t761 * t280 * t299 * t320;
  t4360 = 0.4274e0 * t761 * t1864 * t1725;
  t4364 = 0.18989649058080861537e-2 * t377 * t303 * t690 * t181;
  t4367 = 0.14246666666666666666e0 * t761 * t1868 * t812;
  t4370 = 0.71233333333333333332e-1 * t761 * t794 * t1757;
  t4374 = 0.3684616320282908548e2 * t761 * t293 * t1761 * t1765;
  t4378 = 0.68734380377411894876e1 * t761 * t293 * t1769 * t1771;
  t4380 = t147 * t339 * t2025;
  t4382 = t755 * t864;
  t4384 = -t4342 - 0.73245789224026180216e-3 * t4344 + t4349 - t4353 - t4357 - t4360 + t4364 + t4367 - t4370 - t4374 + t4378 + 0.4e1 * t4380 + 0.24e3 * t4382;
  t4386 = t1812 * t1818;
  t4390 = 0.38527786510141256862e1 * t895 * t294 * t1901;
  t4393 = 0.67471172535210825684e-1 * t895 * t1742 * t384;
  t4396 = 0.43374325201206959368e-1 * t895 * t733 * t747;
  t4399 = 0.12842595503380418954e1 * t895 * t733 * t718;
  t4401 = t861 * t116 * t896;
  t4405 = 0.21687162600603479684e-1 * t895 * t294 * t1837;
  t4408 = 0.38025319932552508021e2 * t895 * t294 * t1845;
  t4409 = t1812 * t1824;
  t4411 = t1812 * t1821;
  t4413 = t329 * t1927;
  t4415 = t876 * t864;
  t4417 = -0.1301229756036208781e0 * t4386 - t4390 + t4393 - t4396 - t4399 + 0.65061487801810439052e-1 * t4401 + t4405 + t4408 + 0.65061487801810439052e-1 * t4409 + 0.19263893255070628431e1 * t4411 - 0.48e2 * t4413 + 0.144e3 * t4415;
  t4420 = 0.84e3 * t144 * t3493 * t185;
  t4422 = t323 * t1440 * t185;
  t4423 = 0.192e4 * t4422;
  t4424 = t4137 * t185;
  t4425 = 0.384e3 * t4424;
  t4428 = 0.57895126195293126241e3 * t1770 * t1886 * t801;
  t4435 = 0.1e1 / t124 / t8 * t1704 * t761 / 0.48e2;
  t4437 = t1731 * t328;
  t4439 = t724 * t517;
  t4440 = t723 * t4439;
  t4442 = t303 * t690;
  t4443 = t302 * t4442;
  t4445 = t118 * t690;
  t4446 = t116 * t4445;
  t4448 = pow(t121, -0.25e1);
  t4451 = t4448 * t114 * t1704 * t761;
  t4453 = t1746 * t328;
  t4455 = t737 * t4439;
  t4457 = t310 * t4442;
  t4460 = t130 * t117 * t517;
  t4469 = t769 * t769;
  t4502 = 0.1e1 * t347 * (-0.39219166666666666667e1 * t4435 + 0.376504e2 * t4437 - 0.13944592592592592593e2 * t4440 + 0.12201518518518518519e2 * t4443 + 0.5356037037037037037e1 * t4446 + 0.14025833333333333333e0 * t4451 - 0.22441333333333333332e1 * t4453 + 0.24934814814814814815e1 * t4455 + 0.21817962962962962963e1 * t4457 + 0.16979925925925925926e1 * t4460) * t353 - t4307 - 0.24828486201251232145e5 * t159 / t783 / t766 * t4469 * t1953 + t4312 - 0.21687162600603479684e-1 * t761 * t826 * t1961 - 0.27397333333333333333e0 * t761 * t108 * t767 * t770 - t4349 + t4353 - 0.21309037037037037036e0 * t761 * t280 * t346 * t354 - 0.38025319932552508021e2 * t761 * t293 * t1841 * t1968 - 0.41096e0 * t761 * t1993 * t2008 - 0.67471172535210825684e-1 * t761 * t280 * t361 * t369 - 0.1301229756036208781e0 * t761 * t1981 * t1964 + t4357 + t4360 - 0.86748650402413918736e-1 * t761 * t108 * t831 * t833 - t4367;
  t4532 = t745 * t745;
  t4536 = t714 * t714;
  t4559 = 0.1e1 * t300 * (-0.21099166666666666667e1 * t4435 + 0.202552e2 * t4437 - 0.75019259259259259258e1 * t4440 + 0.6564185185185185185e1 * t4443 + 0.31003950617283950618e1 * t4446 + 0.68258333333333333335e-1 * t4451 - 0.10921333333333333333e1 * t4453 + 0.12134814814814814815e1 * t4455 + 0.10617962962962962963e1 * t4457 + 0.13388493827160493828e1 * t4460) * t319;
  t4560 = t4370 + t4374 - t4378 + 0.13698666666666666666e0 * t761 * t1986 * t780 + 0.44060335298551228073e1 * t761 * t108 * t784 * t788 + 0.12842595503380418954e1 * t761 * t108 * t713 * t840 - 0.14171548179536397724e3 * t761 * t293 * t1950 * t1954 + 0.13218100589565368422e2 * t761 * t293 * t1931 * t1934 - 0.68493333333333333332e-1 * t761 * t762 * t1946 + 0.43374325201206959368e-1 * t761 * t1974 * t836 + 0.38527786510141256862e1 * t761 * t293 * t1899 * t1958 - 0.35089341735807877242e1 * t832 * t4532 * t368 - 0.14035736694323150897e2 * t1957 * t4536 * t368 + 0.51947577317044391277e2 * t839 * t4532 * t717 + t4428 + 0.6233709278045326953e3 * t1967 * t4536 * t717 - t4559;
  t4562 = t712 * t712;
  t4563 = 0.1e1 / t4562;
  t4565 = t716 * t716;
  t4566 = 0.1e1 / t4565;
  t4573 = t783 * t783;
  t4576 = t786 * t786;
  t4591 = -0.28769444444444444444e1 * t4435 + 0.27618666666666666667e2 * t4437 - 0.10229135802469135803e2 * t4440 + 0.89504938271604938273e1 * t4443 + 0.31310740740740740741e1 * t4446 + 0.366775e-1 * t4451 - 0.58684e0 * t4453 + 0.65204444444444444445e0 * t4455 + 0.5705388888888888889e0 * t4457 + 0.13490888888888888889e1 * t4460;
  t4600 = 0.62071215503128080361e4 * t123 / t815 / t798 * t4302 * t1764;
  t4618 = 0.34367190188705947437e1 * t307 * t816 * t811 * t819 * t318;
  t4622 = 0.4274e0 * t307 * t799 * t318 * t812;
  t4625 = 0.57895126195293126241e3 * t1762 * t4302 * t819;
  t4626 = t811 * t811;
  t4629 = 0.48245938496077605201e2 * t817 * t4626 * t819;
  t4632 = 0.6e1 * t800 * t4626 * t319;
  t4636 = t779 * t779;
  t4643 = 0.91082604192152556044e5 * t172 * t4563 * t4536 * t4566 + 0.11579025239058625248e4 * t1951 * t4469 * t787 + 0.19964560303604640732e6 * t159 / t4573 * t4469 / t4576 + 0.5848223622634646207e0 * t362 * t4591 * t368 + t4600 - 0.19263893255070628431e1 * t307 * t1717 + 0.1301229756036208781e0 * t307 * t1712 - 0.6609050294782684211e1 * t307 * t784 * t779 * t787 * t352 + 0.41096e0 * t307 * t767 * t352 * t780 + t4618 - t4622 - t4625 - t4629 + t4632 - 0.24e2 * t1932 * t4469 * t353 - 0.6e1 * t768 * t4636 * t353 + 0.96491876992155210402e2 * t785 * t4636 * t787;
  t4649 = 0.8e1 * t800 * t320 * t1756;
  t4672 = 0.11483599538271604938e-1 * t116 * t4445 * t140;
  t4676 = 0.3103560775156404018e4 * t1762 * t811 * t1764 * t801;
  t4680 = 0.64327917994770140268e2 * t817 * t1756 * t819 * t318;
  t4690 = 0.36e2 * t817 * t802 * t811;
  t4701 = 0.1e1 / t712 / t830;
  t4706 = -0.11579025239058625248e4 * t1932 * t2014 * t769 + t4649 - 0.55209406483950617283e-2 * t116 * t4445 * t168 + 0.12865583598954028054e3 * t785 * t1945 * t787 * t352 + 0.36e2 * t785 * t770 * t779 + 0.12414243100625616072e5 * t1951 * t779 * t1953 * t769 - 0.8e1 * t768 * t354 * t1945 - 0.62337092780453269531e3 * t1957 * t1716 * t714 + t4672 - t4676 - t4680 - 0.18989649058080861537e-2 * t116 * t4445 * t181 + 0.69263436422725855036e2 * t839 * t1835 * t717 * t367 - t4690 + 0.61524113149298439947e4 * t1967 * t4331 * t714 + 0.21053605041484726346e2 * t839 * t833 * t745 - 0.46785788981077169656e1 * t832 * t369 * t1835 - 0.12304822629859687989e5 * t172 * t4701 * t4536 * t1844;
  t4710 = t147 * t157 * (t4502 + t4560 + t4643 + t4706);
  t4711 = t1533 * t373;
  t4712 = 0.96e2 * t4711;
  t4713 = t1857 * t373;
  t4714 = 0.576e3 * t4713;
  t4718 = 0.24e2 * t146 * t152 * t156 * t184;
  t4719 = t4420 - t4423 - t4425 - t4428 + t4710 + t4712 + t4559 - t4600 - t4714 + t4718 - t4618 + t4622 + t4625;
  t4723 = 0.1e1 / t90 / t1668;
  t4736 = my_piecewise3(t87, 0, 0.4e2 / 0.81e2 * t4723 * t4248 - 0.16e2 / 0.9e1 * t1775 * t664 * t568 + 0.4e1 / 0.3e1 * t846 * t4254 + 0.16e2 / 0.9e1 * t1778 * t1535 + 0.4e1 / 0.3e1 * t89 * t4139);
  t4738 = 0.1e1 / t95 / t1681;
  t4751 = my_piecewise3(t93, 0, 0.4e2 / 0.81e2 * t4738 * t4266 - 0.16e2 / 0.9e1 * t1786 * t672 * t637 + 0.4e1 / 0.3e1 * t853 * t4272 + 0.16e2 / 0.9e1 * t1789 * t1633 + 0.4e1 / 0.3e1 * t94 * t4191);
  t4753 = (t4736 + t4751) * t156;
  t4759 = 0.6233709278045326953e3 * t382 * t1841 * t4536 * t717;
  t4761 = t1797 * t172 * t384;
  t4763 = t750 * t1809;
  t4768 = 0.12304822629859687989e5 * t382 * t4701 * t4536 * t1844;
  t4769 = t1852 * t892;
  t4774 = 0.51947577317044391277e2 * t382 * t713 * t4532 * t717;
  t4778 = 0.35089341735807877242e1 * t382 * t831 * t4532 * t368;
  t4779 = t750 * t1901;
  t4781 = t755 * t862;
  t4783 = t324 * t1804;
  t4785 = 0.19751673498613801407e-1 * t4753 * t182 - t4759 - 0.23392894490538584828e1 * t4761 - 0.14035736694323150897e2 * t4763 + t4768 + 0.70178683471615754484e1 * t4769 - t4774 + t4778 + 0.4155806185363551302e3 * t4779 + t4629 + 0.12e3 * t4781 + 0.16e2 * t4783;
  t4786 = t329 * t1804;
  t4789 = t147 * t1797 * t372;
  t4791 = t879 * t862;
  t4794 = t147 * t861 * t843;
  t4801 = 0.91082604192152556044e5 * t382 * t4563 * t4536 * t4566;
  t4802 = t750 * t1845;
  t4807 = 0.5848223622634646207e0 * t382 * t361 * t4591 * t368;
  t4808 = t1852 * t718;
  t4810 = t750 * t1837;
  t4812 = t1852 * t747;
  t4817 = 0.14035736694323150897e2 * t382 * t1899 * t4536 * t368;
  t4819 = 0.16e2 * t329 * t2026;
  t4820 = -0.16e2 * t4786 + 0.4e1 * t4789 - 0.192e3 * t4791 + 0.6e1 * t4794 + t147 * t4753 * t184 - t4801 - 0.4101607543286562663e4 * t4802 - t4807 - 0.10389515463408878255e3 * t4808 - 0.23392894490538584828e1 * t4810 - 0.35089341735807877242e1 * t4812 + t4817 - t4819;
  t4822 = t879 * t844;
  t4823 = 0.192e3 * t4822;
  t4824 = t876 * t862;
  t4826 = t879 * t864;
  t4828 = t1533 * t340;
  t4830 = t324 * t2026;
  t4831 = 0.16e2 * t4830;
  t4832 = t1915 * t340;
  t4834 = t1915 * t373;
  t4835 = 0.96e3 * t4834;
  t4837 = t143 * t754 * t185;
  t4838 = 0.144e4 * t4837;
  t4839 = t329 * t1883;
  t4841 = t324 * t1883;
  t4843 = -t4823 + 0.72e2 * t4824 - t4632 - 0.384e3 * t4826 + 0.96e2 * t4828 + t4831 + 0.96e3 * t4832 + t4835 + t4838 - 0.48e2 * t4839 + 0.48e2 * t4841 - t4649;
  t4845 = 0.48e3 * t1918 * t373;
  t4846 = t1918 * t340;
  t4848 = t157 * t761;
  t4851 = 0.19263893255070628432e1 * t4848 * t1981 * t2011;
  t4854 = 0.1301229756036208781e0 * t4848 * t1997 * t1971;
  t4855 = t876 * t844;
  t4856 = 0.72e2 * t4855;
  t4857 = t1857 * t340;
  t4861 = 0.86748650402413918736e-1 * t895 * t733 * t892;
  t4862 = t1812 * t1815;
  t4866 = 0.1301229756036208781e0 * t895 * t294 * t1809;
  t4867 = -t4845 - 0.48e3 * t4846 - t4672 + t4676 + t4680 + t4690 + t4851 - t4854 + t4856 - 0.576e3 * t4857 + t4861 - 0.86748650402413918736e-1 * t4862 + t4866;
  t4870 = t4339 + t4384 + t4417 + t4719 + t4785 + t4820 + t4843 + t4867;
  t4877 = t275 * t2037;
  t4879 = t902 * t902;
  t4891 = t101 * t691 * t903;
  t4895 = t275 * t2071;
  t4900 = t101 * t691 * t701;
  t4904 = 0.7e1 / 0.36e2 * t4241 - 0.35e2 / 0.36e2 * t4243 + t101 * t109 * t286 * (-t4283 * t111 / 0.48e2 + 0.7e1 / 0.36e2 * t4286 - 0.35e2 / 0.36e2 * t4288 + 0.455e3 / 0.162e3 * t4290 - t4296 + params->gammac * t4870) / 0.48e2 - 0.7e1 / 0.12e2 * t4877 - t101 * t109 * t699 * t4879 / 0.8e1 + t275 * t2034 / 0.12e2 - t1003 * t1004 * t2032 * t389 / 0.6e1 + 0.35e2 / 0.36e2 * t4891 + t275 * t2064 / 0.2e1 + 0.7e1 / 0.6e1 * t4895 - t682 * t702 / 0.4e1 - 0.35e2 / 0.18e2 * t4900 + t682 * t904 / 0.8e1;
  t4908 = t101 * t2040 * t390;
  t4910 = t275 * t2044;
  t4913 = t101 * t281 * t2063;
  t4916 = 0.1e1 / t2060 / t191;
  t4917 = t700 * t700;
  t4922 = t682 * t695;
  t4931 = t101 * t281 * t2033;
  t4936 = 0.91e3 / 0.243e3 * t101 * t105 * t4293 * t192;
  t4937 = t275 * t2041;
  t4943 = t1003 * t2373 * t2067;
  t4945 = t2047 * t391 / 0.12e2 - 0.455e3 / 0.162e3 * t4908 + 0.35e2 / 0.18e2 * t4910 - 0.7e1 / 0.6e1 * t4913 - t101 * t109 * t4916 * t4917 / 0.2e1 - 0.7e1 / 0.12e2 * t4922 - t2381 * t2068 / 0.2e1 + 0.3e1 / 0.4e1 * t1003 * t2364 * t700 * t902 - 0.7e1 / 0.36e2 * t4931 - t4936 + 0.455e3 / 0.162e3 * t4937 - t4283 * t4 * t193 / 0.48e2 + 0.7e1 / 0.6e1 * t4943;
  t4956 = t1 * (t4176 + t4218) + t4221 * t4222 * t189 + 0.6e1 * t2178 * t1663 + 0.4e1 * t1661 * t387 + 0.3e1 * t659 * t4229 * t189 + 0.12e2 * t967 * t387 * t907 + 0.4e1 * t967 * t189 * t2076 + 0.6e1 * t661 * t900 + t263 * (t4904 + t4945) * t189 + 0.4e1 * t2077 * t387 + 0.6e1 * t908 * t900 + 0.4e1 * t395 * t2030 + t196 * t4870;
  tv4rho40 = t7 * t4956 + 0.4e1 * t1658 + 0.4e1 * t1662 + 0.12e2 * t1664 + 0.12e2 * t1666 + 0.4e1 * t2078 + 0.12e2 * t2079 + 0.12e2 * t2081 + 0.4e1 * t2083;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t4966 = t659 * t2076;
  t4988 = 0.12e2 * t146;
  t4989 = 0.24e2 * t4137;
  t4990 = -t4988 + t4989;
  t4991 = my_piecewise5(t11, 0, t15, 0, t4990);
  t4995 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t4125 * t401 * t1527 - 0.8e1 / 0.9e1 * t1526 * t919 * t562 - 0.8e1 / 0.9e1 * t2092 * t201 * t569 + 0.4e1 / 0.3e1 * t561 * t2103 * t201 + 0.4e1 / 0.3e1 * t2095 * t569 + 0.4e1 / 0.9e1 * t915 * t1536 + 0.4e1 / 0.3e1 * t24 * t4991);
  t5002 = t6 * t923 * t314 * t51;
  t5003 = t5002 / 0.4e1;
  t5014 = t932 * t1553;
  t5018 = t6 * t2107;
  t5021 = -0.3e1 / 0.8e1 * t6 * t4995 * t27 * t51 + t5003 + t4031 / 0.4e1 + t4035 / 0.4e1 - t4038 / 0.8e1 - 0.3e1 / 0.8e1 * t4085 - 0.5e1 / 0.12e2 * t4096 + t4098 / 0.2e1 + t4100 / 0.4e1 - 0.3e1 / 0.8e1 * t4102 - 0.3e1 / 0.8e1 * t932 * t1618 - 0.3e1 / 0.8e1 * t5014 - 0.3e1 / 0.8e1 * t932 * t1589 - 0.9e1 / 0.8e1 * t5018 * t241;
  t5024 = t932 * t1608;
  t5026 = t2116 * t590;
  t5030 = t932 * t1550;
  t5031 = t5030 / 0.4e1;
  t5040 = t6 * t404 * t726 * t51;
  t5044 = t6 * t2107 * t132 * t51;
  t5047 = -0.9e1 / 0.8e1 * t2116 * t596 - 0.3e1 / 0.8e1 * t5024 - 0.3e1 / 0.4e1 * t5026 - 0.9e1 / 0.8e1 * t2116 * t627 + t5031 - 0.9e1 / 0.8e1 * t932 * t1612 - t4107 / 0.8e1 - 0.3e1 / 0.8e1 * t4121 - 0.5e1 / 0.12e2 * t4151 - t4155 / 0.8e1 + t4160 - 0.5e1 / 0.36e2 * t5040 - 0.3e1 / 0.8e1 * t5044 - 0.3e1 / 0.8e1 * t4164;
  t5049 = my_piecewise3(t2, 0, t5021 + t5047);
  t5067 = my_piecewise5(t15, 0, t11, 0, -t4990);
  t5071 = my_piecewise3(t59, 0, 0.4e2 / 0.81e2 * t4179 * t412 * t1627 - 0.8e1 / 0.9e1 * t1626 * t942 * t634 - 0.8e1 / 0.9e1 * t2137 * t247 * t638 + 0.4e1 / 0.3e1 * t633 * t2146 * t247 + 0.4e1 / 0.3e1 * t2140 * t638 + 0.4e1 / 0.9e1 * t939 * t1634 + 0.4e1 / 0.3e1 * t60 * t5067);
  t5078 = t6 * t2150 * t132 * t79;
  t5082 = t6 * t946 * t314 * t79;
  t5083 = t5082 / 0.4e1;
  t5086 = t6 * t415 * t726 * t79;
  t5091 = t6 * t1638;
  t5094 = t2165 * t960;
  t5096 = t956 * t2171;
  t5097 = t5096 / 0.4e1;
  t5098 = t726 * t421;
  t5100 = t420 * t5098 * t441;
  t5102 = -0.3e1 / 0.8e1 * t6 * t5071 * t27 * t79 - 0.3e1 / 0.8e1 * t5078 + t5083 - 0.5e1 / 0.36e2 * t5086 - t4203 / 0.8e1 + t4207 / 0.4e1 - 0.5e1 / 0.12e2 * t4211 + t4216 - 0.3e1 / 0.8e1 * t5091 * t442 - 0.3e1 / 0.8e1 * t5094 + t5097 - 0.5e1 / 0.36e2 * t5100;
  t5103 = my_piecewise3(t56, 0, t5102);
  t5106 = t1857 * t471;
  t5107 = 0.144e3 * t5106;
  t5108 = t1915 * t471;
  t5109 = 0.24e3 * t5108;
  t5110 = t1918 * t471;
  t5112 = t324 * t2311;
  t5113 = 0.12e2 * t5112;
  t5114 = t1050 * t1901;
  t5116 = t1050 * t1837;
  t5119 = t2292 * t172 * t384;
  t5121 = t2333 * t747;
  t5122 = 0.17544670867903938621e1 * t5121;
  t5123 = 0.12e2 * t4308;
  t5126 = -t5107 + t5109 - 0.12e3 * t5110 + t4298 + t5113 + t4307 + 0.10389515463408878255e3 * t5114 - 0.5848223622634646207e0 * t5116 - 0.17544670867903938621e1 * t5119 - t5122 + t5123 - t4312 + t4316 + 0.10526802520742363173e2 * t4317 - 0.15584273195113317383e3 * t4319 + t4324;
  t5132 = -t4329 - t4334 - 0.17090684152272775383e-2 * t4335 + 0.73245789224026180215e-3 * t4337 - t4342 - 0.18311447306006545054e-3 * t4344 + t4349 - t4353 - t4357 - t4360 + t4364 + t4367 - t4370 - t4374 + t4378 + 0.3e1 * t4380 + 0.18e3 * t4382;
  t5142 = t565 * t664;
  t5145 = t200 * t568;
  t5151 = t146 * t200;
  t5154 = t565 * t568;
  t5162 = 0.32e2 * t1027 * t328;
  t5164 = my_piecewise3(t87, 0, 0.4e2 / 0.81e2 * t4723 * t400 * t1671 - 0.16e2 / 0.9e1 * t1775 * t17 * t5142 - 0.8e1 / 0.9e1 * t2263 * t5145 + 0.8e1 / 0.3e1 * t846 * t565 * t200 - 0.8e1 * t2266 * t5151 + 0.8e1 / 0.3e1 * t2266 * t5154 + 0.4e1 / 0.9e1 * t1024 * t1535 - 0.16e2 * t89 * t146 + t5162);
  t5169 = t565 * t672;
  t5172 = t246 * t637;
  t5178 = t146 * t246;
  t5181 = t565 * t637;
  t5189 = 0.32e2 * t1035 * t328;
  t5191 = my_piecewise3(t93, 0, 0.4e2 / 0.81e2 * t4738 * t411 * t1684 + 0.16e2 / 0.9e1 * t1786 * t17 * t5169 - 0.8e1 / 0.9e1 * t2277 * t5172 - 0.8e1 / 0.3e1 * t853 * t565 * t246 + 0.8e1 * t2280 * t5178 - 0.8e1 / 0.3e1 * t2280 * t5181 + 0.4e1 / 0.9e1 * t1032 * t1633 + 0.16e2 * t94 * t146 - t5189);
  t5193 = (t5164 + t5191) * t156;
  t5197 = t1050 * t1809;
  t5199 = t2327 * t1821;
  t5202 = t1041 * t116 * t896;
  t5203 = 0.32530743900905219526e-1 * t5202;
  t5204 = t2327 * t1824;
  t5206 = -0.97592231702715658578e-1 * t4386 - t4390 + t4393 - t4396 - t4399 + 0.32530743900905219526e-1 * t4401 + t4405 + t4408 + 0.48796115851357829289e-1 * t4409 + 0.14447919941302971323e1 * t4411 + 0.19751673498613801407e-1 * t5193 * t182 - 0.36e2 * t4413 - 0.35089341735807877242e1 * t5197 + 0.48159733137676571078e0 * t5199 + t5203 + 0.16265371950452609763e-1 * t5204;
  t5207 = t1050 * t1717;
  t5209 = 0.36e2 * t4415;
  t5210 = 0.96e3 * t4422;
  t5211 = t2319 * t885;
  t5212 = 0.73245789224026180216e-3 * t5211;
  t5213 = t1014 * t1721;
  t5215 = t1050 * t1845;
  t5217 = t2333 * t718;
  t5218 = 0.51947577317044391276e2 * t5217;
  t5219 = 0.192e3 * t4424;
  t5220 = t1050 * t1712;
  t5222 = 0.48e2 * t4711;
  t5223 = -0.51947577317044391277e2 * t5207 - t5209 + t4420 - t5210 + t5212 - 0.56968947174242584612e-3 * t5213 - 0.10254018858216406658e4 * t5215 - t5218 + t5219 - t4428 + t4710 + 0.35089341735807877242e1 * t5220 - t5222 + t4559 - t4600 - t4718 - t4618;
  t5226 = t2333 * t892;
  t5227 = 0.35089341735807877242e1 * t5226;
  t5228 = t329 * t2311;
  t5234 = t876 * t1044;
  t5235 = 0.36e2 * t5234;
  t5238 = t4622 + t5227 + t4625 - 0.12e2 * t5228 - t4759 - 0.5848223622634646207e0 * t4761 - 0.10526802520742363173e2 * t4763 + t4768 + 0.35089341735807877242e1 * t4769 - t4774 + t4778 + 0.31168546390226634765e3 * t4779 + t4629 + t5235 + 0.6e2 * t4781 - 0.4e1 * t4783;
  t5241 = 0.24e2 * t324 * t2260;
  t5242 = t876 * t1042;
  t5243 = 0.36e2 * t5242;
  t5251 = 0.96e2 * t4822;
  t5253 = -0.4e1 * t4786 + t5241 + t5243 + t4789 + 0.3e1 * t4794 - t4801 - 0.30762056574649219973e4 * t4802 - t4807 - 0.51947577317044391277e2 * t4808 - 0.17544670867903938621e1 * t4810 - 0.17544670867903938621e1 * t4812 + t4817 - t4819 + t147 * t5193 * t184 - t5251 - 0.36e2 * t4824 - t4632;
  t5255 = 0.96e2 * t4826;
  t5257 = t2327 * t1815;
  t5259 = t2327 * t1818;
  t5261 = 0.8e1 * t4830;
  t5262 = t329 * t2260;
  t5263 = 0.24e2 * t5262;
  t5264 = 0.24e3 * t4832;
  t5265 = 0.48e3 * t4834;
  t5268 = t147 * t1041 * t843;
  t5269 = 0.3e1 * t5268;
  t5271 = t147 * t470 * t2025;
  t5272 = t755 * t1044;
  t5274 = t1533 * t471;
  t5276 = t879 * t1044;
  t5277 = 0.96e2 * t5276;
  t5278 = t755 * t1042;
  t5279 = 0.6e2 * t5278;
  t5280 = -t5255 - 0.72e2 * t4828 - 0.21687162600603479684e-1 * t5257 - 0.32530743900905219526e-1 * t5259 + t5261 - t5263 + t5264 + t5265 - 0.24e2 * t4839 + t5269 + t5271 - t4649 + 0.6e2 * t5272 + 0.24e2 * t5274 - t5277 + t5279;
  t5283 = t2292 * t3 * t379;
  t5286 = 0.96e2 * t879 * t1042;
  t5287 = 0.144e3 * t4857;
  t5289 = t147 * t2292 * t372;
  t5291 = t329 * t2293;
  t5293 = t324 * t2293;
  t5296 = -t4845 - 0.36e3 * t4846 - 0.54934341918019635162e-3 * t5283 - t5286 - t4672 + t4676 + t4680 + t4690 + t4851 - t4854 + t5287 + 0.3e1 * t5289 - 0.12e2 * t5291 + 0.12e2 * t5293 + t4861 - 0.65061487801810439052e-1 * t4862 + t4866;
  t5299 = t5126 + t5132 + t5206 + t5223 + t5238 + t5253 + t5280 + t5296;
  t5310 = t2385 * t189;
  t5313 = 0.3e1 * t1062 * t900 + t4966 * t968 + 0.3e1 * t2178 * t2185 + 0.3e1 * t2178 * t2182 + t1 * (t5049 + t5103) + t196 * t5299 + t483 * t2030 + 0.3e1 * t2386 * t387 + 0.3e1 * t967 * t482 * t900 + 0.3e1 * t967 * t475 * t907 + 0.3e1 * t967 * t5310;
  t5320 = t1061 * t387;
  t5329 = t458 * t2041;
  t5343 = t989 * t692;
  t5344 = 0.35e2 / 0.72e2 * t5343;
  t5351 = t1003 * t690 * t699 * t1005;
  t5352 = 0.35e2 / 0.36e2 * t5351;
  t5356 = t1003 * t2373 * t2369;
  t5358 = 0.7e1 / 0.144e3 * t4241 - 0.35e2 / 0.72e2 * t4243 + 0.455e3 / 0.648e3 * t5329 - 0.7e1 / 0.48e2 * t4877 - t2381 * t2378 / 0.4e1 - t681 * t110 * t1006 / 0.8e1 - t1003 * t1004 * t477 * t2032 / 0.24e2 - t2603 * t2068 / 0.8e1 - t5344 - t1003 * t1004 * t1056 * t902 / 0.8e1 - t5352 - t2381 * t2370 / 0.8e1 + 0.7e1 / 0.24e2 * t5356;
  t5359 = t2381 * t2374;
  t5369 = t101 * t281 * t2351;
  t5372 = t280 * t2061;
  t5374 = t1003 * t5372 * t2365;
  t5376 = t108 * t4916;
  t5381 = t2232 * t282;
  t5383 = 0.7e1 / 0.12e2 * t5359 + 0.35e2 / 0.72e2 * t4891 + 0.7e1 / 0.24e2 * t4895 - 0.35e2 / 0.36e2 * t4900 - 0.455e3 / 0.216e3 * t4908 + 0.35e2 / 0.36e2 * t4910 - 0.7e1 / 0.24e2 * t4913 - 0.7e1 / 0.48e2 * t4922 - 0.7e1 / 0.48e2 * t5369 - 0.7e1 / 0.144e3 * t4931 - 0.7e1 / 0.8e1 * t5374 - t1003 * t5376 * t477 * t2062 / 0.2e1 + 0.7e1 / 0.48e2 * t5381;
  t5405 = 0.16e2 * t973 * t328;
  t5407 = my_piecewise3(t87, 0, -0.56e2 / 0.81e2 * t4247 * t400 * t1671 + 0.16e2 / 0.9e1 * t1670 * t17 * t5142 + 0.8e1 / 0.9e1 * t2199 * t5145 - 0.4e1 / 0.3e1 * t663 * t565 * t200 + 0.4e1 * t2202 * t5151 - 0.4e1 / 0.3e1 * t2202 * t5154 - 0.2e1 / 0.9e1 * t970 * t1535 - 0.8e1 * t264 * t146 + t5405);
  t5428 = 0.16e2 * t981 * t328;
  t5430 = my_piecewise3(t93, 0, -0.56e2 / 0.81e2 * t4265 * t411 * t1684 - 0.16e2 / 0.9e1 * t1683 * t17 * t5169 + 0.8e1 / 0.9e1 * t2214 * t5172 + 0.4e1 / 0.3e1 * t671 * t565 * t246 - 0.4e1 * t2217 * t5178 + 0.4e1 / 0.3e1 * t2217 * t5181 - 0.2e1 / 0.9e1 * t978 * t1633 + 0.8e1 * t268 * t146 - t5428);
  t5433 = (t5407 / 0.2e1 + t5430 / 0.2e1) * t99;
  t5438 = t101 * t691 * t1057;
  t5439 = 0.35e2 / 0.72e2 * t5438;
  t5440 = t458 * t2071;
  t5444 = t682 * t1000;
  t5448 = t458 * t2044;
  t5449 = 0.35e2 / 0.72e2 * t5448;
  t5450 = t458 * t2037;
  t5452 = t275 * t2193;
  t5453 = 0.35e2 / 0.72e2 * t5452;
  t5455 = t101 * t2040 * t478;
  t5457 = t275 * t2355;
  t5463 = -t5433 * t4 * t193 / 0.48e2 + t5439 + 0.7e1 / 0.24e2 * t5440 - t989 * t702 / 0.8e1 - 0.7e1 / 0.48e2 * t5444 + t458 * t2034 / 0.48e2 + t5449 - 0.7e1 / 0.48e2 * t5450 + t5453 - 0.455e3 / 0.648e3 * t5455 - 0.7e1 / 0.24e2 * t5457 + t2232 * t391 / 0.16e2 + t2047 * t479 / 0.48e2;
  t5468 = t2231 * t289;
  t5470 = t988 * t709;
  t5471 = 0.35e2 / 0.72e2 * t5470;
  t5472 = t457 * t1705;
  t5497 = t1003 * t2373 * t2377;
  t5504 = t989 * t695;
  t5510 = t682 * t1058 / 0.16e2 + t101 * t109 * t286 * (-t5433 * t111 / 0.48e2 + 0.7e1 / 0.48e2 * t5468 - t5471 + 0.455e3 / 0.648e3 * t5472 + 0.7e1 / 0.144e3 * t4286 - 0.35e2 / 0.72e2 * t4288 + 0.455e3 / 0.216e3 * t4290 - t4296 + params->gammac * t5299) / 0.48e2 + t458 * t2064 / 0.8e1 - t4936 + 0.455e3 / 0.216e3 * t4937 - t1003 * t1004 * t2350 * t389 / 0.8e1 + 0.3e1 / 0.8e1 * t1003 * t2364 * t1056 * t700 + 0.3e1 / 0.8e1 * t2381 * t2366 + 0.7e1 / 0.12e2 * t5497 + 0.7e1 / 0.24e2 * t4943 + t275 * t2352 / 0.16e2 + t989 * t904 / 0.16e2 - 0.7e1 / 0.24e2 * t5504 + 0.3e1 / 0.8e1 * t1003 * t2364 * t1005 * t902;
  t5515 = t4221 * t1660;
  t5522 = t2077 * t475 + 0.3e1 * t661 * t1054 + 0.3e1 * t2473 * t968 * t907 + 0.6e1 * t967 * t5320 + 0.3e1 * t2180 * t2185 + 0.3e1 * t2180 * t2182 + t263 * (t5358 + t5383 + t5463 + t5510) * t189 + t5515 * t968 + t1661 * t475 + 0.3e1 * t908 * t1054 + 0.3e1 * t395 * t2348;
  t5532 = 0.3e1 * t2387 + 0.3e1 * t2177 + 0.3e1 * t2181 + t2083 + t2082 + t2080 + t1662 + t1658 + t2078 + t1667 + t1665;
  tv4rho41 = 0.3e1 * t2395 + 0.3e1 * t2391 + 0.6e1 * t2393 + 0.3e1 * t2392 + 0.3e1 * t2390 + 0.6e1 * t2388 + t7 * (t5313 + t5522) + 0.3e1 * t2179 + 0.6e1 * t2186 + 0.6e1 * t2183 + t5532;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t5545 = 0.2e1 * t2475 + 0.2e1 * t2181 + 0.2e1 * t2480 + 0.4e1 * t2476 + 0.4e1 * t2641 + 0.2e1 * t2643 + 0.4e1 * t2639 + 0.2e1 * t2634 + 0.4e1 * t2183 + 0.4e1 * t2393 + 0.2e1 * t2179 + 0.2e1 * t2478;
  t5553 = t6 * t2411 * t132 * t51;
  t5555 = t6 * t2411;
  t5560 = t6 * t1081 * t314 * t51;
  t5562 = t2420 * t590;
  t5575 = t919 * t919;
  t5588 = my_piecewise5(t11, 0, t15, 0, t4989);
  t5592 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t4125 * t1072 * t562 - 0.32e2 / 0.27e2 * t2092 * t201 * t919 - 0.8e1 / 0.27e2 * t2398 * t569 + 0.8e1 / 0.9e1 * t561 * t5575 + 0.8e1 / 0.9e1 * t915 * t2103 - 0.8e1 / 0.27e2 * t1526 * t1077 * t562 + 0.8e1 / 0.9e1 * t561 * t2407 * t201 + 0.4e1 / 0.9e1 * t2403 * t569 + 0.4e1 / 0.3e1 * t24 * t5588);
  t5612 = -0.5e1 / 0.18e2 * t5040 + t5030 / 0.3e1 - t5014 / 0.4e1 - t5044 / 0.4e1 - 0.3e1 / 0.8e1 * t2420 * t596 - t5024 / 0.4e1 + t4160 - 0.5e1 / 0.18e2 * t4096 + t4098 / 0.6e1 + t4100 / 0.12e2 + t4031 / 0.12e2;
  t5614 = my_piecewise3(t2, 0, -t5553 / 0.4e1 - 0.3e1 / 0.4e1 * t5555 * t241 + t5560 / 0.12e2 - t5562 / 0.4e1 - 0.3e1 / 0.8e1 * t2420 * t627 + t4035 / 0.12e2 - 0.3e1 / 0.8e1 * t6 * t5592 * t27 * t51 - 0.5e1 / 0.18e2 * t4151 + t5002 / 0.3e1 - t5026 / 0.2e1 + t5612);
  t5616 = t420 * t2170 * t1136;
  t5626 = t942 * t942;
  t5639 = my_piecewise5(t15, 0, t11, 0, -t4989);
  t5643 = my_piecewise3(t59, 0, 0.4e2 / 0.81e2 * t4179 * t1089 * t634 - 0.32e2 / 0.27e2 * t2137 * t247 * t942 - 0.8e1 / 0.27e2 * t2428 * t638 + 0.8e1 / 0.9e1 * t633 * t5626 + 0.8e1 / 0.9e1 * t939 * t2146 - 0.8e1 / 0.27e2 * t1626 * t1093 * t634 + 0.8e1 / 0.9e1 * t633 * t2437 * t247 + 0.4e1 / 0.9e1 * t2433 * t638 + 0.4e1 / 0.3e1 * t60 * t5639);
  t5654 = t6 * t2441 * t132 * t79;
  t5658 = t6 * t1097 * t314 * t79;
  t5660 = t6 * t2150;
  t5667 = t2451 * t960;
  t5669 = t1103 * t2171;
  t5671 = t956 * t2461;
  t5673 = t314 * t1107;
  t5675 = t420 * t5673 * t1109;
  t5677 = t956 * t2466;
  t5684 = -t5667 / 0.2e1 + t5669 / 0.6e1 - t5671 / 0.4e1 + t5675 / 0.12e2 - t5677 / 0.4e1 - 0.5e1 / 0.18e2 * t5100 - t5094 / 0.4e1 + t5096 / 0.3e1 + t4207 / 0.12e2 - 0.5e1 / 0.18e2 * t4211 + t4216;
  t5686 = my_piecewise3(t56, 0, t5616 / 0.12e2 - 0.3e1 / 0.8e1 * t6 * t5643 * t27 * t79 - 0.3e1 / 0.8e1 * t2165 * t1110 - 0.3e1 / 0.8e1 * t2165 * t1137 - t5654 / 0.4e1 + t5658 / 0.12e2 - 0.3e1 / 0.4e1 * t5660 * t442 - t5078 / 0.4e1 + t5082 / 0.3e1 - 0.5e1 / 0.18e2 * t5086 + t5684);
  t5689 = t1211 * t387;
  t5699 = t200 * t17 * t565;
  t5720 = my_piecewise3(t87, 0, 0.4e2 / 0.81e2 * t4723 * t1147 * t664 - 0.64e2 / 0.27e2 * t2263 * t5699 - 0.8e1 / 0.27e2 * t2549 * t568 + 0.32e2 / 0.9e1 * t846 * t143 * t754 + 0.16e2 / 0.9e1 * t1024 * t565 - 0.16e2 / 0.3e1 * t1024 * t1533 - 0.8e1 / 0.27e2 * t1775 * t1076 * t664 + 0.8e1 / 0.9e1 * t846 * t2406 * t200 + 0.4e1 / 0.9e1 * t2554 * t568 + t5162);
  t5725 = t246 * t17 * t565;
  t5746 = my_piecewise3(t93, 0, 0.4e2 / 0.81e2 * t4738 * t1154 * t672 + 0.64e2 / 0.27e2 * t2277 * t5725 - 0.8e1 / 0.27e2 * t2561 * t637 + 0.32e2 / 0.9e1 * t853 * t143 * t754 - 0.16e2 / 0.9e1 * t1032 * t565 + 0.16e2 / 0.3e1 * t1032 * t1533 - 0.8e1 / 0.27e2 * t1786 * t1092 * t672 + 0.8e1 / 0.9e1 * t853 * t2436 * t246 + 0.4e1 / 0.9e1 * t2566 * t637 - t5189);
  t5748 = (t5720 + t5746) * t156;
  t5757 = t324 * t2581;
  t5759 = t2527 * t892;
  t5762 = 0.96e2 * t5106 + 0.16e3 * t5108 - 0.24e3 * t5110 + t4298 + 0.19751673498613801407e-1 * t5748 * t182 + 0.8e1 * t5112 + t4307 + 0.2077903092681775651e3 * t5114 - 0.11696447245269292414e1 * t5116 - 0.11696447245269292414e1 * t5119 - 0.23392894490538584828e1 * t5121 - 0.8e1 * t4308 + 0.8e1 * t5757 + 0.11696447245269292414e1 * t5759 - t4312 + t4316 + 0.70178683471615754484e1 * t4317;
  t5767 = t329 * t2525;
  t5769 = -0.10389515463408878255e3 * t4319 + t4324 - t4329 - t4334 - 0.11393789434848516922e-2 * t4335 + 0.24415263074675393405e-3 * t4337 - t4342 + t4349 - t4353 - t4357 - t4360 + t4364 + t4367 - t4370 - t4374 + t4378 + 0.2e1 * t4380 - 0.8e1 * t5767;
  t5772 = t2518 * t885;
  t5779 = t876 * t1193;
  t5781 = t879 * t1193;
  t5786 = 0.12e3 * t4382 + 0.24415263074675393405e-3 * t5772 - 0.65061487801810439052e-1 * t4386 - t4390 + t4393 - t4396 - t4399 + 0.10843581300301739842e-1 * t4401 + t4405 + t4408 + 0.32530743900905219526e-1 * t4409 + 0.96319466275353142156e0 * t4411 - 0.24e2 * t4413 + 0.12e2 * t5779 - 0.32e2 * t5781 - 0.70178683471615754484e1 * t5197 + t147 * t5748 * t184;
  t5787 = t329 * t2581;
  t5793 = t2527 * t718;
  t5796 = t2574 * t172 * t384;
  t5798 = t2527 * t747;
  t5806 = -0.8e1 * t5787 + 0.96319466275353142155e0 * t5199 + 0.43374325201206959368e-1 * t5202 + 0.32530743900905219526e-1 * t5204 - 0.10389515463408878255e3 * t5207 - 0.17315859105681463759e2 * t5793 - 0.11696447245269292414e1 * t5796 - 0.5848223622634646207e0 * t5798 - 0.24e2 * t4415 + t4420 + 0.97661052298701573622e-3 * t5211 - 0.11393789434848516923e-2 * t5213 - 0.20508037716432813315e4 * t5215 - 0.69263436422725855034e2 * t5217 - t4428 + t4710 + 0.70178683471615754484e1 * t5220 + t4559;
  t5810 = t755 * t1193;
  t5813 = t2574 * t3 * t379;
  t5815 = t324 * t2525;
  t5821 = -t4600 + 0.192e3 * t4713 + 0.2e2 * t5810 - 0.36622894612013090108e-3 * t5813 + t4718 + 0.8e1 * t5815 - t4618 + t4622 + 0.46785788981077169656e1 * t5226 + t4625 - 0.24e2 * t5228 - t4759 - 0.70178683471615754484e1 * t4763 + t4768 + 0.11696447245269292414e1 * t4769 - t4774 + t4778;
  t5833 = 0.2077903092681775651e3 * t4779 + t4629 - 0.24e2 * t5234 + 0.2e2 * t4781 - 0.48e2 * t5242 + 0.32e2 * t4791 + t4794 - t4801 - 0.20508037716432813316e4 * t4802 - t4807 - 0.17315859105681463759e2 * t4808 - 0.11696447245269292414e1 * t4810 - 0.5848223622634646207e0 * t4812 + t4817 - t4819 + 0.12e2 * t4824 - t4632 + 0.64e2 * t4826;
  t5839 = t147 * t2574 * t372;
  t5842 = t147 * t1192 * t843;
  t5854 = 0.48e2 * t4828 - 0.43374325201206959368e-1 * t5257 - 0.65061487801810439052e-1 * t5259 + 0.2e1 * t5839 + t5842 - 0.32e2 * t5262 - 0.16e3 * t4832 - 0.48e3 * t4837 - 0.8e1 * t4839 - 0.8e1 * t4841 + 0.4e1 * t5268 + 0.2e1 * t5271 - t4649 + 0.12e3 * t5272 - 0.48e2 * t5274 - 0.64e2 * t5276 + 0.8e2 * t5278;
  t5856 = t1192 * t116 * t896;
  t5866 = 0.10843581300301739842e-1 * t5856 - t4845 - 0.24e3 * t4846 - 0.36622894612013090108e-3 * t5283 - t4672 + t4676 + t4680 + t4690 + t4851 - t4854 - 0.24e2 * t4855 + 0.96e2 * t4857 + 0.2e1 * t5289 - 0.8e1 * t5291 - 0.8e1 * t5293 + t4861 - 0.43374325201206959367e-1 * t4862 + t4866;
  t5869 = t5762 + t5769 + t5786 + t5806 + t5821 + t5833 + t5854 + t5866;
  t5871 = t4221 * t660;
  t5873 = t1061 * t1061;
  t5891 = t1 * (t5614 + t5686) + 0.2e1 * t967 * t5689 + t196 * t5869 + t5871 * t2474 + 0.2e1 * t659 * t5873 * t189 + t2178 * t2479 + 0.4e1 * t967 * t482 * t1054 + t2180 * t2479 + t908 * t1204 + 0.2e1 * t1329 * t5310 + 0.2e1 * t2180 * t2636 + 0.2e1 * t2178 * t2636 + 0.2e1 * t395 * t2585;
  t5899 = t1659 * t907;
  t5905 = t1061 * t475;
  t5908 = t2632 * t189;
  t5911 = t989 * t1000;
  t5915 = t275 * t2619;
  t5921 = t1056 * t1056;
  t5936 = t2626 * t282;
  t5964 = my_piecewise3(t87, 0, -0.56e2 / 0.81e2 * t4247 * t1147 * t664 + 0.64e2 / 0.27e2 * t2199 * t5699 + 0.8e1 / 0.27e2 * t2485 * t568 - 0.16e2 / 0.9e1 * t663 * t143 * t754 - 0.8e1 / 0.9e1 * t970 * t565 + 0.8e1 / 0.3e1 * t970 * t1533 + 0.8e1 / 0.27e2 * t1670 * t1076 * t664 - 0.4e1 / 0.9e1 * t663 * t2406 * t200 - 0.2e1 / 0.9e1 * t2490 * t568 + t5405);
  t5988 = my_piecewise3(t93, 0, -0.56e2 / 0.81e2 * t4265 * t1154 * t672 - 0.64e2 / 0.27e2 * t2214 * t5725 + 0.8e1 / 0.27e2 * t2497 * t637 - 0.16e2 / 0.9e1 * t671 * t143 * t754 + 0.8e1 / 0.9e1 * t978 * t565 - 0.8e1 / 0.3e1 * t978 * t1533 + 0.8e1 / 0.27e2 * t1683 * t1092 * t672 - 0.4e1 / 0.9e1 * t671 * t2436 * t246 - 0.2e1 / 0.9e1 * t2502 * t637 - t5428);
  t5991 = (t5964 / 0.2e1 + t5988 / 0.2e1) * t99;
  t5999 = -0.7e1 / 0.36e2 * t5911 - t1164 * t702 / 0.24e2 + 0.7e1 / 0.36e2 * t5915 - 0.35e2 / 0.216e3 * t4243 + 0.455e3 / 0.324e3 * t5329 + t989 * t1058 / 0.12e2 - t101 * t109 * t699 * t5921 / 0.12e2 + t682 * t1208 / 0.48e2 + t2626 * t391 / 0.24e2 - t682 * t1173 / 0.24e2 + t1003 * t2364 * t1005 * t1056 / 0.2e1 + 0.7e1 / 0.72e2 * t5936 - 0.35e2 / 0.54e2 * t5343 + t458 * t2352 / 0.24e2 - t5991 * t4 * t193 / 0.48e2 - t1003 * t1004 * t2587 * t389 / 0.12e2;
  t6004 = t101 * t691 * t1207;
  t6010 = t1164 * t692;
  t6014 = t458 * t2355;
  t6018 = t2511 * t289;
  t6020 = t1163 * t709;
  t6036 = t1164 * t695;
  t6042 = -0.35e2 / 0.27e2 * t5351 + 0.7e1 / 0.36e2 * t5356 + 0.7e1 / 0.18e2 * t5359 + 0.35e2 / 0.216e3 * t6004 + 0.35e2 / 0.216e3 * t4891 - 0.35e2 / 0.108e3 * t4900 - 0.455e3 / 0.324e3 * t4908 + 0.35e2 / 0.108e3 * t4910 - 0.35e2 / 0.216e3 * t6010 + t275 * t2589 / 0.24e2 - 0.7e1 / 0.36e2 * t6014 + t101 * t109 * t286 * (-t5991 * t111 / 0.48e2 + 0.7e1 / 0.72e2 * t6018 - 0.35e2 / 0.216e3 * t6020 + 0.7e1 / 0.72e2 * t5468 - 0.35e2 / 0.54e2 * t5470 + 0.455e3 / 0.324e3 * t5472 - 0.35e2 / 0.216e3 * t4288 + 0.455e3 / 0.324e3 * t4290 - t4296 + params->gammac * t5869) / 0.48e2 + t2232 * t479 / 0.24e2 - 0.7e1 / 0.72e2 * t5369 - 0.7e1 / 0.72e2 * t6036 + t1164 * t904 / 0.48e2 - t2381 * t2607 / 0.12e2;
  t6054 = t1003 * t2373 * t2606;
  t6066 = t1003 * t5372 * t2610;
  t6069 = t1003 * t2373 * t2599;
  t6085 = t101 * t691 * t1172;
  t6088 = -t988 * t110 * t1006 / 0.6e1 + t2381 * t2611 / 0.4e1 - t2381 * t2600 / 0.6e1 - t2603 * t2378 / 0.6e1 + 0.7e1 / 0.36e2 * t6054 - 0.7e1 / 0.12e2 * t5374 + t1003 * t2364 * t1206 * t700 / 0.8e1 - t1003 * t1004 * t1206 * t902 / 0.24e2 - 0.7e1 / 0.12e2 * t6066 + 0.7e1 / 0.18e2 * t6069 - t1003 * t5376 * t1171 * t700 / 0.2e1 - t1003 * t1004 * t477 * t2350 / 0.12e2 + t1003 * t2364 * t1171 * t902 / 0.8e1 + 0.7e1 / 0.72e2 * t5381 - 0.35e2 / 0.108e3 * t6085 + 0.35e2 / 0.54e2 * t5438;
  t6096 = t458 * t2193;
  t6103 = t2603 * t2374;
  t6108 = t101 * t281 * t2588;
  t6110 = t275 * t2616;
  t6112 = 0.7e1 / 0.36e2 * t5440 - 0.7e1 / 0.72e2 * t5444 + 0.35e2 / 0.54e2 * t5448 - 0.7e1 / 0.72e2 * t5450 + 0.35e2 / 0.54e2 * t5452 - 0.455e3 / 0.324e3 * t5455 - 0.7e1 / 0.36e2 * t5457 + 0.35e2 / 0.108e3 * t6096 - t4936 + 0.455e3 / 0.324e3 * t4937 + t2603 * t2366 / 0.4e1 - t2603 * t2370 / 0.12e2 + 0.7e1 / 0.18e2 * t6103 + 0.7e1 / 0.18e2 * t5497 - 0.7e1 / 0.36e2 * t5504 - 0.7e1 / 0.72e2 * t6108 - 0.7e1 / 0.72e2 * t6110;
  t6125 = t1145 * t900 + 0.4e1 * t2473 * t968 * t1061 + 0.2e1 * t2473 * t1144 * t387 + t5899 * t2474 + 0.4e1 * t1329 * t5320 + 0.2e1 * t2386 * t475 + 0.4e1 * t967 * t5905 + 0.2e1 * t967 * t5908 + t263 * (t5999 + t6042 + t6088 + t6112) * t189 + 0.2e1 * t2633 * t387 + t1212 * t900 + 0.4e1 * t1062 * t1054 + 0.2e1 * t483 * t2348 + t661 * t1204;
  t6135 = 0.2e1 * t2392 + 0.2e1 * t2391 + 0.4e1 * t2388 + 0.2e1 * t2390 + 0.2e1 * t2635 + t7 * (t5891 + t6125) + 0.4e1 * t2637 + 0.2e1 * t2644 + 0.2e1 * t2387 + 0.2e1 * t2395 + 0.2e1 * t2472 + 0.2e1 * t2177 + 0.4e1 * t2186;
  tv4rho42 = t5545 + t6135;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t6164 = t4988 + t4989;
  t6165 = my_piecewise5(t11, 0, t15, 0, t6164);
  t6169 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t4125 * t2652 * t201 - 0.8e1 / 0.9e1 * t2398 * t919 - 0.8e1 / 0.9e1 * t2092 * t1077 * t201 + 0.4e1 / 0.3e1 * t2095 * t1077 + 0.4e1 / 0.3e1 * t915 * t2407 + 0.4e1 / 0.9e1 * t561 * t2659 * t201 + 0.4e1 / 0.3e1 * t24 * t6165);
  t6176 = t6 * t2663 * t132 * t51;
  t6178 = t6 * t2663;
  t6187 = -0.3e1 / 0.8e1 * t6 * t6169 * t27 * t51 - t6176 / 0.8e1 - 0.3e1 / 0.8e1 * t6178 * t241 - 0.3e1 / 0.8e1 * t5553 + t5560 / 0.4e1 - 0.3e1 / 0.8e1 * t5562 + t5003 - 0.5e1 / 0.12e2 * t5040 + t5031 - 0.5e1 / 0.36e2 * t4151 + t4160 - 0.5e1 / 0.36e2 * t4096;
  t6188 = my_piecewise3(t2, 0, t6187);
  t6208 = -t6164;
  t6209 = my_piecewise5(t15, 0, t11, 0, t6208);
  t6213 = my_piecewise3(t59, 0, 0.4e2 / 0.81e2 * t4179 * t2677 * t247 - 0.8e1 / 0.9e1 * t2428 * t942 - 0.8e1 / 0.9e1 * t2137 * t1093 * t247 + 0.4e1 / 0.3e1 * t2140 * t1093 + 0.4e1 / 0.3e1 * t939 * t2437 + 0.4e1 / 0.9e1 * t633 * t2683 * t247 + 0.4e1 / 0.3e1 * t60 * t6209);
  t6220 = t6 * t2687 * t132 * t79;
  t6226 = t1103 * t2466;
  t6228 = t1103 * t2461;
  t6230 = t132 * t2737;
  t6232 = t420 * t6230 * t2739;
  t6236 = -0.3e1 / 0.8e1 * t5654 + t5658 / 0.4e1 - 0.5e1 / 0.36e2 * t4211 + t4216 + t5097 - 0.5e1 / 0.12e2 * t5100 - 0.3e1 / 0.8e1 * t6 * t6213 * t27 * t79 - t6220 / 0.8e1 - 0.9e1 / 0.8e1 * t2451 * t1110 - 0.3e1 / 0.8e1 * t956 * t2740 - 0.3e1 / 0.8e1 * t6226 - 0.3e1 / 0.8e1 * t6228 - t6232 / 0.8e1 - 0.9e1 / 0.8e1 * t956 * t2734;
  t6238 = t420 * t2460 * t2733;
  t6249 = t6 * t2441;
  t6255 = t420 * t959 * t2722;
  t6257 = t2726 * t960;
  t6259 = -0.3e1 / 0.8e1 * t6238 + t5083 - 0.5e1 / 0.12e2 * t5086 - 0.3e1 / 0.8e1 * t5677 - 0.3e1 / 0.4e1 * t5667 + t5669 / 0.2e1 - 0.3e1 / 0.8e1 * t5671 + t5675 / 0.4e1 + t5616 / 0.4e1 - 0.3e1 / 0.8e1 * t956 * t2723 - 0.9e1 / 0.8e1 * t6249 * t442 - 0.9e1 / 0.8e1 * t2451 * t1137 - t6255 / 0.8e1 - 0.3e1 / 0.8e1 * t6257;
  t6261 = my_piecewise3(t56, 0, t6236 + t6259);
  t6264 = t4221 * t394;
  t6286 = t1 * (t6188 + t6261) + t6264 * t2747 * t189 + 0.3e1 * t3256 * t2182 + t2748 * t387 + 0.3e1 * t2473 * t968 * t1211 + 0.3e1 * t3089 * t2479 + 0.3e1 * t1329 * t5689 + 0.3e1 * t1329 * t5908 + 0.3e1 * t2473 * t1144 * t475 + 0.6e1 * t1329 * t5905 + 0.3e1 * t1145 * t1054;
  t6287 = t2854 * t189;
  t6292 = t458 * t2616;
  t6294 = t1164 * t1000;
  t6309 = t1076 * t200;
  t6312 = t565 * t1076;
  t6323 = my_piecewise3(t87, 0, -0.56e2 / 0.81e2 * t4247 * t2759 * t200 + 0.16e2 / 0.9e1 * t2485 * t566 + 0.8e1 / 0.9e1 * t2199 * t6309 - 0.4e1 / 0.3e1 * t2202 * t6312 - 0.2e1 / 0.3e1 * t970 * t2406 - 0.2e1 / 0.9e1 * t663 * t2658 * t200 + 0.2e1 / 0.3e1 * t264 * t6164);
  t6329 = t1092 * t246;
  t6332 = t565 * t1092;
  t6343 = my_piecewise3(t93, 0, -0.56e2 / 0.81e2 * t4265 * t2768 * t246 - 0.16e2 / 0.9e1 * t2497 * t566 + 0.8e1 / 0.9e1 * t2214 * t6329 + 0.4e1 / 0.3e1 * t2217 * t6332 - 0.2e1 / 0.3e1 * t978 * t2436 - 0.2e1 / 0.9e1 * t671 * t2682 * t246 + 0.2e1 / 0.3e1 * t268 * t6208);
  t6346 = (t6323 / 0.2e1 + t6343 / 0.2e1) * t99;
  t6349 = t2779 * t289;
  t6362 = t5107 - t5109 - 0.36e3 * t5110 + t4298 - t5113 + t4307 + 0.31168546390226634765e3 * t5114 - 0.17544670867903938621e1 * t5116 - t5122 - t5123 - 0.12e2 * t5757 + 0.35089341735807877242e1 * t5759 - t4312 + t4316 + 0.35089341735807877242e1 * t4317 - 0.51947577317044391277e2 * t4319;
  t6366 = t4324 - t4329 - t4334 - 0.56968947174242584612e-3 * t4335 - t4342 + t4349 - t4353 - t4357 - t4360 + t4364 + t4367 - t4370 - t4374 + t4378 + t4380 - 0.24e2 * t5767 + 0.6e2 * t4382;
  t6373 = t2807 * t172 * t384;
  t6393 = my_piecewise3(t87, 0, 0.4e2 / 0.81e2 * t4723 * t2759 * t200 - 0.16e2 / 0.9e1 * t2549 * t566 - 0.8e1 / 0.9e1 * t2263 * t6309 + 0.8e1 / 0.3e1 * t2266 * t6312 + 0.4e1 / 0.3e1 * t1024 * t2406 + 0.4e1 / 0.9e1 * t846 * t2658 * t200 + 0.4e1 / 0.3e1 * t89 * t6164);
  t6411 = my_piecewise3(t93, 0, 0.4e2 / 0.81e2 * t4738 * t2768 * t246 + 0.16e2 / 0.9e1 * t2561 * t566 - 0.8e1 / 0.9e1 * t2277 * t6329 - 0.8e1 / 0.3e1 * t2280 * t6332 + 0.4e1 / 0.3e1 * t1032 * t2436 + 0.4e1 / 0.9e1 * t853 * t2682 * t246 + 0.4e1 / 0.3e1 * t94 * t6208);
  t6413 = (t6393 + t6411) * t156;
  t6419 = 0.73245789224026180216e-3 * t5772 - 0.32530743900905219526e-1 * t4386 - t4390 + t4393 - t4396 - t4399 + t4405 + t4408 + 0.16265371950452609763e-1 * t4409 + 0.48159733137676571078e0 * t4411 - 0.5848223622634646207e0 * t6373 - 0.12e2 * t4413 + 0.19751673498613801407e-1 * t6413 * t182 - 0.36e2 * t5779 - 0.10526802520742363173e2 * t5197 - 0.12e2 * t5787;
  t6428 = 0.14447919941302971323e1 * t5199 + t5203 + 0.48796115851357829289e-1 * t5204 - 0.15584273195113317383e3 * t5207 - 0.51947577317044391276e2 * t5793 - 0.17544670867903938621e1 * t5796 - 0.17544670867903938621e1 * t5798 + t5209 + t4420 + t5210 + t5212 - 0.17090684152272775384e-2 * t5213 - 0.30762056574649219972e4 * t5215 - t5218 - t5219 - t4428 + t4710;
  t6434 = t324 * t2812;
  t6436 = t329 * t2812;
  t6440 = 0.10526802520742363173e2 * t5220 + t5222 + t4559 - t4600 + 0.6e2 * t5810 - 0.54934341918019635162e-3 * t5813 + 0.4e1 * t6434 - 0.4e1 * t6436 - t4718 - t4618 + t4622 + t5227 + t4625 - 0.36e2 * t5228 - t4759 - 0.35089341735807877242e1 * t4763;
  t6444 = t4768 - t4774 + t4778 + 0.10389515463408878255e3 * t4779 + t4629 - t5235 - t5241 + t5243 - t4801 - 0.10254018858216406658e4 * t4802 - t4807 - 0.5848223622634646207e0 * t4810 + t4817 - t4819 + t5251 - t4632 + t5255;
  t6448 = t2807 * t3 * t379;
  t6457 = -0.24e2 * t4828 - 0.18311447306006545054e-3 * t6448 - 0.65061487801810439052e-1 * t5257 - 0.97592231702715658578e-1 * t5259 - t5261 + 0.3e1 * t5839 + 0.3e1 * t5842 - t5263 - t5264 - t5265 + t5269 + 0.3e1 * t5271 - t4649 + 0.18e3 * t5272 + 0.72e2 * t5274 + t5277;
  t6463 = t147 * t2807 * t372;
  t6465 = t5279 + 0.32530743900905219526e-1 * t5856 - t4845 - 0.12e3 * t4846 + t5286 - t4672 + t4676 + t4680 + t4690 + t4851 - t4854 - t5287 + t147 * t6413 * t184 + t6463 + t4861 - 0.21687162600603479684e-1 * t4862 + t4866;
  t6468 = t6362 + t6366 + t6419 + t6428 + t6440 + t6444 + t6457 + t6465;
  t6475 = t2840 * t282;
  t6477 = -0.7e1 / 0.24e2 * t5911 + 0.7e1 / 0.24e2 * t5915 + 0.455e3 / 0.216e3 * t5329 - 0.7e1 / 0.48e2 * t6292 - 0.7e1 / 0.48e2 * t6294 - t2603 * t2600 / 0.4e1 - t1163 * t110 * t1006 / 0.8e1 - t2603 * t2607 / 0.8e1 + 0.7e1 / 0.48e2 * t5936 + t101 * t109 * t286 * (-t6346 * t111 / 0.48e2 + 0.7e1 / 0.144e3 * t6349 + 0.7e1 / 0.48e2 * t6018 - 0.35e2 / 0.72e2 * t6020 - t5471 + 0.455e3 / 0.216e3 * t5472 + 0.455e3 / 0.648e3 * t4290 - t4296 + params->gammac * t6468) / 0.48e2 + 0.7e1 / 0.144e3 * t6475 - t5344 - t5352;
  t6490 = t101 * t281 * t2846;
  t6506 = 0.35e2 / 0.72e2 * t6004 - t1003 * t1004 * t2830 * t389 / 0.24e2 - 0.455e3 / 0.648e3 * t4908 - 0.35e2 / 0.72e2 * t6010 - t1003 * t1004 * t477 * t2587 / 0.8e1 - 0.7e1 / 0.24e2 * t6490 + t275 * t2847 / 0.8e1 + t2840 * t391 / 0.48e2 - t989 * t1173 / 0.8e1 + t2626 * t479 / 0.16e2 + t1164 * t1058 / 0.16e2 + t458 * t2589 / 0.16e2 + t989 * t1208 / 0.16e2;
  t6509 = t458 * t2619;
  t6512 = t1003 * t2373 * t2850;
  t6525 = -0.7e1 / 0.24e2 * t6014 + 0.7e1 / 0.24e2 * t6509 + 0.7e1 / 0.24e2 * t6512 - 0.7e1 / 0.48e2 * t6036 + 0.7e1 / 0.24e2 * t6054 - 0.7e1 / 0.8e1 * t6066 + 0.7e1 / 0.12e2 * t6069 + t275 * t2832 / 0.48e2 + 0.3e1 / 0.8e1 * t1003 * t2364 * t2850 * t389 - 0.35e2 / 0.36e2 * t6085 + t5439 + t5449 + t5453;
  t6540 = t101 * t281 * t2831;
  t6554 = -0.455e3 / 0.216e3 * t5455 + 0.3e1 / 0.8e1 * t2603 * t2611 + 0.35e2 / 0.36e2 * t6096 - t1003 * t5376 * t2845 * t389 / 0.2e1 + 0.3e1 / 0.8e1 * t1003 * t2364 * t1171 * t1056 - t4936 + 0.455e3 / 0.648e3 * t4937 - 0.7e1 / 0.144e3 * t6540 + 0.7e1 / 0.12e2 * t6103 - t2381 * t2851 / 0.8e1 - t1003 * t1004 * t1056 * t1206 / 0.8e1 - 0.7e1 / 0.48e2 * t6108 - 0.7e1 / 0.48e2 * t6110 - t6346 * t4 * t193 / 0.48e2;
  t6560 = t1211 * t475;
  t6576 = t967 * t6287 + t263 * (t6477 + t6506 + t6525 + t6554) * t189 + t2855 * t387 + 0.3e1 * t967 * t6560 + 0.3e1 * t2633 * t475 + 0.3e1 * t1212 * t1054 + 0.3e1 * t967 * t482 * t1204 + 0.3e1 * t1062 * t1204 + 0.3e1 * t483 * t2585 + t395 * t2828 + t196 * t6468;
  t6579 = 0.3e1 * t2643 + 0.3e1 * t2644 + t2746 + t2749 + t2751 + t2753 + t2856 + t2858 + t2860 + t2861 + t7 * (t6286 + t6576);
  tv4rho43 = 0.3e1 * t2472 + 0.3e1 * t2475 + 0.6e1 * t2476 + 0.3e1 * t2478 + 0.3e1 * t2480 + 0.3e1 * t2634 + 0.3e1 * t2635 + 0.6e1 * t2637 + 0.6e1 * t2639 + 0.6e1 * t2641 + t6579;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t6588 = t1072 * t1072;
  t6593 = t1077 * t1077;
  t6599 = 0.24e2 * t146 + 0.24e2 * t4137;
  t6600 = my_piecewise5(t11, 0, t15, 0, t6599);
  t6604 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t4125 * t6588 - 0.16e2 / 0.9e1 * t2398 * t1077 + 0.4e1 / 0.3e1 * t561 * t6593 + 0.16e2 / 0.9e1 * t915 * t2659 + 0.4e1 / 0.3e1 * t24 * t6600);
  t6613 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t6604 * t27 * t51 - t6176 / 0.2e1 + t5560 / 0.2e1 - 0.5e1 / 0.9e1 * t5040 + t4160);
  t6630 = xbspline(t78, 4, params);
  t6631 = t27 * t6630;
  t6632 = t1109 * t1109;
  t6638 = t1089 * t1089;
  t6643 = t1093 * t1093;
  t6648 = -t6599;
  t6649 = my_piecewise5(t15, 0, t11, 0, t6648);
  t6653 = my_piecewise3(t59, 0, 0.4e2 / 0.81e2 * t4179 * t6638 - 0.16e2 / 0.9e1 * t2428 * t1093 + 0.4e1 / 0.3e1 * t633 * t6643 + 0.16e2 / 0.9e1 * t939 * t2683 + 0.4e1 / 0.3e1 * t60 * t6649);
  t6658 = t5658 / 0.2e1 + t4216 - 0.3e1 / 0.2e1 * t420 * t1108 * t441 * t2722 - 0.9e1 / 0.2e1 * t1103 * t2734 - 0.9e1 / 0.4e1 * t420 * t2738 * t1109 * t1136 - 0.5e1 / 0.9e1 * t5100 - t6220 / 0.2e1 - 0.3e1 / 0.2e1 * t6226 - 0.3e1 / 0.2e1 * t6228 - t6232 / 0.2e1 - 0.3e1 / 0.8e1 * t420 * t6631 * t6632 - 0.9e1 / 0.4e1 * t2726 * t1110 - 0.3e1 / 0.8e1 * t6 * t6653 * t27 * t79;
  t6663 = t1136 * t1136;
  t6673 = t6 * t2687;
  t6695 = t1127 * t432;
  t6704 = t1127 * t1127;
  t6709 = 0.1e1 / t2716 / t74;
  t6718 = -0.3e1 / 0.2e1 * t6238 - 0.5e1 / 0.9e1 * t5086 - 0.3e1 / 0.2e1 * t1103 * t2740 - 0.9e1 / 0.8e1 * t420 * t1108 * t6663 + t5669 + t5675 / 0.2e1 + t5616 / 0.2e1 - t6255 / 0.2e1 - 0.3e1 / 0.2e1 * t6257 - 0.9e1 / 0.4e1 * t2726 * t1137 - 0.3e1 / 0.2e1 * t6673 * t442 - 0.3e1 / 0.2e1 * t1103 * t2723 - 0.3e1 / 0.8e1 * t420 * t422 * (0.2618e4 / 0.243e3 * t35 * sigma[2] / t66 / t432 * t75 - 0.3047e4 / 0.972e3 * t228 * t430 / t65 / t1364 * t437 + 0.2563e4 / 0.1458e4 * t615 * t1126 / t3345 * t1132 - 0.49e2 / 0.729e3 * t2712 / t66 / t6695 * t2717 * t1584 + 0.2e1 / 0.2187e4 * t4067 * t2711 * sigma[2] / t65 / t6704 / rho[1] * t6709 * t4077);
  t6720 = my_piecewise3(t56, 0, t6658 + t6718);
  t6723 = t1144 * t1144;
  t6730 = t1211 * t1211;
  t6747 = t1147 * t1147;
  t6752 = t1076 * t1076;
  t6760 = my_piecewise3(t87, 0, -0.56e2 / 0.81e2 * t4247 * t6747 + 0.16e2 / 0.9e1 * t2485 * t1076 - 0.2e1 / 0.3e1 * t663 * t6752 - 0.8e1 / 0.9e1 * t970 * t2658 + 0.2e1 / 0.3e1 * t264 * t6599);
  t6761 = t1154 * t1154;
  t6766 = t1092 * t1092;
  t6774 = my_piecewise3(t93, 0, -0.56e2 / 0.81e2 * t4265 * t6761 + 0.16e2 / 0.9e1 * t2497 * t1092 - 0.2e1 / 0.3e1 * t671 * t6766 - 0.8e1 / 0.9e1 * t978 * t2682 + 0.2e1 / 0.3e1 * t268 * t6648);
  t6777 = (t6760 / 0.2e1 + t6774 / 0.2e1) * t99;
  t6787 = t1171 * t1171;
  t6794 = 0.455e3 / 0.162e3 * t5329 - 0.7e1 / 0.12e2 * t6292 - 0.7e1 / 0.12e2 * t6294 + t458 * t2832 / 0.12e2 + 0.7e1 / 0.36e2 * t6475 + 0.35e2 / 0.36e2 * t6004 - t6777 * t4 * t193 / 0.48e2 + t2840 * t479 / 0.12e2 - t1164 * t1173 / 0.4e1 + t458 * t2847 / 0.2e1 - t101 * t109 * t4916 * t6787 / 0.2e1 - 0.35e2 / 0.36e2 * t6010 - 0.7e1 / 0.6e1 * t6490;
  t6809 = -0.576e3 * t5106 - 0.96e3 * t5108 - 0.48e3 * t5110 + t4298 - 0.48e2 * t5112 + t4307 + 0.4155806185363551302e3 * t5114 - 0.23392894490538584828e1 * t5116 + 0.70178683471615754484e1 * t5759 - t4312 + t4316 + t4324;
  t6811 = -t4329 - t4334 - t4342 + t4349 - t4353 - t4357 - t4360 + t4364 + t4367 - t4370 - t4374 + t4378 - 0.48e2 * t5767;
  t6819 = 0.14649157844805236043e-2 * t5772 - t4390 + t4393 - t4396 - t4399 + t4405 + t4408 - 0.23392894490538584828e1 * t6373 + 0.72e2 * t5779 + 0.192e3 * t5781 - 0.14035736694323150897e2 * t5197 + 0.19263893255070628431e1 * t5199;
  t6827 = 0.65061487801810439052e-1 * t5204 - 0.20779030926817756511e3 * t5207 - 0.10389515463408878255e3 * t5793 - 0.35089341735807877242e1 * t5798 + t4420 + t4423 - 0.22787578869697033845e-2 * t5213 - 0.4101607543286562663e4 * t5215 + t4425 - t4428 + t4710 + 0.14035736694323150897e2 * t5220 - t4712;
  t6835 = t4559 - t4600 - t4714 + 0.12e3 * t5810 - 0.16e2 * t6434 - 0.16e2 * t6436 + t4718 - 0.48e2 * t5815 - t4618 + t4622 + t4625 - 0.48e2 * t5228;
  t6838 = -t4759 + t4768 - t4774 + t4778 + t4629 + 0.144e3 * t5234 - t4801 - t4807 + t4817 - t4819 + t4823 - t4632 - 0.73245789224026180216e-3 * t6448;
  t6854 = my_piecewise3(t87, 0, 0.4e2 / 0.81e2 * t4723 * t6747 - 0.16e2 / 0.9e1 * t2549 * t1076 + 0.4e1 / 0.3e1 * t846 * t6752 + 0.16e2 / 0.9e1 * t1024 * t2658 + 0.4e1 / 0.3e1 * t89 * t6599);
  t6866 = my_piecewise3(t93, 0, 0.4e2 / 0.81e2 * t4738 * t6761 - 0.16e2 / 0.9e1 * t2561 * t1092 + 0.4e1 / 0.3e1 * t853 * t6766 + 0.16e2 / 0.9e1 * t1032 * t2682 + 0.4e1 / 0.3e1 * t94 * t6648);
  t6868 = (t6854 + t6866) * t156;
  t6876 = -0.86748650402413918736e-1 * t5257 - 0.1301229756036208781e0 * t5259 - t4831 + 0.6e1 * t5842 + 0.19751673498613801407e-1 * t6868 * t182 - t4835 + t4838 + t147 * t6868 * t184 + 0.4e1 * t5271 - t4649 + 0.24e3 * t5272 - 0.96e2 * t5274;
  t6880 = 0.384e3 * t5276 + 0.65061487801810439052e-1 * t5856 - t4845 - t4672 + t4676 + t4680 + t4690 + t4851 - t4854 + t4856 + 0.4e1 * t6463 + t4861 + t4866;
  t6883 = t6809 + t6811 + t6819 + t6827 + t6835 + t6838 + t6876 + t6880;
  t6899 = t1206 * t1206;
  t6911 = 0.7e1 / 0.6e1 * t6509 + 0.7e1 / 0.6e1 * t6512 + t101 * t109 * t286 * (-t6777 * t111 / 0.48e2 + 0.7e1 / 0.36e2 * t6349 - 0.35e2 / 0.36e2 * t6020 + 0.455e3 / 0.162e3 * t5472 - t4296 + params->gammac * t6883) / 0.48e2 + 0.3e1 / 0.4e1 * t1003 * t2364 * t1171 * t1206 - t1003 * t1004 * t2830 * t477 / 0.6e1 - 0.35e2 / 0.18e2 * t6085 - t101 * t109 * t699 * t6899 / 0.8e1 - 0.455e3 / 0.162e3 * t5455 + 0.35e2 / 0.18e2 * t6096 - t4936 - 0.7e1 / 0.36e2 * t6540 - t2603 * t2851 / 0.2e1 + t1164 * t1208 / 0.8e1;
  t6922 = t1 * (t6613 + t6720) + t4221 * t6723 * t189 + 0.6e1 * t3256 * t2479 + 0.4e1 * t2748 * t475 + 0.3e1 * t659 * t6730 * t189 + 0.12e2 * t1329 * t6560 + 0.4e1 * t1329 * t6287 + 0.6e1 * t1145 * t1204 + t263 * (t6794 + t6911) * t189 + 0.4e1 * t2855 * t475 + 0.6e1 * t1212 * t1204 + 0.4e1 * t483 * t2828 + t196 * t6883;
  tv4rho44 = t7 * t6922 + 0.4e1 * t2746 + 0.4e1 * t2749 + 0.12e2 * t2750 + 0.12e2 * t2752 + 0.4e1 * t2856 + 0.12e2 * t2857 + 0.12e2 * t2859 + 0.4e1 * t2861;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t6936 = t523 * t900;
  t6939 = t506 * t2032;
  t6943 = t1260 * t902;
  t6948 = t1266 * t2978 * t2964;
  t6961 = t1258 * t2373 * t2947;
  t6963 = t506 * t2062;
  t6969 = t681 * t1257;
  t6972 = t517 * t4916;
  t6976 = t1273 * t2061;
  t6978 = t1278 * t6976 * t2947;
  t6980 = t2973 * t286;
  t6982 = t1266 * t6980 * t1268;
  t6987 = t690 * t286;
  t6989 = t1258 * t6987 * t1260;
  t6991 = t1278 * t1279 * t6939 / 0.384e3 - 0.3e1 / 0.128e3 * t1278 * t2982 * t6943 - 0.7e1 / 0.48e2 * t6948 + t1266 * t1279 * t2968 * t389 / 0.64e2 + t1266 * t1279 * t1268 * t902 / 0.64e2 - t2936 * t2948 / 0.8e1 + 0.7e1 / 0.24e2 * t6961 + t1258 * t2364 * t6963 / 0.8e1 + t2936 * t2952 / 0.16e2 + t6969 * t1261 / 0.16e2 + t1278 * t6972 * t6963 / 0.32e2 + 0.7e1 / 0.64e2 * t6978 - 0.119e3 / 0.576e3 * t6982 + t1258 * t1259 * t6939 / 0.48e2 + 0.35e2 / 0.72e2 * t6989;
  t6993 = t1258 * t2943 * t2951;
  t6995 = t2936 * t2944;
  t6998 = t1278 * t2978 * t2951;
  t7001 = t1266 * t2960 * t2968;
  t7009 = t2956 * t1265;
  t7012 = t2973 * t699;
  t7014 = t1278 * t7012 * t1260;
  t7018 = t682 * t1254;
  t7020 = t104 * t1704;
  t7023 = 0.455e3 / 0.648e3 * t101 * t7020 * t507;
  t7024 = t275 * t2940;
  t7028 = t515 / t131 / t1439;
  t7031 = 0.595e3 / 0.2592e4 * t514 * t7028 * t519;
  t7032 = t2957 * t1275;
  t7041 = -0.7e1 / 0.48e2 * t6993 - 0.7e1 / 0.24e2 * t6995 - 0.7e1 / 0.192e3 * t6998 + 0.7e1 / 0.192e3 * t7001 - t1266 * t1267 * t506 * t1695 / 0.384e3 - t3119 * t2969 / 0.128e3 + t7009 * t1280 / 0.64e2 + 0.119e3 / 0.576e3 * t7014 - t2047 * t508 / 0.48e2 + 0.7e1 / 0.48e2 * t7018 + t7023 - 0.35e2 / 0.72e2 * t7024 + t7031 + 0.7e1 / 0.192e3 * t7032 - t1258 * t1004 * t6943 / 0.8e1 - 0.3e1 / 0.64e2 * t1266 * t2982 * t1268 * t700;
  t7049 = t1283 * t387;
  t7057 = t6 * t28;
  t7058 = t1615 * t240;
  t7065 = t213 * t1549 * t1242;
  t7068 = t213 * t589 * t2917;
  t7102 = t582 * t2882;
  t7106 = 0.5e1 / 0.36e2 * t213 * t4094 * t499;
  t7107 = t1596 * t1221;
  t7109 = t582 * t2876;
  t7111 = t582 * t2879;
  t7113 = -0.9e1 / 0.8e1 * t7057 * t7058 * t2889 - 0.9e1 / 0.8e1 * t582 * t2918 + t7065 / 0.4e1 - 0.3e1 / 0.8e1 * t7068 - 0.3e1 / 0.8e1 * t213 * t215 * (-0.154e3 / 0.81e2 * t30 * t34 * t1557 * t47 + 0.253e3 / 0.324e3 * t228 * t1563 * t236 * sigma[0] - 0.1025e4 / 0.1944e4 * t615 * t1569 * t622 * t229 + 0.89e2 / 0.3888e4 * t1575 * t1580 * t1582 * t616 * t1584 - t4067 * t1576 / t37 / t4070 * t4075 * t4077 / 0.2916e4) - 0.3e1 / 0.8e1 * t4091 * t500 - 0.9e1 / 0.8e1 * t1596 * t1243 - 0.3e1 / 0.4e1 * t7102 - t7106 - 0.3e1 / 0.8e1 * t7107 + t7109 / 0.4e1 - 0.3e1 / 0.4e1 * t7111;
  t7119 = t213 * t4033 * t1224;
  t7122 = t213 * t1607 * t2889;
  t7125 = t213 * t1607 * t2893;
  t7138 = t213 * t4105 * t2885;
  t7154 = -0.9e1 / 0.8e1 * t582 * t2890 - 0.9e1 / 0.4e1 * t582 * t2894 + t7119 / 0.4e1 - 0.3e1 / 0.8e1 * t7122 - 0.3e1 / 0.4e1 * t7125 - 0.9e1 / 0.8e1 * t213 * t594 * t240 * t2917 - 0.3e1 / 0.8e1 * t213 * t4114 * t1617 * t499 - 0.9e1 / 0.8e1 * t582 * t2886 - 0.3e1 / 0.8e1 * t7138 - 0.9e1 / 0.8e1 * t1596 * t1225 - 0.9e1 / 0.8e1 * t213 * t1616 * t595 * t1242 - 0.3e1 / 0.8e1 * t213 * t594 * t1588 * t499 - 0.9e1 / 0.8e1 * t213 * t594 * t626 * t1242;
  t7156 = my_piecewise3(t2, 0, t7113 + t7154);
  t7158 = t2989 * t189;
  t7166 = t4966 * t1249 + 0.3e1 * t2473 * t1249 * t907 + 0.3e1 * t967 * t6936 + t263 * (t6991 + t7041) * t189 + 0.3e1 * t2180 * t2929 + 0.3e1 * t2180 * t2926 + 0.6e1 * t967 * t7049 + 0.3e1 * t2178 * t2929 + 0.3e1 * t2178 * t2926 + t5515 * t1249 + t1 * t7156 + 0.3e1 * t967 * t7158 + 0.3e1 * t1284 * t900 + t524 * t2030 + 0.3e1 * t2990 * t387;
  tv4rho3sigma0 = t7 * t7166 + 0.3e1 * t2923 + 0.3e1 * t2924 + 0.3e1 * t2925 + 0.6e1 * t2927 + 0.6e1 * t2930 + 0.3e1 * t2991 + 0.6e1 * t2992 + 0.3e1 * t2994;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t7185 = t2165 * t1291;
  t7187 = t956 * t3005;
  t7191 = 0.5e1 / 0.36e2 * t420 * t5098 * t538;
  t7193 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t5091 * t539 - 0.3e1 / 0.8e1 * t7185 + t7187 / 0.4e1 - t7191);
  t7201 = t3064 * t189;
  t7204 = t544 * t2062;
  t7209 = t1278 * t6976 * t3031;
  t7212 = t1266 * t6980 * t1308;
  t7215 = t1258 * t6987 * t1304;
  t7218 = t1258 * t2943 * t3035;
  t7220 = t2936 * t3028;
  t7227 = t1266 * t2978 * t3044;
  t7239 = 0.455e3 / 0.648e3 * t101 * t7020 * t545;
  t7240 = t682 * t1301;
  t7242 = t275 * t3025;
  t7246 = 0.595e3 / 0.2592e4 * t514 * t7028 * t549;
  t7247 = t1278 * t6972 * t7204 / 0.32e2 + 0.7e1 / 0.64e2 * t7209 - 0.119e3 / 0.576e3 * t7212 + 0.35e2 / 0.72e2 * t7215 - 0.7e1 / 0.48e2 * t7218 - 0.7e1 / 0.24e2 * t7220 + t2936 * t3036 / 0.16e2 + t6969 * t1305 / 0.16e2 - 0.7e1 / 0.48e2 * t7227 + t1266 * t1279 * t3048 * t389 / 0.64e2 + t1266 * t1279 * t1308 * t902 / 0.64e2 + t7239 + 0.7e1 / 0.48e2 * t7240 - 0.35e2 / 0.72e2 * t7242 + t7246;
  t7248 = t2957 * t1312;
  t7254 = t1304 * t902;
  t7261 = t1278 * t2978 * t3035;
  t7272 = t1266 * t2960 * t3048;
  t7274 = t544 * t2032;
  t7284 = t1258 * t2373 * t3031;
  t7287 = t1278 * t7012 * t1304;
  t7295 = 0.7e1 / 0.192e3 * t7248 - 0.3e1 / 0.64e2 * t1266 * t2982 * t1308 * t700 - 0.3e1 / 0.128e3 * t1278 * t2982 * t7254 - t2047 * t546 / 0.48e2 - 0.7e1 / 0.192e3 * t7261 - t1266 * t1267 * t544 * t1695 / 0.384e3 - t3119 * t3049 / 0.128e3 + t7009 * t1315 / 0.64e2 + 0.7e1 / 0.192e3 * t7272 + t1278 * t1279 * t7274 / 0.384e3 + t1258 * t2364 * t7204 / 0.8e1 - t2936 * t3032 / 0.8e1 + 0.7e1 / 0.24e2 * t7284 + 0.119e3 / 0.576e3 * t7287 + t1258 * t1259 * t7274 / 0.48e2 - t1258 * t1004 * t7254 / 0.8e1;
  t7299 = t553 * t900;
  t7307 = t1318 * t387;
  t7310 = 0.3e1 * t2180 * t3016 + 0.3e1 * t2180 * t3013 + 0.3e1 * t2473 * t1297 * t907 + t1 * t7193 + t554 * t2030 + t4966 * t1297 + 0.3e1 * t2178 * t3016 + 0.3e1 * t2178 * t3013 + 0.3e1 * t967 * t7201 + t263 * (t7247 + t7295) * t189 + 0.3e1 * t967 * t7299 + t5515 * t1297 + 0.3e1 * t1319 * t900 + 0.3e1 * t3065 * t387 + 0.6e1 * t967 * t7307;
  tv4rho3sigma2 = t7 * t7310 + 0.3e1 * t3010 + 0.3e1 * t3011 + 0.3e1 * t3012 + 0.6e1 * t3014 + 0.6e1 * t3017 + 0.3e1 * t3066 + 0.6e1 * t3067 + 0.3e1 * t3069;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t7321 = 0.7e1 / 0.36e2 * t1258 * t2373 * t3109;
  t7322 = t3113 * t389;
  t7326 = t1333 * t700;
  t7333 = t1333 * t902;
  t7347 = -0.7e1 / 0.144e3 * t6948 - t2936 * t3110 / 0.12e2 + t7321 - t1258 * t1004 * t7322 / 0.12e2 + t1278 * t6972 * t7326 / 0.32e2 - t1278 * t2982 * t7322 / 0.64e2 - t1278 * t2982 * t7333 / 0.128e3 + t1266 * t1279 * t3113 * t273 / 0.96e2 + 0.7e1 / 0.72e2 * t6961 + 0.7e1 / 0.192e3 * t6978 - 0.119e3 / 0.864e3 * t6982 + 0.35e2 / 0.108e3 * t6989 - 0.7e1 / 0.144e3 * t6993 - 0.7e1 / 0.72e2 * t6995;
  t7353 = 0.7e1 / 0.144e3 * t1266 * t2978 * t3135;
  t7356 = 0.7e1 / 0.144e3 * t1266 * t2978 * t3125;
  t7373 = 0.7e1 / 0.72e2 * t989 * t1254;
  t7374 = t458 * t2940;
  t7377 = -0.7e1 / 0.576e3 * t6998 + 0.7e1 / 0.576e3 * t7001 + 0.119e3 / 0.864e3 * t7014 - t7353 - t7356 + t1266 * t1279 * t3129 * t389 / 0.96e2 + t1266 * t1279 * t1337 * t902 / 0.192e3 + t3119 * t3126 / 0.96e2 - t1258 * t1004 * t7333 / 0.24e2 - t2232 * t508 / 0.48e2 + t7373 - 0.35e2 / 0.216e3 * t7374 + 0.7e1 / 0.144e3 * t7018 + t7023;
  t7386 = t1264 * t1265 * t517;
  t7387 = t2061 * t506;
  t7388 = t477 * t273;
  t7389 = t7388 * t389;
  t7394 = t1258 * t6987 * t1333;
  t7399 = t1278 * t7012 * t1333;
  t7402 = 0.7e1 / 0.72e2 * t2936 * t3106;
  t7405 = t506 * t2350;
  t7411 = 0.7e1 / 0.288e3 * t1278 * t2978 * t3113;
  t7417 = t1266 * t6980 * t1337;
  t7419 = -0.35e2 / 0.108e3 * t7024 + t7031 + 0.7e1 / 0.576e3 * t7032 - t1266 * t2982 * t1337 * t700 / 0.64e2 - t7386 * t7387 * t7389 / 0.32e2 + 0.35e2 / 0.216e3 * t7394 + t7009 * t1341 / 0.192e3 + 0.119e3 / 0.1728e4 * t7399 - t7402 - t3099 * t2948 / 0.24e2 + t1278 * t1279 * t7405 / 0.384e3 - t7411 - t1266 * t1267 * t506 * t2230 / 0.384e3 - 0.119e3 / 0.1728e4 * t7417;
  t7421 = 0.7e1 / 0.288e3 * t3119 * t3122;
  t7422 = t988 * t1257;
  t7426 = 0.7e1 / 0.72e2 * t3099 * t2944;
  t7435 = 0.7e1 / 0.72e2 * t1258 * t2943 * t3113;
  t7440 = t680 * t3 * t1265;
  t7447 = 0.7e1 / 0.288e3 * t1266 * t2960 * t3129;
  t7454 = 0.7e1 / 0.96e2 * t1278 * t6976 * t3109;
  t7458 = t7421 + t7422 * t1261 / 0.24e2 - t7426 + t3099 * t2952 / 0.48e2 + t6969 * t1334 / 0.48e2 + t2936 * t3114 / 0.24e2 - t7435 + t1258 * t1259 * t7405 / 0.48e2 - t7440 * t1338 / 0.384e3 - t3119 * t3130 / 0.192e3 + t7447 + t1266 * t1279 * t1333 * t680 / 0.192e3 + t7454 + t1258 * t2364 * t7326 / 0.8e1;
  t7466 = t659 * t2385;
  t7469 = t1061 * t523 * t189;
  t7475 = t1344 * t387;
  t7480 = t2178 * t3153 + t2180 * t3093 + 0.2e1 * t1329 * t7049 + t263 * (t7347 + t7377 + t7419 + t7458) * t189 + t2180 * t3153 + t5899 * t3087 + t1345 * t900 + t7466 * t1249 + 0.2e1 * t2473 * t7469 + 0.2e1 * t3150 * t387 + t2990 * t475 + 0.2e1 * t967 * t7475 + 0.2e1 * t3089 * t2926;
  t7494 = t932 * t2882 / 0.4e1;
  t7498 = t2116 * t1221 / 0.4e1;
  t7501 = t932 * t2876;
  t7504 = t932 * t2879 / 0.4e1;
  t7507 = -t7138 / 0.8e1 - 0.3e1 / 0.8e1 * t932 * t2886 - 0.3e1 / 0.8e1 * t5018 * t500 - 0.3e1 / 0.4e1 * t2116 * t1243 - t7494 - 0.3e1 / 0.8e1 * t932 * t2918 - t7498 - 0.3e1 / 0.4e1 * t2116 * t1225 + t7501 / 0.12e2 - t7504 - 0.3e1 / 0.8e1 * t932 * t2890;
  t7519 = -0.3e1 / 0.4e1 * t932 * t2894 - t7107 / 0.8e1 + t7109 / 0.6e1 - t7111 / 0.4e1 - t7106 + t7119 / 0.6e1 - t7122 / 0.8e1 - t7125 / 0.4e1 - t7102 / 0.4e1 + t7065 / 0.6e1 - t7068 / 0.8e1;
  t7521 = my_piecewise3(t2, 0, t7507 + t7519);
  t7523 = t523 * t1054;
  t7537 = t1283 * t475;
  t7540 = t3149 * t189;
  t7543 = 0.2e1 * t1283 * t189 * t2473 * t482 + 0.2e1 * t2473 * t3086 * t387 + t1 * t7521 + 0.2e1 * t1284 * t1054 + t1329 * t6936 + t1329 * t7158 + t2178 * t3093 + t524 * t2348 + 0.2e1 * t3089 * t2929 + t5871 * t3087 + 0.2e1 * t967 * t7523 + 0.2e1 * t967 * t7537 + 0.2e1 * t967 * t7540;
  t7546 = 0.2e1 * t3156;
  t7547 = 0.2e1 * t3155;
  t7548 = 0.2e1 * t3152;
  t7549 = 0.2e1 * t3085;
  t7550 = 0.2e1 * t3151;
  t7551 = 0.2e1 * t3094;
  t7552 = 0.2e1 * t3092;
  t7553 = 0.2e1 * t3091;
  t7554 = 0.2e1 * t3090;
  t7555 = 0.2e1 * t3154;
  t7556 = 0.2e1 * t3088;
  tv4rho3sigma3 = t7 * (t7480 + t7543) + t7546 + t7547 + t7548 + t2994 + t7549 + t2993 + t7550 + t2924 + t2931 + t2928 + t7551 + t2991 + t2923 + t7552 + t7553 + t7554 + t2925 + t7555 + t7556;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t7557 = 0.2e1 * t3241;
  t7558 = 0.2e1 * t3184;
  t7559 = t553 * t1054;
  t7567 = t1318 * t475;
  t7575 = t3236 * t189;
  t7586 = 0.2e1 * t1318 * t189 * t2473 * t482 + 0.2e1 * t2473 * t3177 * t387 + 0.2e1 * t1319 * t1054 + t7466 * t1297 + t1329 * t7201 + t1329 * t7299 + 0.2e1 * t1329 * t7307 + t2180 * t3240 + 0.2e1 * t3089 * t3013 + t3065 * t475 + 0.2e1 * t967 * t7559 + 0.2e1 * t967 * t7567 + 0.2e1 * t967 * t7575;
  t7592 = t1061 * t553 * t189;
  t7599 = t2451 * t1291 / 0.4e1;
  t7600 = t1103 * t3005;
  t7607 = t956 * t3166 / 0.4e1;
  t7609 = t420 * t5673 * t1352;
  t7614 = t956 * t3171 / 0.4e1;
  t7616 = t420 * t2170 * t1370;
  t7618 = -0.3e1 / 0.8e1 * t5660 * t539 - t7599 + t7600 / 0.12e2 - t7185 / 0.8e1 + t7187 / 0.6e1 - t7191 - 0.3e1 / 0.8e1 * t2165 * t1353 - t7607 + t7609 / 0.12e2 - 0.3e1 / 0.8e1 * t2165 * t1371 - t7614 + t7616 / 0.12e2;
  t7619 = my_piecewise3(t56, 0, t7618);
  t7621 = t1391 * t387;
  t7630 = 0.7e1 / 0.144e3 * t1266 * t2978 * t3222;
  t7634 = 0.7e1 / 0.72e2 * t989 * t1301;
  t7635 = t458 * t3025;
  t7643 = t544 * t2350;
  t7649 = -t7630 + 0.7e1 / 0.192e3 * t7209 - 0.119e3 / 0.864e3 * t7212 + t7634 - 0.35e2 / 0.216e3 * t7635 + 0.35e2 / 0.108e3 * t7215 - 0.7e1 / 0.144e3 * t7218 - 0.7e1 / 0.72e2 * t7220 - 0.7e1 / 0.144e3 * t7227 - t2232 * t546 / 0.48e2 + t1278 * t1279 * t7643 / 0.384e3 + t7239 + 0.7e1 / 0.144e3 * t7240 - 0.35e2 / 0.108e3 * t7242;
  t7657 = 0.7e1 / 0.288e3 * t1266 * t2960 * t3216;
  t7664 = 0.7e1 / 0.288e3 * t1278 * t2978 * t3202;
  t7667 = 0.7e1 / 0.72e2 * t1258 * t2943 * t3202;
  t7671 = 0.7e1 / 0.72e2 * t3099 * t3028;
  t7682 = t7246 + 0.7e1 / 0.576e3 * t7248 - t7440 * t1385 / 0.384e3 - t3119 * t3217 / 0.192e3 + t7657 - t1266 * t1267 * t544 * t2230 / 0.384e3 - t7664 - t7667 + t7422 * t1305 / 0.24e2 - t7671 + t3099 * t3036 / 0.48e2 + t6969 * t1381 / 0.48e2 + t2936 * t3203 / 0.24e2 - t1266 * t2982 * t1384 * t700 / 0.64e2;
  t7698 = 0.7e1 / 0.96e2 * t1278 * t6976 * t3198;
  t7701 = 0.7e1 / 0.36e2 * t1258 * t2373 * t3198;
  t7702 = t3202 * t389;
  t7706 = t1380 * t902;
  t7712 = 0.7e1 / 0.144e3 * t1266 * t2978 * t3212;
  t7721 = t1380 * t700;
  t7725 = -0.7e1 / 0.576e3 * t7261 + 0.7e1 / 0.576e3 * t7272 + 0.7e1 / 0.72e2 * t7284 + 0.119e3 / 0.864e3 * t7287 + t1266 * t1279 * t3202 * t273 / 0.96e2 + t1266 * t1279 * t1380 * t680 / 0.192e3 + t7698 + t7701 - t1258 * t1004 * t7702 / 0.12e2 - t1258 * t1004 * t7706 / 0.24e2 - t7712 + t1266 * t1279 * t3216 * t389 / 0.96e2 + t1266 * t1279 * t1384 * t902 / 0.192e3 + t1258 * t2364 * t7721 / 0.8e1;
  t7735 = t1258 * t6987 * t1380;
  t7740 = t1278 * t7012 * t1380;
  t7743 = 0.7e1 / 0.288e3 * t3119 * t3209;
  t7745 = 0.7e1 / 0.72e2 * t2936 * t3195;
  t7749 = t1266 * t6980 * t1384;
  t7762 = -t2936 * t3199 / 0.12e2 + t1278 * t6972 * t7721 / 0.32e2 - t7386 * t3558 * t7389 / 0.32e2 + 0.35e2 / 0.216e3 * t7735 + t7009 * t1388 / 0.192e3 + 0.119e3 / 0.1728e4 * t7740 + t7743 - t7745 - t3099 * t3032 / 0.24e2 - 0.119e3 / 0.1728e4 * t7749 + t1258 * t1259 * t7643 / 0.48e2 - t1278 * t2982 * t7702 / 0.64e2 - t1278 * t2982 * t7706 / 0.128e3 + t3119 * t3213 / 0.96e2;
  t7769 = t1392 * t900 + t2178 * t3183 + t2178 * t3240 + t5871 * t3178 + 0.2e1 * t2473 * t7592 + t5899 * t3178 + t1 * t7619 + 0.2e1 * t967 * t7621 + t2180 * t3183 + 0.2e1 * t3237 * t387 + t554 * t2348 + t263 * (t7649 + t7682 + t7725 + t7762) * t189 + 0.2e1 * t3089 * t3016;
  t7772 = 0.2e1 * t3243;
  t7773 = 0.2e1 * t3242;
  t7774 = 0.2e1 * t3239;
  t7775 = 0.2e1 * t3179;
  t7776 = 0.2e1 * t3182;
  t7777 = 0.2e1 * t3181;
  t7778 = 0.2e1 * t3176;
  t7779 = 0.2e1 * t3238;
  t7780 = 0.2e1 * t3180;
  tv4rho3sigma5 = t3011 + t3066 + t3018 + t3015 + t3012 + t3010 + t7557 + t7558 + t7 * (t7586 + t7769) + t7772 + t7773 + t7774 + t7775 + t7776 + t7777 + t3069 + t3068 + t7778 + t7779 + t7780;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t7785 = t523 * t1204;
  t7789 = t2420 * t1221;
  t7799 = -0.3e1 / 0.8e1 * t5555 * t500 - t7789 / 0.8e1 - 0.3e1 / 0.8e1 * t2420 * t1225 - 0.3e1 / 0.8e1 * t2420 * t1243 - t7498 + t7501 / 0.6e1 - t7504 - t7494 + t7109 / 0.12e2 - t7106 + t7119 / 0.12e2 + t7065 / 0.12e2;
  t7800 = my_piecewise3(t2, 0, t7799);
  t7805 = t659 * t2632;
  t7817 = t1211 * t523 * t189;
  t7819 = 0.2e1 * t2473 * t3086 * t475 + t1 * t7800 + 0.2e1 * t1345 * t1054 + t1284 * t1204 + t7805 * t1249 + t2473 * t7817 + t3256 * t2929 + 0.2e1 * t3089 * t3093 + 0.2e1 * t3089 * t3153 + 0.2e1 * t3150 * t475 + t3300 * t387 + 0.2e1 * t3650 * t7469 + t967 * t7785;
  t7832 = t1344 * t475;
  t7838 = t3299 * t189;
  t7848 = t456 * t3 * t1265;
  t7851 = t3279 * t1265;
  t7856 = t1164 * t1254;
  t7858 = t506 * t2587;
  t7863 = t1278 * t6976 * t3270;
  t7872 = t1278 * t2978 * t3274;
  t7875 = t1266 * t2960 * t3288;
  t7877 = t3270 * t389;
  t7881 = -t3119 * t3289 / 0.384e3 - t1266 * t1267 * t506 * t2510 / 0.384e3 - t7848 * t3130 / 0.192e3 + t7851 * t1280 / 0.192e3 + t2936 * t3275 / 0.48e2 + 0.7e1 / 0.144e3 * t7856 + t1258 * t1259 * t7858 / 0.48e2 + 0.7e1 / 0.192e3 * t7863 - t2936 * t3271 / 0.24e2 + t7422 * t1334 / 0.24e2 + t3099 * t3114 / 0.24e2 - 0.7e1 / 0.576e3 * t7872 + 0.7e1 / 0.576e3 * t7875 + t1258 * t2364 * t7877 / 0.8e1;
  t7882 = t1333 * t1056;
  t7888 = t3280 * t1275;
  t7895 = t1163 * t1257;
  t7898 = t456 * t477;
  t7899 = t7898 * t389;
  t7904 = t1258 * t2943 * t3274;
  t7907 = t1258 * t2373 * t3270;
  t7909 = -t1258 * t1004 * t7882 / 0.12e2 - t3099 * t3110 / 0.12e2 + t7321 + 0.7e1 / 0.576e3 * t7888 - t2626 * t508 / 0.48e2 - 0.119e3 / 0.1728e4 * t6982 + 0.35e2 / 0.216e3 * t6989 + 0.119e3 / 0.1728e4 * t7014 + t7895 * t1261 / 0.48e2 - t7353 - t7356 - t7386 * t7387 * t7899 / 0.32e2 - 0.7e1 / 0.144e3 * t7904 + 0.7e1 / 0.72e2 * t7907;
  t7911 = t3099 * t3106;
  t7936 = t3274 * t389;
  t7943 = -0.7e1 / 0.72e2 * t7911 + t1278 * t1279 * t7858 / 0.384e3 + t7373 - 0.35e2 / 0.108e3 * t7374 + t7023 - 0.35e2 / 0.216e3 * t7024 + t7031 + t1266 * t1279 * t3288 * t389 / 0.192e3 - t1266 * t2982 * t3270 * t273 / 0.64e2 + t3119 * t3285 / 0.96e2 + t1266 * t1279 * t3129 * t477 / 0.96e2 + t1266 * t1279 * t1337 * t1056 / 0.96e2 - t1258 * t1004 * t7936 / 0.24e2 + t1278 * t6972 * t7877 / 0.32e2;
  t7955 = t1266 * t2978 * t3284;
  t7960 = -t1278 * t2982 * t7882 / 0.64e2 + t1266 * t1279 * t3274 * t273 / 0.192e3 - t1278 * t2982 * t7936 / 0.128e3 - 0.7e1 / 0.144e3 * t7955 + 0.35e2 / 0.108e3 * t7394 + 0.119e3 / 0.864e3 * t7399 - t7402 - t7411 - 0.119e3 / 0.864e3 * t7417 + t7421 - t7426 - t7435 + t7447 + t7454;
  t7968 = 0.2e1 * t2473 * t482 * t1344 * t189 + t6264 * t1144 * t523 * t189 + t3258 * t2926 + 0.2e1 * t1329 * t7475 + 0.2e1 * t1329 * t7540 + 0.2e1 * t967 * t7832 + t3258 * t2929 + 0.2e1 * t1329 * t7537 + t967 * t7838 + t524 * t2585 + t263 * (t7881 + t7909 + t7943 + t7960) * t189 + 0.2e1 * t1329 * t7523 + t3256 * t2926;
  tv4rho3sigma6 = t7549 + t7556 + t7554 + t7553 + t7552 + t7551 + t7550 + t7548 + t7555 + t7547 + t7546 + t3255 + t3257 + t3259 + t3261 + t3263 + t3301 + t3303 + t3304 + t7 * (t7819 + t7968);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t7979 = t3371 * t389;
  t7983 = t1380 * t1056;
  t7988 = t3280 * t1312;
  t7995 = -t1266 * t2982 * t3371 * t273 / 0.64e2 + t1278 * t6972 * t7979 / 0.32e2 - t1278 * t2982 * t7983 / 0.64e2 - t7630 - 0.119e3 / 0.1728e4 * t7212 + 0.7e1 / 0.576e3 * t7988 - t2626 * t546 / 0.48e2 + t7634 - 0.35e2 / 0.108e3 * t7635 + 0.35e2 / 0.216e3 * t7215 + t7239 - 0.35e2 / 0.216e3 * t7242 + t7246 + t7657;
  t8002 = t3375 * t389;
  t8009 = t1266 * t2978 * t3382;
  t8025 = t3099 * t3195;
  t8028 = t1258 * t2943 * t3375;
  t8030 = -t7664 - t7667 - t7671 + t1258 * t2364 * t7979 / 0.8e1 - t1258 * t1004 * t7983 / 0.12e2 - t1258 * t1004 * t8002 / 0.24e2 - t3099 * t3199 / 0.12e2 - 0.7e1 / 0.144e3 * t8009 + t1266 * t1279 * t3386 * t389 / 0.192e3 + t3119 * t3383 / 0.96e2 + t1266 * t1279 * t3216 * t477 / 0.96e2 + t1266 * t1279 * t1384 * t1056 / 0.96e2 - 0.7e1 / 0.72e2 * t8025 - 0.7e1 / 0.144e3 * t8028;
  t8033 = t1164 * t1301;
  t8036 = t1258 * t2373 * t3371;
  t8038 = t544 * t2587;
  t8051 = t1266 * t2960 * t3386;
  t8056 = t1278 * t6976 * t3371;
  t8059 = t1278 * t2978 * t3375;
  t8066 = 0.119e3 / 0.1728e4 * t7287 + 0.7e1 / 0.144e3 * t8033 + 0.7e1 / 0.72e2 * t8036 + t1258 * t1259 * t8038 / 0.48e2 - t2936 * t3372 / 0.24e2 + t7422 * t1381 / 0.24e2 + t3099 * t3203 / 0.24e2 + t7895 * t1305 / 0.48e2 + 0.7e1 / 0.576e3 * t8051 + t2936 * t3376 / 0.48e2 + 0.7e1 / 0.192e3 * t8056 - 0.7e1 / 0.576e3 * t8059 + t7851 * t1315 / 0.192e3 + t1278 * t1279 * t8038 / 0.384e3;
  t8088 = -t3119 * t3387 / 0.384e3 - t1266 * t1267 * t544 * t2510 / 0.384e3 - t7848 * t3217 / 0.192e3 + t7698 + t1266 * t1279 * t3375 * t273 / 0.192e3 + t7701 - t1278 * t2982 * t8002 / 0.128e3 - t7712 + 0.35e2 / 0.108e3 * t7735 + 0.119e3 / 0.864e3 * t7740 + t7743 - t7745 - 0.119e3 / 0.864e3 * t7749 - t7386 * t3558 * t7899 / 0.32e2;
  t8098 = t2726 * t1291;
  t8103 = t1103 * t3166;
  t8107 = t1103 * t3171;
  t8110 = -0.3e1 / 0.8e1 * t6249 * t539 - t8098 / 0.8e1 - t7599 + t7600 / 0.6e1 - 0.3e1 / 0.4e1 * t2451 * t1353 - t8103 / 0.4e1 - 0.3e1 / 0.4e1 * t2451 * t1371 - t8107 / 0.4e1 + t7187 / 0.12e2 - t7191 - t7607;
  t8116 = t420 * t6230 * t3320;
  t8121 = t420 * t2460 * t3324;
  t8126 = t420 * t2460 * t3328;
  t8131 = t420 * t959 * t3352;
  t8133 = t7609 / 0.6e1 - t7614 + t7616 / 0.6e1 - 0.3e1 / 0.8e1 * t956 * t3321 - t8116 / 0.8e1 - 0.3e1 / 0.8e1 * t956 * t3325 - t8121 / 0.8e1 - 0.3e1 / 0.4e1 * t956 * t3329 - t8126 / 0.4e1 - 0.3e1 / 0.8e1 * t956 * t3353 - t8131 / 0.8e1;
  t8135 = my_piecewise3(t56, 0, t8110 + t8133);
  t8137 = t3397 * t189;
  t8142 = t1391 * t475;
  t8151 = 0.2e1 * t2473 * t3177 * t475 + t3258 * t3013 + t263 * (t7995 + t8030 + t8066 + t8088) * t189 + t1319 * t1204 + 0.2e1 * t3237 * t475 + t1 * t8135 + t967 * t8137 + 0.2e1 * t1329 * t7567 + t3398 * t387 + 0.2e1 * t967 * t8142 + 0.2e1 * t1392 * t1054 + 0.2e1 * t3089 * t3240 + 0.2e1 * t3650 * t7592;
  t8152 = t553 * t1204;
  t8167 = t1211 * t553 * t189;
  t8177 = t1144 * t189 * t553 * t6264 + 0.2e1 * t1391 * t189 * t2473 * t482 + t7805 * t1297 + 0.2e1 * t1329 * t7559 + 0.2e1 * t1329 * t7575 + 0.2e1 * t1329 * t7621 + t2473 * t8167 + t554 * t2585 + t3256 * t3013 + t3256 * t3016 + t3258 * t3016 + 0.2e1 * t3089 * t3183 + t967 * t8152;
  tv4rho3sigma8 = t7778 + t7775 + t7780 + t7777 + t7776 + t7558 + t7779 + t7774 + t7557 + t7773 + t7772 + t3358 + t3359 + t3360 + t3362 + t3364 + t3399 + t3401 + t3402 + t7 * (t8151 + t8177);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t8200 = t659 * t2854;
  t8202 = t4221 * t2747;
  t8209 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6178 * t500 - 0.3e1 / 0.8e1 * t7789 + t7501 / 0.4e1 - t7106);
  t8222 = t506 * t2830;
  t8229 = t1333 * t1206;
  t8247 = 0.7e1 / 0.48e2 * t7856 + 0.7e1 / 0.64e2 * t7863 - 0.7e1 / 0.192e3 * t7872 + 0.7e1 / 0.192e3 * t7875 - 0.3e1 / 0.64e2 * t1266 * t2982 * t1337 * t1171 + 0.7e1 / 0.192e3 * t7888 - t3099 * t3271 / 0.8e1 + t1278 * t1279 * t8222 / 0.384e3 + t1258 * t1259 * t8222 / 0.48e2 - t1258 * t1004 * t8229 / 0.8e1 - t2840 * t508 / 0.48e2 - 0.3e1 / 0.128e3 * t1278 * t2982 * t8229 + t1266 * t1279 * t3288 * t477 / 0.64e2 + t1266 * t1279 * t1337 * t1206 / 0.64e2 - 0.7e1 / 0.48e2 * t7904;
  t8251 = t506 * t2845;
  t8274 = 0.7e1 / 0.24e2 * t7907 - 0.7e1 / 0.24e2 * t7911 - 0.35e2 / 0.72e2 * t7374 + t1258 * t2364 * t8251 / 0.8e1 + t1278 * t6972 * t8251 / 0.32e2 + t7895 * t1334 / 0.16e2 + t3099 * t3275 / 0.16e2 - t7848 * t3289 / 0.128e3 + t7851 * t1341 / 0.64e2 - t1266 * t1267 * t506 * t2778 / 0.384e3 + t7023 + t7031 - 0.7e1 / 0.48e2 * t7955 + 0.35e2 / 0.72e2 * t7394 + 0.119e3 / 0.576e3 * t7399 - 0.119e3 / 0.576e3 * t7417;
  t8287 = 0.3e1 * t3256 * t3153 + 0.3e1 * t1329 * t7785 + 0.3e1 * t3258 * t3153 + 0.3e1 * t3258 * t3093 + 0.6e1 * t1329 * t7832 + 0.3e1 * t3256 * t3093 + t8200 * t1249 + t8202 * t1249 + t1 * t8209 + t263 * (t8247 + t8274) * t189 + 0.3e1 * t3650 * t7817 + 0.3e1 * t1329 * t7838 + 0.3e1 * t3300 * t475 + 0.3e1 * t1345 * t1204 + t524 * t2828;
  tv4rho3sigma9 = t7 * t8287 + 0.3e1 * t3255 + 0.3e1 * t3257 + 0.3e1 * t3259 + 0.6e1 * t3260 + 0.6e1 * t3262 + 0.3e1 * t3301 + 0.6e1 * t3302 + 0.3e1 * t3304;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t8322 = t6 * t63;
  t8323 = t2737 * t441;
  t8337 = -0.9e1 / 0.8e1 * t1103 * t3325 - 0.9e1 / 0.4e1 * t1103 * t3329 - 0.9e1 / 0.8e1 * t420 * t2738 * t1109 * t1370 - 0.3e1 / 0.4e1 * t8103 - 0.3e1 / 0.8e1 * t8121 - 0.3e1 / 0.4e1 * t8126 - 0.3e1 / 0.8e1 * t8116 - 0.9e1 / 0.8e1 * t8322 * t8323 * t3324 + t7600 / 0.4e1 + t7609 / 0.4e1 - 0.3e1 / 0.8e1 * t420 * t1108 * t2722 * t538 - 0.9e1 / 0.8e1 * t420 * t1108 * t1136 * t1370;
  t8388 = -0.9e1 / 0.8e1 * t2726 * t1353 - t7191 - 0.3e1 / 0.8e1 * t6673 * t539 - 0.9e1 / 0.8e1 * t2726 * t1371 - 0.9e1 / 0.8e1 * t1103 * t3353 - 0.3e1 / 0.8e1 * t420 * t422 * (-0.154e3 / 0.81e2 * t30 * t34 * t2694 * t75 + 0.253e3 / 0.324e3 * t228 * t2700 * t437 * sigma[2] - 0.1025e4 / 0.1944e4 * t615 * t2706 * t1132 * t430 + 0.89e2 / 0.3888e4 * t1575 * t2715 * t2717 * t1126 * t1584 - t4067 * t2711 / t65 / t6704 * t6709 * t4077 / 0.2916e4) - 0.9e1 / 0.8e1 * t420 * t1108 * t441 * t3352 - 0.3e1 / 0.8e1 * t420 * t6631 * t2739 * t538 - 0.9e1 / 0.8e1 * t1103 * t3321 - 0.3e1 / 0.8e1 * t8131 - 0.3e1 / 0.4e1 * t8107 + t7616 / 0.4e1 - 0.3e1 / 0.8e1 * t8098;
  t8390 = my_piecewise3(t56, 0, t8337 + t8388);
  t8400 = t544 * t2845;
  t8405 = t544 * t2830;
  t8426 = t1380 * t1206;
  t8430 = t3099 * t3376 / 0.16e2 + t7895 * t1381 / 0.16e2 + 0.7e1 / 0.192e3 * t7988 + t1278 * t6972 * t8400 / 0.32e2 - 0.35e2 / 0.72e2 * t7635 + t1278 * t1279 * t8405 / 0.384e3 - t1266 * t1267 * t544 * t2778 / 0.384e3 + t1258 * t2364 * t8400 / 0.8e1 - t3099 * t3372 / 0.8e1 - t7848 * t3387 / 0.128e3 + t7851 * t1388 / 0.64e2 - 0.3e1 / 0.64e2 * t1266 * t2982 * t1384 * t1171 - t1258 * t1004 * t8426 / 0.8e1 + t7239 + t7246;
  t8458 = -0.7e1 / 0.48e2 * t8009 + t1258 * t1259 * t8405 / 0.48e2 - 0.7e1 / 0.24e2 * t8025 - 0.7e1 / 0.48e2 * t8028 - t2840 * t546 / 0.48e2 + 0.7e1 / 0.48e2 * t8033 - 0.3e1 / 0.128e3 * t1278 * t2982 * t8426 + t1266 * t1279 * t3386 * t477 / 0.64e2 + t1266 * t1279 * t1384 * t1206 / 0.64e2 + 0.7e1 / 0.24e2 * t8036 + 0.7e1 / 0.192e3 * t8051 + 0.7e1 / 0.64e2 * t8056 - 0.7e1 / 0.192e3 * t8059 + 0.35e2 / 0.72e2 * t7735 + 0.119e3 / 0.576e3 * t7740 - 0.119e3 / 0.576e3 * t7749;
  t8469 = 0.3e1 * t1329 * t8137 + 0.3e1 * t1329 * t8152 + 0.6e1 * t1329 * t8142 + t554 * t2828 + 0.3e1 * t3258 * t3183 + 0.3e1 * t3398 * t475 + 0.3e1 * t3650 * t8167 + t1 * t8390 + t8200 * t1297 + 0.3e1 * t3256 * t3240 + t263 * (t8430 + t8458) * t189 + 0.3e1 * t3258 * t3240 + 0.3e1 * t1392 * t1204 + t8202 * t1297 + 0.3e1 * t3256 * t3183;
  tv4rho3sigma11 = t7 * t8469 + 0.3e1 * t3358 + 0.3e1 * t3359 + 0.3e1 * t3360 + 0.6e1 * t3361 + 0.6e1 * t3363 + 0.3e1 * t3399 + 0.6e1 * t3400 + 0.3e1 * t3402;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t8481 = t213 * t589 * t3442;
  t8526 = t1242 * t1242;
  t8534 = -0.3e1 / 0.4e1 * t582 * t3443 - t8481 / 0.4e1 - 0.3e1 / 0.8e1 * t213 * t215 * (-0.19e2 / 0.162e3 * t225 * t227 * t607 * t236 + 0.167e3 / 0.1296e4 * t615 * t2905 * sigma[0] - 0.25e2 / 0.3456e4 * t1575 * t2912 * t1582 * t229 * t1584 + t4067 * t616 / t37 / t617 / t605 * t4075 * t4077 / 0.7776e4) - 0.3e1 / 0.2e1 * t7057 * t7058 * t3414 - 0.3e1 / 0.8e1 * t213 * t4114 * t595 * t1397 - 0.3e1 / 0.8e1 * t213 * t1616 * t595 * t1409 - 0.3e1 / 0.8e1 * t1596 * t1398 - 0.3e1 / 0.8e1 * t1596 * t1410 - 0.3e1 / 0.8e1 * t213 * t1616 * t626 * t1397 - 0.3e1 / 0.4e1 * t213 * t594 * t8526 - 0.3e1 / 0.4e1 * t213 * t594 * t499 * t2917;
  t8535 = t582 * t3420;
  t8541 = t213 * t1549 * t1409 / 0.12e2;
  t8543 = t213 * t1607 * t3423;
  t8553 = t582 * t3407;
  t8561 = t213 * t4033 * t1397 / 0.12e2;
  t8563 = t213 * t1607 * t3414;
  t8566 = t213 * t4105 * t3410;
  t8568 = -t8535 / 0.4e1 - 0.3e1 / 0.4e1 * t582 * t3424 + t8541 - t8543 / 0.4e1 - 0.3e1 / 0.8e1 * t213 * t594 * t626 * t1409 - 0.3e1 / 0.4e1 * t213 * t594 * t240 * t3442 - t8553 / 0.4e1 - 0.3e1 / 0.2e1 * t582 * t3415 - 0.3e1 / 0.4e1 * t582 * t3411 + t8561 - t8563 / 0.2e1 - t8566 / 0.4e1;
  t8570 = my_piecewise3(t2, 0, t8534 + t8568);
  t8574 = t1249 * t1283;
  t8577 = t1416 * t387;
  t8580 = t1283 * t1283;
  t8591 = t3512 * t189;
  t8594 = t1449 * t387;
  t8600 = 0.1e1 / t3864 * t699;
  t8603 = 0.7e1 / 0.768e3 * t1438 * t8600 * t1419;
  t8607 = 0.35e2 / 0.432e3 * t101 * t1419 * t690 * t192;
  t8616 = t275 * t3459;
  t8618 = t1419 * t902;
  t8623 = t1266 * t2960 * t3502;
  t8625 = t1419 * t700;
  t8629 = t1430 * t700;
  t8634 = t3465 * t2960 * t3466;
  t8640 = t1430 * t902;
  t8644 = t2061 * t1419;
  t8645 = t273 * t389;
  t8649 = t1419 * t680;
  t8654 = t1460 * t2978 * t3474;
  t8664 = -t682 * t1421 / 0.96e2 - t8603 - t8607 - t1266 * t1279 * t3502 * t389 / 0.192e3 + 0.5e1 / 0.192e3 * t3465 * t1279 * t3466 * t389 + 0.7e1 / 0.144e3 * t8616 + 0.5e1 / 0.768e3 * t1460 * t1279 * t8618 - 0.7e1 / 0.576e3 * t8623 - 0.5e1 / 0.256e3 * t1460 * t2982 * t8625 + t1258 * t1004 * t8629 / 0.48e2 + 0.35e2 / 0.576e3 * t8634 + t1266 * t1267 * t1430 * t680 / 0.768e3 - t1258 * t1259 * t8640 / 0.96e2 + 0.3e1 / 0.1024e4 * t3549 * t8644 * t8645 - 0.5e1 / 0.768e3 * t3465 * t1267 * t8649 - 0.35e2 / 0.576e3 * t8654 - t1278 * t1279 * t8640 / 0.768e3 + t1278 * t2982 * t8629 / 0.256e3 - t2936 * t3484 / 0.48e2;
  t8666 = t1258 * t2943 * t3483;
  t8668 = t98 * M_PI;
  t8669 = t8668 * t1437;
  t8675 = t3488 * t3494 * t3466;
  t8679 = t105 * t2973;
  t8682 = 0.595e3 / 0.6912e4 * t514 * t8679 * t1425;
  t8688 = t3493 * t2061;
  t8690 = t1438 * t8688 * t3474;
  t8695 = t1440 * t4916;
  t8704 = t101 * t3458 * t390;
  t8709 = t275 * t3480;
  t8713 = 0.35e2 / 0.432e3 * t101 * t2939 * t1431;
  t8719 = 0.119e3 / 0.6912e4 * t514 * t2974 * t1445;
  t8721 = t1278 * t2978 * t3483;
  t8723 = 0.7e1 / 0.144e3 * t8666 - t8669 * t1441 * t1419 * t2955 / 0.1024e4 + 0.7e1 / 0.1024e4 * t8675 - 0.5e1 / 0.768e3 * t2957 * t1426 - t8682 + t682 * t1432 / 0.96e2 - t3488 * t1441 * t8649 / 0.2048e4 - 0.7e1 / 0.1024e4 * t8690 + t1438 * t3498 * t8618 / 0.2048e4 - t1438 * t8695 * t8625 / 0.512e3 + t2957 * t1446 / 0.768e3 + t275 * t3462 / 0.48e2 - 0.7e1 / 0.144e3 * t8704 - t101 * t1420 * t701 / 0.48e2 - 0.7e1 / 0.144e3 * t8709 + t8713 + t101 * t1420 * t903 / 0.96e2 + t8719 + 0.7e1 / 0.576e3 * t8721;
  t8730 = t1 * t8570 + t5871 * t3449 + t5899 * t3449 + 0.4e1 * t2473 * t8574 + 0.2e1 * t2473 * t8577 + 0.2e1 * t659 * t8580 * t189 + 0.4e1 * t1453 * t7049 + 0.2e1 * t1453 * t7158 + t1417 * t900 + t2178 * t3454 + t2180 * t3454 + 0.2e1 * t967 * t8591 + 0.2e1 * t967 * t8594 + t263 * (t8664 + t8723) * t189 + 0.2e1 * t3513 * t387 + t1450 * t900;
  tv4rho2sigma20 = t7 * t8730 + 0.2e1 * t3448 + 0.2e1 * t3450 + 0.4e1 * t3451 + 0.2e1 * t3453 + 0.2e1 * t3455 + 0.2e1 * t3514 + 0.2e1 * t3515;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  t8742 = t3518 * t387;
  t8746 = t1283 * t553 * t189;
  t8750 = t1468 * t387;
  t8754 = t523 * t1318 * t189;
  t8774 = t3465 * t2960 * t3537;
  t8776 = t1459 * t517;
  t8777 = t1264 * t8776;
  t8788 = 0.7e1 / 0.768e3 * t1438 * t8600 * t1461;
  t8789 = t1437 * t3493;
  t8790 = t1436 * t8789;
  t8791 = t8790 * t3559;
  t8799 = 0.35e2 / 0.432e3 * t101 * t506 * t690 * t545;
  t8800 = t3534 * t3028;
  t8804 = -0.5e1 / 0.256e3 * t1460 * t2982 * t1461 * t700 + 0.35e2 / 0.576e3 * t8774 + 0.5e1 / 0.192e3 * t8777 * t3550 * t2964 - t682 * t1456 / 0.96e2 - t3549 * t3550 * t2968 / 0.2048e4 - t8788 - 0.7e1 / 0.1024e4 * t8791 + t3557 * t3558 * t2951 / 0.2048e4 - t8799 - 0.7e1 / 0.144e3 * t8800 + t3534 * t3036 / 0.96e2;
  t8805 = t275 * t3530;
  t8807 = t274 * t3533;
  t8810 = t4916 * t544;
  t8816 = 0.595e3 / 0.6912e4 * t1460 * t6980 * t1461;
  t8818 = t1460 * t2978 * t3544;
  t8824 = t8668 * t3548;
  t8829 = t3487 * t8789;
  t8830 = t8829 * t3551;
  t8844 = 0.7e1 / 0.144e3 * t8805 + t8807 * t1305 / 0.48e2 - t3557 * t8810 * t2947 / 0.512e3 - t8816 - 0.35e2 / 0.576e3 * t8818 + 0.5e1 / 0.768e3 * t1460 * t1279 * t1461 * t902 - t8824 * t3550 * t506 * t2955 / 0.1024e4 + 0.7e1 / 0.1024e4 * t8830 + 0.3e1 / 0.1024e4 * t3549 * t3558 * t2964 - t3534 * t3032 / 0.48e2 - 0.5e1 / 0.768e3 * t2956 * t1459 * t1462 - 0.5e1 / 0.768e3 * t3465 * t1267 * t1461 * t680;
  t8848 = t3562 * t189;
  t8852 = t2178 * t3525 + t5871 * t3519 + t2180 * t3525 + 0.2e1 * t2473 * t8742 + 0.2e1 * t2473 * t8746 + t1453 * t7201 + 0.2e1 * t967 * t8750 + 0.2e1 * t2473 * t8754 + 0.2e1 * t1453 * t7307 + 0.2e1 * t3521 * t3016 + 0.2e1 * t3521 * t3013 + t1469 * t900 + t1453 * t7299 + 0.2e1 * t3563 * t387 + t659 * t2989 * t1297 + t263 * (t8804 + t8844) * t189 + 0.2e1 * t967 * t8848 + t5899 * t3519;
  tv4rho2sigma22 = t7 * t8852 + 0.2e1 * t3520 + 0.2e1 * t3522 + 0.2e1 * t3523 + 0.2e1 * t3524 + 0.2e1 * t3526 + 0.2e1 * t3564 + 0.2e1 * t3565;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t8863 = t956 * t3570;
  t8867 = t420 * t5673 * t1472 / 0.12e2;
  t8870 = t956 * t3575;
  t8874 = t420 * t2170 * t1484 / 0.12e2;
  t8876 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t2165 * t1473 - t8863 / 0.4e1 + t8867 - 0.3e1 / 0.8e1 * t2165 * t1485 - t8870 / 0.4e1 + t8874);
  t8880 = t1297 * t1318;
  t8883 = t1491 * t387;
  t8886 = t1318 * t1318;
  t8897 = t3637 * t189;
  t8900 = t1516 * t387;
  t8905 = 0.35e2 / 0.432e3 * t101 * t2939 * t1505;
  t8910 = 0.595e3 / 0.6912e4 * t514 * t8679 * t1499;
  t8916 = t1494 * t700;
  t8925 = t3488 * t3494 * t3598;
  t8927 = t275 * t3611;
  t8930 = t101 * t3591 * t390;
  t8933 = t1438 * t8688 * t3605;
  t8935 = t1494 * t902;
  t8939 = t1494 * t680;
  t8947 = 0.119e3 / 0.6912e4 * t514 * t2974 * t1512;
  t8953 = t275 * t3592;
  t8959 = t8905 - 0.5e1 / 0.768e3 * t2957 * t1500 - t8910 - t101 * t1495 * t701 / 0.48e2 + t682 * t1506 / 0.96e2 - t1438 * t8695 * t8916 / 0.512e3 - t8669 * t1441 * t1494 * t2955 / 0.1024e4 + 0.7e1 / 0.1024e4 * t8925 - 0.7e1 / 0.144e3 * t8927 - 0.7e1 / 0.144e3 * t8930 - 0.7e1 / 0.1024e4 * t8933 + t1438 * t3498 * t8935 / 0.2048e4 - t3488 * t1441 * t8939 / 0.2048e4 + t2957 * t1513 / 0.768e3 + t8947 + t101 * t1495 * t903 / 0.96e2 + t275 * t3595 / 0.48e2 + 0.7e1 / 0.144e3 * t8953 - t1266 * t1279 * t3627 * t389 / 0.192e3;
  t8966 = 0.7e1 / 0.768e3 * t1438 * t8600 * t1494;
  t8970 = 0.35e2 / 0.432e3 * t101 * t1494 * t690 * t192;
  t8978 = t1278 * t2978 * t3614;
  t8980 = t1504 * t902;
  t8993 = t1258 * t2943 * t3614;
  t8999 = t1460 * t2978 * t3605;
  t9004 = t1504 * t700;
  t9009 = t1266 * t2960 * t3627;
  t9018 = t3465 * t2960 * t3598;
  t9020 = 0.5e1 / 0.192e3 * t3465 * t1279 * t3598 * t389 - t8966 - t8970 - t682 * t1496 / 0.96e2 + t1266 * t1267 * t1504 * t680 / 0.768e3 + 0.7e1 / 0.576e3 * t8978 - t1278 * t1279 * t8980 / 0.768e3 + 0.3e1 / 0.1024e4 * t3549 * t3942 * t8645 - t1258 * t1259 * t8980 / 0.96e2 - t2936 * t3615 / 0.48e2 + 0.7e1 / 0.144e3 * t8993 - 0.5e1 / 0.768e3 * t3465 * t1267 * t8939 - 0.35e2 / 0.576e3 * t8999 + 0.5e1 / 0.768e3 * t1460 * t1279 * t8935 + t1278 * t2982 * t9004 / 0.256e3 - 0.7e1 / 0.576e3 * t9009 - 0.5e1 / 0.256e3 * t1460 * t2982 * t8916 + t1258 * t1004 * t9004 / 0.48e2 + 0.35e2 / 0.576e3 * t9018;
  t9027 = t1 * t8876 + t5871 * t3581 + t5899 * t3581 + 0.4e1 * t2473 * t8880 + 0.2e1 * t2473 * t8883 + 0.2e1 * t659 * t8886 * t189 + 0.4e1 * t3583 * t7307 + 0.2e1 * t3583 * t7201 + t1492 * t900 + t2178 * t3587 + t2180 * t3587 + 0.2e1 * t967 * t8897 + 0.2e1 * t967 * t8900 + t263 * (t8959 + t9020) * t189 + 0.2e1 * t3638 * t387 + t1517 * t900;
  tv4rho2sigma25 = t7 * t9027 + 0.2e1 * t3580 + 0.2e1 * t3582 + 0.4e1 * t3584 + 0.2e1 * t3586 + 0.2e1 * t3588 + 0.2e1 * t3639 + 0.2e1 * t3640;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t9031 = t932 * t3407;
  t9042 = t932 * t3420;
  t9051 = -0.3e1 / 0.8e1 * t2116 * t1398 - t9031 / 0.8e1 - 0.3e1 / 0.8e1 * t932 * t3411 - 0.3e1 / 0.4e1 * t932 * t3415 - t8553 / 0.8e1 + t8561 - t8566 / 0.8e1 - t8563 / 0.4e1 - 0.3e1 / 0.8e1 * t2116 * t1410 - t9042 / 0.8e1 - 0.3e1 / 0.8e1 * t932 * t3424 - 0.3e1 / 0.8e1 * t932 * t3443 - t8535 / 0.8e1 + t8541 - t8543 / 0.8e1 - t8481 / 0.8e1;
  t9052 = my_piecewise3(t2, 0, t9051);
  t9057 = t1659 * t1061;
  t9062 = t1249 * t1344;
  t9071 = t1416 * t475;
  t9075 = t1416 * t189 * t482 * t6264 + t1 * t9052 + 0.2e1 * t1453 * t7475 + 0.2e1 * t1453 * t7537 + 0.2e1 * t1453 * t7540 + 0.2e1 * t2473 * t9062 + t2473 * t9071 + 0.2e1 * t3521 * t3093 + t9057 * t3449 + 0.2e1 * t3650 * t8574 + t3650 * t8577;
  t9083 = t3688 * t189;
  t9098 = t3671 * t389;
  t9113 = t458 * t3459;
  t9117 = -t8603 - t8607 - 0.5e1 / 0.256e3 * t1460 * t2982 * t3665 * t389 - t1266 * t1279 * t3681 * t389 / 0.384e3 + 0.7e1 / 0.288e3 * t8616 - t1266 * t1279 * t3671 * t273 / 0.384e3 + t1278 * t2982 * t9098 / 0.256e3 + t1258 * t1004 * t9098 / 0.48e2 + 0.5e1 / 0.384e3 * t3465 * t1279 * t3661 * t389 + 0.5e1 / 0.384e3 * t3465 * t1279 * t3665 * t273 + 0.7e1 / 0.288e3 * t9113 - 0.7e1 / 0.1152e4 * t8623 + 0.35e2 / 0.1152e4 * t8634;
  t9130 = t3488 * t3494 * t3661;
  t9132 = t458 * t3480;
  t9135 = t101 * t3458 * t478;
  t9137 = t1419 * t1056;
  t9141 = t1419 * t987;
  t9148 = t1438 * t8688 * t3665;
  t9150 = -t989 * t1421 / 0.96e2 - 0.35e2 / 0.1152e4 * t8654 + 0.7e1 / 0.288e3 * t8666 + t275 * t3658 / 0.96e2 + t101 * t1420 * t1057 / 0.96e2 + t458 * t3462 / 0.96e2 + 0.7e1 / 0.2048e4 * t9130 - 0.7e1 / 0.288e3 * t9132 - 0.7e1 / 0.288e3 * t9135 + t1438 * t3498 * t9137 / 0.2048e4 - t3488 * t1441 * t9141 / 0.2048e4 + t989 * t1432 / 0.96e2 - 0.7e1 / 0.2048e4 * t9148;
  t9160 = t3118 * t1459;
  t9169 = t1430 * t1056;
  t9174 = t456 * t273;
  t9178 = t456 * t389;
  t9183 = t1460 * t2978 * t3665;
  t9186 = t1258 * t2943 * t3671;
  t9189 = t3465 * t2960 * t3661;
  t9194 = -t100 * t4 * t1419 * t1006 / 0.48e2 - t3099 * t3484 / 0.96e2 - t2936 * t3672 / 0.96e2 - 0.5e1 / 0.768e3 * t9160 * t3662 - 0.5e1 / 0.768e3 * t3465 * t1267 * t9141 + 0.5e1 / 0.768e3 * t1460 * t1279 * t9137 - t1258 * t1259 * t9169 / 0.96e2 - t8824 * t699 * t1419 * t9174 / 0.1024e4 + 0.3e1 / 0.2048e4 * t3549 * t8644 * t9178 - 0.35e2 / 0.1152e4 * t9183 + 0.7e1 / 0.288e3 * t9186 + 0.35e2 / 0.1152e4 * t9189 - t1278 * t1279 * t9169 / 0.768e3;
  t9203 = t1266 * t2960 * t3681;
  t9206 = t1278 * t2978 * t3671;
  t9219 = 0.3e1 / 0.2048e4 * t3549 * t8644 * t7388 - t3557 * t4916 * t1419 * t1005 / 0.512e3 - 0.7e1 / 0.1152e4 * t9203 + 0.7e1 / 0.1152e4 * t9206 + t3119 * t3682 / 0.768e3 + t1266 * t1267 * t1430 * t987 / 0.768e3 + 0.7e1 / 0.2048e4 * t8675 - t8682 - 0.7e1 / 0.2048e4 * t8690 - 0.7e1 / 0.288e3 * t8704 - 0.7e1 / 0.288e3 * t8709 + t8713 + t8719 + 0.7e1 / 0.1152e4 * t8721;
  t9225 = t1449 * t475;
  t9229 = t1417 * t1054 + t2473 * t482 * t1449 * t189 + t3089 * t3454 + t1329 * t8591 + t1329 * t8594 + t967 * t9083 + t263 * (t9117 + t9150 + t9194 + t9219) * t189 + t3689 * t387 + t967 * t9225 + t3513 * t475 + t1450 * t1054;
  tv4rho2sigma26 = t3448 + t3450 + t3452 + t3453 + t3455 + t3514 + t3515 + t3649 + t3651 + t3653 + t3654 + t3655 + t3690 + t3691 + t7 * (t9075 + t9229);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  t9234 = t3718 * t189;
  t9237 = t1468 * t475;
  t9248 = t3519 * t482 * t6264 + t1329 * t8750 + t1329 * t8848 + t1453 * t7567 + t1453 * t7575 + t3521 * t3183 + t3521 * t3240 + t9057 * t3519 + t3563 * t475 + t3650 * t8742 + t3719 * t387 + t967 * t9234 + t967 * t9237;
  t9250 = t523 * t1391 * t189;
  t9253 = t3518 * t475;
  t9257 = t1344 * t553 * t189;
  t9287 = t3465 * t2960 * t3704;
  t9290 = t1460 * t2978 * t3708;
  t9305 = t3534 * t3195;
  t9312 = 0.3e1 / 0.2048e4 * t3549 * t3558 * t3135 - t3557 * t8810 * t3109 / 0.512e3 + 0.5e1 / 0.768e3 * t1460 * t1279 * t1461 * t1056 - t8824 * t3550 * t1337 * t273 / 0.1024e4 - t989 * t1456 / 0.96e2 + 0.3e1 / 0.2048e4 * t3549 * t3558 * t3125 + 0.35e2 / 0.1152e4 * t9287 - 0.35e2 / 0.1152e4 * t9290 - t3534 * t3199 / 0.48e2 - 0.5e1 / 0.768e3 * t9160 * t3705 - 0.5e1 / 0.768e3 * t3465 * t1267 * t1461 * t987 + t3534 * t3203 / 0.96e2 + t3557 * t3558 * t3113 / 0.2048e4 - 0.7e1 / 0.288e3 * t9305 - t3549 * t3550 * t3129 / 0.2048e4 + t8807 * t1381 / 0.96e2;
  t9313 = t8829 * t3712;
  t9315 = t457 * t3533;
  t9318 = t8790 * t3715;
  t9320 = t458 * t3530;
  t9338 = 0.7e1 / 0.2048e4 * t9313 + t9315 * t1305 / 0.96e2 - 0.7e1 / 0.2048e4 * t9318 + 0.7e1 / 0.288e3 * t9320 - t8799 + 0.7e1 / 0.288e3 * t8805 - t8788 + 0.35e2 / 0.1152e4 * t8774 - 0.35e2 / 0.1152e4 * t8818 + 0.5e1 / 0.384e3 * t8777 * t3550 * t3125 + 0.5e1 / 0.384e3 * t8777 * t3550 * t3135 - 0.5e1 / 0.256e3 * t512 * t8776 * t3558 * t3109 - 0.7e1 / 0.2048e4 * t8791 - 0.7e1 / 0.288e3 * t8800 - t8816 + 0.7e1 / 0.2048e4 * t8830;
  t9345 = t2473 * t9250 + t3650 * t8746 + t2473 * t9253 + t1469 * t1054 + t2473 * t9257 + t3089 * t3525 + t3650 * t8754 + t1453 * t7559 + t3695 * t3016 + t659 * t3149 * t1297 + t3695 * t3013 + t1453 * t7621 + t263 * (t9312 + t9338) * t189 + t2473 * t482 * t1468 * t189;
  tv4rho2sigma28 = t3520 + t3522 + t3523 + t3524 + t3526 + t3564 + t3565 + t3694 + t3696 + t3697 + t3698 + t3699 + t3720 + t3721 + t7 * (t9248 + t9345);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t9350 = t1103 * t3570;
  t9356 = t420 * t6230 * t3726;
  t9361 = t420 * t2460 * t3730;
  t9365 = t1103 * t3575;
  t9371 = t420 * t2460 * t3736;
  t9376 = t420 * t959 * t3755;
  t9378 = -0.3e1 / 0.8e1 * t2451 * t1473 - t9350 / 0.8e1 - t8863 / 0.8e1 + t8867 - 0.3e1 / 0.8e1 * t956 * t3727 - t9356 / 0.8e1 - 0.3e1 / 0.4e1 * t956 * t3731 - t9361 / 0.4e1 - 0.3e1 / 0.8e1 * t2451 * t1485 - t9365 / 0.8e1 - t8870 / 0.8e1 + t8874 - 0.3e1 / 0.8e1 * t956 * t3737 - t9371 / 0.8e1 - 0.3e1 / 0.8e1 * t956 * t3756 - t9376 / 0.8e1;
  t9379 = my_piecewise3(t56, 0, t9378);
  t9388 = t1297 * t1391;
  t9391 = t659 * t1318;
  t9398 = t1491 * t475;
  t9402 = t1491 * t189 * t482 * t6264 + t1 * t9379 + 0.2e1 * t2473 * t9388 + t2473 * t9398 + 0.2e1 * t9391 * t3183 + t9057 * t3581 + 0.2e1 * t3583 * t7567 + 0.2e1 * t3583 * t7575 + 0.2e1 * t3583 * t7621 + 0.2e1 * t3650 * t8880 + t3650 * t8883;
  t9410 = t3799 * t189;
  t9418 = t101 * t3591 * t478;
  t9426 = t3488 * t3494 * t3772;
  t9429 = t1438 * t8688 * t3776;
  t9431 = t101 * t1495 * t1057 / 0.96e2 + t458 * t3595 / 0.96e2 - 0.7e1 / 0.288e3 * t9418 + t8905 - t8910 + 0.7e1 / 0.2048e4 * t8925 - 0.7e1 / 0.288e3 * t8927 - 0.7e1 / 0.288e3 * t8930 - 0.7e1 / 0.2048e4 * t8933 + t8947 + 0.7e1 / 0.288e3 * t8953 + 0.7e1 / 0.2048e4 * t9426 - 0.7e1 / 0.2048e4 * t9429;
  t9438 = t4916 * t1494;
  t9449 = t1266 * t2960 * t3792;
  t9452 = t1278 * t2978 * t3782;
  t9454 = t458 * t3611;
  t9456 = t1504 * t1056;
  t9464 = t1494 * t987;
  t9468 = -t8966 + 0.3e1 / 0.2048e4 * t3549 * t3942 * t9178 + 0.3e1 / 0.2048e4 * t3549 * t3942 * t7388 - t3557 * t9438 * t1005 / 0.512e3 + t3119 * t3793 / 0.768e3 + t1266 * t1267 * t1504 * t987 / 0.768e3 - 0.7e1 / 0.1152e4 * t9449 + 0.7e1 / 0.1152e4 * t9452 - 0.7e1 / 0.288e3 * t9454 - t1278 * t1279 * t9456 / 0.768e3 + t989 * t1506 / 0.96e2 + t275 * t3769 / 0.96e2 - t3488 * t1441 * t9464 / 0.2048e4;
  t9470 = t1494 * t1056;
  t9482 = t3782 * t389;
  t9513 = t1438 * t3498 * t9470 / 0.2048e4 - t8970 - t1266 * t1279 * t3792 * t389 / 0.384e3 - t1266 * t1279 * t3782 * t273 / 0.384e3 + t1278 * t2982 * t9482 / 0.256e3 + 0.5e1 / 0.384e3 * t3465 * t1279 * t3772 * t389 + 0.5e1 / 0.384e3 * t3465 * t1279 * t3776 * t273 - 0.5e1 / 0.256e3 * t1460 * t2982 * t3776 * t389 + t1258 * t1004 * t9482 / 0.48e2 - t100 * t4 * t1494 * t1006 / 0.48e2 - 0.5e1 / 0.768e3 * t9160 * t3773 - 0.5e1 / 0.768e3 * t3465 * t1267 * t9464 + 0.5e1 / 0.768e3 * t1460 * t1279 * t9470;
  t9521 = t699 * t1494;
  t9526 = t1258 * t2943 * t3782;
  t9529 = t3465 * t2960 * t3772;
  t9532 = t1460 * t2978 * t3776;
  t9534 = t458 * t3592;
  t9543 = -t3099 * t3615 / 0.96e2 - t2936 * t3783 / 0.96e2 - t1258 * t1259 * t9456 / 0.96e2 - t8824 * t9521 * t9174 / 0.1024e4 + 0.7e1 / 0.288e3 * t9526 + 0.35e2 / 0.1152e4 * t9529 - 0.35e2 / 0.1152e4 * t9532 + 0.7e1 / 0.288e3 * t9534 - t989 * t1496 / 0.96e2 + 0.7e1 / 0.1152e4 * t8978 + 0.7e1 / 0.288e3 * t8993 - 0.35e2 / 0.1152e4 * t8999 - 0.7e1 / 0.1152e4 * t9009 + 0.35e2 / 0.1152e4 * t9018;
  t9549 = t1516 * t475;
  t9553 = t1492 * t1054 + t2473 * t482 * t1516 * t189 + t3089 * t3587 + t1329 * t8897 + t1329 * t8900 + t967 * t9410 + t263 * (t9431 + t9468 + t9513 + t9543) * t189 + t3800 * t387 + t967 * t9549 + t3638 * t475 + t1517 * t1054;
  tv4rho2sigma211 = t3580 + t3582 + t3585 + t3586 + t3588 + t3639 + t3640 + t3761 + t3762 + t3764 + t3765 + t3766 + t3801 + t3802 + t7 * (t9402 + t9553);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t9570 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t2420 * t1398 - t9031 / 0.4e1 + t8561 - 0.3e1 / 0.8e1 * t2420 * t1410 - t9042 / 0.4e1 + t8541);
  t9572 = t4221 * t1144;
  t9574 = t1659 * t1211;
  t9580 = t1344 * t1344;
  t9597 = t1419 * t1162;
  t9601 = t1419 * t1206;
  t9613 = t1430 * t1206;
  t9639 = -t8603 - t8607 + t1164 * t1432 / 0.96e2 - t3488 * t1441 * t9597 / 0.2048e4 + t1438 * t3498 * t9601 / 0.2048e4 + 0.5e1 / 0.192e3 * t3465 * t1279 * t3661 * t477 + t1266 * t1267 * t1430 * t1162 / 0.768e3 - t1278 * t1279 * t9613 / 0.768e3 + 0.3e1 / 0.1024e4 * t3549 * t8644 * t7898 - t1258 * t1259 * t9613 / 0.96e2 - t3099 * t3672 / 0.48e2 - 0.5e1 / 0.768e3 * t3465 * t1267 * t9597 - t1164 * t1421 / 0.96e2 + 0.7e1 / 0.144e3 * t9113 + 0.7e1 / 0.1024e4 * t9130 - 0.7e1 / 0.144e3 * t9132 - 0.7e1 / 0.144e3 * t9135 - t101 * t1420 * t1172 / 0.48e2 - 0.5e1 / 0.768e3 * t3280 * t1426;
  t9661 = t1419 * t1171;
  t9665 = t1430 * t1171;
  t9678 = -0.7e1 / 0.1024e4 * t9148 - t1266 * t1279 * t3681 * t477 / 0.192e3 - 0.35e2 / 0.576e3 * t9183 + 0.7e1 / 0.144e3 * t9186 + 0.35e2 / 0.576e3 * t9189 - 0.7e1 / 0.576e3 * t9203 + 0.7e1 / 0.576e3 * t9206 - t8682 + t8713 + t8719 + t101 * t1420 * t1207 / 0.96e2 + t458 * t3658 / 0.48e2 + t3280 * t1446 / 0.768e3 - t8669 * t1441 * t1419 * t3278 / 0.1024e4 - t1438 * t8695 * t9661 / 0.512e3 + t1278 * t2982 * t9665 / 0.256e3 + t1258 * t1004 * t9665 / 0.48e2 + 0.5e1 / 0.768e3 * t1460 * t1279 * t9601 - 0.5e1 / 0.256e3 * t1460 * t2982 * t9661;
  t9685 = t1 * t9570 + t9572 * t3449 + t9574 * t3449 + 0.4e1 * t3650 * t9062 + 0.2e1 * t3650 * t9071 + 0.2e1 * t659 * t9580 * t189 + 0.4e1 * t1453 * t7832 + 0.2e1 * t1453 * t7838 + t1417 * t1204 + t3256 * t3454 + t3258 * t3454 + 0.2e1 * t1329 * t9083 + 0.2e1 * t1329 * t9225 + t263 * (t9639 + t9678) * t189 + 0.2e1 * t3689 * t475 + t1450 * t1204;
  tv4rho2sigma212 = t7 * t9685 + 0.2e1 * t3649 + 0.2e1 * t3651 + 0.4e1 * t3652 + 0.2e1 * t3654 + 0.2e1 * t3655 + 0.2e1 * t3690 + 0.2e1 * t3691;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  t9720 = 0.5e1 / 0.192e3 * t8777 * t3550 * t3284 + 0.7e1 / 0.144e3 * t9320 - 0.5e1 / 0.256e3 * t1460 * t2982 * t1461 * t1171 - 0.7e1 / 0.1024e4 * t9318 + 0.7e1 / 0.1024e4 * t9313 + 0.35e2 / 0.576e3 * t9287 - 0.35e2 / 0.576e3 * t9290 - t3549 * t3550 * t3288 / 0.2048e4 + t3557 * t3558 * t3274 / 0.2048e4 + t3534 * t3376 / 0.96e2 - t1164 * t1456 / 0.96e2;
  t9747 = -t3557 * t8810 * t3270 / 0.512e3 + 0.5e1 / 0.768e3 * t1460 * t1279 * t1461 * t1206 - t8824 * t3550 * t506 * t3278 / 0.1024e4 + 0.3e1 / 0.1024e4 * t3549 * t3558 * t3284 - 0.5e1 / 0.768e3 * t3279 * t1459 * t1462 - 0.5e1 / 0.768e3 * t3465 * t1267 * t1461 * t1162 - t3534 * t3372 / 0.48e2 - 0.7e1 / 0.144e3 * t9305 - t8788 - t8799 + t9315 * t1381 / 0.48e2 - t8816;
  t9774 = 0.2e1 * t1453 * t8142 + 0.2e1 * t1329 * t9234 + t263 * (t9720 + t9747) * t189 + t659 * t3299 * t1297 + 0.2e1 * t3695 * t3240 + t1453 * t8152 + t3258 * t3525 + t3256 * t3525 + 0.2e1 * t3650 * t9250 + 0.2e1 * t1329 * t9237 + 0.2e1 * t3650 * t9257 + t1453 * t8137 + 0.2e1 * t3650 * t9253 + t1469 * t1204 + t9574 * t3519 + 0.2e1 * t3719 * t475 + 0.2e1 * t3695 * t3183 + t9572 * t3519;
  tv4rho2sigma214 = t7 * t9774 + 0.2e1 * t3694 + 0.2e1 * t3696 + 0.2e1 * t3697 + 0.2e1 * t3698 + 0.2e1 * t3699 + 0.2e1 * t3720 + 0.2e1 * t3721;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t9791 = t1370 * t1370;
  t9820 = -0.3e1 / 0.2e1 * t1103 * t3731 - 0.3e1 / 0.4e1 * t1103 * t3727 - 0.3e1 / 0.8e1 * t420 * t2738 * t1136 * t1472 - 0.3e1 / 0.4e1 * t420 * t1108 * t9791 - 0.3e1 / 0.4e1 * t420 * t1108 * t538 * t3352 - 0.3e1 / 0.4e1 * t1103 * t3737 - 0.3e1 / 0.8e1 * t420 * t1108 * t1136 * t1484 - 0.3e1 / 0.4e1 * t420 * t1108 * t441 * t3755 - 0.3e1 / 0.8e1 * t420 * t2738 * t1109 * t1484 - 0.3e1 / 0.2e1 * t8322 * t8323 * t3730 - 0.3e1 / 0.8e1 * t420 * t6631 * t1109 * t1472;
  t9857 = -t9361 / 0.2e1 - t9371 / 0.4e1 - 0.3e1 / 0.8e1 * t2726 * t1473 - 0.3e1 / 0.8e1 * t2726 * t1485 - 0.3e1 / 0.4e1 * t1103 * t3756 - 0.3e1 / 0.8e1 * t420 * t422 * (-0.19e2 / 0.162e3 * t225 * t227 * t1121 * t437 + 0.167e3 / 0.1296e4 * t615 * t3340 * sigma[2] - 0.25e2 / 0.3456e4 * t1575 * t3347 * t2717 * t430 * t1584 + t4067 * t1126 / t65 / t1127 / t1119 * t6709 * t4077 / 0.7776e4) - t9356 / 0.4e1 - t9350 / 0.4e1 + t8867 + t8874 - t9365 / 0.4e1 - t9376 / 0.4e1;
  t9859 = my_piecewise3(t56, 0, t9820 + t9857);
  t9867 = t1391 * t1391;
  t9900 = t1494 * t1171;
  t9906 = t1494 * t1162;
  t9912 = -0.7e1 / 0.144e3 * t9418 + t8905 - t8910 + t8947 + 0.7e1 / 0.1024e4 * t9426 - 0.7e1 / 0.1024e4 * t9429 - t8966 - t1164 * t1496 / 0.96e2 - 0.7e1 / 0.576e3 * t9449 + 0.7e1 / 0.576e3 * t9452 + 0.5e1 / 0.192e3 * t3465 * t1279 * t3772 * t477 - t1266 * t1279 * t3792 * t477 / 0.192e3 - 0.7e1 / 0.144e3 * t9454 - t8970 + t3280 * t1513 / 0.768e3 - t1438 * t8695 * t9900 / 0.512e3 + t458 * t3769 / 0.48e2 - t3488 * t1441 * t9906 / 0.2048e4 + t1164 * t1506 / 0.96e2;
  t9919 = t1494 * t1206;
  t9937 = t1504 * t1206;
  t9946 = t1504 * t1171;
  t9965 = -0.5e1 / 0.768e3 * t3280 * t1500 - t8669 * t1441 * t1494 * t3278 / 0.1024e4 + t1438 * t3498 * t9919 / 0.2048e4 - t101 * t1495 * t1172 / 0.48e2 + t101 * t1495 * t1207 / 0.96e2 + 0.7e1 / 0.144e3 * t9526 + 0.35e2 / 0.576e3 * t9529 - 0.35e2 / 0.576e3 * t9532 + 0.7e1 / 0.144e3 * t9534 + t1266 * t1267 * t1504 * t1162 / 0.768e3 - t1278 * t1279 * t9937 / 0.768e3 - t3099 * t3783 / 0.48e2 - t1258 * t1259 * t9937 / 0.96e2 + t1278 * t2982 * t9946 / 0.256e3 + 0.3e1 / 0.1024e4 * t3549 * t3942 * t7898 - 0.5e1 / 0.256e3 * t1460 * t2982 * t9900 + t1258 * t1004 * t9946 / 0.48e2 - 0.5e1 / 0.768e3 * t3465 * t1267 * t9906 + 0.5e1 / 0.768e3 * t1460 * t1279 * t9919;
  t9972 = t1 * t9859 + t9572 * t3581 + t9574 * t3581 + 0.4e1 * t3650 * t9388 + 0.2e1 * t3650 * t9398 + 0.2e1 * t659 * t9867 * t189 + 0.4e1 * t3583 * t8142 + 0.2e1 * t3583 * t8137 + t1492 * t1204 + t3256 * t3587 + t3258 * t3587 + 0.2e1 * t1329 * t9410 + 0.2e1 * t1329 * t9549 + t263 * (t9912 + t9965) * t189 + 0.2e1 * t3800 * t475 + t1517 * t1204;
  tv4rho2sigma217 = t7 * t9972 + 0.2e1 * t3761 + 0.2e1 * t3762 + 0.4e1 * t3763 + 0.2e1 * t3765 + 0.2e1 * t3766 + 0.2e1 * t3801 + 0.2e1 * t3802;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t9978 = t213 * t4105 * t3805 / 0.8e1;
  t9991 = 0.3e1 / 0.8e1 * t213 * t1607 * t3809;
  t10007 = t213 * t589 * t3823 / 0.8e1;
  t10015 = t1582 * t29;
  t10030 = -0.3e1 / 0.8e1 * t582 * t3806 - t9978 - 0.3e1 / 0.8e1 * t213 * t4114 * t240 * t3805 - 0.9e1 / 0.8e1 * t213 * t1616 * t1397 * t1242 - 0.9e1 / 0.8e1 * t582 * t3810 - t9991 - 0.9e1 / 0.8e1 * t7057 * t7058 * t3809 - 0.9e1 / 0.8e1 * t213 * t594 * t1242 * t1409 - 0.9e1 / 0.8e1 * t213 * t594 * t499 * t3442 - 0.3e1 / 0.8e1 * t582 * t3824 - t10007 - 0.3e1 / 0.8e1 * t213 * t594 * t240 * t3823 - 0.3e1 / 0.8e1 * t213 * t215 * (-t615 * t3431 / 0.48e2 + 0.7e1 / 0.3456e4 * t1575 * t3437 * t10015 * t42 - t4067 * t229 / t37 / t4059 * t4075 * t4077 / 0.20736e5);
  t10031 = my_piecewise3(t2, 0, t10030);
  t10033 = t3830 * t189;
  t10038 = t1249 * t1449;
  t10047 = t3879 * t189;
  t10054 = 0.7e1 / 0.192e3 * t101 * t3835 * t280 * t192;
  t10058 = t513 * t1430;
  t10059 = t1264 * t10058;
  t10061 = t1267 * t104 * t273;
  t10067 = 0.7e1 / 0.384e3 * t514 * t1430 * t1273 * t3841;
  t10068 = t512 * t10058;
  t10070 = t1279 * t104 * t389;
  t10073 = t3487 * t515;
  t10079 = 0.21e2 / 0.4096e4 * t3845 * t3494 * t1430;
  t10083 = t3835 * t273;
  t10089 = 0.35e2 / 0.1536e4 * t514 * t3470 * t3849;
  t10090 = t3835 * t389;
  t10094 = t275 * t3837 / 0.64e2 - t10054 - t101 * t3836 * t390 / 0.64e2 - t10059 * t10061 / 0.128e3 + t10067 + t10068 * t10070 / 0.128e3 - 0.9e1 / 0.4096e4 * t10073 * t1441 * t3502 + t10079 + 0.9e1 / 0.4096e4 * t3845 * t3498 * t3483 + 0.5e1 / 0.512e3 * t3465 * t1267 * t10083 - t10089 - 0.5e1 / 0.512e3 * t1460 * t1279 * t10090;
  t10099 = 0.7e1 / 0.192e3 * t101 * t1253 * t3855;
  t10100 = t3854 * t389;
  t10105 = t1435 * t3860 * t3907;
  t10106 = t2061 * t1430;
  t10112 = 0.1e1 / t27 / t3492 / t106;
  t10113 = t10112 * t2061;
  t10116 = 0.7e1 / 0.73728e5 * t3863 * t10113 * t3868;
  t10117 = t4916 * t1430;
  t10118 = t99 * t389;
  t10127 = 0.7e1 / 0.4096e4 * t1438 * t3494 * t3835;
  t10137 = 0.7e1 / 0.1536e4 * t514 * t1274 * t3875;
  t10141 = -t275 * t3856 / 0.64e2 + t10099 + t1258 * t1259 * t10100 / 0.64e2 - t10105 * t10106 * t274 / 0.24576e5 + t10116 + t3908 * t10117 * t10118 / 0.24576e5 + 0.3e1 / 0.4096e4 * t3488 * t1441 * t10083 - t10127 - 0.3e1 / 0.4096e4 * t1438 * t3498 * t10090 - t1266 * t1267 * t3854 * t273 / 0.512e3 + t10137 + t1278 * t1279 * t10100 / 0.512e3;
  t10146 = t1 * t10031 + t6264 * t10033 + 0.3e1 * t3883 * t2926 + t3831 * t387 + 0.3e1 * t2473 * t10038 + 0.3e1 * t3521 * t3454 + 0.3e1 * t1453 * t8594 + 0.3e1 * t1453 * t8591 + t967 * t10047 + t263 * (t10094 + t10141) * t189 + t3880 * t387;
  tv4rhosigma30 = t7 * t10146 + t3829 + t3832 + t3834 + t3881;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  t10149 = t1416 * t553 * t189;
  t10156 = t1449 * t553 * t189;
  t10163 = t523 * t1468 * t189;
  t10172 = t3916 * t189;
  t10179 = 0.7e1 / 0.576e3 * t101 * t1430 * t280 * t545;
  t10181 = t100 * t4 * t1430;
  t10184 = t1264 * t3893;
  t10191 = 0.7e1 / 0.384e3 * t3894 * t2960 * t3895;
  t10196 = t515 * t1440;
  t10197 = t3487 * t10196;
  t10203 = 0.21e2 / 0.4096e4 * t3845 * t3494 * t3899;
  t10204 = t1436 * t10196;
  t10214 = 0.35e2 / 0.4608e4 * t1460 * t2960 * t3903;
  t10224 = t3861 * t3862 * t10112;
  t10226 = 0.7e1 / 0.73728e5 * t10224 * t3910;
  t10236 = 0.7e1 / 0.12288e5 * t1438 * t3494 * t3903;
  t10240 = t275 * t3890 / 0.192e3 - t10179 - t10181 * t1305 / 0.192e3 - t10184 * t1267 * t3895 * t273 / 0.128e3 + t10191 + t3894 * t1279 * t3895 * t389 / 0.128e3 - 0.9e1 / 0.4096e4 * t10197 * t3550 * t3466 + t10203 + 0.9e1 / 0.4096e4 * t10204 * t3558 * t3474 + 0.5e1 / 0.1536e4 * t3465 * t1267 * t3903 * t273 - t10214 - 0.5e1 / 0.1536e4 * t1460 * t1279 * t3903 * t389 - t10105 * t3558 * t3909 * t273 / 0.24576e5 + t10226 + t3908 * t8810 * t3909 * t389 / 0.24576e5 + t3549 * t3550 * t3502 / 0.4096e4 - t10236 - t3557 * t3558 * t3483 / 0.4096e4;
  t10244 = t10240 * t189 * t263 + t1297 * t3512 * t659 + t6264 * t10149 + t2473 * t10156 + 0.2e1 * t2473 * t10163 + t967 * t10172 + 0.2e1 * t1453 * t8750 + 0.2e1 * t1453 * t8848 + t3883 * t3013 + t3885 * t3013 + t3883 * t3016 + t3885 * t3016 + 0.2e1 * t3521 * t3525 + t3917 * t387 + 0.2e1 * t3920 * t8746;
  tv4rhosigma32 = t7 * t10244 + t3884 + t3886 + t3888 + t3918;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  t10247 = t523 * t1491 * t189;
  t10254 = t1297 * t1468;
  t10264 = t523 * t1516 * t189;
  t10269 = t3950 * t189;
  t10271 = t1264 * t3925;
  t10278 = 0.7e1 / 0.384e3 * t3926 * t2960 * t3927;
  t10288 = 0.21e2 / 0.4096e4 * t3845 * t3494 * t3931;
  t10296 = 0.7e1 / 0.576e3 * t101 * t3529 * t1505;
  t10305 = 0.35e2 / 0.4608e4 * t1460 * t2960 * t3938;
  t10315 = 0.7e1 / 0.73728e5 * t10224 * t3944;
  t10320 = t699 * t1504;
  t10326 = 0.7e1 / 0.12288e5 * t1438 * t3494 * t3938;
  t10327 = t2061 * t1504;
  t10331 = -t10271 * t1267 * t3927 * t273 / 0.128e3 + t10278 + t3926 * t1279 * t3927 * t389 / 0.128e3 - 0.9e1 / 0.4096e4 * t10197 * t9521 * t1268 + t10288 + 0.9e1 / 0.4096e4 * t10204 * t3942 * t1260 + t275 * t3935 / 0.192e3 - t10296 - t3534 * t3615 / 0.192e3 + 0.5e1 / 0.1536e4 * t3465 * t1267 * t3938 * t273 - t10305 - 0.5e1 / 0.1536e4 * t1460 * t1279 * t3938 * t389 - t10105 * t3942 * t3943 * t273 / 0.24576e5 + t10315 + t3908 * t9438 * t3943 * t389 / 0.24576e5 + t3549 * t10320 * t1268 / 0.4096e4 - t10326 - t3557 * t10327 * t1260 / 0.4096e4;
  t10335 = t10331 * t189 * t263 + t1283 * t1659 * t3581 + t6264 * t10247 + 0.2e1 * t2473 * t10254 + t2473 * t10264 + t967 * t10269 + t1453 * t8897 + t1453 * t8900 + t3521 * t3587 + 0.2e1 * t9391 * t3525 + 0.2e1 * t3583 * t8750 + 0.2e1 * t3583 * t8848 + t3951 * t387 + 0.2e1 * t3920 * t8880 + t3920 * t8883;
  tv4rhosigma35 = t7 * t10335 + t3921 + t3923 + t3924 + t3952;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t10341 = t420 * t6230 * t3954 / 0.8e1;
  t10346 = 0.3e1 / 0.8e1 * t420 * t2460 * t3958;
  t10351 = t420 * t959 * t3972 / 0.8e1;
  t10353 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t956 * t3955 - t10341 - 0.9e1 / 0.8e1 * t956 * t3959 - t10346 - 0.3e1 / 0.8e1 * t956 * t3973 - t10351);
  t10355 = t3979 * t189;
  t10357 = t1659 * t1491;
  t10361 = t1297 * t1516;
  t10370 = t4017 * t189;
  t10377 = 0.7e1 / 0.192e3 * t101 * t3984 * t280 * t192;
  t10381 = t513 * t1504;
  t10382 = t1264 * t10381;
  t10388 = 0.7e1 / 0.384e3 * t514 * t1504 * t1273 * t3841;
  t10389 = t512 * t10381;
  t10397 = 0.21e2 / 0.4096e4 * t3845 * t3494 * t1504;
  t10401 = t3984 * t273;
  t10407 = 0.35e2 / 0.1536e4 * t514 * t3470 * t3996;
  t10408 = t3984 * t389;
  t10412 = t275 * t3986 / 0.64e2 - t10377 - t101 * t3985 * t390 / 0.64e2 - t10382 * t10061 / 0.128e3 + t10388 + t10389 * t10070 / 0.128e3 - 0.9e1 / 0.4096e4 * t10073 * t1441 * t3627 + t10397 + 0.9e1 / 0.4096e4 * t3845 * t3498 * t3614 + 0.5e1 / 0.512e3 * t3465 * t1267 * t10401 - t10407 - 0.5e1 / 0.512e3 * t1460 * t1279 * t10408;
  t10417 = 0.7e1 / 0.192e3 * t101 * t1253 * t4002;
  t10418 = t4001 * t389;
  t10427 = 0.7e1 / 0.73728e5 * t3863 * t10113 * t4006;
  t10428 = t4916 * t1504;
  t10437 = 0.7e1 / 0.4096e4 * t1438 * t3494 * t3984;
  t10447 = 0.7e1 / 0.1536e4 * t514 * t1274 * t4013;
  t10451 = -t275 * t4003 / 0.64e2 + t10417 + t1258 * t1259 * t10418 / 0.64e2 - t10105 * t10327 * t274 / 0.24576e5 + t10427 + t3908 * t10428 * t10118 / 0.24576e5 + 0.3e1 / 0.4096e4 * t3488 * t1441 * t10401 - t10437 - 0.3e1 / 0.4096e4 * t1438 * t3498 * t10408 - t1266 * t1267 * t4001 * t273 / 0.512e3 + t10447 + t1278 * t1279 * t10418 / 0.512e3;
  t10456 = t1 * t10353 + t6264 * t10355 + 0.3e1 * t10357 * t3013 + t3980 * t387 + 0.3e1 * t2473 * t10361 + 0.3e1 * t9391 * t3587 + 0.3e1 * t3583 * t8900 + 0.3e1 * t3583 * t8897 + t967 * t10370 + t263 * (t10412 + t10451) * t189 + t4018 * t387;
  tv4rhosigma39 = t7 * t10456 + t3978 + t3981 + t3983 + t4019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t10465 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t932 * t3806 - t9978 - 0.9e1 / 0.8e1 * t932 * t3810 - t9991 - 0.3e1 / 0.8e1 * t932 * t3824 - t10007);
  t10467 = t4221 * t482;
  t10487 = t1267 * t104 * t456;
  t10491 = t1279 * t104 * t477;
  t10500 = t3835 * t456;
  t10504 = t3835 * t477;
  t10508 = t458 * t3837 / 0.64e2 - t10054 - t101 * t3836 * t478 / 0.64e2 - t10059 * t10487 / 0.128e3 + t10067 + t10068 * t10491 / 0.128e3 - 0.9e1 / 0.4096e4 * t10073 * t1441 * t3681 + t10079 + 0.9e1 / 0.4096e4 * t3845 * t3498 * t3671 + 0.5e1 / 0.512e3 * t3465 * t1267 * t10500 - t10089 - 0.5e1 / 0.512e3 * t1460 * t1279 * t10504;
  t10511 = t3854 * t477;
  t10518 = t99 * t477;
  t10535 = -t458 * t3856 / 0.64e2 + t10099 + t1258 * t1259 * t10511 / 0.64e2 - t10105 * t10106 * t457 / 0.24576e5 + t10116 + t3908 * t10117 * t10518 / 0.24576e5 + 0.3e1 / 0.4096e4 * t3488 * t1441 * t10500 - t10127 - 0.3e1 / 0.4096e4 * t1438 * t3498 * t10504 - t1266 * t1267 * t3854 * t456 / 0.512e3 + t10137 + t1278 * t1279 * t10511 / 0.512e3;
  t10540 = t1 * t10465 + t10467 * t10033 + 0.3e1 * t3883 * t3093 + t3831 * t475 + 0.3e1 * t3650 * t10038 + 0.3e1 * t3695 * t3454 + 0.3e1 * t1453 * t9225 + 0.3e1 * t1453 * t9083 + t1329 * t10047 + t263 * (t10508 + t10535) * t189 + t3880 * t475;
  tv4rhosigma310 = t7 * t10540 + t3829 + t3832 + t3834 + t3881;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  t10601 = t458 * t3890 / 0.192e3 - t10179 - t10181 * t1381 / 0.192e3 - t10184 * t1267 * t3895 * t456 / 0.128e3 + t10191 + t3894 * t1279 * t3895 * t477 / 0.128e3 - 0.9e1 / 0.4096e4 * t10197 * t3550 * t3661 + t10203 + 0.9e1 / 0.4096e4 * t10204 * t3558 * t3665 + 0.5e1 / 0.1536e4 * t3465 * t1267 * t3903 * t456 - t10214 - 0.5e1 / 0.1536e4 * t1460 * t1279 * t3903 * t477 - t10105 * t3558 * t3909 * t456 / 0.24576e5 + t10226 + t3908 * t8810 * t3909 * t477 / 0.24576e5 + t3549 * t3550 * t3681 / 0.4096e4 - t10236 - t3557 * t3558 * t3671 / 0.4096e4;
  t10605 = t10601 * t189 * t263 + t1297 * t3688 * t659 + t10467 * t10149 + t3650 * t10156 + 0.2e1 * t3650 * t10163 + t1329 * t10172 + 0.2e1 * t1453 * t9234 + 0.2e1 * t1453 * t9237 + t3883 * t3183 + t3885 * t3183 + t3883 * t3240 + t3885 * t3240 + 0.2e1 * t3695 * t3525 + t3917 * t475 + 0.2e1 * t3920 * t9257;
  tv4rhosigma312 = t7 * t10605 + t3884 + t3886 + t3888 + t3918;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  t10615 = t659 * t1391;
  t10667 = -t10271 * t1267 * t3927 * t456 / 0.128e3 + t10278 + t3926 * t1279 * t3927 * t477 / 0.128e3 - 0.9e1 / 0.4096e4 * t10197 * t9521 * t1337 + t10288 + 0.9e1 / 0.4096e4 * t10204 * t3942 * t1333 + t458 * t3935 / 0.192e3 - t10296 - t3534 * t3783 / 0.192e3 + 0.5e1 / 0.1536e4 * t3465 * t1267 * t3938 * t456 - t10305 - 0.5e1 / 0.1536e4 * t1460 * t1279 * t3938 * t477 - t10105 * t3942 * t3943 * t456 / 0.24576e5 + t10315 + t3908 * t9438 * t3943 * t477 / 0.24576e5 + t3549 * t10320 * t1337 / 0.4096e4 - t10326 - t3557 * t10327 * t1333 / 0.4096e4;
  t10671 = t10667 * t189 * t263 + t1344 * t1659 * t3581 + t10467 * t10247 + 0.2e1 * t3650 * t10254 + t3650 * t10264 + t1329 * t10269 + 0.2e1 * t10615 * t3525 + t1453 * t9410 + t1453 * t9549 + 0.2e1 * t3583 * t9234 + 0.2e1 * t3583 * t9237 + t3695 * t3587 + 0.2e1 * t3920 * t9388 + t3920 * t9398 + t3951 * t475;
  tv4rhosigma315 = t7 * t10671 + t3921 + t3923 + t3924 + t3952;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t10705 = t2717 * t29;
  t10720 = -0.3e1 / 0.8e1 * t1103 * t3955 - t10341 - 0.3e1 / 0.8e1 * t420 * t6631 * t441 * t3954 - 0.9e1 / 0.8e1 * t420 * t2738 * t1472 * t1370 - 0.9e1 / 0.8e1 * t1103 * t3959 - t10346 - 0.9e1 / 0.8e1 * t8322 * t8323 * t3958 - 0.9e1 / 0.8e1 * t420 * t1108 * t1370 * t1484 - 0.9e1 / 0.8e1 * t420 * t1108 * t538 * t3755 - 0.3e1 / 0.8e1 * t1103 * t3973 - t10351 - 0.3e1 / 0.8e1 * t420 * t1108 * t441 * t3972 - 0.3e1 / 0.8e1 * t420 * t422 * (-t615 * t3744 / 0.48e2 + 0.7e1 / 0.3456e4 * t1575 * t3750 * t10705 * t70 - t4067 * t430 / t65 / t6695 * t6709 * t4077 / 0.20736e5);
  t10721 = my_piecewise3(t56, 0, t10720);
  t10751 = t3984 * t456;
  t10755 = t3984 * t477;
  t10759 = t458 * t3986 / 0.64e2 - t10377 - t101 * t3985 * t478 / 0.64e2 - t10382 * t10487 / 0.128e3 + t10388 + t10389 * t10491 / 0.128e3 - 0.9e1 / 0.4096e4 * t10073 * t1441 * t3792 + t10397 + 0.9e1 / 0.4096e4 * t3845 * t3498 * t3782 + 0.5e1 / 0.512e3 * t3465 * t1267 * t10751 - t10407 - 0.5e1 / 0.512e3 * t1460 * t1279 * t10755;
  t10762 = t4001 * t477;
  t10785 = -t458 * t4003 / 0.64e2 + t10417 + t1258 * t1259 * t10762 / 0.64e2 - t10105 * t10327 * t457 / 0.24576e5 + t10427 + t3908 * t10428 * t10518 / 0.24576e5 + 0.3e1 / 0.4096e4 * t3488 * t1441 * t10751 - t10437 - 0.3e1 / 0.4096e4 * t1438 * t3498 * t10755 - t1266 * t1267 * t4001 * t456 / 0.512e3 + t10447 + t1278 * t1279 * t10762 / 0.512e3;
  t10790 = t1 * t10721 + t10467 * t10355 + 0.3e1 * t10357 * t3183 + t3980 * t475 + 0.3e1 * t3650 * t10361 + 0.3e1 * t10615 * t3587 + 0.3e1 * t3583 * t9549 + 0.3e1 * t3583 * t9410 + t1329 * t10370 + t263 * (t10759 + t10785) * t189 + t4018 * t475;
  tv4rhosigma319 = t7 * t10790 + t3978 + t3981 + t3983 + t4019;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t10792 = t1397 * t1397;
  t10800 = t1409 * t1409;
  t10824 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t213 * t4114 * t10792 - 0.9e1 / 0.4e1 * t213 * t1616 * t1397 * t1409 - 0.9e1 / 0.8e1 * t213 * t594 * t10800 - 0.3e1 / 0.2e1 * t213 * t594 * t499 * t3823 - 0.3e1 / 0.8e1 * t213 * t215 * (-t1575 * t3818 * t10015 * t34 / 0.2304e4 + t4067 * sigma[0] / t37 / t1578 * t4075 * t4077 / 0.55296e5));
  t10826 = t1416 * t1416;
  t10831 = t1449 * t1449;
  t10837 = 0.1e1 / t616;
  t10847 = t1441 * t105;
  t10854 = t3861 * t1437;
  t10855 = t3835 * t99;
  t10867 = 0.1e1 / t102 / t616;
  t10874 = t3859 * t98 * t513 * M_PI;
  t10875 = t1437 * t105;
  t10876 = t10874 * t10875;
  t10879 = 0.1e1 / t131 / t3492 / t278;
  t10880 = t10879 * t4916;
  t10896 = -0.5e1 / 0.128e3 * t101 * t10837 * t108 * t192 + 0.3e1 / 0.256e3 * t514 * t3854 * t517 * t3841 - 0.13e2 / 0.8192e4 * t1436 * t3835 * t10847 - t514 * t3835 * t517 * t286 / 0.512e3 - 0.7e1 / 0.98304e5 * t10854 * t3867 * t10855 + 0.9e1 / 0.4096e4 * t3845 * t1441 * t3854 - 0.25e2 / 0.2048e4 * t514 * t1424 * t286 * t10837 + 0.5e1 / 0.128e3 * t101 * t505 * t192 * t10867 - t10876 * t10880 * t3835 * t3 / 0.393216e6 + t3863 * t3867 * t3854 * t99 / 0.32768e5 - 0.5e1 / 0.8192e4 * t1438 * t1441 * t10837 + 0.5e1 / 0.2048e4 * t514 * t518 * t286 * t10867;
  tv4sigma40 = t7 * (t10826 * t189 * t4221 + 0.3e1 * t10831 * t189 * t659 + t10896 * t189 * t263 + t1 * t10824 + 0.4e1 * t1453 * t10047 + 0.6e1 * t3883 * t3454);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  t10928 = t3861 * t1437 * t3866;
  t10936 = t544 * t3854;
  t10941 = t10874 * t10875 * t10879;
  tv4sigma42 = t7 * (t4221 * t3830 * t1297 + 0.3e1 * t3920 * t10156 + 0.3e1 * t3883 * t3525 + t659 * t3879 * t1297 + 0.3e1 * t3885 * t3525 + 0.3e1 * t1453 * t10172 + t263 * (-t101 * t3854 * t108 * t545 / 0.128e3 + 0.3e1 / 0.512e3 * t512 * t513 * t3835 * t3896 - 0.13e2 / 0.8192e4 * t1436 * t1430 * t1441 * t544 * t105 - t514 * t3904 / 0.512e3 - 0.7e1 / 0.98304e5 * t10928 * t3558 * t3868 + 0.9e1 / 0.8192e4 * t3845 * t1441 * t544 * t3835 - 0.5e1 / 0.2048e4 * t1460 * t1267 * t10936 - t10941 * t8810 * t1430 * t3 / 0.393216e6 + t3908 * t3558 * t10855 / 0.65536e5 - t1438 * t1441 * t10936 / 0.8192e4) * t189);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  t10962 = t1468 * t1468;
  t10999 = t1504 * t1430;
  t11016 = -0.13e2 / 0.8192e4 * t1436 * t1494 * t1441 * t105 * t1419 - t514 * t1494 * t517 * t1425 / 0.512e3 + t3926 * t3842 / 0.512e3 - 0.7e1 / 0.98304e5 * t10928 * t3942 * t3909 + 0.3e1 / 0.8192e4 * t3845 * t1441 * t1494 * t1430 - t101 * t3889 * t1505 / 0.384e3 + t3894 * t3990 / 0.512e3 + 0.3e1 / 0.8192e4 * t3845 * t1441 * t1504 * t1419 - 0.5e1 / 0.6144e4 * t1460 * t1267 * t10999 - t10941 * t9438 * t3 * t1419 / 0.393216e6 + t3908 * t3942 * t3868 / 0.196608e6 + t3908 * t10327 * t3909 / 0.196608e6 - t1438 * t1441 * t10999 / 0.24576e5;
  tv4sigma45 = t7 * (0.2e1 * t10962 * t189 * t659 + t11016 * t189 * t263 + t1416 * t3581 * t4221 + t1449 * t1659 * t3581 + 0.2e1 * t3583 * t10172 + 0.4e1 * t3920 * t10254 + 0.2e1 * t1453 * t10269 + t3883 * t3587 + t3885 * t3587);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  t11053 = t4001 * t506;
  tv4sigma49 = t7 * (t4221 * t523 * t10355 + 0.3e1 * t10357 * t3525 + 0.3e1 * t3920 * t10361 + 0.3e1 * t659 * t1468 * t3587 + 0.3e1 * t3583 * t10269 + t1453 * t10370 + t263 * (0.3e1 / 0.512e3 * t512 * t513 * t3984 * t3928 - 0.13e2 / 0.8192e4 * t1436 * t1504 * t1441 * t105 * t506 - t514 * t3939 / 0.512e3 - 0.7e1 / 0.98304e5 * t10928 * t10327 * t3943 + 0.9e1 / 0.8192e4 * t3845 * t1441 * t3984 * t506 - t101 * t1455 * t4002 / 0.128e3 - 0.5e1 / 0.2048e4 * t1460 * t1267 * t11053 - t10941 * t10428 * t3 * t506 / 0.393216e6 + t3908 * t2061 * t3984 * t3943 / 0.65536e5 - t1438 * t1441 * t11053 / 0.8192e4) * t189);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t11072 = t1472 * t1472;
  t11080 = t1484 * t1484;
  t11104 = my_piecewise3(t56, 0, -0.3e1 / 0.8e1 * t420 * t6631 * t11072 - 0.9e1 / 0.4e1 * t420 * t2738 * t1472 * t1484 - 0.9e1 / 0.8e1 * t420 * t1108 * t11080 - 0.3e1 / 0.2e1 * t420 * t1108 * t538 * t3972 - 0.3e1 / 0.8e1 * t420 * t422 * (-t1575 * t3967 * t10705 * t34 / 0.2304e4 + t4067 * sigma[2] / t65 / t2713 * t6709 * t4077 / 0.55296e5));
  t11106 = t1491 * t1491;
  t11111 = t1516 * t1516;
  t11117 = 0.1e1 / t1126;
  t11145 = 0.1e1 / t103 / t1126;
  t11165 = -0.5e1 / 0.128e3 * t101 * t11117 * t108 * t192 + 0.3e1 / 0.256e3 * t514 * t4001 * t517 * t3841 - 0.13e2 / 0.8192e4 * t1436 * t3984 * t10847 - t514 * t3984 * t517 * t286 / 0.512e3 - 0.7e1 / 0.98304e5 * t10854 * t3867 * t3984 * t99 + 0.9e1 / 0.4096e4 * t3845 * t1441 * t4001 - 0.25e2 / 0.2048e4 * t514 * t1424 * t286 * t11117 + 0.5e1 / 0.128e3 * t101 * t505 * t192 * t11145 - t10876 * t10880 * t3984 * t3 / 0.393216e6 + t3863 * t3867 * t4001 * t99 / 0.32768e5 - 0.5e1 / 0.8192e4 * t1438 * t1441 * t11117 + 0.5e1 / 0.2048e4 * t514 * t518 * t286 * t11145;
  tv4sigma414 = t7 * (t11106 * t189 * t4221 + 0.3e1 * t11111 * t189 * t659 + t11165 * t189 * t263 + t1 * t11104 + 0.6e1 * t10357 * t3587 + 0.4e1 * t3583 * t10370);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

