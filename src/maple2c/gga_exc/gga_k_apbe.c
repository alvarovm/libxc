/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_k_apbe.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t24, t26, t27, t28, t29, t31, t32, t34;
  double t40, t45, t49, tzk0;

  gga_k_apbe_params *params;

  assert(p->params != NULL);
  params = (gga_k_apbe_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t24 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t34 = rho[0] * rho[0];
  t40 = params->kappa + params->mu * t24 * t29 * sigma[0] * t32 / t22 / t34 / 0.24e2;
  t45 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t40);
  t49 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t20 * t22 * t45);
  tzk0 = 0.2e1 * t49;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t24, t26, t27, t28, t29, t31, t32, t34;
  double t40, t45, t49, tzk0;

  double t55, t58, t60, t61, t63, t66, t67, t71;
  double tvrho0, t79, t80, t83, tvsigma0;

  gga_k_apbe_params *params;

  assert(p->params != NULL);
  params = (gga_k_apbe_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t24 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t34 = rho[0] * rho[0];
  t40 = params->kappa + params->mu * t24 * t29 * sigma[0] * t32 / t22 / t34 / 0.24e2;
  t45 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t40);
  t49 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t20 * t22 * t45);
  tzk0 = 0.2e1 * t49;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t55 = t34 * rho[0];
  t58 = params->kappa * params->kappa;
  t60 = t7 * t20 / t55 * t58;
  t61 = t40 * t40;
  t63 = 0.1e1 / t61 * params->mu;
  t66 = t29 * sigma[0] * t32;
  t67 = t63 * t24 * t66;
  t71 = my_piecewise3(t2, 0, t7 * t20 / t21 * t45 / 0.1e2 - t60 * t67 / 0.6e2);
  tvrho0 = 0.2e1 * rho[0] * t71 + 0.2e1 * t49;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t79 = t24 * t29 * t32;
  t80 = t63 * t79;
  t83 = my_piecewise3(t2, 0, t7 * t20 / t34 * t58 * t80 / 0.16e3);
  tvsigma0 = 0.2e1 * rho[0] * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t24, t26, t27, t28, t29, t31, t32, t34;
  double t40, t45, t49, tzk0;

  double t55, t58, t60, t61, t63, t66, t67, t71;
  double tvrho0, t79, t80, t83, tvsigma0;

  double t92, t96, t99, t104, t107, t108, t109, t110;
  double t112, t113, t116, t120, tv2rho20, t125, t130, t133;
  double t137, tv2rhosigma0, t147, t150, tv2sigma20;

  gga_k_apbe_params *params;

  assert(p->params != NULL);
  params = (gga_k_apbe_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t24 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t34 = rho[0] * rho[0];
  t40 = params->kappa + params->mu * t24 * t29 * sigma[0] * t32 / t22 / t34 / 0.24e2;
  t45 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t40);
  t49 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t20 * t22 * t45);
  tzk0 = 0.2e1 * t49;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t55 = t34 * rho[0];
  t58 = params->kappa * params->kappa;
  t60 = t7 * t20 / t55 * t58;
  t61 = t40 * t40;
  t63 = 0.1e1 / t61 * params->mu;
  t66 = t29 * sigma[0] * t32;
  t67 = t63 * t24 * t66;
  t71 = my_piecewise3(t2, 0, t7 * t20 / t21 * t45 / 0.1e2 - t60 * t67 / 0.6e2);
  tvrho0 = 0.2e1 * rho[0] * t71 + 0.2e1 * t49;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t79 = t24 * t29 * t32;
  t80 = t63 * t79;
  t83 = my_piecewise3(t2, 0, t7 * t20 / t34 * t58 * t80 / 0.16e3);
  tvsigma0 = 0.2e1 * rho[0] * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t92 = t34 * t34;
  t96 = t7 * t20 / t92 * t58;
  t99 = t92 * t34;
  t104 = t7 * t20 / t22 / t99 * t58;
  t107 = params->mu * params->mu;
  t108 = 0.1e1 / t61 / t40 * t107;
  t109 = t24 * t24;
  t110 = t108 * t109;
  t112 = 0.1e1 / t27 / t26;
  t113 = sigma[0] * sigma[0];
  t116 = t110 * t112 * t113 * t31;
  t120 = my_piecewise3(t2, 0, -t7 * t20 / t21 / rho[0] * t45 / 0.3e2 + 0.7e1 / 0.18e3 * t96 * t67 - t104 * t116 / 0.135e3);
  tv2rho20 = 0.2e1 * rho[0] * t120 + 0.4e1 * t71;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t125 = t92 * rho[0];
  t130 = t7 * t20 / t22 / t125 * t58;
  t133 = t110 * t112 * t31 * sigma[0];
  t137 = my_piecewise3(t2, 0, -t60 * t80 / 0.8e2 + t130 * t133 / 0.36e3);
  tv2rhosigma0 = 0.2e1 * rho[0] * t137 + 0.2e1 * t83;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t147 = t108 * t109 * t112 * t31;
  t150 = my_piecewise3(t2, 0, -t7 * t20 / t22 / t92 * t58 * t147 / 0.96e3);
  tv2sigma20 = 0.2e1 * rho[0] * t150;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t24, t26, t27, t28, t29, t31, t32, t34;
  double t40, t45, t49, tzk0;

  double t55, t58, t60, t61, t63, t66, t67, t71;
  double tvrho0, t79, t80, t83, tvsigma0;

  double t92, t96, t99, t104, t107, t108, t109, t110;
  double t112, t113, t116, t120, tv2rho20, t125, t130, t133;
  double t137, tv2rhosigma0, t147, t150, tv2sigma20;

  double t162, t165, t170, t173, t176, t177, t178, t182;
  double t183, t184, t185, t186, t187, t189, t193, tv3rho30;
  double t205, t207, t211, tv3rho2sigma0, t217, t221, t225, tv3rhosigma20;
  double t228, t232, t236, tv3sigma30;

  gga_k_apbe_params *params;

  assert(p->params != NULL);
  params = (gga_k_apbe_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t24 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t34 = rho[0] * rho[0];
  t40 = params->kappa + params->mu * t24 * t29 * sigma[0] * t32 / t22 / t34 / 0.24e2;
  t45 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t40);
  t49 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t20 * t22 * t45);
  tzk0 = 0.2e1 * t49;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t55 = t34 * rho[0];
  t58 = params->kappa * params->kappa;
  t60 = t7 * t20 / t55 * t58;
  t61 = t40 * t40;
  t63 = 0.1e1 / t61 * params->mu;
  t66 = t29 * sigma[0] * t32;
  t67 = t63 * t24 * t66;
  t71 = my_piecewise3(t2, 0, t7 * t20 / t21 * t45 / 0.1e2 - t60 * t67 / 0.6e2);
  tvrho0 = 0.2e1 * rho[0] * t71 + 0.2e1 * t49;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t79 = t24 * t29 * t32;
  t80 = t63 * t79;
  t83 = my_piecewise3(t2, 0, t7 * t20 / t34 * t58 * t80 / 0.16e3);
  tvsigma0 = 0.2e1 * rho[0] * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t92 = t34 * t34;
  t96 = t7 * t20 / t92 * t58;
  t99 = t92 * t34;
  t104 = t7 * t20 / t22 / t99 * t58;
  t107 = params->mu * params->mu;
  t108 = 0.1e1 / t61 / t40 * t107;
  t109 = t24 * t24;
  t110 = t108 * t109;
  t112 = 0.1e1 / t27 / t26;
  t113 = sigma[0] * sigma[0];
  t116 = t110 * t112 * t113 * t31;
  t120 = my_piecewise3(t2, 0, -t7 * t20 / t21 / rho[0] * t45 / 0.3e2 + 0.7e1 / 0.18e3 * t96 * t67 - t104 * t116 / 0.135e3);
  tv2rho20 = 0.2e1 * rho[0] * t120 + 0.4e1 * t71;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t125 = t92 * rho[0];
  t130 = t7 * t20 / t22 / t125 * t58;
  t133 = t110 * t112 * t31 * sigma[0];
  t137 = my_piecewise3(t2, 0, -t60 * t80 / 0.8e2 + t130 * t133 / 0.36e3);
  tv2rhosigma0 = 0.2e1 * rho[0] * t137 + 0.2e1 * t83;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t147 = t108 * t109 * t112 * t31;
  t150 = my_piecewise3(t2, 0, -t7 * t20 / t22 / t92 * t58 * t147 / 0.96e3);
  tv2sigma20 = 0.2e1 * rho[0] * t150;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t162 = t7 * t20 / t125 * t58;
  t165 = t92 * t55;
  t170 = t7 * t20 / t22 / t165 * t58;
  t173 = t5 * t5;
  t176 = t4 / t173 / t26;
  t177 = t92 * t92;
  t178 = t177 * t34;
  t182 = t176 * t20 / t21 / t178;
  t183 = t61 * t61;
  t184 = 0.1e1 / t183;
  t185 = t58 * t184;
  t186 = t107 * params->mu;
  t187 = t113 * sigma[0];
  t189 = t185 * t186 * t187;
  t193 = my_piecewise3(t2, 0, 0.2e1 / 0.45e2 * t7 * t20 / t21 / t34 * t45 - 0.41e2 / 0.27e3 * t162 * t67 + t170 * t116 / 0.15e2 - 0.4e1 / 0.135e3 * t182 * t189);
  tv3rho30 = 0.2e1 * rho[0] * t193 + 0.6e1 * t120;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t205 = t176 * t20 / t21 / t177 / rho[0];
  t207 = t185 * t186 * t113;
  t211 = my_piecewise3(t2, 0, 0.3e1 / 0.8e2 * t96 * t80 - 0.23e2 / 0.108e4 * t104 * t133 + t205 * t207 / 0.9e2);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t211 + 0.4e1 * t137;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t217 = 0.1e1 / t21 / t177;
  t221 = t185 * t186 * sigma[0];
  t225 = my_piecewise3(t2, 0, 0.7e1 / 0.144e4 * t130 * t147 - t176 * t20 * t217 * t221 / 0.24e3);
  tv3rhosigma20 = 0.2e1 * rho[0] * t225 + 0.2e1 * t150;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t228 = t176 * t20;
  t232 = t184 * t186;
  t236 = my_piecewise3(t2, 0, t228 / t21 / t165 * t58 * t232 / 0.64e3);
  tv3sigma30 = 0.2e1 * rho[0] * t236;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t24, t26, t27, t28, t29, t31, t32, t34;
  double t40, t45, t49, tzk0;

  double t55, t58, t60, t61, t63, t66, t67, t71;
  double tvrho0, t79, t80, t83, tvsigma0;

  double t92, t96, t99, t104, t107, t108, t109, t110;
  double t112, t113, t116, t120, tv2rho20, t125, t130, t133;
  double t137, tv2rhosigma0, t147, t150, tv2sigma20;

  double t162, t165, t170, t173, t176, t177, t178, t182;
  double t183, t184, t185, t186, t187, t189, t193, tv3rho30;
  double t205, t207, t211, tv3rho2sigma0, t217, t221, t225, tv3rhosigma20;
  double t228, t232, t236, tv3sigma30;

  double t258, t272, t273, t274, t280, tv4rho40, t300, tv4rho3sigma0;
  double t318, tv4rho2sigma20, t334, tv4rhosigma30, t344, tv4sigma40;

  gga_k_apbe_params *params;

  assert(p->params != NULL);
  params = (gga_k_apbe_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t24 = M_CBRT6;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t28 = t27 * t27;
  t29 = 0.1e1 / t28;
  t31 = M_CBRT2;
  t32 = t31 * t31;
  t34 = rho[0] * rho[0];
  t40 = params->kappa + params->mu * t24 * t29 * sigma[0] * t32 / t22 / t34 / 0.24e2;
  t45 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t40);
  t49 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t20 * t22 * t45);
  tzk0 = 0.2e1 * t49;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t55 = t34 * rho[0];
  t58 = params->kappa * params->kappa;
  t60 = t7 * t20 / t55 * t58;
  t61 = t40 * t40;
  t63 = 0.1e1 / t61 * params->mu;
  t66 = t29 * sigma[0] * t32;
  t67 = t63 * t24 * t66;
  t71 = my_piecewise3(t2, 0, t7 * t20 / t21 * t45 / 0.1e2 - t60 * t67 / 0.6e2);
  tvrho0 = 0.2e1 * rho[0] * t71 + 0.2e1 * t49;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t79 = t24 * t29 * t32;
  t80 = t63 * t79;
  t83 = my_piecewise3(t2, 0, t7 * t20 / t34 * t58 * t80 / 0.16e3);
  tvsigma0 = 0.2e1 * rho[0] * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t92 = t34 * t34;
  t96 = t7 * t20 / t92 * t58;
  t99 = t92 * t34;
  t104 = t7 * t20 / t22 / t99 * t58;
  t107 = params->mu * params->mu;
  t108 = 0.1e1 / t61 / t40 * t107;
  t109 = t24 * t24;
  t110 = t108 * t109;
  t112 = 0.1e1 / t27 / t26;
  t113 = sigma[0] * sigma[0];
  t116 = t110 * t112 * t113 * t31;
  t120 = my_piecewise3(t2, 0, -t7 * t20 / t21 / rho[0] * t45 / 0.3e2 + 0.7e1 / 0.18e3 * t96 * t67 - t104 * t116 / 0.135e3);
  tv2rho20 = 0.2e1 * rho[0] * t120 + 0.4e1 * t71;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t125 = t92 * rho[0];
  t130 = t7 * t20 / t22 / t125 * t58;
  t133 = t110 * t112 * t31 * sigma[0];
  t137 = my_piecewise3(t2, 0, -t60 * t80 / 0.8e2 + t130 * t133 / 0.36e3);
  tv2rhosigma0 = 0.2e1 * rho[0] * t137 + 0.2e1 * t83;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t147 = t108 * t109 * t112 * t31;
  t150 = my_piecewise3(t2, 0, -t7 * t20 / t22 / t92 * t58 * t147 / 0.96e3);
  tv2sigma20 = 0.2e1 * rho[0] * t150;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t162 = t7 * t20 / t125 * t58;
  t165 = t92 * t55;
  t170 = t7 * t20 / t22 / t165 * t58;
  t173 = t5 * t5;
  t176 = t4 / t173 / t26;
  t177 = t92 * t92;
  t178 = t177 * t34;
  t182 = t176 * t20 / t21 / t178;
  t183 = t61 * t61;
  t184 = 0.1e1 / t183;
  t185 = t58 * t184;
  t186 = t107 * params->mu;
  t187 = t113 * sigma[0];
  t189 = t185 * t186 * t187;
  t193 = my_piecewise3(t2, 0, 0.2e1 / 0.45e2 * t7 * t20 / t21 / t34 * t45 - 0.41e2 / 0.27e3 * t162 * t67 + t170 * t116 / 0.15e2 - 0.4e1 / 0.135e3 * t182 * t189);
  tv3rho30 = 0.2e1 * rho[0] * t193 + 0.6e1 * t120;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t205 = t176 * t20 / t21 / t177 / rho[0];
  t207 = t185 * t186 * t113;
  t211 = my_piecewise3(t2, 0, 0.3e1 / 0.8e2 * t96 * t80 - 0.23e2 / 0.108e4 * t104 * t133 + t205 * t207 / 0.9e2);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t211 + 0.4e1 * t137;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t217 = 0.1e1 / t21 / t177;
  t221 = t185 * t186 * sigma[0];
  t225 = my_piecewise3(t2, 0, 0.7e1 / 0.144e4 * t130 * t147 - t176 * t20 * t217 * t221 / 0.24e3);
  tv3rhosigma20 = 0.2e1 * rho[0] * t225 + 0.2e1 * t150;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t228 = t176 * t20;
  t232 = t184 * t186;
  t236 = my_piecewise3(t2, 0, t228 / t21 / t165 * t58 * t232 / 0.64e3);
  tv3sigma30 = 0.2e1 * rho[0] * t236;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t258 = t177 * t55;
  t272 = t107 * t107;
  t273 = 0.1e1 / t183 / t40 * t272;
  t274 = t113 * t113;
  t280 = my_piecewise3(t2, 0, -0.14e2 / 0.135e3 * t7 * t20 / t21 / t55 * t45 + 0.611e3 / 0.81e3 * t7 * t20 / t99 * t58 * t67 - 0.703e3 / 0.1215e4 * t7 * t20 / t22 / t177 * t58 * t116 + 0.232e3 / 0.405e3 * t176 * t20 / t21 / t258 * t189 - 0.16e2 / 0.1215e4 * t176 * t20 / t177 / t99 * t58 * t273 * t274 * t79);
  tv4rho40 = 0.2e1 * rho[0] * t280 + 0.8e1 * t193;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t300 = my_piecewise3(t2, 0, -0.3e1 / 0.2e2 * t162 * t80 + 0.257e3 / 0.162e4 * t170 * t133 - 0.17e2 / 0.9e2 * t182 * t207 + 0.2e1 / 0.405e3 * t176 * t20 / t177 / t125 * t58 * t273 * t187 * t79);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t300 + 0.6e1 * t211;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t318 = my_piecewise3(t2, 0, -0.119e3 / 0.432e4 * t104 * t147 + 0.13e2 / 0.24e3 * t205 * t221 - t176 * t20 / t177 / t92 * t58 * t273 * t113 * t79 / 0.54e3);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t318 + 0.4e1 * t225;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t334 = my_piecewise3(t2, 0, -0.11e2 / 0.96e3 * t228 * t217 * t58 * t232 + t176 * t20 / t258 * t58 * t273 * t24 * t66 / 0.144e4);
  tv4rhosigma30 = 0.2e1 * rho[0] * t334 + 0.2e1 * t236;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t344 = my_piecewise3(t2, 0, -t176 * t20 / t178 * t58 * t273 * t79 / 0.384e4);
  tv4sigma40 = 0.2e1 * rho[0] * t344;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t40, t41, t43, t47, t52, t56, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66;
  double t67, t68, t69, t71, t75, t80, t84, tzk0;

  gga_k_apbe_params *params;

  assert(p->params != NULL);
  params = (gga_k_apbe_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = params->mu * t32;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t37 = 0.1e1 / t36;
  t38 = t37 * sigma[0];
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t47 = params->kappa + t33 * t38 * t43 / 0.24e2;
  t52 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t47);
  t56 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t15, t12, t11, t16, -t18);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t62 = t61 * t61;
  t64 = my_piecewise3(t60, t24, t62 * t59);
  t65 = t64 * t30;
  t66 = t37 * sigma[2];
  t67 = rho[1] * rho[1];
  t68 = POW_1_3(rho[1]);
  t69 = t68 * t68;
  t71 = 0.1e1 / t69 / t67;
  t75 = params->kappa + t33 * t66 * t71 / 0.24e2;
  t80 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t75);
  t84 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t65 * t80);
  tzk0 = t56 + t84;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t40, t41, t43, t47, t52, t56, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66;
  double t67, t68, t69, t71, t75, t80, t84, tzk0;

  double t85, t86, t87, t88, t89, t92, t93, t97;
  double t98, t101, t102, t103, t104, t105, t107, t108;
  double t109, t111, t113, t117, t119, t122, t123, t127;
  double t130, t132, tvrho0, t135, t136, t139, t140, t145;
  double t147, t150, t151, t155, t156, t157, t159, t160;
  double t161, t163, t165, t169, tvrho1, t172, t174, t177;
  double tvsigma0, tvsigma1, t179, t182, tvsigma2;

  gga_k_apbe_params *params;

  assert(p->params != NULL);
  params = (gga_k_apbe_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = params->mu * t32;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t37 = 0.1e1 / t36;
  t38 = t37 * sigma[0];
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t47 = params->kappa + t33 * t38 * t43 / 0.24e2;
  t52 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t47);
  t56 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t15, t12, t11, t16, -t18);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t62 = t61 * t61;
  t64 = my_piecewise3(t60, t24, t62 * t59);
  t65 = t64 * t30;
  t66 = t37 * sigma[2];
  t67 = rho[1] * rho[1];
  t68 = POW_1_3(rho[1]);
  t69 = t68 * t68;
  t71 = 0.1e1 / t69 / t67;
  t75 = params->kappa + t33 * t66 * t71 / 0.24e2;
  t80 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t75);
  t84 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t65 * t80);
  tzk0 = t56 + t84;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t85 = t7 * t7;
  t86 = 0.1e1 / t85;
  t87 = t17 * t86;
  t88 = t8 - t87;
  t89 = my_piecewise5(t11, 0, t15, 0, t88);
  t92 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t89);
  t93 = t92 * t30;
  t97 = 0.1e1 / t29;
  t98 = t28 * t97;
  t101 = t6 * t98 * t52 / 0.1e2;
  t102 = params->kappa * params->kappa;
  t103 = t31 * t102;
  t104 = t6 * t103;
  t105 = t47 * t47;
  t107 = 0.1e1 / t105 * params->mu;
  t108 = t107 * t32;
  t109 = t39 * rho[0];
  t111 = 0.1e1 / t41 / t109;
  t113 = t108 * t38 * t111;
  t117 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t93 * t52 + t101 - t104 * t113 / 0.6e2);
  t119 = my_piecewise5(t15, 0, t11, 0, -t88);
  t122 = my_piecewise3(t60, 0, 0.5e1 / 0.3e1 * t62 * t119);
  t123 = t122 * t30;
  t127 = t64 * t97;
  t130 = t6 * t127 * t80 / 0.1e2;
  t132 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t123 * t80 + t130);
  tvrho0 = t56 + t84 + t7 * (t117 + t132);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t135 = -t8 - t87;
  t136 = my_piecewise5(t11, 0, t15, 0, t135);
  t139 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t136);
  t140 = t139 * t30;
  t145 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t140 * t52 + t101);
  t147 = my_piecewise5(t15, 0, t11, 0, -t135);
  t150 = my_piecewise3(t60, 0, 0.5e1 / 0.3e1 * t62 * t147);
  t151 = t150 * t30;
  t155 = t65 * t102;
  t156 = t6 * t155;
  t157 = t75 * t75;
  t159 = 0.1e1 / t157 * params->mu;
  t160 = t159 * t32;
  t161 = t67 * rho[1];
  t163 = 0.1e1 / t69 / t161;
  t165 = t160 * t66 * t163;
  t169 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t151 * t80 + t130 - t156 * t165 / 0.6e2);
  tvrho1 = t56 + t84 + t7 * (t145 + t169);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t172 = t32 * t37;
  t174 = t107 * t172 * t43;
  t177 = my_piecewise3(t1, 0, t104 * t174 / 0.16e3);
  tvsigma0 = t7 * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t179 = t159 * t172 * t71;
  t182 = my_piecewise3(t57, 0, t156 * t179 / 0.16e3);
  tvsigma2 = t7 * t182;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t40, t41, t43, t47, t52, t56, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66;
  double t67, t68, t69, t71, t75, t80, t84, tzk0;

  double t85, t86, t87, t88, t89, t92, t93, t97;
  double t98, t101, t102, t103, t104, t105, t107, t108;
  double t109, t111, t113, t117, t119, t122, t123, t127;
  double t130, t132, tvrho0, t135, t136, t139, t140, t145;
  double t147, t150, t151, t155, t156, t157, t159, t160;
  double t161, t163, t165, t169, tvrho1, t172, t174, t177;
  double tvsigma0, tvsigma1, t179, t182, tvsigma2;

  double t185, t186, t189, t190, t191, t193, t194, t198;
  double t199, t203, t205, t208, t212, t213, t216, t218;
  double t219, t223, t224, t225, t226, t228, t229, t230;
  double t231, t234, t236, t240, t242, t246, t247, t248;
  double t252, t256, t257, t261, t263, t265, t268, t270;
  double tv2rho20, t273, t276, t277, t281, t282, t286, t288;
  double t291, t297, t298, t301, t305, t306, t310, t312;
  double t316, t320, t321, t324, tv2rho21, t329, t333, t334;
  double t338, t339, t345, t346, t350, t354, t355, t361;
  double t367, t368, t369, t370, t371, t374, t376, t380;
  double t382, t386, tv2rho22, t392, t393, t395, t398, t402;
  double t406, tv2rhosigma0, tv2rhosigma1, t411, t413, tv2rhosigma2, t418, tv2rhosigma3;
  double tv2rhosigma4, t422, t424, t427, t431, t435, tv2rhosigma5, t437;
  double t438, t442, t445, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t446, t450, t453, tv2sigma25;

  gga_k_apbe_params *params;

  assert(p->params != NULL);
  params = (gga_k_apbe_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = params->mu * t32;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t37 = 0.1e1 / t36;
  t38 = t37 * sigma[0];
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t47 = params->kappa + t33 * t38 * t43 / 0.24e2;
  t52 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t47);
  t56 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t15, t12, t11, t16, -t18);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t62 = t61 * t61;
  t64 = my_piecewise3(t60, t24, t62 * t59);
  t65 = t64 * t30;
  t66 = t37 * sigma[2];
  t67 = rho[1] * rho[1];
  t68 = POW_1_3(rho[1]);
  t69 = t68 * t68;
  t71 = 0.1e1 / t69 / t67;
  t75 = params->kappa + t33 * t66 * t71 / 0.24e2;
  t80 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t75);
  t84 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t65 * t80);
  tzk0 = t56 + t84;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t85 = t7 * t7;
  t86 = 0.1e1 / t85;
  t87 = t17 * t86;
  t88 = t8 - t87;
  t89 = my_piecewise5(t11, 0, t15, 0, t88);
  t92 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t89);
  t93 = t92 * t30;
  t97 = 0.1e1 / t29;
  t98 = t28 * t97;
  t101 = t6 * t98 * t52 / 0.1e2;
  t102 = params->kappa * params->kappa;
  t103 = t31 * t102;
  t104 = t6 * t103;
  t105 = t47 * t47;
  t107 = 0.1e1 / t105 * params->mu;
  t108 = t107 * t32;
  t109 = t39 * rho[0];
  t111 = 0.1e1 / t41 / t109;
  t113 = t108 * t38 * t111;
  t117 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t93 * t52 + t101 - t104 * t113 / 0.6e2);
  t119 = my_piecewise5(t15, 0, t11, 0, -t88);
  t122 = my_piecewise3(t60, 0, 0.5e1 / 0.3e1 * t62 * t119);
  t123 = t122 * t30;
  t127 = t64 * t97;
  t130 = t6 * t127 * t80 / 0.1e2;
  t132 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t123 * t80 + t130);
  tvrho0 = t56 + t84 + t7 * (t117 + t132);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t135 = -t8 - t87;
  t136 = my_piecewise5(t11, 0, t15, 0, t135);
  t139 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t136);
  t140 = t139 * t30;
  t145 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t140 * t52 + t101);
  t147 = my_piecewise5(t15, 0, t11, 0, -t135);
  t150 = my_piecewise3(t60, 0, 0.5e1 / 0.3e1 * t62 * t147);
  t151 = t150 * t30;
  t155 = t65 * t102;
  t156 = t6 * t155;
  t157 = t75 * t75;
  t159 = 0.1e1 / t157 * params->mu;
  t160 = t159 * t32;
  t161 = t67 * rho[1];
  t163 = 0.1e1 / t69 / t161;
  t165 = t160 * t66 * t163;
  t169 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t151 * t80 + t130 - t156 * t165 / 0.6e2);
  tvrho1 = t56 + t84 + t7 * (t145 + t169);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t172 = t32 * t37;
  t174 = t107 * t172 * t43;
  t177 = my_piecewise3(t1, 0, t104 * t174 / 0.16e3);
  tvsigma0 = t7 * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t179 = t159 * t172 * t71;
  t182 = my_piecewise3(t57, 0, t156 * t179 / 0.16e3);
  tvsigma2 = t7 * t182;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t185 = 0.1e1 / t25;
  t186 = t89 * t89;
  t189 = t85 * t7;
  t190 = 0.1e1 / t189;
  t191 = t17 * t190;
  t193 = -0.2e1 * t86 + 0.2e1 * t191;
  t194 = my_piecewise5(t11, 0, t15, 0, t193);
  t198 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t185 * t186 + 0.5e1 / 0.3e1 * t26 * t194);
  t199 = t198 * t30;
  t203 = t92 * t97;
  t205 = t6 * t203 * t52;
  t208 = t6 * t93 * t102;
  t212 = 0.1e1 / t29 / t7;
  t213 = t28 * t212;
  t216 = t6 * t213 * t52 / 0.3e2;
  t218 = t6 * t98 * t102;
  t219 = t218 * t113;
  t223 = params->mu * params->mu;
  t224 = 0.1e1 / t105 / t47 * t223;
  t225 = t32 * t32;
  t226 = t224 * t225;
  t228 = 0.1e1 / t35 / t34;
  t229 = sigma[0] * sigma[0];
  t230 = t228 * t229;
  t231 = t39 * t39;
  t234 = 0.1e1 / t40 / t231 / t109;
  t236 = t226 * t230 * t234;
  t240 = 0.1e1 / t41 / t231;
  t242 = t108 * t38 * t240;
  t246 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t199 * t52 + t205 / 0.5e1 - t208 * t113 / 0.3e2 - t216 - t219 / 0.45e2 - t104 * t236 / 0.27e3 + 0.11e2 / 0.18e3 * t104 * t242);
  t247 = 0.1e1 / t61;
  t248 = t119 * t119;
  t252 = my_piecewise5(t15, 0, t11, 0, -t193);
  t256 = my_piecewise3(t60, 0, 0.1e2 / 0.9e1 * t247 * t248 + 0.5e1 / 0.3e1 * t62 * t252);
  t257 = t256 * t30;
  t261 = t122 * t97;
  t263 = t6 * t261 * t80;
  t265 = t64 * t212;
  t268 = t6 * t265 * t80 / 0.3e2;
  t270 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t257 * t80 + t263 / 0.5e1 - t268);
  tv2rho20 = 0.2e1 * t117 + 0.2e1 * t132 + t7 * (t246 + t270);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t273 = t185 * t136;
  t276 = 0.2e1 * t191;
  t277 = my_piecewise5(t11, 0, t15, 0, t276);
  t281 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t273 * t89 + 0.5e1 / 0.3e1 * t26 * t277);
  t282 = t281 * t30;
  t286 = t139 * t97;
  t288 = t6 * t286 * t52;
  t291 = t6 * t140 * t102;
  t297 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t282 * t52 + t288 / 0.1e2 - t291 * t113 / 0.6e2 + t205 / 0.1e2 - t216 - t219 / 0.9e2);
  t298 = t247 * t147;
  t301 = my_piecewise5(t15, 0, t11, 0, -t276);
  t305 = my_piecewise3(t60, 0, 0.1e2 / 0.9e1 * t298 * t119 + 0.5e1 / 0.3e1 * t62 * t301);
  t306 = t305 * t30;
  t310 = t150 * t97;
  t312 = t6 * t310 * t80;
  t316 = t6 * t123 * t102;
  t320 = t6 * t127 * t102;
  t321 = t320 * t165;
  t324 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t306 * t80 + t312 / 0.1e2 + t263 / 0.1e2 - t268 - t316 * t165 / 0.6e2 - t321 / 0.9e2);
  tv2rho21 = t117 + t132 + t145 + t169 + t7 * (t297 + t324);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t329 = t136 * t136;
  t333 = 0.2e1 * t86 + 0.2e1 * t191;
  t334 = my_piecewise5(t11, 0, t15, 0, t333);
  t338 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t185 * t329 + 0.5e1 / 0.3e1 * t26 * t334);
  t339 = t338 * t30;
  t345 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t339 * t52 + t288 / 0.5e1 - t216);
  t346 = t147 * t147;
  t350 = my_piecewise5(t15, 0, t11, 0, -t333);
  t354 = my_piecewise3(t60, 0, 0.1e2 / 0.9e1 * t247 * t346 + 0.5e1 / 0.3e1 * t62 * t350);
  t355 = t354 * t30;
  t361 = t6 * t151 * t102;
  t367 = 0.1e1 / t157 / t75 * t223;
  t368 = t367 * t225;
  t369 = sigma[2] * sigma[2];
  t370 = t228 * t369;
  t371 = t67 * t67;
  t374 = 0.1e1 / t68 / t371 / t161;
  t376 = t368 * t370 * t374;
  t380 = 0.1e1 / t69 / t371;
  t382 = t160 * t66 * t380;
  t386 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t355 * t80 + t312 / 0.5e1 - t361 * t165 / 0.3e2 - t268 - t321 / 0.45e2 - t156 * t376 / 0.27e3 + 0.11e2 / 0.18e3 * t156 * t382);
  tv2rho22 = 0.2e1 * t145 + 0.2e1 * t169 + t7 * (t345 + t386);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t392 = t218 * t174 / 0.24e3;
  t393 = t231 * t39;
  t395 = 0.1e1 / t40 / t393;
  t398 = t226 * t228 * t395 * sigma[0];
  t402 = t107 * t172 * t111;
  t406 = my_piecewise3(t1, 0, t208 * t174 / 0.16e3 + t392 + t104 * t398 / 0.72e3 - t104 * t402 / 0.6e2);
  tv2rhosigma0 = t7 * t406 + t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t411 = t320 * t179 / 0.24e3;
  t413 = my_piecewise3(t57, 0, t316 * t179 / 0.16e3 + t411);
  tv2rhosigma2 = t7 * t413 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t418 = my_piecewise3(t1, 0, t291 * t174 / 0.16e3 + t392);
  tv2rhosigma3 = t7 * t418 + t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t422 = t371 * t67;
  t424 = 0.1e1 / t68 / t422;
  t427 = t368 * t228 * t424 * sigma[2];
  t431 = t159 * t172 * t163;
  t435 = my_piecewise3(t57, 0, t361 * t179 / 0.16e3 + t411 + t156 * t427 / 0.72e3 - t156 * t431 / 0.6e2);
  tv2rhosigma5 = t7 * t435 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t437 = t225 * t228;
  t438 = t231 * rho[0];
  t442 = t224 * t437 / t40 / t438;
  t445 = my_piecewise3(t1, 0, -t104 * t442 / 0.192e4);
  tv2sigma20 = t7 * t445;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t446 = t371 * rho[1];
  t450 = t367 * t437 / t68 / t446;
  t453 = my_piecewise3(t57, 0, -t156 * t450 / 0.192e4);
  tv2sigma25 = t7 * t453;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t40, t41, t43, t47, t52, t56, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66;
  double t67, t68, t69, t71, t75, t80, t84, tzk0;

  double t85, t86, t87, t88, t89, t92, t93, t97;
  double t98, t101, t102, t103, t104, t105, t107, t108;
  double t109, t111, t113, t117, t119, t122, t123, t127;
  double t130, t132, tvrho0, t135, t136, t139, t140, t145;
  double t147, t150, t151, t155, t156, t157, t159, t160;
  double t161, t163, t165, t169, tvrho1, t172, t174, t177;
  double tvsigma0, tvsigma1, t179, t182, tvsigma2;

  double t185, t186, t189, t190, t191, t193, t194, t198;
  double t199, t203, t205, t208, t212, t213, t216, t218;
  double t219, t223, t224, t225, t226, t228, t229, t230;
  double t231, t234, t236, t240, t242, t246, t247, t248;
  double t252, t256, t257, t261, t263, t265, t268, t270;
  double tv2rho20, t273, t276, t277, t281, t282, t286, t288;
  double t291, t297, t298, t301, t305, t306, t310, t312;
  double t316, t320, t321, t324, tv2rho21, t329, t333, t334;
  double t338, t339, t345, t346, t350, t354, t355, t361;
  double t367, t368, t369, t370, t371, t374, t376, t380;
  double t382, t386, tv2rho22, t392, t393, t395, t398, t402;
  double t406, tv2rhosigma0, tv2rhosigma1, t411, t413, tv2rhosigma2, t418, tv2rhosigma3;
  double tv2rhosigma4, t422, t424, t427, t431, t435, tv2rhosigma5, t437;
  double t438, t442, t445, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t446, t450, t453, tv2sigma25;

  double t456, t459, t460, t461, t463, t464, t465, t466;
  double t467, t468, t469, t471, t475, t477, t482, t485;
  double t487, t491, t492, t495, t498, t499, t500, t502;
  double t503, t507, t508, t515, t516, t518, t521, t525;
  double t526, t528, t530, t532, t534, t537, t538, t541;
  double t542, t543, t545, t546, t549, t553, t557, t558;
  double t562, t564, t566, t568, t570, t573, t575, tv3rho30;
  double t578, t579, t580, t583, t588, t589, t590, t591;
  double t595, t596, t600, t603, t605, t608, t610, t613;
  double t615, t626, t627, t628, t631, t637, t641, t642;
  double t646, t649, t650, t652, t657, t661, t663, t665;
  double t666, t669, tv3rho31, t672, t677, t680, t681, t685;
  double t686, t690, t692, t695, t702, t703, t708, t712;
  double t716, t717, t721, t723, t727, t731, t732, t738;
  double t742, t744, t745, tv3rho32, t750, t756, t757, t761;
  double t762, t769, t770, t771, t773, t774, t775, t776;
  double t777, t778, t780, t784, t786, t790, t792, t801;
  double t807, t811, t812, t819, t824, t825, tv3rho33, t831;
  double t838, t839, t841, t843, t845, t847, t852, t856;
  double t860, tv3rho2sigma0, tv3rho2sigma1, t865, t868, t870, tv3rho2sigma2, t874;
  double t884, tv3rho2sigma3, tv3rho2sigma4, t888, t893, t897, t900, tv3rho2sigma5;
  double t907, tv3rho2sigma6, tv3rho2sigma7, t919, t921, t923, t928, t932;
  double t936, tv3rho2sigma8, t941, t942, t944, t946, t950, t954;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t959, t961, tv3rhosigma25;
  double t966, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t970, t972;
  double t974, t978, t982, tv3rhosigma211, t986, t989, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t992;
  double t995, tv3sigma39;

  gga_k_apbe_params *params;

  assert(p->params != NULL);
  params = (gga_k_apbe_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = params->mu * t32;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t37 = 0.1e1 / t36;
  t38 = t37 * sigma[0];
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t47 = params->kappa + t33 * t38 * t43 / 0.24e2;
  t52 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t47);
  t56 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t15, t12, t11, t16, -t18);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t62 = t61 * t61;
  t64 = my_piecewise3(t60, t24, t62 * t59);
  t65 = t64 * t30;
  t66 = t37 * sigma[2];
  t67 = rho[1] * rho[1];
  t68 = POW_1_3(rho[1]);
  t69 = t68 * t68;
  t71 = 0.1e1 / t69 / t67;
  t75 = params->kappa + t33 * t66 * t71 / 0.24e2;
  t80 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t75);
  t84 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t65 * t80);
  tzk0 = t56 + t84;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t85 = t7 * t7;
  t86 = 0.1e1 / t85;
  t87 = t17 * t86;
  t88 = t8 - t87;
  t89 = my_piecewise5(t11, 0, t15, 0, t88);
  t92 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t89);
  t93 = t92 * t30;
  t97 = 0.1e1 / t29;
  t98 = t28 * t97;
  t101 = t6 * t98 * t52 / 0.1e2;
  t102 = params->kappa * params->kappa;
  t103 = t31 * t102;
  t104 = t6 * t103;
  t105 = t47 * t47;
  t107 = 0.1e1 / t105 * params->mu;
  t108 = t107 * t32;
  t109 = t39 * rho[0];
  t111 = 0.1e1 / t41 / t109;
  t113 = t108 * t38 * t111;
  t117 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t93 * t52 + t101 - t104 * t113 / 0.6e2);
  t119 = my_piecewise5(t15, 0, t11, 0, -t88);
  t122 = my_piecewise3(t60, 0, 0.5e1 / 0.3e1 * t62 * t119);
  t123 = t122 * t30;
  t127 = t64 * t97;
  t130 = t6 * t127 * t80 / 0.1e2;
  t132 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t123 * t80 + t130);
  tvrho0 = t56 + t84 + t7 * (t117 + t132);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t135 = -t8 - t87;
  t136 = my_piecewise5(t11, 0, t15, 0, t135);
  t139 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t136);
  t140 = t139 * t30;
  t145 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t140 * t52 + t101);
  t147 = my_piecewise5(t15, 0, t11, 0, -t135);
  t150 = my_piecewise3(t60, 0, 0.5e1 / 0.3e1 * t62 * t147);
  t151 = t150 * t30;
  t155 = t65 * t102;
  t156 = t6 * t155;
  t157 = t75 * t75;
  t159 = 0.1e1 / t157 * params->mu;
  t160 = t159 * t32;
  t161 = t67 * rho[1];
  t163 = 0.1e1 / t69 / t161;
  t165 = t160 * t66 * t163;
  t169 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t151 * t80 + t130 - t156 * t165 / 0.6e2);
  tvrho1 = t56 + t84 + t7 * (t145 + t169);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t172 = t32 * t37;
  t174 = t107 * t172 * t43;
  t177 = my_piecewise3(t1, 0, t104 * t174 / 0.16e3);
  tvsigma0 = t7 * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t179 = t159 * t172 * t71;
  t182 = my_piecewise3(t57, 0, t156 * t179 / 0.16e3);
  tvsigma2 = t7 * t182;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t185 = 0.1e1 / t25;
  t186 = t89 * t89;
  t189 = t85 * t7;
  t190 = 0.1e1 / t189;
  t191 = t17 * t190;
  t193 = -0.2e1 * t86 + 0.2e1 * t191;
  t194 = my_piecewise5(t11, 0, t15, 0, t193);
  t198 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t185 * t186 + 0.5e1 / 0.3e1 * t26 * t194);
  t199 = t198 * t30;
  t203 = t92 * t97;
  t205 = t6 * t203 * t52;
  t208 = t6 * t93 * t102;
  t212 = 0.1e1 / t29 / t7;
  t213 = t28 * t212;
  t216 = t6 * t213 * t52 / 0.3e2;
  t218 = t6 * t98 * t102;
  t219 = t218 * t113;
  t223 = params->mu * params->mu;
  t224 = 0.1e1 / t105 / t47 * t223;
  t225 = t32 * t32;
  t226 = t224 * t225;
  t228 = 0.1e1 / t35 / t34;
  t229 = sigma[0] * sigma[0];
  t230 = t228 * t229;
  t231 = t39 * t39;
  t234 = 0.1e1 / t40 / t231 / t109;
  t236 = t226 * t230 * t234;
  t240 = 0.1e1 / t41 / t231;
  t242 = t108 * t38 * t240;
  t246 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t199 * t52 + t205 / 0.5e1 - t208 * t113 / 0.3e2 - t216 - t219 / 0.45e2 - t104 * t236 / 0.27e3 + 0.11e2 / 0.18e3 * t104 * t242);
  t247 = 0.1e1 / t61;
  t248 = t119 * t119;
  t252 = my_piecewise5(t15, 0, t11, 0, -t193);
  t256 = my_piecewise3(t60, 0, 0.1e2 / 0.9e1 * t247 * t248 + 0.5e1 / 0.3e1 * t62 * t252);
  t257 = t256 * t30;
  t261 = t122 * t97;
  t263 = t6 * t261 * t80;
  t265 = t64 * t212;
  t268 = t6 * t265 * t80 / 0.3e2;
  t270 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t257 * t80 + t263 / 0.5e1 - t268);
  tv2rho20 = 0.2e1 * t117 + 0.2e1 * t132 + t7 * (t246 + t270);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t273 = t185 * t136;
  t276 = 0.2e1 * t191;
  t277 = my_piecewise5(t11, 0, t15, 0, t276);
  t281 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t273 * t89 + 0.5e1 / 0.3e1 * t26 * t277);
  t282 = t281 * t30;
  t286 = t139 * t97;
  t288 = t6 * t286 * t52;
  t291 = t6 * t140 * t102;
  t297 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t282 * t52 + t288 / 0.1e2 - t291 * t113 / 0.6e2 + t205 / 0.1e2 - t216 - t219 / 0.9e2);
  t298 = t247 * t147;
  t301 = my_piecewise5(t15, 0, t11, 0, -t276);
  t305 = my_piecewise3(t60, 0, 0.1e2 / 0.9e1 * t298 * t119 + 0.5e1 / 0.3e1 * t62 * t301);
  t306 = t305 * t30;
  t310 = t150 * t97;
  t312 = t6 * t310 * t80;
  t316 = t6 * t123 * t102;
  t320 = t6 * t127 * t102;
  t321 = t320 * t165;
  t324 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t306 * t80 + t312 / 0.1e2 + t263 / 0.1e2 - t268 - t316 * t165 / 0.6e2 - t321 / 0.9e2);
  tv2rho21 = t117 + t132 + t145 + t169 + t7 * (t297 + t324);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t329 = t136 * t136;
  t333 = 0.2e1 * t86 + 0.2e1 * t191;
  t334 = my_piecewise5(t11, 0, t15, 0, t333);
  t338 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t185 * t329 + 0.5e1 / 0.3e1 * t26 * t334);
  t339 = t338 * t30;
  t345 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t339 * t52 + t288 / 0.5e1 - t216);
  t346 = t147 * t147;
  t350 = my_piecewise5(t15, 0, t11, 0, -t333);
  t354 = my_piecewise3(t60, 0, 0.1e2 / 0.9e1 * t247 * t346 + 0.5e1 / 0.3e1 * t62 * t350);
  t355 = t354 * t30;
  t361 = t6 * t151 * t102;
  t367 = 0.1e1 / t157 / t75 * t223;
  t368 = t367 * t225;
  t369 = sigma[2] * sigma[2];
  t370 = t228 * t369;
  t371 = t67 * t67;
  t374 = 0.1e1 / t68 / t371 / t161;
  t376 = t368 * t370 * t374;
  t380 = 0.1e1 / t69 / t371;
  t382 = t160 * t66 * t380;
  t386 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t355 * t80 + t312 / 0.5e1 - t361 * t165 / 0.3e2 - t268 - t321 / 0.45e2 - t156 * t376 / 0.27e3 + 0.11e2 / 0.18e3 * t156 * t382);
  tv2rho22 = 0.2e1 * t145 + 0.2e1 * t169 + t7 * (t345 + t386);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t392 = t218 * t174 / 0.24e3;
  t393 = t231 * t39;
  t395 = 0.1e1 / t40 / t393;
  t398 = t226 * t228 * t395 * sigma[0];
  t402 = t107 * t172 * t111;
  t406 = my_piecewise3(t1, 0, t208 * t174 / 0.16e3 + t392 + t104 * t398 / 0.72e3 - t104 * t402 / 0.6e2);
  tv2rhosigma0 = t7 * t406 + t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t411 = t320 * t179 / 0.24e3;
  t413 = my_piecewise3(t57, 0, t316 * t179 / 0.16e3 + t411);
  tv2rhosigma2 = t7 * t413 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t418 = my_piecewise3(t1, 0, t291 * t174 / 0.16e3 + t392);
  tv2rhosigma3 = t7 * t418 + t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t422 = t371 * t67;
  t424 = 0.1e1 / t68 / t422;
  t427 = t368 * t228 * t424 * sigma[2];
  t431 = t159 * t172 * t163;
  t435 = my_piecewise3(t57, 0, t361 * t179 / 0.16e3 + t411 + t156 * t427 / 0.72e3 - t156 * t431 / 0.6e2);
  tv2rhosigma5 = t7 * t435 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t437 = t225 * t228;
  t438 = t231 * rho[0];
  t442 = t224 * t437 / t40 / t438;
  t445 = my_piecewise3(t1, 0, -t104 * t442 / 0.192e4);
  tv2sigma20 = t7 * t445;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t446 = t371 * rho[1];
  t450 = t367 * t437 / t68 / t446;
  t453 = my_piecewise3(t57, 0, -t156 * t450 / 0.192e4);
  tv2sigma25 = t7 * t453;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t456 = t4 * t4;
  t459 = t3 / t456 / t34;
  t460 = t459 * t31;
  t461 = t105 * t105;
  t463 = t102 / t461;
  t464 = t223 * params->mu;
  t465 = t229 * sigma[0];
  t466 = t464 * t465;
  t467 = t231 * t231;
  t468 = t467 * t109;
  t469 = 0.1e1 / t468;
  t471 = t463 * t466 * t469;
  t475 = 0.1e1 / t41 / t438;
  t477 = t108 * t38 * t475;
  t482 = t218 * t242;
  t485 = 0.1e1 / t40 / t467;
  t487 = t226 * t230 * t485;
  t491 = 0.1e1 / t25 / t20;
  t492 = t186 * t89;
  t495 = t185 * t89;
  t498 = t85 * t85;
  t499 = 0.1e1 / t498;
  t500 = t17 * t499;
  t502 = 0.6e1 * t190 - 0.6e1 * t500;
  t503 = my_piecewise5(t11, 0, t15, 0, t502);
  t507 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t491 * t492 + 0.1e2 / 0.3e1 * t495 * t194 + 0.5e1 / 0.3e1 * t26 * t503);
  t508 = t507 * t30;
  t515 = t6 * t213 * t102;
  t516 = t515 * t113;
  t518 = t218 * t236;
  t521 = t6 * t199 * t102;
  t525 = t6 * t203 * t102;
  t526 = t525 * t113;
  t528 = t198 * t97;
  t530 = t6 * t528 * t52;
  t532 = t92 * t212;
  t534 = t6 * t532 * t52;
  t537 = 0.1e1 / t29 / t85;
  t538 = t28 * t537;
  t541 = 0.2e1 / 0.45e2 * t6 * t538 * t52;
  t542 = -t460 * t471 / 0.135e3 - 0.77e2 / 0.27e3 * t104 * t477 + 0.11e2 / 0.6e2 * t208 * t242 + 0.11e2 / 0.9e2 * t482 + 0.11e2 / 0.27e3 * t104 * t487 + 0.3e1 / 0.2e2 * t6 * t508 * t52 - t208 * t236 / 0.9e2 + t516 / 0.9e2 - t518 / 0.135e3 - t521 * t113 / 0.2e2 - t526 / 0.15e2 + 0.3e1 / 0.1e2 * t530 - t534 / 0.1e2 + t541;
  t543 = my_piecewise3(t1, 0, t542);
  t545 = 0.1e1 / t61 / t59;
  t546 = t248 * t119;
  t549 = t247 * t119;
  t553 = my_piecewise5(t15, 0, t11, 0, -t502);
  t557 = my_piecewise3(t60, 0, -0.1e2 / 0.27e2 * t545 * t546 + 0.1e2 / 0.3e1 * t549 * t252 + 0.5e1 / 0.3e1 * t62 * t553);
  t558 = t557 * t30;
  t562 = t256 * t97;
  t564 = t6 * t562 * t80;
  t566 = t122 * t212;
  t568 = t6 * t566 * t80;
  t570 = t64 * t537;
  t573 = 0.2e1 / 0.45e2 * t6 * t570 * t80;
  t575 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t558 * t80 + 0.3e1 / 0.1e2 * t564 - t568 / 0.1e2 + t573);
  tv3rho30 = 0.3e1 * t246 + 0.3e1 * t270 + t7 * (t543 + t575);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t578 = 0.2e1 * t297;
  t579 = 0.2e1 * t324;
  t580 = t491 * t136;
  t583 = t185 * t277;
  t588 = 0.2e1 * t190;
  t589 = 0.6e1 * t500;
  t590 = t588 - t589;
  t591 = my_piecewise5(t11, 0, t15, 0, t590);
  t595 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t580 * t186 + 0.2e2 / 0.9e1 * t583 * t89 + 0.1e2 / 0.9e1 * t273 * t194 + 0.5e1 / 0.3e1 * t26 * t591);
  t596 = t595 * t30;
  t600 = t281 * t97;
  t603 = t6 * t600 * t52 / 0.5e1;
  t605 = t6 * t282 * t102;
  t608 = t139 * t212;
  t610 = t6 * t608 * t52;
  t613 = t6 * t286 * t102;
  t615 = t613 * t113 / 0.45e2;
  t626 = 0.3e1 / 0.2e2 * t6 * t596 * t52 + t603 - t605 * t113 / 0.3e2 - t610 / 0.3e2 - t615 - t291 * t236 / 0.27e3 + 0.11e2 / 0.18e3 * t291 * t242 + t530 / 0.1e2 - t534 / 0.15e2 - t526 / 0.45e2 + t541 + t516 / 0.135e3 - t518 / 0.405e3 + 0.11e2 / 0.27e3 * t482;
  t627 = my_piecewise3(t1, 0, t626);
  t628 = t545 * t147;
  t631 = t247 * t301;
  t637 = my_piecewise5(t15, 0, t11, 0, -t590);
  t641 = my_piecewise3(t60, 0, -0.1e2 / 0.27e2 * t628 * t248 + 0.2e2 / 0.9e1 * t631 * t119 + 0.1e2 / 0.9e1 * t298 * t252 + 0.5e1 / 0.3e1 * t62 * t637);
  t642 = t641 * t30;
  t646 = t305 * t97;
  t649 = t6 * t646 * t80 / 0.5e1;
  t650 = t150 * t212;
  t652 = t6 * t650 * t80;
  t657 = t6 * t257 * t102;
  t661 = t6 * t261 * t102;
  t663 = t661 * t165 / 0.45e2;
  t665 = t6 * t265 * t102;
  t666 = t665 * t165;
  t669 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t642 * t80 + t649 - t652 / 0.3e2 + t564 / 0.1e2 - t568 / 0.15e2 + t573 - t657 * t165 / 0.6e2 - t663 + t666 / 0.27e3);
  tv3rho31 = t246 + t270 + t578 + t579 + t7 * (t627 + t669);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t672 = t491 * t329;
  t677 = t185 * t334;
  t680 = -t588 - t589;
  t681 = my_piecewise5(t11, 0, t15, 0, t680);
  t685 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t672 * t89 + 0.2e2 / 0.9e1 * t273 * t277 + 0.1e2 / 0.9e1 * t677 * t89 + 0.5e1 / 0.3e1 * t26 * t681);
  t686 = t685 * t30;
  t690 = t338 * t97;
  t692 = t6 * t690 * t52;
  t695 = t6 * t339 * t102;
  t702 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t686 * t52 + t692 / 0.1e2 - t695 * t113 / 0.6e2 + t603 - t610 / 0.15e2 - t615 - t534 / 0.3e2 + t541 + t516 / 0.27e3);
  t703 = t545 * t346;
  t708 = t247 * t350;
  t712 = my_piecewise5(t15, 0, t11, 0, -t680);
  t716 = my_piecewise3(t60, 0, -0.1e2 / 0.27e2 * t703 * t119 + 0.2e2 / 0.9e1 * t298 * t301 + 0.1e2 / 0.9e1 * t708 * t119 + 0.5e1 / 0.3e1 * t62 * t712);
  t717 = t716 * t30;
  t721 = t354 * t97;
  t723 = t6 * t721 * t80;
  t727 = t6 * t306 * t102;
  t731 = t6 * t310 * t102;
  t732 = t731 * t165;
  t738 = t320 * t376;
  t742 = t320 * t382;
  t744 = 0.3e1 / 0.2e2 * t6 * t717 * t80 + t723 / 0.1e2 + t649 - t652 / 0.15e2 - t727 * t165 / 0.3e2 - t732 / 0.45e2 - t568 / 0.3e2 + t573 - t663 + t666 / 0.135e3 - t316 * t376 / 0.27e3 - t738 / 0.405e3 + 0.11e2 / 0.18e3 * t316 * t382 + 0.11e2 / 0.27e3 * t742;
  t745 = my_piecewise3(t57, 0, t744);
  tv3rho32 = t578 + t579 + t345 + t386 + t7 * (t702 + t745);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t750 = t329 * t136;
  t756 = -0.6e1 * t190 - 0.6e1 * t500;
  t757 = my_piecewise5(t11, 0, t15, 0, t756);
  t761 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t491 * t750 + 0.1e2 / 0.3e1 * t273 * t334 + 0.5e1 / 0.3e1 * t26 * t757);
  t762 = t761 * t30;
  t769 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t762 * t52 + 0.3e1 / 0.1e2 * t692 - t610 / 0.1e2 + t541);
  t770 = t459 * t65;
  t771 = t157 * t157;
  t773 = t102 / t771;
  t774 = t369 * sigma[2];
  t775 = t464 * t774;
  t776 = t371 * t371;
  t777 = t776 * t161;
  t778 = 0.1e1 / t777;
  t780 = t773 * t775 * t778;
  t784 = 0.1e1 / t69 / t446;
  t786 = t160 * t66 * t784;
  t790 = 0.1e1 / t68 / t776;
  t792 = t368 * t370 * t790;
  t801 = t346 * t147;
  t807 = my_piecewise5(t15, 0, t11, 0, -t756);
  t811 = my_piecewise3(t60, 0, -0.1e2 / 0.27e2 * t545 * t801 + 0.1e2 / 0.3e1 * t298 * t350 + 0.5e1 / 0.3e1 * t62 * t807);
  t812 = t811 * t30;
  t819 = t6 * t355 * t102;
  t824 = -t770 * t780 / 0.135e3 - 0.77e2 / 0.27e3 * t156 * t786 + 0.11e2 / 0.27e3 * t156 * t792 + 0.11e2 / 0.9e2 * t742 + 0.11e2 / 0.6e2 * t361 * t382 - t732 / 0.15e2 - t738 / 0.135e3 + t666 / 0.9e2 + 0.3e1 / 0.2e2 * t6 * t812 * t80 - t361 * t376 / 0.9e2 - t819 * t165 / 0.2e2 + t573 - t652 / 0.1e2 + 0.3e1 / 0.1e2 * t723;
  t825 = my_piecewise3(t57, 0, t824);
  tv3rho33 = 0.3e1 * t345 + 0.3e1 * t386 + t7 * (t769 + t825);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t831 = t525 * t174;
  t838 = t515 * t174 / 0.72e3;
  t839 = t218 * t398;
  t841 = t218 * t402;
  t843 = t467 * t39;
  t845 = t464 / t843;
  t847 = t463 * t845 * t229;
  t852 = t226 * t228 * t234 * sigma[0];
  t856 = t107 * t172 * t240;
  t860 = my_piecewise3(t1, 0, t521 * t174 / 0.16e3 + t831 / 0.12e3 + t208 * t398 / 0.36e3 - t208 * t402 / 0.3e2 - t838 + t839 / 0.54e3 - t841 / 0.45e2 + t460 * t847 / 0.36e3 - t104 * t852 / 0.8e2 + 0.11e2 / 0.18e3 * t104 * t856);
  tv3rho2sigma0 = t7 * t860 + 0.2e1 * t406;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t865 = t661 * t179;
  t868 = t665 * t179 / 0.72e3;
  t870 = my_piecewise3(t57, 0, t657 * t179 / 0.16e3 + t865 / 0.12e3 - t868);
  tv3rho2sigma2 = t7 * t870 + 0.2e1 * t413;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t874 = t613 * t174;
  t884 = my_piecewise3(t1, 0, t605 * t174 / 0.16e3 + t874 / 0.24e3 + t291 * t398 / 0.72e3 - t291 * t402 / 0.6e2 + t831 / 0.24e3 - t838 + t839 / 0.108e4 - t841 / 0.9e2);
  tv3rho2sigma3 = t7 * t884 + t406 + t418;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t888 = t731 * t179;
  t893 = t320 * t427;
  t897 = t320 * t431;
  t900 = my_piecewise3(t57, 0, t727 * t179 / 0.16e3 + t888 / 0.24e3 + t865 / 0.24e3 - t868 + t316 * t427 / 0.72e3 + t893 / 0.108e4 - t316 * t431 / 0.6e2 - t897 / 0.9e2);
  tv3rho2sigma5 = t7 * t900 + t413 + t435;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t907 = my_piecewise3(t1, 0, t695 * t174 / 0.16e3 + t874 / 0.12e3 - t838);
  tv3rho2sigma6 = t7 * t907 + 0.2e1 * t418;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t919 = t776 * t67;
  t921 = t464 / t919;
  t923 = t773 * t921 * t369;
  t928 = t368 * t228 * t374 * sigma[2];
  t932 = t159 * t172 * t380;
  t936 = my_piecewise3(t57, 0, t819 * t179 / 0.16e3 + t888 / 0.12e3 + t361 * t427 / 0.36e3 - t361 * t431 / 0.3e2 - t868 + t893 / 0.54e3 - t897 / 0.45e2 + t770 * t923 / 0.36e3 - t156 * t928 / 0.8e2 + 0.11e2 / 0.18e3 * t156 * t932);
  tv3rho2sigma8 = t7 * t936 + 0.2e1 * t435;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t941 = t218 * t442 / 0.288e4;
  t942 = t467 * rho[0];
  t944 = t464 / t942;
  t946 = t463 * t944 * sigma[0];
  t950 = t224 * t437 * t395;
  t954 = my_piecewise3(t1, 0, -t208 * t442 / 0.192e4 - t941 - t460 * t946 / 0.96e3 + t104 * t950 / 0.36e3);
  tv3rhosigma20 = t7 * t954 + t445;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t959 = t320 * t450 / 0.288e4;
  t961 = my_piecewise3(t57, 0, -t316 * t450 / 0.192e4 - t959);
  tv3rhosigma25 = t7 * t961 + t453;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t966 = my_piecewise3(t1, 0, -t291 * t442 / 0.192e4 - t941);
  tv3rhosigma26 = t7 * t966 + t445;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t970 = t776 * rho[1];
  t972 = t464 / t970;
  t974 = t773 * t972 * sigma[2];
  t978 = t367 * t437 * t424;
  t982 = my_piecewise3(t57, 0, -t361 * t450 / 0.192e4 - t959 - t770 * t974 / 0.96e3 + t156 * t978 / 0.36e3);
  tv3rhosigma211 = t7 * t982 + t453;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t986 = t463 * t464 / t467;
  t989 = my_piecewise3(t1, 0, t460 * t986 / 0.256e4);
  tv3sigma30 = t7 * t989;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t992 = t773 * t464 / t776;
  t995 = my_piecewise3(t57, 0, t770 * t992 / 0.256e4);
  tv3sigma39 = t7 * t995;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t40, t41, t43, t47, t52, t56, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66;
  double t67, t68, t69, t71, t75, t80, t84, tzk0;

  double t85, t86, t87, t88, t89, t92, t93, t97;
  double t98, t101, t102, t103, t104, t105, t107, t108;
  double t109, t111, t113, t117, t119, t122, t123, t127;
  double t130, t132, tvrho0, t135, t136, t139, t140, t145;
  double t147, t150, t151, t155, t156, t157, t159, t160;
  double t161, t163, t165, t169, tvrho1, t172, t174, t177;
  double tvsigma0, tvsigma1, t179, t182, tvsigma2;

  double t185, t186, t189, t190, t191, t193, t194, t198;
  double t199, t203, t205, t208, t212, t213, t216, t218;
  double t219, t223, t224, t225, t226, t228, t229, t230;
  double t231, t234, t236, t240, t242, t246, t247, t248;
  double t252, t256, t257, t261, t263, t265, t268, t270;
  double tv2rho20, t273, t276, t277, t281, t282, t286, t288;
  double t291, t297, t298, t301, t305, t306, t310, t312;
  double t316, t320, t321, t324, tv2rho21, t329, t333, t334;
  double t338, t339, t345, t346, t350, t354, t355, t361;
  double t367, t368, t369, t370, t371, t374, t376, t380;
  double t382, t386, tv2rho22, t392, t393, t395, t398, t402;
  double t406, tv2rhosigma0, tv2rhosigma1, t411, t413, tv2rhosigma2, t418, tv2rhosigma3;
  double tv2rhosigma4, t422, t424, t427, t431, t435, tv2rhosigma5, t437;
  double t438, t442, t445, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t446, t450, t453, tv2sigma25;

  double t456, t459, t460, t461, t463, t464, t465, t466;
  double t467, t468, t469, t471, t475, t477, t482, t485;
  double t487, t491, t492, t495, t498, t499, t500, t502;
  double t503, t507, t508, t515, t516, t518, t521, t525;
  double t526, t528, t530, t532, t534, t537, t538, t541;
  double t542, t543, t545, t546, t549, t553, t557, t558;
  double t562, t564, t566, t568, t570, t573, t575, tv3rho30;
  double t578, t579, t580, t583, t588, t589, t590, t591;
  double t595, t596, t600, t603, t605, t608, t610, t613;
  double t615, t626, t627, t628, t631, t637, t641, t642;
  double t646, t649, t650, t652, t657, t661, t663, t665;
  double t666, t669, tv3rho31, t672, t677, t680, t681, t685;
  double t686, t690, t692, t695, t702, t703, t708, t712;
  double t716, t717, t721, t723, t727, t731, t732, t738;
  double t742, t744, t745, tv3rho32, t750, t756, t757, t761;
  double t762, t769, t770, t771, t773, t774, t775, t776;
  double t777, t778, t780, t784, t786, t790, t792, t801;
  double t807, t811, t812, t819, t824, t825, tv3rho33, t831;
  double t838, t839, t841, t843, t845, t847, t852, t856;
  double t860, tv3rho2sigma0, tv3rho2sigma1, t865, t868, t870, tv3rho2sigma2, t874;
  double t884, tv3rho2sigma3, tv3rho2sigma4, t888, t893, t897, t900, tv3rho2sigma5;
  double t907, tv3rho2sigma6, tv3rho2sigma7, t919, t921, t923, t928, t932;
  double t936, tv3rho2sigma8, t941, t942, t944, t946, t950, t954;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t959, t961, tv3rhosigma25;
  double t966, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t970, t972;
  double t974, t978, t982, tv3rhosigma211, t986, t989, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t992;
  double t995, tv3sigma39;

  double t999, t1000, t1002, t1005, t1006, t1008, t1010, t1018;
  double t1030, t1033, t1036, t1040, t1041, t1043, t1045, t1048;
  double t1049, t1050, t1063, t1067, t1068, t1070, t1071, t1077;
  double t1084, t1086, t1087, t1091, t1098, t1102, t1106, t1108;
  double t1111, t1112, t1114, t1120, t1122, t1123, t1125, t1126;
  double t1132, t1138, t1142, t1149, t1153, t1157, t1162, t1164;
  double tv4rho40, t1172, t1173, t1174, t1175, t1178, t1182, t1183;
  double t1195, t1199, t1219, t1220, t1221, t1222, t1226, t1233;
  double t1237, t1238, t1241, t1247, t1250, t1252, t1270, t1274;
  double t1281, t1285, t1286, t1289, t1295, t1299, t1300, t1303;
  double t1304, t1305, t1307, t1308, t1310, t1311, tv4rho41, t1328;
  double t1341, t1345, t1352, t1356, t1368, t1372, t1373, t1382;
  double t1384, t1385, t1387, t1389, t1391, t1394, t1395, t1398;
  double t1399, t1409, t1422, t1426, t1433, t1437, t1453, t1456;
  double t1458, tv4rho42, t1478, t1479, t1483, t1490, t1493, t1502;
  double t1503, t1504, t1507, t1508, t1510, t1512, t1514, t1519;
  double t1532, t1552, t1556, t1563, t1569, t1572, t1573, t1575;
  double t1577, tv4rho43, t1582, t1587, t1593, t1594, t1598, t1607;
  double t1611, t1616, t1619, t1620, t1645, t1656, t1661, t1667;
  double t1671, t1680, t1683, t1689, t1691, tv4rho44, t1699, t1701;
  double t1712, t1714, t1719, t1720, t1729, t1733, t1742, t1748;
  double t1750, t1751, tv4rho3sigma0, tv4rho3sigma1, t1756, t1758, t1761, t1763;
  double tv4rho3sigma2, t1765, t1767, t1769, t1773, t1778, t1795, t1796;
  double tv4rho3sigma3, tv4rho3sigma4, t1798, t1802, t1803, t1810, t1811, t1816;
  double t1817, t1819, t1820, tv4rho3sigma5, t1824, t1834, t1835, tv4rho3sigma6;
  double tv4rho3sigma7, t1839, t1844, t1848, t1855, t1859, t1863, t1865;
  double t1866, tv4rho3sigma8, t1874, tv4rho3sigma9, tv4rho3sigma10, t1921, t1922, tv4rho3sigma11;
  double t1927, t1934, t1935, t1937, t1956, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22;
  double tv4rho2sigma23, tv4rho2sigma24, t1961, t1964, t1966, tv4rho2sigma25, t1970, t1980;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t1984, t1989, t1993;
  double t1996, tv4rho2sigma211, t2003, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216;
  double t2032, tv4rho2sigma217, t2037, t2049, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33;
  double tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t2054, t2056, tv4rhosigma39;
  double t2061, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316;
  double tv4rhosigma317, tv4rhosigma318, t2076, tv4rhosigma319, t2085, tv4sigma40, tv4sigma41, tv4sigma42;
  double tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410;
  double tv4sigma411, tv4sigma412, tv4sigma413, t2093, tv4sigma414;

  gga_k_apbe_params *params;

  assert(p->params != NULL);
  params = (gga_k_apbe_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = params->mu * t32;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t36 = t35 * t35;
  t37 = 0.1e1 / t36;
  t38 = t37 * sigma[0];
  t39 = rho[0] * rho[0];
  t40 = POW_1_3(rho[0]);
  t41 = t40 * t40;
  t43 = 0.1e1 / t41 / t39;
  t47 = params->kappa + t33 * t38 * t43 / 0.24e2;
  t52 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t47);
  t56 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t15, t12, t11, t16, -t18);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t62 = t61 * t61;
  t64 = my_piecewise3(t60, t24, t62 * t59);
  t65 = t64 * t30;
  t66 = t37 * sigma[2];
  t67 = rho[1] * rho[1];
  t68 = POW_1_3(rho[1]);
  t69 = t68 * t68;
  t71 = 0.1e1 / t69 / t67;
  t75 = params->kappa + t33 * t66 * t71 / 0.24e2;
  t80 = 0.1e1 + params->kappa * (0.1e1 - params->kappa / t75);
  t84 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t65 * t80);
  tzk0 = t56 + t84;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t85 = t7 * t7;
  t86 = 0.1e1 / t85;
  t87 = t17 * t86;
  t88 = t8 - t87;
  t89 = my_piecewise5(t11, 0, t15, 0, t88);
  t92 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t89);
  t93 = t92 * t30;
  t97 = 0.1e1 / t29;
  t98 = t28 * t97;
  t101 = t6 * t98 * t52 / 0.1e2;
  t102 = params->kappa * params->kappa;
  t103 = t31 * t102;
  t104 = t6 * t103;
  t105 = t47 * t47;
  t107 = 0.1e1 / t105 * params->mu;
  t108 = t107 * t32;
  t109 = t39 * rho[0];
  t111 = 0.1e1 / t41 / t109;
  t113 = t108 * t38 * t111;
  t117 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t93 * t52 + t101 - t104 * t113 / 0.6e2);
  t119 = my_piecewise5(t15, 0, t11, 0, -t88);
  t122 = my_piecewise3(t60, 0, 0.5e1 / 0.3e1 * t62 * t119);
  t123 = t122 * t30;
  t127 = t64 * t97;
  t130 = t6 * t127 * t80 / 0.1e2;
  t132 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t123 * t80 + t130);
  tvrho0 = t56 + t84 + t7 * (t117 + t132);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t135 = -t8 - t87;
  t136 = my_piecewise5(t11, 0, t15, 0, t135);
  t139 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t136);
  t140 = t139 * t30;
  t145 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t140 * t52 + t101);
  t147 = my_piecewise5(t15, 0, t11, 0, -t135);
  t150 = my_piecewise3(t60, 0, 0.5e1 / 0.3e1 * t62 * t147);
  t151 = t150 * t30;
  t155 = t65 * t102;
  t156 = t6 * t155;
  t157 = t75 * t75;
  t159 = 0.1e1 / t157 * params->mu;
  t160 = t159 * t32;
  t161 = t67 * rho[1];
  t163 = 0.1e1 / t69 / t161;
  t165 = t160 * t66 * t163;
  t169 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t151 * t80 + t130 - t156 * t165 / 0.6e2);
  tvrho1 = t56 + t84 + t7 * (t145 + t169);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t172 = t32 * t37;
  t174 = t107 * t172 * t43;
  t177 = my_piecewise3(t1, 0, t104 * t174 / 0.16e3);
  tvsigma0 = t7 * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t179 = t159 * t172 * t71;
  t182 = my_piecewise3(t57, 0, t156 * t179 / 0.16e3);
  tvsigma2 = t7 * t182;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t185 = 0.1e1 / t25;
  t186 = t89 * t89;
  t189 = t85 * t7;
  t190 = 0.1e1 / t189;
  t191 = t17 * t190;
  t193 = -0.2e1 * t86 + 0.2e1 * t191;
  t194 = my_piecewise5(t11, 0, t15, 0, t193);
  t198 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t185 * t186 + 0.5e1 / 0.3e1 * t26 * t194);
  t199 = t198 * t30;
  t203 = t92 * t97;
  t205 = t6 * t203 * t52;
  t208 = t6 * t93 * t102;
  t212 = 0.1e1 / t29 / t7;
  t213 = t28 * t212;
  t216 = t6 * t213 * t52 / 0.3e2;
  t218 = t6 * t98 * t102;
  t219 = t218 * t113;
  t223 = params->mu * params->mu;
  t224 = 0.1e1 / t105 / t47 * t223;
  t225 = t32 * t32;
  t226 = t224 * t225;
  t228 = 0.1e1 / t35 / t34;
  t229 = sigma[0] * sigma[0];
  t230 = t228 * t229;
  t231 = t39 * t39;
  t234 = 0.1e1 / t40 / t231 / t109;
  t236 = t226 * t230 * t234;
  t240 = 0.1e1 / t41 / t231;
  t242 = t108 * t38 * t240;
  t246 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t199 * t52 + t205 / 0.5e1 - t208 * t113 / 0.3e2 - t216 - t219 / 0.45e2 - t104 * t236 / 0.27e3 + 0.11e2 / 0.18e3 * t104 * t242);
  t247 = 0.1e1 / t61;
  t248 = t119 * t119;
  t252 = my_piecewise5(t15, 0, t11, 0, -t193);
  t256 = my_piecewise3(t60, 0, 0.1e2 / 0.9e1 * t247 * t248 + 0.5e1 / 0.3e1 * t62 * t252);
  t257 = t256 * t30;
  t261 = t122 * t97;
  t263 = t6 * t261 * t80;
  t265 = t64 * t212;
  t268 = t6 * t265 * t80 / 0.3e2;
  t270 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t257 * t80 + t263 / 0.5e1 - t268);
  tv2rho20 = 0.2e1 * t117 + 0.2e1 * t132 + t7 * (t246 + t270);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t273 = t185 * t136;
  t276 = 0.2e1 * t191;
  t277 = my_piecewise5(t11, 0, t15, 0, t276);
  t281 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t273 * t89 + 0.5e1 / 0.3e1 * t26 * t277);
  t282 = t281 * t30;
  t286 = t139 * t97;
  t288 = t6 * t286 * t52;
  t291 = t6 * t140 * t102;
  t297 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t282 * t52 + t288 / 0.1e2 - t291 * t113 / 0.6e2 + t205 / 0.1e2 - t216 - t219 / 0.9e2);
  t298 = t247 * t147;
  t301 = my_piecewise5(t15, 0, t11, 0, -t276);
  t305 = my_piecewise3(t60, 0, 0.1e2 / 0.9e1 * t298 * t119 + 0.5e1 / 0.3e1 * t62 * t301);
  t306 = t305 * t30;
  t310 = t150 * t97;
  t312 = t6 * t310 * t80;
  t316 = t6 * t123 * t102;
  t320 = t6 * t127 * t102;
  t321 = t320 * t165;
  t324 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t306 * t80 + t312 / 0.1e2 + t263 / 0.1e2 - t268 - t316 * t165 / 0.6e2 - t321 / 0.9e2);
  tv2rho21 = t117 + t132 + t145 + t169 + t7 * (t297 + t324);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t329 = t136 * t136;
  t333 = 0.2e1 * t86 + 0.2e1 * t191;
  t334 = my_piecewise5(t11, 0, t15, 0, t333);
  t338 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t185 * t329 + 0.5e1 / 0.3e1 * t26 * t334);
  t339 = t338 * t30;
  t345 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t339 * t52 + t288 / 0.5e1 - t216);
  t346 = t147 * t147;
  t350 = my_piecewise5(t15, 0, t11, 0, -t333);
  t354 = my_piecewise3(t60, 0, 0.1e2 / 0.9e1 * t247 * t346 + 0.5e1 / 0.3e1 * t62 * t350);
  t355 = t354 * t30;
  t361 = t6 * t151 * t102;
  t367 = 0.1e1 / t157 / t75 * t223;
  t368 = t367 * t225;
  t369 = sigma[2] * sigma[2];
  t370 = t228 * t369;
  t371 = t67 * t67;
  t374 = 0.1e1 / t68 / t371 / t161;
  t376 = t368 * t370 * t374;
  t380 = 0.1e1 / t69 / t371;
  t382 = t160 * t66 * t380;
  t386 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t355 * t80 + t312 / 0.5e1 - t361 * t165 / 0.3e2 - t268 - t321 / 0.45e2 - t156 * t376 / 0.27e3 + 0.11e2 / 0.18e3 * t156 * t382);
  tv2rho22 = 0.2e1 * t145 + 0.2e1 * t169 + t7 * (t345 + t386);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t392 = t218 * t174 / 0.24e3;
  t393 = t231 * t39;
  t395 = 0.1e1 / t40 / t393;
  t398 = t226 * t228 * t395 * sigma[0];
  t402 = t107 * t172 * t111;
  t406 = my_piecewise3(t1, 0, t208 * t174 / 0.16e3 + t392 + t104 * t398 / 0.72e3 - t104 * t402 / 0.6e2);
  tv2rhosigma0 = t7 * t406 + t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t411 = t320 * t179 / 0.24e3;
  t413 = my_piecewise3(t57, 0, t316 * t179 / 0.16e3 + t411);
  tv2rhosigma2 = t7 * t413 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t418 = my_piecewise3(t1, 0, t291 * t174 / 0.16e3 + t392);
  tv2rhosigma3 = t7 * t418 + t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t422 = t371 * t67;
  t424 = 0.1e1 / t68 / t422;
  t427 = t368 * t228 * t424 * sigma[2];
  t431 = t159 * t172 * t163;
  t435 = my_piecewise3(t57, 0, t361 * t179 / 0.16e3 + t411 + t156 * t427 / 0.72e3 - t156 * t431 / 0.6e2);
  tv2rhosigma5 = t7 * t435 + t182;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t437 = t225 * t228;
  t438 = t231 * rho[0];
  t442 = t224 * t437 / t40 / t438;
  t445 = my_piecewise3(t1, 0, -t104 * t442 / 0.192e4);
  tv2sigma20 = t7 * t445;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t446 = t371 * rho[1];
  t450 = t367 * t437 / t68 / t446;
  t453 = my_piecewise3(t57, 0, -t156 * t450 / 0.192e4);
  tv2sigma25 = t7 * t453;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t456 = t4 * t4;
  t459 = t3 / t456 / t34;
  t460 = t459 * t31;
  t461 = t105 * t105;
  t463 = t102 / t461;
  t464 = t223 * params->mu;
  t465 = t229 * sigma[0];
  t466 = t464 * t465;
  t467 = t231 * t231;
  t468 = t467 * t109;
  t469 = 0.1e1 / t468;
  t471 = t463 * t466 * t469;
  t475 = 0.1e1 / t41 / t438;
  t477 = t108 * t38 * t475;
  t482 = t218 * t242;
  t485 = 0.1e1 / t40 / t467;
  t487 = t226 * t230 * t485;
  t491 = 0.1e1 / t25 / t20;
  t492 = t186 * t89;
  t495 = t185 * t89;
  t498 = t85 * t85;
  t499 = 0.1e1 / t498;
  t500 = t17 * t499;
  t502 = 0.6e1 * t190 - 0.6e1 * t500;
  t503 = my_piecewise5(t11, 0, t15, 0, t502);
  t507 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t491 * t492 + 0.1e2 / 0.3e1 * t495 * t194 + 0.5e1 / 0.3e1 * t26 * t503);
  t508 = t507 * t30;
  t515 = t6 * t213 * t102;
  t516 = t515 * t113;
  t518 = t218 * t236;
  t521 = t6 * t199 * t102;
  t525 = t6 * t203 * t102;
  t526 = t525 * t113;
  t528 = t198 * t97;
  t530 = t6 * t528 * t52;
  t532 = t92 * t212;
  t534 = t6 * t532 * t52;
  t537 = 0.1e1 / t29 / t85;
  t538 = t28 * t537;
  t541 = 0.2e1 / 0.45e2 * t6 * t538 * t52;
  t542 = -t460 * t471 / 0.135e3 - 0.77e2 / 0.27e3 * t104 * t477 + 0.11e2 / 0.6e2 * t208 * t242 + 0.11e2 / 0.9e2 * t482 + 0.11e2 / 0.27e3 * t104 * t487 + 0.3e1 / 0.2e2 * t6 * t508 * t52 - t208 * t236 / 0.9e2 + t516 / 0.9e2 - t518 / 0.135e3 - t521 * t113 / 0.2e2 - t526 / 0.15e2 + 0.3e1 / 0.1e2 * t530 - t534 / 0.1e2 + t541;
  t543 = my_piecewise3(t1, 0, t542);
  t545 = 0.1e1 / t61 / t59;
  t546 = t248 * t119;
  t549 = t247 * t119;
  t553 = my_piecewise5(t15, 0, t11, 0, -t502);
  t557 = my_piecewise3(t60, 0, -0.1e2 / 0.27e2 * t545 * t546 + 0.1e2 / 0.3e1 * t549 * t252 + 0.5e1 / 0.3e1 * t62 * t553);
  t558 = t557 * t30;
  t562 = t256 * t97;
  t564 = t6 * t562 * t80;
  t566 = t122 * t212;
  t568 = t6 * t566 * t80;
  t570 = t64 * t537;
  t573 = 0.2e1 / 0.45e2 * t6 * t570 * t80;
  t575 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t558 * t80 + 0.3e1 / 0.1e2 * t564 - t568 / 0.1e2 + t573);
  tv3rho30 = 0.3e1 * t246 + 0.3e1 * t270 + t7 * (t543 + t575);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t578 = 0.2e1 * t297;
  t579 = 0.2e1 * t324;
  t580 = t491 * t136;
  t583 = t185 * t277;
  t588 = 0.2e1 * t190;
  t589 = 0.6e1 * t500;
  t590 = t588 - t589;
  t591 = my_piecewise5(t11, 0, t15, 0, t590);
  t595 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t580 * t186 + 0.2e2 / 0.9e1 * t583 * t89 + 0.1e2 / 0.9e1 * t273 * t194 + 0.5e1 / 0.3e1 * t26 * t591);
  t596 = t595 * t30;
  t600 = t281 * t97;
  t603 = t6 * t600 * t52 / 0.5e1;
  t605 = t6 * t282 * t102;
  t608 = t139 * t212;
  t610 = t6 * t608 * t52;
  t613 = t6 * t286 * t102;
  t615 = t613 * t113 / 0.45e2;
  t626 = 0.3e1 / 0.2e2 * t6 * t596 * t52 + t603 - t605 * t113 / 0.3e2 - t610 / 0.3e2 - t615 - t291 * t236 / 0.27e3 + 0.11e2 / 0.18e3 * t291 * t242 + t530 / 0.1e2 - t534 / 0.15e2 - t526 / 0.45e2 + t541 + t516 / 0.135e3 - t518 / 0.405e3 + 0.11e2 / 0.27e3 * t482;
  t627 = my_piecewise3(t1, 0, t626);
  t628 = t545 * t147;
  t631 = t247 * t301;
  t637 = my_piecewise5(t15, 0, t11, 0, -t590);
  t641 = my_piecewise3(t60, 0, -0.1e2 / 0.27e2 * t628 * t248 + 0.2e2 / 0.9e1 * t631 * t119 + 0.1e2 / 0.9e1 * t298 * t252 + 0.5e1 / 0.3e1 * t62 * t637);
  t642 = t641 * t30;
  t646 = t305 * t97;
  t649 = t6 * t646 * t80 / 0.5e1;
  t650 = t150 * t212;
  t652 = t6 * t650 * t80;
  t657 = t6 * t257 * t102;
  t661 = t6 * t261 * t102;
  t663 = t661 * t165 / 0.45e2;
  t665 = t6 * t265 * t102;
  t666 = t665 * t165;
  t669 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t642 * t80 + t649 - t652 / 0.3e2 + t564 / 0.1e2 - t568 / 0.15e2 + t573 - t657 * t165 / 0.6e2 - t663 + t666 / 0.27e3);
  tv3rho31 = t246 + t270 + t578 + t579 + t7 * (t627 + t669);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t672 = t491 * t329;
  t677 = t185 * t334;
  t680 = -t588 - t589;
  t681 = my_piecewise5(t11, 0, t15, 0, t680);
  t685 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t672 * t89 + 0.2e2 / 0.9e1 * t273 * t277 + 0.1e2 / 0.9e1 * t677 * t89 + 0.5e1 / 0.3e1 * t26 * t681);
  t686 = t685 * t30;
  t690 = t338 * t97;
  t692 = t6 * t690 * t52;
  t695 = t6 * t339 * t102;
  t702 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t686 * t52 + t692 / 0.1e2 - t695 * t113 / 0.6e2 + t603 - t610 / 0.15e2 - t615 - t534 / 0.3e2 + t541 + t516 / 0.27e3);
  t703 = t545 * t346;
  t708 = t247 * t350;
  t712 = my_piecewise5(t15, 0, t11, 0, -t680);
  t716 = my_piecewise3(t60, 0, -0.1e2 / 0.27e2 * t703 * t119 + 0.2e2 / 0.9e1 * t298 * t301 + 0.1e2 / 0.9e1 * t708 * t119 + 0.5e1 / 0.3e1 * t62 * t712);
  t717 = t716 * t30;
  t721 = t354 * t97;
  t723 = t6 * t721 * t80;
  t727 = t6 * t306 * t102;
  t731 = t6 * t310 * t102;
  t732 = t731 * t165;
  t738 = t320 * t376;
  t742 = t320 * t382;
  t744 = 0.3e1 / 0.2e2 * t6 * t717 * t80 + t723 / 0.1e2 + t649 - t652 / 0.15e2 - t727 * t165 / 0.3e2 - t732 / 0.45e2 - t568 / 0.3e2 + t573 - t663 + t666 / 0.135e3 - t316 * t376 / 0.27e3 - t738 / 0.405e3 + 0.11e2 / 0.18e3 * t316 * t382 + 0.11e2 / 0.27e3 * t742;
  t745 = my_piecewise3(t57, 0, t744);
  tv3rho32 = t578 + t579 + t345 + t386 + t7 * (t702 + t745);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t750 = t329 * t136;
  t756 = -0.6e1 * t190 - 0.6e1 * t500;
  t757 = my_piecewise5(t11, 0, t15, 0, t756);
  t761 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t491 * t750 + 0.1e2 / 0.3e1 * t273 * t334 + 0.5e1 / 0.3e1 * t26 * t757);
  t762 = t761 * t30;
  t769 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t762 * t52 + 0.3e1 / 0.1e2 * t692 - t610 / 0.1e2 + t541);
  t770 = t459 * t65;
  t771 = t157 * t157;
  t773 = t102 / t771;
  t774 = t369 * sigma[2];
  t775 = t464 * t774;
  t776 = t371 * t371;
  t777 = t776 * t161;
  t778 = 0.1e1 / t777;
  t780 = t773 * t775 * t778;
  t784 = 0.1e1 / t69 / t446;
  t786 = t160 * t66 * t784;
  t790 = 0.1e1 / t68 / t776;
  t792 = t368 * t370 * t790;
  t801 = t346 * t147;
  t807 = my_piecewise5(t15, 0, t11, 0, -t756);
  t811 = my_piecewise3(t60, 0, -0.1e2 / 0.27e2 * t545 * t801 + 0.1e2 / 0.3e1 * t298 * t350 + 0.5e1 / 0.3e1 * t62 * t807);
  t812 = t811 * t30;
  t819 = t6 * t355 * t102;
  t824 = -t770 * t780 / 0.135e3 - 0.77e2 / 0.27e3 * t156 * t786 + 0.11e2 / 0.27e3 * t156 * t792 + 0.11e2 / 0.9e2 * t742 + 0.11e2 / 0.6e2 * t361 * t382 - t732 / 0.15e2 - t738 / 0.135e3 + t666 / 0.9e2 + 0.3e1 / 0.2e2 * t6 * t812 * t80 - t361 * t376 / 0.9e2 - t819 * t165 / 0.2e2 + t573 - t652 / 0.1e2 + 0.3e1 / 0.1e2 * t723;
  t825 = my_piecewise3(t57, 0, t824);
  tv3rho33 = 0.3e1 * t345 + 0.3e1 * t386 + t7 * (t769 + t825);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t831 = t525 * t174;
  t838 = t515 * t174 / 0.72e3;
  t839 = t218 * t398;
  t841 = t218 * t402;
  t843 = t467 * t39;
  t845 = t464 / t843;
  t847 = t463 * t845 * t229;
  t852 = t226 * t228 * t234 * sigma[0];
  t856 = t107 * t172 * t240;
  t860 = my_piecewise3(t1, 0, t521 * t174 / 0.16e3 + t831 / 0.12e3 + t208 * t398 / 0.36e3 - t208 * t402 / 0.3e2 - t838 + t839 / 0.54e3 - t841 / 0.45e2 + t460 * t847 / 0.36e3 - t104 * t852 / 0.8e2 + 0.11e2 / 0.18e3 * t104 * t856);
  tv3rho2sigma0 = t7 * t860 + 0.2e1 * t406;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t865 = t661 * t179;
  t868 = t665 * t179 / 0.72e3;
  t870 = my_piecewise3(t57, 0, t657 * t179 / 0.16e3 + t865 / 0.12e3 - t868);
  tv3rho2sigma2 = t7 * t870 + 0.2e1 * t413;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t874 = t613 * t174;
  t884 = my_piecewise3(t1, 0, t605 * t174 / 0.16e3 + t874 / 0.24e3 + t291 * t398 / 0.72e3 - t291 * t402 / 0.6e2 + t831 / 0.24e3 - t838 + t839 / 0.108e4 - t841 / 0.9e2);
  tv3rho2sigma3 = t7 * t884 + t406 + t418;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t888 = t731 * t179;
  t893 = t320 * t427;
  t897 = t320 * t431;
  t900 = my_piecewise3(t57, 0, t727 * t179 / 0.16e3 + t888 / 0.24e3 + t865 / 0.24e3 - t868 + t316 * t427 / 0.72e3 + t893 / 0.108e4 - t316 * t431 / 0.6e2 - t897 / 0.9e2);
  tv3rho2sigma5 = t7 * t900 + t413 + t435;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t907 = my_piecewise3(t1, 0, t695 * t174 / 0.16e3 + t874 / 0.12e3 - t838);
  tv3rho2sigma6 = t7 * t907 + 0.2e1 * t418;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t919 = t776 * t67;
  t921 = t464 / t919;
  t923 = t773 * t921 * t369;
  t928 = t368 * t228 * t374 * sigma[2];
  t932 = t159 * t172 * t380;
  t936 = my_piecewise3(t57, 0, t819 * t179 / 0.16e3 + t888 / 0.12e3 + t361 * t427 / 0.36e3 - t361 * t431 / 0.3e2 - t868 + t893 / 0.54e3 - t897 / 0.45e2 + t770 * t923 / 0.36e3 - t156 * t928 / 0.8e2 + 0.11e2 / 0.18e3 * t156 * t932);
  tv3rho2sigma8 = t7 * t936 + 0.2e1 * t435;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t941 = t218 * t442 / 0.288e4;
  t942 = t467 * rho[0];
  t944 = t464 / t942;
  t946 = t463 * t944 * sigma[0];
  t950 = t224 * t437 * t395;
  t954 = my_piecewise3(t1, 0, -t208 * t442 / 0.192e4 - t941 - t460 * t946 / 0.96e3 + t104 * t950 / 0.36e3);
  tv3rhosigma20 = t7 * t954 + t445;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t959 = t320 * t450 / 0.288e4;
  t961 = my_piecewise3(t57, 0, -t316 * t450 / 0.192e4 - t959);
  tv3rhosigma25 = t7 * t961 + t453;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t966 = my_piecewise3(t1, 0, -t291 * t442 / 0.192e4 - t941);
  tv3rhosigma26 = t7 * t966 + t445;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t970 = t776 * rho[1];
  t972 = t464 / t970;
  t974 = t773 * t972 * sigma[2];
  t978 = t367 * t437 * t424;
  t982 = my_piecewise3(t57, 0, -t361 * t450 / 0.192e4 - t959 - t770 * t974 / 0.96e3 + t156 * t978 / 0.36e3);
  tv3rhosigma211 = t7 * t982 + t453;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t986 = t463 * t464 / t467;
  t989 = my_piecewise3(t1, 0, t460 * t986 / 0.256e4);
  tv3sigma30 = t7 * t989;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t992 = t773 * t464 / t776;
  t995 = my_piecewise3(t57, 0, t770 * t992 / 0.256e4);
  tv3sigma39 = t7 * t995;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t999 = t6 * t528 * t102;
  t1000 = t999 * t113;
  t1002 = t525 * t236;
  t1005 = t6 * t538 * t102;
  t1006 = t1005 * t113;
  t1008 = t515 * t242;
  t1010 = t218 * t477;
  t1018 = t525 * t242;
  t1030 = t218 * t487;
  t1033 = t6 * t508 * t102;
  t1036 = -0.2e1 / 0.15e2 * t1000 - 0.4e1 / 0.135e3 * t1002 - 0.8e1 / 0.405e3 * t1006 - 0.11e2 / 0.135e3 * t1008 - 0.308e3 / 0.405e3 * t1010 + 0.1309e4 / 0.81e3 * t104 * t108 * t38 / t41 / t393 + 0.22e2 / 0.45e2 * t1018 - 0.979e3 / 0.243e4 * t104 * t226 * t230 / t40 / t942 + 0.11e2 / 0.3e2 * t521 * t242 + 0.22e2 / 0.135e3 * t208 * t487 + 0.44e2 / 0.405e3 * t1030 - t1033 * t113 / 0.15e2;
  t1040 = t6 * t532 * t102;
  t1041 = t1040 * t113;
  t1043 = t515 * t236;
  t1045 = t459 * t103;
  t1048 = t223 * t223;
  t1049 = 0.1e1 / t461 / t47 * t1048;
  t1050 = t229 * t229;
  t1063 = 0.1e1 / t29 / t189;
  t1067 = 0.14e2 / 0.135e3 * t6 * t28 * t1063 * t52;
  t1068 = t20 * t20;
  t1070 = 0.1e1 / t25 / t1068;
  t1071 = t186 * t186;
  t1077 = t194 * t194;
  t1084 = t17 / t498 / t7;
  t1086 = -0.24e2 * t499 + 0.24e2 * t1084;
  t1087 = my_piecewise5(t11, 0, t15, 0, t1086);
  t1091 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1070 * t1071 - 0.2e2 / 0.9e1 * t491 * t186 * t194 + 0.1e2 / 0.3e1 * t185 * t1077 + 0.4e2 / 0.9e1 * t495 * t503 + 0.5e1 / 0.3e1 * t26 * t1087);
  t1098 = t6 * t507 * t97 * t52;
  t1102 = t6 * t198 * t212 * t52;
  t1106 = t6 * t92 * t537 * t52;
  t1108 = t459 * t93;
  t1111 = t459 * t98;
  t1112 = t1111 * t471;
  t1114 = t467 * t231;
  t1120 = -t521 * t236 / 0.45e2 + 0.2e1 / 0.45e2 * t1041 + 0.2e1 / 0.405e3 * t1043 - 0.4e1 / 0.1215e4 * t1045 * t1049 * t1050 / t41 / t467 / t393 * t32 * t37 - 0.154e3 / 0.135e3 * t208 * t477 - t1067 + 0.3e1 / 0.2e2 * t6 * t1091 * t30 * t52 + 0.2e1 / 0.5e1 * t1098 - t1102 / 0.5e1 + 0.8e1 / 0.45e2 * t1106 - 0.4e1 / 0.135e3 * t1108 * t471 - 0.8e1 / 0.405e3 * t1112 + 0.22e2 / 0.135e3 * t460 * t463 * t466 / t1114;
  t1122 = my_piecewise3(t1, 0, t1036 + t1120);
  t1123 = t59 * t59;
  t1125 = 0.1e1 / t61 / t1123;
  t1126 = t248 * t248;
  t1132 = t252 * t252;
  t1138 = my_piecewise5(t15, 0, t11, 0, -t1086);
  t1142 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1125 * t1126 - 0.2e2 / 0.9e1 * t545 * t248 * t252 + 0.1e2 / 0.3e1 * t247 * t1132 + 0.4e2 / 0.9e1 * t549 * t553 + 0.5e1 / 0.3e1 * t62 * t1138);
  t1149 = t6 * t557 * t97 * t80;
  t1153 = t6 * t256 * t212 * t80;
  t1157 = t6 * t122 * t537 * t80;
  t1162 = 0.14e2 / 0.135e3 * t6 * t64 * t1063 * t80;
  t1164 = my_piecewise3(t57, 0, 0.3e1 / 0.2e2 * t6 * t1142 * t30 * t80 + 0.2e1 / 0.5e1 * t1149 - t1153 / 0.5e1 + 0.8e1 / 0.45e2 * t1157 - t1162);
  tv4rho40 = 0.4e1 * t543 + 0.4e1 * t575 + t7 * (t1122 + t1164);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1172 = t6 * t608 * t102;
  t1173 = t1172 * t113;
  t1174 = t1173 / 0.9e2;
  t1175 = t613 * t236;
  t1178 = t6 * t596 * t102;
  t1182 = t6 * t600 * t102;
  t1183 = t1182 * t113;
  t1195 = 0.11e2 / 0.6e2 * t605 * t242 + t1174 - t1175 / 0.135e3 - t1178 * t113 / 0.2e2 - t1183 / 0.15e2 - t605 * t236 / 0.9e2 - t1000 / 0.3e2 - t1002 / 0.135e3 - 0.2e1 / 0.135e3 * t1006 - 0.11e2 / 0.27e3 * t1008 - 0.77e2 / 0.405e3 * t1010 + 0.11e2 / 0.9e2 * t1018 + 0.11e2 / 0.405e3 * t1030 + t1041 / 0.45e2;
  t1199 = t613 * t242;
  t1219 = 0.12e2 * t499;
  t1220 = 0.24e2 * t1084;
  t1221 = -t1219 + t1220;
  t1222 = my_piecewise5(t11, 0, t15, 0, t1221);
  t1226 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1070 * t136 * t492 - 0.1e2 / 0.9e1 * t491 * t277 * t186 - 0.1e2 / 0.9e1 * t580 * t89 * t194 + 0.1e2 / 0.3e1 * t185 * t591 * t89 + 0.1e2 / 0.3e1 * t583 * t194 + 0.1e2 / 0.9e1 * t273 * t503 + 0.5e1 / 0.3e1 * t26 * t1222);
  t1233 = t6 * t595 * t97 * t52;
  t1237 = t6 * t281 * t212 * t52;
  t1238 = t1237 / 0.1e2;
  t1241 = t6 * t139 * t537 * t52;
  t1247 = t459 * t140;
  t1250 = t1043 / 0.405e3 - 0.77e2 / 0.27e3 * t291 * t477 + 0.11e2 / 0.9e2 * t1199 + 0.11e2 / 0.27e3 * t291 * t487 - t1067 + 0.3e1 / 0.2e2 * t6 * t1226 * t30 * t52 + 0.3e1 / 0.1e2 * t1233 - t1238 + 0.2e1 / 0.45e2 * t1241 + t1098 / 0.1e2 - t1102 / 0.1e2 + 0.2e1 / 0.15e2 * t1106 - 0.2e1 / 0.405e3 * t1112 - t1247 * t471 / 0.135e3;
  t1252 = my_piecewise3(t1, 0, t1195 + t1250);
  t1270 = my_piecewise5(t15, 0, t11, 0, -t1221);
  t1274 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1125 * t147 * t546 - 0.1e2 / 0.9e1 * t545 * t301 * t248 - 0.1e2 / 0.9e1 * t628 * t119 * t252 + 0.1e2 / 0.3e1 * t247 * t637 * t119 + 0.1e2 / 0.3e1 * t631 * t252 + 0.1e2 / 0.9e1 * t298 * t553 + 0.5e1 / 0.3e1 * t62 * t1270);
  t1281 = t6 * t641 * t97 * t80;
  t1285 = t6 * t305 * t212 * t80;
  t1286 = t1285 / 0.1e2;
  t1289 = t6 * t150 * t537 * t80;
  t1295 = t6 * t558 * t102;
  t1299 = t6 * t562 * t102;
  t1300 = t1299 * t165;
  t1303 = t6 * t566 * t102;
  t1304 = t1303 * t165;
  t1305 = t1304 / 0.9e2;
  t1307 = t6 * t570 * t102;
  t1308 = t1307 * t165;
  t1310 = 0.3e1 / 0.2e2 * t6 * t1274 * t30 * t80 + 0.3e1 / 0.1e2 * t1281 - t1286 + 0.2e1 / 0.45e2 * t1289 + t1149 / 0.1e2 - t1153 / 0.1e2 + 0.2e1 / 0.15e2 * t1157 - t1162 - t1295 * t165 / 0.6e2 - t1300 / 0.3e2 + t1305 - 0.2e1 / 0.405e3 * t1308;
  t1311 = my_piecewise3(t57, 0, t1310);
  tv4rho41 = t543 + t575 + 0.3e1 * t627 + 0.3e1 * t669 + t7 * (t1252 + t1311);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1328 = t277 * t277;
  t1341 = my_piecewise5(t11, 0, t15, 0, t1220);
  t1345 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1070 * t329 * t186 - 0.4e2 / 0.27e2 * t580 * t89 * t277 - 0.1e2 / 0.27e2 * t672 * t194 + 0.2e2 / 0.9e1 * t185 * t1328 + 0.2e2 / 0.9e1 * t273 * t591 - 0.1e2 / 0.27e2 * t491 * t334 * t186 + 0.2e2 / 0.9e1 * t185 * t681 * t89 + 0.1e2 / 0.9e1 * t677 * t194 + 0.5e1 / 0.3e1 * t26 * t1341);
  t1352 = t6 * t685 * t97 * t52;
  t1356 = t6 * t338 * t212 * t52;
  t1368 = t6 * t686 * t102;
  t1372 = t6 * t690 * t102;
  t1373 = t1372 * t113;
  t1382 = 0.11e2 / 0.135e3 * t1199 - 0.4e1 / 0.405e3 * t1006 - 0.11e2 / 0.81e3 * t1008 - t1368 * t113 / 0.3e2 - t1373 / 0.45e2 - t695 * t236 / 0.27e3 + 0.2e1 / 0.135e3 * t1173 - 0.2e1 / 0.405e3 * t1175 - 0.2e1 / 0.45e2 * t1183 + t1041 / 0.135e3 + t1043 / 0.1215e4;
  t1384 = my_piecewise3(t1, 0, 0.11e2 / 0.18e3 * t695 * t242 + 0.3e1 / 0.2e2 * t6 * t1345 * t30 * t52 + t1352 / 0.5e1 - t1356 / 0.3e2 + t1233 / 0.5e1 - 0.2e1 / 0.15e2 * t1237 + 0.4e1 / 0.45e2 * t1241 - t1102 / 0.3e2 + 0.4e1 / 0.45e2 * t1106 - t1067 + t1382);
  t1385 = t661 * t382;
  t1387 = t665 * t382;
  t1389 = t661 * t376;
  t1391 = t665 * t376;
  t1394 = t6 * t646 * t102;
  t1395 = t1394 * t165;
  t1398 = t6 * t650 * t102;
  t1399 = t1398 * t165;
  t1409 = t301 * t301;
  t1422 = my_piecewise5(t15, 0, t11, 0, -t1220);
  t1426 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1125 * t346 * t248 - 0.4e2 / 0.27e2 * t628 * t119 * t301 - 0.1e2 / 0.27e2 * t703 * t252 + 0.2e2 / 0.9e1 * t247 * t1409 + 0.2e2 / 0.9e1 * t298 * t637 - 0.1e2 / 0.27e2 * t545 * t350 * t248 + 0.2e2 / 0.9e1 * t247 * t712 * t119 + 0.1e2 / 0.9e1 * t708 * t252 + 0.5e1 / 0.3e1 * t62 * t1422);
  t1433 = t6 * t716 * t97 * t80;
  t1437 = t6 * t354 * t212 * t80;
  t1453 = t6 * t642 * t102;
  t1456 = -0.2e1 / 0.15e2 * t1285 + 0.4e1 / 0.45e2 * t1289 - t1153 / 0.3e2 + 0.4e1 / 0.45e2 * t1157 - t1162 - 0.4e1 / 0.405e3 * t1308 - t1300 / 0.45e2 + 0.2e1 / 0.135e3 * t1304 - t657 * t376 / 0.27e3 + 0.11e2 / 0.18e3 * t657 * t382 - t1453 * t165 / 0.3e2;
  t1458 = my_piecewise3(t57, 0, 0.11e2 / 0.135e3 * t1385 - 0.11e2 / 0.81e3 * t1387 - 0.2e1 / 0.405e3 * t1389 + t1391 / 0.1215e4 - 0.2e1 / 0.45e2 * t1395 + t1399 / 0.135e3 + 0.3e1 / 0.2e2 * t6 * t1426 * t30 * t80 + t1433 / 0.5e1 - t1437 / 0.3e2 + t1281 / 0.5e1 + t1456);
  tv4rho42 = 0.2e1 * t627 + 0.2e1 * t669 + 0.2e1 * t702 + 0.2e1 * t745 + t7 * (t1384 + t1458);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1478 = t1219 + t1220;
  t1479 = my_piecewise5(t11, 0, t15, 0, t1478);
  t1483 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1070 * t750 * t89 - 0.1e2 / 0.9e1 * t672 * t277 - 0.1e2 / 0.9e1 * t580 * t334 * t89 + 0.1e2 / 0.3e1 * t583 * t334 + 0.1e2 / 0.3e1 * t273 * t681 + 0.1e2 / 0.9e1 * t185 * t757 * t89 + 0.5e1 / 0.3e1 * t26 * t1479);
  t1490 = t6 * t761 * t97 * t52;
  t1493 = t6 * t762 * t102;
  t1502 = 0.3e1 / 0.2e2 * t6 * t1483 * t30 * t52 + t1490 / 0.1e2 - t1493 * t113 / 0.6e2 + 0.3e1 / 0.1e2 * t1352 - t1356 / 0.1e2 - t1373 / 0.3e2 - t1238 + 0.2e1 / 0.15e2 * t1241 + t1174 + 0.2e1 / 0.45e2 * t1106 - t1067 - 0.2e1 / 0.405e3 * t1006;
  t1503 = my_piecewise3(t1, 0, t1502);
  t1504 = t731 * t376;
  t1507 = t6 * t721 * t102;
  t1508 = t1507 * t165;
  t1510 = t320 * t786;
  t1512 = t320 * t792;
  t1514 = t731 * t382;
  t1519 = t6 * t717 * t102;
  t1532 = -t1504 / 0.135e3 - t1508 / 0.3e2 - 0.77e2 / 0.405e3 * t1510 + 0.11e2 / 0.405e3 * t1512 + 0.11e2 / 0.9e2 * t1514 - t727 * t376 / 0.9e2 - t1519 * t165 / 0.2e2 - 0.77e2 / 0.27e3 * t316 * t786 + 0.11e2 / 0.27e3 * t316 * t792 + 0.11e2 / 0.6e2 * t727 * t382 + 0.11e2 / 0.9e2 * t1385 - 0.11e2 / 0.27e3 * t1387 - t1389 / 0.135e3 + t1391 / 0.405e3;
  t1552 = my_piecewise5(t15, 0, t11, 0, -t1478);
  t1556 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1125 * t801 * t119 - 0.1e2 / 0.9e1 * t703 * t301 - 0.1e2 / 0.9e1 * t628 * t350 * t119 + 0.1e2 / 0.3e1 * t631 * t350 + 0.1e2 / 0.3e1 * t298 * t712 + 0.1e2 / 0.9e1 * t247 * t807 * t119 + 0.5e1 / 0.3e1 * t62 * t1552);
  t1563 = t6 * t811 * t97 * t80;
  t1569 = t459 * t123;
  t1572 = t459 * t127;
  t1573 = t1572 * t780;
  t1575 = -t1395 / 0.15e2 + t1399 / 0.45e2 + t1305 - 0.2e1 / 0.135e3 * t1308 + 0.3e1 / 0.2e2 * t6 * t1556 * t30 * t80 + t1563 / 0.1e2 - t1437 / 0.1e2 + 0.3e1 / 0.1e2 * t1433 - t1286 + 0.2e1 / 0.15e2 * t1289 + 0.2e1 / 0.45e2 * t1157 - t1162 - t1569 * t780 / 0.135e3 - 0.2e1 / 0.405e3 * t1573;
  t1577 = my_piecewise3(t57, 0, t1532 + t1575);
  tv4rho43 = 0.3e1 * t702 + 0.3e1 * t745 + t769 + t825 + t7 * (t1503 + t1577);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1582 = t329 * t329;
  t1587 = t334 * t334;
  t1593 = 0.24e2 * t499 + 0.24e2 * t1084;
  t1594 = my_piecewise5(t11, 0, t15, 0, t1593);
  t1598 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1070 * t1582 - 0.2e2 / 0.9e1 * t672 * t334 + 0.1e2 / 0.3e1 * t185 * t1587 + 0.4e2 / 0.9e1 * t273 * t757 + 0.5e1 / 0.3e1 * t26 * t1594);
  t1607 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t1598 * t30 * t52 + 0.2e1 / 0.5e1 * t1490 - t1356 / 0.5e1 + 0.8e1 / 0.45e2 * t1241 - t1067);
  t1611 = t6 * t812 * t102;
  t1616 = t459 * t155;
  t1619 = 0.1e1 / t771 / t75 * t1048;
  t1620 = t369 * t369;
  t1645 = 0.11e2 / 0.3e2 * t819 * t382 - t1611 * t165 / 0.15e2 - t819 * t376 / 0.45e2 - 0.4e1 / 0.1215e4 * t1616 * t1619 * t1620 / t69 / t776 / t422 * t32 * t37 - 0.154e3 / 0.135e3 * t361 * t786 - 0.979e3 / 0.243e4 * t156 * t368 * t370 / t68 / t970 + 0.22e2 / 0.135e3 * t361 * t792 - 0.4e1 / 0.135e3 * t1504 - 0.2e1 / 0.15e2 * t1508 - 0.308e3 / 0.405e3 * t1510 + 0.44e2 / 0.405e3 * t1512 + 0.22e2 / 0.45e2 * t1514;
  t1656 = t346 * t346;
  t1661 = t350 * t350;
  t1667 = my_piecewise5(t15, 0, t11, 0, -t1593);
  t1671 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1125 * t1656 - 0.2e2 / 0.9e1 * t703 * t350 + 0.1e2 / 0.3e1 * t247 * t1661 + 0.4e2 / 0.9e1 * t298 * t807 + 0.5e1 / 0.3e1 * t62 * t1667);
  t1680 = t459 * t151;
  t1683 = t776 * t371;
  t1689 = 0.1309e4 / 0.81e3 * t156 * t160 * t66 / t69 / t422 - 0.11e2 / 0.135e3 * t1387 + 0.2e1 / 0.405e3 * t1391 + 0.2e1 / 0.45e2 * t1399 - 0.8e1 / 0.405e3 * t1308 + 0.3e1 / 0.2e2 * t6 * t1671 * t30 * t80 + 0.2e1 / 0.5e1 * t1563 - t1437 / 0.5e1 + 0.8e1 / 0.45e2 * t1289 - t1162 - 0.8e1 / 0.405e3 * t1573 - 0.4e1 / 0.135e3 * t1680 * t780 + 0.22e2 / 0.135e3 * t770 * t773 * t775 / t1683;
  t1691 = my_piecewise3(t57, 0, t1645 + t1689);
  tv4rho44 = 0.4e1 * t769 + 0.4e1 * t825 + t7 * (t1607 + t1691);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1699 = t515 * t398;
  t1701 = t218 * t856;
  t1712 = t525 * t402;
  t1714 = t525 * t398;
  t1719 = t1005 * t174 / 0.54e3;
  t1720 = t515 * t402;
  t1729 = t218 * t852;
  t1733 = t1111 * t847;
  t1742 = t999 * t174;
  t1748 = t1040 * t174;
  t1750 = -0.77e2 / 0.27e3 * t104 * t107 * t172 * t475 - t1699 / 0.108e4 + 0.11e2 / 0.9e2 * t1701 + t1045 * t1049 / t41 / t467 / t438 * t465 * t32 * t37 / 0.81e3 - t1712 / 0.15e2 + t1714 / 0.18e3 + 0.11e2 / 0.6e2 * t208 * t856 + t1719 + t1720 / 0.9e2 + 0.341e3 / 0.324e4 * t104 * t226 * t228 * t485 * sigma[0] - 0.3e1 / 0.8e2 * t208 * t852 - t1729 / 0.4e2 + t1108 * t847 / 0.12e3 + t1733 / 0.18e3 - 0.19e2 / 0.36e3 * t460 * t463 * t464 * t469 * t229 + t1033 * t174 / 0.16e3 + t1742 / 0.8e2 - t521 * t402 / 0.2e2 + t521 * t398 / 0.24e3 - t1748 / 0.24e3;
  t1751 = my_piecewise3(t1, 0, t1750);
  tv4rho3sigma0 = t7 * t1751 + 0.3e1 * t860;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1756 = t1299 * t179;
  t1758 = t1303 * t179;
  t1761 = t1307 * t179 / 0.54e3;
  t1763 = my_piecewise3(t57, 0, t1295 * t179 / 0.16e3 + t1756 / 0.8e2 - t1758 / 0.24e3 + t1761);
  tv4rho3sigma2 = t7 * t1763 + 0.3e1 * t870;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1765 = 0.2e1 * t884;
  t1767 = t613 * t402 / 0.45e2;
  t1769 = t613 * t398 / 0.54e3;
  t1773 = t1182 * t174 / 0.12e3;
  t1778 = t1172 * t174;
  t1795 = -t1767 + t1769 + 0.11e2 / 0.18e3 * t291 * t856 + t1773 - t605 * t402 / 0.3e2 + t605 * t398 / 0.36e3 - t1778 / 0.72e3 - t1699 / 0.162e4 + 0.11e2 / 0.27e3 * t1701 - t1712 / 0.45e2 + t1714 / 0.54e3 + t1719 + t1720 / 0.135e3 - t291 * t852 / 0.8e2 - t1729 / 0.12e3 + t1733 / 0.54e3 + t1247 * t847 / 0.36e3 + t1178 * t174 / 0.16e3 + t1742 / 0.24e3 - t1748 / 0.36e3;
  t1796 = my_piecewise3(t1, 0, t1795);
  tv4rho3sigma3 = t7 * t1796 + t1765 + t860;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1798 = 0.2e1 * t900;
  t1802 = t1394 * t179 / 0.12e3;
  t1803 = t1398 * t179;
  t1810 = t661 * t427 / 0.54e3;
  t1811 = t665 * t427;
  t1816 = t661 * t431 / 0.45e2;
  t1817 = t665 * t431;
  t1819 = t1453 * t179 / 0.16e3 + t1802 - t1803 / 0.72e3 + t1756 / 0.24e3 - t1758 / 0.36e3 + t1761 + t657 * t427 / 0.72e3 + t1810 - t1811 / 0.324e4 - t657 * t431 / 0.6e2 - t1816 + t1817 / 0.27e3;
  t1820 = my_piecewise3(t57, 0, t1819);
  tv4rho3sigma5 = t7 * t1820 + t1798 + t870;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t1824 = t1372 * t174;
  t1834 = t1368 * t174 / 0.16e3 + t1824 / 0.24e3 + t695 * t398 / 0.72e3 - t695 * t402 / 0.6e2 + t1773 - t1778 / 0.36e3 + t1769 - t1767 - t1748 / 0.72e3 + t1719 - t1699 / 0.324e4 + t1720 / 0.27e3;
  t1835 = my_piecewise3(t1, 0, t1834);
  tv4rho3sigma6 = t7 * t1835 + t1765 + t907;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t1839 = t1507 * t179;
  t1844 = t731 * t427;
  t1848 = t731 * t431;
  t1855 = t1572 * t923;
  t1859 = t320 * t928;
  t1863 = t320 * t932;
  t1865 = t1519 * t179 / 0.16e3 + t1839 / 0.24e3 + t1802 - t1803 / 0.36e3 + t727 * t427 / 0.36e3 + t1844 / 0.54e3 - t727 * t431 / 0.3e2 - t1848 / 0.45e2 - t1758 / 0.72e3 + t1761 + t1810 - t1811 / 0.162e4 - t1816 + t1817 / 0.135e3 + t1569 * t923 / 0.36e3 + t1855 / 0.54e3 - t316 * t928 / 0.8e2 - t1859 / 0.12e3 + 0.11e2 / 0.18e3 * t316 * t932 + 0.11e2 / 0.27e3 * t1863;
  t1866 = my_piecewise3(t57, 0, t1865);
  tv4rho3sigma8 = t7 * t1866 + t1798 + t936;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t1874 = my_piecewise3(t1, 0, t1493 * t174 / 0.16e3 + t1824 / 0.8e2 - t1778 / 0.24e3 + t1719);
  tv4rho3sigma9 = t7 * t1874 + 0.3e1 * t907;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t1921 = -0.77e2 / 0.27e3 * t156 * t159 * t172 * t784 + t1616 * t1619 / t69 / t776 / t446 * t774 * t32 * t37 / 0.81e3 + 0.11e2 / 0.6e2 * t361 * t932 - t819 * t431 / 0.2e2 + t819 * t427 / 0.24e3 + 0.11e2 / 0.9e2 * t1863 - t1848 / 0.15e2 + t1817 / 0.9e2 + t1839 / 0.8e2 - t1803 / 0.24e3 + t1761 + 0.341e3 / 0.324e4 * t156 * t368 * t228 * t790 * sigma[2] - 0.3e1 / 0.8e2 * t361 * t928 + t1844 / 0.18e3 - t1859 / 0.4e2 - t1811 / 0.108e4 + t1680 * t923 / 0.12e3 - 0.19e2 / 0.36e3 * t770 * t773 * t464 * t778 * t369 + t1611 * t179 / 0.16e3 + t1855 / 0.18e3;
  t1922 = my_piecewise3(t57, 0, t1921);
  tv4rho3sigma11 = t7 * t1922 + 0.3e1 * t936;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t1927 = t525 * t442;
  t1934 = t515 * t442 / 0.864e4;
  t1935 = t1111 * t946;
  t1937 = t218 * t950;
  t1956 = my_piecewise3(t1, 0, -t521 * t442 / 0.192e4 - t1927 / 0.144e4 - t1108 * t946 / 0.48e3 + t208 * t950 / 0.18e3 + t1934 - t1935 / 0.72e3 + t1937 / 0.27e3 - t1045 * t1049 / t41 / t1114 * t229 * t32 * t37 / 0.216e4 + 0.43e2 / 0.288e4 * t460 * t463 * t845 * sigma[0] - 0.19e2 / 0.108e4 * t104 * t224 * t437 * t234);
  tv4rho2sigma20 = t7 * t1956 + 0.2e1 * t954;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t1961 = t661 * t450;
  t1964 = t665 * t450 / 0.864e4;
  t1966 = my_piecewise3(t57, 0, -t657 * t450 / 0.192e4 - t1961 / 0.144e4 + t1964);
  tv4rho2sigma25 = t7 * t1966 + 0.2e1 * t961;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t1970 = t613 * t442;
  t1980 = my_piecewise3(t1, 0, -t605 * t442 / 0.192e4 - t1970 / 0.288e4 - t1247 * t946 / 0.96e3 + t291 * t950 / 0.36e3 - t1927 / 0.288e4 + t1934 - t1935 / 0.144e4 + t1937 / 0.54e3);
  tv4rho2sigma26 = t7 * t1980 + t954 + t966;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t1984 = t731 * t450;
  t1989 = t1572 * t974;
  t1993 = t320 * t978;
  t1996 = my_piecewise3(t57, 0, -t727 * t450 / 0.192e4 - t1984 / 0.288e4 - t1961 / 0.288e4 + t1964 - t1569 * t974 / 0.96e3 - t1989 / 0.144e4 + t316 * t978 / 0.36e3 + t1993 / 0.54e3);
  tv4rho2sigma211 = t7 * t1996 + t961 + t982;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2003 = my_piecewise3(t1, 0, -t695 * t442 / 0.192e4 - t1970 / 0.144e4 + t1934);
  tv4rho2sigma212 = t7 * t2003 + 0.2e1 * t966;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2032 = my_piecewise3(t57, 0, -t819 * t450 / 0.192e4 - t1984 / 0.144e4 - t1680 * t974 / 0.48e3 + t361 * t978 / 0.18e3 + t1964 - t1989 / 0.72e3 + t1993 / 0.27e3 - t1616 * t1619 / t69 / t1683 * t369 * t32 * t37 / 0.216e4 + 0.43e2 / 0.288e4 * t770 * t773 * t921 * sigma[2] - 0.19e2 / 0.108e4 * t156 * t367 * t437 * t374);
  tv4rho2sigma217 = t7 * t2032 + 0.2e1 * t982;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2037 = t1111 * t986 / 0.384e4;
  t2049 = my_piecewise3(t1, 0, t1108 * t986 / 0.256e4 + t2037 + t1045 * t1049 / t41 / t468 * t172 * sigma[0] / 0.576e4 - t460 * t463 * t944 / 0.32e3);
  tv4rhosigma30 = t7 * t2049 + t989;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2054 = t1572 * t992 / 0.384e4;
  t2056 = my_piecewise3(t57, 0, t1569 * t992 / 0.256e4 + t2054);
  tv4rhosigma39 = t7 * t2056 + t995;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2061 = my_piecewise3(t1, 0, t1247 * t986 / 0.256e4 + t2037);
  tv4rhosigma310 = t7 * t2061 + t989;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2076 = my_piecewise3(t57, 0, t1680 * t992 / 0.256e4 + t2054 + t1616 * t1619 / t69 / t777 * t172 * sigma[2] / 0.576e4 - t770 * t773 * t972 / 0.32e3);
  tv4rhosigma319 = t7 * t2076 + t995;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2085 = my_piecewise3(t1, 0, -t1045 * t1049 / t41 / t843 * t32 * t37 / 0.1536e5);
  tv4sigma40 = t7 * t2085;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2093 = my_piecewise3(t57, 0, -t1616 * t1619 / t69 / t919 * t32 * t37 / 0.1536e5);
  tv4sigma414 = t7 * t2093;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

