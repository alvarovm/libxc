/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_k_lkt.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t34, t37, t38, t39, t40, t41, t42;
  double t43, t45, t46, t47, t48, t50, t54, t58;
  double tzk0;

  gga_k_lkt_params *params;

  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_CBRT6;
  t25 = t24 * t24;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t29 = t25 / t27;
  t30 = sqrt(sigma[0]);
  t31 = M_CBRT2;
  t32 = t30 * t31;
  t34 = 0.1e1 / t21 / rho[0];
  t37 = t29 * t32 * t34 / 0.12e2;
  t38 = t37 < 0.2e3;
  t39 = my_piecewise3(t38, t37, 200);
  t40 = params->a * t39;
  t41 = cosh(t40);
  t42 = 0.1e1 / t41;
  t43 = t27 * t27;
  t45 = t24 / t43;
  t46 = t31 * t31;
  t47 = sigma[0] * t46;
  t48 = rho[0] * rho[0];
  t50 = 0.1e1 / t22 / t48;
  t54 = t42 + 0.5e1 / 0.72e2 * t45 * t47 * t50;
  t58 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t54);
  tzk0 = 0.2e1 * t58;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t34, t37, t38, t39, t40, t41, t42;
  double t43, t45, t46, t47, t48, t50, t54, t58;
  double tzk0;

  double t60, t64, t65, t66, t68, t72, t73, t74;
  double t76, t78, t82, t87, tvrho0, t91, t95, t96;
  double t101, t105, tvsigma0;

  gga_k_lkt_params *params;

  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_CBRT6;
  t25 = t24 * t24;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t29 = t25 / t27;
  t30 = sqrt(sigma[0]);
  t31 = M_CBRT2;
  t32 = t30 * t31;
  t34 = 0.1e1 / t21 / rho[0];
  t37 = t29 * t32 * t34 / 0.12e2;
  t38 = t37 < 0.2e3;
  t39 = my_piecewise3(t38, t37, 200);
  t40 = params->a * t39;
  t41 = cosh(t40);
  t42 = 0.1e1 / t41;
  t43 = t27 * t27;
  t45 = t24 / t43;
  t46 = t31 * t31;
  t47 = sigma[0] * t46;
  t48 = rho[0] * rho[0];
  t50 = 0.1e1 / t22 / t48;
  t54 = t42 + 0.5e1 / 0.72e2 * t45 * t47 * t50;
  t58 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t54);
  tzk0 = 0.2e1 * t58;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t60 = t20 / t21;
  t64 = t41 * t41;
  t65 = 0.1e1 / t64;
  t66 = t65 * params->a;
  t68 = 0.1e1 / t21 / t48;
  t72 = my_piecewise3(t38, -t29 * t32 * t68 / 0.9e1, 0);
  t73 = sinh(t40);
  t74 = t72 * t73;
  t76 = t48 * rho[0];
  t78 = 0.1e1 / t22 / t76;
  t82 = -t66 * t74 - 0.5e1 / 0.27e2 * t45 * t47 * t78;
  t87 = my_piecewise3(t2, 0, t7 * t60 * t54 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t82);
  tvrho0 = 0.2e1 * rho[0] * t87 + 0.2e1 * t58;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t91 = 0.1e1 / t30 * t31;
  t95 = my_piecewise3(t38, t29 * t91 * t34 / 0.24e2, 0);
  t96 = t95 * t73;
  t101 = -t66 * t96 + 0.5e1 / 0.72e2 * t45 * t46 * t50;
  t105 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t101);
  tvsigma0 = 0.2e1 * rho[0] * t105;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t34, t37, t38, t39, t40, t41, t42;
  double t43, t45, t46, t47, t48, t50, t54, t58;
  double tzk0;

  double t60, t64, t65, t66, t68, t72, t73, t74;
  double t76, t78, t82, t87, tvrho0, t91, t95, t96;
  double t101, t105, tvsigma0;

  double t108, t116, t117, t118, t119, t120, t125, t129;
  double t132, t134, t136, t140, t145, tv2rho20, t151, t158;
  double t159, t166, t171, tv2rhosigma0, t174, t175, t180, t184;
  double t185, t188, t192, tv2sigma20;

  gga_k_lkt_params *params;

  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_CBRT6;
  t25 = t24 * t24;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t29 = t25 / t27;
  t30 = sqrt(sigma[0]);
  t31 = M_CBRT2;
  t32 = t30 * t31;
  t34 = 0.1e1 / t21 / rho[0];
  t37 = t29 * t32 * t34 / 0.12e2;
  t38 = t37 < 0.2e3;
  t39 = my_piecewise3(t38, t37, 200);
  t40 = params->a * t39;
  t41 = cosh(t40);
  t42 = 0.1e1 / t41;
  t43 = t27 * t27;
  t45 = t24 / t43;
  t46 = t31 * t31;
  t47 = sigma[0] * t46;
  t48 = rho[0] * rho[0];
  t50 = 0.1e1 / t22 / t48;
  t54 = t42 + 0.5e1 / 0.72e2 * t45 * t47 * t50;
  t58 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t54);
  tzk0 = 0.2e1 * t58;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t60 = t20 / t21;
  t64 = t41 * t41;
  t65 = 0.1e1 / t64;
  t66 = t65 * params->a;
  t68 = 0.1e1 / t21 / t48;
  t72 = my_piecewise3(t38, -t29 * t32 * t68 / 0.9e1, 0);
  t73 = sinh(t40);
  t74 = t72 * t73;
  t76 = t48 * rho[0];
  t78 = 0.1e1 / t22 / t76;
  t82 = -t66 * t74 - 0.5e1 / 0.27e2 * t45 * t47 * t78;
  t87 = my_piecewise3(t2, 0, t7 * t60 * t54 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t82);
  tvrho0 = 0.2e1 * rho[0] * t87 + 0.2e1 * t58;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t91 = 0.1e1 / t30 * t31;
  t95 = my_piecewise3(t38, t29 * t91 * t34 / 0.24e2, 0);
  t96 = t95 * t73;
  t101 = -t66 * t96 + 0.5e1 / 0.72e2 * t45 * t46 * t50;
  t105 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t101);
  tvsigma0 = 0.2e1 * rho[0] * t105;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t108 = t20 * t34;
  t116 = 0.1e1 / t64 / t41;
  t117 = params->a * params->a;
  t118 = t116 * t117;
  t119 = t72 * t72;
  t120 = t73 * t73;
  t125 = 0.1e1 / t21 / t76;
  t129 = my_piecewise3(t38, 0.7e1 / 0.27e2 * t29 * t32 * t125, 0);
  t132 = t42 * t117;
  t134 = t48 * t48;
  t136 = 0.1e1 / t22 / t134;
  t140 = 0.2e1 * t118 * t119 * t120 - t66 * t129 * t73 - t132 * t119 + 0.55e2 / 0.81e2 * t45 * t47 * t136;
  t145 = my_piecewise3(t2, 0, -t7 * t108 * t54 / 0.3e2 + t7 * t60 * t82 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t140);
  tv2rho20 = 0.2e1 * rho[0] * t145 + 0.4e1 * t87;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t151 = t95 * t120;
  t158 = my_piecewise3(t38, -t29 * t91 * t68 / 0.18e2, 0);
  t159 = t158 * t73;
  t166 = 0.2e1 * t118 * t151 * t72 - t66 * t159 - t132 * t95 * t72 - 0.5e1 / 0.27e2 * t45 * t46 * t78;
  t171 = my_piecewise3(t2, 0, t7 * t60 * t101 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t166);
  tv2rhosigma0 = 0.2e1 * rho[0] * t171 + 0.2e1 * t105;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t174 = t95 * t95;
  t175 = t174 * t120;
  t180 = 0.1e1 / t30 / sigma[0] * t31;
  t184 = my_piecewise3(t38, -t29 * t180 * t34 / 0.48e2, 0);
  t185 = t184 * t73;
  t188 = 0.2e1 * t118 * t175 - t132 * t174 - t66 * t185;
  t192 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t188);
  tv2sigma20 = 0.2e1 * rho[0] * t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t34, t37, t38, t39, t40, t41, t42;
  double t43, t45, t46, t47, t48, t50, t54, t58;
  double tzk0;

  double t60, t64, t65, t66, t68, t72, t73, t74;
  double t76, t78, t82, t87, tvrho0, t91, t95, t96;
  double t101, t105, tvsigma0;

  double t108, t116, t117, t118, t119, t120, t125, t129;
  double t132, t134, t136, t140, t145, tv2rho20, t151, t158;
  double t159, t166, t171, tv2rhosigma0, t174, t175, t180, t184;
  double t185, t188, t192, tv2sigma20;

  double t195, t205, t207, t208, t209, t210, t214, t218;
  double t223, t227, t233, t235, t239, t244, tv3rho30, t258;
  double t271, t282, t287, tv3rho2sigma0, t293, t300, t304, t311;
  double t319, t324, tv3rhosigma20, t327, t337, t340, t344, t350;
  double t354, tv3sigma30;

  gga_k_lkt_params *params;

  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_CBRT6;
  t25 = t24 * t24;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t29 = t25 / t27;
  t30 = sqrt(sigma[0]);
  t31 = M_CBRT2;
  t32 = t30 * t31;
  t34 = 0.1e1 / t21 / rho[0];
  t37 = t29 * t32 * t34 / 0.12e2;
  t38 = t37 < 0.2e3;
  t39 = my_piecewise3(t38, t37, 200);
  t40 = params->a * t39;
  t41 = cosh(t40);
  t42 = 0.1e1 / t41;
  t43 = t27 * t27;
  t45 = t24 / t43;
  t46 = t31 * t31;
  t47 = sigma[0] * t46;
  t48 = rho[0] * rho[0];
  t50 = 0.1e1 / t22 / t48;
  t54 = t42 + 0.5e1 / 0.72e2 * t45 * t47 * t50;
  t58 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t54);
  tzk0 = 0.2e1 * t58;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t60 = t20 / t21;
  t64 = t41 * t41;
  t65 = 0.1e1 / t64;
  t66 = t65 * params->a;
  t68 = 0.1e1 / t21 / t48;
  t72 = my_piecewise3(t38, -t29 * t32 * t68 / 0.9e1, 0);
  t73 = sinh(t40);
  t74 = t72 * t73;
  t76 = t48 * rho[0];
  t78 = 0.1e1 / t22 / t76;
  t82 = -t66 * t74 - 0.5e1 / 0.27e2 * t45 * t47 * t78;
  t87 = my_piecewise3(t2, 0, t7 * t60 * t54 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t82);
  tvrho0 = 0.2e1 * rho[0] * t87 + 0.2e1 * t58;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t91 = 0.1e1 / t30 * t31;
  t95 = my_piecewise3(t38, t29 * t91 * t34 / 0.24e2, 0);
  t96 = t95 * t73;
  t101 = -t66 * t96 + 0.5e1 / 0.72e2 * t45 * t46 * t50;
  t105 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t101);
  tvsigma0 = 0.2e1 * rho[0] * t105;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t108 = t20 * t34;
  t116 = 0.1e1 / t64 / t41;
  t117 = params->a * params->a;
  t118 = t116 * t117;
  t119 = t72 * t72;
  t120 = t73 * t73;
  t125 = 0.1e1 / t21 / t76;
  t129 = my_piecewise3(t38, 0.7e1 / 0.27e2 * t29 * t32 * t125, 0);
  t132 = t42 * t117;
  t134 = t48 * t48;
  t136 = 0.1e1 / t22 / t134;
  t140 = 0.2e1 * t118 * t119 * t120 - t66 * t129 * t73 - t132 * t119 + 0.55e2 / 0.81e2 * t45 * t47 * t136;
  t145 = my_piecewise3(t2, 0, -t7 * t108 * t54 / 0.3e2 + t7 * t60 * t82 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t140);
  tv2rho20 = 0.2e1 * rho[0] * t145 + 0.4e1 * t87;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t151 = t95 * t120;
  t158 = my_piecewise3(t38, -t29 * t91 * t68 / 0.18e2, 0);
  t159 = t158 * t73;
  t166 = 0.2e1 * t118 * t151 * t72 - t66 * t159 - t132 * t95 * t72 - 0.5e1 / 0.27e2 * t45 * t46 * t78;
  t171 = my_piecewise3(t2, 0, t7 * t60 * t101 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t166);
  tv2rhosigma0 = 0.2e1 * rho[0] * t171 + 0.2e1 * t105;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t174 = t95 * t95;
  t175 = t174 * t120;
  t180 = 0.1e1 / t30 / sigma[0] * t31;
  t184 = my_piecewise3(t38, -t29 * t180 * t34 / 0.48e2, 0);
  t185 = t184 * t73;
  t188 = 0.2e1 * t118 * t175 - t132 * t174 - t66 * t185;
  t192 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t188);
  tv2sigma20 = 0.2e1 * rho[0] * t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t195 = t20 * t68;
  t205 = t64 * t64;
  t207 = t117 * params->a;
  t208 = 0.1e1 / t205 * t207;
  t209 = t119 * t72;
  t210 = t120 * t73;
  t214 = t72 * t120;
  t218 = t65 * t207;
  t223 = 0.1e1 / t21 / t134;
  t227 = my_piecewise3(t38, -0.7e2 / 0.81e2 * t29 * t32 * t223, 0);
  t233 = t134 * rho[0];
  t235 = 0.1e1 / t22 / t233;
  t239 = -0.6e1 * t208 * t209 * t210 + 0.6e1 * t118 * t214 * t129 + 0.5e1 * t218 * t209 * t73 - t66 * t227 * t73 - 0.3e1 * t132 * t129 * t72 - 0.77e3 / 0.243e3 * t45 * t47 * t235;
  t244 = my_piecewise3(t2, 0, 0.2e1 / 0.45e2 * t7 * t195 * t54 - t7 * t108 * t82 / 0.1e2 + 0.3e1 / 0.1e2 * t7 * t60 * t140 + 0.3e1 / 0.2e2 * t7 * t23 * t239);
  tv3rho30 = 0.2e1 * rho[0] * t244 + 0.6e1 * t145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t258 = t158 * t120;
  t271 = my_piecewise3(t38, 0.7e1 / 0.54e2 * t29 * t91 * t125, 0);
  t282 = -0.6e1 * t208 * t95 * t210 * t119 + 0.4e1 * t118 * t258 * t72 + 0.5e1 * t218 * t96 * t119 + 0.2e1 * t118 * t151 * t129 - t66 * t271 * t73 - 0.2e1 * t132 * t158 * t72 - t132 * t95 * t129 + 0.55e2 / 0.81e2 * t45 * t46 * t136;
  t287 = my_piecewise3(t2, 0, -t7 * t108 * t101 / 0.3e2 + t7 * t60 * t166 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t282);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t287 + 0.4e1 * t171;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t293 = t174 * t210;
  t300 = t174 * t73;
  t304 = t184 * t120;
  t311 = my_piecewise3(t38, t29 * t180 * t68 / 0.36e2, 0);
  t319 = 0.4e1 * t118 * t151 * t158 + 0.2e1 * t118 * t304 * t72 - 0.2e1 * t132 * t95 * t158 - t132 * t184 * t72 - 0.6e1 * t208 * t293 * t72 + 0.5e1 * t218 * t300 * t72 - t66 * t311 * t73;
  t324 = my_piecewise3(t2, 0, t7 * t60 * t188 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t319);
  tv3rhosigma20 = 0.2e1 * rho[0] * t324 + 0.2e1 * t192;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t327 = t174 * t95;
  t337 = sigma[0] * sigma[0];
  t340 = 0.1e1 / t30 / t337 * t31;
  t344 = my_piecewise3(t38, t29 * t340 * t34 / 0.32e2, 0);
  t350 = 0.6e1 * t118 * t151 * t184 - 0.3e1 * t132 * t184 * t95 - 0.6e1 * t208 * t327 * t210 + 0.5e1 * t218 * t327 * t73 - t66 * t344 * t73;
  t354 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t350);
  tv3sigma30 = 0.2e1 * rho[0] * t354;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t23, t24, t25, t26, t27, t29, t30, t31;
  double t32, t34, t37, t38, t39, t40, t41, t42;
  double t43, t45, t46, t47, t48, t50, t54, t58;
  double tzk0;

  double t60, t64, t65, t66, t68, t72, t73, t74;
  double t76, t78, t82, t87, tvrho0, t91, t95, t96;
  double t101, t105, tvsigma0;

  double t108, t116, t117, t118, t119, t120, t125, t129;
  double t132, t134, t136, t140, t145, tv2rho20, t151, t158;
  double t159, t166, t171, tv2rhosigma0, t174, t175, t180, t184;
  double t185, t188, t192, tv2sigma20;

  double t195, t205, t207, t208, t209, t210, t214, t218;
  double t223, t227, t233, t235, t239, t244, tv3rho30, t258;
  double t271, t282, t287, tv3rho2sigma0, t293, t300, t304, t311;
  double t319, t324, tv3rhosigma20, t327, t337, t340, t344, t350;
  double t354, tv3sigma30;

  double t372, t373, t374, t375, t383, t387, t398, t406;
  double t420, t425, tv4rho40, t452, t453, t457, t480, t491;
  double t496, tv4rho3sigma0, t509, t542, t555, t565, t570, tv4rho2sigma20;
  double t612, t623, t628, tv4rhosigma30, t631, t641, t660, t672;
  double tv4sigma40;

  gga_k_lkt_params *params;

  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t23 = t20 * t22;
  t24 = M_CBRT6;
  t25 = t24 * t24;
  t26 = M_PI * M_PI;
  t27 = POW_1_3(t26);
  t29 = t25 / t27;
  t30 = sqrt(sigma[0]);
  t31 = M_CBRT2;
  t32 = t30 * t31;
  t34 = 0.1e1 / t21 / rho[0];
  t37 = t29 * t32 * t34 / 0.12e2;
  t38 = t37 < 0.2e3;
  t39 = my_piecewise3(t38, t37, 200);
  t40 = params->a * t39;
  t41 = cosh(t40);
  t42 = 0.1e1 / t41;
  t43 = t27 * t27;
  t45 = t24 / t43;
  t46 = t31 * t31;
  t47 = sigma[0] * t46;
  t48 = rho[0] * rho[0];
  t50 = 0.1e1 / t22 / t48;
  t54 = t42 + 0.5e1 / 0.72e2 * t45 * t47 * t50;
  t58 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t54);
  tzk0 = 0.2e1 * t58;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t60 = t20 / t21;
  t64 = t41 * t41;
  t65 = 0.1e1 / t64;
  t66 = t65 * params->a;
  t68 = 0.1e1 / t21 / t48;
  t72 = my_piecewise3(t38, -t29 * t32 * t68 / 0.9e1, 0);
  t73 = sinh(t40);
  t74 = t72 * t73;
  t76 = t48 * rho[0];
  t78 = 0.1e1 / t22 / t76;
  t82 = -t66 * t74 - 0.5e1 / 0.27e2 * t45 * t47 * t78;
  t87 = my_piecewise3(t2, 0, t7 * t60 * t54 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t82);
  tvrho0 = 0.2e1 * rho[0] * t87 + 0.2e1 * t58;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t91 = 0.1e1 / t30 * t31;
  t95 = my_piecewise3(t38, t29 * t91 * t34 / 0.24e2, 0);
  t96 = t95 * t73;
  t101 = -t66 * t96 + 0.5e1 / 0.72e2 * t45 * t46 * t50;
  t105 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t101);
  tvsigma0 = 0.2e1 * rho[0] * t105;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t108 = t20 * t34;
  t116 = 0.1e1 / t64 / t41;
  t117 = params->a * params->a;
  t118 = t116 * t117;
  t119 = t72 * t72;
  t120 = t73 * t73;
  t125 = 0.1e1 / t21 / t76;
  t129 = my_piecewise3(t38, 0.7e1 / 0.27e2 * t29 * t32 * t125, 0);
  t132 = t42 * t117;
  t134 = t48 * t48;
  t136 = 0.1e1 / t22 / t134;
  t140 = 0.2e1 * t118 * t119 * t120 - t66 * t129 * t73 - t132 * t119 + 0.55e2 / 0.81e2 * t45 * t47 * t136;
  t145 = my_piecewise3(t2, 0, -t7 * t108 * t54 / 0.3e2 + t7 * t60 * t82 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t140);
  tv2rho20 = 0.2e1 * rho[0] * t145 + 0.4e1 * t87;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t151 = t95 * t120;
  t158 = my_piecewise3(t38, -t29 * t91 * t68 / 0.18e2, 0);
  t159 = t158 * t73;
  t166 = 0.2e1 * t118 * t151 * t72 - t66 * t159 - t132 * t95 * t72 - 0.5e1 / 0.27e2 * t45 * t46 * t78;
  t171 = my_piecewise3(t2, 0, t7 * t60 * t101 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t166);
  tv2rhosigma0 = 0.2e1 * rho[0] * t171 + 0.2e1 * t105;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t174 = t95 * t95;
  t175 = t174 * t120;
  t180 = 0.1e1 / t30 / sigma[0] * t31;
  t184 = my_piecewise3(t38, -t29 * t180 * t34 / 0.48e2, 0);
  t185 = t184 * t73;
  t188 = 0.2e1 * t118 * t175 - t132 * t174 - t66 * t185;
  t192 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t188);
  tv2sigma20 = 0.2e1 * rho[0] * t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t195 = t20 * t68;
  t205 = t64 * t64;
  t207 = t117 * params->a;
  t208 = 0.1e1 / t205 * t207;
  t209 = t119 * t72;
  t210 = t120 * t73;
  t214 = t72 * t120;
  t218 = t65 * t207;
  t223 = 0.1e1 / t21 / t134;
  t227 = my_piecewise3(t38, -0.7e2 / 0.81e2 * t29 * t32 * t223, 0);
  t233 = t134 * rho[0];
  t235 = 0.1e1 / t22 / t233;
  t239 = -0.6e1 * t208 * t209 * t210 + 0.6e1 * t118 * t214 * t129 + 0.5e1 * t218 * t209 * t73 - t66 * t227 * t73 - 0.3e1 * t132 * t129 * t72 - 0.77e3 / 0.243e3 * t45 * t47 * t235;
  t244 = my_piecewise3(t2, 0, 0.2e1 / 0.45e2 * t7 * t195 * t54 - t7 * t108 * t82 / 0.1e2 + 0.3e1 / 0.1e2 * t7 * t60 * t140 + 0.3e1 / 0.2e2 * t7 * t23 * t239);
  tv3rho30 = 0.2e1 * rho[0] * t244 + 0.6e1 * t145;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t258 = t158 * t120;
  t271 = my_piecewise3(t38, 0.7e1 / 0.54e2 * t29 * t91 * t125, 0);
  t282 = -0.6e1 * t208 * t95 * t210 * t119 + 0.4e1 * t118 * t258 * t72 + 0.5e1 * t218 * t96 * t119 + 0.2e1 * t118 * t151 * t129 - t66 * t271 * t73 - 0.2e1 * t132 * t158 * t72 - t132 * t95 * t129 + 0.55e2 / 0.81e2 * t45 * t46 * t136;
  t287 = my_piecewise3(t2, 0, -t7 * t108 * t101 / 0.3e2 + t7 * t60 * t166 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t282);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t287 + 0.4e1 * t171;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t293 = t174 * t210;
  t300 = t174 * t73;
  t304 = t184 * t120;
  t311 = my_piecewise3(t38, t29 * t180 * t68 / 0.36e2, 0);
  t319 = 0.4e1 * t118 * t151 * t158 + 0.2e1 * t118 * t304 * t72 - 0.2e1 * t132 * t95 * t158 - t132 * t184 * t72 - 0.6e1 * t208 * t293 * t72 + 0.5e1 * t218 * t300 * t72 - t66 * t311 * t73;
  t324 = my_piecewise3(t2, 0, t7 * t60 * t188 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t319);
  tv3rhosigma20 = 0.2e1 * rho[0] * t324 + 0.2e1 * t192;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t327 = t174 * t95;
  t337 = sigma[0] * sigma[0];
  t340 = 0.1e1 / t30 / t337 * t31;
  t344 = my_piecewise3(t38, t29 * t340 * t34 / 0.32e2, 0);
  t350 = 0.6e1 * t118 * t151 * t184 - 0.3e1 * t132 * t184 * t95 - 0.6e1 * t208 * t327 * t210 + 0.5e1 * t218 * t327 * t73 - t66 * t344 * t73;
  t354 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * t350);
  tv3sigma30 = 0.2e1 * rho[0] * t354;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t372 = t117 * t117;
  t373 = 0.1e1 / t205 / t41 * t372;
  t374 = t119 * t119;
  t375 = t120 * t120;
  t383 = t116 * t372;
  t387 = t129 * t129;
  t398 = t42 * t372;
  t406 = my_piecewise3(t38, 0.91e3 / 0.243e3 * t29 * t32 / t21 / t233, 0);
  t420 = 0.24e2 * t373 * t374 * t375 - 0.36e2 * t208 * t119 * t210 * t129 - 0.28e2 * t383 * t374 * t120 + 0.6e1 * t118 * t387 * t120 + 0.3e2 * t218 * t119 * t73 * t129 + 0.8e1 * t118 * t214 * t227 + 0.5e1 * t398 * t374 - t66 * t406 * t73 - 0.4e1 * t132 * t227 * t72 - 0.3e1 * t132 * t387 + 0.1309e5 / 0.729e3 * t45 * t47 / t22 / t134 / t48;
  t425 = my_piecewise3(t2, 0, -0.14e2 / 0.135e3 * t7 * t20 * t125 * t54 + 0.8e1 / 0.45e2 * t7 * t195 * t82 - t7 * t108 * t140 / 0.5e1 + 0.2e1 / 0.5e1 * t7 * t60 * t239 + 0.3e1 / 0.2e2 * t7 * t23 * t420);
  tv4rho40 = 0.2e1 * rho[0] * t425 + 0.8e1 * t244;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t452 = t208 * t95;
  t453 = t210 * t72;
  t457 = t218 * t95;
  t480 = my_piecewise3(t38, -0.35e2 / 0.81e2 * t29 * t91 * t223, 0);
  t491 = -0.18e2 * t208 * t158 * t210 * t119 + 0.6e1 * t118 * t271 * t120 * t72 + 0.6e1 * t118 * t258 * t129 + 0.2e1 * t118 * t151 * t227 - 0.18e2 * t452 * t453 * t129 + 0.15e2 * t457 * t74 * t129 - 0.3e1 * t132 * t271 * t72 + 0.24e2 * t373 * t95 * t375 * t209 - 0.28e2 * t383 * t151 * t209 + 0.15e2 * t218 * t159 * t119 + 0.5e1 * t398 * t95 * t209 - t66 * t480 * t73 - 0.3e1 * t132 * t158 * t129 - t132 * t95 * t227 - 0.77e3 / 0.243e3 * t45 * t46 * t235;
  t496 = my_piecewise3(t2, 0, 0.2e1 / 0.45e2 * t7 * t195 * t101 - t7 * t108 * t166 / 0.1e2 + 0.3e1 / 0.1e2 * t7 * t60 * t282 + 0.3e1 / 0.2e2 * t7 * t23 * t491);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t496 + 0.6e1 * t287;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t509 = t158 * t158;
  t542 = t184 * t210;
  t555 = my_piecewise3(t38, -0.7e1 / 0.108e3 * t29 * t180 * t125, 0);
  t565 = -0.6e1 * t208 * t293 * t129 + 0.4e1 * t118 * t509 * t120 + 0.4e1 * t118 * t151 * t271 + 0.5e1 * t218 * t300 * t129 + 0.4e1 * t118 * t311 * t120 * t72 + 0.2e1 * t118 * t304 * t129 - 0.24e2 * t452 * t453 * t158 - 0.2e1 * t132 * t311 * t72 + 0.24e2 * t373 * t174 * t375 * t119 - 0.28e2 * t383 * t175 * t119 + 0.2e2 * t457 * t159 * t72 - 0.6e1 * t208 * t542 * t119 + 0.5e1 * t218 * t185 * t119 + 0.5e1 * t398 * t174 * t119 - t66 * t555 * t73 - t132 * t184 * t129 - 0.2e1 * t132 * t509 - 0.2e1 * t132 * t95 * t271;
  t570 = my_piecewise3(t2, 0, -t7 * t108 * t188 / 0.3e2 + t7 * t60 * t319 / 0.5e1 + 0.3e1 / 0.2e2 * t7 * t23 * t565);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t570 + 0.4e1 * t324;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t612 = my_piecewise3(t38, -t29 * t340 * t68 / 0.24e2, 0);
  t623 = 0.2e1 * t118 * t344 * t120 * t72 - 0.28e2 * t383 * t327 * t120 * t72 + 0.24e2 * t373 * t327 * t375 * t72 + 0.6e1 * t118 * t151 * t311 + 0.6e1 * t118 * t258 * t184 - 0.3e1 * t132 * t184 * t158 - 0.3e1 * t132 * t311 * t95 - t132 * t344 * t72 - 0.18e2 * t208 * t293 * t158 + 0.15e2 * t218 * t300 * t158 + 0.15e2 * t457 * t185 * t72 + 0.5e1 * t398 * t327 * t72 - 0.18e2 * t452 * t542 * t72 - t66 * t612 * t73;
  t628 = my_piecewise3(t2, 0, t7 * t60 * t350 / 0.1e2 + 0.3e1 / 0.2e2 * t7 * t23 * t623);
  tv4rhosigma30 = 0.2e1 * rho[0] * t628 + 0.2e1 * t354;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t631 = t174 * t174;
  t641 = t184 * t184;
  t660 = my_piecewise3(t38, -0.5e1 / 0.64e2 * t29 / t30 / t337 / sigma[0] * t31 * t34, 0);
  t672 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t23 * (0.6e1 * t118 * t641 * t120 + 0.8e1 * t118 * t151 * t344 - 0.28e2 * t383 * t631 * t120 - 0.4e1 * t132 * t344 * t95 - 0.36e2 * t208 * t293 * t184 + 0.3e2 * t218 * t300 * t184 + 0.24e2 * t373 * t631 * t375 - t66 * t660 * t73 - 0.3e1 * t132 * t641 + 0.5e1 * t398 * t631));
  tv4sigma40 = 0.2e1 * rho[0] * t672;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t39;
  double t41, t44, t45, t46, t47, t48, t49, t50;
  double t52, t53, t54, t56, t60, t64, t65, t66;
  double t67, t68, t69, t70, t72, t73, t74, t75;
  double t77, t80, t81, t82, t83, t84, t85, t86;
  double t87, t89, t93, t97, tzk0;

  gga_k_lkt_params *params;

  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = t32 * t32;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t37 = t33 / t35;
  t38 = sqrt(sigma[0]);
  t39 = POW_1_3(rho[0]);
  t41 = 0.1e1 / t39 / rho[0];
  t44 = t37 * t38 * t41 / 0.12e2;
  t45 = t44 < 0.2e3;
  t46 = my_piecewise3(t45, t44, 200);
  t47 = params->a * t46;
  t48 = cosh(t47);
  t49 = 0.1e1 / t48;
  t50 = t35 * t35;
  t52 = t32 / t50;
  t53 = rho[0] * rho[0];
  t54 = t39 * t39;
  t56 = 0.1e1 / t54 / t53;
  t60 = t49 + 0.5e1 / 0.72e2 * t52 * sigma[0] * t56;
  t64 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t60);
  t65 = rho[1] <= p->dens_threshold;
  t66 = my_piecewise5(t15, t12, t11, t16, -t18);
  t67 = 0.1e1 + t66;
  t68 = t67 <= p->zeta_threshold;
  t69 = POW_1_3(t67);
  t70 = t69 * t69;
  t72 = my_piecewise3(t68, t24, t70 * t67);
  t73 = t72 * t30;
  t74 = sqrt(sigma[2]);
  t75 = POW_1_3(rho[1]);
  t77 = 0.1e1 / t75 / rho[1];
  t80 = t37 * t74 * t77 / 0.12e2;
  t81 = t80 < 0.2e3;
  t82 = my_piecewise3(t81, t80, 200);
  t83 = params->a * t82;
  t84 = cosh(t83);
  t85 = 0.1e1 / t84;
  t86 = rho[1] * rho[1];
  t87 = t75 * t75;
  t89 = 0.1e1 / t87 / t86;
  t93 = t85 + 0.5e1 / 0.72e2 * t52 * sigma[2] * t89;
  t97 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t93);
  tzk0 = t64 + t97;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t39;
  double t41, t44, t45, t46, t47, t48, t49, t50;
  double t52, t53, t54, t56, t60, t64, t65, t66;
  double t67, t68, t69, t70, t72, t73, t74, t75;
  double t77, t80, t81, t82, t83, t84, t85, t86;
  double t87, t89, t93, t97, tzk0;

  double t98, t99, t100, t101, t102, t105, t106, t110;
  double t111, t114, t115, t116, t117, t119, t123, t124;
  double t125, t127, t129, t133, t138, t140, t143, t144;
  double t148, t151, t153, tvrho0, t156, t157, t160, t161;
  double t166, t168, t171, t172, t176, t177, t178, t180;
  double t184, t185, t186, t188, t190, t194, t199, tvrho1;
  double t202, t206, t207, t211, t215, tvsigma0, tvsigma1, t216;
  double t220, t221, t225, t229, tvsigma2;

  gga_k_lkt_params *params;

  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = t32 * t32;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t37 = t33 / t35;
  t38 = sqrt(sigma[0]);
  t39 = POW_1_3(rho[0]);
  t41 = 0.1e1 / t39 / rho[0];
  t44 = t37 * t38 * t41 / 0.12e2;
  t45 = t44 < 0.2e3;
  t46 = my_piecewise3(t45, t44, 200);
  t47 = params->a * t46;
  t48 = cosh(t47);
  t49 = 0.1e1 / t48;
  t50 = t35 * t35;
  t52 = t32 / t50;
  t53 = rho[0] * rho[0];
  t54 = t39 * t39;
  t56 = 0.1e1 / t54 / t53;
  t60 = t49 + 0.5e1 / 0.72e2 * t52 * sigma[0] * t56;
  t64 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t60);
  t65 = rho[1] <= p->dens_threshold;
  t66 = my_piecewise5(t15, t12, t11, t16, -t18);
  t67 = 0.1e1 + t66;
  t68 = t67 <= p->zeta_threshold;
  t69 = POW_1_3(t67);
  t70 = t69 * t69;
  t72 = my_piecewise3(t68, t24, t70 * t67);
  t73 = t72 * t30;
  t74 = sqrt(sigma[2]);
  t75 = POW_1_3(rho[1]);
  t77 = 0.1e1 / t75 / rho[1];
  t80 = t37 * t74 * t77 / 0.12e2;
  t81 = t80 < 0.2e3;
  t82 = my_piecewise3(t81, t80, 200);
  t83 = params->a * t82;
  t84 = cosh(t83);
  t85 = 0.1e1 / t84;
  t86 = rho[1] * rho[1];
  t87 = t75 * t75;
  t89 = 0.1e1 / t87 / t86;
  t93 = t85 + 0.5e1 / 0.72e2 * t52 * sigma[2] * t89;
  t97 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t93);
  tzk0 = t64 + t97;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t98 = t7 * t7;
  t99 = 0.1e1 / t98;
  t100 = t17 * t99;
  t101 = t8 - t100;
  t102 = my_piecewise5(t11, 0, t15, 0, t101);
  t105 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t102);
  t106 = t105 * t30;
  t110 = 0.1e1 / t29;
  t111 = t28 * t110;
  t114 = t6 * t111 * t60 / 0.1e2;
  t115 = t48 * t48;
  t116 = 0.1e1 / t115;
  t117 = t116 * params->a;
  t119 = 0.1e1 / t39 / t53;
  t123 = my_piecewise3(t45, -t37 * t38 * t119 / 0.9e1, 0);
  t124 = sinh(t47);
  t125 = t123 * t124;
  t127 = t53 * rho[0];
  t129 = 0.1e1 / t54 / t127;
  t133 = -t117 * t125 - 0.5e1 / 0.27e2 * t52 * sigma[0] * t129;
  t138 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t106 * t60 + t114 + 0.3e1 / 0.2e2 * t6 * t31 * t133);
  t140 = my_piecewise5(t15, 0, t11, 0, -t101);
  t143 = my_piecewise3(t68, 0, 0.5e1 / 0.3e1 * t70 * t140);
  t144 = t143 * t30;
  t148 = t72 * t110;
  t151 = t6 * t148 * t93 / 0.1e2;
  t153 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t144 * t93 + t151);
  tvrho0 = t64 + t97 + t7 * (t138 + t153);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t156 = -t8 - t100;
  t157 = my_piecewise5(t11, 0, t15, 0, t156);
  t160 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t157);
  t161 = t160 * t30;
  t166 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t161 * t60 + t114);
  t168 = my_piecewise5(t15, 0, t11, 0, -t156);
  t171 = my_piecewise3(t68, 0, 0.5e1 / 0.3e1 * t70 * t168);
  t172 = t171 * t30;
  t176 = t84 * t84;
  t177 = 0.1e1 / t176;
  t178 = t177 * params->a;
  t180 = 0.1e1 / t75 / t86;
  t184 = my_piecewise3(t81, -t37 * t74 * t180 / 0.9e1, 0);
  t185 = sinh(t83);
  t186 = t184 * t185;
  t188 = t86 * rho[1];
  t190 = 0.1e1 / t87 / t188;
  t194 = -t178 * t186 - 0.5e1 / 0.27e2 * t52 * sigma[2] * t190;
  t199 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t172 * t93 + t151 + 0.3e1 / 0.2e2 * t6 * t73 * t194);
  tvrho1 = t64 + t97 + t7 * (t166 + t199);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t202 = 0.1e1 / t38;
  t206 = my_piecewise3(t45, t37 * t202 * t41 / 0.24e2, 0);
  t207 = t206 * t124;
  t211 = -t117 * t207 + 0.5e1 / 0.72e2 * t52 * t56;
  t215 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t211);
  tvsigma0 = t7 * t215;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t216 = 0.1e1 / t74;
  t220 = my_piecewise3(t81, t37 * t216 * t77 / 0.24e2, 0);
  t221 = t220 * t185;
  t225 = -t178 * t221 + 0.5e1 / 0.72e2 * t52 * t89;
  t229 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t225);
  tvsigma2 = t7 * t229;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t39;
  double t41, t44, t45, t46, t47, t48, t49, t50;
  double t52, t53, t54, t56, t60, t64, t65, t66;
  double t67, t68, t69, t70, t72, t73, t74, t75;
  double t77, t80, t81, t82, t83, t84, t85, t86;
  double t87, t89, t93, t97, tzk0;

  double t98, t99, t100, t101, t102, t105, t106, t110;
  double t111, t114, t115, t116, t117, t119, t123, t124;
  double t125, t127, t129, t133, t138, t140, t143, t144;
  double t148, t151, t153, tvrho0, t156, t157, t160, t161;
  double t166, t168, t171, t172, t176, t177, t178, t180;
  double t184, t185, t186, t188, t190, t194, t199, tvrho1;
  double t202, t206, t207, t211, t215, tvsigma0, tvsigma1, t216;
  double t220, t221, t225, t229, tvsigma2;

  double t232, t233, t236, t237, t238, t240, t241, t245;
  double t246, t250, t252, t258, t259, t262, t264, t267;
  double t268, t269, t270, t271, t276, t280, t283, t285;
  double t287, t291, t296, t297, t298, t302, t306, t307;
  double t311, t313, t315, t318, t320, tv2rho20, t323, t326;
  double t327, t331, t332, t336, t338, t346, t347, t350;
  double t354, t355, t359, t361, t368, t371, tv2rho21, t376;
  double t380, t381, t385, t386, t392, t393, t397, t401;
  double t402, t412, t413, t414, t415, t420, t424, t427;
  double t429, t431, t435, t440, tv2rho22, t448, t449, t456;
  double t457, t463, t468, tv2rhosigma0, tv2rhosigma1, t475, t477, tv2rhosigma2;
  double t483, tv2rhosigma3, tv2rhosigma4, t488, t495, t496, t502, t507;
  double tv2rhosigma5, t509, t510, t514, t518, t519, t522, t526;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t527, t528, t532;
  double t536, t537, t540, t544, tv2sigma25;

  gga_k_lkt_params *params;

  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = t32 * t32;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t37 = t33 / t35;
  t38 = sqrt(sigma[0]);
  t39 = POW_1_3(rho[0]);
  t41 = 0.1e1 / t39 / rho[0];
  t44 = t37 * t38 * t41 / 0.12e2;
  t45 = t44 < 0.2e3;
  t46 = my_piecewise3(t45, t44, 200);
  t47 = params->a * t46;
  t48 = cosh(t47);
  t49 = 0.1e1 / t48;
  t50 = t35 * t35;
  t52 = t32 / t50;
  t53 = rho[0] * rho[0];
  t54 = t39 * t39;
  t56 = 0.1e1 / t54 / t53;
  t60 = t49 + 0.5e1 / 0.72e2 * t52 * sigma[0] * t56;
  t64 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t60);
  t65 = rho[1] <= p->dens_threshold;
  t66 = my_piecewise5(t15, t12, t11, t16, -t18);
  t67 = 0.1e1 + t66;
  t68 = t67 <= p->zeta_threshold;
  t69 = POW_1_3(t67);
  t70 = t69 * t69;
  t72 = my_piecewise3(t68, t24, t70 * t67);
  t73 = t72 * t30;
  t74 = sqrt(sigma[2]);
  t75 = POW_1_3(rho[1]);
  t77 = 0.1e1 / t75 / rho[1];
  t80 = t37 * t74 * t77 / 0.12e2;
  t81 = t80 < 0.2e3;
  t82 = my_piecewise3(t81, t80, 200);
  t83 = params->a * t82;
  t84 = cosh(t83);
  t85 = 0.1e1 / t84;
  t86 = rho[1] * rho[1];
  t87 = t75 * t75;
  t89 = 0.1e1 / t87 / t86;
  t93 = t85 + 0.5e1 / 0.72e2 * t52 * sigma[2] * t89;
  t97 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t93);
  tzk0 = t64 + t97;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t98 = t7 * t7;
  t99 = 0.1e1 / t98;
  t100 = t17 * t99;
  t101 = t8 - t100;
  t102 = my_piecewise5(t11, 0, t15, 0, t101);
  t105 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t102);
  t106 = t105 * t30;
  t110 = 0.1e1 / t29;
  t111 = t28 * t110;
  t114 = t6 * t111 * t60 / 0.1e2;
  t115 = t48 * t48;
  t116 = 0.1e1 / t115;
  t117 = t116 * params->a;
  t119 = 0.1e1 / t39 / t53;
  t123 = my_piecewise3(t45, -t37 * t38 * t119 / 0.9e1, 0);
  t124 = sinh(t47);
  t125 = t123 * t124;
  t127 = t53 * rho[0];
  t129 = 0.1e1 / t54 / t127;
  t133 = -t117 * t125 - 0.5e1 / 0.27e2 * t52 * sigma[0] * t129;
  t138 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t106 * t60 + t114 + 0.3e1 / 0.2e2 * t6 * t31 * t133);
  t140 = my_piecewise5(t15, 0, t11, 0, -t101);
  t143 = my_piecewise3(t68, 0, 0.5e1 / 0.3e1 * t70 * t140);
  t144 = t143 * t30;
  t148 = t72 * t110;
  t151 = t6 * t148 * t93 / 0.1e2;
  t153 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t144 * t93 + t151);
  tvrho0 = t64 + t97 + t7 * (t138 + t153);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t156 = -t8 - t100;
  t157 = my_piecewise5(t11, 0, t15, 0, t156);
  t160 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t157);
  t161 = t160 * t30;
  t166 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t161 * t60 + t114);
  t168 = my_piecewise5(t15, 0, t11, 0, -t156);
  t171 = my_piecewise3(t68, 0, 0.5e1 / 0.3e1 * t70 * t168);
  t172 = t171 * t30;
  t176 = t84 * t84;
  t177 = 0.1e1 / t176;
  t178 = t177 * params->a;
  t180 = 0.1e1 / t75 / t86;
  t184 = my_piecewise3(t81, -t37 * t74 * t180 / 0.9e1, 0);
  t185 = sinh(t83);
  t186 = t184 * t185;
  t188 = t86 * rho[1];
  t190 = 0.1e1 / t87 / t188;
  t194 = -t178 * t186 - 0.5e1 / 0.27e2 * t52 * sigma[2] * t190;
  t199 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t172 * t93 + t151 + 0.3e1 / 0.2e2 * t6 * t73 * t194);
  tvrho1 = t64 + t97 + t7 * (t166 + t199);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t202 = 0.1e1 / t38;
  t206 = my_piecewise3(t45, t37 * t202 * t41 / 0.24e2, 0);
  t207 = t206 * t124;
  t211 = -t117 * t207 + 0.5e1 / 0.72e2 * t52 * t56;
  t215 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t211);
  tvsigma0 = t7 * t215;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t216 = 0.1e1 / t74;
  t220 = my_piecewise3(t81, t37 * t216 * t77 / 0.24e2, 0);
  t221 = t220 * t185;
  t225 = -t178 * t221 + 0.5e1 / 0.72e2 * t52 * t89;
  t229 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t225);
  tvsigma2 = t7 * t229;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t232 = 0.1e1 / t25;
  t233 = t102 * t102;
  t236 = t98 * t7;
  t237 = 0.1e1 / t236;
  t238 = t17 * t237;
  t240 = -0.2e1 * t99 + 0.2e1 * t238;
  t241 = my_piecewise5(t11, 0, t15, 0, t240);
  t245 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t232 * t233 + 0.5e1 / 0.3e1 * t26 * t241);
  t246 = t245 * t30;
  t250 = t105 * t110;
  t252 = t6 * t250 * t60;
  t258 = 0.1e1 / t29 / t7;
  t259 = t28 * t258;
  t262 = t6 * t259 * t60 / 0.3e2;
  t264 = t6 * t111 * t133;
  t267 = 0.1e1 / t115 / t48;
  t268 = params->a * params->a;
  t269 = t267 * t268;
  t270 = t123 * t123;
  t271 = t124 * t124;
  t276 = 0.1e1 / t39 / t127;
  t280 = my_piecewise3(t45, 0.7e1 / 0.27e2 * t37 * t38 * t276, 0);
  t283 = t49 * t268;
  t285 = t53 * t53;
  t287 = 0.1e1 / t54 / t285;
  t291 = 0.2e1 * t269 * t270 * t271 - t117 * t280 * t124 - t283 * t270 + 0.55e2 / 0.81e2 * t52 * sigma[0] * t287;
  t296 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t246 * t60 + t252 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t106 * t133 - t262 + t264 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t291);
  t297 = 0.1e1 / t69;
  t298 = t140 * t140;
  t302 = my_piecewise5(t15, 0, t11, 0, -t240);
  t306 = my_piecewise3(t68, 0, 0.1e2 / 0.9e1 * t297 * t298 + 0.5e1 / 0.3e1 * t70 * t302);
  t307 = t306 * t30;
  t311 = t143 * t110;
  t313 = t6 * t311 * t93;
  t315 = t72 * t258;
  t318 = t6 * t315 * t93 / 0.3e2;
  t320 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t307 * t93 + t313 / 0.5e1 - t318);
  tv2rho20 = 0.2e1 * t138 + 0.2e1 * t153 + t7 * (t296 + t320);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t323 = t232 * t157;
  t326 = 0.2e1 * t238;
  t327 = my_piecewise5(t11, 0, t15, 0, t326);
  t331 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t323 * t102 + 0.5e1 / 0.3e1 * t26 * t327);
  t332 = t331 * t30;
  t336 = t160 * t110;
  t338 = t6 * t336 * t60;
  t346 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t332 * t60 + t338 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t161 * t133 + t252 / 0.1e2 - t262 + t264 / 0.1e2);
  t347 = t297 * t168;
  t350 = my_piecewise5(t15, 0, t11, 0, -t326);
  t354 = my_piecewise3(t68, 0, 0.1e2 / 0.9e1 * t347 * t140 + 0.5e1 / 0.3e1 * t70 * t350);
  t355 = t354 * t30;
  t359 = t171 * t110;
  t361 = t6 * t359 * t93;
  t368 = t6 * t148 * t194;
  t371 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t355 * t93 + t361 / 0.1e2 + t313 / 0.1e2 - t318 + 0.3e1 / 0.2e2 * t6 * t144 * t194 + t368 / 0.1e2);
  tv2rho21 = t138 + t153 + t166 + t199 + t7 * (t346 + t371);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t376 = t157 * t157;
  t380 = 0.2e1 * t99 + 0.2e1 * t238;
  t381 = my_piecewise5(t11, 0, t15, 0, t380);
  t385 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t232 * t376 + 0.5e1 / 0.3e1 * t26 * t381);
  t386 = t385 * t30;
  t392 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t386 * t60 + t338 / 0.5e1 - t262);
  t393 = t168 * t168;
  t397 = my_piecewise5(t15, 0, t11, 0, -t380);
  t401 = my_piecewise3(t68, 0, 0.1e2 / 0.9e1 * t297 * t393 + 0.5e1 / 0.3e1 * t70 * t397);
  t402 = t401 * t30;
  t412 = 0.1e1 / t176 / t84;
  t413 = t412 * t268;
  t414 = t184 * t184;
  t415 = t185 * t185;
  t420 = 0.1e1 / t75 / t188;
  t424 = my_piecewise3(t81, 0.7e1 / 0.27e2 * t37 * t74 * t420, 0);
  t427 = t85 * t268;
  t429 = t86 * t86;
  t431 = 0.1e1 / t87 / t429;
  t435 = 0.2e1 * t413 * t414 * t415 - t178 * t424 * t185 - t427 * t414 + 0.55e2 / 0.81e2 * t52 * sigma[2] * t431;
  t440 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t402 * t93 + t361 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t172 * t194 - t318 + t368 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t73 * t435);
  tv2rho22 = 0.2e1 * t166 + 0.2e1 * t199 + t7 * (t392 + t440);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t448 = t6 * t111 * t211 / 0.1e2;
  t449 = t206 * t271;
  t456 = my_piecewise3(t45, -t37 * t202 * t119 / 0.18e2, 0);
  t457 = t456 * t124;
  t463 = 0.2e1 * t269 * t449 * t123 - t117 * t457 - t283 * t206 * t123 - 0.5e1 / 0.27e2 * t52 * t129;
  t468 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t106 * t211 + t448 + 0.3e1 / 0.2e2 * t6 * t31 * t463);
  tv2rhosigma0 = t7 * t468 + t215;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t475 = t6 * t148 * t225 / 0.1e2;
  t477 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t144 * t225 + t475);
  tv2rhosigma2 = t7 * t477 + t229;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t483 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t161 * t211 + t448);
  tv2rhosigma3 = t7 * t483 + t215;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t488 = t220 * t415;
  t495 = my_piecewise3(t81, -t37 * t216 * t180 / 0.18e2, 0);
  t496 = t495 * t185;
  t502 = 0.2e1 * t413 * t488 * t184 - t178 * t496 - t427 * t220 * t184 - 0.5e1 / 0.27e2 * t52 * t190;
  t507 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t172 * t225 + t475 + 0.3e1 / 0.2e2 * t6 * t73 * t502);
  tv2rhosigma5 = t7 * t507 + t229;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t509 = t206 * t206;
  t510 = t509 * t271;
  t514 = 0.1e1 / t38 / sigma[0];
  t518 = my_piecewise3(t45, -t37 * t514 * t41 / 0.48e2, 0);
  t519 = t518 * t124;
  t522 = -t117 * t519 + 0.2e1 * t269 * t510 - t283 * t509;
  t526 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t522);
  tv2sigma20 = t7 * t526;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t527 = t220 * t220;
  t528 = t527 * t415;
  t532 = 0.1e1 / t74 / sigma[2];
  t536 = my_piecewise3(t81, -t37 * t532 * t77 / 0.48e2, 0);
  t537 = t536 * t185;
  t540 = -t178 * t537 + 0.2e1 * t413 * t528 - t427 * t527;
  t544 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t540);
  tv2sigma25 = t7 * t544;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t39;
  double t41, t44, t45, t46, t47, t48, t49, t50;
  double t52, t53, t54, t56, t60, t64, t65, t66;
  double t67, t68, t69, t70, t72, t73, t74, t75;
  double t77, t80, t81, t82, t83, t84, t85, t86;
  double t87, t89, t93, t97, tzk0;

  double t98, t99, t100, t101, t102, t105, t106, t110;
  double t111, t114, t115, t116, t117, t119, t123, t124;
  double t125, t127, t129, t133, t138, t140, t143, t144;
  double t148, t151, t153, tvrho0, t156, t157, t160, t161;
  double t166, t168, t171, t172, t176, t177, t178, t180;
  double t184, t185, t186, t188, t190, t194, t199, tvrho1;
  double t202, t206, t207, t211, t215, tvsigma0, tvsigma1, t216;
  double t220, t221, t225, t229, tvsigma2;

  double t232, t233, t236, t237, t238, t240, t241, t245;
  double t246, t250, t252, t258, t259, t262, t264, t267;
  double t268, t269, t270, t271, t276, t280, t283, t285;
  double t287, t291, t296, t297, t298, t302, t306, t307;
  double t311, t313, t315, t318, t320, tv2rho20, t323, t326;
  double t327, t331, t332, t336, t338, t346, t347, t350;
  double t354, t355, t359, t361, t368, t371, tv2rho21, t376;
  double t380, t381, t385, t386, t392, t393, t397, t401;
  double t402, t412, t413, t414, t415, t420, t424, t427;
  double t429, t431, t435, t440, tv2rho22, t448, t449, t456;
  double t457, t463, t468, tv2rhosigma0, tv2rhosigma1, t475, t477, tv2rhosigma2;
  double t483, tv2rhosigma3, tv2rhosigma4, t488, t495, t496, t502, t507;
  double tv2rhosigma5, t509, t510, t514, t518, t519, t522, t526;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t527, t528, t532;
  double t536, t537, t540, t544, tv2sigma25;

  double t548, t549, t552, t555, t556, t557, t559, t560;
  double t564, t565, t569, t571, t576, t578, t581, t587;
  double t588, t591, t593, t596, t598, t600, t601, t602;
  double t603, t607, t611, t616, t620, t626, t628, t632;
  double t637, t639, t640, t643, t647, t651, t652, t656;
  double t658, t660, t662, t664, t667, t669, tv3rho30, t672;
  double t673, t674, t677, t682, t683, t684, t685, t689;
  double t690, t694, t697, t701, t703, t707, t716, t717;
  double t718, t721, t727, t731, t732, t736, t739, t740;
  double t742, t751, t753, t756, tv3rho31, t759, t764, t767;
  double t768, t772, t773, t777, t779, t788, t789, t794;
  double t798, t802, t803, t807, t809, t816, t824, t826;
  double t827, tv3rho32, t832, t838, t839, t843, t844, t851;
  double t852, t858, t862, t863, t878, t880, t881, t882;
  double t886, t890, t895, t899, t905, t907, t911, t916;
  double tv3rho33, t924, t931, t933, t939, t952, t962, t967;
  double tv3rho2sigma0, tv3rho2sigma1, t974, t978, t980, tv3rho2sigma2, t986, t994;
  double tv3rho2sigma3, tv3rho2sigma4, t1000, t1007, t1010, tv3rho2sigma5, t1018, tv3rho2sigma6;
  double tv3rho2sigma7, t1033, t1046, t1056, t1061, tv3rho2sigma8, t1068, t1069;
  double t1076, t1080, t1087, t1095, t1100, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22;
  double tv3rhosigma23, tv3rhosigma24, t1107, t1109, tv3rhosigma25, t1115, tv3rhosigma26, tv3rhosigma27;
  double tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1120, t1127, t1131, t1138, t1146;
  double t1151, tv3rhosigma211, t1153, t1163, t1165, t1169, t1175, t1179;
  double tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37;
  double tv3sigma38, t1180, t1190, t1192, t1196, t1202, t1206, tv3sigma39;

  gga_k_lkt_params *params;

  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = t32 * t32;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t37 = t33 / t35;
  t38 = sqrt(sigma[0]);
  t39 = POW_1_3(rho[0]);
  t41 = 0.1e1 / t39 / rho[0];
  t44 = t37 * t38 * t41 / 0.12e2;
  t45 = t44 < 0.2e3;
  t46 = my_piecewise3(t45, t44, 200);
  t47 = params->a * t46;
  t48 = cosh(t47);
  t49 = 0.1e1 / t48;
  t50 = t35 * t35;
  t52 = t32 / t50;
  t53 = rho[0] * rho[0];
  t54 = t39 * t39;
  t56 = 0.1e1 / t54 / t53;
  t60 = t49 + 0.5e1 / 0.72e2 * t52 * sigma[0] * t56;
  t64 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t60);
  t65 = rho[1] <= p->dens_threshold;
  t66 = my_piecewise5(t15, t12, t11, t16, -t18);
  t67 = 0.1e1 + t66;
  t68 = t67 <= p->zeta_threshold;
  t69 = POW_1_3(t67);
  t70 = t69 * t69;
  t72 = my_piecewise3(t68, t24, t70 * t67);
  t73 = t72 * t30;
  t74 = sqrt(sigma[2]);
  t75 = POW_1_3(rho[1]);
  t77 = 0.1e1 / t75 / rho[1];
  t80 = t37 * t74 * t77 / 0.12e2;
  t81 = t80 < 0.2e3;
  t82 = my_piecewise3(t81, t80, 200);
  t83 = params->a * t82;
  t84 = cosh(t83);
  t85 = 0.1e1 / t84;
  t86 = rho[1] * rho[1];
  t87 = t75 * t75;
  t89 = 0.1e1 / t87 / t86;
  t93 = t85 + 0.5e1 / 0.72e2 * t52 * sigma[2] * t89;
  t97 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t93);
  tzk0 = t64 + t97;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t98 = t7 * t7;
  t99 = 0.1e1 / t98;
  t100 = t17 * t99;
  t101 = t8 - t100;
  t102 = my_piecewise5(t11, 0, t15, 0, t101);
  t105 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t102);
  t106 = t105 * t30;
  t110 = 0.1e1 / t29;
  t111 = t28 * t110;
  t114 = t6 * t111 * t60 / 0.1e2;
  t115 = t48 * t48;
  t116 = 0.1e1 / t115;
  t117 = t116 * params->a;
  t119 = 0.1e1 / t39 / t53;
  t123 = my_piecewise3(t45, -t37 * t38 * t119 / 0.9e1, 0);
  t124 = sinh(t47);
  t125 = t123 * t124;
  t127 = t53 * rho[0];
  t129 = 0.1e1 / t54 / t127;
  t133 = -t117 * t125 - 0.5e1 / 0.27e2 * t52 * sigma[0] * t129;
  t138 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t106 * t60 + t114 + 0.3e1 / 0.2e2 * t6 * t31 * t133);
  t140 = my_piecewise5(t15, 0, t11, 0, -t101);
  t143 = my_piecewise3(t68, 0, 0.5e1 / 0.3e1 * t70 * t140);
  t144 = t143 * t30;
  t148 = t72 * t110;
  t151 = t6 * t148 * t93 / 0.1e2;
  t153 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t144 * t93 + t151);
  tvrho0 = t64 + t97 + t7 * (t138 + t153);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t156 = -t8 - t100;
  t157 = my_piecewise5(t11, 0, t15, 0, t156);
  t160 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t157);
  t161 = t160 * t30;
  t166 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t161 * t60 + t114);
  t168 = my_piecewise5(t15, 0, t11, 0, -t156);
  t171 = my_piecewise3(t68, 0, 0.5e1 / 0.3e1 * t70 * t168);
  t172 = t171 * t30;
  t176 = t84 * t84;
  t177 = 0.1e1 / t176;
  t178 = t177 * params->a;
  t180 = 0.1e1 / t75 / t86;
  t184 = my_piecewise3(t81, -t37 * t74 * t180 / 0.9e1, 0);
  t185 = sinh(t83);
  t186 = t184 * t185;
  t188 = t86 * rho[1];
  t190 = 0.1e1 / t87 / t188;
  t194 = -t178 * t186 - 0.5e1 / 0.27e2 * t52 * sigma[2] * t190;
  t199 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t172 * t93 + t151 + 0.3e1 / 0.2e2 * t6 * t73 * t194);
  tvrho1 = t64 + t97 + t7 * (t166 + t199);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t202 = 0.1e1 / t38;
  t206 = my_piecewise3(t45, t37 * t202 * t41 / 0.24e2, 0);
  t207 = t206 * t124;
  t211 = -t117 * t207 + 0.5e1 / 0.72e2 * t52 * t56;
  t215 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t211);
  tvsigma0 = t7 * t215;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t216 = 0.1e1 / t74;
  t220 = my_piecewise3(t81, t37 * t216 * t77 / 0.24e2, 0);
  t221 = t220 * t185;
  t225 = -t178 * t221 + 0.5e1 / 0.72e2 * t52 * t89;
  t229 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t225);
  tvsigma2 = t7 * t229;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t232 = 0.1e1 / t25;
  t233 = t102 * t102;
  t236 = t98 * t7;
  t237 = 0.1e1 / t236;
  t238 = t17 * t237;
  t240 = -0.2e1 * t99 + 0.2e1 * t238;
  t241 = my_piecewise5(t11, 0, t15, 0, t240);
  t245 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t232 * t233 + 0.5e1 / 0.3e1 * t26 * t241);
  t246 = t245 * t30;
  t250 = t105 * t110;
  t252 = t6 * t250 * t60;
  t258 = 0.1e1 / t29 / t7;
  t259 = t28 * t258;
  t262 = t6 * t259 * t60 / 0.3e2;
  t264 = t6 * t111 * t133;
  t267 = 0.1e1 / t115 / t48;
  t268 = params->a * params->a;
  t269 = t267 * t268;
  t270 = t123 * t123;
  t271 = t124 * t124;
  t276 = 0.1e1 / t39 / t127;
  t280 = my_piecewise3(t45, 0.7e1 / 0.27e2 * t37 * t38 * t276, 0);
  t283 = t49 * t268;
  t285 = t53 * t53;
  t287 = 0.1e1 / t54 / t285;
  t291 = 0.2e1 * t269 * t270 * t271 - t117 * t280 * t124 - t283 * t270 + 0.55e2 / 0.81e2 * t52 * sigma[0] * t287;
  t296 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t246 * t60 + t252 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t106 * t133 - t262 + t264 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t291);
  t297 = 0.1e1 / t69;
  t298 = t140 * t140;
  t302 = my_piecewise5(t15, 0, t11, 0, -t240);
  t306 = my_piecewise3(t68, 0, 0.1e2 / 0.9e1 * t297 * t298 + 0.5e1 / 0.3e1 * t70 * t302);
  t307 = t306 * t30;
  t311 = t143 * t110;
  t313 = t6 * t311 * t93;
  t315 = t72 * t258;
  t318 = t6 * t315 * t93 / 0.3e2;
  t320 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t307 * t93 + t313 / 0.5e1 - t318);
  tv2rho20 = 0.2e1 * t138 + 0.2e1 * t153 + t7 * (t296 + t320);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t323 = t232 * t157;
  t326 = 0.2e1 * t238;
  t327 = my_piecewise5(t11, 0, t15, 0, t326);
  t331 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t323 * t102 + 0.5e1 / 0.3e1 * t26 * t327);
  t332 = t331 * t30;
  t336 = t160 * t110;
  t338 = t6 * t336 * t60;
  t346 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t332 * t60 + t338 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t161 * t133 + t252 / 0.1e2 - t262 + t264 / 0.1e2);
  t347 = t297 * t168;
  t350 = my_piecewise5(t15, 0, t11, 0, -t326);
  t354 = my_piecewise3(t68, 0, 0.1e2 / 0.9e1 * t347 * t140 + 0.5e1 / 0.3e1 * t70 * t350);
  t355 = t354 * t30;
  t359 = t171 * t110;
  t361 = t6 * t359 * t93;
  t368 = t6 * t148 * t194;
  t371 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t355 * t93 + t361 / 0.1e2 + t313 / 0.1e2 - t318 + 0.3e1 / 0.2e2 * t6 * t144 * t194 + t368 / 0.1e2);
  tv2rho21 = t138 + t153 + t166 + t199 + t7 * (t346 + t371);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t376 = t157 * t157;
  t380 = 0.2e1 * t99 + 0.2e1 * t238;
  t381 = my_piecewise5(t11, 0, t15, 0, t380);
  t385 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t232 * t376 + 0.5e1 / 0.3e1 * t26 * t381);
  t386 = t385 * t30;
  t392 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t386 * t60 + t338 / 0.5e1 - t262);
  t393 = t168 * t168;
  t397 = my_piecewise5(t15, 0, t11, 0, -t380);
  t401 = my_piecewise3(t68, 0, 0.1e2 / 0.9e1 * t297 * t393 + 0.5e1 / 0.3e1 * t70 * t397);
  t402 = t401 * t30;
  t412 = 0.1e1 / t176 / t84;
  t413 = t412 * t268;
  t414 = t184 * t184;
  t415 = t185 * t185;
  t420 = 0.1e1 / t75 / t188;
  t424 = my_piecewise3(t81, 0.7e1 / 0.27e2 * t37 * t74 * t420, 0);
  t427 = t85 * t268;
  t429 = t86 * t86;
  t431 = 0.1e1 / t87 / t429;
  t435 = 0.2e1 * t413 * t414 * t415 - t178 * t424 * t185 - t427 * t414 + 0.55e2 / 0.81e2 * t52 * sigma[2] * t431;
  t440 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t402 * t93 + t361 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t172 * t194 - t318 + t368 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t73 * t435);
  tv2rho22 = 0.2e1 * t166 + 0.2e1 * t199 + t7 * (t392 + t440);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t448 = t6 * t111 * t211 / 0.1e2;
  t449 = t206 * t271;
  t456 = my_piecewise3(t45, -t37 * t202 * t119 / 0.18e2, 0);
  t457 = t456 * t124;
  t463 = 0.2e1 * t269 * t449 * t123 - t117 * t457 - t283 * t206 * t123 - 0.5e1 / 0.27e2 * t52 * t129;
  t468 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t106 * t211 + t448 + 0.3e1 / 0.2e2 * t6 * t31 * t463);
  tv2rhosigma0 = t7 * t468 + t215;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t475 = t6 * t148 * t225 / 0.1e2;
  t477 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t144 * t225 + t475);
  tv2rhosigma2 = t7 * t477 + t229;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t483 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t161 * t211 + t448);
  tv2rhosigma3 = t7 * t483 + t215;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t488 = t220 * t415;
  t495 = my_piecewise3(t81, -t37 * t216 * t180 / 0.18e2, 0);
  t496 = t495 * t185;
  t502 = 0.2e1 * t413 * t488 * t184 - t178 * t496 - t427 * t220 * t184 - 0.5e1 / 0.27e2 * t52 * t190;
  t507 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t172 * t225 + t475 + 0.3e1 / 0.2e2 * t6 * t73 * t502);
  tv2rhosigma5 = t7 * t507 + t229;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t509 = t206 * t206;
  t510 = t509 * t271;
  t514 = 0.1e1 / t38 / sigma[0];
  t518 = my_piecewise3(t45, -t37 * t514 * t41 / 0.48e2, 0);
  t519 = t518 * t124;
  t522 = -t117 * t519 + 0.2e1 * t269 * t510 - t283 * t509;
  t526 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t522);
  tv2sigma20 = t7 * t526;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t527 = t220 * t220;
  t528 = t527 * t415;
  t532 = 0.1e1 / t74 / sigma[2];
  t536 = my_piecewise3(t81, -t37 * t532 * t77 / 0.48e2, 0);
  t537 = t536 * t185;
  t540 = -t178 * t537 + 0.2e1 * t413 * t528 - t427 * t527;
  t544 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t540);
  tv2sigma25 = t7 * t544;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t548 = 0.1e1 / t25 / t20;
  t549 = t233 * t102;
  t552 = t232 * t102;
  t555 = t98 * t98;
  t556 = 0.1e1 / t555;
  t557 = t17 * t556;
  t559 = 0.6e1 * t237 - 0.6e1 * t557;
  t560 = my_piecewise5(t11, 0, t15, 0, t559);
  t564 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t548 * t549 + 0.1e2 / 0.3e1 * t552 * t241 + 0.5e1 / 0.3e1 * t26 * t560);
  t565 = t564 * t30;
  t569 = t245 * t110;
  t571 = t6 * t569 * t60;
  t576 = t105 * t258;
  t578 = t6 * t576 * t60;
  t581 = t6 * t250 * t133;
  t587 = 0.1e1 / t29 / t98;
  t588 = t28 * t587;
  t591 = 0.2e1 / 0.45e2 * t6 * t588 * t60;
  t593 = t6 * t259 * t133;
  t596 = t6 * t111 * t291;
  t598 = t115 * t115;
  t600 = t268 * params->a;
  t601 = 0.1e1 / t598 * t600;
  t602 = t270 * t123;
  t603 = t271 * t124;
  t607 = t123 * t271;
  t611 = t116 * t600;
  t616 = 0.1e1 / t39 / t285;
  t620 = my_piecewise3(t45, -0.7e2 / 0.81e2 * t37 * t38 * t616, 0);
  t626 = t285 * rho[0];
  t628 = 0.1e1 / t54 / t626;
  t632 = -0.6e1 * t601 * t602 * t603 + 0.6e1 * t269 * t607 * t280 + 0.5e1 * t611 * t602 * t124 - t117 * t620 * t124 - 0.3e1 * t283 * t280 * t123 - 0.77e3 / 0.243e3 * t52 * sigma[0] * t628;
  t637 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t565 * t60 + 0.3e1 / 0.1e2 * t571 + 0.9e1 / 0.2e2 * t6 * t246 * t133 - t578 / 0.1e2 + 0.3e1 / 0.5e1 * t581 + 0.9e1 / 0.2e2 * t6 * t106 * t291 + t591 - t593 / 0.1e2 + 0.3e1 / 0.1e2 * t596 + 0.3e1 / 0.2e2 * t6 * t31 * t632);
  t639 = 0.1e1 / t69 / t67;
  t640 = t298 * t140;
  t643 = t297 * t140;
  t647 = my_piecewise5(t15, 0, t11, 0, -t559);
  t651 = my_piecewise3(t68, 0, -0.1e2 / 0.27e2 * t639 * t640 + 0.1e2 / 0.3e1 * t643 * t302 + 0.5e1 / 0.3e1 * t70 * t647);
  t652 = t651 * t30;
  t656 = t306 * t110;
  t658 = t6 * t656 * t93;
  t660 = t143 * t258;
  t662 = t6 * t660 * t93;
  t664 = t72 * t587;
  t667 = 0.2e1 / 0.45e2 * t6 * t664 * t93;
  t669 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t652 * t93 + 0.3e1 / 0.1e2 * t658 - t662 / 0.1e2 + t667);
  tv3rho30 = 0.3e1 * t296 + 0.3e1 * t320 + t7 * (t637 + t669);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t672 = 0.2e1 * t346;
  t673 = 0.2e1 * t371;
  t674 = t548 * t157;
  t677 = t232 * t327;
  t682 = 0.2e1 * t237;
  t683 = 0.6e1 * t557;
  t684 = t682 - t683;
  t685 = my_piecewise5(t11, 0, t15, 0, t684);
  t689 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t674 * t233 + 0.2e2 / 0.9e1 * t677 * t102 + 0.1e2 / 0.9e1 * t323 * t241 + 0.5e1 / 0.3e1 * t26 * t685);
  t690 = t689 * t30;
  t694 = t331 * t110;
  t697 = t6 * t694 * t60 / 0.5e1;
  t701 = t160 * t258;
  t703 = t6 * t701 * t60;
  t707 = t6 * t336 * t133 / 0.5e1;
  t716 = 0.3e1 / 0.2e2 * t6 * t690 * t60 + t697 + 0.3e1 / 0.1e2 * t6 * t332 * t133 - t703 / 0.3e2 + t707 + 0.3e1 / 0.2e2 * t6 * t161 * t291 + t571 / 0.1e2 - t578 / 0.15e2 + t581 / 0.5e1 + t591 - t593 / 0.15e2 + t596 / 0.1e2;
  t717 = my_piecewise3(t1, 0, t716);
  t718 = t639 * t168;
  t721 = t297 * t350;
  t727 = my_piecewise5(t15, 0, t11, 0, -t684);
  t731 = my_piecewise3(t68, 0, -0.1e2 / 0.27e2 * t718 * t298 + 0.2e2 / 0.9e1 * t721 * t140 + 0.1e2 / 0.9e1 * t347 * t302 + 0.5e1 / 0.3e1 * t70 * t727);
  t732 = t731 * t30;
  t736 = t354 * t110;
  t739 = t6 * t736 * t93 / 0.5e1;
  t740 = t171 * t258;
  t742 = t6 * t740 * t93;
  t751 = t6 * t311 * t194 / 0.5e1;
  t753 = t6 * t315 * t194;
  t756 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t732 * t93 + t739 - t742 / 0.3e2 + t658 / 0.1e2 - t662 / 0.15e2 + t667 + 0.3e1 / 0.2e2 * t6 * t307 * t194 + t751 - t753 / 0.3e2);
  tv3rho31 = t296 + t320 + t672 + t673 + t7 * (t717 + t756);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t759 = t548 * t376;
  t764 = t232 * t381;
  t767 = -t682 - t683;
  t768 = my_piecewise5(t11, 0, t15, 0, t767);
  t772 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t759 * t102 + 0.2e2 / 0.9e1 * t323 * t327 + 0.1e2 / 0.9e1 * t764 * t102 + 0.5e1 / 0.3e1 * t26 * t768);
  t773 = t772 * t30;
  t777 = t385 * t110;
  t779 = t6 * t777 * t60;
  t788 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t773 * t60 + t779 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t386 * t133 + t697 - t703 / 0.15e2 + t707 - t578 / 0.3e2 + t591 - t593 / 0.3e2);
  t789 = t639 * t393;
  t794 = t297 * t397;
  t798 = my_piecewise5(t15, 0, t11, 0, -t767);
  t802 = my_piecewise3(t68, 0, -0.1e2 / 0.27e2 * t789 * t140 + 0.2e2 / 0.9e1 * t347 * t350 + 0.1e2 / 0.9e1 * t794 * t140 + 0.5e1 / 0.3e1 * t70 * t798);
  t803 = t802 * t30;
  t807 = t401 * t110;
  t809 = t6 * t807 * t93;
  t816 = t6 * t359 * t194;
  t824 = t6 * t148 * t435;
  t826 = 0.3e1 / 0.2e2 * t6 * t803 * t93 + t809 / 0.1e2 + t739 - t742 / 0.15e2 + 0.3e1 / 0.1e2 * t6 * t355 * t194 + t816 / 0.5e1 - t662 / 0.3e2 + t667 + t751 - t753 / 0.15e2 + 0.3e1 / 0.2e2 * t6 * t144 * t435 + t824 / 0.1e2;
  t827 = my_piecewise3(t65, 0, t826);
  tv3rho32 = t672 + t673 + t392 + t440 + t7 * (t788 + t827);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t832 = t376 * t157;
  t838 = -0.6e1 * t237 - 0.6e1 * t557;
  t839 = my_piecewise5(t11, 0, t15, 0, t838);
  t843 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t548 * t832 + 0.1e2 / 0.3e1 * t323 * t381 + 0.5e1 / 0.3e1 * t26 * t839);
  t844 = t843 * t30;
  t851 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t844 * t60 + 0.3e1 / 0.1e2 * t779 - t703 / 0.1e2 + t591);
  t852 = t393 * t168;
  t858 = my_piecewise5(t15, 0, t11, 0, -t838);
  t862 = my_piecewise3(t68, 0, -0.1e2 / 0.27e2 * t639 * t852 + 0.1e2 / 0.3e1 * t347 * t397 + 0.5e1 / 0.3e1 * t70 * t858);
  t863 = t862 * t30;
  t878 = t176 * t176;
  t880 = 0.1e1 / t878 * t600;
  t881 = t414 * t184;
  t882 = t415 * t185;
  t886 = t184 * t415;
  t890 = t177 * t600;
  t895 = 0.1e1 / t75 / t429;
  t899 = my_piecewise3(t81, -0.7e2 / 0.81e2 * t37 * t74 * t895, 0);
  t905 = t429 * rho[1];
  t907 = 0.1e1 / t87 / t905;
  t911 = -0.6e1 * t880 * t881 * t882 + 0.6e1 * t413 * t886 * t424 + 0.5e1 * t890 * t881 * t185 - t178 * t899 * t185 - 0.3e1 * t427 * t424 * t184 - 0.77e3 / 0.243e3 * t52 * sigma[2] * t907;
  t916 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t863 * t93 + 0.3e1 / 0.1e2 * t809 + 0.9e1 / 0.2e2 * t6 * t402 * t194 - t742 / 0.1e2 + 0.3e1 / 0.5e1 * t816 + 0.9e1 / 0.2e2 * t6 * t172 * t435 + t667 - t753 / 0.1e2 + 0.3e1 / 0.1e2 * t824 + 0.3e1 / 0.2e2 * t6 * t73 * t911);
  tv3rho33 = 0.3e1 * t392 + 0.3e1 * t440 + t7 * (t851 + t916);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t924 = t6 * t250 * t211;
  t931 = t6 * t259 * t211 / 0.3e2;
  t933 = t6 * t111 * t463;
  t939 = t456 * t271;
  t952 = my_piecewise3(t45, 0.7e1 / 0.54e2 * t37 * t202 * t276, 0);
  t962 = -0.6e1 * t601 * t206 * t603 * t270 + 0.4e1 * t269 * t939 * t123 + 0.5e1 * t611 * t207 * t270 + 0.2e1 * t269 * t449 * t280 - t117 * t952 * t124 - 0.2e1 * t283 * t456 * t123 - t283 * t206 * t280 + 0.55e2 / 0.81e2 * t52 * t287;
  t967 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t246 * t211 + t924 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t106 * t463 - t931 + t933 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t962);
  tv3rho2sigma0 = t7 * t967 + 0.2e1 * t468;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t974 = t6 * t311 * t225;
  t978 = t6 * t315 * t225 / 0.3e2;
  t980 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t307 * t225 + t974 / 0.5e1 - t978);
  tv3rho2sigma2 = t7 * t980 + 0.2e1 * t477;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t986 = t6 * t336 * t211;
  t994 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t332 * t211 + t986 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t161 * t463 + t924 / 0.1e2 - t931 + t933 / 0.1e2);
  tv3rho2sigma3 = t7 * t994 + t468 + t483;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1000 = t6 * t359 * t225;
  t1007 = t6 * t148 * t502;
  t1010 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t355 * t225 + t1000 / 0.1e2 + t974 / 0.1e2 - t978 + 0.3e1 / 0.2e2 * t6 * t144 * t502 + t1007 / 0.1e2);
  tv3rho2sigma5 = t7 * t1010 + t477 + t507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1018 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t386 * t211 + t986 / 0.5e1 - t931);
  tv3rho2sigma6 = t7 * t1018 + 0.2e1 * t483;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1033 = t495 * t415;
  t1046 = my_piecewise3(t81, 0.7e1 / 0.54e2 * t37 * t216 * t420, 0);
  t1056 = -0.6e1 * t880 * t220 * t882 * t414 + 0.4e1 * t413 * t1033 * t184 + 0.5e1 * t890 * t221 * t414 + 0.2e1 * t413 * t488 * t424 - t178 * t1046 * t185 - 0.2e1 * t427 * t495 * t184 - t427 * t220 * t424 + 0.55e2 / 0.81e2 * t52 * t431;
  t1061 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t402 * t225 + t1000 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t172 * t502 - t978 + t1007 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t73 * t1056);
  tv3rho2sigma8 = t7 * t1061 + 0.2e1 * t507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1068 = t6 * t111 * t522 / 0.1e2;
  t1069 = t509 * t603;
  t1076 = t509 * t124;
  t1080 = t518 * t271;
  t1087 = my_piecewise3(t45, t37 * t514 * t119 / 0.36e2, 0);
  t1095 = -0.6e1 * t601 * t1069 * t123 + 0.5e1 * t611 * t1076 * t123 + 0.2e1 * t269 * t1080 * t123 - t117 * t1087 * t124 - t283 * t518 * t123 - 0.2e1 * t283 * t206 * t456 + 0.4e1 * t269 * t449 * t456;
  t1100 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t106 * t522 + t1068 + 0.3e1 / 0.2e2 * t6 * t31 * t1095);
  tv3rhosigma20 = t7 * t1100 + t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1107 = t6 * t148 * t540 / 0.1e2;
  t1109 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t144 * t540 + t1107);
  tv3rhosigma25 = t7 * t1109 + t544;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1115 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t161 * t522 + t1068);
  tv3rhosigma26 = t7 * t1115 + t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1120 = t527 * t882;
  t1127 = t527 * t185;
  t1131 = t536 * t415;
  t1138 = my_piecewise3(t81, t37 * t532 * t180 / 0.36e2, 0);
  t1146 = -0.6e1 * t880 * t1120 * t184 + 0.5e1 * t890 * t1127 * t184 + 0.2e1 * t413 * t1131 * t184 - t178 * t1138 * t185 - t427 * t536 * t184 - 0.2e1 * t427 * t220 * t495 + 0.4e1 * t413 * t488 * t495;
  t1151 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t172 * t540 + t1107 + 0.3e1 / 0.2e2 * t6 * t73 * t1146);
  tv3rhosigma211 = t7 * t1151 + t544;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1153 = t509 * t206;
  t1163 = sigma[0] * sigma[0];
  t1165 = 0.1e1 / t38 / t1163;
  t1169 = my_piecewise3(t45, t37 * t1165 * t41 / 0.32e2, 0);
  t1175 = 0.5e1 * t611 * t1153 * t124 - 0.6e1 * t601 * t1153 * t603 - t117 * t1169 * t124 - 0.3e1 * t283 * t518 * t206 + 0.6e1 * t269 * t449 * t518;
  t1179 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t1175);
  tv3sigma30 = t7 * t1179;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1180 = t527 * t220;
  t1190 = sigma[2] * sigma[2];
  t1192 = 0.1e1 / t74 / t1190;
  t1196 = my_piecewise3(t81, t37 * t1192 * t77 / 0.32e2, 0);
  t1202 = 0.5e1 * t890 * t1180 * t185 - 0.6e1 * t880 * t1180 * t882 - t178 * t1196 * t185 - 0.3e1 * t427 * t536 * t220 + 0.6e1 * t413 * t488 * t536;
  t1206 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t1202);
  tv3sigma39 = t7 * t1206;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t39;
  double t41, t44, t45, t46, t47, t48, t49, t50;
  double t52, t53, t54, t56, t60, t64, t65, t66;
  double t67, t68, t69, t70, t72, t73, t74, t75;
  double t77, t80, t81, t82, t83, t84, t85, t86;
  double t87, t89, t93, t97, tzk0;

  double t98, t99, t100, t101, t102, t105, t106, t110;
  double t111, t114, t115, t116, t117, t119, t123, t124;
  double t125, t127, t129, t133, t138, t140, t143, t144;
  double t148, t151, t153, tvrho0, t156, t157, t160, t161;
  double t166, t168, t171, t172, t176, t177, t178, t180;
  double t184, t185, t186, t188, t190, t194, t199, tvrho1;
  double t202, t206, t207, t211, t215, tvsigma0, tvsigma1, t216;
  double t220, t221, t225, t229, tvsigma2;

  double t232, t233, t236, t237, t238, t240, t241, t245;
  double t246, t250, t252, t258, t259, t262, t264, t267;
  double t268, t269, t270, t271, t276, t280, t283, t285;
  double t287, t291, t296, t297, t298, t302, t306, t307;
  double t311, t313, t315, t318, t320, tv2rho20, t323, t326;
  double t327, t331, t332, t336, t338, t346, t347, t350;
  double t354, t355, t359, t361, t368, t371, tv2rho21, t376;
  double t380, t381, t385, t386, t392, t393, t397, t401;
  double t402, t412, t413, t414, t415, t420, t424, t427;
  double t429, t431, t435, t440, tv2rho22, t448, t449, t456;
  double t457, t463, t468, tv2rhosigma0, tv2rhosigma1, t475, t477, tv2rhosigma2;
  double t483, tv2rhosigma3, tv2rhosigma4, t488, t495, t496, t502, t507;
  double tv2rhosigma5, t509, t510, t514, t518, t519, t522, t526;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t527, t528, t532;
  double t536, t537, t540, t544, tv2sigma25;

  double t548, t549, t552, t555, t556, t557, t559, t560;
  double t564, t565, t569, t571, t576, t578, t581, t587;
  double t588, t591, t593, t596, t598, t600, t601, t602;
  double t603, t607, t611, t616, t620, t626, t628, t632;
  double t637, t639, t640, t643, t647, t651, t652, t656;
  double t658, t660, t662, t664, t667, t669, tv3rho30, t672;
  double t673, t674, t677, t682, t683, t684, t685, t689;
  double t690, t694, t697, t701, t703, t707, t716, t717;
  double t718, t721, t727, t731, t732, t736, t739, t740;
  double t742, t751, t753, t756, tv3rho31, t759, t764, t767;
  double t768, t772, t773, t777, t779, t788, t789, t794;
  double t798, t802, t803, t807, t809, t816, t824, t826;
  double t827, tv3rho32, t832, t838, t839, t843, t844, t851;
  double t852, t858, t862, t863, t878, t880, t881, t882;
  double t886, t890, t895, t899, t905, t907, t911, t916;
  double tv3rho33, t924, t931, t933, t939, t952, t962, t967;
  double tv3rho2sigma0, tv3rho2sigma1, t974, t978, t980, tv3rho2sigma2, t986, t994;
  double tv3rho2sigma3, tv3rho2sigma4, t1000, t1007, t1010, tv3rho2sigma5, t1018, tv3rho2sigma6;
  double tv3rho2sigma7, t1033, t1046, t1056, t1061, tv3rho2sigma8, t1068, t1069;
  double t1076, t1080, t1087, t1095, t1100, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22;
  double tv3rhosigma23, tv3rhosigma24, t1107, t1109, tv3rhosigma25, t1115, tv3rhosigma26, tv3rhosigma27;
  double tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1120, t1127, t1131, t1138, t1146;
  double t1151, tv3rhosigma211, t1153, t1163, t1165, t1169, t1175, t1179;
  double tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37;
  double tv3sigma38, t1180, t1190, t1192, t1196, t1202, t1206, tv3sigma39;

  double t1210, t1214, t1217, t1221, t1225, t1228, t1234, t1237;
  double t1240, t1244, t1245, t1246, t1247, t1255, t1259, t1270;
  double t1278, t1292, t1296, t1298, t1299, t1305, t1312, t1314;
  double t1315, t1319, t1328, t1334, t1336, t1337, t1338, t1340;
  double t1341, t1347, t1353, t1357, t1364, t1368, t1372, t1377;
  double t1379, tv4rho40, t1386, t1390, t1391, t1394, t1415, t1416;
  double t1417, t1418, t1422, t1431, t1437, t1438, t1440, t1451;
  double t1452, t1470, t1474, t1481, t1485, t1486, t1489, t1498;
  double t1501, t1502, t1504, t1506, t1507, tv4rho41, t1516, t1520;
  double t1535, t1548, t1552, t1561, t1572, t1573, t1582, t1595;
  double t1599, t1606, t1610, t1619, t1622, t1633, t1636, t1638;
  double t1639, tv4rho42, t1659, t1660, t1664, t1671, t1682, t1683;
  double t1700, t1704, t1711, t1719, t1728, t1738, t1740, t1741;
  double tv4rho43, t1746, t1751, t1757, t1758, t1762, t1771, t1781;
  double t1786, t1792, t1796, t1812, t1813, t1814, t1822, t1826;
  double t1837, t1845, t1859, t1863, t1864, tv4rho44, t1872, t1878;
  double t1881, t1888, t1890, t1893, t1908, t1909, t1913, t1937;
  double t1947, t1952, tv4rho3sigma0, tv4rho3sigma1, t1959, t1962, t1966, t1968;
  double tv4rho3sigma2, t1970, t1976, t1981, t1985, t1994, t1995, tv4rho3sigma3;
  double tv4rho3sigma4, t1997, t2003, t2005, t2014, t2016, t2019, tv4rho3sigma5;
  double t2025, t2034, tv4rho3sigma6, tv4rho3sigma7, t2040, t2047, t2055, t2057;
  double t2058, tv4rho3sigma8, t2067, tv4rho3sigma9, tv4rho3sigma10, t2084, t2091, t2092;
  double t2126, t2136, t2141, tv4rho3sigma11, t2148, t2155, t2157, t2168;
  double t2195, t2208, t2218, t2223, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t2230, t2234, t2236, tv4rho2sigma25, t2242, t2250, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t2256, t2263, t2266, tv4rho2sigma211;
  double t2274, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t2288, t2293;
  double t2334, t2344, t2349, tv4rho2sigma217, t2356, t2393, t2404, t2409;
  double tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37;
  double tv4rhosigma38, t2416, t2418, tv4rhosigma39, t2424, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312;
  double tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t2465, t2476;
  double t2481, tv4rhosigma319, t2483, t2493, t2511, t2523, tv4sigma40, tv4sigma41;
  double tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49;
  double tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t2524, t2534, t2552, t2564;
  double tv4sigma414;

  gga_k_lkt_params *params;

  assert(p->params != NULL);
  params = (gga_k_lkt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t31 = t28 * t30;
  t32 = M_CBRT6;
  t33 = t32 * t32;
  t34 = M_PI * M_PI;
  t35 = POW_1_3(t34);
  t37 = t33 / t35;
  t38 = sqrt(sigma[0]);
  t39 = POW_1_3(rho[0]);
  t41 = 0.1e1 / t39 / rho[0];
  t44 = t37 * t38 * t41 / 0.12e2;
  t45 = t44 < 0.2e3;
  t46 = my_piecewise3(t45, t44, 200);
  t47 = params->a * t46;
  t48 = cosh(t47);
  t49 = 0.1e1 / t48;
  t50 = t35 * t35;
  t52 = t32 / t50;
  t53 = rho[0] * rho[0];
  t54 = t39 * t39;
  t56 = 0.1e1 / t54 / t53;
  t60 = t49 + 0.5e1 / 0.72e2 * t52 * sigma[0] * t56;
  t64 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t60);
  t65 = rho[1] <= p->dens_threshold;
  t66 = my_piecewise5(t15, t12, t11, t16, -t18);
  t67 = 0.1e1 + t66;
  t68 = t67 <= p->zeta_threshold;
  t69 = POW_1_3(t67);
  t70 = t69 * t69;
  t72 = my_piecewise3(t68, t24, t70 * t67);
  t73 = t72 * t30;
  t74 = sqrt(sigma[2]);
  t75 = POW_1_3(rho[1]);
  t77 = 0.1e1 / t75 / rho[1];
  t80 = t37 * t74 * t77 / 0.12e2;
  t81 = t80 < 0.2e3;
  t82 = my_piecewise3(t81, t80, 200);
  t83 = params->a * t82;
  t84 = cosh(t83);
  t85 = 0.1e1 / t84;
  t86 = rho[1] * rho[1];
  t87 = t75 * t75;
  t89 = 0.1e1 / t87 / t86;
  t93 = t85 + 0.5e1 / 0.72e2 * t52 * sigma[2] * t89;
  t97 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t93);
  tzk0 = t64 + t97;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t98 = t7 * t7;
  t99 = 0.1e1 / t98;
  t100 = t17 * t99;
  t101 = t8 - t100;
  t102 = my_piecewise5(t11, 0, t15, 0, t101);
  t105 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t102);
  t106 = t105 * t30;
  t110 = 0.1e1 / t29;
  t111 = t28 * t110;
  t114 = t6 * t111 * t60 / 0.1e2;
  t115 = t48 * t48;
  t116 = 0.1e1 / t115;
  t117 = t116 * params->a;
  t119 = 0.1e1 / t39 / t53;
  t123 = my_piecewise3(t45, -t37 * t38 * t119 / 0.9e1, 0);
  t124 = sinh(t47);
  t125 = t123 * t124;
  t127 = t53 * rho[0];
  t129 = 0.1e1 / t54 / t127;
  t133 = -t117 * t125 - 0.5e1 / 0.27e2 * t52 * sigma[0] * t129;
  t138 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t106 * t60 + t114 + 0.3e1 / 0.2e2 * t6 * t31 * t133);
  t140 = my_piecewise5(t15, 0, t11, 0, -t101);
  t143 = my_piecewise3(t68, 0, 0.5e1 / 0.3e1 * t70 * t140);
  t144 = t143 * t30;
  t148 = t72 * t110;
  t151 = t6 * t148 * t93 / 0.1e2;
  t153 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t144 * t93 + t151);
  tvrho0 = t64 + t97 + t7 * (t138 + t153);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t156 = -t8 - t100;
  t157 = my_piecewise5(t11, 0, t15, 0, t156);
  t160 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t157);
  t161 = t160 * t30;
  t166 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t161 * t60 + t114);
  t168 = my_piecewise5(t15, 0, t11, 0, -t156);
  t171 = my_piecewise3(t68, 0, 0.5e1 / 0.3e1 * t70 * t168);
  t172 = t171 * t30;
  t176 = t84 * t84;
  t177 = 0.1e1 / t176;
  t178 = t177 * params->a;
  t180 = 0.1e1 / t75 / t86;
  t184 = my_piecewise3(t81, -t37 * t74 * t180 / 0.9e1, 0);
  t185 = sinh(t83);
  t186 = t184 * t185;
  t188 = t86 * rho[1];
  t190 = 0.1e1 / t87 / t188;
  t194 = -t178 * t186 - 0.5e1 / 0.27e2 * t52 * sigma[2] * t190;
  t199 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t172 * t93 + t151 + 0.3e1 / 0.2e2 * t6 * t73 * t194);
  tvrho1 = t64 + t97 + t7 * (t166 + t199);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t202 = 0.1e1 / t38;
  t206 = my_piecewise3(t45, t37 * t202 * t41 / 0.24e2, 0);
  t207 = t206 * t124;
  t211 = -t117 * t207 + 0.5e1 / 0.72e2 * t52 * t56;
  t215 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t211);
  tvsigma0 = t7 * t215;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t216 = 0.1e1 / t74;
  t220 = my_piecewise3(t81, t37 * t216 * t77 / 0.24e2, 0);
  t221 = t220 * t185;
  t225 = -t178 * t221 + 0.5e1 / 0.72e2 * t52 * t89;
  t229 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t225);
  tvsigma2 = t7 * t229;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t232 = 0.1e1 / t25;
  t233 = t102 * t102;
  t236 = t98 * t7;
  t237 = 0.1e1 / t236;
  t238 = t17 * t237;
  t240 = -0.2e1 * t99 + 0.2e1 * t238;
  t241 = my_piecewise5(t11, 0, t15, 0, t240);
  t245 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t232 * t233 + 0.5e1 / 0.3e1 * t26 * t241);
  t246 = t245 * t30;
  t250 = t105 * t110;
  t252 = t6 * t250 * t60;
  t258 = 0.1e1 / t29 / t7;
  t259 = t28 * t258;
  t262 = t6 * t259 * t60 / 0.3e2;
  t264 = t6 * t111 * t133;
  t267 = 0.1e1 / t115 / t48;
  t268 = params->a * params->a;
  t269 = t267 * t268;
  t270 = t123 * t123;
  t271 = t124 * t124;
  t276 = 0.1e1 / t39 / t127;
  t280 = my_piecewise3(t45, 0.7e1 / 0.27e2 * t37 * t38 * t276, 0);
  t283 = t49 * t268;
  t285 = t53 * t53;
  t287 = 0.1e1 / t54 / t285;
  t291 = 0.2e1 * t269 * t270 * t271 - t117 * t280 * t124 - t283 * t270 + 0.55e2 / 0.81e2 * t52 * sigma[0] * t287;
  t296 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t246 * t60 + t252 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t106 * t133 - t262 + t264 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t291);
  t297 = 0.1e1 / t69;
  t298 = t140 * t140;
  t302 = my_piecewise5(t15, 0, t11, 0, -t240);
  t306 = my_piecewise3(t68, 0, 0.1e2 / 0.9e1 * t297 * t298 + 0.5e1 / 0.3e1 * t70 * t302);
  t307 = t306 * t30;
  t311 = t143 * t110;
  t313 = t6 * t311 * t93;
  t315 = t72 * t258;
  t318 = t6 * t315 * t93 / 0.3e2;
  t320 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t307 * t93 + t313 / 0.5e1 - t318);
  tv2rho20 = 0.2e1 * t138 + 0.2e1 * t153 + t7 * (t296 + t320);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t323 = t232 * t157;
  t326 = 0.2e1 * t238;
  t327 = my_piecewise5(t11, 0, t15, 0, t326);
  t331 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t323 * t102 + 0.5e1 / 0.3e1 * t26 * t327);
  t332 = t331 * t30;
  t336 = t160 * t110;
  t338 = t6 * t336 * t60;
  t346 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t332 * t60 + t338 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t161 * t133 + t252 / 0.1e2 - t262 + t264 / 0.1e2);
  t347 = t297 * t168;
  t350 = my_piecewise5(t15, 0, t11, 0, -t326);
  t354 = my_piecewise3(t68, 0, 0.1e2 / 0.9e1 * t347 * t140 + 0.5e1 / 0.3e1 * t70 * t350);
  t355 = t354 * t30;
  t359 = t171 * t110;
  t361 = t6 * t359 * t93;
  t368 = t6 * t148 * t194;
  t371 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t355 * t93 + t361 / 0.1e2 + t313 / 0.1e2 - t318 + 0.3e1 / 0.2e2 * t6 * t144 * t194 + t368 / 0.1e2);
  tv2rho21 = t138 + t153 + t166 + t199 + t7 * (t346 + t371);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t376 = t157 * t157;
  t380 = 0.2e1 * t99 + 0.2e1 * t238;
  t381 = my_piecewise5(t11, 0, t15, 0, t380);
  t385 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t232 * t376 + 0.5e1 / 0.3e1 * t26 * t381);
  t386 = t385 * t30;
  t392 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t386 * t60 + t338 / 0.5e1 - t262);
  t393 = t168 * t168;
  t397 = my_piecewise5(t15, 0, t11, 0, -t380);
  t401 = my_piecewise3(t68, 0, 0.1e2 / 0.9e1 * t297 * t393 + 0.5e1 / 0.3e1 * t70 * t397);
  t402 = t401 * t30;
  t412 = 0.1e1 / t176 / t84;
  t413 = t412 * t268;
  t414 = t184 * t184;
  t415 = t185 * t185;
  t420 = 0.1e1 / t75 / t188;
  t424 = my_piecewise3(t81, 0.7e1 / 0.27e2 * t37 * t74 * t420, 0);
  t427 = t85 * t268;
  t429 = t86 * t86;
  t431 = 0.1e1 / t87 / t429;
  t435 = 0.2e1 * t413 * t414 * t415 - t178 * t424 * t185 - t427 * t414 + 0.55e2 / 0.81e2 * t52 * sigma[2] * t431;
  t440 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t402 * t93 + t361 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t172 * t194 - t318 + t368 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t73 * t435);
  tv2rho22 = 0.2e1 * t166 + 0.2e1 * t199 + t7 * (t392 + t440);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t448 = t6 * t111 * t211 / 0.1e2;
  t449 = t206 * t271;
  t456 = my_piecewise3(t45, -t37 * t202 * t119 / 0.18e2, 0);
  t457 = t456 * t124;
  t463 = 0.2e1 * t269 * t449 * t123 - t117 * t457 - t283 * t206 * t123 - 0.5e1 / 0.27e2 * t52 * t129;
  t468 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t106 * t211 + t448 + 0.3e1 / 0.2e2 * t6 * t31 * t463);
  tv2rhosigma0 = t7 * t468 + t215;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t475 = t6 * t148 * t225 / 0.1e2;
  t477 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t144 * t225 + t475);
  tv2rhosigma2 = t7 * t477 + t229;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t483 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t161 * t211 + t448);
  tv2rhosigma3 = t7 * t483 + t215;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t488 = t220 * t415;
  t495 = my_piecewise3(t81, -t37 * t216 * t180 / 0.18e2, 0);
  t496 = t495 * t185;
  t502 = 0.2e1 * t413 * t488 * t184 - t178 * t496 - t427 * t220 * t184 - 0.5e1 / 0.27e2 * t52 * t190;
  t507 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t172 * t225 + t475 + 0.3e1 / 0.2e2 * t6 * t73 * t502);
  tv2rhosigma5 = t7 * t507 + t229;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t509 = t206 * t206;
  t510 = t509 * t271;
  t514 = 0.1e1 / t38 / sigma[0];
  t518 = my_piecewise3(t45, -t37 * t514 * t41 / 0.48e2, 0);
  t519 = t518 * t124;
  t522 = -t117 * t519 + 0.2e1 * t269 * t510 - t283 * t509;
  t526 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t522);
  tv2sigma20 = t7 * t526;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t527 = t220 * t220;
  t528 = t527 * t415;
  t532 = 0.1e1 / t74 / sigma[2];
  t536 = my_piecewise3(t81, -t37 * t532 * t77 / 0.48e2, 0);
  t537 = t536 * t185;
  t540 = -t178 * t537 + 0.2e1 * t413 * t528 - t427 * t527;
  t544 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t540);
  tv2sigma25 = t7 * t544;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t548 = 0.1e1 / t25 / t20;
  t549 = t233 * t102;
  t552 = t232 * t102;
  t555 = t98 * t98;
  t556 = 0.1e1 / t555;
  t557 = t17 * t556;
  t559 = 0.6e1 * t237 - 0.6e1 * t557;
  t560 = my_piecewise5(t11, 0, t15, 0, t559);
  t564 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t548 * t549 + 0.1e2 / 0.3e1 * t552 * t241 + 0.5e1 / 0.3e1 * t26 * t560);
  t565 = t564 * t30;
  t569 = t245 * t110;
  t571 = t6 * t569 * t60;
  t576 = t105 * t258;
  t578 = t6 * t576 * t60;
  t581 = t6 * t250 * t133;
  t587 = 0.1e1 / t29 / t98;
  t588 = t28 * t587;
  t591 = 0.2e1 / 0.45e2 * t6 * t588 * t60;
  t593 = t6 * t259 * t133;
  t596 = t6 * t111 * t291;
  t598 = t115 * t115;
  t600 = t268 * params->a;
  t601 = 0.1e1 / t598 * t600;
  t602 = t270 * t123;
  t603 = t271 * t124;
  t607 = t123 * t271;
  t611 = t116 * t600;
  t616 = 0.1e1 / t39 / t285;
  t620 = my_piecewise3(t45, -0.7e2 / 0.81e2 * t37 * t38 * t616, 0);
  t626 = t285 * rho[0];
  t628 = 0.1e1 / t54 / t626;
  t632 = -0.6e1 * t601 * t602 * t603 + 0.6e1 * t269 * t607 * t280 + 0.5e1 * t611 * t602 * t124 - t117 * t620 * t124 - 0.3e1 * t283 * t280 * t123 - 0.77e3 / 0.243e3 * t52 * sigma[0] * t628;
  t637 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t565 * t60 + 0.3e1 / 0.1e2 * t571 + 0.9e1 / 0.2e2 * t6 * t246 * t133 - t578 / 0.1e2 + 0.3e1 / 0.5e1 * t581 + 0.9e1 / 0.2e2 * t6 * t106 * t291 + t591 - t593 / 0.1e2 + 0.3e1 / 0.1e2 * t596 + 0.3e1 / 0.2e2 * t6 * t31 * t632);
  t639 = 0.1e1 / t69 / t67;
  t640 = t298 * t140;
  t643 = t297 * t140;
  t647 = my_piecewise5(t15, 0, t11, 0, -t559);
  t651 = my_piecewise3(t68, 0, -0.1e2 / 0.27e2 * t639 * t640 + 0.1e2 / 0.3e1 * t643 * t302 + 0.5e1 / 0.3e1 * t70 * t647);
  t652 = t651 * t30;
  t656 = t306 * t110;
  t658 = t6 * t656 * t93;
  t660 = t143 * t258;
  t662 = t6 * t660 * t93;
  t664 = t72 * t587;
  t667 = 0.2e1 / 0.45e2 * t6 * t664 * t93;
  t669 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t652 * t93 + 0.3e1 / 0.1e2 * t658 - t662 / 0.1e2 + t667);
  tv3rho30 = 0.3e1 * t296 + 0.3e1 * t320 + t7 * (t637 + t669);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t672 = 0.2e1 * t346;
  t673 = 0.2e1 * t371;
  t674 = t548 * t157;
  t677 = t232 * t327;
  t682 = 0.2e1 * t237;
  t683 = 0.6e1 * t557;
  t684 = t682 - t683;
  t685 = my_piecewise5(t11, 0, t15, 0, t684);
  t689 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t674 * t233 + 0.2e2 / 0.9e1 * t677 * t102 + 0.1e2 / 0.9e1 * t323 * t241 + 0.5e1 / 0.3e1 * t26 * t685);
  t690 = t689 * t30;
  t694 = t331 * t110;
  t697 = t6 * t694 * t60 / 0.5e1;
  t701 = t160 * t258;
  t703 = t6 * t701 * t60;
  t707 = t6 * t336 * t133 / 0.5e1;
  t716 = 0.3e1 / 0.2e2 * t6 * t690 * t60 + t697 + 0.3e1 / 0.1e2 * t6 * t332 * t133 - t703 / 0.3e2 + t707 + 0.3e1 / 0.2e2 * t6 * t161 * t291 + t571 / 0.1e2 - t578 / 0.15e2 + t581 / 0.5e1 + t591 - t593 / 0.15e2 + t596 / 0.1e2;
  t717 = my_piecewise3(t1, 0, t716);
  t718 = t639 * t168;
  t721 = t297 * t350;
  t727 = my_piecewise5(t15, 0, t11, 0, -t684);
  t731 = my_piecewise3(t68, 0, -0.1e2 / 0.27e2 * t718 * t298 + 0.2e2 / 0.9e1 * t721 * t140 + 0.1e2 / 0.9e1 * t347 * t302 + 0.5e1 / 0.3e1 * t70 * t727);
  t732 = t731 * t30;
  t736 = t354 * t110;
  t739 = t6 * t736 * t93 / 0.5e1;
  t740 = t171 * t258;
  t742 = t6 * t740 * t93;
  t751 = t6 * t311 * t194 / 0.5e1;
  t753 = t6 * t315 * t194;
  t756 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t732 * t93 + t739 - t742 / 0.3e2 + t658 / 0.1e2 - t662 / 0.15e2 + t667 + 0.3e1 / 0.2e2 * t6 * t307 * t194 + t751 - t753 / 0.3e2);
  tv3rho31 = t296 + t320 + t672 + t673 + t7 * (t717 + t756);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t759 = t548 * t376;
  t764 = t232 * t381;
  t767 = -t682 - t683;
  t768 = my_piecewise5(t11, 0, t15, 0, t767);
  t772 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t759 * t102 + 0.2e2 / 0.9e1 * t323 * t327 + 0.1e2 / 0.9e1 * t764 * t102 + 0.5e1 / 0.3e1 * t26 * t768);
  t773 = t772 * t30;
  t777 = t385 * t110;
  t779 = t6 * t777 * t60;
  t788 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t773 * t60 + t779 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t386 * t133 + t697 - t703 / 0.15e2 + t707 - t578 / 0.3e2 + t591 - t593 / 0.3e2);
  t789 = t639 * t393;
  t794 = t297 * t397;
  t798 = my_piecewise5(t15, 0, t11, 0, -t767);
  t802 = my_piecewise3(t68, 0, -0.1e2 / 0.27e2 * t789 * t140 + 0.2e2 / 0.9e1 * t347 * t350 + 0.1e2 / 0.9e1 * t794 * t140 + 0.5e1 / 0.3e1 * t70 * t798);
  t803 = t802 * t30;
  t807 = t401 * t110;
  t809 = t6 * t807 * t93;
  t816 = t6 * t359 * t194;
  t824 = t6 * t148 * t435;
  t826 = 0.3e1 / 0.2e2 * t6 * t803 * t93 + t809 / 0.1e2 + t739 - t742 / 0.15e2 + 0.3e1 / 0.1e2 * t6 * t355 * t194 + t816 / 0.5e1 - t662 / 0.3e2 + t667 + t751 - t753 / 0.15e2 + 0.3e1 / 0.2e2 * t6 * t144 * t435 + t824 / 0.1e2;
  t827 = my_piecewise3(t65, 0, t826);
  tv3rho32 = t672 + t673 + t392 + t440 + t7 * (t788 + t827);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t832 = t376 * t157;
  t838 = -0.6e1 * t237 - 0.6e1 * t557;
  t839 = my_piecewise5(t11, 0, t15, 0, t838);
  t843 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t548 * t832 + 0.1e2 / 0.3e1 * t323 * t381 + 0.5e1 / 0.3e1 * t26 * t839);
  t844 = t843 * t30;
  t851 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t844 * t60 + 0.3e1 / 0.1e2 * t779 - t703 / 0.1e2 + t591);
  t852 = t393 * t168;
  t858 = my_piecewise5(t15, 0, t11, 0, -t838);
  t862 = my_piecewise3(t68, 0, -0.1e2 / 0.27e2 * t639 * t852 + 0.1e2 / 0.3e1 * t347 * t397 + 0.5e1 / 0.3e1 * t70 * t858);
  t863 = t862 * t30;
  t878 = t176 * t176;
  t880 = 0.1e1 / t878 * t600;
  t881 = t414 * t184;
  t882 = t415 * t185;
  t886 = t184 * t415;
  t890 = t177 * t600;
  t895 = 0.1e1 / t75 / t429;
  t899 = my_piecewise3(t81, -0.7e2 / 0.81e2 * t37 * t74 * t895, 0);
  t905 = t429 * rho[1];
  t907 = 0.1e1 / t87 / t905;
  t911 = -0.6e1 * t880 * t881 * t882 + 0.6e1 * t413 * t886 * t424 + 0.5e1 * t890 * t881 * t185 - t178 * t899 * t185 - 0.3e1 * t427 * t424 * t184 - 0.77e3 / 0.243e3 * t52 * sigma[2] * t907;
  t916 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t863 * t93 + 0.3e1 / 0.1e2 * t809 + 0.9e1 / 0.2e2 * t6 * t402 * t194 - t742 / 0.1e2 + 0.3e1 / 0.5e1 * t816 + 0.9e1 / 0.2e2 * t6 * t172 * t435 + t667 - t753 / 0.1e2 + 0.3e1 / 0.1e2 * t824 + 0.3e1 / 0.2e2 * t6 * t73 * t911);
  tv3rho33 = 0.3e1 * t392 + 0.3e1 * t440 + t7 * (t851 + t916);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t924 = t6 * t250 * t211;
  t931 = t6 * t259 * t211 / 0.3e2;
  t933 = t6 * t111 * t463;
  t939 = t456 * t271;
  t952 = my_piecewise3(t45, 0.7e1 / 0.54e2 * t37 * t202 * t276, 0);
  t962 = -0.6e1 * t601 * t206 * t603 * t270 + 0.4e1 * t269 * t939 * t123 + 0.5e1 * t611 * t207 * t270 + 0.2e1 * t269 * t449 * t280 - t117 * t952 * t124 - 0.2e1 * t283 * t456 * t123 - t283 * t206 * t280 + 0.55e2 / 0.81e2 * t52 * t287;
  t967 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t246 * t211 + t924 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t106 * t463 - t931 + t933 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t962);
  tv3rho2sigma0 = t7 * t967 + 0.2e1 * t468;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t974 = t6 * t311 * t225;
  t978 = t6 * t315 * t225 / 0.3e2;
  t980 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t307 * t225 + t974 / 0.5e1 - t978);
  tv3rho2sigma2 = t7 * t980 + 0.2e1 * t477;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t986 = t6 * t336 * t211;
  t994 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t332 * t211 + t986 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t161 * t463 + t924 / 0.1e2 - t931 + t933 / 0.1e2);
  tv3rho2sigma3 = t7 * t994 + t468 + t483;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1000 = t6 * t359 * t225;
  t1007 = t6 * t148 * t502;
  t1010 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t355 * t225 + t1000 / 0.1e2 + t974 / 0.1e2 - t978 + 0.3e1 / 0.2e2 * t6 * t144 * t502 + t1007 / 0.1e2);
  tv3rho2sigma5 = t7 * t1010 + t477 + t507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1018 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t386 * t211 + t986 / 0.5e1 - t931);
  tv3rho2sigma6 = t7 * t1018 + 0.2e1 * t483;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1033 = t495 * t415;
  t1046 = my_piecewise3(t81, 0.7e1 / 0.54e2 * t37 * t216 * t420, 0);
  t1056 = -0.6e1 * t880 * t220 * t882 * t414 + 0.4e1 * t413 * t1033 * t184 + 0.5e1 * t890 * t221 * t414 + 0.2e1 * t413 * t488 * t424 - t178 * t1046 * t185 - 0.2e1 * t427 * t495 * t184 - t427 * t220 * t424 + 0.55e2 / 0.81e2 * t52 * t431;
  t1061 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t402 * t225 + t1000 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t172 * t502 - t978 + t1007 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t73 * t1056);
  tv3rho2sigma8 = t7 * t1061 + 0.2e1 * t507;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1068 = t6 * t111 * t522 / 0.1e2;
  t1069 = t509 * t603;
  t1076 = t509 * t124;
  t1080 = t518 * t271;
  t1087 = my_piecewise3(t45, t37 * t514 * t119 / 0.36e2, 0);
  t1095 = -0.6e1 * t601 * t1069 * t123 + 0.5e1 * t611 * t1076 * t123 + 0.2e1 * t269 * t1080 * t123 - t117 * t1087 * t124 - t283 * t518 * t123 - 0.2e1 * t283 * t206 * t456 + 0.4e1 * t269 * t449 * t456;
  t1100 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t106 * t522 + t1068 + 0.3e1 / 0.2e2 * t6 * t31 * t1095);
  tv3rhosigma20 = t7 * t1100 + t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1107 = t6 * t148 * t540 / 0.1e2;
  t1109 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t144 * t540 + t1107);
  tv3rhosigma25 = t7 * t1109 + t544;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1115 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t161 * t522 + t1068);
  tv3rhosigma26 = t7 * t1115 + t526;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1120 = t527 * t882;
  t1127 = t527 * t185;
  t1131 = t536 * t415;
  t1138 = my_piecewise3(t81, t37 * t532 * t180 / 0.36e2, 0);
  t1146 = -0.6e1 * t880 * t1120 * t184 + 0.5e1 * t890 * t1127 * t184 + 0.2e1 * t413 * t1131 * t184 - t178 * t1138 * t185 - t427 * t536 * t184 - 0.2e1 * t427 * t220 * t495 + 0.4e1 * t413 * t488 * t495;
  t1151 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t172 * t540 + t1107 + 0.3e1 / 0.2e2 * t6 * t73 * t1146);
  tv3rhosigma211 = t7 * t1151 + t544;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1153 = t509 * t206;
  t1163 = sigma[0] * sigma[0];
  t1165 = 0.1e1 / t38 / t1163;
  t1169 = my_piecewise3(t45, t37 * t1165 * t41 / 0.32e2, 0);
  t1175 = 0.5e1 * t611 * t1153 * t124 - 0.6e1 * t601 * t1153 * t603 - t117 * t1169 * t124 - 0.3e1 * t283 * t518 * t206 + 0.6e1 * t269 * t449 * t518;
  t1179 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * t1175);
  tv3sigma30 = t7 * t1179;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1180 = t527 * t220;
  t1190 = sigma[2] * sigma[2];
  t1192 = 0.1e1 / t74 / t1190;
  t1196 = my_piecewise3(t81, t37 * t1192 * t77 / 0.32e2, 0);
  t1202 = 0.5e1 * t890 * t1180 * t185 - 0.6e1 * t880 * t1180 * t882 - t178 * t1196 * t185 - 0.3e1 * t427 * t536 * t220 + 0.6e1 * t413 * t488 * t536;
  t1206 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * t1202);
  tv3sigma39 = t7 * t1206;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1210 = 0.1e1 / t29 / t236;
  t1214 = 0.14e2 / 0.135e3 * t6 * t28 * t1210 * t60;
  t1217 = t6 * t564 * t110 * t60;
  t1221 = t6 * t245 * t258 * t60;
  t1225 = t6 * t105 * t587 * t60;
  t1228 = t6 * t250 * t291;
  t1234 = t6 * t588 * t133;
  t1237 = t6 * t259 * t291;
  t1240 = t6 * t111 * t632;
  t1244 = t268 * t268;
  t1245 = 0.1e1 / t598 / t48 * t1244;
  t1246 = t270 * t270;
  t1247 = t271 * t271;
  t1255 = t267 * t1244;
  t1259 = t280 * t280;
  t1270 = t49 * t1244;
  t1278 = my_piecewise3(t45, 0.91e3 / 0.243e3 * t37 * t38 / t39 / t626, 0);
  t1292 = 0.24e2 * t1245 * t1246 * t1247 - 0.36e2 * t601 * t270 * t603 * t280 - 0.28e2 * t1255 * t1246 * t271 + 0.6e1 * t269 * t1259 * t271 + 0.3e2 * t611 * t270 * t124 * t280 + 0.8e1 * t269 * t607 * t620 + 0.5e1 * t1270 * t1246 - t117 * t1278 * t124 - 0.4e1 * t283 * t620 * t123 - 0.3e1 * t283 * t1259 + 0.1309e5 / 0.729e3 * t52 * sigma[0] / t54 / t285 / t53;
  t1296 = t20 * t20;
  t1298 = 0.1e1 / t25 / t1296;
  t1299 = t233 * t233;
  t1305 = t241 * t241;
  t1312 = t17 / t555 / t7;
  t1314 = -0.24e2 * t556 + 0.24e2 * t1312;
  t1315 = my_piecewise5(t11, 0, t15, 0, t1314);
  t1319 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1298 * t1299 - 0.2e2 / 0.9e1 * t548 * t233 * t241 + 0.1e2 / 0.3e1 * t232 * t1305 + 0.4e2 / 0.9e1 * t552 * t560 + 0.5e1 / 0.3e1 * t26 * t1315);
  t1328 = t6 * t569 * t133;
  t1334 = t6 * t576 * t133;
  t1336 = -t1214 + 0.2e1 / 0.5e1 * t1217 - t1221 / 0.5e1 + 0.8e1 / 0.45e2 * t1225 + 0.6e1 / 0.5e1 * t1228 + 0.3e1 / 0.5e1 * t6 * t106 * t632 + 0.8e1 / 0.45e2 * t1234 - t1237 / 0.5e1 + 0.2e1 / 0.5e1 * t1240 + 0.3e1 / 0.2e2 * t6 * t31 * t1292 + 0.3e1 / 0.2e2 * t6 * t1319 * t30 * t60 + 0.3e1 / 0.5e1 * t6 * t565 * t133 + 0.6e1 / 0.5e1 * t1328 + 0.9e1 / 0.1e2 * t6 * t246 * t291 - 0.2e1 / 0.5e1 * t1334;
  t1337 = my_piecewise3(t1, 0, t1336);
  t1338 = t67 * t67;
  t1340 = 0.1e1 / t69 / t1338;
  t1341 = t298 * t298;
  t1347 = t302 * t302;
  t1353 = my_piecewise5(t15, 0, t11, 0, -t1314);
  t1357 = my_piecewise3(t68, 0, 0.4e2 / 0.81e2 * t1340 * t1341 - 0.2e2 / 0.9e1 * t639 * t298 * t302 + 0.1e2 / 0.3e1 * t297 * t1347 + 0.4e2 / 0.9e1 * t643 * t647 + 0.5e1 / 0.3e1 * t70 * t1353);
  t1364 = t6 * t651 * t110 * t93;
  t1368 = t6 * t306 * t258 * t93;
  t1372 = t6 * t143 * t587 * t93;
  t1377 = 0.14e2 / 0.135e3 * t6 * t72 * t1210 * t93;
  t1379 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t1357 * t30 * t93 + 0.2e1 / 0.5e1 * t1364 - t1368 / 0.5e1 + 0.8e1 / 0.45e2 * t1372 - t1377);
  tv4rho40 = 0.4e1 * t637 + 0.4e1 * t669 + t7 * (t1337 + t1379);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1386 = t6 * t689 * t110 * t60;
  t1390 = t6 * t331 * t258 * t60;
  t1391 = t1390 / 0.1e2;
  t1394 = t6 * t160 * t587 * t60;
  t1415 = 0.12e2 * t556;
  t1416 = 0.24e2 * t1312;
  t1417 = -t1415 + t1416;
  t1418 = my_piecewise5(t11, 0, t15, 0, t1417);
  t1422 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1298 * t157 * t549 - 0.1e2 / 0.9e1 * t548 * t327 * t233 - 0.1e2 / 0.9e1 * t674 * t102 * t241 + 0.1e2 / 0.3e1 * t232 * t685 * t102 + 0.1e2 / 0.3e1 * t677 * t241 + 0.1e2 / 0.9e1 * t323 * t560 + 0.5e1 / 0.3e1 * t26 * t1418);
  t1431 = t6 * t694 * t133;
  t1437 = t6 * t701 * t133;
  t1438 = t1437 / 0.1e2;
  t1440 = t6 * t336 * t291;
  t1451 = 0.3e1 / 0.1e2 * t1386 - t1391 + 0.2e1 / 0.45e2 * t1394 - t1214 + t1217 / 0.1e2 - t1221 / 0.1e2 + 0.2e1 / 0.15e2 * t1225 + 0.3e1 / 0.2e2 * t6 * t1422 * t30 * t60 + 0.9e1 / 0.2e2 * t6 * t690 * t133 + 0.3e1 / 0.5e1 * t1431 + 0.9e1 / 0.2e2 * t6 * t332 * t291 - t1438 + 0.3e1 / 0.1e2 * t1440 + 0.3e1 / 0.2e2 * t6 * t161 * t632 + 0.3e1 / 0.1e2 * t1228 + 0.2e1 / 0.15e2 * t1234 - t1237 / 0.1e2 + t1240 / 0.1e2 + 0.3e1 / 0.1e2 * t1328 - t1334 / 0.5e1;
  t1452 = my_piecewise3(t1, 0, t1451);
  t1470 = my_piecewise5(t15, 0, t11, 0, -t1417);
  t1474 = my_piecewise3(t68, 0, 0.4e2 / 0.81e2 * t1340 * t168 * t640 - 0.1e2 / 0.9e1 * t639 * t350 * t298 - 0.1e2 / 0.9e1 * t718 * t140 * t302 + 0.1e2 / 0.3e1 * t297 * t727 * t140 + 0.1e2 / 0.3e1 * t721 * t302 + 0.1e2 / 0.9e1 * t347 * t647 + 0.5e1 / 0.3e1 * t70 * t1470);
  t1481 = t6 * t731 * t110 * t93;
  t1485 = t6 * t354 * t258 * t93;
  t1486 = t1485 / 0.1e2;
  t1489 = t6 * t171 * t587 * t93;
  t1498 = t6 * t656 * t194;
  t1501 = t6 * t660 * t194;
  t1502 = t1501 / 0.1e2;
  t1504 = t6 * t664 * t194;
  t1506 = 0.3e1 / 0.2e2 * t6 * t1474 * t30 * t93 + 0.3e1 / 0.1e2 * t1481 - t1486 + 0.2e1 / 0.45e2 * t1489 + t1364 / 0.1e2 - t1368 / 0.1e2 + 0.2e1 / 0.15e2 * t1372 - t1377 + 0.3e1 / 0.2e2 * t6 * t652 * t194 + 0.3e1 / 0.1e2 * t1498 - t1502 + 0.2e1 / 0.45e2 * t1504;
  t1507 = my_piecewise3(t65, 0, t1506);
  tv4rho41 = t637 + t669 + 0.3e1 * t717 + 0.3e1 * t756 + t7 * (t1452 + t1507);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1516 = t6 * t772 * t110 * t60;
  t1520 = t6 * t385 * t258 * t60;
  t1535 = t327 * t327;
  t1548 = my_piecewise5(t11, 0, t15, 0, t1416);
  t1552 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1298 * t376 * t233 - 0.4e2 / 0.27e2 * t674 * t102 * t327 - 0.1e2 / 0.27e2 * t759 * t241 + 0.2e2 / 0.9e1 * t232 * t1535 + 0.2e2 / 0.9e1 * t323 * t685 - 0.1e2 / 0.27e2 * t548 * t381 * t233 + 0.2e2 / 0.9e1 * t232 * t768 * t102 + 0.1e2 / 0.9e1 * t764 * t241 + 0.5e1 / 0.3e1 * t26 * t1548);
  t1561 = t6 * t777 * t133;
  t1572 = t1516 / 0.5e1 - t1520 / 0.3e2 + t1386 / 0.5e1 - 0.2e1 / 0.15e2 * t1390 + 0.4e1 / 0.45e2 * t1394 - t1214 - t1221 / 0.3e2 + 0.4e1 / 0.45e2 * t1225 + 0.3e1 / 0.2e2 * t6 * t1552 * t30 * t60 + 0.3e1 / 0.1e2 * t6 * t773 * t133 + t1561 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t386 * t291 + 0.2e1 / 0.5e1 * t1431 - 0.2e1 / 0.15e2 * t1437 + t1440 / 0.5e1 + 0.4e1 / 0.45e2 * t1234 - t1237 / 0.3e2 - t1334 / 0.15e2;
  t1573 = my_piecewise3(t1, 0, t1572);
  t1582 = t350 * t350;
  t1595 = my_piecewise5(t15, 0, t11, 0, -t1416);
  t1599 = my_piecewise3(t68, 0, 0.4e2 / 0.81e2 * t1340 * t393 * t298 - 0.4e2 / 0.27e2 * t718 * t140 * t350 - 0.1e2 / 0.27e2 * t789 * t302 + 0.2e2 / 0.9e1 * t297 * t1582 + 0.2e2 / 0.9e1 * t347 * t727 - 0.1e2 / 0.27e2 * t639 * t397 * t298 + 0.2e2 / 0.9e1 * t297 * t798 * t140 + 0.1e2 / 0.9e1 * t794 * t302 + 0.5e1 / 0.3e1 * t70 * t1595);
  t1606 = t6 * t802 * t110 * t93;
  t1610 = t6 * t401 * t258 * t93;
  t1619 = t6 * t736 * t194;
  t1622 = t6 * t740 * t194;
  t1633 = t6 * t311 * t435;
  t1636 = t6 * t315 * t435;
  t1638 = 0.3e1 / 0.2e2 * t6 * t1599 * t30 * t93 + t1606 / 0.5e1 - t1610 / 0.3e2 + t1481 / 0.5e1 - 0.2e1 / 0.15e2 * t1485 + 0.4e1 / 0.45e2 * t1489 + 0.3e1 / 0.1e2 * t6 * t732 * t194 + 0.2e1 / 0.5e1 * t1619 - t1622 / 0.15e2 - t1368 / 0.3e2 + 0.4e1 / 0.45e2 * t1372 - t1377 + t1498 / 0.5e1 - 0.2e1 / 0.15e2 * t1501 + 0.4e1 / 0.45e2 * t1504 + 0.3e1 / 0.2e2 * t6 * t307 * t435 + t1633 / 0.5e1 - t1636 / 0.3e2;
  t1639 = my_piecewise3(t65, 0, t1638);
  tv4rho42 = 0.2e1 * t717 + 0.2e1 * t756 + 0.2e1 * t788 + 0.2e1 * t827 + t7 * (t1573 + t1639);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1659 = t1415 + t1416;
  t1660 = my_piecewise5(t11, 0, t15, 0, t1659);
  t1664 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1298 * t832 * t102 - 0.1e2 / 0.9e1 * t759 * t327 - 0.1e2 / 0.9e1 * t674 * t381 * t102 + 0.1e2 / 0.3e1 * t677 * t381 + 0.1e2 / 0.3e1 * t323 * t768 + 0.1e2 / 0.9e1 * t232 * t839 * t102 + 0.5e1 / 0.3e1 * t26 * t1660);
  t1671 = t6 * t843 * t110 * t60;
  t1682 = 0.3e1 / 0.2e2 * t6 * t1664 * t30 * t60 + t1671 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t844 * t133 + 0.3e1 / 0.1e2 * t1516 - t1520 / 0.1e2 + 0.3e1 / 0.1e2 * t1561 - t1391 + 0.2e1 / 0.15e2 * t1394 - t1438 + 0.2e1 / 0.45e2 * t1225 - t1214 + 0.2e1 / 0.45e2 * t1234;
  t1683 = my_piecewise3(t1, 0, t1682);
  t1700 = my_piecewise5(t15, 0, t11, 0, -t1659);
  t1704 = my_piecewise3(t68, 0, 0.4e2 / 0.81e2 * t1340 * t852 * t140 - 0.1e2 / 0.9e1 * t789 * t350 - 0.1e2 / 0.9e1 * t718 * t397 * t140 + 0.1e2 / 0.3e1 * t721 * t397 + 0.1e2 / 0.3e1 * t347 * t798 + 0.1e2 / 0.9e1 * t297 * t858 * t140 + 0.5e1 / 0.3e1 * t70 * t1700);
  t1711 = t6 * t862 * t110 * t93;
  t1719 = t6 * t807 * t194;
  t1728 = t6 * t359 * t435;
  t1738 = t6 * t148 * t911;
  t1740 = 0.3e1 / 0.2e2 * t6 * t1704 * t30 * t93 + t1711 / 0.1e2 + 0.3e1 / 0.1e2 * t1606 - t1610 / 0.1e2 + 0.9e1 / 0.2e2 * t6 * t803 * t194 + 0.3e1 / 0.1e2 * t1719 - t1486 + 0.2e1 / 0.15e2 * t1489 + 0.3e1 / 0.5e1 * t1619 - t1622 / 0.5e1 + 0.9e1 / 0.2e2 * t6 * t355 * t435 + 0.3e1 / 0.1e2 * t1728 + 0.2e1 / 0.45e2 * t1372 - t1377 - t1502 + 0.2e1 / 0.15e2 * t1504 + 0.3e1 / 0.1e2 * t1633 - t1636 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t144 * t911 + t1738 / 0.1e2;
  t1741 = my_piecewise3(t65, 0, t1740);
  tv4rho43 = 0.3e1 * t788 + 0.3e1 * t827 + t851 + t916 + t7 * (t1683 + t1741);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1746 = t376 * t376;
  t1751 = t381 * t381;
  t1757 = 0.24e2 * t556 + 0.24e2 * t1312;
  t1758 = my_piecewise5(t11, 0, t15, 0, t1757);
  t1762 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t1298 * t1746 - 0.2e2 / 0.9e1 * t759 * t381 + 0.1e2 / 0.3e1 * t232 * t1751 + 0.4e2 / 0.9e1 * t323 * t839 + 0.5e1 / 0.3e1 * t26 * t1758);
  t1771 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t1762 * t30 * t60 + 0.2e1 / 0.5e1 * t1671 - t1520 / 0.5e1 + 0.8e1 / 0.45e2 * t1394 - t1214);
  t1781 = t393 * t393;
  t1786 = t397 * t397;
  t1792 = my_piecewise5(t15, 0, t11, 0, -t1757);
  t1796 = my_piecewise3(t68, 0, 0.4e2 / 0.81e2 * t1340 * t1781 - 0.2e2 / 0.9e1 * t789 * t397 + 0.1e2 / 0.3e1 * t297 * t1786 + 0.4e2 / 0.9e1 * t347 * t858 + 0.5e1 / 0.3e1 * t70 * t1792);
  t1812 = 0.1e1 / t878 / t84 * t1244;
  t1813 = t414 * t414;
  t1814 = t415 * t415;
  t1822 = t412 * t1244;
  t1826 = t424 * t424;
  t1837 = t85 * t1244;
  t1845 = my_piecewise3(t81, 0.91e3 / 0.243e3 * t37 * t74 / t75 / t905, 0);
  t1859 = 0.24e2 * t1812 * t1813 * t1814 - 0.36e2 * t880 * t414 * t882 * t424 - 0.28e2 * t1822 * t1813 * t415 + 0.6e1 * t413 * t1826 * t415 + 0.3e2 * t890 * t414 * t185 * t424 + 0.8e1 * t413 * t886 * t899 + 0.5e1 * t1837 * t1813 - t178 * t1845 * t185 - 0.4e1 * t427 * t899 * t184 - 0.3e1 * t427 * t1826 + 0.1309e5 / 0.729e3 * t52 * sigma[2] / t87 / t429 / t86;
  t1863 = 0.2e1 / 0.5e1 * t1711 + 0.6e1 / 0.5e1 * t1719 + 0.6e1 / 0.5e1 * t1728 + 0.2e1 / 0.5e1 * t1738 - t1610 / 0.5e1 - 0.2e1 / 0.5e1 * t1622 - t1636 / 0.5e1 + 0.8e1 / 0.45e2 * t1489 + 0.8e1 / 0.45e2 * t1504 - t1377 + 0.3e1 / 0.2e2 * t6 * t1796 * t30 * t93 + 0.3e1 / 0.5e1 * t6 * t863 * t194 + 0.9e1 / 0.1e2 * t6 * t402 * t435 + 0.3e1 / 0.5e1 * t6 * t172 * t911 + 0.3e1 / 0.2e2 * t6 * t73 * t1859;
  t1864 = my_piecewise3(t65, 0, t1863);
  tv4rho44 = 0.4e1 * t851 + 0.4e1 * t916 + t7 * (t1771 + t1864);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1872 = t6 * t569 * t211;
  t1878 = t6 * t576 * t211;
  t1881 = t6 * t250 * t463;
  t1888 = 0.2e1 / 0.45e2 * t6 * t588 * t211;
  t1890 = t6 * t259 * t463;
  t1893 = t6 * t111 * t962;
  t1908 = t601 * t206;
  t1909 = t603 * t123;
  t1913 = t611 * t206;
  t1937 = my_piecewise3(t45, -0.35e2 / 0.81e2 * t37 * t202 * t616, 0);
  t1947 = 0.24e2 * t1245 * t206 * t1247 * t602 - 0.28e2 * t1255 * t449 * t602 + 0.15e2 * t611 * t457 * t270 - 0.3e1 * t283 * t952 * t123 - 0.18e2 * t1908 * t1909 * t280 + 0.15e2 * t1913 * t125 * t280 - 0.18e2 * t601 * t456 * t603 * t270 + 0.6e1 * t269 * t952 * t271 * t123 + 0.6e1 * t269 * t939 * t280 + 0.2e1 * t269 * t449 * t620 + 0.5e1 * t1270 * t206 * t602 - t117 * t1937 * t124 - 0.3e1 * t283 * t456 * t280 - t283 * t206 * t620 - 0.77e3 / 0.243e3 * t52 * t628;
  t1952 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t565 * t211 + 0.3e1 / 0.1e2 * t1872 + 0.9e1 / 0.2e2 * t6 * t246 * t463 - t1878 / 0.1e2 + 0.3e1 / 0.5e1 * t1881 + 0.9e1 / 0.2e2 * t6 * t106 * t962 + t1888 - t1890 / 0.1e2 + 0.3e1 / 0.1e2 * t1893 + 0.3e1 / 0.2e2 * t6 * t31 * t1947);
  tv4rho3sigma0 = t7 * t1952 + 0.3e1 * t967;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1959 = t6 * t656 * t225;
  t1962 = t6 * t660 * t225;
  t1966 = 0.2e1 / 0.45e2 * t6 * t664 * t225;
  t1968 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t652 * t225 + 0.3e1 / 0.1e2 * t1959 - t1962 / 0.1e2 + t1966);
  tv4rho3sigma2 = t7 * t1968 + 0.3e1 * t980;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1970 = 0.2e1 * t994;
  t1976 = t6 * t694 * t211 / 0.5e1;
  t1981 = t6 * t701 * t211;
  t1985 = t6 * t336 * t463 / 0.5e1;
  t1994 = 0.3e1 / 0.2e2 * t6 * t690 * t211 + t1976 + 0.3e1 / 0.1e2 * t6 * t332 * t463 - t1981 / 0.3e2 + t1985 + 0.3e1 / 0.2e2 * t6 * t161 * t962 + t1872 / 0.1e2 - t1878 / 0.15e2 + t1881 / 0.5e1 + t1888 - t1890 / 0.15e2 + t1893 / 0.1e2;
  t1995 = my_piecewise3(t1, 0, t1994);
  tv4rho3sigma3 = t7 * t1995 + t1970 + t967;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1997 = 0.2e1 * t1010;
  t2003 = t6 * t736 * t225 / 0.5e1;
  t2005 = t6 * t740 * t225;
  t2014 = t6 * t311 * t502 / 0.5e1;
  t2016 = t6 * t315 * t502;
  t2019 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t732 * t225 + t2003 - t2005 / 0.3e2 + t1959 / 0.1e2 - t1962 / 0.15e2 + t1966 + 0.3e1 / 0.2e2 * t6 * t307 * t502 + t2014 - t2016 / 0.3e2);
  tv4rho3sigma5 = t7 * t2019 + t1997 + t980;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2025 = t6 * t777 * t211;
  t2034 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t773 * t211 + t2025 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t386 * t463 + t1976 - t1981 / 0.15e2 + t1985 - t1878 / 0.3e2 + t1888 - t1890 / 0.3e2);
  tv4rho3sigma6 = t7 * t2034 + t1018 + t1970;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2040 = t6 * t807 * t225;
  t2047 = t6 * t359 * t502;
  t2055 = t6 * t148 * t1056;
  t2057 = 0.3e1 / 0.2e2 * t6 * t803 * t225 + t2040 / 0.1e2 + t2003 - t2005 / 0.15e2 + 0.3e1 / 0.1e2 * t6 * t355 * t502 + t2047 / 0.5e1 - t1962 / 0.3e2 + t1966 + t2014 - t2016 / 0.15e2 + 0.3e1 / 0.2e2 * t6 * t144 * t1056 + t2055 / 0.1e2;
  t2058 = my_piecewise3(t65, 0, t2057);
  tv4rho3sigma8 = t7 * t2058 + t1061 + t1997;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2067 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t844 * t211 + 0.3e1 / 0.1e2 * t2025 - t1981 / 0.1e2 + t1888);
  tv4rho3sigma9 = t7 * t2067 + 0.3e1 * t1018;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2084 = t890 * t220;
  t2091 = t880 * t220;
  t2092 = t882 * t184;
  t2126 = my_piecewise3(t81, -0.35e2 / 0.81e2 * t37 * t216 * t895, 0);
  t2136 = 0.15e2 * t2084 * t186 * t424 - 0.3e1 * t427 * t1046 * t184 - 0.18e2 * t2091 * t2092 * t424 - 0.18e2 * t880 * t495 * t882 * t414 + 0.6e1 * t413 * t1046 * t415 * t184 + 0.6e1 * t413 * t1033 * t424 + 0.2e1 * t413 * t488 * t899 + 0.24e2 * t1812 * t220 * t1814 * t881 - 0.28e2 * t1822 * t488 * t881 + 0.15e2 * t890 * t496 * t414 + 0.5e1 * t1837 * t220 * t881 - t178 * t2126 * t185 - 0.3e1 * t427 * t495 * t424 - t427 * t220 * t899 - 0.77e3 / 0.243e3 * t52 * t907;
  t2141 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t863 * t225 + 0.3e1 / 0.1e2 * t2040 + 0.9e1 / 0.2e2 * t6 * t402 * t502 - t2005 / 0.1e2 + 0.3e1 / 0.5e1 * t2047 + 0.9e1 / 0.2e2 * t6 * t172 * t1056 + t1966 - t2016 / 0.1e2 + 0.3e1 / 0.1e2 * t2055 + 0.3e1 / 0.2e2 * t6 * t73 * t2136);
  tv4rho3sigma11 = t7 * t2141 + 0.3e1 * t1061;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2148 = t6 * t250 * t522;
  t2155 = t6 * t259 * t522 / 0.3e2;
  t2157 = t6 * t111 * t1095;
  t2168 = t456 * t456;
  t2195 = t518 * t603;
  t2208 = my_piecewise3(t45, -0.7e1 / 0.108e3 * t37 * t514 * t276, 0);
  t2218 = -0.2e1 * t283 * t1087 * t123 - 0.24e2 * t1908 * t1909 * t456 - 0.6e1 * t601 * t1069 * t280 + 0.4e1 * t269 * t2168 * t271 + 0.4e1 * t269 * t449 * t952 + 0.5e1 * t611 * t1076 * t280 + 0.4e1 * t269 * t1087 * t271 * t123 + 0.2e1 * t269 * t1080 * t280 + 0.24e2 * t1245 * t509 * t1247 * t270 - 0.28e2 * t1255 * t510 * t270 + 0.2e2 * t1913 * t457 * t123 - 0.6e1 * t601 * t2195 * t270 + 0.5e1 * t611 * t519 * t270 + 0.5e1 * t1270 * t509 * t270 - t117 * t2208 * t124 - t283 * t518 * t280 - 0.2e1 * t283 * t2168 - 0.2e1 * t283 * t206 * t952;
  t2223 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t246 * t522 + t2148 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t106 * t1095 - t2155 + t2157 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t31 * t2218);
  tv4rho2sigma20 = t7 * t2223 + 0.2e1 * t1100;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2230 = t6 * t311 * t540;
  t2234 = t6 * t315 * t540 / 0.3e2;
  t2236 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t307 * t540 + t2230 / 0.5e1 - t2234);
  tv4rho2sigma25 = t7 * t2236 + 0.2e1 * t1109;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2242 = t6 * t336 * t522;
  t2250 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t332 * t522 + t2242 / 0.1e2 + 0.3e1 / 0.2e2 * t6 * t161 * t1095 + t2148 / 0.1e2 - t2155 + t2157 / 0.1e2);
  tv4rho2sigma26 = t7 * t2250 + t1100 + t1115;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2256 = t6 * t359 * t540;
  t2263 = t6 * t148 * t1146;
  t2266 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t355 * t540 + t2256 / 0.1e2 + t2230 / 0.1e2 - t2234 + 0.3e1 / 0.2e2 * t6 * t144 * t1146 + t2263 / 0.1e2);
  tv4rho2sigma211 = t7 * t2266 + t1109 + t1151;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2274 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t386 * t522 + t2242 / 0.5e1 - t2155);
  tv4rho2sigma212 = t7 * t2274 + 0.2e1 * t1115;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2288 = my_piecewise3(t81, -0.7e1 / 0.108e3 * t37 * t532 * t420, 0);
  t2293 = t495 * t495;
  t2334 = t536 * t882;
  t2344 = -t178 * t2288 * t185 - t427 * t536 * t424 - 0.2e1 * t427 * t2293 - 0.2e1 * t427 * t220 * t1046 - 0.24e2 * t2091 * t2092 * t495 - 0.2e1 * t427 * t1138 * t184 - 0.6e1 * t880 * t1120 * t424 + 0.4e1 * t413 * t2293 * t415 + 0.4e1 * t413 * t488 * t1046 + 0.5e1 * t890 * t1127 * t424 + 0.4e1 * t413 * t1138 * t415 * t184 + 0.2e1 * t413 * t1131 * t424 + 0.24e2 * t1812 * t527 * t1814 * t414 - 0.28e2 * t1822 * t528 * t414 + 0.2e2 * t2084 * t496 * t184 - 0.6e1 * t880 * t2334 * t414 + 0.5e1 * t890 * t537 * t414 + 0.5e1 * t1837 * t527 * t414;
  t2349 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t402 * t540 + t2256 / 0.5e1 + 0.3e1 / 0.1e2 * t6 * t172 * t1146 - t2234 + t2263 / 0.5e1 + 0.3e1 / 0.2e2 * t6 * t73 * t2344);
  tv4rho2sigma217 = t7 * t2349 + 0.2e1 * t1151;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2356 = t6 * t111 * t1175 / 0.1e2;
  t2393 = my_piecewise3(t45, -t37 * t1165 * t119 / 0.24e2, 0);
  t2404 = 0.24e2 * t1245 * t1153 * t1247 * t123 - 0.28e2 * t1255 * t1153 * t271 * t123 + 0.2e1 * t269 * t1169 * t271 * t123 - 0.18e2 * t601 * t1069 * t456 + 0.15e2 * t611 * t1076 * t456 - 0.3e1 * t283 * t1087 * t206 + 0.6e1 * t269 * t449 * t1087 + 0.5e1 * t1270 * t1153 * t123 - t283 * t1169 * t123 - t117 * t2393 * t124 - 0.18e2 * t1908 * t2195 * t123 + 0.15e2 * t1913 * t519 * t123 + 0.6e1 * t269 * t939 * t518 - 0.3e1 * t283 * t518 * t456;
  t2409 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t106 * t1175 + t2356 + 0.3e1 / 0.2e2 * t6 * t31 * t2404);
  tv4rhosigma30 = t7 * t2409 + t1179;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2416 = t6 * t148 * t1202 / 0.1e2;
  t2418 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t144 * t1202 + t2416);
  tv4rhosigma39 = t7 * t2418 + t1206;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2424 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t161 * t1175 + t2356);
  tv4rhosigma310 = t7 * t2424 + t1179;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2465 = my_piecewise3(t81, -t37 * t1192 * t180 / 0.24e2, 0);
  t2476 = 0.24e2 * t1812 * t1180 * t1814 * t184 - 0.28e2 * t1822 * t1180 * t415 * t184 + 0.2e1 * t413 * t1196 * t415 * t184 + 0.6e1 * t413 * t1033 * t536 - 0.18e2 * t880 * t1120 * t495 + 0.15e2 * t890 * t1127 * t495 - 0.3e1 * t427 * t1138 * t220 + 0.6e1 * t413 * t488 * t1138 + 0.5e1 * t1837 * t1180 * t184 - t427 * t1196 * t184 - t178 * t2465 * t185 + 0.15e2 * t2084 * t537 * t184 - 0.18e2 * t2091 * t2334 * t184 - 0.3e1 * t427 * t536 * t495;
  t2481 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t172 * t1202 + t2416 + 0.3e1 / 0.2e2 * t6 * t73 * t2476);
  tv4rhosigma319 = t7 * t2481 + t1206;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2483 = t509 * t509;
  t2493 = t518 * t518;
  t2511 = my_piecewise3(t45, -0.5e1 / 0.64e2 * t37 / t38 / t1163 / sigma[0] * t41, 0);
  t2523 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t31 * (-0.36e2 * t601 * t1069 * t518 + 0.3e2 * t611 * t1076 * t518 - 0.4e1 * t283 * t1169 * t206 + 0.8e1 * t269 * t449 * t1169 - t117 * t2511 * t124 + 0.24e2 * t1245 * t2483 * t1247 - 0.28e2 * t1255 * t2483 * t271 + 0.6e1 * t269 * t2493 * t271 + 0.5e1 * t1270 * t2483 - 0.3e1 * t283 * t2493));
  tv4sigma40 = t7 * t2523;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2524 = t527 * t527;
  t2534 = t536 * t536;
  t2552 = my_piecewise3(t81, -0.5e1 / 0.64e2 * t37 / t74 / t1190 / sigma[2] * t77, 0);
  t2564 = my_piecewise3(t65, 0, 0.3e1 / 0.2e2 * t6 * t73 * (-0.36e2 * t880 * t1120 * t536 + 0.3e2 * t890 * t1127 * t536 - 0.4e1 * t427 * t1196 * t220 + 0.8e1 * t413 * t488 * t1196 - t178 * t2552 * t185 + 0.24e2 * t1812 * t2524 * t1814 - 0.28e2 * t1822 * t2524 * t415 + 0.6e1 * t413 * t2534 * t415 + 0.5e1 * t1837 * t2524 - 0.3e1 * t427 * t2534));
  tv4sigma414 = t7 * t2564;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

