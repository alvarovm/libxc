/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_2d_pbe.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t20, t21, t25, t28;
  double t32, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t25 = 0.4604e0 + 0.14106971928508582281e-1 * sigma[0] / t21;
  t28 = 0.14604e1 - 0.21196816e0 / t25;
  t32 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t17 * t18 * t28);
  tzk0 = 0.2e1 * t32;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t20, t21, t25, t28;
  double t32, tzk0;

  double t38, t40, t41, t42, t43, t48, tvrho0, t52;
  double t56, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t25 = 0.4604e0 + 0.14106971928508582281e-1 * sigma[0] / t21;
  t28 = 0.14604e1 - 0.21196816e0 / t25;
  t32 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t17 * t18 * t28);
  tzk0 = 0.2e1 * t32;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t15 * t17;
  t40 = 0.1e1 / t18 / t21;
  t41 = t25 * t25;
  t42 = 0.1e1 / t41;
  t43 = t40 * t42;
  t48 = my_piecewise3(t2, 0, -t16 * t17 / t18 * t28 / 0.3e1 + 0.33741119762638214745e-2 * t38 * t43 * sigma[0]);
  tvrho0 = 0.2e1 * rho[0] * t48 + 0.2e1 * t32;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t52 = 0.1e1 / t18 / t20;
  t56 = my_piecewise3(t2, 0, -0.11247039920879404915e-2 * t38 * t52 * t42);
  tvsigma0 = 0.2e1 * rho[0] * t56;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t20, t21, t25, t28;
  double t32, tzk0;

  double t38, t40, t41, t42, t43, t48, tvrho0, t52;
  double t56, tvsigma0;

  double t65, t68, t72, t76, t77, t78, t83, tv2rho20;
  double t88, t90, t91, t96, tv2rhosigma0, t99, t101, t105;
  double tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t25 = 0.4604e0 + 0.14106971928508582281e-1 * sigma[0] / t21;
  t28 = 0.14604e1 - 0.21196816e0 / t25;
  t32 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t17 * t18 * t28);
  tzk0 = 0.2e1 * t32;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t15 * t17;
  t40 = 0.1e1 / t18 / t21;
  t41 = t25 * t25;
  t42 = 0.1e1 / t41;
  t43 = t40 * t42;
  t48 = my_piecewise3(t2, 0, -t16 * t17 / t18 * t28 / 0.3e1 + 0.33741119762638214745e-2 * t38 * t43 * sigma[0]);
  tvrho0 = 0.2e1 * rho[0] * t48 + 0.2e1 * t32;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t52 = 0.1e1 / t18 / t20;
  t56 = my_piecewise3(t2, 0, -0.11247039920879404915e-2 * t38 * t52 * t42);
  tvsigma0 = 0.2e1 * rho[0] * t56;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t65 = t20 * t20;
  t68 = 0.1e1 / t18 / t65 * t42;
  t72 = t65 * t21;
  t76 = 0.1e1 / t41 / t25;
  t77 = 0.1e1 / t18 / t72 * t76;
  t78 = sigma[0] * sigma[0];
  t83 = my_piecewise3(t2, 0, t16 * t17 / t18 / rho[0] * t28 / 0.6e1 - 0.10122335928791464424e-1 * t38 * t68 * sigma[0] + 0.28559101759679007257e-3 * t38 * t77 * t78);
  tv2rho20 = 0.2e1 * rho[0] * t83 + 0.4e1 * t48;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t88 = t65 * t20;
  t90 = 0.1e1 / t18 / t88;
  t91 = t90 * t76;
  t96 = my_piecewise3(t2, 0, 0.28117599802198512288e-2 * t38 * t43 - 0.95197005865596690856e-4 * t38 * t91 * sigma[0]);
  tv2rhosigma0 = 0.2e1 * rho[0] * t96 + 0.2e1 * t56;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t99 = t65 * rho[0];
  t101 = 0.1e1 / t18 / t99;
  t105 = my_piecewise3(t2, 0, 0.31732335288532230285e-4 * t38 * t101 * t76);
  tv2sigma20 = 0.2e1 * rho[0] * t105;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t20, t21, t25, t28;
  double t32, tzk0;

  double t38, t40, t41, t42, t43, t48, tvrho0, t52;
  double t56, tvsigma0;

  double t65, t68, t72, t76, t77, t78, t83, tv2rho20;
  double t88, t90, t91, t96, tv2rhosigma0, t99, t101, t105;
  double tv2sigma20;

  double t112, t116, t118, t119, t125, t126, t127, t128;
  double t129, t134, tv3rho30, t146, t151, tv3rho2sigma0, t158, t159;
  double t164, tv3rhosigma20, t170, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t25 = 0.4604e0 + 0.14106971928508582281e-1 * sigma[0] / t21;
  t28 = 0.14604e1 - 0.21196816e0 / t25;
  t32 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t17 * t18 * t28);
  tzk0 = 0.2e1 * t32;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t15 * t17;
  t40 = 0.1e1 / t18 / t21;
  t41 = t25 * t25;
  t42 = 0.1e1 / t41;
  t43 = t40 * t42;
  t48 = my_piecewise3(t2, 0, -t16 * t17 / t18 * t28 / 0.3e1 + 0.33741119762638214745e-2 * t38 * t43 * sigma[0]);
  tvrho0 = 0.2e1 * rho[0] * t48 + 0.2e1 * t32;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t52 = 0.1e1 / t18 / t20;
  t56 = my_piecewise3(t2, 0, -0.11247039920879404915e-2 * t38 * t52 * t42);
  tvsigma0 = 0.2e1 * rho[0] * t56;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t65 = t20 * t20;
  t68 = 0.1e1 / t18 / t65 * t42;
  t72 = t65 * t21;
  t76 = 0.1e1 / t41 / t25;
  t77 = 0.1e1 / t18 / t72 * t76;
  t78 = sigma[0] * sigma[0];
  t83 = my_piecewise3(t2, 0, t16 * t17 / t18 / rho[0] * t28 / 0.6e1 - 0.10122335928791464424e-1 * t38 * t68 * sigma[0] + 0.28559101759679007257e-3 * t38 * t77 * t78);
  tv2rho20 = 0.2e1 * rho[0] * t83 + 0.4e1 * t48;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t88 = t65 * t20;
  t90 = 0.1e1 / t18 / t88;
  t91 = t90 * t76;
  t96 = my_piecewise3(t2, 0, 0.28117599802198512288e-2 * t38 * t43 - 0.95197005865596690856e-4 * t38 * t91 * sigma[0]);
  tv2rhosigma0 = 0.2e1 * rho[0] * t96 + 0.2e1 * t56;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t99 = t65 * rho[0];
  t101 = 0.1e1 / t18 / t99;
  t105 = my_piecewise3(t2, 0, 0.31732335288532230285e-4 * t38 * t101 * t76);
  tv2sigma20 = 0.2e1 * rho[0] * t105;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t112 = t101 * t42;
  t116 = t65 * t65;
  t118 = 0.1e1 / t18 / t116;
  t119 = t118 * t76;
  t125 = 0.1e1 / t18 / t116 / t21;
  t126 = t41 * t41;
  t127 = 0.1e1 / t126;
  t128 = t125 * t127;
  t129 = t78 * sigma[0];
  t134 = my_piecewise3(t2, 0, -t16 * t17 * t52 * t28 / 0.4e1 + 0.44706983685495634539e-1 * t38 * t112 * sigma[0] - 0.2998705684766295762e-2 * t38 * t119 * t78 + 0.36259420214449062971e-4 * t38 * t128 * t129);
  tv3rho30 = 0.2e1 * rho[0] * t134 + 0.6e1 * t83;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t146 = 0.1e1 / t18 / t116 / t20 * t127;
  t151 = my_piecewise3(t2, 0, -0.98411599307694793008e-2 * t38 * t68 + 0.8567730527903702177e-3 * t38 * t77 * sigma[0] - 0.12086473404816354323e-4 * t38 * t146 * t78);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t151 + 0.4e1 * t96;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t158 = 0.1e1 / t18 / t116 / rho[0];
  t159 = t158 * t127;
  t164 = my_piecewise3(t2, 0, -0.17452784408692726657e-3 * t38 * t91 + 0.40288244682721181078e-5 * t38 * t159 * sigma[0]);
  tv3rhosigma20 = 0.2e1 * rho[0] * t164 + 0.2e1 * t105;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t170 = my_piecewise3(t2, 0, -0.13429414894240393692e-5 * t38 * t118 * t127);
  tv3sigma30 = 0.2e1 * rho[0] * t170;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t6, t8, t9, t11, t13;
  double t15, t16, t17, t18, t20, t21, t25, t28;
  double t32, tzk0;

  double t38, t40, t41, t42, t43, t48, tvrho0, t52;
  double t56, tvsigma0;

  double t65, t68, t72, t76, t77, t78, t83, tv2rho20;
  double t88, t90, t91, t96, tv2rhosigma0, t99, t101, t105;
  double tv2sigma20;

  double t112, t116, t118, t119, t125, t126, t127, t128;
  double t129, t134, tv3rho30, t146, t151, tv3rho2sigma0, t158, t159;
  double t164, tv3rhosigma20, t170, tv3sigma30;

  double t187, t196, t198, t203, tv4rho40, t223, tv4rho3sigma0, t240;
  double tv4rho2sigma20, t250, tv4rhosigma30, t256, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = sqrt(M_PI);
  t5 = 0.1e1 <= p->zeta_threshold;
  t6 = p->zeta_threshold - 0.1e1;
  t8 = my_piecewise5(t5, t6, t5, -t6, 0);
  t9 = 0.1e1 + t8;
  t11 = sqrt(p->zeta_threshold);
  t13 = sqrt(t9);
  t15 = my_piecewise3(t9 <= p->zeta_threshold, t11 * p->zeta_threshold, t13 * t9);
  t16 = 0.1e1 / t3 * t15;
  t17 = M_SQRT2;
  t18 = sqrt(rho[0]);
  t20 = rho[0] * rho[0];
  t21 = t20 * rho[0];
  t25 = 0.4604e0 + 0.14106971928508582281e-1 * sigma[0] / t21;
  t28 = 0.14604e1 - 0.21196816e0 / t25;
  t32 = my_piecewise3(t2, 0, -0.2e1 / 0.3e1 * t16 * t17 * t18 * t28);
  tzk0 = 0.2e1 * t32;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t38 = t15 * t17;
  t40 = 0.1e1 / t18 / t21;
  t41 = t25 * t25;
  t42 = 0.1e1 / t41;
  t43 = t40 * t42;
  t48 = my_piecewise3(t2, 0, -t16 * t17 / t18 * t28 / 0.3e1 + 0.33741119762638214745e-2 * t38 * t43 * sigma[0]);
  tvrho0 = 0.2e1 * rho[0] * t48 + 0.2e1 * t32;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t52 = 0.1e1 / t18 / t20;
  t56 = my_piecewise3(t2, 0, -0.11247039920879404915e-2 * t38 * t52 * t42);
  tvsigma0 = 0.2e1 * rho[0] * t56;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t65 = t20 * t20;
  t68 = 0.1e1 / t18 / t65 * t42;
  t72 = t65 * t21;
  t76 = 0.1e1 / t41 / t25;
  t77 = 0.1e1 / t18 / t72 * t76;
  t78 = sigma[0] * sigma[0];
  t83 = my_piecewise3(t2, 0, t16 * t17 / t18 / rho[0] * t28 / 0.6e1 - 0.10122335928791464424e-1 * t38 * t68 * sigma[0] + 0.28559101759679007257e-3 * t38 * t77 * t78);
  tv2rho20 = 0.2e1 * rho[0] * t83 + 0.4e1 * t48;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t88 = t65 * t20;
  t90 = 0.1e1 / t18 / t88;
  t91 = t90 * t76;
  t96 = my_piecewise3(t2, 0, 0.28117599802198512288e-2 * t38 * t43 - 0.95197005865596690856e-4 * t38 * t91 * sigma[0]);
  tv2rhosigma0 = 0.2e1 * rho[0] * t96 + 0.2e1 * t56;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t99 = t65 * rho[0];
  t101 = 0.1e1 / t18 / t99;
  t105 = my_piecewise3(t2, 0, 0.31732335288532230285e-4 * t38 * t101 * t76);
  tv2sigma20 = 0.2e1 * rho[0] * t105;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t112 = t101 * t42;
  t116 = t65 * t65;
  t118 = 0.1e1 / t18 / t116;
  t119 = t118 * t76;
  t125 = 0.1e1 / t18 / t116 / t21;
  t126 = t41 * t41;
  t127 = 0.1e1 / t126;
  t128 = t125 * t127;
  t129 = t78 * sigma[0];
  t134 = my_piecewise3(t2, 0, -t16 * t17 * t52 * t28 / 0.4e1 + 0.44706983685495634539e-1 * t38 * t112 * sigma[0] - 0.2998705684766295762e-2 * t38 * t119 * t78 + 0.36259420214449062971e-4 * t38 * t128 * t129);
  tv3rho30 = 0.2e1 * rho[0] * t134 + 0.6e1 * t83;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t146 = 0.1e1 / t18 / t116 / t20 * t127;
  t151 = my_piecewise3(t2, 0, -0.98411599307694793008e-2 * t38 * t68 + 0.8567730527903702177e-3 * t38 * t77 * sigma[0] - 0.12086473404816354323e-4 * t38 * t146 * t78);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t151 + 0.4e1 * t96;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t158 = 0.1e1 / t18 / t116 / rho[0];
  t159 = t158 * t127;
  t164 = my_piecewise3(t2, 0, -0.17452784408692726657e-3 * t38 * t91 + 0.40288244682721181078e-5 * t38 * t159 * sigma[0]);
  tv3rhosigma20 = 0.2e1 * rho[0] * t164 + 0.2e1 * t105;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t170 = my_piecewise3(t2, 0, -0.13429414894240393692e-5 * t38 * t118 * t127);
  tv3sigma30 = 0.2e1 * rho[0] * t170;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t187 = 0.1e1 / t18 / t116 / t65;
  t196 = 0.1e1 / t126 / t25;
  t198 = t78 * t78;
  t203 = my_piecewise3(t2, 0, 0.5e1 / 0.8e1 * t16 * t17 * t40 * t28 - 0.24462311827912705691e0 * t38 * t90 * t42 * sigma[0] + 0.29273079303670982439e-1 * t38 * t158 * t76 * t78 - 0.79770724471787938536e-3 * t38 * t187 * t127 * t129 + 0.61381274773107548394e-5 * t38 / t18 / t116 / t72 * t196 * t198);
  tv4rho40 = 0.2e1 * rho[0] * t203 + 0.8e1 * t134;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t223 = my_piecewise3(t2, 0, 0.44285219688462656854e-1 * t38 * t112 - 0.72587716972517476778e-2 * t38 * t119 * sigma[0] + 0.2356862313939189093e-3 * t38 * t128 * t78 - 0.20460424924369182797e-5 * t38 / t18 / t116 / t88 * t196 * t129);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t223 + 0.6e1 * t151;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t240 = my_piecewise3(t2, 0, 0.11344309865650272327e-2 * t38 * t77 - 0.60432367024081771617e-4 * t38 * t146 * sigma[0] + 0.68201416414563942659e-6 * t38 / t18 / t116 / t99 * t196 * t78);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t240 + 0.4e1 * t164;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t250 = my_piecewise3(t2, 0, 0.11415002660104334638e-4 * t38 * t159 - 0.22733805471521314218e-6 * t38 * t187 * t196 * sigma[0]);
  tv4rhosigma30 = 0.2e1 * rho[0] * t250 + 0.2e1 * t170;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t256 = my_piecewise3(t2, 0, 0.75779351571737714062e-7 * t38 * t125 * t196);
  tv4sigma40 = 0.2e1 * rho[0] * t256;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t33, t36, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t48, t49, t50;
  double t51, t54, t57, t58, t61, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t33 = 0.4604e0 + 0.70534859642542911404e-2 * sigma[0] * t30;
  t36 = 0.14604e1 - 0.21196816e0 / t33;
  t37 = t27 * t36;
  t40 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t37);
  t41 = rho[1] <= p->dens_threshold;
  t42 = my_piecewise5(t12, t9, t8, t13, -t15);
  t43 = 0.1e1 + t42;
  t44 = t43 <= p->zeta_threshold;
  t45 = sqrt(t43);
  t46 = t45 * t43;
  t47 = my_piecewise3(t44, t20, t46);
  t48 = t3 * t47;
  t49 = rho[1] * rho[1];
  t50 = t49 * rho[1];
  t51 = 0.1e1 / t50;
  t54 = 0.4604e0 + 0.70534859642542911404e-2 * sigma[2] * t51;
  t57 = 0.14604e1 - 0.21196816e0 / t54;
  t58 = t27 * t57;
  t61 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t48 * t58);
  tzk0 = t40 + t61;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t33, t36, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t48, t49, t50;
  double t51, t54, t57, t58, t61, tzk0;

  double t62, t63, t64, t65, t66, t69, t70, t73;
  double t74, t75, t77, t78, t79, t80, t81, t82;
  double t83, t84, t85, t89, t91, t94, t95, t98;
  double t100, t102, tvrho0, t105, t106, t109, t110, t114;
  double t116, t119, t120, t123, t124, t125, t126, t127;
  double t128, t129, t130, t134, tvrho1, t137, t138, t141;
  double tvsigma0, tvsigma1, t142, t143, t146, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t33 = 0.4604e0 + 0.70534859642542911404e-2 * sigma[0] * t30;
  t36 = 0.14604e1 - 0.21196816e0 / t33;
  t37 = t27 * t36;
  t40 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t37);
  t41 = rho[1] <= p->dens_threshold;
  t42 = my_piecewise5(t12, t9, t8, t13, -t15);
  t43 = 0.1e1 + t42;
  t44 = t43 <= p->zeta_threshold;
  t45 = sqrt(t43);
  t46 = t45 * t43;
  t47 = my_piecewise3(t44, t20, t46);
  t48 = t3 * t47;
  t49 = rho[1] * rho[1];
  t50 = t49 * rho[1];
  t51 = 0.1e1 / t50;
  t54 = 0.4604e0 + 0.70534859642542911404e-2 * sigma[2] * t51;
  t57 = 0.14604e1 - 0.21196816e0 / t54;
  t58 = t27 * t57;
  t61 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t48 * t58);
  tzk0 = t40 + t61;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t62 = t4 * t4;
  t63 = 0.1e1 / t62;
  t64 = t14 * t63;
  t65 = t5 - t64;
  t66 = my_piecewise5(t8, 0, t12, 0, t65);
  t69 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t66);
  t70 = t3 * t69;
  t73 = 0.1e1 / t26;
  t74 = t25 * t73;
  t75 = t74 * t36;
  t77 = t24 * t75 / 0.3e1;
  t78 = t23 * t25;
  t79 = t78 * t26;
  t80 = t33 * t33;
  t81 = 0.1e1 / t80;
  t82 = t81 * sigma[0];
  t83 = t28 * t28;
  t84 = 0.1e1 / t83;
  t85 = t82 * t84;
  t89 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t70 * t37 - t77 + 0.16870559881319107373e-2 * t79 * t85);
  t91 = my_piecewise5(t12, 0, t8, 0, -t65);
  t94 = my_piecewise3(t44, 0, 0.3e1 / 0.2e1 * t45 * t91);
  t95 = t3 * t94;
  t98 = t74 * t57;
  t100 = t48 * t98 / 0.3e1;
  t102 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t95 * t58 - t100);
  tvrho0 = t40 + t61 + t4 * (t89 + t102);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t105 = -t5 - t64;
  t106 = my_piecewise5(t8, 0, t12, 0, t105);
  t109 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t106);
  t110 = t3 * t109;
  t114 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t110 * t37 - t77);
  t116 = my_piecewise5(t12, 0, t8, 0, -t105);
  t119 = my_piecewise3(t44, 0, 0.3e1 / 0.2e1 * t45 * t116);
  t120 = t3 * t119;
  t123 = t47 * t25;
  t124 = t123 * t26;
  t125 = t54 * t54;
  t126 = 0.1e1 / t125;
  t127 = t126 * sigma[2];
  t128 = t49 * t49;
  t129 = 0.1e1 / t128;
  t130 = t127 * t129;
  t134 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t120 * t58 - t100 + 0.16870559881319107373e-2 * t124 * t130);
  tvrho1 = t40 + t61 + t4 * (t114 + t134);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t137 = t26 * t81;
  t138 = t137 * t30;
  t141 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t78 * t138);
  tvsigma0 = t4 * t141;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t142 = t26 * t126;
  t143 = t142 * t51;
  t146 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t123 * t143);
  tvsigma2 = t4 * t146;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t33, t36, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t48, t49, t50;
  double t51, t54, t57, t58, t61, tzk0;

  double t62, t63, t64, t65, t66, t69, t70, t73;
  double t74, t75, t77, t78, t79, t80, t81, t82;
  double t83, t84, t85, t89, t91, t94, t95, t98;
  double t100, t102, tvrho0, t105, t106, t109, t110, t114;
  double t116, t119, t120, t123, t124, t125, t126, t127;
  double t128, t129, t130, t134, tvrho1, t137, t138, t141;
  double tvsigma0, tvsigma1, t142, t143, t146, tvsigma2;

  double t149, t150, t153, t154, t155, t157, t158, t162;
  double t163, t166, t168, t169, t173, t174, t175, t177;
  double t178, t179, t182, t183, t184, t185, t186, t187;
  double t190, t191, t192, t196, t197, t198, t202, t206;
  double t207, t210, t212, t214, t216, tv2rho20, t219, t222;
  double t223, t227, t228, t231, t233, t234, t240, t241;
  double t244, t248, t249, t252, t255, t256, t259, t260;
  double t263, tv2rho21, t268, t272, t273, t277, t278, t283;
  double t284, t288, t292, t293, t297, t298, t303, t304;
  double t305, t306, t307, t308, t311, t312, t313, t317;
  double tv2rho22, t322, t323, t325, t326, t327, t329, t332;
  double t336, tv2rhosigma0, tv2rhosigma1, t340, t341, t343, t345, tv2rhosigma2;
  double t350, tv2rhosigma3, tv2rhosigma4, t354, t355, t357, t360, t364;
  double tv2rhosigma5, t366, t367, t368, t369, t372, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t373, t374, t375, t376, t379;
  double tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t33 = 0.4604e0 + 0.70534859642542911404e-2 * sigma[0] * t30;
  t36 = 0.14604e1 - 0.21196816e0 / t33;
  t37 = t27 * t36;
  t40 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t37);
  t41 = rho[1] <= p->dens_threshold;
  t42 = my_piecewise5(t12, t9, t8, t13, -t15);
  t43 = 0.1e1 + t42;
  t44 = t43 <= p->zeta_threshold;
  t45 = sqrt(t43);
  t46 = t45 * t43;
  t47 = my_piecewise3(t44, t20, t46);
  t48 = t3 * t47;
  t49 = rho[1] * rho[1];
  t50 = t49 * rho[1];
  t51 = 0.1e1 / t50;
  t54 = 0.4604e0 + 0.70534859642542911404e-2 * sigma[2] * t51;
  t57 = 0.14604e1 - 0.21196816e0 / t54;
  t58 = t27 * t57;
  t61 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t48 * t58);
  tzk0 = t40 + t61;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t62 = t4 * t4;
  t63 = 0.1e1 / t62;
  t64 = t14 * t63;
  t65 = t5 - t64;
  t66 = my_piecewise5(t8, 0, t12, 0, t65);
  t69 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t66);
  t70 = t3 * t69;
  t73 = 0.1e1 / t26;
  t74 = t25 * t73;
  t75 = t74 * t36;
  t77 = t24 * t75 / 0.3e1;
  t78 = t23 * t25;
  t79 = t78 * t26;
  t80 = t33 * t33;
  t81 = 0.1e1 / t80;
  t82 = t81 * sigma[0];
  t83 = t28 * t28;
  t84 = 0.1e1 / t83;
  t85 = t82 * t84;
  t89 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t70 * t37 - t77 + 0.16870559881319107373e-2 * t79 * t85);
  t91 = my_piecewise5(t12, 0, t8, 0, -t65);
  t94 = my_piecewise3(t44, 0, 0.3e1 / 0.2e1 * t45 * t91);
  t95 = t3 * t94;
  t98 = t74 * t57;
  t100 = t48 * t98 / 0.3e1;
  t102 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t95 * t58 - t100);
  tvrho0 = t40 + t61 + t4 * (t89 + t102);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t105 = -t5 - t64;
  t106 = my_piecewise5(t8, 0, t12, 0, t105);
  t109 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t106);
  t110 = t3 * t109;
  t114 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t110 * t37 - t77);
  t116 = my_piecewise5(t12, 0, t8, 0, -t105);
  t119 = my_piecewise3(t44, 0, 0.3e1 / 0.2e1 * t45 * t116);
  t120 = t3 * t119;
  t123 = t47 * t25;
  t124 = t123 * t26;
  t125 = t54 * t54;
  t126 = 0.1e1 / t125;
  t127 = t126 * sigma[2];
  t128 = t49 * t49;
  t129 = 0.1e1 / t128;
  t130 = t127 * t129;
  t134 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t120 * t58 - t100 + 0.16870559881319107373e-2 * t124 * t130);
  tvrho1 = t40 + t61 + t4 * (t114 + t134);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t137 = t26 * t81;
  t138 = t137 * t30;
  t141 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t78 * t138);
  tvsigma0 = t4 * t141;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t142 = t26 * t126;
  t143 = t142 * t51;
  t146 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t123 * t143);
  tvsigma2 = t4 * t146;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t149 = 0.1e1 / t21;
  t150 = t66 * t66;
  t153 = t62 * t4;
  t154 = 0.1e1 / t153;
  t155 = t14 * t154;
  t157 = -0.2e1 * t63 + 0.2e1 * t155;
  t158 = my_piecewise5(t8, 0, t12, 0, t157);
  t162 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t149 * t150 + 0.3e1 / 0.2e1 * t21 * t158);
  t163 = t3 * t162;
  t166 = t70 * t75;
  t168 = t69 * t25;
  t169 = t168 * t26;
  t173 = 0.1e1 / t26 / t4;
  t174 = t25 * t173;
  t175 = t174 * t36;
  t177 = t24 * t175 / 0.6e1;
  t178 = t78 * t73;
  t179 = t178 * t85;
  t182 = 0.1e1 / t80 / t33;
  t183 = sigma[0] * sigma[0];
  t184 = t182 * t183;
  t185 = t83 * t83;
  t186 = 0.1e1 / t185;
  t187 = t184 * t186;
  t190 = t83 * rho[0];
  t191 = 0.1e1 / t190;
  t192 = t82 * t191;
  t196 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t163 * t37 - 0.2e1 / 0.3e1 * t166 + 0.33741119762638214746e-2 * t169 * t85 + t177 + 0.16870559881319107373e-2 * t179 + 0.71397754399197518142e-4 * t79 * t187 - 0.67482239525276429492e-2 * t79 * t192);
  t197 = 0.1e1 / t45;
  t198 = t91 * t91;
  t202 = my_piecewise5(t12, 0, t8, 0, -t157);
  t206 = my_piecewise3(t44, 0, 0.3e1 / 0.4e1 * t197 * t198 + 0.3e1 / 0.2e1 * t45 * t202);
  t207 = t3 * t206;
  t210 = t95 * t98;
  t212 = t174 * t57;
  t214 = t48 * t212 / 0.6e1;
  t216 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t207 * t58 - 0.2e1 / 0.3e1 * t210 + t214);
  tv2rho20 = 0.2e1 * t89 + 0.2e1 * t102 + t4 * (t196 + t216);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t219 = t149 * t106;
  t222 = 0.2e1 * t155;
  t223 = my_piecewise5(t8, 0, t12, 0, t222);
  t227 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t219 * t66 + 0.3e1 / 0.2e1 * t21 * t223);
  t228 = t3 * t227;
  t231 = t110 * t75;
  t233 = t109 * t25;
  t234 = t233 * t26;
  t240 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t228 * t37 - t231 / 0.3e1 + 0.16870559881319107373e-2 * t234 * t85 - t166 / 0.3e1 + t177 + 0.84352799406595536863e-3 * t179);
  t241 = t197 * t116;
  t244 = my_piecewise5(t12, 0, t8, 0, -t222);
  t248 = my_piecewise3(t44, 0, 0.3e1 / 0.4e1 * t241 * t91 + 0.3e1 / 0.2e1 * t45 * t244);
  t249 = t3 * t248;
  t252 = t120 * t98;
  t255 = t94 * t25;
  t256 = t255 * t26;
  t259 = t123 * t73;
  t260 = t259 * t130;
  t263 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t249 * t58 - t252 / 0.3e1 - t210 / 0.3e1 + t214 + 0.16870559881319107373e-2 * t256 * t130 + 0.84352799406595536865e-3 * t260);
  tv2rho21 = t89 + t102 + t114 + t134 + t4 * (t240 + t263);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t268 = t106 * t106;
  t272 = 0.2e1 * t63 + 0.2e1 * t155;
  t273 = my_piecewise5(t8, 0, t12, 0, t272);
  t277 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t149 * t268 + 0.3e1 / 0.2e1 * t21 * t273);
  t278 = t3 * t277;
  t283 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t278 * t37 - 0.2e1 / 0.3e1 * t231 + t177);
  t284 = t116 * t116;
  t288 = my_piecewise5(t12, 0, t8, 0, -t272);
  t292 = my_piecewise3(t44, 0, 0.3e1 / 0.4e1 * t197 * t284 + 0.3e1 / 0.2e1 * t45 * t288);
  t293 = t3 * t292;
  t297 = t119 * t25;
  t298 = t297 * t26;
  t303 = 0.1e1 / t125 / t54;
  t304 = sigma[2] * sigma[2];
  t305 = t303 * t304;
  t306 = t128 * t128;
  t307 = 0.1e1 / t306;
  t308 = t305 * t307;
  t311 = t128 * rho[1];
  t312 = 0.1e1 / t311;
  t313 = t127 * t312;
  t317 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t293 * t58 - 0.2e1 / 0.3e1 * t252 + 0.33741119762638214746e-2 * t298 * t130 + t214 + 0.16870559881319107373e-2 * t260 + 0.71397754399197518142e-4 * t124 * t308 - 0.67482239525276429492e-2 * t124 * t313);
  tv2rho22 = 0.2e1 * t114 + 0.2e1 * t134 + t4 * (t283 + t317);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t322 = t73 * t81;
  t323 = t322 * t30;
  t325 = 0.28117599802198512286e-3 * t78 * t323;
  t326 = t83 * t29;
  t327 = 0.1e1 / t326;
  t329 = t182 * t327 * sigma[0];
  t332 = t137 * t84;
  t336 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t168 * t138 - t325 - 0.23799251466399172713e-4 * t79 * t329 + 0.16870559881319107372e-2 * t78 * t332);
  tv2rhosigma0 = t4 * t336 + t141;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t340 = t73 * t126;
  t341 = t340 * t51;
  t343 = 0.28117599802198512286e-3 * t123 * t341;
  t345 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t255 * t143 - t343);
  tv2rhosigma2 = t4 * t345 + t146;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t350 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t233 * t138 - t325);
  tv2rhosigma3 = t4 * t350 + t141;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t354 = t128 * t50;
  t355 = 0.1e1 / t354;
  t357 = t303 * t355 * sigma[2];
  t360 = t142 * t129;
  t364 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t297 * t143 - t343 - 0.23799251466399172713e-4 * t124 * t357 + 0.16870559881319107372e-2 * t123 * t360);
  tv2rhosigma5 = t4 * t364 + t146;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t366 = t26 * t182;
  t367 = t83 * t28;
  t368 = 0.1e1 / t367;
  t369 = t366 * t368;
  t372 = my_piecewise3(t1, 0, 0.79330838221330575711e-5 * t78 * t369);
  tv2sigma20 = t4 * t372;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t373 = t26 * t303;
  t374 = t128 * t49;
  t375 = 0.1e1 / t374;
  t376 = t373 * t375;
  t379 = my_piecewise3(t41, 0, 0.79330838221330575711e-5 * t123 * t376);
  tv2sigma25 = t4 * t379;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t33, t36, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t48, t49, t50;
  double t51, t54, t57, t58, t61, tzk0;

  double t62, t63, t64, t65, t66, t69, t70, t73;
  double t74, t75, t77, t78, t79, t80, t81, t82;
  double t83, t84, t85, t89, t91, t94, t95, t98;
  double t100, t102, tvrho0, t105, t106, t109, t110, t114;
  double t116, t119, t120, t123, t124, t125, t126, t127;
  double t128, t129, t130, t134, tvrho1, t137, t138, t141;
  double tvsigma0, tvsigma1, t142, t143, t146, tvsigma2;

  double t149, t150, t153, t154, t155, t157, t158, t162;
  double t163, t166, t168, t169, t173, t174, t175, t177;
  double t178, t179, t182, t183, t184, t185, t186, t187;
  double t190, t191, t192, t196, t197, t198, t202, t206;
  double t207, t210, t212, t214, t216, tv2rho20, t219, t222;
  double t223, t227, t228, t231, t233, t234, t240, t241;
  double t244, t248, t249, t252, t255, t256, t259, t260;
  double t263, tv2rho21, t268, t272, t273, t277, t278, t283;
  double t284, t288, t292, t293, t297, t298, t303, t304;
  double t305, t306, t307, t308, t311, t312, t313, t317;
  double tv2rho22, t322, t323, t325, t326, t327, t329, t332;
  double t336, tv2rhosigma0, tv2rhosigma1, t340, t341, t343, t345, tv2rhosigma2;
  double t350, tv2rhosigma3, tv2rhosigma4, t354, t355, t357, t360, t364;
  double tv2rhosigma5, t366, t367, t368, t369, t372, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t373, t374, t375, t376, t379;
  double tv2sigma25;

  double t382, t385, t386, t389, t394, t396, t397, t402;
  double t403, t404, t406, t407, t408, t410, t412, t413;
  double t414, t415, t417, t418, t421, t422, t423, t426;
  double t427, t430, t433, t434, t435, t437, t438, t442;
  double t443, t446, t447, t448, t449, t452, t456, t460;
  double t461, t464, t465, t467, t469, t471, tv3rho30, t474;
  double t475, t476, t479, t484, t485, t486, t487, t491;
  double t492, t496, t497, t498, t501, t503, t505, t516;
  double t517, t518, t521, t527, t531, t532, t536, t537;
  double t541, t542, t545, t547, t548, t549, t552, tv3rho31;
  double t555, t560, t563, t564, t568, t569, t572, t574;
  double t575, t582, t583, t588, t592, t596, t597, t600;
  double t603, t604, t607, t608, t614, t618, t620, t621;
  double tv3rho32, t626, t632, t633, t637, t638, t643, t646;
  double t647, t648, t649, t651, t652, t655, t656, t662;
  double t663, t666, t674, t680, t684, t685, t688, t689;
  double tv3rho33, t695, t701, t702, t704, t705, t707, t708;
  double t712, t713, t717, t720, t724, tv3rho2sigma0, tv3rho2sigma1, t729;
  double t731, t732, t734, t736, tv3rho2sigma2, t740, t750, tv3rho2sigma3;
  double tv3rho2sigma4, t754, t759, t763, t764, t767, tv3rho2sigma5, t774;
  double tv3rho2sigma6, tv3rho2sigma7, t788, t789, t793, t796, t800, tv3rho2sigma8;
  double t804, t805, t807, t809, t811, t814, t818, tv3rhosigma20;
  double tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t822, t823, t825, t827;
  double tv3rhosigma25, t832, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t837;
  double t839, t842, t846, tv3rhosigma211, t848, t849, t852, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t853, t854, t857, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t33 = 0.4604e0 + 0.70534859642542911404e-2 * sigma[0] * t30;
  t36 = 0.14604e1 - 0.21196816e0 / t33;
  t37 = t27 * t36;
  t40 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t37);
  t41 = rho[1] <= p->dens_threshold;
  t42 = my_piecewise5(t12, t9, t8, t13, -t15);
  t43 = 0.1e1 + t42;
  t44 = t43 <= p->zeta_threshold;
  t45 = sqrt(t43);
  t46 = t45 * t43;
  t47 = my_piecewise3(t44, t20, t46);
  t48 = t3 * t47;
  t49 = rho[1] * rho[1];
  t50 = t49 * rho[1];
  t51 = 0.1e1 / t50;
  t54 = 0.4604e0 + 0.70534859642542911404e-2 * sigma[2] * t51;
  t57 = 0.14604e1 - 0.21196816e0 / t54;
  t58 = t27 * t57;
  t61 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t48 * t58);
  tzk0 = t40 + t61;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t62 = t4 * t4;
  t63 = 0.1e1 / t62;
  t64 = t14 * t63;
  t65 = t5 - t64;
  t66 = my_piecewise5(t8, 0, t12, 0, t65);
  t69 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t66);
  t70 = t3 * t69;
  t73 = 0.1e1 / t26;
  t74 = t25 * t73;
  t75 = t74 * t36;
  t77 = t24 * t75 / 0.3e1;
  t78 = t23 * t25;
  t79 = t78 * t26;
  t80 = t33 * t33;
  t81 = 0.1e1 / t80;
  t82 = t81 * sigma[0];
  t83 = t28 * t28;
  t84 = 0.1e1 / t83;
  t85 = t82 * t84;
  t89 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t70 * t37 - t77 + 0.16870559881319107373e-2 * t79 * t85);
  t91 = my_piecewise5(t12, 0, t8, 0, -t65);
  t94 = my_piecewise3(t44, 0, 0.3e1 / 0.2e1 * t45 * t91);
  t95 = t3 * t94;
  t98 = t74 * t57;
  t100 = t48 * t98 / 0.3e1;
  t102 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t95 * t58 - t100);
  tvrho0 = t40 + t61 + t4 * (t89 + t102);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t105 = -t5 - t64;
  t106 = my_piecewise5(t8, 0, t12, 0, t105);
  t109 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t106);
  t110 = t3 * t109;
  t114 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t110 * t37 - t77);
  t116 = my_piecewise5(t12, 0, t8, 0, -t105);
  t119 = my_piecewise3(t44, 0, 0.3e1 / 0.2e1 * t45 * t116);
  t120 = t3 * t119;
  t123 = t47 * t25;
  t124 = t123 * t26;
  t125 = t54 * t54;
  t126 = 0.1e1 / t125;
  t127 = t126 * sigma[2];
  t128 = t49 * t49;
  t129 = 0.1e1 / t128;
  t130 = t127 * t129;
  t134 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t120 * t58 - t100 + 0.16870559881319107373e-2 * t124 * t130);
  tvrho1 = t40 + t61 + t4 * (t114 + t134);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t137 = t26 * t81;
  t138 = t137 * t30;
  t141 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t78 * t138);
  tvsigma0 = t4 * t141;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t142 = t26 * t126;
  t143 = t142 * t51;
  t146 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t123 * t143);
  tvsigma2 = t4 * t146;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t149 = 0.1e1 / t21;
  t150 = t66 * t66;
  t153 = t62 * t4;
  t154 = 0.1e1 / t153;
  t155 = t14 * t154;
  t157 = -0.2e1 * t63 + 0.2e1 * t155;
  t158 = my_piecewise5(t8, 0, t12, 0, t157);
  t162 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t149 * t150 + 0.3e1 / 0.2e1 * t21 * t158);
  t163 = t3 * t162;
  t166 = t70 * t75;
  t168 = t69 * t25;
  t169 = t168 * t26;
  t173 = 0.1e1 / t26 / t4;
  t174 = t25 * t173;
  t175 = t174 * t36;
  t177 = t24 * t175 / 0.6e1;
  t178 = t78 * t73;
  t179 = t178 * t85;
  t182 = 0.1e1 / t80 / t33;
  t183 = sigma[0] * sigma[0];
  t184 = t182 * t183;
  t185 = t83 * t83;
  t186 = 0.1e1 / t185;
  t187 = t184 * t186;
  t190 = t83 * rho[0];
  t191 = 0.1e1 / t190;
  t192 = t82 * t191;
  t196 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t163 * t37 - 0.2e1 / 0.3e1 * t166 + 0.33741119762638214746e-2 * t169 * t85 + t177 + 0.16870559881319107373e-2 * t179 + 0.71397754399197518142e-4 * t79 * t187 - 0.67482239525276429492e-2 * t79 * t192);
  t197 = 0.1e1 / t45;
  t198 = t91 * t91;
  t202 = my_piecewise5(t12, 0, t8, 0, -t157);
  t206 = my_piecewise3(t44, 0, 0.3e1 / 0.4e1 * t197 * t198 + 0.3e1 / 0.2e1 * t45 * t202);
  t207 = t3 * t206;
  t210 = t95 * t98;
  t212 = t174 * t57;
  t214 = t48 * t212 / 0.6e1;
  t216 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t207 * t58 - 0.2e1 / 0.3e1 * t210 + t214);
  tv2rho20 = 0.2e1 * t89 + 0.2e1 * t102 + t4 * (t196 + t216);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t219 = t149 * t106;
  t222 = 0.2e1 * t155;
  t223 = my_piecewise5(t8, 0, t12, 0, t222);
  t227 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t219 * t66 + 0.3e1 / 0.2e1 * t21 * t223);
  t228 = t3 * t227;
  t231 = t110 * t75;
  t233 = t109 * t25;
  t234 = t233 * t26;
  t240 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t228 * t37 - t231 / 0.3e1 + 0.16870559881319107373e-2 * t234 * t85 - t166 / 0.3e1 + t177 + 0.84352799406595536863e-3 * t179);
  t241 = t197 * t116;
  t244 = my_piecewise5(t12, 0, t8, 0, -t222);
  t248 = my_piecewise3(t44, 0, 0.3e1 / 0.4e1 * t241 * t91 + 0.3e1 / 0.2e1 * t45 * t244);
  t249 = t3 * t248;
  t252 = t120 * t98;
  t255 = t94 * t25;
  t256 = t255 * t26;
  t259 = t123 * t73;
  t260 = t259 * t130;
  t263 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t249 * t58 - t252 / 0.3e1 - t210 / 0.3e1 + t214 + 0.16870559881319107373e-2 * t256 * t130 + 0.84352799406595536865e-3 * t260);
  tv2rho21 = t89 + t102 + t114 + t134 + t4 * (t240 + t263);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t268 = t106 * t106;
  t272 = 0.2e1 * t63 + 0.2e1 * t155;
  t273 = my_piecewise5(t8, 0, t12, 0, t272);
  t277 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t149 * t268 + 0.3e1 / 0.2e1 * t21 * t273);
  t278 = t3 * t277;
  t283 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t278 * t37 - 0.2e1 / 0.3e1 * t231 + t177);
  t284 = t116 * t116;
  t288 = my_piecewise5(t12, 0, t8, 0, -t272);
  t292 = my_piecewise3(t44, 0, 0.3e1 / 0.4e1 * t197 * t284 + 0.3e1 / 0.2e1 * t45 * t288);
  t293 = t3 * t292;
  t297 = t119 * t25;
  t298 = t297 * t26;
  t303 = 0.1e1 / t125 / t54;
  t304 = sigma[2] * sigma[2];
  t305 = t303 * t304;
  t306 = t128 * t128;
  t307 = 0.1e1 / t306;
  t308 = t305 * t307;
  t311 = t128 * rho[1];
  t312 = 0.1e1 / t311;
  t313 = t127 * t312;
  t317 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t293 * t58 - 0.2e1 / 0.3e1 * t252 + 0.33741119762638214746e-2 * t298 * t130 + t214 + 0.16870559881319107373e-2 * t260 + 0.71397754399197518142e-4 * t124 * t308 - 0.67482239525276429492e-2 * t124 * t313);
  tv2rho22 = 0.2e1 * t114 + 0.2e1 * t134 + t4 * (t283 + t317);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t322 = t73 * t81;
  t323 = t322 * t30;
  t325 = 0.28117599802198512286e-3 * t78 * t323;
  t326 = t83 * t29;
  t327 = 0.1e1 / t326;
  t329 = t182 * t327 * sigma[0];
  t332 = t137 * t84;
  t336 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t168 * t138 - t325 - 0.23799251466399172713e-4 * t79 * t329 + 0.16870559881319107372e-2 * t78 * t332);
  tv2rhosigma0 = t4 * t336 + t141;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t340 = t73 * t126;
  t341 = t340 * t51;
  t343 = 0.28117599802198512286e-3 * t123 * t341;
  t345 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t255 * t143 - t343);
  tv2rhosigma2 = t4 * t345 + t146;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t350 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t233 * t138 - t325);
  tv2rhosigma3 = t4 * t350 + t141;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t354 = t128 * t50;
  t355 = 0.1e1 / t354;
  t357 = t303 * t355 * sigma[2];
  t360 = t142 * t129;
  t364 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t297 * t143 - t343 - 0.23799251466399172713e-4 * t124 * t357 + 0.16870559881319107372e-2 * t123 * t360);
  tv2rhosigma5 = t4 * t364 + t146;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t366 = t26 * t182;
  t367 = t83 * t28;
  t368 = 0.1e1 / t367;
  t369 = t366 * t368;
  t372 = my_piecewise3(t1, 0, 0.79330838221330575711e-5 * t78 * t369);
  tv2sigma20 = t4 * t372;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t373 = t26 * t303;
  t374 = t128 * t49;
  t375 = 0.1e1 / t374;
  t376 = t373 * t375;
  t379 = my_piecewise3(t41, 0, 0.79330838221330575711e-5 * t123 * t376);
  tv2sigma25 = t4 * t379;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t382 = t178 * t192;
  t385 = 0.1e1 / t185 / rho[0];
  t386 = t184 * t385;
  t389 = t82 * t368;
  t394 = t70 * t175;
  t396 = t168 * t73;
  t397 = t396 * t85;
  t402 = 0.1e1 / t26 / t62;
  t403 = t25 * t402;
  t404 = t403 * t36;
  t406 = t24 * t404 / 0.4e1;
  t407 = t78 * t173;
  t408 = t407 * t85;
  t410 = t178 * t187;
  t412 = t80 * t80;
  t413 = 0.1e1 / t412;
  t414 = t183 * sigma[0];
  t415 = t413 * t414;
  t417 = 0.1e1 / t185 / t83;
  t418 = t415 * t417;
  t421 = t163 * t75;
  t422 = t162 * t25;
  t423 = t422 * t26;
  t426 = 0.1e1 / t22;
  t427 = t150 * t66;
  t430 = t149 * t66;
  t433 = t62 * t62;
  t434 = 0.1e1 / t433;
  t435 = t14 * t434;
  t437 = 0.6e1 * t154 - 0.6e1 * t435;
  t438 = my_piecewise5(t8, 0, t12, 0, t437);
  t442 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t426 * t427 + 0.9e1 / 0.4e1 * t430 * t158 + 0.3e1 / 0.2e1 * t21 * t438);
  t443 = t3 * t442;
  t446 = -0.10122335928791464424e-1 * t382 - 0.85677305279037021771e-3 * t79 * t386 + 0.33741119762638214746e-1 * t79 * t389 - 0.20244671857582928847e-1 * t169 * t192 + t394 / 0.2e1 + 0.50611679643957322119e-2 * t397 + 0.21419326319759255442e-3 * t169 * t187 - t406 - 0.1265291991098933053e-2 * t408 + 0.10709663159879627721e-3 * t410 + 0.45324275268061328712e-5 * t79 * t418 - t421 + 0.50611679643957322119e-2 * t423 * t85 - 0.2e1 / 0.3e1 * t443 * t37;
  t447 = my_piecewise3(t1, 0, t446);
  t448 = 0.1e1 / t46;
  t449 = t198 * t91;
  t452 = t197 * t91;
  t456 = my_piecewise5(t12, 0, t8, 0, -t437);
  t460 = my_piecewise3(t44, 0, -0.3e1 / 0.8e1 * t448 * t449 + 0.9e1 / 0.4e1 * t452 * t202 + 0.3e1 / 0.2e1 * t45 * t456);
  t461 = t3 * t460;
  t464 = t207 * t98;
  t465 = t95 * t212;
  t467 = t403 * t57;
  t469 = t48 * t467 / 0.4e1;
  t471 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t461 * t58 - t464 + t465 / 0.2e1 - t469);
  tv3rho30 = 0.3e1 * t196 + 0.3e1 * t216 + t4 * (t447 + t471);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t474 = 0.2e1 * t240;
  t475 = 0.2e1 * t263;
  t476 = t426 * t106;
  t479 = t149 * t223;
  t484 = 0.2e1 * t154;
  t485 = 0.6e1 * t435;
  t486 = t484 - t485;
  t487 = my_piecewise5(t8, 0, t12, 0, t486);
  t491 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t476 * t150 + 0.3e1 / 0.2e1 * t479 * t66 + 0.3e1 / 0.4e1 * t219 * t158 + 0.3e1 / 0.2e1 * t21 * t487);
  t492 = t3 * t491;
  t496 = 0.2e1 / 0.3e1 * t228 * t75;
  t497 = t227 * t25;
  t498 = t497 * t26;
  t501 = t110 * t175;
  t503 = t233 * t73;
  t505 = 0.16870559881319107373e-2 * t503 * t85;
  t516 = -0.2e1 / 0.3e1 * t492 * t37 - t496 + 0.33741119762638214746e-2 * t498 * t85 + t501 / 0.6e1 + t505 + 0.71397754399197518142e-4 * t234 * t187 - 0.67482239525276429492e-2 * t234 * t192 - t421 / 0.3e1 + t394 / 0.3e1 + 0.16870559881319107373e-2 * t397 - t406 - 0.84352799406595536864e-3 * t408 + 0.3569887719959875907e-4 * t410 - 0.33741119762638214745e-2 * t382;
  t517 = my_piecewise3(t1, 0, t516);
  t518 = t448 * t116;
  t521 = t197 * t244;
  t527 = my_piecewise5(t12, 0, t8, 0, -t486);
  t531 = my_piecewise3(t44, 0, -0.3e1 / 0.8e1 * t518 * t198 + 0.3e1 / 0.2e1 * t521 * t91 + 0.3e1 / 0.4e1 * t241 * t202 + 0.3e1 / 0.2e1 * t45 * t527);
  t532 = t3 * t531;
  t536 = 0.2e1 / 0.3e1 * t249 * t98;
  t537 = t120 * t212;
  t541 = t206 * t25;
  t542 = t541 * t26;
  t545 = t255 * t73;
  t547 = 0.16870559881319107373e-2 * t545 * t130;
  t548 = t123 * t173;
  t549 = t548 * t130;
  t552 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t532 * t58 - t536 + t537 / 0.6e1 - t464 / 0.3e1 + t465 / 0.3e1 - t469 + 0.16870559881319107373e-2 * t542 * t130 + t547 - 0.42176399703297768432e-3 * t549);
  tv3rho31 = t196 + t216 + t474 + t475 + t4 * (t517 + t552);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t555 = t426 * t268;
  t560 = t149 * t273;
  t563 = -t484 - t485;
  t564 = my_piecewise5(t8, 0, t12, 0, t563);
  t568 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t555 * t66 + 0.3e1 / 0.2e1 * t219 * t223 + 0.3e1 / 0.4e1 * t560 * t66 + 0.3e1 / 0.2e1 * t21 * t564);
  t569 = t3 * t568;
  t572 = t278 * t75;
  t574 = t277 * t25;
  t575 = t574 * t26;
  t582 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t569 * t37 - t572 / 0.3e1 + 0.16870559881319107373e-2 * t575 * t85 - t496 + t501 / 0.3e1 + t505 + t394 / 0.6e1 - t406 - 0.42176399703297768432e-3 * t408);
  t583 = t448 * t284;
  t588 = t197 * t288;
  t592 = my_piecewise5(t12, 0, t8, 0, -t563);
  t596 = my_piecewise3(t44, 0, -0.3e1 / 0.8e1 * t583 * t91 + 0.3e1 / 0.2e1 * t241 * t244 + 0.3e1 / 0.4e1 * t588 * t91 + 0.3e1 / 0.2e1 * t45 * t592);
  t597 = t3 * t596;
  t600 = t293 * t98;
  t603 = t248 * t25;
  t604 = t603 * t26;
  t607 = t297 * t73;
  t608 = t607 * t130;
  t614 = t259 * t308;
  t618 = t259 * t313;
  t620 = -0.2e1 / 0.3e1 * t597 * t58 - t600 / 0.3e1 - t536 + t537 / 0.3e1 + 0.33741119762638214746e-2 * t604 * t130 + 0.16870559881319107373e-2 * t608 + t465 / 0.6e1 - t469 + t547 - 0.84352799406595536865e-3 * t549 + 0.71397754399197518142e-4 * t256 * t308 + 0.35698877199598759071e-4 * t614 - 0.67482239525276429492e-2 * t256 * t313 - 0.33741119762638214746e-2 * t618;
  t621 = my_piecewise3(t41, 0, t620);
  tv3rho32 = t474 + t475 + t283 + t317 + t4 * (t582 + t621);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t626 = t268 * t106;
  t632 = -0.6e1 * t154 - 0.6e1 * t435;
  t633 = my_piecewise5(t8, 0, t12, 0, t632);
  t637 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t426 * t626 + 0.9e1 / 0.4e1 * t219 * t273 + 0.3e1 / 0.2e1 * t21 * t633);
  t638 = t3 * t637;
  t643 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t638 * t37 - t572 + t501 / 0.2e1 - t406);
  t646 = t125 * t125;
  t647 = 0.1e1 / t646;
  t648 = t304 * sigma[2];
  t649 = t647 * t648;
  t651 = 0.1e1 / t306 / t128;
  t652 = t649 * t651;
  t655 = t292 * t25;
  t656 = t655 * t26;
  t662 = 0.1e1 / t306 / rho[1];
  t663 = t305 * t662;
  t666 = t127 * t375;
  t674 = t284 * t116;
  t680 = my_piecewise5(t12, 0, t8, 0, -t632);
  t684 = my_piecewise3(t44, 0, -0.3e1 / 0.8e1 * t448 * t674 + 0.9e1 / 0.4e1 * t241 * t288 + 0.3e1 / 0.2e1 * t45 * t680);
  t685 = t3 * t684;
  t688 = 0.21419326319759255442e-3 * t298 * t308 + 0.45324275268061328712e-5 * t124 * t652 + 0.50611679643957322119e-2 * t656 * t130 - t600 - 0.20244671857582928847e-1 * t298 * t313 - 0.85677305279037021771e-3 * t124 * t663 + 0.33741119762638214746e-1 * t124 * t666 + 0.10709663159879627721e-3 * t614 - 0.10122335928791464424e-1 * t618 + 0.50611679643957322119e-2 * t608 - 0.1265291991098933053e-2 * t549 + t537 / 0.2e1 - t469 - 0.2e1 / 0.3e1 * t685 * t58;
  t689 = my_piecewise3(t41, 0, t688);
  tv3rho33 = 0.3e1 * t283 + 0.3e1 * t317 + t4 * (t643 + t689);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t695 = t168 * t323;
  t701 = t173 * t81;
  t702 = t701 * t30;
  t704 = 0.14058799901099256143e-3 * t78 * t702;
  t705 = t178 * t329;
  t707 = t322 * t84;
  t708 = t78 * t707;
  t712 = t413 / t185 / t29;
  t713 = t712 * t183;
  t717 = t182 * t186 * sigma[0];
  t720 = t137 * t191;
  t724 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t422 * t138 - 0.56235199604397024572e-3 * t695 - 0.47598502932798345426e-4 * t169 * t329 + 0.33741119762638214744e-2 * t168 * t332 + t704 - 0.23799251466399172712e-4 * t705 + 0.16870559881319107372e-2 * t708 - 0.15108091756020442903e-5 * t79 * t713 + 0.23799251466399172713e-3 * t79 * t717 - 0.67482239525276429488e-2 * t78 * t720);
  tv3rho2sigma0 = t4 * t724 + 0.2e1 * t336;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t729 = t255 * t341;
  t731 = t173 * t126;
  t732 = t731 * t51;
  t734 = 0.14058799901099256143e-3 * t123 * t732;
  t736 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t541 * t143 - 0.56235199604397024572e-3 * t729 + t734);
  tv3rho2sigma2 = t4 * t736 + 0.2e1 * t345;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t740 = t233 * t323;
  t750 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t497 * t138 - 0.28117599802198512286e-3 * t740 - 0.23799251466399172713e-4 * t234 * t329 + 0.16870559881319107372e-2 * t233 * t332 - 0.28117599802198512286e-3 * t695 + t704 - 0.11899625733199586356e-4 * t705 + 0.84352799406595536858e-3 * t708);
  tv3rho2sigma3 = t4 * t750 + t336 + t350;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t754 = t297 * t341;
  t759 = t259 * t357;
  t763 = t340 * t129;
  t764 = t123 * t763;
  t767 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t603 * t143 - 0.28117599802198512286e-3 * t754 - 0.28117599802198512286e-3 * t729 + t734 - 0.23799251466399172713e-4 * t256 * t357 - 0.11899625733199586356e-4 * t759 + 0.16870559881319107372e-2 * t255 * t360 + 0.8435279940659553686e-3 * t764);
  tv3rho2sigma5 = t4 * t767 + t345 + t364;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t774 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t574 * t138 - 0.56235199604397024572e-3 * t740 + t704);
  tv3rho2sigma6 = t4 * t774 + 0.2e1 * t350;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t788 = t647 / t306 / t50;
  t789 = t788 * t304;
  t793 = t303 * t307 * sigma[2];
  t796 = t142 * t312;
  t800 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t655 * t143 - 0.56235199604397024572e-3 * t754 - 0.47598502932798345426e-4 * t298 * t357 + 0.33741119762638214744e-2 * t297 * t360 + t734 - 0.23799251466399172712e-4 * t759 + 0.16870559881319107372e-2 * t764 - 0.15108091756020442903e-5 * t124 * t789 + 0.23799251466399172713e-3 * t124 * t793 - 0.67482239525276429488e-2 * t123 * t796);
  tv3rho2sigma8 = t4 * t800 + 0.2e1 * t364;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t804 = t73 * t182;
  t805 = t804 * t368;
  t807 = 0.39665419110665287856e-5 * t78 * t805;
  t809 = 0.1e1 / t185 / t28;
  t811 = t413 * t809 * sigma[0];
  t814 = t366 * t327;
  t818 = my_piecewise3(t1, 0, 0.79330838221330575711e-5 * t168 * t369 + t807 + 0.50360305853401476345e-6 * t79 * t811 - 0.47598502932798345427e-4 * t78 * t814);
  tv3rhosigma20 = t4 * t818 + t372;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t822 = t73 * t303;
  t823 = t822 * t375;
  t825 = 0.39665419110665287856e-5 * t123 * t823;
  t827 = my_piecewise3(t41, 0, 0.79330838221330575711e-5 * t255 * t376 + t825);
  tv3rhosigma25 = t4 * t827 + t379;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t832 = my_piecewise3(t1, 0, 0.79330838221330575711e-5 * t233 * t369 + t807);
  tv3rhosigma26 = t4 * t832 + t372;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t837 = 0.1e1 / t306 / t49;
  t839 = t647 * t837 * sigma[2];
  t842 = t373 * t355;
  t846 = my_piecewise3(t41, 0, 0.79330838221330575711e-5 * t297 * t376 + t825 + 0.50360305853401476345e-6 * t124 * t839 - 0.47598502932798345427e-4 * t123 * t842);
  tv3rhosigma211 = t4 * t846 + t379;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t848 = t26 * t413;
  t849 = t848 * t385;
  t852 = my_piecewise3(t1, 0, -0.16786768617800492115e-6 * t78 * t849);
  tv3sigma30 = t4 * t852;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t853 = t26 * t647;
  t854 = t853 * t662;
  t857 = my_piecewise3(t41, 0, -0.16786768617800492115e-6 * t123 * t854);
  tv3sigma39 = t4 * t857;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t5, t8, t9, t12;
  double t13, t14, t15, t16, t17, t18, t19, t20;
  double t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t33, t36, t37, t40, t41, t42;
  double t43, t44, t45, t46, t47, t48, t49, t50;
  double t51, t54, t57, t58, t61, tzk0;

  double t62, t63, t64, t65, t66, t69, t70, t73;
  double t74, t75, t77, t78, t79, t80, t81, t82;
  double t83, t84, t85, t89, t91, t94, t95, t98;
  double t100, t102, tvrho0, t105, t106, t109, t110, t114;
  double t116, t119, t120, t123, t124, t125, t126, t127;
  double t128, t129, t130, t134, tvrho1, t137, t138, t141;
  double tvsigma0, tvsigma1, t142, t143, t146, tvsigma2;

  double t149, t150, t153, t154, t155, t157, t158, t162;
  double t163, t166, t168, t169, t173, t174, t175, t177;
  double t178, t179, t182, t183, t184, t185, t186, t187;
  double t190, t191, t192, t196, t197, t198, t202, t206;
  double t207, t210, t212, t214, t216, tv2rho20, t219, t222;
  double t223, t227, t228, t231, t233, t234, t240, t241;
  double t244, t248, t249, t252, t255, t256, t259, t260;
  double t263, tv2rho21, t268, t272, t273, t277, t278, t283;
  double t284, t288, t292, t293, t297, t298, t303, t304;
  double t305, t306, t307, t308, t311, t312, t313, t317;
  double tv2rho22, t322, t323, t325, t326, t327, t329, t332;
  double t336, tv2rhosigma0, tv2rhosigma1, t340, t341, t343, t345, tv2rhosigma2;
  double t350, tv2rhosigma3, tv2rhosigma4, t354, t355, t357, t360, t364;
  double tv2rhosigma5, t366, t367, t368, t369, t372, tv2sigma20, tv2sigma21;
  double tv2sigma22, tv2sigma23, tv2sigma24, t373, t374, t375, t376, t379;
  double tv2sigma25;

  double t382, t385, t386, t389, t394, t396, t397, t402;
  double t403, t404, t406, t407, t408, t410, t412, t413;
  double t414, t415, t417, t418, t421, t422, t423, t426;
  double t427, t430, t433, t434, t435, t437, t438, t442;
  double t443, t446, t447, t448, t449, t452, t456, t460;
  double t461, t464, t465, t467, t469, t471, tv3rho30, t474;
  double t475, t476, t479, t484, t485, t486, t487, t491;
  double t492, t496, t497, t498, t501, t503, t505, t516;
  double t517, t518, t521, t527, t531, t532, t536, t537;
  double t541, t542, t545, t547, t548, t549, t552, tv3rho31;
  double t555, t560, t563, t564, t568, t569, t572, t574;
  double t575, t582, t583, t588, t592, t596, t597, t600;
  double t603, t604, t607, t608, t614, t618, t620, t621;
  double tv3rho32, t626, t632, t633, t637, t638, t643, t646;
  double t647, t648, t649, t651, t652, t655, t656, t662;
  double t663, t666, t674, t680, t684, t685, t688, t689;
  double tv3rho33, t695, t701, t702, t704, t705, t707, t708;
  double t712, t713, t717, t720, t724, tv3rho2sigma0, tv3rho2sigma1, t729;
  double t731, t732, t734, t736, tv3rho2sigma2, t740, t750, tv3rho2sigma3;
  double tv3rho2sigma4, t754, t759, t763, t764, t767, tv3rho2sigma5, t774;
  double tv3rho2sigma6, tv3rho2sigma7, t788, t789, t793, t796, t800, tv3rho2sigma8;
  double t804, t805, t807, t809, t811, t814, t818, tv3rhosigma20;
  double tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t822, t823, t825, t827;
  double tv3rhosigma25, t832, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t837;
  double t839, t842, t846, tv3rhosigma211, t848, t849, t852, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t853, t854, t857, tv3sigma39;

  double t860, t863, t866, t867, t869, t871, t872, t878;
  double t885, t887, t888, t892, t896, t897, t899, t908;
  double t911, t913, t915, t921, t923, t925, t928, t929;
  double t931, t936, t940, t942, t947, t955, t957, t958;
  double t960, t961, t967, t973, t977, t981, t983, t984;
  double t987, t989, tv4rho40, t994, t995, t996, t997, t1015;
  double t1016, t1017, t1018, t1022, t1030, t1031, t1032, t1039;
  double t1049, t1055, t1060, t1064, t1066, t1084, t1088, t1092;
  double t1093, t1094, t1095, t1100, t1105, t1108, t1109, t1111;
  double t1113, t1114, tv4rho41, t1129, t1142, t1146, t1150, t1152;
  double t1156, t1159, t1179, t1181, t1190, t1203, t1207, t1213;
  double t1215, t1217, t1224, t1227, t1229, t1231, t1234, t1236;
  double t1246, t1248, tv4rho42, t1268, t1269, t1273, t1277, t1279;
  double t1288, t1289, t1294, t1304, t1306, t1308, t1311, t1313;
  double t1315, t1319, t1340, t1344, t1348, t1354, t1356, tv4rho43;
  double t1361, t1366, t1372, t1373, t1377, t1383, t1399, t1400;
  double t1402, t1407, t1415, t1421, t1429, t1434, t1440, t1444;
  double t1449, t1451, tv4rho44, t1464, t1470, t1472, t1474, t1483;
  double t1485, t1487, t1489, t1492, t1496, t1508, t1509, tv4rho3sigma0;
  double tv4rho3sigma1, t1514, t1516, t1521, t1523, tv4rho3sigma2, t1525, t1527;
  double t1532, t1535, t1537, t1555, t1556, tv4rho3sigma3, tv4rho3sigma4, t1558;
  double t1562, t1563, t1570, t1571, t1576, t1578, t1580, t1581;
  double tv4rho3sigma5, t1585, t1595, t1596, tv4rho3sigma6, tv4rho3sigma7, t1600, t1605;
  double t1609, t1616, t1620, t1625, t1627, t1628, tv4rho3sigma8, t1636;
  double tv4rho3sigma9, tv4rho3sigma10, t1677, t1678, tv4rho3sigma11, t1683, t1692, t1693;
  double t1696, t1711, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t1716;
  double t1721, t1723, tv4rho2sigma25, t1727, t1737, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28;
  double tv4rho2sigma29, tv4rho2sigma210, t1741, t1746, t1751, t1754, tv4rho2sigma211, t1761;
  double tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t1786, tv4rho2sigma217, t1793;
  double t1802, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36;
  double tv4rhosigma37, tv4rhosigma38, t1809, t1811, tv4rhosigma39, t1816, tv4rhosigma310, tv4rhosigma311;
  double tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t1828;
  double tv4rhosigma319, t1834, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45;
  double tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413;
  double t1839, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = sqrt(M_PI);
  t3 = 0.1e1 / t2;
  t4 = rho[0] + rho[1];
  t5 = 0.1e1 / t4;
  t8 = 0.2e1 * rho[0] * t5 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t12 = 0.2e1 * rho[1] * t5 <= p->zeta_threshold;
  t13 = -t9;
  t14 = rho[0] - rho[1];
  t15 = t14 * t5;
  t16 = my_piecewise5(t8, t9, t12, t13, t15);
  t17 = 0.1e1 + t16;
  t18 = t17 <= p->zeta_threshold;
  t19 = sqrt(p->zeta_threshold);
  t20 = t19 * p->zeta_threshold;
  t21 = sqrt(t17);
  t22 = t21 * t17;
  t23 = my_piecewise3(t18, t20, t22);
  t24 = t3 * t23;
  t25 = M_SQRT2;
  t26 = sqrt(t4);
  t27 = t25 * t26;
  t28 = rho[0] * rho[0];
  t29 = t28 * rho[0];
  t30 = 0.1e1 / t29;
  t33 = 0.4604e0 + 0.70534859642542911404e-2 * sigma[0] * t30;
  t36 = 0.14604e1 - 0.21196816e0 / t33;
  t37 = t27 * t36;
  t40 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t24 * t37);
  t41 = rho[1] <= p->dens_threshold;
  t42 = my_piecewise5(t12, t9, t8, t13, -t15);
  t43 = 0.1e1 + t42;
  t44 = t43 <= p->zeta_threshold;
  t45 = sqrt(t43);
  t46 = t45 * t43;
  t47 = my_piecewise3(t44, t20, t46);
  t48 = t3 * t47;
  t49 = rho[1] * rho[1];
  t50 = t49 * rho[1];
  t51 = 0.1e1 / t50;
  t54 = 0.4604e0 + 0.70534859642542911404e-2 * sigma[2] * t51;
  t57 = 0.14604e1 - 0.21196816e0 / t54;
  t58 = t27 * t57;
  t61 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t48 * t58);
  tzk0 = t40 + t61;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t62 = t4 * t4;
  t63 = 0.1e1 / t62;
  t64 = t14 * t63;
  t65 = t5 - t64;
  t66 = my_piecewise5(t8, 0, t12, 0, t65);
  t69 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t66);
  t70 = t3 * t69;
  t73 = 0.1e1 / t26;
  t74 = t25 * t73;
  t75 = t74 * t36;
  t77 = t24 * t75 / 0.3e1;
  t78 = t23 * t25;
  t79 = t78 * t26;
  t80 = t33 * t33;
  t81 = 0.1e1 / t80;
  t82 = t81 * sigma[0];
  t83 = t28 * t28;
  t84 = 0.1e1 / t83;
  t85 = t82 * t84;
  t89 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t70 * t37 - t77 + 0.16870559881319107373e-2 * t79 * t85);
  t91 = my_piecewise5(t12, 0, t8, 0, -t65);
  t94 = my_piecewise3(t44, 0, 0.3e1 / 0.2e1 * t45 * t91);
  t95 = t3 * t94;
  t98 = t74 * t57;
  t100 = t48 * t98 / 0.3e1;
  t102 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t95 * t58 - t100);
  tvrho0 = t40 + t61 + t4 * (t89 + t102);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t105 = -t5 - t64;
  t106 = my_piecewise5(t8, 0, t12, 0, t105);
  t109 = my_piecewise3(t18, 0, 0.3e1 / 0.2e1 * t21 * t106);
  t110 = t3 * t109;
  t114 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t110 * t37 - t77);
  t116 = my_piecewise5(t12, 0, t8, 0, -t105);
  t119 = my_piecewise3(t44, 0, 0.3e1 / 0.2e1 * t45 * t116);
  t120 = t3 * t119;
  t123 = t47 * t25;
  t124 = t123 * t26;
  t125 = t54 * t54;
  t126 = 0.1e1 / t125;
  t127 = t126 * sigma[2];
  t128 = t49 * t49;
  t129 = 0.1e1 / t128;
  t130 = t127 * t129;
  t134 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t120 * t58 - t100 + 0.16870559881319107373e-2 * t124 * t130);
  tvrho1 = t40 + t61 + t4 * (t114 + t134);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t137 = t26 * t81;
  t138 = t137 * t30;
  t141 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t78 * t138);
  tvsigma0 = t4 * t141;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t142 = t26 * t126;
  t143 = t142 * t51;
  t146 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t123 * t143);
  tvsigma2 = t4 * t146;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t149 = 0.1e1 / t21;
  t150 = t66 * t66;
  t153 = t62 * t4;
  t154 = 0.1e1 / t153;
  t155 = t14 * t154;
  t157 = -0.2e1 * t63 + 0.2e1 * t155;
  t158 = my_piecewise5(t8, 0, t12, 0, t157);
  t162 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t149 * t150 + 0.3e1 / 0.2e1 * t21 * t158);
  t163 = t3 * t162;
  t166 = t70 * t75;
  t168 = t69 * t25;
  t169 = t168 * t26;
  t173 = 0.1e1 / t26 / t4;
  t174 = t25 * t173;
  t175 = t174 * t36;
  t177 = t24 * t175 / 0.6e1;
  t178 = t78 * t73;
  t179 = t178 * t85;
  t182 = 0.1e1 / t80 / t33;
  t183 = sigma[0] * sigma[0];
  t184 = t182 * t183;
  t185 = t83 * t83;
  t186 = 0.1e1 / t185;
  t187 = t184 * t186;
  t190 = t83 * rho[0];
  t191 = 0.1e1 / t190;
  t192 = t82 * t191;
  t196 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t163 * t37 - 0.2e1 / 0.3e1 * t166 + 0.33741119762638214746e-2 * t169 * t85 + t177 + 0.16870559881319107373e-2 * t179 + 0.71397754399197518142e-4 * t79 * t187 - 0.67482239525276429492e-2 * t79 * t192);
  t197 = 0.1e1 / t45;
  t198 = t91 * t91;
  t202 = my_piecewise5(t12, 0, t8, 0, -t157);
  t206 = my_piecewise3(t44, 0, 0.3e1 / 0.4e1 * t197 * t198 + 0.3e1 / 0.2e1 * t45 * t202);
  t207 = t3 * t206;
  t210 = t95 * t98;
  t212 = t174 * t57;
  t214 = t48 * t212 / 0.6e1;
  t216 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t207 * t58 - 0.2e1 / 0.3e1 * t210 + t214);
  tv2rho20 = 0.2e1 * t89 + 0.2e1 * t102 + t4 * (t196 + t216);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t219 = t149 * t106;
  t222 = 0.2e1 * t155;
  t223 = my_piecewise5(t8, 0, t12, 0, t222);
  t227 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t219 * t66 + 0.3e1 / 0.2e1 * t21 * t223);
  t228 = t3 * t227;
  t231 = t110 * t75;
  t233 = t109 * t25;
  t234 = t233 * t26;
  t240 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t228 * t37 - t231 / 0.3e1 + 0.16870559881319107373e-2 * t234 * t85 - t166 / 0.3e1 + t177 + 0.84352799406595536863e-3 * t179);
  t241 = t197 * t116;
  t244 = my_piecewise5(t12, 0, t8, 0, -t222);
  t248 = my_piecewise3(t44, 0, 0.3e1 / 0.4e1 * t241 * t91 + 0.3e1 / 0.2e1 * t45 * t244);
  t249 = t3 * t248;
  t252 = t120 * t98;
  t255 = t94 * t25;
  t256 = t255 * t26;
  t259 = t123 * t73;
  t260 = t259 * t130;
  t263 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t249 * t58 - t252 / 0.3e1 - t210 / 0.3e1 + t214 + 0.16870559881319107373e-2 * t256 * t130 + 0.84352799406595536865e-3 * t260);
  tv2rho21 = t89 + t102 + t114 + t134 + t4 * (t240 + t263);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t268 = t106 * t106;
  t272 = 0.2e1 * t63 + 0.2e1 * t155;
  t273 = my_piecewise5(t8, 0, t12, 0, t272);
  t277 = my_piecewise3(t18, 0, 0.3e1 / 0.4e1 * t149 * t268 + 0.3e1 / 0.2e1 * t21 * t273);
  t278 = t3 * t277;
  t283 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t278 * t37 - 0.2e1 / 0.3e1 * t231 + t177);
  t284 = t116 * t116;
  t288 = my_piecewise5(t12, 0, t8, 0, -t272);
  t292 = my_piecewise3(t44, 0, 0.3e1 / 0.4e1 * t197 * t284 + 0.3e1 / 0.2e1 * t45 * t288);
  t293 = t3 * t292;
  t297 = t119 * t25;
  t298 = t297 * t26;
  t303 = 0.1e1 / t125 / t54;
  t304 = sigma[2] * sigma[2];
  t305 = t303 * t304;
  t306 = t128 * t128;
  t307 = 0.1e1 / t306;
  t308 = t305 * t307;
  t311 = t128 * rho[1];
  t312 = 0.1e1 / t311;
  t313 = t127 * t312;
  t317 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t293 * t58 - 0.2e1 / 0.3e1 * t252 + 0.33741119762638214746e-2 * t298 * t130 + t214 + 0.16870559881319107373e-2 * t260 + 0.71397754399197518142e-4 * t124 * t308 - 0.67482239525276429492e-2 * t124 * t313);
  tv2rho22 = 0.2e1 * t114 + 0.2e1 * t134 + t4 * (t283 + t317);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t322 = t73 * t81;
  t323 = t322 * t30;
  t325 = 0.28117599802198512286e-3 * t78 * t323;
  t326 = t83 * t29;
  t327 = 0.1e1 / t326;
  t329 = t182 * t327 * sigma[0];
  t332 = t137 * t84;
  t336 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t168 * t138 - t325 - 0.23799251466399172713e-4 * t79 * t329 + 0.16870559881319107372e-2 * t78 * t332);
  tv2rhosigma0 = t4 * t336 + t141;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t340 = t73 * t126;
  t341 = t340 * t51;
  t343 = 0.28117599802198512286e-3 * t123 * t341;
  t345 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t255 * t143 - t343);
  tv2rhosigma2 = t4 * t345 + t146;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t350 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t233 * t138 - t325);
  tv2rhosigma3 = t4 * t350 + t141;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t354 = t128 * t50;
  t355 = 0.1e1 / t354;
  t357 = t303 * t355 * sigma[2];
  t360 = t142 * t129;
  t364 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t297 * t143 - t343 - 0.23799251466399172713e-4 * t124 * t357 + 0.16870559881319107372e-2 * t123 * t360);
  tv2rhosigma5 = t4 * t364 + t146;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t366 = t26 * t182;
  t367 = t83 * t28;
  t368 = 0.1e1 / t367;
  t369 = t366 * t368;
  t372 = my_piecewise3(t1, 0, 0.79330838221330575711e-5 * t78 * t369);
  tv2sigma20 = t4 * t372;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t373 = t26 * t303;
  t374 = t128 * t49;
  t375 = 0.1e1 / t374;
  t376 = t373 * t375;
  t379 = my_piecewise3(t41, 0, 0.79330838221330575711e-5 * t123 * t376);
  tv2sigma25 = t4 * t379;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t382 = t178 * t192;
  t385 = 0.1e1 / t185 / rho[0];
  t386 = t184 * t385;
  t389 = t82 * t368;
  t394 = t70 * t175;
  t396 = t168 * t73;
  t397 = t396 * t85;
  t402 = 0.1e1 / t26 / t62;
  t403 = t25 * t402;
  t404 = t403 * t36;
  t406 = t24 * t404 / 0.4e1;
  t407 = t78 * t173;
  t408 = t407 * t85;
  t410 = t178 * t187;
  t412 = t80 * t80;
  t413 = 0.1e1 / t412;
  t414 = t183 * sigma[0];
  t415 = t413 * t414;
  t417 = 0.1e1 / t185 / t83;
  t418 = t415 * t417;
  t421 = t163 * t75;
  t422 = t162 * t25;
  t423 = t422 * t26;
  t426 = 0.1e1 / t22;
  t427 = t150 * t66;
  t430 = t149 * t66;
  t433 = t62 * t62;
  t434 = 0.1e1 / t433;
  t435 = t14 * t434;
  t437 = 0.6e1 * t154 - 0.6e1 * t435;
  t438 = my_piecewise5(t8, 0, t12, 0, t437);
  t442 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t426 * t427 + 0.9e1 / 0.4e1 * t430 * t158 + 0.3e1 / 0.2e1 * t21 * t438);
  t443 = t3 * t442;
  t446 = -0.10122335928791464424e-1 * t382 - 0.85677305279037021771e-3 * t79 * t386 + 0.33741119762638214746e-1 * t79 * t389 - 0.20244671857582928847e-1 * t169 * t192 + t394 / 0.2e1 + 0.50611679643957322119e-2 * t397 + 0.21419326319759255442e-3 * t169 * t187 - t406 - 0.1265291991098933053e-2 * t408 + 0.10709663159879627721e-3 * t410 + 0.45324275268061328712e-5 * t79 * t418 - t421 + 0.50611679643957322119e-2 * t423 * t85 - 0.2e1 / 0.3e1 * t443 * t37;
  t447 = my_piecewise3(t1, 0, t446);
  t448 = 0.1e1 / t46;
  t449 = t198 * t91;
  t452 = t197 * t91;
  t456 = my_piecewise5(t12, 0, t8, 0, -t437);
  t460 = my_piecewise3(t44, 0, -0.3e1 / 0.8e1 * t448 * t449 + 0.9e1 / 0.4e1 * t452 * t202 + 0.3e1 / 0.2e1 * t45 * t456);
  t461 = t3 * t460;
  t464 = t207 * t98;
  t465 = t95 * t212;
  t467 = t403 * t57;
  t469 = t48 * t467 / 0.4e1;
  t471 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t461 * t58 - t464 + t465 / 0.2e1 - t469);
  tv3rho30 = 0.3e1 * t196 + 0.3e1 * t216 + t4 * (t447 + t471);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t474 = 0.2e1 * t240;
  t475 = 0.2e1 * t263;
  t476 = t426 * t106;
  t479 = t149 * t223;
  t484 = 0.2e1 * t154;
  t485 = 0.6e1 * t435;
  t486 = t484 - t485;
  t487 = my_piecewise5(t8, 0, t12, 0, t486);
  t491 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t476 * t150 + 0.3e1 / 0.2e1 * t479 * t66 + 0.3e1 / 0.4e1 * t219 * t158 + 0.3e1 / 0.2e1 * t21 * t487);
  t492 = t3 * t491;
  t496 = 0.2e1 / 0.3e1 * t228 * t75;
  t497 = t227 * t25;
  t498 = t497 * t26;
  t501 = t110 * t175;
  t503 = t233 * t73;
  t505 = 0.16870559881319107373e-2 * t503 * t85;
  t516 = -0.2e1 / 0.3e1 * t492 * t37 - t496 + 0.33741119762638214746e-2 * t498 * t85 + t501 / 0.6e1 + t505 + 0.71397754399197518142e-4 * t234 * t187 - 0.67482239525276429492e-2 * t234 * t192 - t421 / 0.3e1 + t394 / 0.3e1 + 0.16870559881319107373e-2 * t397 - t406 - 0.84352799406595536864e-3 * t408 + 0.3569887719959875907e-4 * t410 - 0.33741119762638214745e-2 * t382;
  t517 = my_piecewise3(t1, 0, t516);
  t518 = t448 * t116;
  t521 = t197 * t244;
  t527 = my_piecewise5(t12, 0, t8, 0, -t486);
  t531 = my_piecewise3(t44, 0, -0.3e1 / 0.8e1 * t518 * t198 + 0.3e1 / 0.2e1 * t521 * t91 + 0.3e1 / 0.4e1 * t241 * t202 + 0.3e1 / 0.2e1 * t45 * t527);
  t532 = t3 * t531;
  t536 = 0.2e1 / 0.3e1 * t249 * t98;
  t537 = t120 * t212;
  t541 = t206 * t25;
  t542 = t541 * t26;
  t545 = t255 * t73;
  t547 = 0.16870559881319107373e-2 * t545 * t130;
  t548 = t123 * t173;
  t549 = t548 * t130;
  t552 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t532 * t58 - t536 + t537 / 0.6e1 - t464 / 0.3e1 + t465 / 0.3e1 - t469 + 0.16870559881319107373e-2 * t542 * t130 + t547 - 0.42176399703297768432e-3 * t549);
  tv3rho31 = t196 + t216 + t474 + t475 + t4 * (t517 + t552);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t555 = t426 * t268;
  t560 = t149 * t273;
  t563 = -t484 - t485;
  t564 = my_piecewise5(t8, 0, t12, 0, t563);
  t568 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t555 * t66 + 0.3e1 / 0.2e1 * t219 * t223 + 0.3e1 / 0.4e1 * t560 * t66 + 0.3e1 / 0.2e1 * t21 * t564);
  t569 = t3 * t568;
  t572 = t278 * t75;
  t574 = t277 * t25;
  t575 = t574 * t26;
  t582 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t569 * t37 - t572 / 0.3e1 + 0.16870559881319107373e-2 * t575 * t85 - t496 + t501 / 0.3e1 + t505 + t394 / 0.6e1 - t406 - 0.42176399703297768432e-3 * t408);
  t583 = t448 * t284;
  t588 = t197 * t288;
  t592 = my_piecewise5(t12, 0, t8, 0, -t563);
  t596 = my_piecewise3(t44, 0, -0.3e1 / 0.8e1 * t583 * t91 + 0.3e1 / 0.2e1 * t241 * t244 + 0.3e1 / 0.4e1 * t588 * t91 + 0.3e1 / 0.2e1 * t45 * t592);
  t597 = t3 * t596;
  t600 = t293 * t98;
  t603 = t248 * t25;
  t604 = t603 * t26;
  t607 = t297 * t73;
  t608 = t607 * t130;
  t614 = t259 * t308;
  t618 = t259 * t313;
  t620 = -0.2e1 / 0.3e1 * t597 * t58 - t600 / 0.3e1 - t536 + t537 / 0.3e1 + 0.33741119762638214746e-2 * t604 * t130 + 0.16870559881319107373e-2 * t608 + t465 / 0.6e1 - t469 + t547 - 0.84352799406595536865e-3 * t549 + 0.71397754399197518142e-4 * t256 * t308 + 0.35698877199598759071e-4 * t614 - 0.67482239525276429492e-2 * t256 * t313 - 0.33741119762638214746e-2 * t618;
  t621 = my_piecewise3(t41, 0, t620);
  tv3rho32 = t474 + t475 + t283 + t317 + t4 * (t582 + t621);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t626 = t268 * t106;
  t632 = -0.6e1 * t154 - 0.6e1 * t435;
  t633 = my_piecewise5(t8, 0, t12, 0, t632);
  t637 = my_piecewise3(t18, 0, -0.3e1 / 0.8e1 * t426 * t626 + 0.9e1 / 0.4e1 * t219 * t273 + 0.3e1 / 0.2e1 * t21 * t633);
  t638 = t3 * t637;
  t643 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t638 * t37 - t572 + t501 / 0.2e1 - t406);
  t646 = t125 * t125;
  t647 = 0.1e1 / t646;
  t648 = t304 * sigma[2];
  t649 = t647 * t648;
  t651 = 0.1e1 / t306 / t128;
  t652 = t649 * t651;
  t655 = t292 * t25;
  t656 = t655 * t26;
  t662 = 0.1e1 / t306 / rho[1];
  t663 = t305 * t662;
  t666 = t127 * t375;
  t674 = t284 * t116;
  t680 = my_piecewise5(t12, 0, t8, 0, -t632);
  t684 = my_piecewise3(t44, 0, -0.3e1 / 0.8e1 * t448 * t674 + 0.9e1 / 0.4e1 * t241 * t288 + 0.3e1 / 0.2e1 * t45 * t680);
  t685 = t3 * t684;
  t688 = 0.21419326319759255442e-3 * t298 * t308 + 0.45324275268061328712e-5 * t124 * t652 + 0.50611679643957322119e-2 * t656 * t130 - t600 - 0.20244671857582928847e-1 * t298 * t313 - 0.85677305279037021771e-3 * t124 * t663 + 0.33741119762638214746e-1 * t124 * t666 + 0.10709663159879627721e-3 * t614 - 0.10122335928791464424e-1 * t618 + 0.50611679643957322119e-2 * t608 - 0.1265291991098933053e-2 * t549 + t537 / 0.2e1 - t469 - 0.2e1 / 0.3e1 * t685 * t58;
  t689 = my_piecewise3(t41, 0, t688);
  tv3rho33 = 0.3e1 * t283 + 0.3e1 * t317 + t4 * (t643 + t689);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t695 = t168 * t323;
  t701 = t173 * t81;
  t702 = t701 * t30;
  t704 = 0.14058799901099256143e-3 * t78 * t702;
  t705 = t178 * t329;
  t707 = t322 * t84;
  t708 = t78 * t707;
  t712 = t413 / t185 / t29;
  t713 = t712 * t183;
  t717 = t182 * t186 * sigma[0];
  t720 = t137 * t191;
  t724 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t422 * t138 - 0.56235199604397024572e-3 * t695 - 0.47598502932798345426e-4 * t169 * t329 + 0.33741119762638214744e-2 * t168 * t332 + t704 - 0.23799251466399172712e-4 * t705 + 0.16870559881319107372e-2 * t708 - 0.15108091756020442903e-5 * t79 * t713 + 0.23799251466399172713e-3 * t79 * t717 - 0.67482239525276429488e-2 * t78 * t720);
  tv3rho2sigma0 = t4 * t724 + 0.2e1 * t336;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t729 = t255 * t341;
  t731 = t173 * t126;
  t732 = t731 * t51;
  t734 = 0.14058799901099256143e-3 * t123 * t732;
  t736 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t541 * t143 - 0.56235199604397024572e-3 * t729 + t734);
  tv3rho2sigma2 = t4 * t736 + 0.2e1 * t345;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t740 = t233 * t323;
  t750 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t497 * t138 - 0.28117599802198512286e-3 * t740 - 0.23799251466399172713e-4 * t234 * t329 + 0.16870559881319107372e-2 * t233 * t332 - 0.28117599802198512286e-3 * t695 + t704 - 0.11899625733199586356e-4 * t705 + 0.84352799406595536858e-3 * t708);
  tv3rho2sigma3 = t4 * t750 + t336 + t350;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t754 = t297 * t341;
  t759 = t259 * t357;
  t763 = t340 * t129;
  t764 = t123 * t763;
  t767 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t603 * t143 - 0.28117599802198512286e-3 * t754 - 0.28117599802198512286e-3 * t729 + t734 - 0.23799251466399172713e-4 * t256 * t357 - 0.11899625733199586356e-4 * t759 + 0.16870559881319107372e-2 * t255 * t360 + 0.8435279940659553686e-3 * t764);
  tv3rho2sigma5 = t4 * t767 + t345 + t364;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t774 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t574 * t138 - 0.56235199604397024572e-3 * t740 + t704);
  tv3rho2sigma6 = t4 * t774 + 0.2e1 * t350;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t788 = t647 / t306 / t50;
  t789 = t788 * t304;
  t793 = t303 * t307 * sigma[2];
  t796 = t142 * t312;
  t800 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t655 * t143 - 0.56235199604397024572e-3 * t754 - 0.47598502932798345426e-4 * t298 * t357 + 0.33741119762638214744e-2 * t297 * t360 + t734 - 0.23799251466399172712e-4 * t759 + 0.16870559881319107372e-2 * t764 - 0.15108091756020442903e-5 * t124 * t789 + 0.23799251466399172713e-3 * t124 * t793 - 0.67482239525276429488e-2 * t123 * t796);
  tv3rho2sigma8 = t4 * t800 + 0.2e1 * t364;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t804 = t73 * t182;
  t805 = t804 * t368;
  t807 = 0.39665419110665287856e-5 * t78 * t805;
  t809 = 0.1e1 / t185 / t28;
  t811 = t413 * t809 * sigma[0];
  t814 = t366 * t327;
  t818 = my_piecewise3(t1, 0, 0.79330838221330575711e-5 * t168 * t369 + t807 + 0.50360305853401476345e-6 * t79 * t811 - 0.47598502932798345427e-4 * t78 * t814);
  tv3rhosigma20 = t4 * t818 + t372;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t822 = t73 * t303;
  t823 = t822 * t375;
  t825 = 0.39665419110665287856e-5 * t123 * t823;
  t827 = my_piecewise3(t41, 0, 0.79330838221330575711e-5 * t255 * t376 + t825);
  tv3rhosigma25 = t4 * t827 + t379;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t832 = my_piecewise3(t1, 0, 0.79330838221330575711e-5 * t233 * t369 + t807);
  tv3rhosigma26 = t4 * t832 + t372;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t837 = 0.1e1 / t306 / t49;
  t839 = t647 * t837 * sigma[2];
  t842 = t373 * t355;
  t846 = my_piecewise3(t41, 0, 0.79330838221330575711e-5 * t297 * t376 + t825 + 0.50360305853401476345e-6 * t124 * t839 - 0.47598502932798345427e-4 * t123 * t842);
  tv3rhosigma211 = t4 * t846 + t379;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t848 = t26 * t413;
  t849 = t848 * t385;
  t852 = my_piecewise3(t1, 0, -0.16786768617800492115e-6 * t78 * t849);
  tv3sigma30 = t4 * t852;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t853 = t26 * t647;
  t854 = t853 * t662;
  t857 = my_piecewise3(t41, 0, -0.16786768617800492115e-6 * t123 * t854);
  tv3sigma39 = t4 * t857;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t860 = t70 * t404;
  t863 = t25 / t26 / t153;
  t866 = 0.5e1 / 0.8e1 * t24 * t863 * t36;
  t867 = t443 * t75;
  t869 = t17 * t17;
  t871 = 0.1e1 / t21 / t869;
  t872 = t150 * t150;
  t878 = t158 * t158;
  t885 = t14 / t433 / t4;
  t887 = -0.24e2 * t434 + 0.24e2 * t885;
  t888 = my_piecewise5(t8, 0, t12, 0, t887);
  t892 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t871 * t872 - 0.9e1 / 0.4e1 * t426 * t150 * t158 + 0.9e1 / 0.4e1 * t149 * t878 + 0.3e1 * t430 * t438 + 0.3e1 / 0.2e1 * t21 * t888);
  t896 = t163 * t175;
  t897 = t407 * t192;
  t899 = t178 * t389;
  t908 = t168 * t173 * t85;
  t911 = t422 * t73 * t85;
  t913 = t396 * t187;
  t915 = -t860 + t866 - 0.4e1 / 0.3e1 * t867 - 0.2e1 / 0.3e1 * t3 * t892 * t37 + t896 + 0.10122335928791464424e-1 * t897 + 0.67482239525276429493e-1 * t899 + 0.91389125630972823222e-2 * t79 * t184 * t809 - 0.20244671857582928848e0 * t79 * t82 * t327 - 0.5061167964395732212e-2 * t908 + 0.10122335928791464424e-1 * t911 + 0.42838652639518510885e-3 * t913;
  t921 = t78 * t402 * t85;
  t923 = t407 * t187;
  t925 = t178 * t418;
  t928 = 0.1e1 / t412 / t33;
  t929 = t183 * t183;
  t931 = t185 * t185;
  t936 = t442 * t25;
  t940 = t396 * t192;
  t942 = t178 * t386;
  t947 = 0.1e1 / t185 / t190;
  t955 = 0.42838652639518510885e-3 * t423 * t187 + 0.18129710107224531484e-4 * t169 * t418 + 0.2530583982197866106e-2 * t921 - 0.10709663159879627721e-3 * t923 + 0.90648550536122657421e-5 * t925 + 0.38363296733192217744e-6 * t79 * t928 * t929 / t931 + 0.67482239525276429492e-2 * t936 * t26 * t85 - 0.40489343715165857696e-1 * t940 - 0.17135461055807404354e-2 * t942 - 0.34270922111614808708e-2 * t169 * t386 - 0.10877826064334718891e-3 * t79 * t415 * t947 + 0.13496447905055285899e0 * t169 * t389 - 0.40489343715165857695e-1 * t423 * t192;
  t957 = my_piecewise3(t1, 0, t915 + t955);
  t958 = t43 * t43;
  t960 = 0.1e1 / t45 / t958;
  t961 = t198 * t198;
  t967 = t202 * t202;
  t973 = my_piecewise5(t12, 0, t8, 0, -t887);
  t977 = my_piecewise3(t44, 0, 0.9e1 / 0.16e2 * t960 * t961 - 0.9e1 / 0.4e1 * t448 * t198 * t202 + 0.9e1 / 0.4e1 * t197 * t967 + 0.3e1 * t452 * t456 + 0.3e1 / 0.2e1 * t45 * t973);
  t981 = t461 * t98;
  t983 = t207 * t212;
  t984 = t95 * t467;
  t987 = 0.5e1 / 0.8e1 * t48 * t863 * t57;
  t989 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t3 * t977 * t58 - 0.4e1 / 0.3e1 * t981 + t983 - t984 + t987);
  tv4rho40 = 0.4e1 * t447 + 0.4e1 * t471 + t4 * (t957 + t989);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t994 = t492 * t75;
  t995 = t228 * t175;
  t996 = t995 / 0.2e1;
  t997 = t110 * t404;
  t1015 = 0.12e2 * t434;
  t1016 = 0.24e2 * t885;
  t1017 = -t1015 + t1016;
  t1018 = my_piecewise5(t8, 0, t12, 0, t1017);
  t1022 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t871 * t106 * t427 - 0.9e1 / 0.8e1 * t426 * t223 * t150 - 0.9e1 / 0.8e1 * t476 * t66 * t158 + 0.9e1 / 0.4e1 * t149 * t487 * t66 + 0.9e1 / 0.4e1 * t479 * t158 + 0.3e1 / 0.4e1 * t219 * t438 + 0.3e1 / 0.2e1 * t21 * t1018);
  t1030 = t233 * t173 * t85;
  t1031 = 0.1265291991098933053e-2 * t1030;
  t1032 = t503 * t187;
  t1039 = -t994 + t996 - t997 / 0.4e1 - 0.2e1 / 0.3e1 * t3 * t1022 * t37 - 0.3e1 / 0.4e1 * t860 + t866 - t867 / 0.3e1 + t896 / 0.2e1 - t1031 + 0.10709663159879627721e-3 * t1032 + 0.45324275268061328712e-5 * t234 * t418 + 0.50611679643957322118e-2 * t897 + 0.16870559881319107372e-1 * t899 - 0.25305839821978661059e-2 * t908;
  t1049 = t503 * t192;
  t1055 = t491 * t25;
  t1060 = t497 * t73 * t85;
  t1064 = 0.25305839821978661059e-2 * t911 + 0.10709663159879627721e-3 * t913 + 0.18979379866483995795e-2 * t921 - 0.53548315799398138606e-4 * t923 + 0.22662137634030664355e-5 * t925 - 0.10122335928791464424e-1 * t940 - 0.42838652639518510884e-3 * t942 - 0.20244671857582928847e-1 * t498 * t192 - 0.10122335928791464424e-1 * t1049 - 0.85677305279037021771e-3 * t234 * t386 + 0.33741119762638214746e-1 * t234 * t389 + 0.50611679643957322119e-2 * t1055 * t26 * t85 + 0.50611679643957322119e-2 * t1060 + 0.21419326319759255442e-3 * t498 * t187;
  t1066 = my_piecewise3(t1, 0, t1039 + t1064);
  t1084 = my_piecewise5(t12, 0, t8, 0, -t1017);
  t1088 = my_piecewise3(t44, 0, 0.9e1 / 0.16e2 * t960 * t116 * t449 - 0.9e1 / 0.8e1 * t448 * t244 * t198 - 0.9e1 / 0.8e1 * t518 * t91 * t202 + 0.9e1 / 0.4e1 * t197 * t527 * t91 + 0.9e1 / 0.4e1 * t521 * t202 + 0.3e1 / 0.4e1 * t241 * t456 + 0.3e1 / 0.2e1 * t45 * t1084);
  t1092 = t532 * t98;
  t1093 = t249 * t212;
  t1094 = t1093 / 0.2e1;
  t1095 = t120 * t467;
  t1100 = t460 * t25;
  t1105 = t541 * t73 * t130;
  t1108 = t255 * t173 * t130;
  t1109 = 0.1265291991098933053e-2 * t1108;
  t1111 = t123 * t402 * t130;
  t1113 = -0.2e1 / 0.3e1 * t3 * t1088 * t58 - t1092 + t1094 - t1095 / 0.4e1 - t981 / 0.3e1 + t983 / 0.2e1 - 0.3e1 / 0.4e1 * t984 + t987 + 0.16870559881319107373e-2 * t1100 * t26 * t130 + 0.2530583982197866106e-2 * t1105 - t1109 + 0.63264599554946652648e-3 * t1111;
  t1114 = my_piecewise3(t41, 0, t1113);
  tv4rho41 = t447 + t471 + 0.3e1 * t517 + 0.3e1 * t552 + t4 * (t1066 + t1114);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1129 = t223 * t223;
  t1142 = my_piecewise5(t8, 0, t12, 0, t1016);
  t1146 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t871 * t268 * t150 - 0.3e1 / 0.2e1 * t476 * t66 * t223 - 0.3e1 / 0.8e1 * t555 * t158 + 0.3e1 / 0.2e1 * t149 * t1129 + 0.3e1 / 0.2e1 * t219 * t487 - 0.3e1 / 0.8e1 * t426 * t273 * t150 + 0.3e1 / 0.2e1 * t149 * t564 * t66 + 0.3e1 / 0.4e1 * t560 * t158 + 0.3e1 / 0.2e1 * t21 * t1142);
  t1150 = t569 * t75;
  t1152 = t568 * t25;
  t1156 = t278 * t175;
  t1159 = t574 * t73 * t85;
  t1179 = 0.2e1 / 0.3e1 * t995 + 0.33741119762638214746e-2 * t1060 - t997 / 0.2e1 - 0.16870559881319107373e-2 * t1030 + 0.71397754399197518142e-4 * t1032 - t860 / 0.2e1 - 0.84352799406595536864e-3 * t908 + t866 + 0.1265291991098933053e-2 * t921 - 0.17849438599799379535e-4 * t923 + t896 / 0.6e1;
  t1181 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t3 * t1146 * t37 - 0.2e1 / 0.3e1 * t1150 + 0.33741119762638214746e-2 * t1152 * t26 * t85 + t1156 / 0.6e1 + 0.16870559881319107373e-2 * t1159 + 0.71397754399197518142e-4 * t575 * t187 - 0.67482239525276429492e-2 * t575 * t192 - 0.67482239525276429492e-2 * t1049 + 0.16870559881319107373e-2 * t897 - 0.2e1 / 0.3e1 * t994 + t1179);
  t1190 = t244 * t244;
  t1203 = my_piecewise5(t12, 0, t8, 0, -t1016);
  t1207 = my_piecewise3(t44, 0, 0.9e1 / 0.16e2 * t960 * t284 * t198 - 0.3e1 / 0.2e1 * t518 * t91 * t244 - 0.3e1 / 0.8e1 * t583 * t202 + 0.3e1 / 0.2e1 * t197 * t1190 + 0.3e1 / 0.2e1 * t241 * t527 - 0.3e1 / 0.8e1 * t448 * t288 * t198 + 0.3e1 / 0.2e1 * t197 * t592 * t91 + 0.3e1 / 0.4e1 * t588 * t202 + 0.3e1 / 0.2e1 * t45 * t1203);
  t1213 = t597 * t98;
  t1215 = t293 * t212;
  t1217 = t531 * t25;
  t1224 = t603 * t73 * t130;
  t1227 = t297 * t173 * t130;
  t1229 = t545 * t308;
  t1231 = t548 * t308;
  t1234 = t545 * t313;
  t1236 = t548 * t313;
  t1246 = -0.67482239525276429492e-2 * t1234 + 0.16870559881319107373e-2 * t1236 + 0.16870559881319107373e-2 * t1105 - 0.16870559881319107373e-2 * t1108 + 0.1265291991098933053e-2 * t1111 - 0.2e1 / 0.3e1 * t1092 + 0.2e1 / 0.3e1 * t1093 - t1095 / 0.2e1 + t983 / 0.6e1 - t984 / 0.2e1 + t987;
  t1248 = my_piecewise3(t41, 0, -0.2e1 / 0.3e1 * t3 * t1207 * t58 - 0.67482239525276429492e-2 * t542 * t313 - 0.2e1 / 0.3e1 * t1213 + t1215 / 0.6e1 + 0.33741119762638214746e-2 * t1217 * t26 * t130 + 0.71397754399197518142e-4 * t542 * t308 + 0.33741119762638214746e-2 * t1224 - 0.84352799406595536865e-3 * t1227 + 0.71397754399197518142e-4 * t1229 - 0.17849438599799379536e-4 * t1231 + t1246);
  tv4rho42 = 0.2e1 * t517 + 0.2e1 * t552 + 0.2e1 * t582 + 0.2e1 * t621 + t4 * (t1181 + t1248);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1268 = t1015 + t1016;
  t1269 = my_piecewise5(t8, 0, t12, 0, t1268);
  t1273 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t871 * t626 * t66 - 0.9e1 / 0.8e1 * t555 * t223 - 0.9e1 / 0.8e1 * t476 * t273 * t66 + 0.9e1 / 0.4e1 * t479 * t273 + 0.9e1 / 0.4e1 * t219 * t564 + 0.3e1 / 0.4e1 * t149 * t633 * t66 + 0.3e1 / 0.2e1 * t21 * t1269);
  t1277 = t638 * t75;
  t1279 = t637 * t25;
  t1288 = -0.2e1 / 0.3e1 * t3 * t1273 * t37 - t1277 / 0.3e1 + 0.16870559881319107373e-2 * t1279 * t26 * t85 - t1150 + t1156 / 0.2e1 + 0.25305839821978661059e-2 * t1159 + t996 - 0.3e1 / 0.4e1 * t997 - t1031 - t860 / 0.4e1 + t866 + 0.63264599554946652648e-3 * t921;
  t1289 = my_piecewise3(t1, 0, t1288);
  t1294 = t596 * t25;
  t1304 = t259 * t666;
  t1306 = t607 * t308;
  t1308 = t259 * t652;
  t1311 = t655 * t73 * t130;
  t1313 = t607 * t313;
  t1315 = t259 * t663;
  t1319 = 0.21419326319759255442e-3 * t604 * t308 + 0.45324275268061328712e-5 * t256 * t652 + 0.50611679643957322119e-2 * t1294 * t26 * t130 - 0.20244671857582928847e-1 * t604 * t313 - 0.85677305279037021771e-3 * t256 * t663 + 0.33741119762638214746e-1 * t256 * t666 + 0.16870559881319107373e-1 * t1304 + 0.10709663159879627721e-3 * t1306 + 0.22662137634030664356e-5 * t1308 + 0.2530583982197866106e-2 * t1311 - 0.10122335928791464424e-1 * t1313 - 0.42838652639518510886e-3 * t1315 + 0.50611679643957322119e-2 * t1224 - 0.2530583982197866106e-2 * t1227;
  t1340 = my_piecewise5(t12, 0, t8, 0, -t1268);
  t1344 = my_piecewise3(t44, 0, 0.9e1 / 0.16e2 * t960 * t674 * t91 - 0.9e1 / 0.8e1 * t583 * t244 - 0.9e1 / 0.8e1 * t518 * t288 * t91 + 0.9e1 / 0.4e1 * t521 * t288 + 0.9e1 / 0.4e1 * t241 * t592 + 0.3e1 / 0.4e1 * t197 * t680 * t91 + 0.3e1 / 0.2e1 * t45 * t1340);
  t1348 = t685 * t98;
  t1354 = 0.10709663159879627721e-3 * t1229 - 0.53548315799398138605e-4 * t1231 - 0.10122335928791464424e-1 * t1234 + 0.5061167964395732212e-2 * t1236 - 0.2e1 / 0.3e1 * t3 * t1344 * t58 - t1348 / 0.3e1 - t984 / 0.4e1 + t987 + t1094 - 0.3e1 / 0.4e1 * t1095 - t1213 + t1215 / 0.2e1 - t1109 + 0.18979379866483995795e-2 * t1111;
  t1356 = my_piecewise3(t41, 0, t1319 + t1354);
  tv4rho43 = 0.3e1 * t582 + 0.3e1 * t621 + t643 + t689 + t4 * (t1289 + t1356);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1361 = t268 * t268;
  t1366 = t273 * t273;
  t1372 = 0.24e2 * t434 + 0.24e2 * t885;
  t1373 = my_piecewise5(t8, 0, t12, 0, t1372);
  t1377 = my_piecewise3(t18, 0, 0.9e1 / 0.16e2 * t871 * t1361 - 0.9e1 / 0.4e1 * t555 * t273 + 0.9e1 / 0.4e1 * t149 * t1366 + 0.3e1 * t219 * t633 + 0.3e1 / 0.2e1 * t21 * t1373);
  t1383 = my_piecewise3(t1, 0, -0.2e1 / 0.3e1 * t3 * t1377 * t37 - 0.4e1 / 0.3e1 * t1277 + t1156 - t997 + t866);
  t1399 = 0.1e1 / t646 / t54;
  t1400 = t304 * t304;
  t1402 = t306 * t306;
  t1407 = t684 * t25;
  t1415 = -0.40489343715165857695e-1 * t656 * t313 + 0.13496447905055285899e0 * t298 * t666 + 0.91389125630972823222e-2 * t124 * t305 * t837 - 0.20244671857582928848e0 * t124 * t127 * t355 + 0.42838652639518510885e-3 * t656 * t308 + 0.18129710107224531484e-4 * t298 * t652 + 0.38363296733192217744e-6 * t124 * t1399 * t1400 / t1402 + 0.67482239525276429492e-2 * t1407 * t26 * t130 + 0.67482239525276429493e-1 * t1304 + 0.42838652639518510885e-3 * t1306 + 0.90648550536122657421e-5 * t1308 + 0.10122335928791464424e-1 * t1311;
  t1421 = 0.1e1 / t306 / t311;
  t1429 = t284 * t284;
  t1434 = t288 * t288;
  t1440 = my_piecewise5(t12, 0, t8, 0, -t1372);
  t1444 = my_piecewise3(t44, 0, 0.9e1 / 0.16e2 * t960 * t1429 - 0.9e1 / 0.4e1 * t583 * t288 + 0.9e1 / 0.4e1 * t197 * t1434 + 0.3e1 * t241 * t680 + 0.3e1 / 0.2e1 * t45 * t1440);
  t1449 = -0.40489343715165857696e-1 * t1313 - 0.17135461055807404354e-2 * t1315 - 0.34270922111614808708e-2 * t298 * t663 - 0.10877826064334718891e-3 * t124 * t649 * t1421 - 0.5061167964395732212e-2 * t1227 - 0.10709663159879627721e-3 * t1231 + 0.10122335928791464424e-1 * t1236 - 0.4e1 / 0.3e1 * t1348 - 0.2e1 / 0.3e1 * t3 * t1444 * t58 + t987 - t1095 + t1215 + 0.2530583982197866106e-2 * t1111;
  t1451 = my_piecewise3(t41, 0, t1415 + t1449);
  tv4rho44 = 0.4e1 * t643 + 0.4e1 * t689 + t4 * (t1383 + t1451);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1464 = t422 * t323;
  t1470 = t168 * t702;
  t1472 = t168 * t707;
  t1474 = t396 * t329;
  t1483 = 0.21088199851648884214e-3 * t78 * t402 * t81 * t30;
  t1485 = t78 * t701 * t84;
  t1487 = t407 * t329;
  t1489 = t178 * t713;
  t1492 = t78 * t322 * t191;
  t1496 = t178 * t717;
  t1508 = -0.12787765577730739247e-6 * t79 * t928 / t185 / t326 * t414 + 0.33741119762638214744e-1 * t78 * t137 * t368 - 0.84352799406595536858e-3 * t1464 + 0.50611679643957322116e-2 * t422 * t332 - 0.71397754399197518139e-4 * t423 * t329 + 0.42176399703297768429e-3 * t1470 + 0.50611679643957322116e-2 * t1472 - 0.71397754399197518137e-4 * t1474 - 0.45324275268061328709e-5 * t169 * t713 - 0.20244671857582928847e-1 * t168 * t720 - t1483 - 0.12652919910989330529e-2 * t1485 + 0.17849438599799379534e-4 * t1487 - 0.22662137634030664354e-5 * t1489 - 0.10122335928791464423e-1 * t1492 + 0.71397754399197518139e-3 * t169 * t717 + 0.35698877199598759068e-3 * t1496 + 0.31726992687642930096e-4 * t79 * t413 * t417 * t183 - 0.21895311349087238896e-2 * t79 * t182 * t385 * sigma[0] - 0.56235199604397024573e-3 * t936 * t138;
  t1509 = my_piecewise3(t1, 0, t1508);
  tv4rho3sigma0 = t4 * t1509 + 0.3e1 * t724;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1514 = t541 * t341;
  t1516 = t255 * t732;
  t1521 = 0.21088199851648884214e-3 * t123 * t402 * t126 * t51;
  t1523 = my_piecewise3(t41, 0, -0.56235199604397024573e-3 * t1100 * t143 - 0.84352799406595536858e-3 * t1514 + 0.42176399703297768429e-3 * t1516 - t1521);
  tv4rho3sigma2 = t4 * t1523 + 0.3e1 * t736;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1525 = 0.2e1 * t750;
  t1527 = 0.56235199604397024572e-3 * t497 * t323;
  t1532 = t233 * t702;
  t1535 = 0.16870559881319107372e-2 * t233 * t707;
  t1537 = 0.23799251466399172712e-4 * t503 * t329;
  t1555 = -t1527 + 0.33741119762638214744e-2 * t497 * t332 - 0.47598502932798345426e-4 * t498 * t329 + 0.14058799901099256143e-3 * t1532 + t1535 - t1537 - 0.15108091756020442903e-5 * t234 * t713 - 0.67482239525276429488e-2 * t233 * t720 - 0.28117599802198512286e-3 * t1464 + 0.28117599802198512286e-3 * t1470 + 0.16870559881319107372e-2 * t1472 - 0.23799251466399172712e-4 * t1474 - t1483 - 0.84352799406595536858e-3 * t1485 + 0.11899625733199586356e-4 * t1487 - 0.75540458780102214513e-6 * t1489 - 0.33741119762638214743e-2 * t1492 + 0.23799251466399172713e-3 * t234 * t717 + 0.11899625733199586356e-3 * t1496 - 0.56235199604397024573e-3 * t1055 * t138;
  t1556 = my_piecewise3(t1, 0, t1555);
  tv4rho3sigma3 = t4 * t1556 + t1525 + t724;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1558 = 0.2e1 * t767;
  t1562 = 0.56235199604397024572e-3 * t603 * t341;
  t1563 = t297 * t732;
  t1570 = 0.23799251466399172712e-4 * t545 * t357;
  t1571 = t548 * t357;
  t1576 = 0.16870559881319107372e-2 * t255 * t763;
  t1578 = t123 * t731 * t129;
  t1580 = -0.56235199604397024573e-3 * t1217 * t143 - t1562 + 0.14058799901099256143e-3 * t1563 - 0.28117599802198512286e-3 * t1514 + 0.28117599802198512286e-3 * t1516 - t1521 - 0.23799251466399172713e-4 * t542 * t357 - t1570 + 0.5949812866599793178e-5 * t1571 + 0.16870559881319107372e-2 * t541 * t360 + t1576 - 0.4217639970329776843e-3 * t1578;
  t1581 = my_piecewise3(t41, 0, t1580);
  tv4rho3sigma5 = t4 * t1581 + t1558 + t736;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t1585 = t574 * t323;
  t1595 = -0.56235199604397024573e-3 * t1152 * t138 - 0.28117599802198512286e-3 * t1585 - 0.23799251466399172713e-4 * t575 * t329 + 0.16870559881319107372e-2 * t574 * t332 - t1527 + 0.28117599802198512286e-3 * t1532 - t1537 + t1535 + 0.14058799901099256143e-3 * t1470 - t1483 + 0.5949812866599793178e-5 * t1487 - 0.42176399703297768429e-3 * t1485;
  t1596 = my_piecewise3(t1, 0, t1595);
  tv4rho3sigma6 = t4 * t1596 + t1525 + t774;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t1600 = t655 * t341;
  t1605 = t607 * t357;
  t1609 = t297 * t763;
  t1616 = t259 * t789;
  t1620 = t259 * t793;
  t1625 = t123 * t340 * t312;
  t1627 = -0.56235199604397024573e-3 * t1294 * t143 - 0.28117599802198512286e-3 * t1600 - t1562 + 0.28117599802198512286e-3 * t1563 - 0.47598502932798345426e-4 * t604 * t357 - 0.23799251466399172713e-4 * t1605 + 0.33741119762638214744e-2 * t603 * t360 + 0.16870559881319107372e-2 * t1609 + 0.14058799901099256143e-3 * t1516 - t1521 - t1570 + 0.11899625733199586356e-4 * t1571 + t1576 - 0.8435279940659553686e-3 * t1578 - 0.15108091756020442903e-5 * t256 * t789 - 0.75540458780102214515e-6 * t1616 + 0.23799251466399172713e-3 * t256 * t793 + 0.11899625733199586356e-3 * t1620 - 0.67482239525276429488e-2 * t255 * t796 - 0.33741119762638214744e-2 * t1625;
  t1628 = my_piecewise3(t41, 0, t1627);
  tv4rho3sigma8 = t4 * t1628 + t1558 + t800;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t1636 = my_piecewise3(t1, 0, -0.56235199604397024573e-3 * t1279 * t138 - 0.84352799406595536858e-3 * t1585 + 0.42176399703297768429e-3 * t1532 - t1483);
  tv4rho3sigma9 = t4 * t1636 + 0.3e1 * t774;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t1677 = -0.45324275268061328709e-5 * t298 * t789 - 0.20244671857582928847e-1 * t297 * t796 - 0.12787765577730739247e-6 * t124 * t1399 / t306 / t354 * t648 + 0.33741119762638214744e-1 * t123 * t142 * t375 + 0.50611679643957322116e-2 * t655 * t360 - 0.71397754399197518139e-4 * t656 * t357 + 0.50611679643957322116e-2 * t1609 - 0.10122335928791464423e-1 * t1625 - 0.84352799406595536858e-3 * t1600 + 0.42176399703297768429e-3 * t1563 - 0.12652919910989330529e-2 * t1578 - t1521 - 0.21895311349087238896e-2 * t124 * t303 * t662 * sigma[2] + 0.71397754399197518139e-3 * t298 * t793 + 0.31726992687642930096e-4 * t124 * t647 * t651 * t304 - 0.71397754399197518137e-4 * t1605 - 0.22662137634030664354e-5 * t1616 + 0.35698877199598759068e-3 * t1620 + 0.17849438599799379534e-4 * t1571 - 0.56235199604397024573e-3 * t1407 * t143;
  t1678 = my_piecewise3(t41, 0, t1677);
  tv4rho3sigma11 = t4 * t1678 + 0.3e1 * t800;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t1683 = t168 * t805;
  t1692 = 0.19832709555332643928e-5 * t78 * t173 * t182 * t368;
  t1693 = t178 * t811;
  t1696 = t78 * t804 * t327;
  t1711 = my_piecewise3(t1, 0, 0.79330838221330575711e-5 * t422 * t369 + 0.79330838221330575712e-5 * t1683 + 0.10072061170680295269e-5 * t169 * t811 - 0.95197005865596690854e-4 * t168 * t814 - t1692 + 0.50360305853401476345e-6 * t1693 - 0.47598502932798345428e-4 * t1696 + 0.42625885259102464159e-7 * t79 * t928 / t185 / t367 * t183 - 0.80576489365442362152e-5 * t79 * t712 * sigma[0] + 0.33318952052958841799e-3 * t78 * t366 * t186);
  tv4rho2sigma20 = t4 * t1711 + 0.2e1 * t818;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t1716 = t255 * t823;
  t1721 = 0.19832709555332643928e-5 * t123 * t173 * t303 * t375;
  t1723 = my_piecewise3(t41, 0, 0.79330838221330575711e-5 * t541 * t376 + 0.79330838221330575712e-5 * t1716 - t1721);
  tv4rho2sigma25 = t4 * t1723 + 0.2e1 * t827;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t1727 = t233 * t805;
  t1737 = my_piecewise3(t1, 0, 0.79330838221330575711e-5 * t497 * t369 + 0.39665419110665287856e-5 * t1727 + 0.50360305853401476345e-6 * t234 * t811 - 0.47598502932798345427e-4 * t233 * t814 + 0.39665419110665287856e-5 * t1683 - t1692 + 0.25180152926700738173e-6 * t1693 - 0.23799251466399172714e-4 * t1696);
  tv4rho2sigma26 = t4 * t1737 + t818 + t832;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t1741 = t297 * t823;
  t1746 = t259 * t839;
  t1751 = t123 * t822 * t355;
  t1754 = my_piecewise3(t41, 0, 0.79330838221330575711e-5 * t603 * t376 + 0.39665419110665287856e-5 * t1741 + 0.39665419110665287856e-5 * t1716 - t1721 + 0.50360305853401476345e-6 * t256 * t839 + 0.25180152926700738172e-6 * t1746 - 0.47598502932798345427e-4 * t255 * t842 - 0.23799251466399172714e-4 * t1751);
  tv4rho2sigma211 = t4 * t1754 + t827 + t846;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t1761 = my_piecewise3(t1, 0, 0.79330838221330575711e-5 * t574 * t369 + 0.79330838221330575712e-5 * t1727 - t1692);
  tv4rho2sigma212 = t4 * t1761 + 0.2e1 * t832;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t1786 = my_piecewise3(t41, 0, 0.79330838221330575711e-5 * t655 * t376 + 0.79330838221330575712e-5 * t1741 + 0.10072061170680295269e-5 * t298 * t839 - 0.95197005865596690854e-4 * t297 * t842 - t1721 + 0.50360305853401476345e-6 * t1746 - 0.47598502932798345428e-4 * t1751 + 0.42625885259102464159e-7 * t124 * t1399 / t306 / t374 * t304 - 0.80576489365442362152e-5 * t124 * t788 * sigma[2] + 0.33318952052958841799e-3 * t123 * t373 * t307);
  tv4rho2sigma217 = t4 * t1786 + 0.2e1 * t846;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t1793 = 0.83933843089002460575e-7 * t78 * t73 * t413 * t385;
  t1802 = my_piecewise3(t1, 0, -0.16786768617800492115e-6 * t168 * t849 - t1793 - 0.14208628419700821386e-7 * t79 * t928 * t947 * sigma[0] + 0.15108091756020442904e-5 * t78 * t848 * t809);
  tv4rhosigma30 = t4 * t1802 + t852;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t1809 = 0.83933843089002460575e-7 * t123 * t73 * t647 * t662;
  t1811 = my_piecewise3(t41, 0, -0.16786768617800492115e-6 * t255 * t854 - t1809);
  tv4rhosigma39 = t4 * t1811 + t857;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t1816 = my_piecewise3(t1, 0, -0.16786768617800492115e-6 * t233 * t849 - t1793);
  tv4rhosigma310 = t4 * t1816 + t852;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t1828 = my_piecewise3(t41, 0, -0.16786768617800492115e-6 * t297 * t854 - t1809 - 0.14208628419700821386e-7 * t124 * t1399 * t1421 * sigma[2] + 0.15108091756020442904e-5 * t123 * t853 * t837);
  tv4rhosigma319 = t4 * t1828 + t857;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t1834 = my_piecewise3(t1, 0, 0.47362094732336071289e-8 * t78 * t26 * t928 * t417);
  tv4sigma40 = t4 * t1834;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t1839 = my_piecewise3(t41, 0, 0.47362094732336071289e-8 * t123 * t26 * t1399 * t651);
  tv4sigma414 = t4 * t1839;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

