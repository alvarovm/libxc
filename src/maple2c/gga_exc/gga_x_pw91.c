/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_pw91.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t22, t23;
  double t24, t25, t27, t28, t29, t30, t31, t33;
  double t34, t37, t40, t41, t44, t45, t46, t47;
  double t50, t51, t54, t55, t56, t57, t63, t64;
  double t65, t68, t69, t71, t75, tzk0;

  gga_x_pw91_params *params;

  assert(p->params != NULL);
  params = (gga_x_pw91_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t37 = exp(-params->alpha * t20 * t25 * t34 / 0.24e2);
  t40 = (params->d * t37 + params->c) * t20;
  t41 = t40 * t25;
  t44 = t20 * t20;
  t45 = 0.1e1 / t23;
  t46 = t44 * t45;
  t47 = sqrt(sigma[0]);
  t50 = 0.1e1 / t18 / rho[0];
  t51 = t47 * t27 * t50;
  t54 = pow(t46 * t51 / 0.12e2, params->expo);
  t55 = params->f * t54;
  t56 = t41 * t34 / 0.24e2 - t55;
  t57 = t46 * t47;
  t63 = log(params->b * t44 * t45 * t51 / 0.12e2 + sqrt(POW_2(params->b * t44 * t45 * t51 / 0.12e2) + 0.1e1));
  t64 = params->a * t63;
  t65 = t27 * t50 * t64;
  t68 = 0.1e1 + t57 * t65 / 0.12e2 + t55;
  t69 = 0.1e1 / t68;
  t71 = t56 * t69 + 0.1e1;
  t75 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t71);
  tzk0 = 0.2e1 * t75;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t22, t23;
  double t24, t25, t27, t28, t29, t30, t31, t33;
  double t34, t37, t40, t41, t44, t45, t46, t47;
  double t50, t51, t54, t55, t56, t57, t63, t64;
  double t65, t68, t69, t71, t75, tzk0;

  double t77, t81, t83, t84, t85, t86, t87, t88;
  double t89, t91, t92, t96, t98, t102, t105, t106;
  double t108, t109, t110, t114, t117, t118, t120, t125;
  double t126, t128, t129, t132, t134, t139, tvrho0, t142;
  double t144, t145, t146, t150, t154, t157, t158, t161;
  double t164, t166, t169, t171, t175, tvsigma0;

  gga_x_pw91_params *params;

  assert(p->params != NULL);
  params = (gga_x_pw91_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t37 = exp(-params->alpha * t20 * t25 * t34 / 0.24e2);
  t40 = (params->d * t37 + params->c) * t20;
  t41 = t40 * t25;
  t44 = t20 * t20;
  t45 = 0.1e1 / t23;
  t46 = t44 * t45;
  t47 = sqrt(sigma[0]);
  t50 = 0.1e1 / t18 / rho[0];
  t51 = t47 * t27 * t50;
  t54 = pow(t46 * t51 / 0.12e2, params->expo);
  t55 = params->f * t54;
  t56 = t41 * t34 / 0.24e2 - t55;
  t57 = t46 * t47;
  t63 = log(params->b * t44 * t45 * t51 / 0.12e2 + sqrt(POW_2(params->b * t44 * t45 * t51 / 0.12e2) + 0.1e1));
  t64 = params->a * t63;
  t65 = t27 * t50 * t64;
  t68 = 0.1e1 + t57 * t65 / 0.12e2 + t55;
  t69 = 0.1e1 / t68;
  t71 = t56 * t69 + 0.1e1;
  t75 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t71);
  tzk0 = 0.2e1 * t75;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t77 = t17 / t31;
  t81 = params->d * params->alpha;
  t83 = 0.1e1 / t23 / t22;
  t84 = t44 * t83;
  t85 = t81 * t84;
  t86 = sigma[0] * sigma[0];
  t87 = t86 * t27;
  t88 = t30 * t30;
  t89 = t88 * t30;
  t91 = 0.1e1 / t18 / t89;
  t92 = t91 * t37;
  t96 = t30 * rho[0];
  t98 = 0.1e1 / t31 / t96;
  t102 = 0.1e1 / rho[0];
  t105 = 0.4e1 / 0.3e1 * t55 * params->expo * t102;
  t106 = t85 * t87 * t92 / 0.108e3 - t41 * t29 * t98 / 0.9e1 + t105;
  t108 = t68 * t68;
  t109 = 0.1e1 / t108;
  t110 = t56 * t109;
  t114 = t27 / t18 / t30 * t64;
  t117 = t20 * t25;
  t118 = t117 * t29;
  t120 = params->b * params->b;
  t125 = 0.6e1 * t120 * t20 * t25 * t34 + 0.144e3;
  t126 = sqrt(t125);
  t128 = params->b / t126;
  t129 = t98 * params->a * t128;
  t132 = -t57 * t114 / 0.9e1 - 0.2e1 / 0.3e1 * t118 * t129 - t105;
  t134 = t106 * t69 - t110 * t132;
  t139 = my_piecewise3(t2, 0, -t6 * t77 * t71 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t134);
  tvrho0 = 0.2e1 * rho[0] * t139 + 0.2e1 * t75;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t142 = t88 * rho[0];
  t144 = 0.1e1 / t18 / t142;
  t145 = t27 * t144;
  t146 = t37 * sigma[0];
  t150 = t25 * t28;
  t154 = 0.1e1 / sigma[0];
  t157 = t55 * params->expo * t154 / 0.2e1;
  t158 = -t85 * t145 * t146 / 0.288e3 + t40 * t150 * t33 / 0.24e2 - t157;
  t161 = t46 / t47;
  t164 = t117 * t28;
  t166 = t33 * params->a * t128;
  t169 = t161 * t65 / 0.24e2 + t164 * t166 / 0.4e1 + t157;
  t171 = -t110 * t169 + t158 * t69;
  t175 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t171);
  tvsigma0 = 0.2e1 * rho[0] * t175;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t22, t23;
  double t24, t25, t27, t28, t29, t30, t31, t33;
  double t34, t37, t40, t41, t44, t45, t46, t47;
  double t50, t51, t54, t55, t56, t57, t63, t64;
  double t65, t68, t69, t71, t75, tzk0;

  double t77, t81, t83, t84, t85, t86, t87, t88;
  double t89, t91, t92, t96, t98, t102, t105, t106;
  double t108, t109, t110, t114, t117, t118, t120, t125;
  double t126, t128, t129, t132, t134, t139, tvrho0, t142;
  double t144, t145, t146, t150, t154, t157, t158, t161;
  double t164, t166, t169, t171, t175, tvsigma0;

  double t180, t187, t189, t190, t194, t195, t196, t197;
  double t198, t199, t200, t201, t202, t208, t212, t213;
  double t214, t216, t219, t220, t222, t226, t227, t228;
  double t234, t238, t241, t243, t245, t246, t247, t250;
  double t252, t257, tv2rho20, t263, t267, t268, t276, t279;
  double t280, t282, t285, t294, t297, t299, t304, tv2rhosigma0;
  double t307, t312, t313, t318, t321, t324, t325, t329;
  double t334, t338, t341, t343, t346, t348, t352, tv2sigma20;

  gga_x_pw91_params *params;

  assert(p->params != NULL);
  params = (gga_x_pw91_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t37 = exp(-params->alpha * t20 * t25 * t34 / 0.24e2);
  t40 = (params->d * t37 + params->c) * t20;
  t41 = t40 * t25;
  t44 = t20 * t20;
  t45 = 0.1e1 / t23;
  t46 = t44 * t45;
  t47 = sqrt(sigma[0]);
  t50 = 0.1e1 / t18 / rho[0];
  t51 = t47 * t27 * t50;
  t54 = pow(t46 * t51 / 0.12e2, params->expo);
  t55 = params->f * t54;
  t56 = t41 * t34 / 0.24e2 - t55;
  t57 = t46 * t47;
  t63 = log(params->b * t44 * t45 * t51 / 0.12e2 + sqrt(POW_2(params->b * t44 * t45 * t51 / 0.12e2) + 0.1e1));
  t64 = params->a * t63;
  t65 = t27 * t50 * t64;
  t68 = 0.1e1 + t57 * t65 / 0.12e2 + t55;
  t69 = 0.1e1 / t68;
  t71 = t56 * t69 + 0.1e1;
  t75 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t71);
  tzk0 = 0.2e1 * t75;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t77 = t17 / t31;
  t81 = params->d * params->alpha;
  t83 = 0.1e1 / t23 / t22;
  t84 = t44 * t83;
  t85 = t81 * t84;
  t86 = sigma[0] * sigma[0];
  t87 = t86 * t27;
  t88 = t30 * t30;
  t89 = t88 * t30;
  t91 = 0.1e1 / t18 / t89;
  t92 = t91 * t37;
  t96 = t30 * rho[0];
  t98 = 0.1e1 / t31 / t96;
  t102 = 0.1e1 / rho[0];
  t105 = 0.4e1 / 0.3e1 * t55 * params->expo * t102;
  t106 = t85 * t87 * t92 / 0.108e3 - t41 * t29 * t98 / 0.9e1 + t105;
  t108 = t68 * t68;
  t109 = 0.1e1 / t108;
  t110 = t56 * t109;
  t114 = t27 / t18 / t30 * t64;
  t117 = t20 * t25;
  t118 = t117 * t29;
  t120 = params->b * params->b;
  t125 = 0.6e1 * t120 * t20 * t25 * t34 + 0.144e3;
  t126 = sqrt(t125);
  t128 = params->b / t126;
  t129 = t98 * params->a * t128;
  t132 = -t57 * t114 / 0.9e1 - 0.2e1 / 0.3e1 * t118 * t129 - t105;
  t134 = t106 * t69 - t110 * t132;
  t139 = my_piecewise3(t2, 0, -t6 * t77 * t71 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t134);
  tvrho0 = 0.2e1 * rho[0] * t139 + 0.2e1 * t75;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t142 = t88 * rho[0];
  t144 = 0.1e1 / t18 / t142;
  t145 = t27 * t144;
  t146 = t37 * sigma[0];
  t150 = t25 * t28;
  t154 = 0.1e1 / sigma[0];
  t157 = t55 * params->expo * t154 / 0.2e1;
  t158 = -t85 * t145 * t146 / 0.288e3 + t40 * t150 * t33 / 0.24e2 - t157;
  t161 = t46 / t47;
  t164 = t117 * t28;
  t166 = t33 * params->a * t128;
  t169 = t161 * t65 / 0.24e2 + t164 * t166 / 0.4e1 + t157;
  t171 = -t110 * t169 + t158 * t69;
  t175 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t171);
  tvsigma0 = 0.2e1 * rho[0] * t175;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t180 = t17 / t31 / rho[0];
  t187 = t88 * t96;
  t189 = 0.1e1 / t18 / t187;
  t190 = t189 * t37;
  t194 = params->alpha * params->alpha;
  t195 = params->d * t194;
  t196 = t22 * t22;
  t197 = 0.1e1 / t196;
  t198 = t195 * t197;
  t199 = t86 * sigma[0];
  t200 = t88 * t88;
  t201 = t200 * t30;
  t202 = 0.1e1 / t201;
  t208 = 0.1e1 / t31 / t88;
  t212 = params->expo * params->expo;
  t213 = 0.1e1 / t30;
  t214 = t212 * t213;
  t216 = 0.16e2 / 0.9e1 * t55 * t214;
  t219 = 0.4e1 / 0.3e1 * t55 * params->expo * t213;
  t220 = -t85 * t87 * t190 / 0.12e2 + t198 * t199 * t202 * t37 / 0.81e2 + 0.11e2 / 0.27e2 * t41 * t29 * t208 - t216 - t219;
  t222 = t106 * t109;
  t226 = 0.1e1 / t108 / t68;
  t227 = t56 * t226;
  t228 = t132 * t132;
  t234 = t27 / t18 / t96 * t64;
  t238 = t208 * params->a * t128;
  t241 = t84 * t87;
  t243 = t120 * params->b;
  t245 = 0.1e1 / t126 / t125;
  t246 = t243 * t245;
  t247 = t189 * params->a * t246;
  t250 = 0.7e1 / 0.27e2 * t57 * t234 + 0.1e2 / 0.3e1 * t118 * t238 - 0.32e2 / 0.3e1 * t241 * t247 + t216 + t219;
  t252 = -t110 * t250 - 0.2e1 * t222 * t132 + t220 * t69 + 0.2e1 * t227 * t228;
  t257 = my_piecewise3(t2, 0, t6 * t180 * t71 / 0.12e2 - t6 * t77 * t134 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t252);
  tv2rho20 = 0.2e1 * rho[0] * t257 + 0.4e1 * t139;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t263 = t27 * t91;
  t267 = t200 * rho[0];
  t268 = 0.1e1 / t267;
  t276 = t212 * t102;
  t279 = 0.2e1 / 0.3e1 * t55 * t276 * t154;
  t280 = t85 * t263 * t146 / 0.36e2 - t198 * t268 * t86 * t37 / 0.216e3 - t40 * t150 * t98 / 0.9e1 + t279;
  t282 = t158 * t109;
  t285 = t169 * t132;
  t294 = params->a * t243 * t245 * sigma[0];
  t297 = -t161 * t114 / 0.18e2 - t164 * t129 + 0.4e1 * t84 * t263 * t294 - t279;
  t299 = -t110 * t297 - t282 * t132 - t222 * t169 + 0.2e1 * t227 * t285 + t280 * t69;
  t304 = my_piecewise3(t2, 0, -t6 * t77 * t171 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t299);
  tv2rhosigma0 = 0.2e1 * rho[0] * t304 + 0.2e1 * t175;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t307 = 0.1e1 / t200;
  t312 = t81 * t44;
  t313 = t83 * t27;
  t318 = 0.1e1 / t86;
  t321 = t55 * t212 * t318 / 0.4e1;
  t324 = t55 * params->expo * t318 / 0.2e1;
  t325 = t198 * t307 * t37 * sigma[0] / 0.576e3 - t312 * t313 * t144 * t37 / 0.144e3 - t321 + t324;
  t329 = t169 * t169;
  t334 = t46 / t47 / sigma[0];
  t338 = t117 * t154 * t28;
  t341 = t84 * t27;
  t343 = t144 * params->a * t246;
  t346 = -t334 * t65 / 0.48e2 + t338 * t166 / 0.8e1 - 0.3e1 / 0.2e1 * t341 * t343 + t321 - t324;
  t348 = -t110 * t346 - 0.2e1 * t282 * t169 + 0.2e1 * t227 * t329 + t325 * t69;
  t352 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t348);
  tv2sigma20 = 0.2e1 * rho[0] * t352;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t22, t23;
  double t24, t25, t27, t28, t29, t30, t31, t33;
  double t34, t37, t40, t41, t44, t45, t46, t47;
  double t50, t51, t54, t55, t56, t57, t63, t64;
  double t65, t68, t69, t71, t75, tzk0;

  double t77, t81, t83, t84, t85, t86, t87, t88;
  double t89, t91, t92, t96, t98, t102, t105, t106;
  double t108, t109, t110, t114, t117, t118, t120, t125;
  double t126, t128, t129, t132, t134, t139, tvrho0, t142;
  double t144, t145, t146, t150, t154, t157, t158, t161;
  double t164, t166, t169, t171, t175, tvsigma0;

  double t180, t187, t189, t190, t194, t195, t196, t197;
  double t198, t199, t200, t201, t202, t208, t212, t213;
  double t214, t216, t219, t220, t222, t226, t227, t228;
  double t234, t238, t241, t243, t245, t246, t247, t250;
  double t252, t257, tv2rho20, t263, t267, t268, t276, t279;
  double t280, t282, t285, t294, t297, t299, t304, tv2rhosigma0;
  double t307, t312, t313, t318, t321, t324, t325, t329;
  double t334, t338, t341, t343, t346, t348, t352, tv2sigma20;

  double t355, t366, t371, t372, t378, t379, t380, t381;
  double t382, t384, t386, t391, t395, t396, t397, t399;
  double t400, t402, t405, t406, t408, t411, t416, t417;
  double t418, t419, t422, t428, t432, t439, t441, t442;
  double t444, t446, t447, t450, t452, t457, tv3rho30, t467;
  double t475, t478, t479, t481, t487, t490, t493, t494;
  double t496, t499, t508, t511, t514, t525, t526, t527;
  double t530, t532, t537, tv3rho2sigma0, t549, t550, t553, t559;
  double t562, t565, t566, t568, t578, t581, t585, t593;
  double t596, t598, t601, t603, t608, tv3rhosigma20, t613, t614;
  double t615, t617, t620, t624, t627, t630, t632, t633;
  double t641, t644, t649, t653, t657, t662, t664, t668;
  double tv3sigma30;

  gga_x_pw91_params *params;

  assert(p->params != NULL);
  params = (gga_x_pw91_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t37 = exp(-params->alpha * t20 * t25 * t34 / 0.24e2);
  t40 = (params->d * t37 + params->c) * t20;
  t41 = t40 * t25;
  t44 = t20 * t20;
  t45 = 0.1e1 / t23;
  t46 = t44 * t45;
  t47 = sqrt(sigma[0]);
  t50 = 0.1e1 / t18 / rho[0];
  t51 = t47 * t27 * t50;
  t54 = pow(t46 * t51 / 0.12e2, params->expo);
  t55 = params->f * t54;
  t56 = t41 * t34 / 0.24e2 - t55;
  t57 = t46 * t47;
  t63 = log(params->b * t44 * t45 * t51 / 0.12e2 + sqrt(POW_2(params->b * t44 * t45 * t51 / 0.12e2) + 0.1e1));
  t64 = params->a * t63;
  t65 = t27 * t50 * t64;
  t68 = 0.1e1 + t57 * t65 / 0.12e2 + t55;
  t69 = 0.1e1 / t68;
  t71 = t56 * t69 + 0.1e1;
  t75 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t71);
  tzk0 = 0.2e1 * t75;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t77 = t17 / t31;
  t81 = params->d * params->alpha;
  t83 = 0.1e1 / t23 / t22;
  t84 = t44 * t83;
  t85 = t81 * t84;
  t86 = sigma[0] * sigma[0];
  t87 = t86 * t27;
  t88 = t30 * t30;
  t89 = t88 * t30;
  t91 = 0.1e1 / t18 / t89;
  t92 = t91 * t37;
  t96 = t30 * rho[0];
  t98 = 0.1e1 / t31 / t96;
  t102 = 0.1e1 / rho[0];
  t105 = 0.4e1 / 0.3e1 * t55 * params->expo * t102;
  t106 = t85 * t87 * t92 / 0.108e3 - t41 * t29 * t98 / 0.9e1 + t105;
  t108 = t68 * t68;
  t109 = 0.1e1 / t108;
  t110 = t56 * t109;
  t114 = t27 / t18 / t30 * t64;
  t117 = t20 * t25;
  t118 = t117 * t29;
  t120 = params->b * params->b;
  t125 = 0.6e1 * t120 * t20 * t25 * t34 + 0.144e3;
  t126 = sqrt(t125);
  t128 = params->b / t126;
  t129 = t98 * params->a * t128;
  t132 = -t57 * t114 / 0.9e1 - 0.2e1 / 0.3e1 * t118 * t129 - t105;
  t134 = t106 * t69 - t110 * t132;
  t139 = my_piecewise3(t2, 0, -t6 * t77 * t71 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t134);
  tvrho0 = 0.2e1 * rho[0] * t139 + 0.2e1 * t75;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t142 = t88 * rho[0];
  t144 = 0.1e1 / t18 / t142;
  t145 = t27 * t144;
  t146 = t37 * sigma[0];
  t150 = t25 * t28;
  t154 = 0.1e1 / sigma[0];
  t157 = t55 * params->expo * t154 / 0.2e1;
  t158 = -t85 * t145 * t146 / 0.288e3 + t40 * t150 * t33 / 0.24e2 - t157;
  t161 = t46 / t47;
  t164 = t117 * t28;
  t166 = t33 * params->a * t128;
  t169 = t161 * t65 / 0.24e2 + t164 * t166 / 0.4e1 + t157;
  t171 = -t110 * t169 + t158 * t69;
  t175 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t171);
  tvsigma0 = 0.2e1 * rho[0] * t175;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t180 = t17 / t31 / rho[0];
  t187 = t88 * t96;
  t189 = 0.1e1 / t18 / t187;
  t190 = t189 * t37;
  t194 = params->alpha * params->alpha;
  t195 = params->d * t194;
  t196 = t22 * t22;
  t197 = 0.1e1 / t196;
  t198 = t195 * t197;
  t199 = t86 * sigma[0];
  t200 = t88 * t88;
  t201 = t200 * t30;
  t202 = 0.1e1 / t201;
  t208 = 0.1e1 / t31 / t88;
  t212 = params->expo * params->expo;
  t213 = 0.1e1 / t30;
  t214 = t212 * t213;
  t216 = 0.16e2 / 0.9e1 * t55 * t214;
  t219 = 0.4e1 / 0.3e1 * t55 * params->expo * t213;
  t220 = -t85 * t87 * t190 / 0.12e2 + t198 * t199 * t202 * t37 / 0.81e2 + 0.11e2 / 0.27e2 * t41 * t29 * t208 - t216 - t219;
  t222 = t106 * t109;
  t226 = 0.1e1 / t108 / t68;
  t227 = t56 * t226;
  t228 = t132 * t132;
  t234 = t27 / t18 / t96 * t64;
  t238 = t208 * params->a * t128;
  t241 = t84 * t87;
  t243 = t120 * params->b;
  t245 = 0.1e1 / t126 / t125;
  t246 = t243 * t245;
  t247 = t189 * params->a * t246;
  t250 = 0.7e1 / 0.27e2 * t57 * t234 + 0.1e2 / 0.3e1 * t118 * t238 - 0.32e2 / 0.3e1 * t241 * t247 + t216 + t219;
  t252 = -t110 * t250 - 0.2e1 * t222 * t132 + t220 * t69 + 0.2e1 * t227 * t228;
  t257 = my_piecewise3(t2, 0, t6 * t180 * t71 / 0.12e2 - t6 * t77 * t134 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t252);
  tv2rho20 = 0.2e1 * rho[0] * t257 + 0.4e1 * t139;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t263 = t27 * t91;
  t267 = t200 * rho[0];
  t268 = 0.1e1 / t267;
  t276 = t212 * t102;
  t279 = 0.2e1 / 0.3e1 * t55 * t276 * t154;
  t280 = t85 * t263 * t146 / 0.36e2 - t198 * t268 * t86 * t37 / 0.216e3 - t40 * t150 * t98 / 0.9e1 + t279;
  t282 = t158 * t109;
  t285 = t169 * t132;
  t294 = params->a * t243 * t245 * sigma[0];
  t297 = -t161 * t114 / 0.18e2 - t164 * t129 + 0.4e1 * t84 * t263 * t294 - t279;
  t299 = -t110 * t297 - t282 * t132 - t222 * t169 + 0.2e1 * t227 * t285 + t280 * t69;
  t304 = my_piecewise3(t2, 0, -t6 * t77 * t171 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t299);
  tv2rhosigma0 = 0.2e1 * rho[0] * t304 + 0.2e1 * t175;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t307 = 0.1e1 / t200;
  t312 = t81 * t44;
  t313 = t83 * t27;
  t318 = 0.1e1 / t86;
  t321 = t55 * t212 * t318 / 0.4e1;
  t324 = t55 * params->expo * t318 / 0.2e1;
  t325 = t198 * t307 * t37 * sigma[0] / 0.576e3 - t312 * t313 * t144 * t37 / 0.144e3 - t321 + t324;
  t329 = t169 * t169;
  t334 = t46 / t47 / sigma[0];
  t338 = t117 * t154 * t28;
  t341 = t84 * t27;
  t343 = t144 * params->a * t246;
  t346 = -t334 * t65 / 0.48e2 + t338 * t166 / 0.8e1 - 0.3e1 / 0.2e1 * t341 * t343 + t321 - t324;
  t348 = -t110 * t346 - 0.2e1 * t282 * t169 + 0.2e1 * t227 * t329 + t325 * t69;
  t352 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t348);
  tv2sigma20 = 0.2e1 * rho[0] * t352;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t355 = t17 * t33;
  t366 = 0.1e1 / t18 / t200;
  t371 = t200 * t96;
  t372 = 0.1e1 / t371;
  t378 = params->d * t194 * params->alpha;
  t379 = t86 * t86;
  t380 = t197 * t379;
  t381 = t378 * t380;
  t382 = t200 * t142;
  t384 = 0.1e1 / t31 / t382;
  t386 = t150 * t37;
  t391 = 0.1e1 / t31 / t142;
  t395 = t212 * params->expo;
  t396 = 0.1e1 / t96;
  t397 = t395 * t396;
  t399 = 0.64e2 / 0.27e2 * t55 * t397;
  t400 = t212 * t396;
  t402 = 0.16e2 / 0.3e1 * t55 * t400;
  t405 = 0.8e1 / 0.3e1 * t55 * params->expo * t396;
  t406 = 0.341e3 / 0.486e3 * t85 * t87 * t366 * t37 - 0.19e2 / 0.81e2 * t198 * t199 * t372 * t37 + t381 * t384 * t20 * t386 / 0.729e3 - 0.154e3 / 0.81e2 * t41 * t29 * t391 + t399 + t402 + t405;
  t408 = t220 * t109;
  t411 = t106 * t226;
  t416 = t108 * t108;
  t417 = 0.1e1 / t416;
  t418 = t56 * t417;
  t419 = t228 * t132;
  t422 = t132 * t250;
  t428 = t27 / t18 / t88 * t64;
  t432 = t391 * params->a * t128;
  t439 = t197 * t199;
  t441 = t120 * t120;
  t442 = t441 * params->b;
  t444 = t125 * t125;
  t446 = 0.1e1 / t126 / t444;
  t447 = params->a * t442 * t446;
  t450 = -0.7e2 / 0.81e2 * t57 * t428 - 0.476e3 / 0.27e2 * t118 * t432 + 0.1184e4 / 0.9e1 * t241 * t366 * params->a * t246 - 0.3072e4 * t439 * t372 * t447 - t399 - t402 - t405;
  t452 = -t110 * t450 - 0.3e1 * t408 * t132 - 0.3e1 * t222 * t250 + 0.6e1 * t227 * t422 + 0.6e1 * t411 * t228 + t406 * t69 - 0.6e1 * t418 * t419;
  t457 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t355 * t71 + t6 * t180 * t134 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t77 * t252 - 0.3e1 / 0.8e1 * t6 * t19 * t452);
  tv3rho30 = 0.2e1 * rho[0] * t457 + 0.6e1 * t257;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t467 = t27 * t189;
  t475 = t200 * t88;
  t478 = t197 / t31 / t475;
  t479 = t378 * t478;
  t481 = t199 * t20 * t386;
  t487 = t395 * t213;
  t490 = 0.8e1 / 0.9e1 * t55 * t487 * t154;
  t493 = 0.2e1 / 0.3e1 * t55 * t214 * t154;
  t494 = -0.65e2 / 0.324e3 * t85 * t467 * t146 + 0.17e2 / 0.216e3 * t198 * t202 * t86 * t37 - t479 * t481 / 0.1944e4 + 0.11e2 / 0.27e2 * t40 * t150 * t208 - t490 - t493;
  t496 = t280 * t109;
  t499 = t158 * t226;
  t508 = t169 * t228;
  t511 = t297 * t132;
  t514 = t169 * t250;
  t525 = t197 * t202 * params->a;
  t526 = t442 * t446;
  t527 = t526 * t86;
  t530 = 0.7e1 / 0.54e2 * t161 * t234 + 0.37e2 / 0.9e1 * t164 * t238 - 0.124e3 / 0.3e1 * t84 * t467 * t294 + 0.1152e4 * t525 * t527 + t490 + t493;
  t532 = -t110 * t530 - 0.2e1 * t496 * t132 - t408 * t169 - 0.2e1 * t222 * t297 + 0.4e1 * t227 * t511 + 0.2e1 * t227 * t514 + 0.2e1 * t499 * t228 - t282 * t250 + 0.4e1 * t411 * t285 - 0.6e1 * t418 * t508 + t494 * t69;
  t537 = my_piecewise3(t2, 0, t6 * t180 * t171 / 0.12e2 - t6 * t77 * t299 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t532);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t537 + 0.4e1 * t304;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t549 = t197 / t31 / t371;
  t550 = t378 * t549;
  t553 = t117 * t86 * t28 * t37;
  t559 = t395 * t102;
  t562 = t55 * t559 * t318 / 0.3e1;
  t565 = 0.2e1 / 0.3e1 * t55 * t276 * t318;
  t566 = -0.5e1 / 0.216e3 * t198 * t268 * t37 * sigma[0] + t550 * t553 / 0.5184e4 + t312 * t313 * t92 / 0.27e2 + t562 - t565;
  t568 = t325 * t109;
  t578 = t329 * t132;
  t581 = t169 * t297;
  t585 = t346 * t132;
  t593 = t91 * params->a * t246;
  t596 = t197 * t268;
  t598 = t526 * sigma[0];
  t601 = t334 * t114 / 0.36e2 - t338 * t129 / 0.6e1 + 0.1e2 * t341 * t593 - 0.432e3 * t596 * params->a * t598 - t562 + t565;
  t603 = -t110 * t601 - t568 * t132 - 0.2e1 * t496 * t169 - t222 * t346 + 0.4e1 * t227 * t581 + 0.2e1 * t227 * t585 - 0.2e1 * t282 * t297 + 0.4e1 * t499 * t285 + 0.2e1 * t411 * t329 - 0.6e1 * t418 * t578 + t566 * t69;
  t608 = my_piecewise3(t2, 0, -t6 * t77 * t348 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t603);
  tv3rhosigma20 = 0.2e1 * rho[0] * t608 + 0.2e1 * t352;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t613 = t197 / t31 / t201;
  t614 = t378 * t613;
  t615 = t28 * t37;
  t617 = t117 * t615 * sigma[0];
  t620 = t197 * t307;
  t624 = 0.1e1 / t199;
  t627 = t55 * t395 * t624 / 0.8e1;
  t630 = 0.3e1 / 0.4e1 * t55 * t212 * t624;
  t632 = t55 * params->expo * t624;
  t633 = -t614 * t617 / 0.13824e5 + t195 * t620 * t37 / 0.192e3 - t627 + t630 - t632;
  t641 = t329 * t169;
  t644 = t169 * t346;
  t649 = t46 / t47 / t86;
  t653 = t117 * t318 * t28;
  t657 = t84 * t154 * t27;
  t662 = t649 * t65 / 0.32e2 - 0.3e1 / 0.16e2 * t653 * t166 - 0.3e1 / 0.4e1 * t657 * t343 + 0.162e3 * t620 * t447 + t627 - t630 + t632;
  t664 = -t110 * t662 - 0.3e1 * t568 * t169 + 0.6e1 * t227 * t644 - 0.3e1 * t282 * t346 + 0.6e1 * t499 * t329 - 0.6e1 * t418 * t641 + t633 * t69;
  t668 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t664);
  tv3sigma30 = 0.2e1 * rho[0] * t668;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t22, t23;
  double t24, t25, t27, t28, t29, t30, t31, t33;
  double t34, t37, t40, t41, t44, t45, t46, t47;
  double t50, t51, t54, t55, t56, t57, t63, t64;
  double t65, t68, t69, t71, t75, tzk0;

  double t77, t81, t83, t84, t85, t86, t87, t88;
  double t89, t91, t92, t96, t98, t102, t105, t106;
  double t108, t109, t110, t114, t117, t118, t120, t125;
  double t126, t128, t129, t132, t134, t139, tvrho0, t142;
  double t144, t145, t146, t150, t154, t157, t158, t161;
  double t164, t166, t169, t171, t175, tvsigma0;

  double t180, t187, t189, t190, t194, t195, t196, t197;
  double t198, t199, t200, t201, t202, t208, t212, t213;
  double t214, t216, t219, t220, t222, t226, t227, t228;
  double t234, t238, t241, t243, t245, t246, t247, t250;
  double t252, t257, tv2rho20, t263, t267, t268, t276, t279;
  double t280, t282, t285, t294, t297, t299, t304, tv2rhosigma0;
  double t307, t312, t313, t318, t321, t324, t325, t329;
  double t334, t338, t341, t343, t346, t348, t352, tv2sigma20;

  double t355, t366, t371, t372, t378, t379, t380, t381;
  double t382, t384, t386, t391, t395, t396, t397, t399;
  double t400, t402, t405, t406, t408, t411, t416, t417;
  double t418, t419, t422, t428, t432, t439, t441, t442;
  double t444, t446, t447, t450, t452, t457, tv3rho30, t467;
  double t475, t478, t479, t481, t487, t490, t493, t494;
  double t496, t499, t508, t511, t514, t525, t526, t527;
  double t530, t532, t537, tv3rho2sigma0, t549, t550, t553, t559;
  double t562, t565, t566, t568, t578, t581, t585, t593;
  double t596, t598, t601, t603, t608, tv3rhosigma20, t613, t614;
  double t615, t617, t620, t624, t627, t630, t632, t633;
  double t641, t644, t649, t653, t657, t662, t664, t668;
  double tv3sigma30;

  double t685, t690, t695, t697, t702, t703, t707, t712;
  double t717, t721, t722, t725, t728, t731, t734, t737;
  double t740, t745, t754, t755, t761, t783, t786, t793;
  double t798, tv4rho40, t811, t819, t837, t840, t843, t854;
  double t857, t881, t903, t911, t917, tv4rho3sigma0, t959, t960;
  double t963, t994, t997, t1000, t1003, t1030, t1036, tv4rho2sigma20;
  double t1058, t1060, t1063, t1066, t1118, t1126, t1132, tv4rhosigma30;
  double t1147, t1150, t1153, t1156, t1159, t1174, t1180, t1209;
  double t1213, tv4sigma40;

  gga_x_pw91_params *params;

  assert(p->params != NULL);
  params = (gga_x_pw91_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = sigma[0] * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t34 = t29 * t33;
  t37 = exp(-params->alpha * t20 * t25 * t34 / 0.24e2);
  t40 = (params->d * t37 + params->c) * t20;
  t41 = t40 * t25;
  t44 = t20 * t20;
  t45 = 0.1e1 / t23;
  t46 = t44 * t45;
  t47 = sqrt(sigma[0]);
  t50 = 0.1e1 / t18 / rho[0];
  t51 = t47 * t27 * t50;
  t54 = pow(t46 * t51 / 0.12e2, params->expo);
  t55 = params->f * t54;
  t56 = t41 * t34 / 0.24e2 - t55;
  t57 = t46 * t47;
  t63 = log(params->b * t44 * t45 * t51 / 0.12e2 + sqrt(POW_2(params->b * t44 * t45 * t51 / 0.12e2) + 0.1e1));
  t64 = params->a * t63;
  t65 = t27 * t50 * t64;
  t68 = 0.1e1 + t57 * t65 / 0.12e2 + t55;
  t69 = 0.1e1 / t68;
  t71 = t56 * t69 + 0.1e1;
  t75 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t71);
  tzk0 = 0.2e1 * t75;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t77 = t17 / t31;
  t81 = params->d * params->alpha;
  t83 = 0.1e1 / t23 / t22;
  t84 = t44 * t83;
  t85 = t81 * t84;
  t86 = sigma[0] * sigma[0];
  t87 = t86 * t27;
  t88 = t30 * t30;
  t89 = t88 * t30;
  t91 = 0.1e1 / t18 / t89;
  t92 = t91 * t37;
  t96 = t30 * rho[0];
  t98 = 0.1e1 / t31 / t96;
  t102 = 0.1e1 / rho[0];
  t105 = 0.4e1 / 0.3e1 * t55 * params->expo * t102;
  t106 = t85 * t87 * t92 / 0.108e3 - t41 * t29 * t98 / 0.9e1 + t105;
  t108 = t68 * t68;
  t109 = 0.1e1 / t108;
  t110 = t56 * t109;
  t114 = t27 / t18 / t30 * t64;
  t117 = t20 * t25;
  t118 = t117 * t29;
  t120 = params->b * params->b;
  t125 = 0.6e1 * t120 * t20 * t25 * t34 + 0.144e3;
  t126 = sqrt(t125);
  t128 = params->b / t126;
  t129 = t98 * params->a * t128;
  t132 = -t57 * t114 / 0.9e1 - 0.2e1 / 0.3e1 * t118 * t129 - t105;
  t134 = t106 * t69 - t110 * t132;
  t139 = my_piecewise3(t2, 0, -t6 * t77 * t71 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t134);
  tvrho0 = 0.2e1 * rho[0] * t139 + 0.2e1 * t75;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t142 = t88 * rho[0];
  t144 = 0.1e1 / t18 / t142;
  t145 = t27 * t144;
  t146 = t37 * sigma[0];
  t150 = t25 * t28;
  t154 = 0.1e1 / sigma[0];
  t157 = t55 * params->expo * t154 / 0.2e1;
  t158 = -t85 * t145 * t146 / 0.288e3 + t40 * t150 * t33 / 0.24e2 - t157;
  t161 = t46 / t47;
  t164 = t117 * t28;
  t166 = t33 * params->a * t128;
  t169 = t161 * t65 / 0.24e2 + t164 * t166 / 0.4e1 + t157;
  t171 = -t110 * t169 + t158 * t69;
  t175 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t171);
  tvsigma0 = 0.2e1 * rho[0] * t175;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t180 = t17 / t31 / rho[0];
  t187 = t88 * t96;
  t189 = 0.1e1 / t18 / t187;
  t190 = t189 * t37;
  t194 = params->alpha * params->alpha;
  t195 = params->d * t194;
  t196 = t22 * t22;
  t197 = 0.1e1 / t196;
  t198 = t195 * t197;
  t199 = t86 * sigma[0];
  t200 = t88 * t88;
  t201 = t200 * t30;
  t202 = 0.1e1 / t201;
  t208 = 0.1e1 / t31 / t88;
  t212 = params->expo * params->expo;
  t213 = 0.1e1 / t30;
  t214 = t212 * t213;
  t216 = 0.16e2 / 0.9e1 * t55 * t214;
  t219 = 0.4e1 / 0.3e1 * t55 * params->expo * t213;
  t220 = -t85 * t87 * t190 / 0.12e2 + t198 * t199 * t202 * t37 / 0.81e2 + 0.11e2 / 0.27e2 * t41 * t29 * t208 - t216 - t219;
  t222 = t106 * t109;
  t226 = 0.1e1 / t108 / t68;
  t227 = t56 * t226;
  t228 = t132 * t132;
  t234 = t27 / t18 / t96 * t64;
  t238 = t208 * params->a * t128;
  t241 = t84 * t87;
  t243 = t120 * params->b;
  t245 = 0.1e1 / t126 / t125;
  t246 = t243 * t245;
  t247 = t189 * params->a * t246;
  t250 = 0.7e1 / 0.27e2 * t57 * t234 + 0.1e2 / 0.3e1 * t118 * t238 - 0.32e2 / 0.3e1 * t241 * t247 + t216 + t219;
  t252 = -t110 * t250 - 0.2e1 * t222 * t132 + t220 * t69 + 0.2e1 * t227 * t228;
  t257 = my_piecewise3(t2, 0, t6 * t180 * t71 / 0.12e2 - t6 * t77 * t134 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t252);
  tv2rho20 = 0.2e1 * rho[0] * t257 + 0.4e1 * t139;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t263 = t27 * t91;
  t267 = t200 * rho[0];
  t268 = 0.1e1 / t267;
  t276 = t212 * t102;
  t279 = 0.2e1 / 0.3e1 * t55 * t276 * t154;
  t280 = t85 * t263 * t146 / 0.36e2 - t198 * t268 * t86 * t37 / 0.216e3 - t40 * t150 * t98 / 0.9e1 + t279;
  t282 = t158 * t109;
  t285 = t169 * t132;
  t294 = params->a * t243 * t245 * sigma[0];
  t297 = -t161 * t114 / 0.18e2 - t164 * t129 + 0.4e1 * t84 * t263 * t294 - t279;
  t299 = -t110 * t297 - t282 * t132 - t222 * t169 + 0.2e1 * t227 * t285 + t280 * t69;
  t304 = my_piecewise3(t2, 0, -t6 * t77 * t171 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t299);
  tv2rhosigma0 = 0.2e1 * rho[0] * t304 + 0.2e1 * t175;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t307 = 0.1e1 / t200;
  t312 = t81 * t44;
  t313 = t83 * t27;
  t318 = 0.1e1 / t86;
  t321 = t55 * t212 * t318 / 0.4e1;
  t324 = t55 * params->expo * t318 / 0.2e1;
  t325 = t198 * t307 * t37 * sigma[0] / 0.576e3 - t312 * t313 * t144 * t37 / 0.144e3 - t321 + t324;
  t329 = t169 * t169;
  t334 = t46 / t47 / sigma[0];
  t338 = t117 * t154 * t28;
  t341 = t84 * t27;
  t343 = t144 * params->a * t246;
  t346 = -t334 * t65 / 0.48e2 + t338 * t166 / 0.8e1 - 0.3e1 / 0.2e1 * t341 * t343 + t321 - t324;
  t348 = -t110 * t346 - 0.2e1 * t282 * t169 + 0.2e1 * t227 * t329 + t325 * t69;
  t352 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t348);
  tv2sigma20 = 0.2e1 * rho[0] * t352;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t355 = t17 * t33;
  t366 = 0.1e1 / t18 / t200;
  t371 = t200 * t96;
  t372 = 0.1e1 / t371;
  t378 = params->d * t194 * params->alpha;
  t379 = t86 * t86;
  t380 = t197 * t379;
  t381 = t378 * t380;
  t382 = t200 * t142;
  t384 = 0.1e1 / t31 / t382;
  t386 = t150 * t37;
  t391 = 0.1e1 / t31 / t142;
  t395 = t212 * params->expo;
  t396 = 0.1e1 / t96;
  t397 = t395 * t396;
  t399 = 0.64e2 / 0.27e2 * t55 * t397;
  t400 = t212 * t396;
  t402 = 0.16e2 / 0.3e1 * t55 * t400;
  t405 = 0.8e1 / 0.3e1 * t55 * params->expo * t396;
  t406 = 0.341e3 / 0.486e3 * t85 * t87 * t366 * t37 - 0.19e2 / 0.81e2 * t198 * t199 * t372 * t37 + t381 * t384 * t20 * t386 / 0.729e3 - 0.154e3 / 0.81e2 * t41 * t29 * t391 + t399 + t402 + t405;
  t408 = t220 * t109;
  t411 = t106 * t226;
  t416 = t108 * t108;
  t417 = 0.1e1 / t416;
  t418 = t56 * t417;
  t419 = t228 * t132;
  t422 = t132 * t250;
  t428 = t27 / t18 / t88 * t64;
  t432 = t391 * params->a * t128;
  t439 = t197 * t199;
  t441 = t120 * t120;
  t442 = t441 * params->b;
  t444 = t125 * t125;
  t446 = 0.1e1 / t126 / t444;
  t447 = params->a * t442 * t446;
  t450 = -0.7e2 / 0.81e2 * t57 * t428 - 0.476e3 / 0.27e2 * t118 * t432 + 0.1184e4 / 0.9e1 * t241 * t366 * params->a * t246 - 0.3072e4 * t439 * t372 * t447 - t399 - t402 - t405;
  t452 = -t110 * t450 - 0.3e1 * t408 * t132 - 0.3e1 * t222 * t250 + 0.6e1 * t227 * t422 + 0.6e1 * t411 * t228 + t406 * t69 - 0.6e1 * t418 * t419;
  t457 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t355 * t71 + t6 * t180 * t134 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t77 * t252 - 0.3e1 / 0.8e1 * t6 * t19 * t452);
  tv3rho30 = 0.2e1 * rho[0] * t457 + 0.6e1 * t257;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t467 = t27 * t189;
  t475 = t200 * t88;
  t478 = t197 / t31 / t475;
  t479 = t378 * t478;
  t481 = t199 * t20 * t386;
  t487 = t395 * t213;
  t490 = 0.8e1 / 0.9e1 * t55 * t487 * t154;
  t493 = 0.2e1 / 0.3e1 * t55 * t214 * t154;
  t494 = -0.65e2 / 0.324e3 * t85 * t467 * t146 + 0.17e2 / 0.216e3 * t198 * t202 * t86 * t37 - t479 * t481 / 0.1944e4 + 0.11e2 / 0.27e2 * t40 * t150 * t208 - t490 - t493;
  t496 = t280 * t109;
  t499 = t158 * t226;
  t508 = t169 * t228;
  t511 = t297 * t132;
  t514 = t169 * t250;
  t525 = t197 * t202 * params->a;
  t526 = t442 * t446;
  t527 = t526 * t86;
  t530 = 0.7e1 / 0.54e2 * t161 * t234 + 0.37e2 / 0.9e1 * t164 * t238 - 0.124e3 / 0.3e1 * t84 * t467 * t294 + 0.1152e4 * t525 * t527 + t490 + t493;
  t532 = -t110 * t530 - 0.2e1 * t496 * t132 - t408 * t169 - 0.2e1 * t222 * t297 + 0.4e1 * t227 * t511 + 0.2e1 * t227 * t514 + 0.2e1 * t499 * t228 - t282 * t250 + 0.4e1 * t411 * t285 - 0.6e1 * t418 * t508 + t494 * t69;
  t537 = my_piecewise3(t2, 0, t6 * t180 * t171 / 0.12e2 - t6 * t77 * t299 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t532);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t537 + 0.4e1 * t304;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t549 = t197 / t31 / t371;
  t550 = t378 * t549;
  t553 = t117 * t86 * t28 * t37;
  t559 = t395 * t102;
  t562 = t55 * t559 * t318 / 0.3e1;
  t565 = 0.2e1 / 0.3e1 * t55 * t276 * t318;
  t566 = -0.5e1 / 0.216e3 * t198 * t268 * t37 * sigma[0] + t550 * t553 / 0.5184e4 + t312 * t313 * t92 / 0.27e2 + t562 - t565;
  t568 = t325 * t109;
  t578 = t329 * t132;
  t581 = t169 * t297;
  t585 = t346 * t132;
  t593 = t91 * params->a * t246;
  t596 = t197 * t268;
  t598 = t526 * sigma[0];
  t601 = t334 * t114 / 0.36e2 - t338 * t129 / 0.6e1 + 0.1e2 * t341 * t593 - 0.432e3 * t596 * params->a * t598 - t562 + t565;
  t603 = -t110 * t601 - t568 * t132 - 0.2e1 * t496 * t169 - t222 * t346 + 0.4e1 * t227 * t581 + 0.2e1 * t227 * t585 - 0.2e1 * t282 * t297 + 0.4e1 * t499 * t285 + 0.2e1 * t411 * t329 - 0.6e1 * t418 * t578 + t566 * t69;
  t608 = my_piecewise3(t2, 0, -t6 * t77 * t348 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t603);
  tv3rhosigma20 = 0.2e1 * rho[0] * t608 + 0.2e1 * t352;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t613 = t197 / t31 / t201;
  t614 = t378 * t613;
  t615 = t28 * t37;
  t617 = t117 * t615 * sigma[0];
  t620 = t197 * t307;
  t624 = 0.1e1 / t199;
  t627 = t55 * t395 * t624 / 0.8e1;
  t630 = 0.3e1 / 0.4e1 * t55 * t212 * t624;
  t632 = t55 * params->expo * t624;
  t633 = -t614 * t617 / 0.13824e5 + t195 * t620 * t37 / 0.192e3 - t627 + t630 - t632;
  t641 = t329 * t169;
  t644 = t169 * t346;
  t649 = t46 / t47 / t86;
  t653 = t117 * t318 * t28;
  t657 = t84 * t154 * t27;
  t662 = t649 * t65 / 0.32e2 - 0.3e1 / 0.16e2 * t653 * t166 - 0.3e1 / 0.4e1 * t657 * t343 + 0.162e3 * t620 * t447 + t627 - t630 + t632;
  t664 = -t110 * t662 - 0.3e1 * t568 * t169 + 0.6e1 * t227 * t644 - 0.3e1 * t282 * t346 + 0.6e1 * t499 * t329 - 0.6e1 * t418 * t641 + t633 * t69;
  t668 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t664);
  tv3sigma30 = 0.2e1 * rho[0] * t668;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t685 = 0.1e1 / t18 / t267;
  t690 = 0.1e1 / t475;
  t695 = t200 * t89;
  t697 = 0.1e1 / t31 / t695;
  t702 = t194 * t194;
  t703 = params->d * t702;
  t707 = t200 * t200;
  t712 = t313 * t37;
  t717 = 0.1e1 / t31 / t89;
  t721 = t212 * t212;
  t722 = 0.1e1 / t88;
  t725 = 0.256e3 / 0.81e2 * t55 * t721 * t722;
  t728 = 0.128e3 / 0.9e1 * t55 * t395 * t722;
  t731 = 0.176e3 / 0.9e1 * t55 * t212 * t722;
  t734 = 0.8e1 * t55 * params->expo * t722;
  t737 = t406 * t109;
  t740 = t220 * t226;
  t745 = t106 * t417;
  t754 = t56 / t416 / t68;
  t755 = t228 * t228;
  t761 = t250 * t250;
  t783 = t441 * t243;
  t786 = 0.1e1 / t126 / t444 / t125;
  t793 = (-0.3047e4 / 0.486e3 * t85 * t87 * t685 * t37 + 0.2563e4 / 0.729e3 * t198 * t199 * t690 * t37 - 0.98e2 / 0.2187e4 * t381 * t697 * t20 * t386 + 0.2e1 / 0.6561e4 * t703 * t197 * t379 * sigma[0] / t18 / t707 / rho[0] * t44 * t712 + 0.2618e4 / 0.243e3 * t41 * t29 * t717 - t725 - t728 - t731 - t734) * t69 - 0.4e1 * t737 * t132 + 0.12e2 * t740 * t228 - 0.6e1 * t408 * t250 - 0.24e2 * t745 * t419 + 0.24e2 * t411 * t422 - 0.4e1 * t222 * t450 + 0.24e2 * t754 * t755 - 0.36e2 * t418 * t228 * t250 + 0.6e1 * t227 * t761 + 0.8e1 * t227 * t132 * t450 - t110 * (0.91e3 / 0.243e3 * t57 * t145 * t64 + 0.2884e4 / 0.27e2 * t118 * t717 * params->a * t128 - 0.37216e5 / 0.27e2 * t241 * t685 * params->a * t246 + 0.7168e5 * t439 * t690 * t447 - 0.12288e6 * t380 * t697 * params->a * t783 * t786 * t164 + t725 + t728 + t731 + t734);
  t798 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t98 * t71 - 0.5e1 / 0.9e1 * t6 * t355 * t134 + t6 * t180 * t252 / 0.2e1 - t6 * t77 * t452 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * t793);
  tv4rho40 = 0.2e1 * rho[0] * t798 + 0.8e1 * t457;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t811 = t27 * t366;
  t819 = t197 * t384;
  t837 = 0.32e2 / 0.27e2 * t55 * t721 * t396 * t154;
  t840 = 0.8e1 / 0.3e1 * t55 * t397 * t154;
  t843 = 0.4e1 / 0.3e1 * t55 * t400 * t154;
  t854 = t280 * t226;
  t857 = t158 * t417;
  t881 = t494 * t109;
  t903 = params->a * t783;
  t911 = -0.18e2 * t418 * t297 * t228 + 0.6e1 * t227 * t530 * t132 + 0.6e1 * t227 * t297 * t250 + 0.2e1 * t227 * t169 * t450 - 0.3e1 * t881 * t132 - 0.3e1 * t496 * t250 - t282 * t450 - t737 * t169 - 0.3e1 * t408 * t297 - 0.3e1 * t222 * t530 - t110 * (-0.35e2 / 0.81e2 * t161 * t428 - 0.182e3 / 0.9e1 * t164 * t432 + 0.332e4 / 0.9e1 * t84 * t811 * t294 - 0.23424e5 * t197 * t372 * params->a * t527 + 0.4608e5 * t819 * t903 * t786 * t199 * t164 - t837 - t840 - t843);
  t917 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t355 * t171 + t6 * t180 * t299 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t77 * t532 - 0.3e1 / 0.8e1 * t6 * t19 * ((0.253e3 / 0.162e3 * t85 * t811 * t146 - 0.1025e4 / 0.972e3 * t198 * t372 * t86 * t37 + 0.89e2 / 0.5832e4 * t378 * t819 * t481 - t703 * t197 / t18 / t707 * t379 * t44 * t712 / 0.8748e4 - 0.154e3 / 0.81e2 * t40 * t150 * t391 + t837 + t840 + t843) * t69 - 0.18e2 * t745 * t508 + 0.24e2 * t754 * t169 * t419 - 0.18e2 * t418 * t285 * t250 + 0.6e1 * t854 * t228 - 0.6e1 * t857 * t419 + 0.6e1 * t499 * t422 + 0.6e1 * t740 * t285 + 0.12e2 * t411 * t511 + 0.6e1 * t411 * t514 + t911));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t917 + 0.6e1 * t537;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t959 = 0.4e1 * t227 * t601 * t132 + 0.4e1 * t227 * t169 * t530 + 0.2e1 * t227 * t346 * t250 + 0.24e2 * t754 * t329 * t228 - 0.6e1 * t418 * t346 * t228 - 0.6e1 * t418 * t329 * t250 + 0.8e1 * t854 * t285 + 0.8e1 * t411 * t581 + 0.4e1 * t411 * t585 + 0.8e1 * t499 * t511 + 0.4e1 * t499 * t514 - 0.12e2 * t857 * t508 - 0.12e2 * t745 * t578;
  t960 = t297 * t297;
  t963 = t566 * t109;
  t994 = 0.4e1 / 0.9e1 * t55 * t721 * t213 * t318;
  t997 = 0.5e1 / 0.9e1 * t55 * t487 * t318;
  t1000 = 0.2e1 / 0.3e1 * t55 * t214 * t318;
  t1003 = t325 * t226;
  t1030 = 0.4e1 * t227 * t960 - 0.2e1 * t963 * t132 - t568 * t250 - 0.2e1 * t881 * t169 - 0.4e1 * t496 * t297 - 0.2e1 * t282 * t530 + 0.2e1 * t740 * t329 - t408 * t346 - 0.2e1 * t222 * t601 - t110 * (-0.7e1 / 0.108e3 * t334 * t234 + 0.7e1 / 0.18e2 * t338 * t238 - 0.66e2 * t341 * t247 + 0.6768e4 * t525 * t598 - 0.1728e5 * t478 * t903 * t786 * t86 * t164 + t994 - t997 - t1000) + 0.2e1 * t1003 * t228 + (0.167e3 / 0.648e3 * t198 * t202 * t37 * sigma[0] - 0.25e2 / 0.5184e4 * t479 * t553 + t703 * t197 / t18 / t200 / t187 * t84 * t199 * t27 * t37 / 0.23328e5 - 0.19e2 / 0.81e2 * t312 * t313 * t190 - t994 + t997 + t1000) * t69 - 0.24e2 * t418 * t285 * t297;
  t1036 = my_piecewise3(t2, 0, t6 * t180 * t348 / 0.12e2 - t6 * t77 * t603 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t959 + t1030));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1036 + 0.4e1 * t608;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1058 = t55 * t721 * t102 * t624 / 0.6e1;
  t1060 = t55 * t559 * t624;
  t1063 = 0.4e1 / 0.3e1 * t55 * t276 * t624;
  t1066 = t633 * t109;
  t1118 = t786 * t20;
  t1126 = -0.3e1 * t282 * t601 - 0.6e1 * t745 * t641 + 0.24e2 * t754 * t641 * t132 - 0.18e2 * t418 * t329 * t297 + 0.6e1 * t411 * t644 - 0.18e2 * t418 * t644 * t132 + 0.6e1 * t227 * t297 * t346 + 0.6e1 * t227 * t169 * t601 - t222 * t662 + 0.2e1 * t227 * t662 * t132 - t110 * (-t649 * t114 / 0.24e2 + t653 * t129 / 0.4e1 + t657 * t593 - 0.1512e4 * t596 * t447 + 0.648e4 * t549 * t903 * t1118 * t25 * sigma[0] * t28 - t1058 + t1060 - t1063);
  t1132 = my_piecewise3(t2, 0, -t6 * t77 * t664 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * ((0.7e1 / 0.5184e4 * t550 * t617 - t703 * t197 / t18 / t695 * t84 * t87 * t37 / 0.62208e5 - t195 * t596 * t37 / 0.24e2 + t1058 - t1060 + t1063) * t69 - t1066 * t132 - 0.3e1 * t963 * t169 + 0.6e1 * t1003 * t285 - 0.3e1 * t568 * t297 + 0.6e1 * t854 * t329 - 0.18e2 * t857 * t578 + 0.12e2 * t499 * t581 - 0.3e1 * t496 * t346 + 0.6e1 * t499 * t585 + t1126));
  tv4rhosigma30 = 0.2e1 * rho[0] * t1132 + 0.2e1 * t668;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1147 = 0.1e1 / t379;
  t1150 = t55 * t721 * t1147 / 0.16e2;
  t1153 = 0.3e1 / 0.4e1 * t55 * t395 * t1147;
  t1156 = 0.11e2 / 0.4e1 * t55 * t212 * t1147;
  t1159 = 0.3e1 * t55 * params->expo * t1147;
  t1174 = t329 * t329;
  t1180 = t346 * t346;
  t1209 = (t703 * t197 / t18 / t382 * t84 * t27 * t37 * sigma[0] / 0.165888e6 - t614 * t117 * t615 / 0.3456e4 - t1150 + t1153 - t1156 + t1159) * t69 - 0.4e1 * t1066 * t169 + 0.12e2 * t1003 * t329 - 0.6e1 * t568 * t346 - 0.24e2 * t857 * t641 + 0.24e2 * t499 * t644 - 0.4e1 * t282 * t662 + 0.24e2 * t754 * t1174 - 0.36e2 * t418 * t329 * t346 + 0.6e1 * t227 * t1180 + 0.8e1 * t227 * t169 * t662 - t110 * (-0.5e1 / 0.64e2 * t46 / t47 / t199 * t65 + 0.15e2 / 0.32e2 * t117 * t624 * t28 * t166 + 0.15e2 / 0.8e1 * t84 * t318 * t27 * t343 + 0.81e2 * t197 * t154 * t307 * t447 - 0.243e4 * t613 * t903 * t1118 * t150 + t1150 - t1153 + t1156 - t1159);
  t1213 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1209);
  tv4sigma40 = 0.2e1 * rho[0] * t1213;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t40, t43, t46, t49, t50, t51, t52, t54;
  double t58, t59, t60, t61, t63, t68, t69, t72;
  double t73, t75, t79, t80, t81, t82, t83, t84;
  double t86, t87, t88, t89, t90, t91, t93, t94;
  double t97, t100, t103, t105, t109, t110, t111, t112;
  double t118, t119, t122, t123, t125, t129, tzk0;

  gga_x_pw91_params *params;

  assert(p->params != NULL);
  params = (gga_x_pw91_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->alpha * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t33 * sigma[0];
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = t34 * t39;
  t43 = exp(-t29 * t40 / 0.24e2);
  t46 = (params->d * t43 + params->c) * t28;
  t49 = t28 * t28;
  t50 = 0.1e1 / t31;
  t51 = t49 * t50;
  t52 = sqrt(sigma[0]);
  t54 = 0.1e1 / t36 / rho[0];
  t58 = pow(t51 * t52 * t54 / 0.12e2, params->expo);
  t59 = params->f * t58;
  t60 = t46 * t40 / 0.24e2 - t59;
  t61 = t51 * t52;
  t63 = params->b * t49;
  t68 = log(t63 * t50 * t52 * t54 / 0.12e2 + sqrt(POW_2(t63 * t50 * t52 * t54 / 0.12e2) + 0.1e1));
  t69 = t54 * params->a * t68;
  t72 = 0.1e1 + t61 * t69 / 0.12e2 + t59;
  t73 = 0.1e1 / t72;
  t75 = t60 * t73 + 0.1e1;
  t79 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t75);
  t80 = rho[1] <= p->dens_threshold;
  t81 = my_piecewise5(t14, t11, t10, t15, -t17);
  t82 = 0.1e1 + t81;
  t83 = t82 <= p->zeta_threshold;
  t84 = POW_1_3(t82);
  t86 = my_piecewise3(t83, t22, t84 * t82);
  t87 = t86 * t26;
  t88 = t33 * sigma[2];
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t93 = 0.1e1 / t91 / t89;
  t94 = t88 * t93;
  t97 = exp(-t29 * t94 / 0.24e2);
  t100 = (params->d * t97 + params->c) * t28;
  t103 = sqrt(sigma[2]);
  t105 = 0.1e1 / t90 / rho[1];
  t109 = pow(t51 * t103 * t105 / 0.12e2, params->expo);
  t110 = params->f * t109;
  t111 = t100 * t94 / 0.24e2 - t110;
  t112 = t51 * t103;
  t118 = log(t63 * t50 * t103 * t105 / 0.12e2 + sqrt(POW_2(t63 * t50 * t103 * t105 / 0.12e2) + 0.1e1));
  t119 = t105 * params->a * t118;
  t122 = 0.1e1 + t112 * t119 / 0.12e2 + t110;
  t123 = 0.1e1 / t122;
  t125 = t111 * t123 + 0.1e1;
  t129 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t125);
  tzk0 = t79 + t129;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t40, t43, t46, t49, t50, t51, t52, t54;
  double t58, t59, t60, t61, t63, t68, t69, t72;
  double t73, t75, t79, t80, t81, t82, t83, t84;
  double t86, t87, t88, t89, t90, t91, t93, t94;
  double t97, t100, t103, t105, t109, t110, t111, t112;
  double t118, t119, t122, t123, t125, t129, tzk0;

  double t130, t131, t132, t133, t134, t137, t138, t142;
  double t143, t144, t147, t149, t151, t152, t153, t154;
  double t155, t157, t162, t164, t168, t171, t172, t174;
  double t175, t176, t180, t183, t184, t186, t187, t190;
  double t191, t192, t193, t194, t197, t199, t204, t206;
  double t209, t210, t214, t217, t219, tvrho0, t222, t223;
  double t226, t227, t232, t234, t237, t238, t242, t243;
  double t244, t245, t247, t252, t254, t258, t261, t262;
  double t264, t265, t266, t270, t273, t277, t278, t279;
  double t280, t281, t284, t286, t291, tvrho1, t294, t296;
  double t297, t298, t305, t308, t309, t312, t316, t317;
  double t320, t322, t326, tvsigma0, tvsigma1, t327, t329, t330;
  double t331, t338, t341, t342, t345, t349, t352, t354;
  double t358, tvsigma2;

  gga_x_pw91_params *params;

  assert(p->params != NULL);
  params = (gga_x_pw91_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->alpha * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t33 * sigma[0];
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = t34 * t39;
  t43 = exp(-t29 * t40 / 0.24e2);
  t46 = (params->d * t43 + params->c) * t28;
  t49 = t28 * t28;
  t50 = 0.1e1 / t31;
  t51 = t49 * t50;
  t52 = sqrt(sigma[0]);
  t54 = 0.1e1 / t36 / rho[0];
  t58 = pow(t51 * t52 * t54 / 0.12e2, params->expo);
  t59 = params->f * t58;
  t60 = t46 * t40 / 0.24e2 - t59;
  t61 = t51 * t52;
  t63 = params->b * t49;
  t68 = log(t63 * t50 * t52 * t54 / 0.12e2 + sqrt(POW_2(t63 * t50 * t52 * t54 / 0.12e2) + 0.1e1));
  t69 = t54 * params->a * t68;
  t72 = 0.1e1 + t61 * t69 / 0.12e2 + t59;
  t73 = 0.1e1 / t72;
  t75 = t60 * t73 + 0.1e1;
  t79 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t75);
  t80 = rho[1] <= p->dens_threshold;
  t81 = my_piecewise5(t14, t11, t10, t15, -t17);
  t82 = 0.1e1 + t81;
  t83 = t82 <= p->zeta_threshold;
  t84 = POW_1_3(t82);
  t86 = my_piecewise3(t83, t22, t84 * t82);
  t87 = t86 * t26;
  t88 = t33 * sigma[2];
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t93 = 0.1e1 / t91 / t89;
  t94 = t88 * t93;
  t97 = exp(-t29 * t94 / 0.24e2);
  t100 = (params->d * t97 + params->c) * t28;
  t103 = sqrt(sigma[2]);
  t105 = 0.1e1 / t90 / rho[1];
  t109 = pow(t51 * t103 * t105 / 0.12e2, params->expo);
  t110 = params->f * t109;
  t111 = t100 * t94 / 0.24e2 - t110;
  t112 = t51 * t103;
  t118 = log(t63 * t50 * t103 * t105 / 0.12e2 + sqrt(POW_2(t63 * t50 * t103 * t105 / 0.12e2) + 0.1e1));
  t119 = t105 * params->a * t118;
  t122 = 0.1e1 + t112 * t119 / 0.12e2 + t110;
  t123 = 0.1e1 / t122;
  t125 = t111 * t123 + 0.1e1;
  t129 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t125);
  tzk0 = t79 + t129;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t130 = t6 * t6;
  t131 = 0.1e1 / t130;
  t132 = t16 * t131;
  t133 = t7 - t132;
  t134 = my_piecewise5(t10, 0, t14, 0, t133);
  t137 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t134);
  t138 = t137 * t26;
  t142 = t26 * t26;
  t143 = 0.1e1 / t142;
  t144 = t25 * t143;
  t147 = t5 * t144 * t75 / 0.8e1;
  t149 = params->d * params->alpha * t49;
  t151 = 0.1e1 / t31 / t30;
  t152 = sigma[0] * sigma[0];
  t153 = t151 * t152;
  t154 = t35 * t35;
  t155 = t154 * t35;
  t157 = 0.1e1 / t36 / t155;
  t162 = t35 * rho[0];
  t164 = 0.1e1 / t37 / t162;
  t168 = 0.1e1 / rho[0];
  t171 = 0.4e1 / 0.3e1 * t59 * params->expo * t168;
  t172 = t149 * t153 * t157 * t43 / 0.216e3 - t46 * t34 * t164 / 0.9e1 + t171;
  t174 = t72 * t72;
  t175 = 0.1e1 / t174;
  t176 = t60 * t175;
  t180 = 0.1e1 / t36 / t35 * params->a * t68;
  t183 = t28 * t33;
  t184 = t183 * sigma[0];
  t186 = params->b * params->b;
  t187 = t186 * t28;
  t190 = 0.6e1 * t187 * t40 + 0.144e3;
  t191 = sqrt(t190);
  t192 = 0.1e1 / t191;
  t193 = params->b * t192;
  t194 = t164 * params->a * t193;
  t197 = -t61 * t180 / 0.9e1 - 0.2e1 / 0.3e1 * t184 * t194 - t171;
  t199 = t172 * t73 - t176 * t197;
  t204 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t75 - t147 - 0.3e1 / 0.8e1 * t5 * t27 * t199);
  t206 = my_piecewise5(t14, 0, t10, 0, -t133);
  t209 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t206);
  t210 = t209 * t26;
  t214 = t86 * t143;
  t217 = t5 * t214 * t125 / 0.8e1;
  t219 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t210 * t125 - t217);
  tvrho0 = t79 + t129 + t6 * (t204 + t219);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t222 = -t7 - t132;
  t223 = my_piecewise5(t10, 0, t14, 0, t222);
  t226 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t223);
  t227 = t226 * t26;
  t232 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t227 * t75 - t147);
  t234 = my_piecewise5(t14, 0, t10, 0, -t222);
  t237 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t234);
  t238 = t237 * t26;
  t242 = sigma[2] * sigma[2];
  t243 = t151 * t242;
  t244 = t89 * t89;
  t245 = t244 * t89;
  t247 = 0.1e1 / t90 / t245;
  t252 = t89 * rho[1];
  t254 = 0.1e1 / t91 / t252;
  t258 = 0.1e1 / rho[1];
  t261 = 0.4e1 / 0.3e1 * t110 * params->expo * t258;
  t262 = t149 * t243 * t247 * t97 / 0.216e3 - t100 * t88 * t254 / 0.9e1 + t261;
  t264 = t122 * t122;
  t265 = 0.1e1 / t264;
  t266 = t111 * t265;
  t270 = 0.1e1 / t90 / t89 * params->a * t118;
  t273 = t183 * sigma[2];
  t277 = 0.6e1 * t187 * t94 + 0.144e3;
  t278 = sqrt(t277);
  t279 = 0.1e1 / t278;
  t280 = params->b * t279;
  t281 = t254 * params->a * t280;
  t284 = -t112 * t270 / 0.9e1 - 0.2e1 / 0.3e1 * t273 * t281 - t261;
  t286 = t262 * t123 - t266 * t284;
  t291 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t238 * t125 - t217 - 0.3e1 / 0.8e1 * t5 * t87 * t286);
  tvrho1 = t79 + t129 + t6 * (t232 + t291);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t294 = t154 * rho[0];
  t296 = 0.1e1 / t36 / t294;
  t297 = t151 * t296;
  t298 = t43 * sigma[0];
  t305 = 0.1e1 / sigma[0];
  t308 = t59 * params->expo * t305 / 0.2e1;
  t309 = -t149 * t297 * t298 / 0.576e3 + t46 * t33 * t39 / 0.24e2 - t308;
  t312 = t51 / t52;
  t316 = params->a * params->b;
  t317 = t316 * t192;
  t320 = t312 * t69 / 0.24e2 + t183 * t39 * t317 / 0.4e1 + t308;
  t322 = -t176 * t320 + t309 * t73;
  t326 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t322);
  tvsigma0 = t6 * t326;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t327 = t244 * rho[1];
  t329 = 0.1e1 / t90 / t327;
  t330 = t151 * t329;
  t331 = t97 * sigma[2];
  t338 = 0.1e1 / sigma[2];
  t341 = t110 * params->expo * t338 / 0.2e1;
  t342 = -t149 * t330 * t331 / 0.576e3 + t100 * t33 * t93 / 0.24e2 - t341;
  t345 = t51 / t103;
  t349 = t316 * t279;
  t352 = t345 * t119 / 0.24e2 + t183 * t93 * t349 / 0.4e1 + t341;
  t354 = t342 * t123 - t266 * t352;
  t358 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t354);
  tvsigma2 = t6 * t358;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t40, t43, t46, t49, t50, t51, t52, t54;
  double t58, t59, t60, t61, t63, t68, t69, t72;
  double t73, t75, t79, t80, t81, t82, t83, t84;
  double t86, t87, t88, t89, t90, t91, t93, t94;
  double t97, t100, t103, t105, t109, t110, t111, t112;
  double t118, t119, t122, t123, t125, t129, tzk0;

  double t130, t131, t132, t133, t134, t137, t138, t142;
  double t143, t144, t147, t149, t151, t152, t153, t154;
  double t155, t157, t162, t164, t168, t171, t172, t174;
  double t175, t176, t180, t183, t184, t186, t187, t190;
  double t191, t192, t193, t194, t197, t199, t204, t206;
  double t209, t210, t214, t217, t219, tvrho0, t222, t223;
  double t226, t227, t232, t234, t237, t238, t242, t243;
  double t244, t245, t247, t252, t254, t258, t261, t262;
  double t264, t265, t266, t270, t273, t277, t278, t279;
  double t280, t281, t284, t286, t291, tvrho1, t294, t296;
  double t297, t298, t305, t308, t309, t312, t316, t317;
  double t320, t322, t326, tvsigma0, tvsigma1, t327, t329, t330;
  double t331, t338, t341, t342, t345, t349, t352, t354;
  double t358, tvsigma2;

  double t361, t362, t363, t366, t367, t368, t370, t371;
  double t375, t376, t380, t382, t388, t389, t392, t394;
  double t396, t398, t403, t404, t405, t406, t407, t408;
  double t409, t410, t411, t417, t421, t422, t423, t425;
  double t428, t429, t431, t435, t436, t437, t443, t447;
  double t450, t451, t453, t455, t456, t460, t462, t467;
  double t468, t469, t470, t474, t478, t479, t483, t485;
  double t487, t490, t492, tv2rho20, t495, t498, t499, t503;
  double t504, t508, t510, t518, t519, t522, t526, t527;
  double t531, t533, t540, t543, tv2rho21, t548, t552, t553;
  double t557, t558, t564, t565, t569, t573, t574, t583;
  double t585, t590, t591, t592, t593, t599, t603, t604;
  double t606, t609, t610, t612, t616, t617, t618, t624;
  double t628, t631, t634, t635, t639, t641, t646, tv2rho22;
  double t654, t655, t659, t660, t668, t671, t672, t674;
  double t677, t684, t685, t687, t690, t692, t697, tv2rhosigma0;
  double tv2rhosigma1, t704, t706, tv2rhosigma2, t712, tv2rhosigma3, tv2rhosigma4, t717;
  double t721, t722, t730, t733, t734, t736, t739, t746;
  double t748, t751, t753, t758, tv2rhosigma5, t760, t768, t771;
  double t774, t775, t779, t784, t787, t789, t793, t796;
  double t798, t802, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t803;
  double t811, t814, t817, t818, t822, t827, t830, t832;
  double t836, t839, t841, t845, tv2sigma25;

  gga_x_pw91_params *params;

  assert(p->params != NULL);
  params = (gga_x_pw91_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->alpha * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t33 * sigma[0];
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = t34 * t39;
  t43 = exp(-t29 * t40 / 0.24e2);
  t46 = (params->d * t43 + params->c) * t28;
  t49 = t28 * t28;
  t50 = 0.1e1 / t31;
  t51 = t49 * t50;
  t52 = sqrt(sigma[0]);
  t54 = 0.1e1 / t36 / rho[0];
  t58 = pow(t51 * t52 * t54 / 0.12e2, params->expo);
  t59 = params->f * t58;
  t60 = t46 * t40 / 0.24e2 - t59;
  t61 = t51 * t52;
  t63 = params->b * t49;
  t68 = log(t63 * t50 * t52 * t54 / 0.12e2 + sqrt(POW_2(t63 * t50 * t52 * t54 / 0.12e2) + 0.1e1));
  t69 = t54 * params->a * t68;
  t72 = 0.1e1 + t61 * t69 / 0.12e2 + t59;
  t73 = 0.1e1 / t72;
  t75 = t60 * t73 + 0.1e1;
  t79 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t75);
  t80 = rho[1] <= p->dens_threshold;
  t81 = my_piecewise5(t14, t11, t10, t15, -t17);
  t82 = 0.1e1 + t81;
  t83 = t82 <= p->zeta_threshold;
  t84 = POW_1_3(t82);
  t86 = my_piecewise3(t83, t22, t84 * t82);
  t87 = t86 * t26;
  t88 = t33 * sigma[2];
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t93 = 0.1e1 / t91 / t89;
  t94 = t88 * t93;
  t97 = exp(-t29 * t94 / 0.24e2);
  t100 = (params->d * t97 + params->c) * t28;
  t103 = sqrt(sigma[2]);
  t105 = 0.1e1 / t90 / rho[1];
  t109 = pow(t51 * t103 * t105 / 0.12e2, params->expo);
  t110 = params->f * t109;
  t111 = t100 * t94 / 0.24e2 - t110;
  t112 = t51 * t103;
  t118 = log(t63 * t50 * t103 * t105 / 0.12e2 + sqrt(POW_2(t63 * t50 * t103 * t105 / 0.12e2) + 0.1e1));
  t119 = t105 * params->a * t118;
  t122 = 0.1e1 + t112 * t119 / 0.12e2 + t110;
  t123 = 0.1e1 / t122;
  t125 = t111 * t123 + 0.1e1;
  t129 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t125);
  tzk0 = t79 + t129;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t130 = t6 * t6;
  t131 = 0.1e1 / t130;
  t132 = t16 * t131;
  t133 = t7 - t132;
  t134 = my_piecewise5(t10, 0, t14, 0, t133);
  t137 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t134);
  t138 = t137 * t26;
  t142 = t26 * t26;
  t143 = 0.1e1 / t142;
  t144 = t25 * t143;
  t147 = t5 * t144 * t75 / 0.8e1;
  t149 = params->d * params->alpha * t49;
  t151 = 0.1e1 / t31 / t30;
  t152 = sigma[0] * sigma[0];
  t153 = t151 * t152;
  t154 = t35 * t35;
  t155 = t154 * t35;
  t157 = 0.1e1 / t36 / t155;
  t162 = t35 * rho[0];
  t164 = 0.1e1 / t37 / t162;
  t168 = 0.1e1 / rho[0];
  t171 = 0.4e1 / 0.3e1 * t59 * params->expo * t168;
  t172 = t149 * t153 * t157 * t43 / 0.216e3 - t46 * t34 * t164 / 0.9e1 + t171;
  t174 = t72 * t72;
  t175 = 0.1e1 / t174;
  t176 = t60 * t175;
  t180 = 0.1e1 / t36 / t35 * params->a * t68;
  t183 = t28 * t33;
  t184 = t183 * sigma[0];
  t186 = params->b * params->b;
  t187 = t186 * t28;
  t190 = 0.6e1 * t187 * t40 + 0.144e3;
  t191 = sqrt(t190);
  t192 = 0.1e1 / t191;
  t193 = params->b * t192;
  t194 = t164 * params->a * t193;
  t197 = -t61 * t180 / 0.9e1 - 0.2e1 / 0.3e1 * t184 * t194 - t171;
  t199 = t172 * t73 - t176 * t197;
  t204 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t75 - t147 - 0.3e1 / 0.8e1 * t5 * t27 * t199);
  t206 = my_piecewise5(t14, 0, t10, 0, -t133);
  t209 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t206);
  t210 = t209 * t26;
  t214 = t86 * t143;
  t217 = t5 * t214 * t125 / 0.8e1;
  t219 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t210 * t125 - t217);
  tvrho0 = t79 + t129 + t6 * (t204 + t219);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t222 = -t7 - t132;
  t223 = my_piecewise5(t10, 0, t14, 0, t222);
  t226 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t223);
  t227 = t226 * t26;
  t232 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t227 * t75 - t147);
  t234 = my_piecewise5(t14, 0, t10, 0, -t222);
  t237 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t234);
  t238 = t237 * t26;
  t242 = sigma[2] * sigma[2];
  t243 = t151 * t242;
  t244 = t89 * t89;
  t245 = t244 * t89;
  t247 = 0.1e1 / t90 / t245;
  t252 = t89 * rho[1];
  t254 = 0.1e1 / t91 / t252;
  t258 = 0.1e1 / rho[1];
  t261 = 0.4e1 / 0.3e1 * t110 * params->expo * t258;
  t262 = t149 * t243 * t247 * t97 / 0.216e3 - t100 * t88 * t254 / 0.9e1 + t261;
  t264 = t122 * t122;
  t265 = 0.1e1 / t264;
  t266 = t111 * t265;
  t270 = 0.1e1 / t90 / t89 * params->a * t118;
  t273 = t183 * sigma[2];
  t277 = 0.6e1 * t187 * t94 + 0.144e3;
  t278 = sqrt(t277);
  t279 = 0.1e1 / t278;
  t280 = params->b * t279;
  t281 = t254 * params->a * t280;
  t284 = -t112 * t270 / 0.9e1 - 0.2e1 / 0.3e1 * t273 * t281 - t261;
  t286 = t262 * t123 - t266 * t284;
  t291 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t238 * t125 - t217 - 0.3e1 / 0.8e1 * t5 * t87 * t286);
  tvrho1 = t79 + t129 + t6 * (t232 + t291);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t294 = t154 * rho[0];
  t296 = 0.1e1 / t36 / t294;
  t297 = t151 * t296;
  t298 = t43 * sigma[0];
  t305 = 0.1e1 / sigma[0];
  t308 = t59 * params->expo * t305 / 0.2e1;
  t309 = -t149 * t297 * t298 / 0.576e3 + t46 * t33 * t39 / 0.24e2 - t308;
  t312 = t51 / t52;
  t316 = params->a * params->b;
  t317 = t316 * t192;
  t320 = t312 * t69 / 0.24e2 + t183 * t39 * t317 / 0.4e1 + t308;
  t322 = -t176 * t320 + t309 * t73;
  t326 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t322);
  tvsigma0 = t6 * t326;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t327 = t244 * rho[1];
  t329 = 0.1e1 / t90 / t327;
  t330 = t151 * t329;
  t331 = t97 * sigma[2];
  t338 = 0.1e1 / sigma[2];
  t341 = t110 * params->expo * t338 / 0.2e1;
  t342 = -t149 * t330 * t331 / 0.576e3 + t100 * t33 * t93 / 0.24e2 - t341;
  t345 = t51 / t103;
  t349 = t316 * t279;
  t352 = t345 * t119 / 0.24e2 + t183 * t93 * t349 / 0.4e1 + t341;
  t354 = t342 * t123 - t266 * t352;
  t358 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t354);
  tvsigma2 = t6 * t358;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t361 = t23 * t23;
  t362 = 0.1e1 / t361;
  t363 = t134 * t134;
  t366 = t130 * t6;
  t367 = 0.1e1 / t366;
  t368 = t16 * t367;
  t370 = -0.2e1 * t131 + 0.2e1 * t368;
  t371 = my_piecewise5(t10, 0, t14, 0, t370);
  t375 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t362 * t363 + 0.4e1 / 0.3e1 * t23 * t371);
  t376 = t375 * t26;
  t380 = t137 * t143;
  t382 = t5 * t380 * t75;
  t388 = 0.1e1 / t142 / t6;
  t389 = t25 * t388;
  t392 = t5 * t389 * t75 / 0.12e2;
  t394 = t5 * t144 * t199;
  t396 = t154 * t162;
  t398 = 0.1e1 / t36 / t396;
  t403 = params->alpha * params->alpha;
  t404 = params->d * t403;
  t405 = t30 * t30;
  t406 = 0.1e1 / t405;
  t407 = t404 * t406;
  t408 = t152 * sigma[0];
  t409 = t154 * t154;
  t410 = t409 * t35;
  t411 = 0.1e1 / t410;
  t417 = 0.1e1 / t37 / t154;
  t421 = params->expo * params->expo;
  t422 = 0.1e1 / t35;
  t423 = t421 * t422;
  t425 = 0.16e2 / 0.9e1 * t59 * t423;
  t428 = 0.4e1 / 0.3e1 * t59 * params->expo * t422;
  t429 = -t149 * t153 * t398 * t43 / 0.24e2 + t407 * t408 * t411 * t43 / 0.324e3 + 0.11e2 / 0.27e2 * t46 * t34 * t417 - t425 - t428;
  t431 = t172 * t175;
  t435 = 0.1e1 / t174 / t72;
  t436 = t60 * t435;
  t437 = t197 * t197;
  t443 = 0.1e1 / t36 / t162 * params->a * t68;
  t447 = t417 * params->a * t193;
  t450 = t49 * t151;
  t451 = t450 * t152;
  t453 = t186 * params->b;
  t455 = 0.1e1 / t191 / t190;
  t456 = t453 * t455;
  t460 = 0.7e1 / 0.27e2 * t61 * t443 + 0.1e2 / 0.3e1 * t184 * t447 - 0.16e2 / 0.3e1 * t451 * t398 * params->a * t456 + t425 + t428;
  t462 = -t176 * t460 - 0.2e1 * t431 * t197 + t429 * t73 + 0.2e1 * t436 * t437;
  t467 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t376 * t75 - t382 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t199 + t392 - t394 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t462);
  t468 = t84 * t84;
  t469 = 0.1e1 / t468;
  t470 = t206 * t206;
  t474 = my_piecewise5(t14, 0, t10, 0, -t370);
  t478 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t469 * t470 + 0.4e1 / 0.3e1 * t84 * t474);
  t479 = t478 * t26;
  t483 = t209 * t143;
  t485 = t5 * t483 * t125;
  t487 = t86 * t388;
  t490 = t5 * t487 * t125 / 0.12e2;
  t492 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t479 * t125 - t485 / 0.4e1 + t490);
  tv2rho20 = 0.2e1 * t204 + 0.2e1 * t219 + t6 * (t467 + t492);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t495 = t362 * t223;
  t498 = 0.2e1 * t368;
  t499 = my_piecewise5(t10, 0, t14, 0, t498);
  t503 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t495 * t134 + 0.4e1 / 0.3e1 * t23 * t499);
  t504 = t503 * t26;
  t508 = t226 * t143;
  t510 = t5 * t508 * t75;
  t518 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t504 * t75 - t510 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t227 * t199 - t382 / 0.8e1 + t392 - t394 / 0.8e1);
  t519 = t469 * t234;
  t522 = my_piecewise5(t14, 0, t10, 0, -t498);
  t526 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t519 * t206 + 0.4e1 / 0.3e1 * t84 * t522);
  t527 = t526 * t26;
  t531 = t237 * t143;
  t533 = t5 * t531 * t125;
  t540 = t5 * t214 * t286;
  t543 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t527 * t125 - t533 / 0.8e1 - t485 / 0.8e1 + t490 - 0.3e1 / 0.8e1 * t5 * t210 * t286 - t540 / 0.8e1);
  tv2rho21 = t204 + t219 + t232 + t291 + t6 * (t518 + t543);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t548 = t223 * t223;
  t552 = 0.2e1 * t131 + 0.2e1 * t368;
  t553 = my_piecewise5(t10, 0, t14, 0, t552);
  t557 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t362 * t548 + 0.4e1 / 0.3e1 * t23 * t553);
  t558 = t557 * t26;
  t564 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t558 * t75 - t510 / 0.4e1 + t392);
  t565 = t234 * t234;
  t569 = my_piecewise5(t14, 0, t10, 0, -t552);
  t573 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t469 * t565 + 0.4e1 / 0.3e1 * t84 * t569);
  t574 = t573 * t26;
  t583 = t244 * t252;
  t585 = 0.1e1 / t90 / t583;
  t590 = t242 * sigma[2];
  t591 = t244 * t244;
  t592 = t591 * t89;
  t593 = 0.1e1 / t592;
  t599 = 0.1e1 / t91 / t244;
  t603 = 0.1e1 / t89;
  t604 = t421 * t603;
  t606 = 0.16e2 / 0.9e1 * t110 * t604;
  t609 = 0.4e1 / 0.3e1 * t110 * params->expo * t603;
  t610 = -t149 * t243 * t585 * t97 / 0.24e2 + t407 * t590 * t593 * t97 / 0.324e3 + 0.11e2 / 0.27e2 * t100 * t88 * t599 - t606 - t609;
  t612 = t262 * t265;
  t616 = 0.1e1 / t264 / t122;
  t617 = t111 * t616;
  t618 = t284 * t284;
  t624 = 0.1e1 / t90 / t252 * params->a * t118;
  t628 = t599 * params->a * t280;
  t631 = t450 * t242;
  t634 = 0.1e1 / t278 / t277;
  t635 = t453 * t634;
  t639 = 0.7e1 / 0.27e2 * t112 * t624 + 0.1e2 / 0.3e1 * t273 * t628 - 0.16e2 / 0.3e1 * t631 * t585 * params->a * t635 + t606 + t609;
  t641 = t610 * t123 - t266 * t639 - 0.2e1 * t612 * t284 + 0.2e1 * t617 * t618;
  t646 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t574 * t125 - t533 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t238 * t286 + t490 - t540 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * t641);
  tv2rho22 = 0.2e1 * t232 + 0.2e1 * t291 + t6 * (t564 + t646);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t654 = t5 * t144 * t322 / 0.8e1;
  t655 = t151 * t157;
  t659 = t409 * rho[0];
  t660 = 0.1e1 / t659;
  t668 = t421 * t168;
  t671 = 0.2e1 / 0.3e1 * t59 * t668 * t305;
  t672 = t149 * t655 * t298 / 0.72e2 - t407 * t660 * t152 * t43 / 0.864e3 - t46 * t33 * t164 / 0.9e1 + t671;
  t674 = t309 * t175;
  t677 = t320 * t197;
  t684 = t450 * t157;
  t685 = params->a * t453;
  t687 = t685 * t455 * sigma[0];
  t690 = -t312 * t180 / 0.18e2 - t183 * t164 * t317 + 0.2e1 * t684 * t687 - t671;
  t692 = -t176 * t690 - t674 * t197 - t431 * t320 + 0.2e1 * t436 * t677 + t672 * t73;
  t697 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t322 - t654 - 0.3e1 / 0.8e1 * t5 * t27 * t692);
  tv2rhosigma0 = t6 * t697 + t326;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t704 = t5 * t214 * t354 / 0.8e1;
  t706 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t210 * t354 - t704);
  tv2rhosigma2 = t6 * t706 + t358;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t712 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t227 * t322 - t654);
  tv2rhosigma3 = t6 * t712 + t326;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t717 = t151 * t247;
  t721 = t591 * rho[1];
  t722 = 0.1e1 / t721;
  t730 = t421 * t258;
  t733 = 0.2e1 / 0.3e1 * t110 * t730 * t338;
  t734 = t149 * t717 * t331 / 0.72e2 - t407 * t722 * t242 * t97 / 0.864e3 - t100 * t33 * t254 / 0.9e1 + t733;
  t736 = t342 * t265;
  t739 = t352 * t284;
  t746 = t450 * t247;
  t748 = t685 * t634 * sigma[2];
  t751 = -t345 * t270 / 0.18e2 - t183 * t254 * t349 + 0.2e1 * t746 * t748 - t733;
  t753 = t734 * t123 - t266 * t751 - t736 * t284 - t612 * t352 + 0.2e1 * t617 * t739;
  t758 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t238 * t354 - t704 - 0.3e1 / 0.8e1 * t5 * t87 * t753);
  tv2rhosigma5 = t6 * t758 + t358;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t760 = 0.1e1 / t409;
  t768 = 0.1e1 / t152;
  t771 = t59 * t421 * t768 / 0.4e1;
  t774 = t59 * params->expo * t768 / 0.2e1;
  t775 = t407 * t760 * t43 * sigma[0] / 0.2304e4 - t149 * t297 * t43 / 0.288e3 - t771 + t774;
  t779 = t320 * t320;
  t784 = t51 / t52 / sigma[0];
  t787 = t183 * t305;
  t789 = t39 * params->a * t193;
  t793 = t685 * t455;
  t796 = -t784 * t69 / 0.48e2 + t787 * t789 / 0.8e1 - 0.3e1 / 0.4e1 * t450 * t296 * t793 + t771 - t774;
  t798 = -t176 * t796 - 0.2e1 * t674 * t320 + 0.2e1 * t436 * t779 + t775 * t73;
  t802 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t798);
  tv2sigma20 = t6 * t802;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t803 = 0.1e1 / t591;
  t811 = 0.1e1 / t242;
  t814 = t110 * t421 * t811 / 0.4e1;
  t817 = t110 * params->expo * t811 / 0.2e1;
  t818 = t407 * t803 * t97 * sigma[2] / 0.2304e4 - t149 * t330 * t97 / 0.288e3 - t814 + t817;
  t822 = t352 * t352;
  t827 = t51 / t103 / sigma[2];
  t830 = t183 * t338;
  t832 = t93 * params->a * t280;
  t836 = t685 * t634;
  t839 = -t827 * t119 / 0.48e2 + t830 * t832 / 0.8e1 - 0.3e1 / 0.4e1 * t450 * t329 * t836 + t814 - t817;
  t841 = t818 * t123 - t266 * t839 - 0.2e1 * t736 * t352 + 0.2e1 * t617 * t822;
  t845 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t841);
  tv2sigma25 = t6 * t845;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t40, t43, t46, t49, t50, t51, t52, t54;
  double t58, t59, t60, t61, t63, t68, t69, t72;
  double t73, t75, t79, t80, t81, t82, t83, t84;
  double t86, t87, t88, t89, t90, t91, t93, t94;
  double t97, t100, t103, t105, t109, t110, t111, t112;
  double t118, t119, t122, t123, t125, t129, tzk0;

  double t130, t131, t132, t133, t134, t137, t138, t142;
  double t143, t144, t147, t149, t151, t152, t153, t154;
  double t155, t157, t162, t164, t168, t171, t172, t174;
  double t175, t176, t180, t183, t184, t186, t187, t190;
  double t191, t192, t193, t194, t197, t199, t204, t206;
  double t209, t210, t214, t217, t219, tvrho0, t222, t223;
  double t226, t227, t232, t234, t237, t238, t242, t243;
  double t244, t245, t247, t252, t254, t258, t261, t262;
  double t264, t265, t266, t270, t273, t277, t278, t279;
  double t280, t281, t284, t286, t291, tvrho1, t294, t296;
  double t297, t298, t305, t308, t309, t312, t316, t317;
  double t320, t322, t326, tvsigma0, tvsigma1, t327, t329, t330;
  double t331, t338, t341, t342, t345, t349, t352, t354;
  double t358, tvsigma2;

  double t361, t362, t363, t366, t367, t368, t370, t371;
  double t375, t376, t380, t382, t388, t389, t392, t394;
  double t396, t398, t403, t404, t405, t406, t407, t408;
  double t409, t410, t411, t417, t421, t422, t423, t425;
  double t428, t429, t431, t435, t436, t437, t443, t447;
  double t450, t451, t453, t455, t456, t460, t462, t467;
  double t468, t469, t470, t474, t478, t479, t483, t485;
  double t487, t490, t492, tv2rho20, t495, t498, t499, t503;
  double t504, t508, t510, t518, t519, t522, t526, t527;
  double t531, t533, t540, t543, tv2rho21, t548, t552, t553;
  double t557, t558, t564, t565, t569, t573, t574, t583;
  double t585, t590, t591, t592, t593, t599, t603, t604;
  double t606, t609, t610, t612, t616, t617, t618, t624;
  double t628, t631, t634, t635, t639, t641, t646, tv2rho22;
  double t654, t655, t659, t660, t668, t671, t672, t674;
  double t677, t684, t685, t687, t690, t692, t697, tv2rhosigma0;
  double tv2rhosigma1, t704, t706, tv2rhosigma2, t712, tv2rhosigma3, tv2rhosigma4, t717;
  double t721, t722, t730, t733, t734, t736, t739, t746;
  double t748, t751, t753, t758, tv2rhosigma5, t760, t768, t771;
  double t774, t775, t779, t784, t787, t789, t793, t796;
  double t798, t802, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t803;
  double t811, t814, t817, t818, t822, t827, t830, t832;
  double t836, t839, t841, t845, tv2sigma25;

  double t849, t850, t853, t856, t857, t858, t860, t861;
  double t865, t866, t870, t872, t877, t879, t882, t888;
  double t889, t892, t894, t897, t900, t905, t906, t912;
  double t913, t914, t915, t916, t918, t920, t925, t929;
  double t930, t931, t933, t934, t936, t939, t940, t942;
  double t945, t950, t951, t952, t953, t956, t962, t973;
  double t975, t976, t977, t978, t980, t981, t984, t986;
  double t991, t993, t994, t997, t1001, t1005, t1006, t1010;
  double t1012, t1014, t1016, t1018, t1021, t1023, tv3rho30, t1026;
  double t1027, t1028, t1031, t1036, t1037, t1038, t1039, t1043;
  double t1044, t1048, t1051, t1055, t1057, t1061, t1070, t1071;
  double t1072, t1075, t1081, t1085, t1086, t1090, t1093, t1094;
  double t1096, t1105, t1107, t1110, tv3rho31, t1113, t1118, t1121;
  double t1122, t1126, t1127, t1131, t1133, t1142, t1143, t1148;
  double t1152, t1156, t1157, t1161, t1163, t1170, t1178, t1180;
  double t1181, tv3rho32, t1186, t1192, t1193, t1197, t1198, t1205;
  double t1206, t1212, t1216, t1217, t1233, t1238, t1239, t1244;
  double t1245, t1246, t1247, t1249, t1251, t1256, t1260, t1261;
  double t1263, t1264, t1266, t1269, t1270, t1272, t1275, t1280;
  double t1281, t1282, t1283, t1286, t1292, t1303, t1305, t1307;
  double t1308, t1311, t1313, t1318, tv3rho33, t1326, t1333, t1335;
  double t1337, t1345, t1348, t1349, t1351, t1357, t1360, t1363;
  double t1364, t1366, t1369, t1378, t1381, t1384, t1392, t1396;
  double t1397, t1398, t1401, t1403, t1408, tv3rho2sigma0, tv3rho2sigma1, t1415;
  double t1419, t1421, tv3rho2sigma2, t1427, t1435, tv3rho2sigma3, tv3rho2sigma4, t1441;
  double t1448, t1451, tv3rho2sigma5, t1459, tv3rho2sigma6, tv3rho2sigma7, t1470, t1478;
  double t1481, t1482, t1484, t1490, t1493, t1496, t1497, t1499;
  double t1502, t1511, t1514, t1517, t1525, t1529, t1530, t1531;
  double t1534, t1536, t1541, tv3rho2sigma8, t1548, t1555, t1556, t1557;
  double t1558, t1564, t1567, t1570, t1571, t1573, t1583, t1586;
  double t1590, t1599, t1601, t1604, t1606, t1611, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1618, t1620, tv3rhosigma25, t1626, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1637, t1638, t1639, t1640;
  double t1646, t1649, t1652, t1653, t1655, t1665, t1668, t1672;
  double t1681, t1683, t1686, t1688, t1693, tv3rhosigma211, t1696, t1697;
  double t1699, t1702, t1706, t1709, t1712, t1714, t1715, t1723;
  double t1726, t1731, t1734, t1737, t1738, t1739, t1744, t1746;
  double t1750, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t1752, t1753, t1755, t1758, t1762, t1765;
  double t1768, t1770, t1771, t1779, t1782, t1787, t1790, t1793;
  double t1794, t1795, t1800, t1802, t1806, tv3sigma39;

  gga_x_pw91_params *params;

  assert(p->params != NULL);
  params = (gga_x_pw91_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->alpha * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t33 * sigma[0];
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = t34 * t39;
  t43 = exp(-t29 * t40 / 0.24e2);
  t46 = (params->d * t43 + params->c) * t28;
  t49 = t28 * t28;
  t50 = 0.1e1 / t31;
  t51 = t49 * t50;
  t52 = sqrt(sigma[0]);
  t54 = 0.1e1 / t36 / rho[0];
  t58 = pow(t51 * t52 * t54 / 0.12e2, params->expo);
  t59 = params->f * t58;
  t60 = t46 * t40 / 0.24e2 - t59;
  t61 = t51 * t52;
  t63 = params->b * t49;
  t68 = log(t63 * t50 * t52 * t54 / 0.12e2 + sqrt(POW_2(t63 * t50 * t52 * t54 / 0.12e2) + 0.1e1));
  t69 = t54 * params->a * t68;
  t72 = 0.1e1 + t61 * t69 / 0.12e2 + t59;
  t73 = 0.1e1 / t72;
  t75 = t60 * t73 + 0.1e1;
  t79 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t75);
  t80 = rho[1] <= p->dens_threshold;
  t81 = my_piecewise5(t14, t11, t10, t15, -t17);
  t82 = 0.1e1 + t81;
  t83 = t82 <= p->zeta_threshold;
  t84 = POW_1_3(t82);
  t86 = my_piecewise3(t83, t22, t84 * t82);
  t87 = t86 * t26;
  t88 = t33 * sigma[2];
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t93 = 0.1e1 / t91 / t89;
  t94 = t88 * t93;
  t97 = exp(-t29 * t94 / 0.24e2);
  t100 = (params->d * t97 + params->c) * t28;
  t103 = sqrt(sigma[2]);
  t105 = 0.1e1 / t90 / rho[1];
  t109 = pow(t51 * t103 * t105 / 0.12e2, params->expo);
  t110 = params->f * t109;
  t111 = t100 * t94 / 0.24e2 - t110;
  t112 = t51 * t103;
  t118 = log(t63 * t50 * t103 * t105 / 0.12e2 + sqrt(POW_2(t63 * t50 * t103 * t105 / 0.12e2) + 0.1e1));
  t119 = t105 * params->a * t118;
  t122 = 0.1e1 + t112 * t119 / 0.12e2 + t110;
  t123 = 0.1e1 / t122;
  t125 = t111 * t123 + 0.1e1;
  t129 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t125);
  tzk0 = t79 + t129;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t130 = t6 * t6;
  t131 = 0.1e1 / t130;
  t132 = t16 * t131;
  t133 = t7 - t132;
  t134 = my_piecewise5(t10, 0, t14, 0, t133);
  t137 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t134);
  t138 = t137 * t26;
  t142 = t26 * t26;
  t143 = 0.1e1 / t142;
  t144 = t25 * t143;
  t147 = t5 * t144 * t75 / 0.8e1;
  t149 = params->d * params->alpha * t49;
  t151 = 0.1e1 / t31 / t30;
  t152 = sigma[0] * sigma[0];
  t153 = t151 * t152;
  t154 = t35 * t35;
  t155 = t154 * t35;
  t157 = 0.1e1 / t36 / t155;
  t162 = t35 * rho[0];
  t164 = 0.1e1 / t37 / t162;
  t168 = 0.1e1 / rho[0];
  t171 = 0.4e1 / 0.3e1 * t59 * params->expo * t168;
  t172 = t149 * t153 * t157 * t43 / 0.216e3 - t46 * t34 * t164 / 0.9e1 + t171;
  t174 = t72 * t72;
  t175 = 0.1e1 / t174;
  t176 = t60 * t175;
  t180 = 0.1e1 / t36 / t35 * params->a * t68;
  t183 = t28 * t33;
  t184 = t183 * sigma[0];
  t186 = params->b * params->b;
  t187 = t186 * t28;
  t190 = 0.6e1 * t187 * t40 + 0.144e3;
  t191 = sqrt(t190);
  t192 = 0.1e1 / t191;
  t193 = params->b * t192;
  t194 = t164 * params->a * t193;
  t197 = -t61 * t180 / 0.9e1 - 0.2e1 / 0.3e1 * t184 * t194 - t171;
  t199 = t172 * t73 - t176 * t197;
  t204 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t75 - t147 - 0.3e1 / 0.8e1 * t5 * t27 * t199);
  t206 = my_piecewise5(t14, 0, t10, 0, -t133);
  t209 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t206);
  t210 = t209 * t26;
  t214 = t86 * t143;
  t217 = t5 * t214 * t125 / 0.8e1;
  t219 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t210 * t125 - t217);
  tvrho0 = t79 + t129 + t6 * (t204 + t219);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t222 = -t7 - t132;
  t223 = my_piecewise5(t10, 0, t14, 0, t222);
  t226 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t223);
  t227 = t226 * t26;
  t232 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t227 * t75 - t147);
  t234 = my_piecewise5(t14, 0, t10, 0, -t222);
  t237 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t234);
  t238 = t237 * t26;
  t242 = sigma[2] * sigma[2];
  t243 = t151 * t242;
  t244 = t89 * t89;
  t245 = t244 * t89;
  t247 = 0.1e1 / t90 / t245;
  t252 = t89 * rho[1];
  t254 = 0.1e1 / t91 / t252;
  t258 = 0.1e1 / rho[1];
  t261 = 0.4e1 / 0.3e1 * t110 * params->expo * t258;
  t262 = t149 * t243 * t247 * t97 / 0.216e3 - t100 * t88 * t254 / 0.9e1 + t261;
  t264 = t122 * t122;
  t265 = 0.1e1 / t264;
  t266 = t111 * t265;
  t270 = 0.1e1 / t90 / t89 * params->a * t118;
  t273 = t183 * sigma[2];
  t277 = 0.6e1 * t187 * t94 + 0.144e3;
  t278 = sqrt(t277);
  t279 = 0.1e1 / t278;
  t280 = params->b * t279;
  t281 = t254 * params->a * t280;
  t284 = -t112 * t270 / 0.9e1 - 0.2e1 / 0.3e1 * t273 * t281 - t261;
  t286 = t262 * t123 - t266 * t284;
  t291 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t238 * t125 - t217 - 0.3e1 / 0.8e1 * t5 * t87 * t286);
  tvrho1 = t79 + t129 + t6 * (t232 + t291);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t294 = t154 * rho[0];
  t296 = 0.1e1 / t36 / t294;
  t297 = t151 * t296;
  t298 = t43 * sigma[0];
  t305 = 0.1e1 / sigma[0];
  t308 = t59 * params->expo * t305 / 0.2e1;
  t309 = -t149 * t297 * t298 / 0.576e3 + t46 * t33 * t39 / 0.24e2 - t308;
  t312 = t51 / t52;
  t316 = params->a * params->b;
  t317 = t316 * t192;
  t320 = t312 * t69 / 0.24e2 + t183 * t39 * t317 / 0.4e1 + t308;
  t322 = -t176 * t320 + t309 * t73;
  t326 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t322);
  tvsigma0 = t6 * t326;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t327 = t244 * rho[1];
  t329 = 0.1e1 / t90 / t327;
  t330 = t151 * t329;
  t331 = t97 * sigma[2];
  t338 = 0.1e1 / sigma[2];
  t341 = t110 * params->expo * t338 / 0.2e1;
  t342 = -t149 * t330 * t331 / 0.576e3 + t100 * t33 * t93 / 0.24e2 - t341;
  t345 = t51 / t103;
  t349 = t316 * t279;
  t352 = t345 * t119 / 0.24e2 + t183 * t93 * t349 / 0.4e1 + t341;
  t354 = t342 * t123 - t266 * t352;
  t358 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t354);
  tvsigma2 = t6 * t358;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t361 = t23 * t23;
  t362 = 0.1e1 / t361;
  t363 = t134 * t134;
  t366 = t130 * t6;
  t367 = 0.1e1 / t366;
  t368 = t16 * t367;
  t370 = -0.2e1 * t131 + 0.2e1 * t368;
  t371 = my_piecewise5(t10, 0, t14, 0, t370);
  t375 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t362 * t363 + 0.4e1 / 0.3e1 * t23 * t371);
  t376 = t375 * t26;
  t380 = t137 * t143;
  t382 = t5 * t380 * t75;
  t388 = 0.1e1 / t142 / t6;
  t389 = t25 * t388;
  t392 = t5 * t389 * t75 / 0.12e2;
  t394 = t5 * t144 * t199;
  t396 = t154 * t162;
  t398 = 0.1e1 / t36 / t396;
  t403 = params->alpha * params->alpha;
  t404 = params->d * t403;
  t405 = t30 * t30;
  t406 = 0.1e1 / t405;
  t407 = t404 * t406;
  t408 = t152 * sigma[0];
  t409 = t154 * t154;
  t410 = t409 * t35;
  t411 = 0.1e1 / t410;
  t417 = 0.1e1 / t37 / t154;
  t421 = params->expo * params->expo;
  t422 = 0.1e1 / t35;
  t423 = t421 * t422;
  t425 = 0.16e2 / 0.9e1 * t59 * t423;
  t428 = 0.4e1 / 0.3e1 * t59 * params->expo * t422;
  t429 = -t149 * t153 * t398 * t43 / 0.24e2 + t407 * t408 * t411 * t43 / 0.324e3 + 0.11e2 / 0.27e2 * t46 * t34 * t417 - t425 - t428;
  t431 = t172 * t175;
  t435 = 0.1e1 / t174 / t72;
  t436 = t60 * t435;
  t437 = t197 * t197;
  t443 = 0.1e1 / t36 / t162 * params->a * t68;
  t447 = t417 * params->a * t193;
  t450 = t49 * t151;
  t451 = t450 * t152;
  t453 = t186 * params->b;
  t455 = 0.1e1 / t191 / t190;
  t456 = t453 * t455;
  t460 = 0.7e1 / 0.27e2 * t61 * t443 + 0.1e2 / 0.3e1 * t184 * t447 - 0.16e2 / 0.3e1 * t451 * t398 * params->a * t456 + t425 + t428;
  t462 = -t176 * t460 - 0.2e1 * t431 * t197 + t429 * t73 + 0.2e1 * t436 * t437;
  t467 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t376 * t75 - t382 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t199 + t392 - t394 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t462);
  t468 = t84 * t84;
  t469 = 0.1e1 / t468;
  t470 = t206 * t206;
  t474 = my_piecewise5(t14, 0, t10, 0, -t370);
  t478 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t469 * t470 + 0.4e1 / 0.3e1 * t84 * t474);
  t479 = t478 * t26;
  t483 = t209 * t143;
  t485 = t5 * t483 * t125;
  t487 = t86 * t388;
  t490 = t5 * t487 * t125 / 0.12e2;
  t492 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t479 * t125 - t485 / 0.4e1 + t490);
  tv2rho20 = 0.2e1 * t204 + 0.2e1 * t219 + t6 * (t467 + t492);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t495 = t362 * t223;
  t498 = 0.2e1 * t368;
  t499 = my_piecewise5(t10, 0, t14, 0, t498);
  t503 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t495 * t134 + 0.4e1 / 0.3e1 * t23 * t499);
  t504 = t503 * t26;
  t508 = t226 * t143;
  t510 = t5 * t508 * t75;
  t518 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t504 * t75 - t510 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t227 * t199 - t382 / 0.8e1 + t392 - t394 / 0.8e1);
  t519 = t469 * t234;
  t522 = my_piecewise5(t14, 0, t10, 0, -t498);
  t526 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t519 * t206 + 0.4e1 / 0.3e1 * t84 * t522);
  t527 = t526 * t26;
  t531 = t237 * t143;
  t533 = t5 * t531 * t125;
  t540 = t5 * t214 * t286;
  t543 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t527 * t125 - t533 / 0.8e1 - t485 / 0.8e1 + t490 - 0.3e1 / 0.8e1 * t5 * t210 * t286 - t540 / 0.8e1);
  tv2rho21 = t204 + t219 + t232 + t291 + t6 * (t518 + t543);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t548 = t223 * t223;
  t552 = 0.2e1 * t131 + 0.2e1 * t368;
  t553 = my_piecewise5(t10, 0, t14, 0, t552);
  t557 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t362 * t548 + 0.4e1 / 0.3e1 * t23 * t553);
  t558 = t557 * t26;
  t564 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t558 * t75 - t510 / 0.4e1 + t392);
  t565 = t234 * t234;
  t569 = my_piecewise5(t14, 0, t10, 0, -t552);
  t573 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t469 * t565 + 0.4e1 / 0.3e1 * t84 * t569);
  t574 = t573 * t26;
  t583 = t244 * t252;
  t585 = 0.1e1 / t90 / t583;
  t590 = t242 * sigma[2];
  t591 = t244 * t244;
  t592 = t591 * t89;
  t593 = 0.1e1 / t592;
  t599 = 0.1e1 / t91 / t244;
  t603 = 0.1e1 / t89;
  t604 = t421 * t603;
  t606 = 0.16e2 / 0.9e1 * t110 * t604;
  t609 = 0.4e1 / 0.3e1 * t110 * params->expo * t603;
  t610 = -t149 * t243 * t585 * t97 / 0.24e2 + t407 * t590 * t593 * t97 / 0.324e3 + 0.11e2 / 0.27e2 * t100 * t88 * t599 - t606 - t609;
  t612 = t262 * t265;
  t616 = 0.1e1 / t264 / t122;
  t617 = t111 * t616;
  t618 = t284 * t284;
  t624 = 0.1e1 / t90 / t252 * params->a * t118;
  t628 = t599 * params->a * t280;
  t631 = t450 * t242;
  t634 = 0.1e1 / t278 / t277;
  t635 = t453 * t634;
  t639 = 0.7e1 / 0.27e2 * t112 * t624 + 0.1e2 / 0.3e1 * t273 * t628 - 0.16e2 / 0.3e1 * t631 * t585 * params->a * t635 + t606 + t609;
  t641 = t610 * t123 - t266 * t639 - 0.2e1 * t612 * t284 + 0.2e1 * t617 * t618;
  t646 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t574 * t125 - t533 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t238 * t286 + t490 - t540 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * t641);
  tv2rho22 = 0.2e1 * t232 + 0.2e1 * t291 + t6 * (t564 + t646);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t654 = t5 * t144 * t322 / 0.8e1;
  t655 = t151 * t157;
  t659 = t409 * rho[0];
  t660 = 0.1e1 / t659;
  t668 = t421 * t168;
  t671 = 0.2e1 / 0.3e1 * t59 * t668 * t305;
  t672 = t149 * t655 * t298 / 0.72e2 - t407 * t660 * t152 * t43 / 0.864e3 - t46 * t33 * t164 / 0.9e1 + t671;
  t674 = t309 * t175;
  t677 = t320 * t197;
  t684 = t450 * t157;
  t685 = params->a * t453;
  t687 = t685 * t455 * sigma[0];
  t690 = -t312 * t180 / 0.18e2 - t183 * t164 * t317 + 0.2e1 * t684 * t687 - t671;
  t692 = -t176 * t690 - t674 * t197 - t431 * t320 + 0.2e1 * t436 * t677 + t672 * t73;
  t697 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t322 - t654 - 0.3e1 / 0.8e1 * t5 * t27 * t692);
  tv2rhosigma0 = t6 * t697 + t326;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t704 = t5 * t214 * t354 / 0.8e1;
  t706 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t210 * t354 - t704);
  tv2rhosigma2 = t6 * t706 + t358;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t712 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t227 * t322 - t654);
  tv2rhosigma3 = t6 * t712 + t326;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t717 = t151 * t247;
  t721 = t591 * rho[1];
  t722 = 0.1e1 / t721;
  t730 = t421 * t258;
  t733 = 0.2e1 / 0.3e1 * t110 * t730 * t338;
  t734 = t149 * t717 * t331 / 0.72e2 - t407 * t722 * t242 * t97 / 0.864e3 - t100 * t33 * t254 / 0.9e1 + t733;
  t736 = t342 * t265;
  t739 = t352 * t284;
  t746 = t450 * t247;
  t748 = t685 * t634 * sigma[2];
  t751 = -t345 * t270 / 0.18e2 - t183 * t254 * t349 + 0.2e1 * t746 * t748 - t733;
  t753 = t734 * t123 - t266 * t751 - t736 * t284 - t612 * t352 + 0.2e1 * t617 * t739;
  t758 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t238 * t354 - t704 - 0.3e1 / 0.8e1 * t5 * t87 * t753);
  tv2rhosigma5 = t6 * t758 + t358;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t760 = 0.1e1 / t409;
  t768 = 0.1e1 / t152;
  t771 = t59 * t421 * t768 / 0.4e1;
  t774 = t59 * params->expo * t768 / 0.2e1;
  t775 = t407 * t760 * t43 * sigma[0] / 0.2304e4 - t149 * t297 * t43 / 0.288e3 - t771 + t774;
  t779 = t320 * t320;
  t784 = t51 / t52 / sigma[0];
  t787 = t183 * t305;
  t789 = t39 * params->a * t193;
  t793 = t685 * t455;
  t796 = -t784 * t69 / 0.48e2 + t787 * t789 / 0.8e1 - 0.3e1 / 0.4e1 * t450 * t296 * t793 + t771 - t774;
  t798 = -t176 * t796 - 0.2e1 * t674 * t320 + 0.2e1 * t436 * t779 + t775 * t73;
  t802 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t798);
  tv2sigma20 = t6 * t802;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t803 = 0.1e1 / t591;
  t811 = 0.1e1 / t242;
  t814 = t110 * t421 * t811 / 0.4e1;
  t817 = t110 * params->expo * t811 / 0.2e1;
  t818 = t407 * t803 * t97 * sigma[2] / 0.2304e4 - t149 * t330 * t97 / 0.288e3 - t814 + t817;
  t822 = t352 * t352;
  t827 = t51 / t103 / sigma[2];
  t830 = t183 * t338;
  t832 = t93 * params->a * t280;
  t836 = t685 * t634;
  t839 = -t827 * t119 / 0.48e2 + t830 * t832 / 0.8e1 - 0.3e1 / 0.4e1 * t450 * t329 * t836 + t814 - t817;
  t841 = t818 * t123 - t266 * t839 - 0.2e1 * t736 * t352 + 0.2e1 * t617 * t822;
  t845 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t841);
  tv2sigma25 = t6 * t845;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t849 = 0.1e1 / t361 / t19;
  t850 = t363 * t134;
  t853 = t362 * t134;
  t856 = t130 * t130;
  t857 = 0.1e1 / t856;
  t858 = t16 * t857;
  t860 = 0.6e1 * t367 - 0.6e1 * t858;
  t861 = my_piecewise5(t10, 0, t14, 0, t860);
  t865 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t849 * t850 + 0.4e1 / 0.3e1 * t853 * t371 + 0.4e1 / 0.3e1 * t23 * t861);
  t866 = t865 * t26;
  t870 = t375 * t143;
  t872 = t5 * t870 * t75;
  t877 = t137 * t388;
  t879 = t5 * t877 * t75;
  t882 = t5 * t380 * t199;
  t888 = 0.1e1 / t142 / t130;
  t889 = t25 * t888;
  t892 = 0.5e1 / 0.36e2 * t5 * t889 * t75;
  t894 = t5 * t389 * t199;
  t897 = t5 * t144 * t462;
  t900 = 0.1e1 / t36 / t409;
  t905 = t409 * t162;
  t906 = 0.1e1 / t905;
  t912 = params->d * t403 * params->alpha;
  t913 = t152 * t152;
  t914 = t406 * t913;
  t915 = t912 * t914;
  t916 = t409 * t294;
  t918 = 0.1e1 / t37 / t916;
  t920 = t33 * t43;
  t925 = 0.1e1 / t37 / t294;
  t929 = t421 * params->expo;
  t930 = 0.1e1 / t162;
  t931 = t929 * t930;
  t933 = 0.64e2 / 0.27e2 * t59 * t931;
  t934 = t421 * t930;
  t936 = 0.16e2 / 0.3e1 * t59 * t934;
  t939 = 0.8e1 / 0.3e1 * t59 * params->expo * t930;
  t940 = 0.341e3 / 0.972e3 * t149 * t153 * t900 * t43 - 0.19e2 / 0.324e3 * t407 * t408 * t906 * t43 + t915 * t918 * t28 * t920 / 0.2916e4 - 0.154e3 / 0.81e2 * t46 * t34 * t925 + t933 + t936 + t939;
  t942 = t429 * t175;
  t945 = t172 * t435;
  t950 = t174 * t174;
  t951 = 0.1e1 / t950;
  t952 = t60 * t951;
  t953 = t437 * t197;
  t956 = t197 * t460;
  t962 = 0.1e1 / t36 / t154 * params->a * t68;
  t973 = t406 * t408;
  t975 = t186 * t186;
  t976 = t975 * params->b;
  t977 = params->a * t976;
  t978 = t190 * t190;
  t980 = 0.1e1 / t191 / t978;
  t981 = t977 * t980;
  t984 = -0.7e2 / 0.81e2 * t61 * t962 - 0.476e3 / 0.27e2 * t184 * t925 * params->a * t193 + 0.592e3 / 0.9e1 * t451 * t900 * params->a * t456 - 0.768e3 * t973 * t906 * t981 - t933 - t936 - t939;
  t986 = -t176 * t984 - 0.3e1 * t942 * t197 - 0.3e1 * t431 * t460 + 0.6e1 * t436 * t956 + 0.6e1 * t945 * t437 + t940 * t73 - 0.6e1 * t952 * t953;
  t991 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t866 * t75 - 0.3e1 / 0.8e1 * t872 - 0.9e1 / 0.8e1 * t5 * t376 * t199 + t879 / 0.4e1 - 0.3e1 / 0.4e1 * t882 - 0.9e1 / 0.8e1 * t5 * t138 * t462 - t892 + t894 / 0.4e1 - 0.3e1 / 0.8e1 * t897 - 0.3e1 / 0.8e1 * t5 * t27 * t986);
  t993 = 0.1e1 / t468 / t82;
  t994 = t470 * t206;
  t997 = t469 * t206;
  t1001 = my_piecewise5(t14, 0, t10, 0, -t860);
  t1005 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t993 * t994 + 0.4e1 / 0.3e1 * t997 * t474 + 0.4e1 / 0.3e1 * t84 * t1001);
  t1006 = t1005 * t26;
  t1010 = t478 * t143;
  t1012 = t5 * t1010 * t125;
  t1014 = t209 * t388;
  t1016 = t5 * t1014 * t125;
  t1018 = t86 * t888;
  t1021 = 0.5e1 / 0.36e2 * t5 * t1018 * t125;
  t1023 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t1006 * t125 - 0.3e1 / 0.8e1 * t1012 + t1016 / 0.4e1 - t1021);
  tv3rho30 = 0.3e1 * t467 + 0.3e1 * t492 + t6 * (t991 + t1023);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1026 = 0.2e1 * t518;
  t1027 = 0.2e1 * t543;
  t1028 = t849 * t223;
  t1031 = t362 * t499;
  t1036 = 0.2e1 * t367;
  t1037 = 0.6e1 * t858;
  t1038 = t1036 - t1037;
  t1039 = my_piecewise5(t10, 0, t14, 0, t1038);
  t1043 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1028 * t363 + 0.8e1 / 0.9e1 * t1031 * t134 + 0.4e1 / 0.9e1 * t495 * t371 + 0.4e1 / 0.3e1 * t23 * t1039);
  t1044 = t1043 * t26;
  t1048 = t503 * t143;
  t1051 = t5 * t1048 * t75 / 0.4e1;
  t1055 = t226 * t388;
  t1057 = t5 * t1055 * t75;
  t1061 = t5 * t508 * t199 / 0.4e1;
  t1070 = -0.3e1 / 0.8e1 * t5 * t1044 * t75 - t1051 - 0.3e1 / 0.4e1 * t5 * t504 * t199 + t1057 / 0.12e2 - t1061 - 0.3e1 / 0.8e1 * t5 * t227 * t462 - t872 / 0.8e1 + t879 / 0.6e1 - t882 / 0.4e1 - t892 + t894 / 0.6e1 - t897 / 0.8e1;
  t1071 = my_piecewise3(t1, 0, t1070);
  t1072 = t993 * t234;
  t1075 = t469 * t522;
  t1081 = my_piecewise5(t14, 0, t10, 0, -t1038);
  t1085 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1072 * t470 + 0.8e1 / 0.9e1 * t1075 * t206 + 0.4e1 / 0.9e1 * t519 * t474 + 0.4e1 / 0.3e1 * t84 * t1081);
  t1086 = t1085 * t26;
  t1090 = t526 * t143;
  t1093 = t5 * t1090 * t125 / 0.4e1;
  t1094 = t237 * t388;
  t1096 = t5 * t1094 * t125;
  t1105 = t5 * t483 * t286 / 0.4e1;
  t1107 = t5 * t487 * t286;
  t1110 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t1086 * t125 - t1093 + t1096 / 0.12e2 - t1012 / 0.8e1 + t1016 / 0.6e1 - t1021 - 0.3e1 / 0.8e1 * t5 * t479 * t286 - t1105 + t1107 / 0.12e2);
  tv3rho31 = t467 + t492 + t1026 + t1027 + t6 * (t1071 + t1110);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1113 = t849 * t548;
  t1118 = t362 * t553;
  t1121 = -t1036 - t1037;
  t1122 = my_piecewise5(t10, 0, t14, 0, t1121);
  t1126 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1113 * t134 + 0.8e1 / 0.9e1 * t495 * t499 + 0.4e1 / 0.9e1 * t1118 * t134 + 0.4e1 / 0.3e1 * t23 * t1122);
  t1127 = t1126 * t26;
  t1131 = t557 * t143;
  t1133 = t5 * t1131 * t75;
  t1142 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1127 * t75 - t1133 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t558 * t199 - t1051 + t1057 / 0.6e1 - t1061 + t879 / 0.12e2 - t892 + t894 / 0.12e2);
  t1143 = t993 * t565;
  t1148 = t469 * t569;
  t1152 = my_piecewise5(t14, 0, t10, 0, -t1121);
  t1156 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1143 * t206 + 0.8e1 / 0.9e1 * t519 * t522 + 0.4e1 / 0.9e1 * t1148 * t206 + 0.4e1 / 0.3e1 * t84 * t1152);
  t1157 = t1156 * t26;
  t1161 = t573 * t143;
  t1163 = t5 * t1161 * t125;
  t1170 = t5 * t531 * t286;
  t1178 = t5 * t214 * t641;
  t1180 = -0.3e1 / 0.8e1 * t5 * t1157 * t125 - t1163 / 0.8e1 - t1093 + t1096 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t527 * t286 - t1170 / 0.4e1 + t1016 / 0.12e2 - t1021 - t1105 + t1107 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t210 * t641 - t1178 / 0.8e1;
  t1181 = my_piecewise3(t80, 0, t1180);
  tv3rho32 = t1026 + t1027 + t564 + t646 + t6 * (t1142 + t1181);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1186 = t548 * t223;
  t1192 = -0.6e1 * t367 - 0.6e1 * t858;
  t1193 = my_piecewise5(t10, 0, t14, 0, t1192);
  t1197 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t849 * t1186 + 0.4e1 / 0.3e1 * t495 * t553 + 0.4e1 / 0.3e1 * t23 * t1193);
  t1198 = t1197 * t26;
  t1205 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1198 * t75 - 0.3e1 / 0.8e1 * t1133 + t1057 / 0.4e1 - t892);
  t1206 = t565 * t234;
  t1212 = my_piecewise5(t14, 0, t10, 0, -t1192);
  t1216 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t993 * t1206 + 0.4e1 / 0.3e1 * t519 * t569 + 0.4e1 / 0.3e1 * t84 * t1212);
  t1217 = t1216 * t26;
  t1233 = 0.1e1 / t90 / t591;
  t1238 = t591 * t252;
  t1239 = 0.1e1 / t1238;
  t1244 = t242 * t242;
  t1245 = t406 * t1244;
  t1246 = t912 * t1245;
  t1247 = t591 * t327;
  t1249 = 0.1e1 / t91 / t1247;
  t1251 = t33 * t97;
  t1256 = 0.1e1 / t91 / t327;
  t1260 = 0.1e1 / t252;
  t1261 = t929 * t1260;
  t1263 = 0.64e2 / 0.27e2 * t110 * t1261;
  t1264 = t421 * t1260;
  t1266 = 0.16e2 / 0.3e1 * t110 * t1264;
  t1269 = 0.8e1 / 0.3e1 * t110 * params->expo * t1260;
  t1270 = 0.341e3 / 0.972e3 * t149 * t243 * t1233 * t97 - 0.19e2 / 0.324e3 * t407 * t590 * t1239 * t97 + t1246 * t1249 * t28 * t1251 / 0.2916e4 - 0.154e3 / 0.81e2 * t100 * t88 * t1256 + t1263 + t1266 + t1269;
  t1272 = t610 * t265;
  t1275 = t262 * t616;
  t1280 = t264 * t264;
  t1281 = 0.1e1 / t1280;
  t1282 = t111 * t1281;
  t1283 = t618 * t284;
  t1286 = t284 * t639;
  t1292 = 0.1e1 / t90 / t244 * params->a * t118;
  t1303 = t406 * t590;
  t1305 = t277 * t277;
  t1307 = 0.1e1 / t278 / t1305;
  t1308 = t977 * t1307;
  t1311 = -0.7e2 / 0.81e2 * t112 * t1292 - 0.476e3 / 0.27e2 * t273 * t1256 * params->a * t280 + 0.592e3 / 0.9e1 * t631 * t1233 * params->a * t635 - 0.768e3 * t1303 * t1239 * t1308 - t1263 - t1266 - t1269;
  t1313 = t1270 * t123 - 0.3e1 * t1272 * t284 + 0.6e1 * t1275 * t618 - 0.6e1 * t1282 * t1283 + 0.6e1 * t617 * t1286 - t266 * t1311 - 0.3e1 * t612 * t639;
  t1318 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t1217 * t125 - 0.3e1 / 0.8e1 * t1163 - 0.9e1 / 0.8e1 * t5 * t574 * t286 + t1096 / 0.4e1 - 0.3e1 / 0.4e1 * t1170 - 0.9e1 / 0.8e1 * t5 * t238 * t641 - t1021 + t1107 / 0.4e1 - 0.3e1 / 0.8e1 * t1178 - 0.3e1 / 0.8e1 * t5 * t87 * t1313);
  tv3rho33 = 0.3e1 * t564 + 0.3e1 * t646 + t6 * (t1205 + t1318);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1326 = t5 * t380 * t322;
  t1333 = t5 * t389 * t322 / 0.12e2;
  t1335 = t5 * t144 * t692;
  t1337 = t151 * t398;
  t1345 = t409 * t154;
  t1348 = t406 / t37 / t1345;
  t1349 = t912 * t1348;
  t1351 = t408 * t28 * t920;
  t1357 = t929 * t422;
  t1360 = 0.8e1 / 0.9e1 * t59 * t1357 * t305;
  t1363 = 0.2e1 / 0.3e1 * t59 * t423 * t305;
  t1364 = -0.65e2 / 0.648e3 * t149 * t1337 * t298 + 0.17e2 / 0.864e3 * t407 * t411 * t152 * t43 - t1349 * t1351 / 0.7776e4 + 0.11e2 / 0.27e2 * t46 * t33 * t417 - t1360 - t1363;
  t1366 = t672 * t175;
  t1369 = t309 * t435;
  t1378 = t320 * t437;
  t1381 = t690 * t197;
  t1384 = t320 * t460;
  t1392 = t450 * t398;
  t1396 = t406 * t411 * params->a;
  t1397 = t976 * t980;
  t1398 = t1397 * t152;
  t1401 = 0.7e1 / 0.54e2 * t312 * t443 + 0.37e2 / 0.9e1 * t183 * t417 * t317 - 0.62e2 / 0.3e1 * t1392 * t687 + 0.288e3 * t1396 * t1398 + t1360 + t1363;
  t1403 = t1364 * t73 - 0.2e1 * t1366 * t197 + 0.2e1 * t1369 * t437 - 0.6e1 * t952 * t1378 + 0.4e1 * t436 * t1381 + 0.2e1 * t436 * t1384 - t176 * t1401 - t942 * t320 - 0.2e1 * t431 * t690 - t674 * t460 + 0.4e1 * t945 * t677;
  t1408 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t376 * t322 - t1326 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t692 + t1333 - t1335 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1403);
  tv3rho2sigma0 = t6 * t1408 + 0.2e1 * t697;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1415 = t5 * t483 * t354;
  t1419 = t5 * t487 * t354 / 0.12e2;
  t1421 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t479 * t354 - t1415 / 0.4e1 + t1419);
  tv3rho2sigma2 = t6 * t1421 + 0.2e1 * t706;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1427 = t5 * t508 * t322;
  t1435 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t504 * t322 - t1427 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t227 * t692 - t1326 / 0.8e1 + t1333 - t1335 / 0.8e1);
  tv3rho2sigma3 = t6 * t1435 + t697 + t712;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1441 = t5 * t531 * t354;
  t1448 = t5 * t214 * t753;
  t1451 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t527 * t354 - t1441 / 0.8e1 - t1415 / 0.8e1 + t1419 - 0.3e1 / 0.8e1 * t5 * t210 * t753 - t1448 / 0.8e1);
  tv3rho2sigma5 = t6 * t1451 + t706 + t758;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1459 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t558 * t322 - t1427 / 0.4e1 + t1333);
  tv3rho2sigma6 = t6 * t1459 + 0.2e1 * t712;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1470 = t151 * t585;
  t1478 = t591 * t244;
  t1481 = t406 / t91 / t1478;
  t1482 = t912 * t1481;
  t1484 = t590 * t28 * t1251;
  t1490 = t929 * t603;
  t1493 = 0.8e1 / 0.9e1 * t110 * t1490 * t338;
  t1496 = 0.2e1 / 0.3e1 * t110 * t604 * t338;
  t1497 = -0.65e2 / 0.648e3 * t149 * t1470 * t331 + 0.17e2 / 0.864e3 * t407 * t593 * t242 * t97 - t1482 * t1484 / 0.7776e4 + 0.11e2 / 0.27e2 * t100 * t33 * t599 - t1493 - t1496;
  t1499 = t734 * t265;
  t1502 = t342 * t616;
  t1511 = t352 * t618;
  t1514 = t751 * t284;
  t1517 = t352 * t639;
  t1525 = t450 * t585;
  t1529 = t406 * t593 * params->a;
  t1530 = t976 * t1307;
  t1531 = t1530 * t242;
  t1534 = 0.7e1 / 0.54e2 * t345 * t624 + 0.37e2 / 0.9e1 * t183 * t599 * t349 - 0.62e2 / 0.3e1 * t1525 * t748 + 0.288e3 * t1529 * t1531 + t1493 + t1496;
  t1536 = t1497 * t123 - t1272 * t352 + 0.4e1 * t1275 * t739 - 0.6e1 * t1282 * t1511 - 0.2e1 * t1499 * t284 + 0.2e1 * t1502 * t618 + 0.4e1 * t617 * t1514 + 0.2e1 * t617 * t1517 - t266 * t1534 - 0.2e1 * t612 * t751 - t736 * t639;
  t1541 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t574 * t354 - t1441 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t238 * t753 + t1419 - t1448 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * t1536);
  tv3rho2sigma8 = t6 * t1541 + 0.2e1 * t758;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1548 = t5 * t144 * t798 / 0.8e1;
  t1555 = t406 / t37 / t905;
  t1556 = t912 * t1555;
  t1557 = t152 * t43;
  t1558 = t183 * t1557;
  t1564 = t929 * t168;
  t1567 = t59 * t1564 * t768 / 0.3e1;
  t1570 = 0.2e1 / 0.3e1 * t59 * t668 * t768;
  t1571 = -0.5e1 / 0.864e3 * t407 * t660 * t43 * sigma[0] + t1556 * t1558 / 0.20736e5 + t149 * t655 * t43 / 0.54e2 + t1567 - t1570;
  t1573 = t775 * t175;
  t1583 = t779 * t197;
  t1586 = t320 * t690;
  t1590 = t796 * t197;
  t1599 = t406 * t660;
  t1601 = t1397 * sigma[0];
  t1604 = t784 * t180 / 0.36e2 - t787 * t194 / 0.6e1 + 0.5e1 * t684 * t793 - 0.108e3 * t1599 * params->a * t1601 - t1567 + t1570;
  t1606 = -0.2e1 * t1366 * t320 + 0.4e1 * t1369 * t677 + t1571 * t73 - t1573 * t197 - 0.6e1 * t952 * t1583 + 0.4e1 * t436 * t1586 + 0.2e1 * t436 * t1590 - t176 * t1604 - t431 * t796 - 0.2e1 * t674 * t690 + 0.2e1 * t945 * t779;
  t1611 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t798 - t1548 - 0.3e1 / 0.8e1 * t5 * t27 * t1606);
  tv3rhosigma20 = t6 * t1611 + t802;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1618 = t5 * t214 * t841 / 0.8e1;
  t1620 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t210 * t841 - t1618);
  tv3rhosigma25 = t6 * t1620 + t845;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1626 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t227 * t798 - t1548);
  tv3rhosigma26 = t6 * t1626 + t802;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1637 = t406 / t91 / t1238;
  t1638 = t912 * t1637;
  t1639 = t242 * t97;
  t1640 = t183 * t1639;
  t1646 = t929 * t258;
  t1649 = t110 * t1646 * t811 / 0.3e1;
  t1652 = 0.2e1 / 0.3e1 * t110 * t730 * t811;
  t1653 = -0.5e1 / 0.864e3 * t407 * t722 * t97 * sigma[2] + t1638 * t1640 / 0.20736e5 + t149 * t717 * t97 / 0.54e2 + t1649 - t1652;
  t1655 = t818 * t265;
  t1665 = t822 * t284;
  t1668 = t352 * t751;
  t1672 = t839 * t284;
  t1681 = t406 * t722;
  t1683 = t1530 * sigma[2];
  t1686 = t827 * t270 / 0.36e2 - t830 * t281 / 0.6e1 + 0.5e1 * t746 * t836 - 0.108e3 * t1681 * params->a * t1683 - t1649 + t1652;
  t1688 = t1653 * t123 + 0.2e1 * t1275 * t822 - 0.6e1 * t1282 * t1665 - 0.2e1 * t1499 * t352 + 0.4e1 * t1502 * t739 - t1655 * t284 + 0.4e1 * t617 * t1668 + 0.2e1 * t617 * t1672 - t266 * t1686 - t612 * t839 - 0.2e1 * t736 * t751;
  t1693 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t238 * t841 - t1618 - 0.3e1 / 0.8e1 * t5 * t87 * t1688);
  tv3rhosigma211 = t6 * t1693 + t845;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1696 = 0.1e1 / t37 / t410;
  t1697 = t406 * t1696;
  t1699 = t183 * t298;
  t1702 = t406 * t760;
  t1706 = 0.1e1 / t408;
  t1709 = t59 * t929 * t1706 / 0.8e1;
  t1712 = 0.3e1 / 0.4e1 * t59 * t421 * t1706;
  t1714 = t59 * params->expo * t1706;
  t1715 = -t912 * t1697 * t1699 / 0.55296e5 + t404 * t1702 * t43 / 0.768e3 - t1709 + t1712 - t1714;
  t1723 = t779 * t320;
  t1726 = t320 * t796;
  t1731 = t51 / t52 / t152;
  t1734 = t183 * t768;
  t1737 = t450 * t305;
  t1738 = t296 * params->a;
  t1739 = t1738 * t456;
  t1744 = t1731 * t69 / 0.32e2 - 0.3e1 / 0.16e2 * t1734 * t789 - 0.3e1 / 0.8e1 * t1737 * t1739 + 0.81e2 / 0.2e1 * t1702 * t981 + t1709 - t1712 + t1714;
  t1746 = 0.6e1 * t1369 * t779 - 0.3e1 * t1573 * t320 + t1715 * t73 - 0.6e1 * t952 * t1723 + 0.6e1 * t436 * t1726 - t176 * t1744 - 0.3e1 * t674 * t796;
  t1750 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1746);
  tv3sigma30 = t6 * t1750;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1752 = 0.1e1 / t91 / t592;
  t1753 = t406 * t1752;
  t1755 = t183 * t331;
  t1758 = t406 * t803;
  t1762 = 0.1e1 / t590;
  t1765 = t110 * t929 * t1762 / 0.8e1;
  t1768 = 0.3e1 / 0.4e1 * t110 * t421 * t1762;
  t1770 = t110 * params->expo * t1762;
  t1771 = -t912 * t1753 * t1755 / 0.55296e5 + t404 * t1758 * t97 / 0.768e3 - t1765 + t1768 - t1770;
  t1779 = t822 * t352;
  t1782 = t352 * t839;
  t1787 = t51 / t103 / t242;
  t1790 = t183 * t811;
  t1793 = t450 * t338;
  t1794 = t329 * params->a;
  t1795 = t1794 * t635;
  t1800 = t1787 * t119 / 0.32e2 - 0.3e1 / 0.16e2 * t1790 * t832 - 0.3e1 / 0.8e1 * t1793 * t1795 + 0.81e2 / 0.2e1 * t1758 * t1308 + t1765 - t1768 + t1770;
  t1802 = t1771 * t123 - 0.6e1 * t1282 * t1779 + 0.6e1 * t1502 * t822 - 0.3e1 * t1655 * t352 + 0.6e1 * t617 * t1782 - t266 * t1800 - 0.3e1 * t736 * t839;
  t1806 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t1802);
  tv3sigma39 = t6 * t1806;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t40, t43, t46, t49, t50, t51, t52, t54;
  double t58, t59, t60, t61, t63, t68, t69, t72;
  double t73, t75, t79, t80, t81, t82, t83, t84;
  double t86, t87, t88, t89, t90, t91, t93, t94;
  double t97, t100, t103, t105, t109, t110, t111, t112;
  double t118, t119, t122, t123, t125, t129, tzk0;

  double t130, t131, t132, t133, t134, t137, t138, t142;
  double t143, t144, t147, t149, t151, t152, t153, t154;
  double t155, t157, t162, t164, t168, t171, t172, t174;
  double t175, t176, t180, t183, t184, t186, t187, t190;
  double t191, t192, t193, t194, t197, t199, t204, t206;
  double t209, t210, t214, t217, t219, tvrho0, t222, t223;
  double t226, t227, t232, t234, t237, t238, t242, t243;
  double t244, t245, t247, t252, t254, t258, t261, t262;
  double t264, t265, t266, t270, t273, t277, t278, t279;
  double t280, t281, t284, t286, t291, tvrho1, t294, t296;
  double t297, t298, t305, t308, t309, t312, t316, t317;
  double t320, t322, t326, tvsigma0, tvsigma1, t327, t329, t330;
  double t331, t338, t341, t342, t345, t349, t352, t354;
  double t358, tvsigma2;

  double t361, t362, t363, t366, t367, t368, t370, t371;
  double t375, t376, t380, t382, t388, t389, t392, t394;
  double t396, t398, t403, t404, t405, t406, t407, t408;
  double t409, t410, t411, t417, t421, t422, t423, t425;
  double t428, t429, t431, t435, t436, t437, t443, t447;
  double t450, t451, t453, t455, t456, t460, t462, t467;
  double t468, t469, t470, t474, t478, t479, t483, t485;
  double t487, t490, t492, tv2rho20, t495, t498, t499, t503;
  double t504, t508, t510, t518, t519, t522, t526, t527;
  double t531, t533, t540, t543, tv2rho21, t548, t552, t553;
  double t557, t558, t564, t565, t569, t573, t574, t583;
  double t585, t590, t591, t592, t593, t599, t603, t604;
  double t606, t609, t610, t612, t616, t617, t618, t624;
  double t628, t631, t634, t635, t639, t641, t646, tv2rho22;
  double t654, t655, t659, t660, t668, t671, t672, t674;
  double t677, t684, t685, t687, t690, t692, t697, tv2rhosigma0;
  double tv2rhosigma1, t704, t706, tv2rhosigma2, t712, tv2rhosigma3, tv2rhosigma4, t717;
  double t721, t722, t730, t733, t734, t736, t739, t746;
  double t748, t751, t753, t758, tv2rhosigma5, t760, t768, t771;
  double t774, t775, t779, t784, t787, t789, t793, t796;
  double t798, t802, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t803;
  double t811, t814, t817, t818, t822, t827, t830, t832;
  double t836, t839, t841, t845, tv2sigma25;

  double t849, t850, t853, t856, t857, t858, t860, t861;
  double t865, t866, t870, t872, t877, t879, t882, t888;
  double t889, t892, t894, t897, t900, t905, t906, t912;
  double t913, t914, t915, t916, t918, t920, t925, t929;
  double t930, t931, t933, t934, t936, t939, t940, t942;
  double t945, t950, t951, t952, t953, t956, t962, t973;
  double t975, t976, t977, t978, t980, t981, t984, t986;
  double t991, t993, t994, t997, t1001, t1005, t1006, t1010;
  double t1012, t1014, t1016, t1018, t1021, t1023, tv3rho30, t1026;
  double t1027, t1028, t1031, t1036, t1037, t1038, t1039, t1043;
  double t1044, t1048, t1051, t1055, t1057, t1061, t1070, t1071;
  double t1072, t1075, t1081, t1085, t1086, t1090, t1093, t1094;
  double t1096, t1105, t1107, t1110, tv3rho31, t1113, t1118, t1121;
  double t1122, t1126, t1127, t1131, t1133, t1142, t1143, t1148;
  double t1152, t1156, t1157, t1161, t1163, t1170, t1178, t1180;
  double t1181, tv3rho32, t1186, t1192, t1193, t1197, t1198, t1205;
  double t1206, t1212, t1216, t1217, t1233, t1238, t1239, t1244;
  double t1245, t1246, t1247, t1249, t1251, t1256, t1260, t1261;
  double t1263, t1264, t1266, t1269, t1270, t1272, t1275, t1280;
  double t1281, t1282, t1283, t1286, t1292, t1303, t1305, t1307;
  double t1308, t1311, t1313, t1318, tv3rho33, t1326, t1333, t1335;
  double t1337, t1345, t1348, t1349, t1351, t1357, t1360, t1363;
  double t1364, t1366, t1369, t1378, t1381, t1384, t1392, t1396;
  double t1397, t1398, t1401, t1403, t1408, tv3rho2sigma0, tv3rho2sigma1, t1415;
  double t1419, t1421, tv3rho2sigma2, t1427, t1435, tv3rho2sigma3, tv3rho2sigma4, t1441;
  double t1448, t1451, tv3rho2sigma5, t1459, tv3rho2sigma6, tv3rho2sigma7, t1470, t1478;
  double t1481, t1482, t1484, t1490, t1493, t1496, t1497, t1499;
  double t1502, t1511, t1514, t1517, t1525, t1529, t1530, t1531;
  double t1534, t1536, t1541, tv3rho2sigma8, t1548, t1555, t1556, t1557;
  double t1558, t1564, t1567, t1570, t1571, t1573, t1583, t1586;
  double t1590, t1599, t1601, t1604, t1606, t1611, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1618, t1620, tv3rhosigma25, t1626, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1637, t1638, t1639, t1640;
  double t1646, t1649, t1652, t1653, t1655, t1665, t1668, t1672;
  double t1681, t1683, t1686, t1688, t1693, tv3rhosigma211, t1696, t1697;
  double t1699, t1702, t1706, t1709, t1712, t1714, t1715, t1723;
  double t1726, t1731, t1734, t1737, t1738, t1739, t1744, t1746;
  double t1750, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36;
  double tv3sigma37, tv3sigma38, t1752, t1753, t1755, t1758, t1762, t1765;
  double t1768, t1770, t1771, t1779, t1782, t1787, t1790, t1793;
  double t1794, t1795, t1800, t1802, t1806, tv3sigma39;

  double t1813, t1819, t1821, t1827, t1830, t1833, t1836, t1841;
  double t1846, t1848, t1853, t1854, t1858, t1863, t1868, t1872;
  double t1873, t1876, t1879, t1882, t1885, t1888, t1891, t1896;
  double t1905, t1906, t1912, t1934, t1937, t1939, t1944, t1950;
  double t1954, t1958, t1961, t1965, t1966, t1968, t1969, t1975;
  double t1982, t1984, t1985, t1989, t1994, t1995, t1996, t1998;
  double t1999, t2005, t2011, t2015, t2022, t2026, t2030, t2035;
  double t2037, tv4rho40, t2058, t2059, t2060, t2061, t2065, t2074;
  double t2080, t2081, t2083, t2096, t2100, t2101, t2104, t2109;
  double t2110, t2128, t2132, t2139, t2143, t2144, t2147, t2156;
  double t2159, t2160, t2162, t2164, t2165, tv4rho41, t2180, t2193;
  double t2197, t2206, t2219, t2223, t2230, t2231, t2240, t2253;
  double t2257, t2264, t2268, t2277, t2280, t2291, t2294, t2296;
  double t2297, tv4rho42, t2317, t2318, t2322, t2329, t2340, t2341;
  double t2358, t2362, t2369, t2377, t2386, t2396, t2398, t2399;
  double tv4rho43, t2404, t2409, t2415, t2416, t2420, t2429, t2434;
  double t2439, t2444, t2446, t2454, t2459, t2464, t2468, t2471;
  double t2474, t2477, t2480, t2483, t2486, t2491, t2500, t2501;
  double t2507, t2531, t2533, t2538, t2542, t2547, t2553, t2557;
  double t2576, t2577, tv4rho44, t2585, t2591, t2594, t2601, t2603;
  double t2606, t2616, t2639, t2640, t2649, t2652, t2655, t2659;
  double t2662, t2709, t2715, tv4rho3sigma0, tv4rho3sigma1, t2722, t2725, t2729;
  double t2731, tv4rho3sigma2, t2733, t2739, t2744, t2748, t2757, t2758;
  double tv4rho3sigma3, tv4rho3sigma4, t2760, t2766, t2768, t2777, t2779, t2782;
  double tv4rho3sigma5, t2788, t2797, tv4rho3sigma6, tv4rho3sigma7, t2803, t2810, t2818;
  double t2820, t2821, tv4rho3sigma8, t2830, tv4rho3sigma9, tv4rho3sigma10, t2855, t2878;
  double t2887, t2890, t2893, t2897, t2900, t2947, t2953, tv4rho3sigma11;
  double t2960, t2967, t2969, t3003, t3028, t3031, t3034, t3052;
  double t3067, t3070, t3073, t3079, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t3086, t3090, t3092, tv4rho2sigma25, t3098, t3106, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t3112, t3119, t3122, tv4rho2sigma211;
  double t3130, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t3173, t3198;
  double t3201, t3204, t3207, t3237, t3240, t3243, t3249, tv4rho2sigma217;
  double t3256, t3272, t3274, t3277, t3280, t3341, t3347, tv4rhosigma30;
  double tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38;
  double t3354, t3356, tv4rhosigma39, t3362, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313;
  double tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t3382, t3384, t3387;
  double t3390, t3451, t3457, tv4rhosigma319, t3466, t3471, t3474, t3477;
  double t3480, t3483, t3498, t3504, t3530, t3534, tv4sigma40, tv4sigma41;
  double tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49;
  double tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t3546, t3549, t3552, t3555;
  double t3558, t3573, t3579, t3605, t3609, tv4sigma414;

  gga_x_pw91_params *params;

  assert(p->params != NULL);
  params = (gga_x_pw91_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->alpha * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t33 * sigma[0];
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t40 = t34 * t39;
  t43 = exp(-t29 * t40 / 0.24e2);
  t46 = (params->d * t43 + params->c) * t28;
  t49 = t28 * t28;
  t50 = 0.1e1 / t31;
  t51 = t49 * t50;
  t52 = sqrt(sigma[0]);
  t54 = 0.1e1 / t36 / rho[0];
  t58 = pow(t51 * t52 * t54 / 0.12e2, params->expo);
  t59 = params->f * t58;
  t60 = t46 * t40 / 0.24e2 - t59;
  t61 = t51 * t52;
  t63 = params->b * t49;
  t68 = log(t63 * t50 * t52 * t54 / 0.12e2 + sqrt(POW_2(t63 * t50 * t52 * t54 / 0.12e2) + 0.1e1));
  t69 = t54 * params->a * t68;
  t72 = 0.1e1 + t61 * t69 / 0.12e2 + t59;
  t73 = 0.1e1 / t72;
  t75 = t60 * t73 + 0.1e1;
  t79 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t75);
  t80 = rho[1] <= p->dens_threshold;
  t81 = my_piecewise5(t14, t11, t10, t15, -t17);
  t82 = 0.1e1 + t81;
  t83 = t82 <= p->zeta_threshold;
  t84 = POW_1_3(t82);
  t86 = my_piecewise3(t83, t22, t84 * t82);
  t87 = t86 * t26;
  t88 = t33 * sigma[2];
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t93 = 0.1e1 / t91 / t89;
  t94 = t88 * t93;
  t97 = exp(-t29 * t94 / 0.24e2);
  t100 = (params->d * t97 + params->c) * t28;
  t103 = sqrt(sigma[2]);
  t105 = 0.1e1 / t90 / rho[1];
  t109 = pow(t51 * t103 * t105 / 0.12e2, params->expo);
  t110 = params->f * t109;
  t111 = t100 * t94 / 0.24e2 - t110;
  t112 = t51 * t103;
  t118 = log(t63 * t50 * t103 * t105 / 0.12e2 + sqrt(POW_2(t63 * t50 * t103 * t105 / 0.12e2) + 0.1e1));
  t119 = t105 * params->a * t118;
  t122 = 0.1e1 + t112 * t119 / 0.12e2 + t110;
  t123 = 0.1e1 / t122;
  t125 = t111 * t123 + 0.1e1;
  t129 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t125);
  tzk0 = t79 + t129;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t130 = t6 * t6;
  t131 = 0.1e1 / t130;
  t132 = t16 * t131;
  t133 = t7 - t132;
  t134 = my_piecewise5(t10, 0, t14, 0, t133);
  t137 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t134);
  t138 = t137 * t26;
  t142 = t26 * t26;
  t143 = 0.1e1 / t142;
  t144 = t25 * t143;
  t147 = t5 * t144 * t75 / 0.8e1;
  t149 = params->d * params->alpha * t49;
  t151 = 0.1e1 / t31 / t30;
  t152 = sigma[0] * sigma[0];
  t153 = t151 * t152;
  t154 = t35 * t35;
  t155 = t154 * t35;
  t157 = 0.1e1 / t36 / t155;
  t162 = t35 * rho[0];
  t164 = 0.1e1 / t37 / t162;
  t168 = 0.1e1 / rho[0];
  t171 = 0.4e1 / 0.3e1 * t59 * params->expo * t168;
  t172 = t149 * t153 * t157 * t43 / 0.216e3 - t46 * t34 * t164 / 0.9e1 + t171;
  t174 = t72 * t72;
  t175 = 0.1e1 / t174;
  t176 = t60 * t175;
  t180 = 0.1e1 / t36 / t35 * params->a * t68;
  t183 = t28 * t33;
  t184 = t183 * sigma[0];
  t186 = params->b * params->b;
  t187 = t186 * t28;
  t190 = 0.6e1 * t187 * t40 + 0.144e3;
  t191 = sqrt(t190);
  t192 = 0.1e1 / t191;
  t193 = params->b * t192;
  t194 = t164 * params->a * t193;
  t197 = -t61 * t180 / 0.9e1 - 0.2e1 / 0.3e1 * t184 * t194 - t171;
  t199 = t172 * t73 - t176 * t197;
  t204 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t75 - t147 - 0.3e1 / 0.8e1 * t5 * t27 * t199);
  t206 = my_piecewise5(t14, 0, t10, 0, -t133);
  t209 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t206);
  t210 = t209 * t26;
  t214 = t86 * t143;
  t217 = t5 * t214 * t125 / 0.8e1;
  t219 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t210 * t125 - t217);
  tvrho0 = t79 + t129 + t6 * (t204 + t219);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t222 = -t7 - t132;
  t223 = my_piecewise5(t10, 0, t14, 0, t222);
  t226 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t223);
  t227 = t226 * t26;
  t232 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t227 * t75 - t147);
  t234 = my_piecewise5(t14, 0, t10, 0, -t222);
  t237 = my_piecewise3(t83, 0, 0.4e1 / 0.3e1 * t84 * t234);
  t238 = t237 * t26;
  t242 = sigma[2] * sigma[2];
  t243 = t151 * t242;
  t244 = t89 * t89;
  t245 = t244 * t89;
  t247 = 0.1e1 / t90 / t245;
  t252 = t89 * rho[1];
  t254 = 0.1e1 / t91 / t252;
  t258 = 0.1e1 / rho[1];
  t261 = 0.4e1 / 0.3e1 * t110 * params->expo * t258;
  t262 = t149 * t243 * t247 * t97 / 0.216e3 - t100 * t88 * t254 / 0.9e1 + t261;
  t264 = t122 * t122;
  t265 = 0.1e1 / t264;
  t266 = t111 * t265;
  t270 = 0.1e1 / t90 / t89 * params->a * t118;
  t273 = t183 * sigma[2];
  t277 = 0.6e1 * t187 * t94 + 0.144e3;
  t278 = sqrt(t277);
  t279 = 0.1e1 / t278;
  t280 = params->b * t279;
  t281 = t254 * params->a * t280;
  t284 = -t112 * t270 / 0.9e1 - 0.2e1 / 0.3e1 * t273 * t281 - t261;
  t286 = t262 * t123 - t266 * t284;
  t291 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t238 * t125 - t217 - 0.3e1 / 0.8e1 * t5 * t87 * t286);
  tvrho1 = t79 + t129 + t6 * (t232 + t291);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t294 = t154 * rho[0];
  t296 = 0.1e1 / t36 / t294;
  t297 = t151 * t296;
  t298 = t43 * sigma[0];
  t305 = 0.1e1 / sigma[0];
  t308 = t59 * params->expo * t305 / 0.2e1;
  t309 = -t149 * t297 * t298 / 0.576e3 + t46 * t33 * t39 / 0.24e2 - t308;
  t312 = t51 / t52;
  t316 = params->a * params->b;
  t317 = t316 * t192;
  t320 = t312 * t69 / 0.24e2 + t183 * t39 * t317 / 0.4e1 + t308;
  t322 = -t176 * t320 + t309 * t73;
  t326 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t322);
  tvsigma0 = t6 * t326;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t327 = t244 * rho[1];
  t329 = 0.1e1 / t90 / t327;
  t330 = t151 * t329;
  t331 = t97 * sigma[2];
  t338 = 0.1e1 / sigma[2];
  t341 = t110 * params->expo * t338 / 0.2e1;
  t342 = -t149 * t330 * t331 / 0.576e3 + t100 * t33 * t93 / 0.24e2 - t341;
  t345 = t51 / t103;
  t349 = t316 * t279;
  t352 = t345 * t119 / 0.24e2 + t183 * t93 * t349 / 0.4e1 + t341;
  t354 = t342 * t123 - t266 * t352;
  t358 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t354);
  tvsigma2 = t6 * t358;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t361 = t23 * t23;
  t362 = 0.1e1 / t361;
  t363 = t134 * t134;
  t366 = t130 * t6;
  t367 = 0.1e1 / t366;
  t368 = t16 * t367;
  t370 = -0.2e1 * t131 + 0.2e1 * t368;
  t371 = my_piecewise5(t10, 0, t14, 0, t370);
  t375 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t362 * t363 + 0.4e1 / 0.3e1 * t23 * t371);
  t376 = t375 * t26;
  t380 = t137 * t143;
  t382 = t5 * t380 * t75;
  t388 = 0.1e1 / t142 / t6;
  t389 = t25 * t388;
  t392 = t5 * t389 * t75 / 0.12e2;
  t394 = t5 * t144 * t199;
  t396 = t154 * t162;
  t398 = 0.1e1 / t36 / t396;
  t403 = params->alpha * params->alpha;
  t404 = params->d * t403;
  t405 = t30 * t30;
  t406 = 0.1e1 / t405;
  t407 = t404 * t406;
  t408 = t152 * sigma[0];
  t409 = t154 * t154;
  t410 = t409 * t35;
  t411 = 0.1e1 / t410;
  t417 = 0.1e1 / t37 / t154;
  t421 = params->expo * params->expo;
  t422 = 0.1e1 / t35;
  t423 = t421 * t422;
  t425 = 0.16e2 / 0.9e1 * t59 * t423;
  t428 = 0.4e1 / 0.3e1 * t59 * params->expo * t422;
  t429 = -t149 * t153 * t398 * t43 / 0.24e2 + t407 * t408 * t411 * t43 / 0.324e3 + 0.11e2 / 0.27e2 * t46 * t34 * t417 - t425 - t428;
  t431 = t172 * t175;
  t435 = 0.1e1 / t174 / t72;
  t436 = t60 * t435;
  t437 = t197 * t197;
  t443 = 0.1e1 / t36 / t162 * params->a * t68;
  t447 = t417 * params->a * t193;
  t450 = t49 * t151;
  t451 = t450 * t152;
  t453 = t186 * params->b;
  t455 = 0.1e1 / t191 / t190;
  t456 = t453 * t455;
  t460 = 0.7e1 / 0.27e2 * t61 * t443 + 0.1e2 / 0.3e1 * t184 * t447 - 0.16e2 / 0.3e1 * t451 * t398 * params->a * t456 + t425 + t428;
  t462 = -t176 * t460 - 0.2e1 * t431 * t197 + t429 * t73 + 0.2e1 * t436 * t437;
  t467 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t376 * t75 - t382 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t199 + t392 - t394 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t462);
  t468 = t84 * t84;
  t469 = 0.1e1 / t468;
  t470 = t206 * t206;
  t474 = my_piecewise5(t14, 0, t10, 0, -t370);
  t478 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t469 * t470 + 0.4e1 / 0.3e1 * t84 * t474);
  t479 = t478 * t26;
  t483 = t209 * t143;
  t485 = t5 * t483 * t125;
  t487 = t86 * t388;
  t490 = t5 * t487 * t125 / 0.12e2;
  t492 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t479 * t125 - t485 / 0.4e1 + t490);
  tv2rho20 = 0.2e1 * t204 + 0.2e1 * t219 + t6 * (t467 + t492);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t495 = t362 * t223;
  t498 = 0.2e1 * t368;
  t499 = my_piecewise5(t10, 0, t14, 0, t498);
  t503 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t495 * t134 + 0.4e1 / 0.3e1 * t23 * t499);
  t504 = t503 * t26;
  t508 = t226 * t143;
  t510 = t5 * t508 * t75;
  t518 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t504 * t75 - t510 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t227 * t199 - t382 / 0.8e1 + t392 - t394 / 0.8e1);
  t519 = t469 * t234;
  t522 = my_piecewise5(t14, 0, t10, 0, -t498);
  t526 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t519 * t206 + 0.4e1 / 0.3e1 * t84 * t522);
  t527 = t526 * t26;
  t531 = t237 * t143;
  t533 = t5 * t531 * t125;
  t540 = t5 * t214 * t286;
  t543 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t527 * t125 - t533 / 0.8e1 - t485 / 0.8e1 + t490 - 0.3e1 / 0.8e1 * t5 * t210 * t286 - t540 / 0.8e1);
  tv2rho21 = t204 + t219 + t232 + t291 + t6 * (t518 + t543);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t548 = t223 * t223;
  t552 = 0.2e1 * t131 + 0.2e1 * t368;
  t553 = my_piecewise5(t10, 0, t14, 0, t552);
  t557 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t362 * t548 + 0.4e1 / 0.3e1 * t23 * t553);
  t558 = t557 * t26;
  t564 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t558 * t75 - t510 / 0.4e1 + t392);
  t565 = t234 * t234;
  t569 = my_piecewise5(t14, 0, t10, 0, -t552);
  t573 = my_piecewise3(t83, 0, 0.4e1 / 0.9e1 * t469 * t565 + 0.4e1 / 0.3e1 * t84 * t569);
  t574 = t573 * t26;
  t583 = t244 * t252;
  t585 = 0.1e1 / t90 / t583;
  t590 = t242 * sigma[2];
  t591 = t244 * t244;
  t592 = t591 * t89;
  t593 = 0.1e1 / t592;
  t599 = 0.1e1 / t91 / t244;
  t603 = 0.1e1 / t89;
  t604 = t421 * t603;
  t606 = 0.16e2 / 0.9e1 * t110 * t604;
  t609 = 0.4e1 / 0.3e1 * t110 * params->expo * t603;
  t610 = -t149 * t243 * t585 * t97 / 0.24e2 + t407 * t590 * t593 * t97 / 0.324e3 + 0.11e2 / 0.27e2 * t100 * t88 * t599 - t606 - t609;
  t612 = t262 * t265;
  t616 = 0.1e1 / t264 / t122;
  t617 = t111 * t616;
  t618 = t284 * t284;
  t624 = 0.1e1 / t90 / t252 * params->a * t118;
  t628 = t599 * params->a * t280;
  t631 = t450 * t242;
  t634 = 0.1e1 / t278 / t277;
  t635 = t453 * t634;
  t639 = 0.7e1 / 0.27e2 * t112 * t624 + 0.1e2 / 0.3e1 * t273 * t628 - 0.16e2 / 0.3e1 * t631 * t585 * params->a * t635 + t606 + t609;
  t641 = t610 * t123 - t266 * t639 - 0.2e1 * t612 * t284 + 0.2e1 * t617 * t618;
  t646 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t574 * t125 - t533 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t238 * t286 + t490 - t540 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * t641);
  tv2rho22 = 0.2e1 * t232 + 0.2e1 * t291 + t6 * (t564 + t646);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t654 = t5 * t144 * t322 / 0.8e1;
  t655 = t151 * t157;
  t659 = t409 * rho[0];
  t660 = 0.1e1 / t659;
  t668 = t421 * t168;
  t671 = 0.2e1 / 0.3e1 * t59 * t668 * t305;
  t672 = t149 * t655 * t298 / 0.72e2 - t407 * t660 * t152 * t43 / 0.864e3 - t46 * t33 * t164 / 0.9e1 + t671;
  t674 = t309 * t175;
  t677 = t320 * t197;
  t684 = t450 * t157;
  t685 = params->a * t453;
  t687 = t685 * t455 * sigma[0];
  t690 = -t312 * t180 / 0.18e2 - t183 * t164 * t317 + 0.2e1 * t684 * t687 - t671;
  t692 = -t176 * t690 - t674 * t197 - t431 * t320 + 0.2e1 * t436 * t677 + t672 * t73;
  t697 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t322 - t654 - 0.3e1 / 0.8e1 * t5 * t27 * t692);
  tv2rhosigma0 = t6 * t697 + t326;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t704 = t5 * t214 * t354 / 0.8e1;
  t706 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t210 * t354 - t704);
  tv2rhosigma2 = t6 * t706 + t358;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t712 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t227 * t322 - t654);
  tv2rhosigma3 = t6 * t712 + t326;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t717 = t151 * t247;
  t721 = t591 * rho[1];
  t722 = 0.1e1 / t721;
  t730 = t421 * t258;
  t733 = 0.2e1 / 0.3e1 * t110 * t730 * t338;
  t734 = t149 * t717 * t331 / 0.72e2 - t407 * t722 * t242 * t97 / 0.864e3 - t100 * t33 * t254 / 0.9e1 + t733;
  t736 = t342 * t265;
  t739 = t352 * t284;
  t746 = t450 * t247;
  t748 = t685 * t634 * sigma[2];
  t751 = -t345 * t270 / 0.18e2 - t183 * t254 * t349 + 0.2e1 * t746 * t748 - t733;
  t753 = t734 * t123 - t266 * t751 - t736 * t284 - t612 * t352 + 0.2e1 * t617 * t739;
  t758 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t238 * t354 - t704 - 0.3e1 / 0.8e1 * t5 * t87 * t753);
  tv2rhosigma5 = t6 * t758 + t358;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t760 = 0.1e1 / t409;
  t768 = 0.1e1 / t152;
  t771 = t59 * t421 * t768 / 0.4e1;
  t774 = t59 * params->expo * t768 / 0.2e1;
  t775 = t407 * t760 * t43 * sigma[0] / 0.2304e4 - t149 * t297 * t43 / 0.288e3 - t771 + t774;
  t779 = t320 * t320;
  t784 = t51 / t52 / sigma[0];
  t787 = t183 * t305;
  t789 = t39 * params->a * t193;
  t793 = t685 * t455;
  t796 = -t784 * t69 / 0.48e2 + t787 * t789 / 0.8e1 - 0.3e1 / 0.4e1 * t450 * t296 * t793 + t771 - t774;
  t798 = -t176 * t796 - 0.2e1 * t674 * t320 + 0.2e1 * t436 * t779 + t775 * t73;
  t802 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t798);
  tv2sigma20 = t6 * t802;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t803 = 0.1e1 / t591;
  t811 = 0.1e1 / t242;
  t814 = t110 * t421 * t811 / 0.4e1;
  t817 = t110 * params->expo * t811 / 0.2e1;
  t818 = t407 * t803 * t97 * sigma[2] / 0.2304e4 - t149 * t330 * t97 / 0.288e3 - t814 + t817;
  t822 = t352 * t352;
  t827 = t51 / t103 / sigma[2];
  t830 = t183 * t338;
  t832 = t93 * params->a * t280;
  t836 = t685 * t634;
  t839 = -t827 * t119 / 0.48e2 + t830 * t832 / 0.8e1 - 0.3e1 / 0.4e1 * t450 * t329 * t836 + t814 - t817;
  t841 = t818 * t123 - t266 * t839 - 0.2e1 * t736 * t352 + 0.2e1 * t617 * t822;
  t845 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t841);
  tv2sigma25 = t6 * t845;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t849 = 0.1e1 / t361 / t19;
  t850 = t363 * t134;
  t853 = t362 * t134;
  t856 = t130 * t130;
  t857 = 0.1e1 / t856;
  t858 = t16 * t857;
  t860 = 0.6e1 * t367 - 0.6e1 * t858;
  t861 = my_piecewise5(t10, 0, t14, 0, t860);
  t865 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t849 * t850 + 0.4e1 / 0.3e1 * t853 * t371 + 0.4e1 / 0.3e1 * t23 * t861);
  t866 = t865 * t26;
  t870 = t375 * t143;
  t872 = t5 * t870 * t75;
  t877 = t137 * t388;
  t879 = t5 * t877 * t75;
  t882 = t5 * t380 * t199;
  t888 = 0.1e1 / t142 / t130;
  t889 = t25 * t888;
  t892 = 0.5e1 / 0.36e2 * t5 * t889 * t75;
  t894 = t5 * t389 * t199;
  t897 = t5 * t144 * t462;
  t900 = 0.1e1 / t36 / t409;
  t905 = t409 * t162;
  t906 = 0.1e1 / t905;
  t912 = params->d * t403 * params->alpha;
  t913 = t152 * t152;
  t914 = t406 * t913;
  t915 = t912 * t914;
  t916 = t409 * t294;
  t918 = 0.1e1 / t37 / t916;
  t920 = t33 * t43;
  t925 = 0.1e1 / t37 / t294;
  t929 = t421 * params->expo;
  t930 = 0.1e1 / t162;
  t931 = t929 * t930;
  t933 = 0.64e2 / 0.27e2 * t59 * t931;
  t934 = t421 * t930;
  t936 = 0.16e2 / 0.3e1 * t59 * t934;
  t939 = 0.8e1 / 0.3e1 * t59 * params->expo * t930;
  t940 = 0.341e3 / 0.972e3 * t149 * t153 * t900 * t43 - 0.19e2 / 0.324e3 * t407 * t408 * t906 * t43 + t915 * t918 * t28 * t920 / 0.2916e4 - 0.154e3 / 0.81e2 * t46 * t34 * t925 + t933 + t936 + t939;
  t942 = t429 * t175;
  t945 = t172 * t435;
  t950 = t174 * t174;
  t951 = 0.1e1 / t950;
  t952 = t60 * t951;
  t953 = t437 * t197;
  t956 = t197 * t460;
  t962 = 0.1e1 / t36 / t154 * params->a * t68;
  t973 = t406 * t408;
  t975 = t186 * t186;
  t976 = t975 * params->b;
  t977 = params->a * t976;
  t978 = t190 * t190;
  t980 = 0.1e1 / t191 / t978;
  t981 = t977 * t980;
  t984 = -0.7e2 / 0.81e2 * t61 * t962 - 0.476e3 / 0.27e2 * t184 * t925 * params->a * t193 + 0.592e3 / 0.9e1 * t451 * t900 * params->a * t456 - 0.768e3 * t973 * t906 * t981 - t933 - t936 - t939;
  t986 = -t176 * t984 - 0.3e1 * t942 * t197 - 0.3e1 * t431 * t460 + 0.6e1 * t436 * t956 + 0.6e1 * t945 * t437 + t940 * t73 - 0.6e1 * t952 * t953;
  t991 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t866 * t75 - 0.3e1 / 0.8e1 * t872 - 0.9e1 / 0.8e1 * t5 * t376 * t199 + t879 / 0.4e1 - 0.3e1 / 0.4e1 * t882 - 0.9e1 / 0.8e1 * t5 * t138 * t462 - t892 + t894 / 0.4e1 - 0.3e1 / 0.8e1 * t897 - 0.3e1 / 0.8e1 * t5 * t27 * t986);
  t993 = 0.1e1 / t468 / t82;
  t994 = t470 * t206;
  t997 = t469 * t206;
  t1001 = my_piecewise5(t14, 0, t10, 0, -t860);
  t1005 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t993 * t994 + 0.4e1 / 0.3e1 * t997 * t474 + 0.4e1 / 0.3e1 * t84 * t1001);
  t1006 = t1005 * t26;
  t1010 = t478 * t143;
  t1012 = t5 * t1010 * t125;
  t1014 = t209 * t388;
  t1016 = t5 * t1014 * t125;
  t1018 = t86 * t888;
  t1021 = 0.5e1 / 0.36e2 * t5 * t1018 * t125;
  t1023 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t1006 * t125 - 0.3e1 / 0.8e1 * t1012 + t1016 / 0.4e1 - t1021);
  tv3rho30 = 0.3e1 * t467 + 0.3e1 * t492 + t6 * (t991 + t1023);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1026 = 0.2e1 * t518;
  t1027 = 0.2e1 * t543;
  t1028 = t849 * t223;
  t1031 = t362 * t499;
  t1036 = 0.2e1 * t367;
  t1037 = 0.6e1 * t858;
  t1038 = t1036 - t1037;
  t1039 = my_piecewise5(t10, 0, t14, 0, t1038);
  t1043 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1028 * t363 + 0.8e1 / 0.9e1 * t1031 * t134 + 0.4e1 / 0.9e1 * t495 * t371 + 0.4e1 / 0.3e1 * t23 * t1039);
  t1044 = t1043 * t26;
  t1048 = t503 * t143;
  t1051 = t5 * t1048 * t75 / 0.4e1;
  t1055 = t226 * t388;
  t1057 = t5 * t1055 * t75;
  t1061 = t5 * t508 * t199 / 0.4e1;
  t1070 = -0.3e1 / 0.8e1 * t5 * t1044 * t75 - t1051 - 0.3e1 / 0.4e1 * t5 * t504 * t199 + t1057 / 0.12e2 - t1061 - 0.3e1 / 0.8e1 * t5 * t227 * t462 - t872 / 0.8e1 + t879 / 0.6e1 - t882 / 0.4e1 - t892 + t894 / 0.6e1 - t897 / 0.8e1;
  t1071 = my_piecewise3(t1, 0, t1070);
  t1072 = t993 * t234;
  t1075 = t469 * t522;
  t1081 = my_piecewise5(t14, 0, t10, 0, -t1038);
  t1085 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1072 * t470 + 0.8e1 / 0.9e1 * t1075 * t206 + 0.4e1 / 0.9e1 * t519 * t474 + 0.4e1 / 0.3e1 * t84 * t1081);
  t1086 = t1085 * t26;
  t1090 = t526 * t143;
  t1093 = t5 * t1090 * t125 / 0.4e1;
  t1094 = t237 * t388;
  t1096 = t5 * t1094 * t125;
  t1105 = t5 * t483 * t286 / 0.4e1;
  t1107 = t5 * t487 * t286;
  t1110 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t1086 * t125 - t1093 + t1096 / 0.12e2 - t1012 / 0.8e1 + t1016 / 0.6e1 - t1021 - 0.3e1 / 0.8e1 * t5 * t479 * t286 - t1105 + t1107 / 0.12e2);
  tv3rho31 = t467 + t492 + t1026 + t1027 + t6 * (t1071 + t1110);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1113 = t849 * t548;
  t1118 = t362 * t553;
  t1121 = -t1036 - t1037;
  t1122 = my_piecewise5(t10, 0, t14, 0, t1121);
  t1126 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1113 * t134 + 0.8e1 / 0.9e1 * t495 * t499 + 0.4e1 / 0.9e1 * t1118 * t134 + 0.4e1 / 0.3e1 * t23 * t1122);
  t1127 = t1126 * t26;
  t1131 = t557 * t143;
  t1133 = t5 * t1131 * t75;
  t1142 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1127 * t75 - t1133 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t558 * t199 - t1051 + t1057 / 0.6e1 - t1061 + t879 / 0.12e2 - t892 + t894 / 0.12e2);
  t1143 = t993 * t565;
  t1148 = t469 * t569;
  t1152 = my_piecewise5(t14, 0, t10, 0, -t1121);
  t1156 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t1143 * t206 + 0.8e1 / 0.9e1 * t519 * t522 + 0.4e1 / 0.9e1 * t1148 * t206 + 0.4e1 / 0.3e1 * t84 * t1152);
  t1157 = t1156 * t26;
  t1161 = t573 * t143;
  t1163 = t5 * t1161 * t125;
  t1170 = t5 * t531 * t286;
  t1178 = t5 * t214 * t641;
  t1180 = -0.3e1 / 0.8e1 * t5 * t1157 * t125 - t1163 / 0.8e1 - t1093 + t1096 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t527 * t286 - t1170 / 0.4e1 + t1016 / 0.12e2 - t1021 - t1105 + t1107 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t210 * t641 - t1178 / 0.8e1;
  t1181 = my_piecewise3(t80, 0, t1180);
  tv3rho32 = t1026 + t1027 + t564 + t646 + t6 * (t1142 + t1181);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1186 = t548 * t223;
  t1192 = -0.6e1 * t367 - 0.6e1 * t858;
  t1193 = my_piecewise5(t10, 0, t14, 0, t1192);
  t1197 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t849 * t1186 + 0.4e1 / 0.3e1 * t495 * t553 + 0.4e1 / 0.3e1 * t23 * t1193);
  t1198 = t1197 * t26;
  t1205 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1198 * t75 - 0.3e1 / 0.8e1 * t1133 + t1057 / 0.4e1 - t892);
  t1206 = t565 * t234;
  t1212 = my_piecewise5(t14, 0, t10, 0, -t1192);
  t1216 = my_piecewise3(t83, 0, -0.8e1 / 0.27e2 * t993 * t1206 + 0.4e1 / 0.3e1 * t519 * t569 + 0.4e1 / 0.3e1 * t84 * t1212);
  t1217 = t1216 * t26;
  t1233 = 0.1e1 / t90 / t591;
  t1238 = t591 * t252;
  t1239 = 0.1e1 / t1238;
  t1244 = t242 * t242;
  t1245 = t406 * t1244;
  t1246 = t912 * t1245;
  t1247 = t591 * t327;
  t1249 = 0.1e1 / t91 / t1247;
  t1251 = t33 * t97;
  t1256 = 0.1e1 / t91 / t327;
  t1260 = 0.1e1 / t252;
  t1261 = t929 * t1260;
  t1263 = 0.64e2 / 0.27e2 * t110 * t1261;
  t1264 = t421 * t1260;
  t1266 = 0.16e2 / 0.3e1 * t110 * t1264;
  t1269 = 0.8e1 / 0.3e1 * t110 * params->expo * t1260;
  t1270 = 0.341e3 / 0.972e3 * t149 * t243 * t1233 * t97 - 0.19e2 / 0.324e3 * t407 * t590 * t1239 * t97 + t1246 * t1249 * t28 * t1251 / 0.2916e4 - 0.154e3 / 0.81e2 * t100 * t88 * t1256 + t1263 + t1266 + t1269;
  t1272 = t610 * t265;
  t1275 = t262 * t616;
  t1280 = t264 * t264;
  t1281 = 0.1e1 / t1280;
  t1282 = t111 * t1281;
  t1283 = t618 * t284;
  t1286 = t284 * t639;
  t1292 = 0.1e1 / t90 / t244 * params->a * t118;
  t1303 = t406 * t590;
  t1305 = t277 * t277;
  t1307 = 0.1e1 / t278 / t1305;
  t1308 = t977 * t1307;
  t1311 = -0.7e2 / 0.81e2 * t112 * t1292 - 0.476e3 / 0.27e2 * t273 * t1256 * params->a * t280 + 0.592e3 / 0.9e1 * t631 * t1233 * params->a * t635 - 0.768e3 * t1303 * t1239 * t1308 - t1263 - t1266 - t1269;
  t1313 = t1270 * t123 - 0.3e1 * t1272 * t284 + 0.6e1 * t1275 * t618 - 0.6e1 * t1282 * t1283 + 0.6e1 * t617 * t1286 - t266 * t1311 - 0.3e1 * t612 * t639;
  t1318 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t1217 * t125 - 0.3e1 / 0.8e1 * t1163 - 0.9e1 / 0.8e1 * t5 * t574 * t286 + t1096 / 0.4e1 - 0.3e1 / 0.4e1 * t1170 - 0.9e1 / 0.8e1 * t5 * t238 * t641 - t1021 + t1107 / 0.4e1 - 0.3e1 / 0.8e1 * t1178 - 0.3e1 / 0.8e1 * t5 * t87 * t1313);
  tv3rho33 = 0.3e1 * t564 + 0.3e1 * t646 + t6 * (t1205 + t1318);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1326 = t5 * t380 * t322;
  t1333 = t5 * t389 * t322 / 0.12e2;
  t1335 = t5 * t144 * t692;
  t1337 = t151 * t398;
  t1345 = t409 * t154;
  t1348 = t406 / t37 / t1345;
  t1349 = t912 * t1348;
  t1351 = t408 * t28 * t920;
  t1357 = t929 * t422;
  t1360 = 0.8e1 / 0.9e1 * t59 * t1357 * t305;
  t1363 = 0.2e1 / 0.3e1 * t59 * t423 * t305;
  t1364 = -0.65e2 / 0.648e3 * t149 * t1337 * t298 + 0.17e2 / 0.864e3 * t407 * t411 * t152 * t43 - t1349 * t1351 / 0.7776e4 + 0.11e2 / 0.27e2 * t46 * t33 * t417 - t1360 - t1363;
  t1366 = t672 * t175;
  t1369 = t309 * t435;
  t1378 = t320 * t437;
  t1381 = t690 * t197;
  t1384 = t320 * t460;
  t1392 = t450 * t398;
  t1396 = t406 * t411 * params->a;
  t1397 = t976 * t980;
  t1398 = t1397 * t152;
  t1401 = 0.7e1 / 0.54e2 * t312 * t443 + 0.37e2 / 0.9e1 * t183 * t417 * t317 - 0.62e2 / 0.3e1 * t1392 * t687 + 0.288e3 * t1396 * t1398 + t1360 + t1363;
  t1403 = t1364 * t73 - 0.2e1 * t1366 * t197 + 0.2e1 * t1369 * t437 - 0.6e1 * t952 * t1378 + 0.4e1 * t436 * t1381 + 0.2e1 * t436 * t1384 - t176 * t1401 - t942 * t320 - 0.2e1 * t431 * t690 - t674 * t460 + 0.4e1 * t945 * t677;
  t1408 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t376 * t322 - t1326 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t692 + t1333 - t1335 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1403);
  tv3rho2sigma0 = t6 * t1408 + 0.2e1 * t697;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1415 = t5 * t483 * t354;
  t1419 = t5 * t487 * t354 / 0.12e2;
  t1421 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t479 * t354 - t1415 / 0.4e1 + t1419);
  tv3rho2sigma2 = t6 * t1421 + 0.2e1 * t706;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1427 = t5 * t508 * t322;
  t1435 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t504 * t322 - t1427 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t227 * t692 - t1326 / 0.8e1 + t1333 - t1335 / 0.8e1);
  tv3rho2sigma3 = t6 * t1435 + t697 + t712;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1441 = t5 * t531 * t354;
  t1448 = t5 * t214 * t753;
  t1451 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t527 * t354 - t1441 / 0.8e1 - t1415 / 0.8e1 + t1419 - 0.3e1 / 0.8e1 * t5 * t210 * t753 - t1448 / 0.8e1);
  tv3rho2sigma5 = t6 * t1451 + t706 + t758;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1459 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t558 * t322 - t1427 / 0.4e1 + t1333);
  tv3rho2sigma6 = t6 * t1459 + 0.2e1 * t712;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1470 = t151 * t585;
  t1478 = t591 * t244;
  t1481 = t406 / t91 / t1478;
  t1482 = t912 * t1481;
  t1484 = t590 * t28 * t1251;
  t1490 = t929 * t603;
  t1493 = 0.8e1 / 0.9e1 * t110 * t1490 * t338;
  t1496 = 0.2e1 / 0.3e1 * t110 * t604 * t338;
  t1497 = -0.65e2 / 0.648e3 * t149 * t1470 * t331 + 0.17e2 / 0.864e3 * t407 * t593 * t242 * t97 - t1482 * t1484 / 0.7776e4 + 0.11e2 / 0.27e2 * t100 * t33 * t599 - t1493 - t1496;
  t1499 = t734 * t265;
  t1502 = t342 * t616;
  t1511 = t352 * t618;
  t1514 = t751 * t284;
  t1517 = t352 * t639;
  t1525 = t450 * t585;
  t1529 = t406 * t593 * params->a;
  t1530 = t976 * t1307;
  t1531 = t1530 * t242;
  t1534 = 0.7e1 / 0.54e2 * t345 * t624 + 0.37e2 / 0.9e1 * t183 * t599 * t349 - 0.62e2 / 0.3e1 * t1525 * t748 + 0.288e3 * t1529 * t1531 + t1493 + t1496;
  t1536 = t1497 * t123 - t1272 * t352 + 0.4e1 * t1275 * t739 - 0.6e1 * t1282 * t1511 - 0.2e1 * t1499 * t284 + 0.2e1 * t1502 * t618 + 0.4e1 * t617 * t1514 + 0.2e1 * t617 * t1517 - t266 * t1534 - 0.2e1 * t612 * t751 - t736 * t639;
  t1541 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t574 * t354 - t1441 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t238 * t753 + t1419 - t1448 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * t1536);
  tv3rho2sigma8 = t6 * t1541 + 0.2e1 * t758;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1548 = t5 * t144 * t798 / 0.8e1;
  t1555 = t406 / t37 / t905;
  t1556 = t912 * t1555;
  t1557 = t152 * t43;
  t1558 = t183 * t1557;
  t1564 = t929 * t168;
  t1567 = t59 * t1564 * t768 / 0.3e1;
  t1570 = 0.2e1 / 0.3e1 * t59 * t668 * t768;
  t1571 = -0.5e1 / 0.864e3 * t407 * t660 * t43 * sigma[0] + t1556 * t1558 / 0.20736e5 + t149 * t655 * t43 / 0.54e2 + t1567 - t1570;
  t1573 = t775 * t175;
  t1583 = t779 * t197;
  t1586 = t320 * t690;
  t1590 = t796 * t197;
  t1599 = t406 * t660;
  t1601 = t1397 * sigma[0];
  t1604 = t784 * t180 / 0.36e2 - t787 * t194 / 0.6e1 + 0.5e1 * t684 * t793 - 0.108e3 * t1599 * params->a * t1601 - t1567 + t1570;
  t1606 = -0.2e1 * t1366 * t320 + 0.4e1 * t1369 * t677 + t1571 * t73 - t1573 * t197 - 0.6e1 * t952 * t1583 + 0.4e1 * t436 * t1586 + 0.2e1 * t436 * t1590 - t176 * t1604 - t431 * t796 - 0.2e1 * t674 * t690 + 0.2e1 * t945 * t779;
  t1611 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t798 - t1548 - 0.3e1 / 0.8e1 * t5 * t27 * t1606);
  tv3rhosigma20 = t6 * t1611 + t802;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1618 = t5 * t214 * t841 / 0.8e1;
  t1620 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t210 * t841 - t1618);
  tv3rhosigma25 = t6 * t1620 + t845;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1626 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t227 * t798 - t1548);
  tv3rhosigma26 = t6 * t1626 + t802;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1637 = t406 / t91 / t1238;
  t1638 = t912 * t1637;
  t1639 = t242 * t97;
  t1640 = t183 * t1639;
  t1646 = t929 * t258;
  t1649 = t110 * t1646 * t811 / 0.3e1;
  t1652 = 0.2e1 / 0.3e1 * t110 * t730 * t811;
  t1653 = -0.5e1 / 0.864e3 * t407 * t722 * t97 * sigma[2] + t1638 * t1640 / 0.20736e5 + t149 * t717 * t97 / 0.54e2 + t1649 - t1652;
  t1655 = t818 * t265;
  t1665 = t822 * t284;
  t1668 = t352 * t751;
  t1672 = t839 * t284;
  t1681 = t406 * t722;
  t1683 = t1530 * sigma[2];
  t1686 = t827 * t270 / 0.36e2 - t830 * t281 / 0.6e1 + 0.5e1 * t746 * t836 - 0.108e3 * t1681 * params->a * t1683 - t1649 + t1652;
  t1688 = t1653 * t123 + 0.2e1 * t1275 * t822 - 0.6e1 * t1282 * t1665 - 0.2e1 * t1499 * t352 + 0.4e1 * t1502 * t739 - t1655 * t284 + 0.4e1 * t617 * t1668 + 0.2e1 * t617 * t1672 - t266 * t1686 - t612 * t839 - 0.2e1 * t736 * t751;
  t1693 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t238 * t841 - t1618 - 0.3e1 / 0.8e1 * t5 * t87 * t1688);
  tv3rhosigma211 = t6 * t1693 + t845;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1696 = 0.1e1 / t37 / t410;
  t1697 = t406 * t1696;
  t1699 = t183 * t298;
  t1702 = t406 * t760;
  t1706 = 0.1e1 / t408;
  t1709 = t59 * t929 * t1706 / 0.8e1;
  t1712 = 0.3e1 / 0.4e1 * t59 * t421 * t1706;
  t1714 = t59 * params->expo * t1706;
  t1715 = -t912 * t1697 * t1699 / 0.55296e5 + t404 * t1702 * t43 / 0.768e3 - t1709 + t1712 - t1714;
  t1723 = t779 * t320;
  t1726 = t320 * t796;
  t1731 = t51 / t52 / t152;
  t1734 = t183 * t768;
  t1737 = t450 * t305;
  t1738 = t296 * params->a;
  t1739 = t1738 * t456;
  t1744 = t1731 * t69 / 0.32e2 - 0.3e1 / 0.16e2 * t1734 * t789 - 0.3e1 / 0.8e1 * t1737 * t1739 + 0.81e2 / 0.2e1 * t1702 * t981 + t1709 - t1712 + t1714;
  t1746 = 0.6e1 * t1369 * t779 - 0.3e1 * t1573 * t320 + t1715 * t73 - 0.6e1 * t952 * t1723 + 0.6e1 * t436 * t1726 - t176 * t1744 - 0.3e1 * t674 * t796;
  t1750 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1746);
  tv3sigma30 = t6 * t1750;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1752 = 0.1e1 / t91 / t592;
  t1753 = t406 * t1752;
  t1755 = t183 * t331;
  t1758 = t406 * t803;
  t1762 = 0.1e1 / t590;
  t1765 = t110 * t929 * t1762 / 0.8e1;
  t1768 = 0.3e1 / 0.4e1 * t110 * t421 * t1762;
  t1770 = t110 * params->expo * t1762;
  t1771 = -t912 * t1753 * t1755 / 0.55296e5 + t404 * t1758 * t97 / 0.768e3 - t1765 + t1768 - t1770;
  t1779 = t822 * t352;
  t1782 = t352 * t839;
  t1787 = t51 / t103 / t242;
  t1790 = t183 * t811;
  t1793 = t450 * t338;
  t1794 = t329 * params->a;
  t1795 = t1794 * t635;
  t1800 = t1787 * t119 / 0.32e2 - 0.3e1 / 0.16e2 * t1790 * t832 - 0.3e1 / 0.8e1 * t1793 * t1795 + 0.81e2 / 0.2e1 * t1758 * t1308 + t1765 - t1768 + t1770;
  t1802 = t1771 * t123 - 0.6e1 * t1282 * t1779 + 0.6e1 * t1502 * t822 - 0.3e1 * t1655 * t352 + 0.6e1 * t617 * t1782 - t266 * t1800 - 0.3e1 * t736 * t839;
  t1806 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t1802);
  tv3sigma39 = t6 * t1806;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1813 = t5 * t870 * t199;
  t1819 = t5 * t877 * t199;
  t1821 = t5 * t380 * t462;
  t1827 = t5 * t889 * t199;
  t1830 = t5 * t389 * t462;
  t1833 = t5 * t144 * t986;
  t1836 = 0.1e1 / t36 / t659;
  t1841 = 0.1e1 / t1345;
  t1846 = t409 * t155;
  t1848 = 0.1e1 / t37 / t1846;
  t1853 = t403 * t403;
  t1854 = params->d * t1853;
  t1858 = t409 * t409;
  t1863 = t151 * t43;
  t1868 = 0.1e1 / t37 / t155;
  t1872 = t421 * t421;
  t1873 = 0.1e1 / t154;
  t1876 = 0.256e3 / 0.81e2 * t59 * t1872 * t1873;
  t1879 = 0.128e3 / 0.9e1 * t59 * t929 * t1873;
  t1882 = 0.176e3 / 0.9e1 * t59 * t421 * t1873;
  t1885 = 0.8e1 * t59 * params->expo * t1873;
  t1888 = t940 * t175;
  t1891 = t429 * t435;
  t1896 = t172 * t951;
  t1905 = t60 / t950 / t72;
  t1906 = t437 * t437;
  t1912 = t460 * t460;
  t1934 = t975 * t453;
  t1937 = 0.1e1 / t191 / t978 / t190;
  t1939 = t1934 * t1937 * t183;
  t1944 = (-0.3047e4 / 0.972e3 * t149 * t153 * t1836 * t43 + 0.2563e4 / 0.2916e4 * t407 * t408 * t1841 * t43 - 0.49e2 / 0.4374e4 * t915 * t1848 * t28 * t920 + t1854 * t406 * t913 * sigma[0] / t36 / t1858 / rho[0] * t49 * t1863 / 0.26244e5 + 0.2618e4 / 0.243e3 * t46 * t34 * t1868 - t1876 - t1879 - t1882 - t1885) * t73 - 0.4e1 * t1888 * t197 + 0.12e2 * t1891 * t437 - 0.6e1 * t942 * t460 - 0.24e2 * t1896 * t953 + 0.24e2 * t945 * t956 - 0.4e1 * t431 * t984 + 0.24e2 * t1905 * t1906 - 0.36e2 * t952 * t437 * t460 + 0.6e1 * t436 * t1912 + 0.8e1 * t436 * t197 * t984 - t176 * (0.91e3 / 0.243e3 * t61 * t1738 * t68 + 0.2884e4 / 0.27e2 * t184 * t1868 * params->a * t193 - 0.18608e5 / 0.27e2 * t451 * t1836 * params->a * t456 + 0.1792e5 * t973 * t1841 * t981 - 0.3072e5 * t914 * t1848 * params->a * t1939 + t1876 + t1879 + t1882 + t1885);
  t1950 = t5 * t865 * t143 * t75;
  t1954 = t5 * t375 * t388 * t75;
  t1958 = t5 * t137 * t888 * t75;
  t1961 = 0.1e1 / t142 / t366;
  t1965 = 0.1e2 / 0.27e2 * t5 * t25 * t1961 * t75;
  t1966 = t19 * t19;
  t1968 = 0.1e1 / t361 / t1966;
  t1969 = t363 * t363;
  t1975 = t371 * t371;
  t1982 = t16 / t856 / t6;
  t1984 = -0.24e2 * t857 + 0.24e2 * t1982;
  t1985 = my_piecewise5(t10, 0, t14, 0, t1984);
  t1989 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1968 * t1969 - 0.16e2 / 0.9e1 * t849 * t363 * t371 + 0.4e1 / 0.3e1 * t362 * t1975 + 0.16e2 / 0.9e1 * t853 * t861 + 0.4e1 / 0.3e1 * t23 * t1985);
  t1994 = -0.3e1 / 0.2e1 * t5 * t866 * t199 - 0.3e1 / 0.2e1 * t1813 - 0.9e1 / 0.4e1 * t5 * t376 * t462 + t1819 - 0.3e1 / 0.2e1 * t1821 - 0.3e1 / 0.2e1 * t5 * t138 * t986 - 0.5e1 / 0.9e1 * t1827 + t1830 / 0.2e1 - t1833 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1944 - t1950 / 0.2e1 + t1954 / 0.2e1 - 0.5e1 / 0.9e1 * t1958 + t1965 - 0.3e1 / 0.8e1 * t5 * t1989 * t26 * t75;
  t1995 = my_piecewise3(t1, 0, t1994);
  t1996 = t82 * t82;
  t1998 = 0.1e1 / t468 / t1996;
  t1999 = t470 * t470;
  t2005 = t474 * t474;
  t2011 = my_piecewise5(t14, 0, t10, 0, -t1984);
  t2015 = my_piecewise3(t83, 0, 0.4e2 / 0.81e2 * t1998 * t1999 - 0.16e2 / 0.9e1 * t993 * t470 * t474 + 0.4e1 / 0.3e1 * t469 * t2005 + 0.16e2 / 0.9e1 * t997 * t1001 + 0.4e1 / 0.3e1 * t84 * t2011);
  t2022 = t5 * t1005 * t143 * t125;
  t2026 = t5 * t478 * t388 * t125;
  t2030 = t5 * t209 * t888 * t125;
  t2035 = 0.1e2 / 0.27e2 * t5 * t86 * t1961 * t125;
  t2037 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t2015 * t26 * t125 - t2022 / 0.2e1 + t2026 / 0.2e1 - 0.5e1 / 0.9e1 * t2030 + t2035);
  tv4rho40 = 0.4e1 * t991 + 0.4e1 * t1023 + t6 * (t1995 + t2037);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2058 = 0.12e2 * t857;
  t2059 = 0.24e2 * t1982;
  t2060 = -t2058 + t2059;
  t2061 = my_piecewise5(t10, 0, t14, 0, t2060);
  t2065 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1968 * t223 * t850 - 0.8e1 / 0.9e1 * t849 * t499 * t363 - 0.8e1 / 0.9e1 * t1028 * t134 * t371 + 0.4e1 / 0.3e1 * t362 * t1039 * t134 + 0.4e1 / 0.3e1 * t1031 * t371 + 0.4e1 / 0.9e1 * t495 * t861 + 0.4e1 / 0.3e1 * t23 * t2061);
  t2074 = t5 * t1048 * t199;
  t2080 = t5 * t1055 * t199;
  t2081 = t2080 / 0.4e1;
  t2083 = t5 * t508 * t462;
  t2096 = t5 * t1043 * t143 * t75;
  t2100 = t5 * t503 * t388 * t75;
  t2101 = t2100 / 0.4e1;
  t2104 = t5 * t226 * t888 * t75;
  t2109 = -0.3e1 / 0.8e1 * t5 * t2065 * t26 * t75 - 0.9e1 / 0.8e1 * t5 * t1044 * t199 - 0.3e1 / 0.4e1 * t2074 - 0.9e1 / 0.8e1 * t5 * t504 * t462 + t2081 - 0.3e1 / 0.8e1 * t2083 - 0.3e1 / 0.8e1 * t5 * t227 * t986 - 0.3e1 / 0.8e1 * t1813 + t1819 / 0.2e1 - 0.3e1 / 0.8e1 * t1821 - 0.5e1 / 0.12e2 * t1827 + t1830 / 0.4e1 - t1833 / 0.8e1 - 0.3e1 / 0.8e1 * t2096 + t2101 - 0.5e1 / 0.36e2 * t2104 - t1950 / 0.8e1 + t1954 / 0.4e1 - 0.5e1 / 0.12e2 * t1958 + t1965;
  t2110 = my_piecewise3(t1, 0, t2109);
  t2128 = my_piecewise5(t14, 0, t10, 0, -t2060);
  t2132 = my_piecewise3(t83, 0, 0.4e2 / 0.81e2 * t1998 * t234 * t994 - 0.8e1 / 0.9e1 * t993 * t522 * t470 - 0.8e1 / 0.9e1 * t1072 * t206 * t474 + 0.4e1 / 0.3e1 * t469 * t1081 * t206 + 0.4e1 / 0.3e1 * t1075 * t474 + 0.4e1 / 0.9e1 * t519 * t1001 + 0.4e1 / 0.3e1 * t84 * t2128);
  t2139 = t5 * t1085 * t143 * t125;
  t2143 = t5 * t526 * t388 * t125;
  t2144 = t2143 / 0.4e1;
  t2147 = t5 * t237 * t888 * t125;
  t2156 = t5 * t1010 * t286;
  t2159 = t5 * t1014 * t286;
  t2160 = t2159 / 0.4e1;
  t2162 = t5 * t1018 * t286;
  t2164 = -0.3e1 / 0.8e1 * t5 * t2132 * t26 * t125 - 0.3e1 / 0.8e1 * t2139 + t2144 - 0.5e1 / 0.36e2 * t2147 - t2022 / 0.8e1 + t2026 / 0.4e1 - 0.5e1 / 0.12e2 * t2030 + t2035 - 0.3e1 / 0.8e1 * t5 * t1006 * t286 - 0.3e1 / 0.8e1 * t2156 + t2160 - 0.5e1 / 0.36e2 * t2162;
  t2165 = my_piecewise3(t80, 0, t2164);
  tv4rho41 = t991 + t1023 + 0.3e1 * t1071 + 0.3e1 * t1110 + t6 * (t2110 + t2165);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2180 = t499 * t499;
  t2193 = my_piecewise5(t10, 0, t14, 0, t2059);
  t2197 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1968 * t548 * t363 - 0.32e2 / 0.27e2 * t1028 * t134 * t499 - 0.8e1 / 0.27e2 * t1113 * t371 + 0.8e1 / 0.9e1 * t362 * t2180 + 0.8e1 / 0.9e1 * t495 * t1039 - 0.8e1 / 0.27e2 * t849 * t553 * t363 + 0.8e1 / 0.9e1 * t362 * t1122 * t134 + 0.4e1 / 0.9e1 * t1118 * t371 + 0.4e1 / 0.3e1 * t23 * t2193);
  t2206 = t5 * t1131 * t199;
  t2219 = t5 * t1126 * t143 * t75;
  t2223 = t5 * t557 * t388 * t75;
  t2230 = -0.3e1 / 0.8e1 * t5 * t2197 * t26 * t75 - 0.3e1 / 0.4e1 * t5 * t1127 * t199 - t2206 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t558 * t462 - t2074 / 0.2e1 + t2080 / 0.3e1 - t2083 / 0.4e1 + t1819 / 0.6e1 - 0.5e1 / 0.18e2 * t1827 + t1830 / 0.12e2 - t2219 / 0.4e1 + t2223 / 0.12e2 - t2096 / 0.4e1 + t2100 / 0.3e1 - 0.5e1 / 0.18e2 * t2104 + t1954 / 0.12e2 - 0.5e1 / 0.18e2 * t1958 + t1965;
  t2231 = my_piecewise3(t1, 0, t2230);
  t2240 = t522 * t522;
  t2253 = my_piecewise5(t14, 0, t10, 0, -t2059);
  t2257 = my_piecewise3(t83, 0, 0.4e2 / 0.81e2 * t1998 * t565 * t470 - 0.32e2 / 0.27e2 * t1072 * t206 * t522 - 0.8e1 / 0.27e2 * t1143 * t474 + 0.8e1 / 0.9e1 * t469 * t2240 + 0.8e1 / 0.9e1 * t519 * t1081 - 0.8e1 / 0.27e2 * t993 * t569 * t470 + 0.8e1 / 0.9e1 * t469 * t1152 * t206 + 0.4e1 / 0.9e1 * t1148 * t474 + 0.4e1 / 0.3e1 * t84 * t2253);
  t2264 = t5 * t1156 * t143 * t125;
  t2268 = t5 * t573 * t388 * t125;
  t2277 = t5 * t1090 * t286;
  t2280 = t5 * t1094 * t286;
  t2291 = t5 * t483 * t641;
  t2294 = t5 * t487 * t641;
  t2296 = -0.3e1 / 0.8e1 * t5 * t2257 * t26 * t125 - t2264 / 0.4e1 + t2268 / 0.12e2 - t2139 / 0.4e1 + t2143 / 0.3e1 - 0.5e1 / 0.18e2 * t2147 - 0.3e1 / 0.4e1 * t5 * t1086 * t286 - t2277 / 0.2e1 + t2280 / 0.6e1 + t2026 / 0.12e2 - 0.5e1 / 0.18e2 * t2030 + t2035 - t2156 / 0.4e1 + t2159 / 0.3e1 - 0.5e1 / 0.18e2 * t2162 - 0.3e1 / 0.8e1 * t5 * t479 * t641 - t2291 / 0.4e1 + t2294 / 0.12e2;
  t2297 = my_piecewise3(t80, 0, t2296);
  tv4rho42 = 0.2e1 * t1071 + 0.2e1 * t1110 + 0.2e1 * t1142 + 0.2e1 * t1181 + t6 * (t2231 + t2297);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2317 = t2058 + t2059;
  t2318 = my_piecewise5(t10, 0, t14, 0, t2317);
  t2322 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1968 * t1186 * t134 - 0.8e1 / 0.9e1 * t1113 * t499 - 0.8e1 / 0.9e1 * t1028 * t553 * t134 + 0.4e1 / 0.3e1 * t1031 * t553 + 0.4e1 / 0.3e1 * t495 * t1122 + 0.4e1 / 0.9e1 * t362 * t1193 * t134 + 0.4e1 / 0.3e1 * t23 * t2318);
  t2329 = t5 * t1197 * t143 * t75;
  t2340 = -0.3e1 / 0.8e1 * t5 * t2322 * t26 * t75 - t2329 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1198 * t199 - 0.3e1 / 0.8e1 * t2219 + t2223 / 0.4e1 - 0.3e1 / 0.8e1 * t2206 + t2101 - 0.5e1 / 0.12e2 * t2104 + t2081 - 0.5e1 / 0.36e2 * t1958 + t1965 - 0.5e1 / 0.36e2 * t1827;
  t2341 = my_piecewise3(t1, 0, t2340);
  t2358 = my_piecewise5(t14, 0, t10, 0, -t2317);
  t2362 = my_piecewise3(t83, 0, 0.4e2 / 0.81e2 * t1998 * t1206 * t206 - 0.8e1 / 0.9e1 * t1143 * t522 - 0.8e1 / 0.9e1 * t1072 * t569 * t206 + 0.4e1 / 0.3e1 * t1075 * t569 + 0.4e1 / 0.3e1 * t519 * t1152 + 0.4e1 / 0.9e1 * t469 * t1212 * t206 + 0.4e1 / 0.3e1 * t84 * t2358);
  t2369 = t5 * t1216 * t143 * t125;
  t2377 = t5 * t1161 * t286;
  t2386 = t5 * t531 * t641;
  t2396 = t5 * t214 * t1313;
  t2398 = -0.3e1 / 0.8e1 * t5 * t2362 * t26 * t125 - t2369 / 0.8e1 - 0.3e1 / 0.8e1 * t2264 + t2268 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1157 * t286 - 0.3e1 / 0.8e1 * t2377 + t2144 - 0.5e1 / 0.12e2 * t2147 - 0.3e1 / 0.4e1 * t2277 + t2280 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t527 * t641 - 0.3e1 / 0.8e1 * t2386 - 0.5e1 / 0.36e2 * t2030 + t2035 + t2160 - 0.5e1 / 0.12e2 * t2162 - 0.3e1 / 0.8e1 * t2291 + t2294 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t210 * t1313 - t2396 / 0.8e1;
  t2399 = my_piecewise3(t80, 0, t2398);
  tv4rho43 = 0.3e1 * t1142 + 0.3e1 * t1181 + t1205 + t1318 + t6 * (t2341 + t2399);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2404 = t548 * t548;
  t2409 = t553 * t553;
  t2415 = 0.24e2 * t857 + 0.24e2 * t1982;
  t2416 = my_piecewise5(t10, 0, t14, 0, t2415);
  t2420 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1968 * t2404 - 0.16e2 / 0.9e1 * t1113 * t553 + 0.4e1 / 0.3e1 * t362 * t2409 + 0.16e2 / 0.9e1 * t495 * t1193 + 0.4e1 / 0.3e1 * t23 * t2416);
  t2429 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2420 * t26 * t75 - t2329 / 0.2e1 + t2223 / 0.2e1 - 0.5e1 / 0.9e1 * t2104 + t1965);
  t2434 = 0.1e1 / t90 / t721;
  t2439 = 0.1e1 / t1478;
  t2444 = t591 * t245;
  t2446 = 0.1e1 / t91 / t2444;
  t2454 = t591 * t591;
  t2459 = t151 * t97;
  t2464 = 0.1e1 / t91 / t245;
  t2468 = 0.1e1 / t244;
  t2471 = 0.256e3 / 0.81e2 * t110 * t1872 * t2468;
  t2474 = 0.128e3 / 0.9e1 * t110 * t929 * t2468;
  t2477 = 0.176e3 / 0.9e1 * t110 * t421 * t2468;
  t2480 = 0.8e1 * t110 * params->expo * t2468;
  t2483 = t1270 * t265;
  t2486 = t610 * t616;
  t2491 = t262 * t1281;
  t2500 = t111 / t1280 / t122;
  t2501 = t618 * t618;
  t2507 = t639 * t639;
  t2531 = 0.1e1 / t278 / t1305 / t277;
  t2533 = t1934 * t2531 * t183;
  t2538 = (-0.3047e4 / 0.972e3 * t149 * t243 * t2434 * t97 + 0.2563e4 / 0.2916e4 * t407 * t590 * t2439 * t97 - 0.49e2 / 0.4374e4 * t1246 * t2446 * t28 * t1251 + t1854 * t406 * t1244 * sigma[2] / t90 / t2454 / rho[1] * t49 * t2459 / 0.26244e5 + 0.2618e4 / 0.243e3 * t100 * t88 * t2464 - t2471 - t2474 - t2477 - t2480) * t123 - 0.4e1 * t2483 * t284 + 0.12e2 * t2486 * t618 - 0.6e1 * t1272 * t639 - 0.24e2 * t2491 * t1283 + 0.24e2 * t1275 * t1286 - 0.4e1 * t612 * t1311 + 0.24e2 * t2500 * t2501 - 0.36e2 * t1282 * t618 * t639 + 0.6e1 * t617 * t2507 + 0.8e1 * t617 * t284 * t1311 - t266 * (0.91e3 / 0.243e3 * t112 * t1794 * t118 + 0.2884e4 / 0.27e2 * t273 * t2464 * params->a * t280 - 0.18608e5 / 0.27e2 * t631 * t2434 * params->a * t635 + 0.1792e5 * t1303 * t2439 * t1308 - 0.3072e5 * t1245 * t2446 * params->a * t2533 + t2471 + t2474 + t2477 + t2480);
  t2542 = t565 * t565;
  t2547 = t569 * t569;
  t2553 = my_piecewise5(t14, 0, t10, 0, -t2415);
  t2557 = my_piecewise3(t83, 0, 0.4e2 / 0.81e2 * t1998 * t2542 - 0.16e2 / 0.9e1 * t1143 * t569 + 0.4e1 / 0.3e1 * t469 * t2547 + 0.16e2 / 0.9e1 * t519 * t1212 + 0.4e1 / 0.3e1 * t84 * t2553);
  t2576 = -0.3e1 / 0.2e1 * t5 * t238 * t1313 - 0.3e1 / 0.8e1 * t5 * t87 * t2538 - 0.3e1 / 0.8e1 * t5 * t2557 * t26 * t125 - 0.3e1 / 0.2e1 * t5 * t1217 * t286 - 0.9e1 / 0.4e1 * t5 * t574 * t641 - t2369 / 0.2e1 - 0.3e1 / 0.2e1 * t2377 - 0.3e1 / 0.2e1 * t2386 - t2396 / 0.2e1 + t2268 / 0.2e1 + t2280 + t2294 / 0.2e1 - 0.5e1 / 0.9e1 * t2162 - 0.5e1 / 0.9e1 * t2147 + t2035;
  t2577 = my_piecewise3(t80, 0, t2576);
  tv4rho44 = 0.4e1 * t1205 + 0.4e1 * t1318 + t6 * (t2429 + t2577);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t2585 = t5 * t870 * t322;
  t2591 = t5 * t877 * t322;
  t2594 = t5 * t380 * t692;
  t2601 = 0.5e1 / 0.36e2 * t5 * t889 * t322;
  t2603 = t5 * t389 * t692;
  t2606 = t5 * t144 * t1403;
  t2616 = t1364 * t175;
  t2639 = t406 * t918;
  t2640 = params->a * t1934;
  t2649 = 0.32e2 / 0.27e2 * t59 * t1872 * t930 * t305;
  t2652 = 0.8e1 / 0.3e1 * t59 * t931 * t305;
  t2655 = 0.4e1 / 0.3e1 * t59 * t934 * t305;
  t2659 = t672 * t435;
  t2662 = t309 * t951;
  t2709 = 0.6e1 * t2659 * t437 - 0.6e1 * t2662 * t953 + 0.6e1 * t1369 * t956 + 0.6e1 * t1891 * t677 + 0.12e2 * t945 * t1381 + 0.6e1 * t945 * t1384 - 0.18e2 * t952 * t690 * t437 + 0.6e1 * t436 * t1401 * t197 + 0.6e1 * t436 * t690 * t460 + 0.2e1 * t436 * t320 * t984 + (0.253e3 / 0.324e3 * t149 * t151 * t900 * t298 - 0.1025e4 / 0.3888e4 * t407 * t906 * t152 * t43 + 0.89e2 / 0.23328e5 * t912 * t2639 * t1351 - t1854 * t406 / t36 / t1858 * t913 * t49 * t1863 / 0.69984e5 - 0.154e3 / 0.81e2 * t46 * t33 * t925 + t2649 + t2652 + t2655) * t73;
  t2715 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t866 * t322 - 0.3e1 / 0.8e1 * t2585 - 0.9e1 / 0.8e1 * t5 * t376 * t692 + t2591 / 0.4e1 - 0.3e1 / 0.4e1 * t2594 - 0.9e1 / 0.8e1 * t5 * t138 * t1403 - t2601 + t2603 / 0.4e1 - 0.3e1 / 0.8e1 * t2606 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.18e2 * t1896 * t1378 + 0.24e2 * t1905 * t320 * t953 - 0.18e2 * t952 * t677 * t460 - 0.3e1 * t2616 * t197 - 0.3e1 * t1366 * t460 - t674 * t984 - t1888 * t320 - 0.3e1 * t942 * t690 - 0.3e1 * t431 * t1401 - t176 * (-0.35e2 / 0.81e2 * t312 * t962 - 0.182e3 / 0.9e1 * t183 * t925 * t317 + 0.166e4 / 0.9e1 * t450 * t900 * t687 - 0.5856e4 * t406 * t906 * params->a * t1398 + 0.1152e5 * t2639 * t2640 * t1937 * t408 * t183 - t2649 - t2652 - t2655) + t2709));
  tv4rho3sigma0 = t6 * t2715 + 0.3e1 * t1408;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t2722 = t5 * t1010 * t354;
  t2725 = t5 * t1014 * t354;
  t2729 = 0.5e1 / 0.36e2 * t5 * t1018 * t354;
  t2731 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t1006 * t354 - 0.3e1 / 0.8e1 * t2722 + t2725 / 0.4e1 - t2729);
  tv4rho3sigma2 = t6 * t2731 + 0.3e1 * t1421;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t2733 = 0.2e1 * t1435;
  t2739 = t5 * t1048 * t322 / 0.4e1;
  t2744 = t5 * t1055 * t322;
  t2748 = t5 * t508 * t692 / 0.4e1;
  t2757 = -0.3e1 / 0.8e1 * t5 * t1044 * t322 - t2739 - 0.3e1 / 0.4e1 * t5 * t504 * t692 + t2744 / 0.12e2 - t2748 - 0.3e1 / 0.8e1 * t5 * t227 * t1403 - t2585 / 0.8e1 + t2591 / 0.6e1 - t2594 / 0.4e1 - t2601 + t2603 / 0.6e1 - t2606 / 0.8e1;
  t2758 = my_piecewise3(t1, 0, t2757);
  tv4rho3sigma3 = t6 * t2758 + t1408 + t2733;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t2760 = 0.2e1 * t1451;
  t2766 = t5 * t1090 * t354 / 0.4e1;
  t2768 = t5 * t1094 * t354;
  t2777 = t5 * t483 * t753 / 0.4e1;
  t2779 = t5 * t487 * t753;
  t2782 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t1086 * t354 - t2766 + t2768 / 0.12e2 - t2722 / 0.8e1 + t2725 / 0.6e1 - t2729 - 0.3e1 / 0.8e1 * t5 * t479 * t753 - t2777 + t2779 / 0.12e2);
  tv4rho3sigma5 = t6 * t2782 + t1421 + t2760;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2788 = t5 * t1131 * t322;
  t2797 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1127 * t322 - t2788 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t558 * t692 - t2739 + t2744 / 0.6e1 - t2748 + t2591 / 0.12e2 - t2601 + t2603 / 0.12e2);
  tv4rho3sigma6 = t6 * t2797 + t1459 + t2733;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2803 = t5 * t1161 * t354;
  t2810 = t5 * t531 * t753;
  t2818 = t5 * t214 * t1536;
  t2820 = -0.3e1 / 0.8e1 * t5 * t1157 * t354 - t2803 / 0.8e1 - t2766 + t2768 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t527 * t753 - t2810 / 0.4e1 + t2725 / 0.12e2 - t2729 - t2777 + t2779 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t210 * t1536 - t2818 / 0.8e1;
  t2821 = my_piecewise3(t80, 0, t2820);
  tv4rho3sigma8 = t6 * t2821 + t1541 + t2760;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2830 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1198 * t322 - 0.3e1 / 0.8e1 * t2788 + t2744 / 0.4e1 - t2601);
  tv4rho3sigma9 = t6 * t2830 + 0.3e1 * t1459;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2855 = t1497 * t265;
  t2878 = t406 * t1249;
  t2887 = 0.32e2 / 0.27e2 * t110 * t1872 * t1260 * t338;
  t2890 = 0.8e1 / 0.3e1 * t110 * t1261 * t338;
  t2893 = 0.4e1 / 0.3e1 * t110 * t1264 * t338;
  t2897 = t734 * t616;
  t2900 = t342 * t1281;
  t2947 = 0.6e1 * t2897 * t618 - 0.6e1 * t2900 * t1283 + 0.6e1 * t1502 * t1286 + 0.6e1 * t2486 * t739 + 0.12e2 * t1275 * t1514 + 0.6e1 * t1275 * t1517 - 0.18e2 * t1282 * t751 * t618 + 0.6e1 * t617 * t1534 * t284 + 0.6e1 * t617 * t751 * t639 + 0.2e1 * t617 * t352 * t1311 + (0.253e3 / 0.324e3 * t149 * t151 * t1233 * t331 - 0.1025e4 / 0.3888e4 * t407 * t1239 * t242 * t97 + 0.89e2 / 0.23328e5 * t912 * t2878 * t1484 - t1854 * t406 / t90 / t2454 * t1244 * t49 * t2459 / 0.69984e5 - 0.154e3 / 0.81e2 * t100 * t33 * t1256 + t2887 + t2890 + t2893) * t123;
  t2953 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t1217 * t354 - 0.3e1 / 0.8e1 * t2803 - 0.9e1 / 0.8e1 * t5 * t574 * t753 + t2768 / 0.4e1 - 0.3e1 / 0.4e1 * t2810 - 0.9e1 / 0.8e1 * t5 * t238 * t1536 - t2729 + t2779 / 0.4e1 - 0.3e1 / 0.8e1 * t2818 - 0.3e1 / 0.8e1 * t5 * t87 * (-0.18e2 * t2491 * t1511 + 0.24e2 * t2500 * t352 * t1283 - 0.18e2 * t1282 * t739 * t639 - 0.3e1 * t2855 * t284 - 0.3e1 * t1499 * t639 - t736 * t1311 - t2483 * t352 - 0.3e1 * t1272 * t751 - 0.3e1 * t612 * t1534 - t266 * (-0.35e2 / 0.81e2 * t345 * t1292 - 0.182e3 / 0.9e1 * t183 * t1256 * t349 + 0.166e4 / 0.9e1 * t450 * t1233 * t748 - 0.5856e4 * t406 * t1239 * params->a * t1531 + 0.1152e5 * t2878 * t2640 * t2531 * t590 * t183 - t2887 - t2890 - t2893) + t2947));
  tv4rho3sigma11 = t6 * t2953 + 0.3e1 * t1541;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2960 = t5 * t380 * t798;
  t2967 = t5 * t389 * t798 / 0.12e2;
  t2969 = t5 * t144 * t1606;
  t3003 = 0.4e1 * t436 * t320 * t1401 + 0.4e1 * t436 * t1604 * t197 + 0.24e2 * t1905 * t779 * t437 + 0.2e1 * t436 * t796 * t460 - 0.6e1 * t952 * t796 * t437 - 0.6e1 * t952 * t779 * t460 + 0.8e1 * t1369 * t1381 + 0.4e1 * t1369 * t1384 - 0.12e2 * t2662 * t1378 - 0.12e2 * t1896 * t1583 + 0.8e1 * t945 * t1586 + 0.4e1 * t945 * t1590 + 0.8e1 * t2659 * t677;
  t3028 = 0.4e1 / 0.9e1 * t59 * t1872 * t422 * t768;
  t3031 = 0.5e1 / 0.9e1 * t59 * t1357 * t768;
  t3034 = 0.2e1 / 0.3e1 * t59 * t423 * t768;
  t3052 = t1571 * t175;
  t3067 = t775 * t435;
  t3070 = t690 * t690;
  t3073 = -0.24e2 * t952 * t677 * t690 + (0.167e3 / 0.2592e4 * t407 * t411 * t43 * sigma[0] - 0.25e2 / 0.20736e5 * t1349 * t1558 + t1854 * t406 / t36 / t409 / t396 * t450 * t408 * t43 / 0.186624e6 - 0.19e2 / 0.162e3 * t149 * t1337 * t43 - t3028 + t3031 + t3034) * t73 - t176 * (-0.7e1 / 0.108e3 * t784 * t443 + 0.7e1 / 0.18e2 * t787 * t447 - 0.33e2 * t1392 * t793 + 0.1692e4 * t1396 * t1601 - 0.432e4 * t1348 * t2640 * t1937 * t152 * t183 + t3028 - t3031 - t3034) - 0.2e1 * t3052 * t197 - t1573 * t460 - 0.2e1 * t2616 * t320 - 0.4e1 * t1366 * t690 - 0.2e1 * t674 * t1401 + 0.2e1 * t1891 * t779 - t942 * t796 - 0.2e1 * t431 * t1604 + 0.2e1 * t3067 * t437 + 0.4e1 * t436 * t3070;
  t3079 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t376 * t798 - t2960 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t1606 + t2967 - t2969 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t3003 + t3073));
  tv4rho2sigma20 = t6 * t3079 + 0.2e1 * t1611;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t3086 = t5 * t483 * t841;
  t3090 = t5 * t487 * t841 / 0.12e2;
  t3092 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t479 * t841 - t3086 / 0.4e1 + t3090);
  tv4rho2sigma25 = t6 * t3092 + 0.2e1 * t1620;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t3098 = t5 * t508 * t798;
  t3106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t504 * t798 - t3098 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t227 * t1606 - t2960 / 0.8e1 + t2967 - t2969 / 0.8e1);
  tv4rho2sigma26 = t6 * t3106 + t1611 + t1626;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t3112 = t5 * t531 * t841;
  t3119 = t5 * t214 * t1688;
  t3122 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t527 * t841 - t3112 / 0.8e1 - t3086 / 0.8e1 + t3090 - 0.3e1 / 0.8e1 * t5 * t210 * t1688 - t3119 / 0.8e1);
  tv4rho2sigma211 = t6 * t3122 + t1620 + t1693;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t3130 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t558 * t798 - t3098 / 0.4e1 + t2967);
  tv4rho2sigma212 = t6 * t3130 + 0.2e1 * t1626;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t3173 = -0.6e1 * t1282 * t822 * t639 - 0.24e2 * t1282 * t739 * t751 + 0.4e1 * t617 * t352 * t1534 + 0.4e1 * t617 * t1686 * t284 + 0.24e2 * t2500 * t822 * t618 + 0.2e1 * t617 * t839 * t639 + 0.8e1 * t1275 * t1668 + 0.4e1 * t1275 * t1672 + 0.8e1 * t1502 * t1514 + 0.4e1 * t1502 * t1517 - 0.12e2 * t2900 * t1511 - 0.12e2 * t2491 * t1665 + 0.8e1 * t2897 * t739;
  t3198 = 0.4e1 / 0.9e1 * t110 * t1872 * t603 * t811;
  t3201 = 0.5e1 / 0.9e1 * t110 * t1490 * t811;
  t3204 = 0.2e1 / 0.3e1 * t110 * t604 * t811;
  t3207 = t1653 * t265;
  t3237 = t818 * t616;
  t3240 = t751 * t751;
  t3243 = -0.6e1 * t1282 * t839 * t618 + (0.167e3 / 0.2592e4 * t407 * t593 * t97 * sigma[2] - 0.25e2 / 0.20736e5 * t1482 * t1640 + t1854 * t406 / t90 / t591 / t583 * t450 * t590 * t97 / 0.186624e6 - 0.19e2 / 0.162e3 * t149 * t1470 * t97 - t3198 + t3201 + t3204) * t123 - 0.2e1 * t3207 * t284 - t1655 * t639 - 0.2e1 * t2855 * t352 - 0.4e1 * t1499 * t751 - 0.2e1 * t736 * t1534 + 0.2e1 * t2486 * t822 - t1272 * t839 - 0.2e1 * t612 * t1686 - t266 * (-0.7e1 / 0.108e3 * t827 * t624 + 0.7e1 / 0.18e2 * t830 * t628 - 0.33e2 * t1525 * t836 + 0.1692e4 * t1529 * t1683 - 0.432e4 * t1481 * t2640 * t2531 * t242 * t183 + t3198 - t3201 - t3204) + 0.2e1 * t3237 * t618 + 0.4e1 * t617 * t3240;
  t3249 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t574 * t841 - t3112 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t238 * t1688 + t3090 - t3119 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t87 * (t3173 + t3243));
  tv4rho2sigma217 = t6 * t3249 + 0.2e1 * t1693;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t3256 = t5 * t144 * t1746 / 0.8e1;
  t3272 = t59 * t1872 * t168 * t1706 / 0.6e1;
  t3274 = t59 * t1564 * t1706;
  t3277 = 0.4e1 / 0.3e1 * t59 * t668 * t1706;
  t3280 = t1715 * t175;
  t3341 = -0.3e1 * t674 * t1604 - 0.6e1 * t1896 * t1723 + 0.24e2 * t1905 * t1723 * t197 - 0.18e2 * t952 * t779 * t690 + 0.6e1 * t945 * t1726 - 0.18e2 * t952 * t1726 * t197 + 0.6e1 * t436 * t690 * t796 + 0.6e1 * t436 * t320 * t1604 - t431 * t1744 + 0.2e1 * t436 * t1744 * t197 - t176 * (-t1731 * t180 / 0.24e2 + t1734 * t194 / 0.4e1 + t1737 * t157 * params->a * t456 / 0.2e1 - 0.378e3 * t1599 * t981 + 0.162e4 * t1555 * t2640 * t1937 * t28 * t34 - t3272 + t3274 - t3277);
  t3347 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t1746 - t3256 - 0.3e1 / 0.8e1 * t5 * t27 * ((0.7e1 / 0.20736e5 * t1556 * t1699 - t1854 * t406 / t36 / t1846 * t450 * t1557 / 0.497664e6 - t404 * t1599 * t43 / 0.96e2 + t3272 - t3274 + t3277) * t73 - t3280 * t197 - 0.3e1 * t3052 * t320 + 0.6e1 * t3067 * t677 - 0.3e1 * t1573 * t690 + 0.6e1 * t2659 * t779 - 0.18e2 * t2662 * t1583 + 0.12e2 * t1369 * t1586 - 0.3e1 * t1366 * t796 + 0.6e1 * t1369 * t1590 + t3341));
  tv4rhosigma30 = t6 * t3347 + t1750;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t3354 = t5 * t214 * t1802 / 0.8e1;
  t3356 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t210 * t1802 - t3354);
  tv4rhosigma39 = t6 * t3356 + t1806;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t3362 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t227 * t1746 - t3256);
  tv4rhosigma310 = t6 * t3362 + t1750;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t3382 = t110 * t1872 * t258 * t1762 / 0.6e1;
  t3384 = t110 * t1646 * t1762;
  t3387 = 0.4e1 / 0.3e1 * t110 * t730 * t1762;
  t3390 = t1771 * t265;
  t3451 = -0.3e1 * t736 * t1686 - 0.6e1 * t2491 * t1779 + 0.24e2 * t2500 * t1779 * t284 - 0.18e2 * t1282 * t822 * t751 + 0.6e1 * t1275 * t1782 - 0.18e2 * t1282 * t1782 * t284 + 0.6e1 * t617 * t751 * t839 + 0.6e1 * t617 * t352 * t1686 - t612 * t1800 + 0.2e1 * t617 * t1800 * t284 - t266 * (-t1787 * t270 / 0.24e2 + t1790 * t281 / 0.4e1 + t1793 * t247 * params->a * t635 / 0.2e1 - 0.378e3 * t1681 * t1308 + 0.162e4 * t1637 * t2640 * t2531 * t28 * t88 - t3382 + t3384 - t3387);
  t3457 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t238 * t1802 - t3354 - 0.3e1 / 0.8e1 * t5 * t87 * ((0.7e1 / 0.20736e5 * t1638 * t1755 - t1854 * t406 / t90 / t2444 * t450 * t1639 / 0.497664e6 - t404 * t1681 * t97 / 0.96e2 + t3382 - t3384 + t3387) * t123 - t3390 * t284 - 0.3e1 * t3207 * t352 + 0.6e1 * t3237 * t739 - 0.3e1 * t1655 * t751 + 0.6e1 * t2897 * t822 - 0.18e2 * t2900 * t1665 + 0.12e2 * t1502 * t1668 - 0.3e1 * t1499 * t839 + 0.6e1 * t1502 * t1672 + t3451));
  tv4rhosigma319 = t6 * t3457 + t1806;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t3466 = t912 * t406;
  t3471 = 0.1e1 / t913;
  t3474 = t59 * t1872 * t3471 / 0.16e2;
  t3477 = 0.3e1 / 0.4e1 * t59 * t929 * t3471;
  t3480 = 0.11e2 / 0.4e1 * t59 * t421 * t3471;
  t3483 = 0.3e1 * t59 * params->expo * t3471;
  t3498 = t779 * t779;
  t3504 = t796 * t796;
  t3530 = (t1854 * t406 / t36 / t916 * t450 * t298 / 0.1327104e7 - t3466 * t1696 * t28 * t920 / 0.13824e5 - t3474 + t3477 - t3480 + t3483) * t73 - 0.4e1 * t3280 * t320 + 0.12e2 * t3067 * t779 - 0.6e1 * t1573 * t796 - 0.24e2 * t2662 * t1723 + 0.24e2 * t1369 * t1726 - 0.4e1 * t674 * t1744 + 0.24e2 * t1905 * t3498 - 0.36e2 * t952 * t779 * t796 + 0.6e1 * t436 * t3504 + 0.8e1 * t436 * t320 * t1744 - t176 * (-0.5e1 / 0.64e2 * t51 / t52 / t408 * t69 + 0.15e2 / 0.32e2 * t183 * t1706 * t789 + 0.15e2 / 0.16e2 * t450 * t768 * t1739 + 0.81e2 / 0.4e1 * t406 * t305 * t760 * t981 - 0.1215e4 / 0.2e1 * t1697 * params->a * t1939 + t3474 - t3477 + t3480 - t3483);
  t3534 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t3530);
  tv4sigma40 = t6 * t3534;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t3546 = 0.1e1 / t1244;
  t3549 = t110 * t1872 * t3546 / 0.16e2;
  t3552 = 0.3e1 / 0.4e1 * t110 * t929 * t3546;
  t3555 = 0.11e2 / 0.4e1 * t110 * t421 * t3546;
  t3558 = 0.3e1 * t110 * params->expo * t3546;
  t3573 = t822 * t822;
  t3579 = t839 * t839;
  t3605 = (t1854 * t406 / t90 / t1247 * t450 * t331 / 0.1327104e7 - t3466 * t1752 * t28 * t1251 / 0.13824e5 - t3549 + t3552 - t3555 + t3558) * t123 - 0.4e1 * t3390 * t352 + 0.12e2 * t3237 * t822 - 0.6e1 * t1655 * t839 - 0.24e2 * t2900 * t1779 + 0.24e2 * t1502 * t1782 - 0.4e1 * t736 * t1800 + 0.24e2 * t2500 * t3573 - 0.36e2 * t1282 * t822 * t839 + 0.6e1 * t617 * t3579 + 0.8e1 * t617 * t352 * t1800 - t266 * (-0.5e1 / 0.64e2 * t51 / t103 / t590 * t119 + 0.15e2 / 0.32e2 * t183 * t1762 * t832 + 0.15e2 / 0.16e2 * t450 * t811 * t1795 + 0.81e2 / 0.4e1 * t406 * t338 * t803 * t1308 - 0.1215e4 / 0.2e1 * t1753 * params->a * t2533 + t3549 - t3552 + t3555 - t3558);
  t3609 = my_piecewise3(t80, 0, -0.3e1 / 0.8e1 * t5 * t87 * t3605);
  tv4sigma414 = t6 * t3609;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

