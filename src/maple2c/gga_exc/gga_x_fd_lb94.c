/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_fd_lb94.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t31;
  double t35, t36, t37, t39, t40, t41, t44, t48;
  double tzk0;

  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = t25 * t26;
  t28 = M_CBRT2;
  t30 = 0.1e1 / t18 / rho[0];
  t31 = t28 * t30;
  t35 = t25 * t26 * t28 * t30 / 0.12e2;
  t36 = xc_integrate(func0, NULL, 0.0, t35);
  t37 = log(t35);
  t39 = xc_integrate(func1, NULL, 0.0, t35);
  t40 = t36 * t37 - t39;
  t41 = t31 * t40;
  t44 = 0.1e1 - t27 * t41 / 0.12e2;
  t48 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t44);
  tzk0 = 0.2e1 * t48;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t31;
  double t35, t36, t37, t39, t40, t41, t44, t48;
  double tzk0;

  double t49, t51, t55, t57, t58, t59, t61, t64;
  double t69, tvrho0, t72, t73, t75, t78, t82, tvsigma0;

  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = t25 * t26;
  t28 = M_CBRT2;
  t30 = 0.1e1 / t18 / rho[0];
  t31 = t28 * t30;
  t35 = t25 * t26 * t28 * t30 / 0.12e2;
  t36 = xc_integrate(func0, NULL, 0.0, t35);
  t37 = log(t35);
  t39 = xc_integrate(func1, NULL, 0.0, t35);
  t40 = t36 * t37 - t39;
  t41 = t31 * t40;
  t44 = 0.1e1 - t27 * t41 / 0.12e2;
  t48 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t44);
  tzk0 = 0.2e1 * t48;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t49 = t18 * t18;
  t51 = t17 / t49;
  t55 = rho[0] * rho[0];
  t57 = 0.1e1 / t18 / t55;
  t58 = t28 * t57;
  t59 = t58 * t40;
  t61 = t58 * t36;
  t64 = t27 * t59 / 0.9e1 + t27 * t61 / 0.9e1;
  t69 = my_piecewise3(t2, 0, -t6 * t51 * t44 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t64);
  tvrho0 = 0.2e1 * rho[0] * t69 + 0.2e1 * t48;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t72 = 0.1e1 / t26;
  t73 = t25 * t72;
  t75 = t31 * t36;
  t78 = -t73 * t41 / 0.24e2 - t73 * t75 / 0.24e2;
  t82 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t78);
  tvsigma0 = 0.2e1 * rho[0] * t82;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t31;
  double t35, t36, t37, t39, t40, t41, t44, t48;
  double tzk0;

  double t49, t51, t55, t57, t58, t59, t61, t64;
  double t69, tvrho0, t72, t73, t75, t78, t82, tvsigma0;

  double t87, t94, t96, t97, t98, t101, t104, t105;
  double t106, t107, t108, t110, t111, t112, t113, t114;
  double t115, t116, t121, t123, t127, t128, t130, t131;
  double t132, t136, t137, t138, t141, t146, tv2rho20, t157;
  double t158, t159, t162, t167, tv2rhosigma0, t171, t172, t175;
  double t176, t177, t178, t181, t185, tv2sigma20;

  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = t25 * t26;
  t28 = M_CBRT2;
  t30 = 0.1e1 / t18 / rho[0];
  t31 = t28 * t30;
  t35 = t25 * t26 * t28 * t30 / 0.12e2;
  t36 = xc_integrate(func0, NULL, 0.0, t35);
  t37 = log(t35);
  t39 = xc_integrate(func1, NULL, 0.0, t35);
  t40 = t36 * t37 - t39;
  t41 = t31 * t40;
  t44 = 0.1e1 - t27 * t41 / 0.12e2;
  t48 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t44);
  tzk0 = 0.2e1 * t48;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t49 = t18 * t18;
  t51 = t17 / t49;
  t55 = rho[0] * rho[0];
  t57 = 0.1e1 / t18 / t55;
  t58 = t28 * t57;
  t59 = t58 * t40;
  t61 = t58 * t36;
  t64 = t27 * t59 / 0.9e1 + t27 * t61 / 0.9e1;
  t69 = my_piecewise3(t2, 0, -t6 * t51 * t44 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t64);
  tvrho0 = 0.2e1 * rho[0] * t69 + 0.2e1 * t48;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t72 = 0.1e1 / t26;
  t73 = t25 * t72;
  t75 = t31 * t36;
  t78 = -t73 * t41 / 0.24e2 - t73 * t75 / 0.24e2;
  t82 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t78);
  tvsigma0 = 0.2e1 * rho[0] * t82;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t87 = t17 / t49 / rho[0];
  t94 = t55 * rho[0];
  t96 = 0.1e1 / t18 / t94;
  t97 = t28 * t96;
  t98 = t97 * t40;
  t101 = t97 * t36;
  t104 = t23 * t23;
  t105 = 0.1e1 / t104;
  t106 = t20 * t105;
  t107 = t106 * sigma[0];
  t108 = t55 * t55;
  t110 = 0.1e1 / t49 / t108;
  t111 = t110 * params->beta;
  t112 = t28 * t28;
  t113 = params->beta * t112;
  t114 = t113 * t21;
  t115 = t24 * t26;
  t116 = t112 * t21;
  t121 = t105 * sigma[0];
  t123 = 0.1e1 / t49 / t55;
  t127 = 0.3e1 * t28 * t20 * t121 * t123 + 0.36e2;
  t128 = sqrt(t127);
  t130 = t116 * t115 * t30 / 0.12e2 + t128 / 0.6e1;
  t131 = log(t130);
  t132 = t30 * t131;
  t136 = 0.1e1 + t114 * t115 * t132 / 0.4e1;
  t137 = 0.1e1 / t136;
  t138 = t111 * t137;
  t141 = -0.7e1 / 0.27e2 * t27 * t98 - 0.11e2 / 0.27e2 * t27 * t101 + t107 * t138 / 0.9e1;
  t146 = my_piecewise3(t2, 0, t6 * t87 * t44 / 0.12e2 - t6 * t51 * t64 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t141);
  tv2rho20 = 0.2e1 * rho[0] * t146 + 0.4e1 * t69;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t157 = 0.1e1 / t49 / t94;
  t158 = t157 * params->beta;
  t159 = t158 * t137;
  t162 = t73 * t59 / 0.18e2 + t73 * t61 / 0.9e1 - t106 * t159 / 0.24e2;
  t167 = my_piecewise3(t2, 0, -t6 * t51 * t78 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t162);
  tv2rhosigma0 = 0.2e1 * rho[0] * t167 + 0.2e1 * t82;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t171 = 0.1e1 / t26 / sigma[0];
  t172 = t25 * t171;
  t175 = 0.1e1 / sigma[0];
  t176 = t106 * t175;
  t177 = t123 * params->beta;
  t178 = t177 * t137;
  t181 = t172 * t41 / 0.48e2 + t176 * t178 / 0.64e2;
  t185 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t181);
  tv2sigma20 = 0.2e1 * rho[0] * t185;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t31;
  double t35, t36, t37, t39, t40, t41, t44, t48;
  double tzk0;

  double t49, t51, t55, t57, t58, t59, t61, t64;
  double t69, tvrho0, t72, t73, t75, t78, t82, tvsigma0;

  double t87, t94, t96, t97, t98, t101, t104, t105;
  double t106, t107, t108, t110, t111, t112, t113, t114;
  double t115, t116, t121, t123, t127, t128, t130, t131;
  double t132, t136, t137, t138, t141, t146, tv2rho20, t157;
  double t158, t159, t162, t167, tv2rhosigma0, t171, t172, t175;
  double t176, t177, t178, t181, t185, tv2sigma20;

  double t188, t200, t201, t204, t207, t210, t211, t214;
  double t215, t216, t220, t221, t226, t227, t231, t232;
  double t233, t237, t238, t242, t247, tv3rho30, t263, t264;
  double t265, t268, t273, tv3rho2sigma0, t285, t288, t293, tv3rhosigma20;
  double t296, t299, t305, t308, t318, t319, t323, t324;
  double t325, t328, t332, tv3sigma30;

  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = t25 * t26;
  t28 = M_CBRT2;
  t30 = 0.1e1 / t18 / rho[0];
  t31 = t28 * t30;
  t35 = t25 * t26 * t28 * t30 / 0.12e2;
  t36 = xc_integrate(func0, NULL, 0.0, t35);
  t37 = log(t35);
  t39 = xc_integrate(func1, NULL, 0.0, t35);
  t40 = t36 * t37 - t39;
  t41 = t31 * t40;
  t44 = 0.1e1 - t27 * t41 / 0.12e2;
  t48 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t44);
  tzk0 = 0.2e1 * t48;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t49 = t18 * t18;
  t51 = t17 / t49;
  t55 = rho[0] * rho[0];
  t57 = 0.1e1 / t18 / t55;
  t58 = t28 * t57;
  t59 = t58 * t40;
  t61 = t58 * t36;
  t64 = t27 * t59 / 0.9e1 + t27 * t61 / 0.9e1;
  t69 = my_piecewise3(t2, 0, -t6 * t51 * t44 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t64);
  tvrho0 = 0.2e1 * rho[0] * t69 + 0.2e1 * t48;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t72 = 0.1e1 / t26;
  t73 = t25 * t72;
  t75 = t31 * t36;
  t78 = -t73 * t41 / 0.24e2 - t73 * t75 / 0.24e2;
  t82 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t78);
  tvsigma0 = 0.2e1 * rho[0] * t82;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t87 = t17 / t49 / rho[0];
  t94 = t55 * rho[0];
  t96 = 0.1e1 / t18 / t94;
  t97 = t28 * t96;
  t98 = t97 * t40;
  t101 = t97 * t36;
  t104 = t23 * t23;
  t105 = 0.1e1 / t104;
  t106 = t20 * t105;
  t107 = t106 * sigma[0];
  t108 = t55 * t55;
  t110 = 0.1e1 / t49 / t108;
  t111 = t110 * params->beta;
  t112 = t28 * t28;
  t113 = params->beta * t112;
  t114 = t113 * t21;
  t115 = t24 * t26;
  t116 = t112 * t21;
  t121 = t105 * sigma[0];
  t123 = 0.1e1 / t49 / t55;
  t127 = 0.3e1 * t28 * t20 * t121 * t123 + 0.36e2;
  t128 = sqrt(t127);
  t130 = t116 * t115 * t30 / 0.12e2 + t128 / 0.6e1;
  t131 = log(t130);
  t132 = t30 * t131;
  t136 = 0.1e1 + t114 * t115 * t132 / 0.4e1;
  t137 = 0.1e1 / t136;
  t138 = t111 * t137;
  t141 = -0.7e1 / 0.27e2 * t27 * t98 - 0.11e2 / 0.27e2 * t27 * t101 + t107 * t138 / 0.9e1;
  t146 = my_piecewise3(t2, 0, t6 * t87 * t44 / 0.12e2 - t6 * t51 * t64 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t141);
  tv2rho20 = 0.2e1 * rho[0] * t146 + 0.4e1 * t69;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t157 = 0.1e1 / t49 / t94;
  t158 = t157 * params->beta;
  t159 = t158 * t137;
  t162 = t73 * t59 / 0.18e2 + t73 * t61 / 0.9e1 - t106 * t159 / 0.24e2;
  t167 = my_piecewise3(t2, 0, -t6 * t51 * t78 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t162);
  tv2rhosigma0 = 0.2e1 * rho[0] * t167 + 0.2e1 * t82;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t171 = 0.1e1 / t26 / sigma[0];
  t172 = t25 * t171;
  t175 = 0.1e1 / sigma[0];
  t176 = t106 * t175;
  t177 = t123 * params->beta;
  t178 = t177 * t137;
  t181 = t172 * t41 / 0.48e2 + t176 * t178 / 0.64e2;
  t185 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t181);
  tv2sigma20 = 0.2e1 * rho[0] * t185;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t188 = t17 * t123;
  t200 = t28 / t18 / t108;
  t201 = t200 * t40;
  t204 = t200 * t36;
  t207 = t108 * rho[0];
  t210 = 0.1e1 / t49 / t207 * params->beta;
  t211 = t210 * t137;
  t214 = t136 * t136;
  t215 = 0.1e1 / t214;
  t216 = t57 * t131;
  t220 = t113 * t25;
  t221 = t26 * t30;
  t226 = 0.1e1 / t128 * t28;
  t227 = t226 * t20;
  t231 = -t116 * t115 * t57 / 0.9e1 - 0.2e1 / 0.3e1 * t227 * t121 * t157;
  t232 = 0.1e1 / t130;
  t233 = t231 * t232;
  t237 = -t114 * t115 * t216 / 0.3e1 + t220 * t221 * t233 / 0.4e1;
  t238 = t215 * t237;
  t242 = 0.7e2 / 0.81e2 * t27 * t201 + 0.46e2 / 0.27e2 * t27 * t204 - 0.25e2 / 0.27e2 * t107 * t211 - t107 * t111 * t238 / 0.9e1;
  t247 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t188 * t44 + t6 * t87 * t64 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t51 * t141 - 0.3e1 / 0.8e1 * t6 * t19 * t242);
  tv3rho30 = 0.2e1 * rho[0] * t247 + 0.6e1 * t146;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t263 = t106 * t157;
  t264 = params->beta * t215;
  t265 = t264 * t237;
  t268 = -0.7e1 / 0.54e2 * t73 * t98 - t73 * t101 / 0.3e1 + 0.19e2 / 0.72e2 * t106 * t138 + t263 * t265 / 0.24e2;
  t273 = my_piecewise3(t2, 0, t6 * t87 * t78 / 0.12e2 - t6 * t51 * t162 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t268);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t273 + 0.4e1 * t167;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t285 = t177 * t238;
  t288 = -t172 * t59 / 0.36e2 - t172 * t61 / 0.36e2 - t176 * t159 / 0.24e2 - t176 * t285 / 0.64e2;
  t293 = my_piecewise3(t2, 0, -t6 * t51 * t181 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t288);
  tv3rhosigma20 = 0.2e1 * rho[0] * t293 + 0.2e1 * t185;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t296 = sigma[0] * sigma[0];
  t299 = t25 / t26 / t296;
  t305 = t106 / t296;
  t308 = t24 * t72;
  t318 = t116 * t308 * t30 / 0.24e2 + t226 * t106 * t123 / 0.4e1;
  t319 = t318 * t232;
  t323 = t114 * t308 * t132 / 0.8e1 + t220 * t221 * t319 / 0.4e1;
  t324 = t215 * t323;
  t325 = t177 * t324;
  t328 = -t299 * t41 / 0.32e2 + t299 * t75 / 0.96e2 - t305 * t178 / 0.64e2 - t176 * t325 / 0.64e2;
  t332 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t328);
  tv3sigma30 = 0.2e1 * rho[0] * t332;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t30, t31;
  double t35, t36, t37, t39, t40, t41, t44, t48;
  double tzk0;

  double t49, t51, t55, t57, t58, t59, t61, t64;
  double t69, tvrho0, t72, t73, t75, t78, t82, tvsigma0;

  double t87, t94, t96, t97, t98, t101, t104, t105;
  double t106, t107, t108, t110, t111, t112, t113, t114;
  double t115, t116, t121, t123, t127, t128, t130, t131;
  double t132, t136, t137, t138, t141, t146, tv2rho20, t157;
  double t158, t159, t162, t167, tv2rhosigma0, t171, t172, t175;
  double t176, t177, t178, t181, t185, tv2sigma20;

  double t188, t200, t201, t204, t207, t210, t211, t214;
  double t215, t216, t220, t221, t226, t227, t231, t232;
  double t233, t237, t238, t242, t247, tv3rho30, t263, t264;
  double t265, t268, t273, tv3rho2sigma0, t285, t288, t293, tv3rhosigma20;
  double t296, t299, t305, t308, t318, t319, t323, t324;
  double t325, t328, t332, tv3sigma30;

  double t349, t350, t357, t368, t369, t370, t378, t387;
  double t388, t390, t406, t407, t408, t413, t414, t423;
  double tv4rho40, t445, t457, tv4rho3sigma0, t487, tv4rho2sigma20, t513, t550;
  double tv4rhosigma30, t553, t556, t567, t572, t591, t605, tv4sigma40;

  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = 0.1e1 / t23;
  t25 = t21 * t24;
  t26 = sqrt(sigma[0]);
  t27 = t25 * t26;
  t28 = M_CBRT2;
  t30 = 0.1e1 / t18 / rho[0];
  t31 = t28 * t30;
  t35 = t25 * t26 * t28 * t30 / 0.12e2;
  t36 = xc_integrate(func0, NULL, 0.0, t35);
  t37 = log(t35);
  t39 = xc_integrate(func1, NULL, 0.0, t35);
  t40 = t36 * t37 - t39;
  t41 = t31 * t40;
  t44 = 0.1e1 - t27 * t41 / 0.12e2;
  t48 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t44);
  tzk0 = 0.2e1 * t48;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t49 = t18 * t18;
  t51 = t17 / t49;
  t55 = rho[0] * rho[0];
  t57 = 0.1e1 / t18 / t55;
  t58 = t28 * t57;
  t59 = t58 * t40;
  t61 = t58 * t36;
  t64 = t27 * t59 / 0.9e1 + t27 * t61 / 0.9e1;
  t69 = my_piecewise3(t2, 0, -t6 * t51 * t44 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t64);
  tvrho0 = 0.2e1 * rho[0] * t69 + 0.2e1 * t48;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t72 = 0.1e1 / t26;
  t73 = t25 * t72;
  t75 = t31 * t36;
  t78 = -t73 * t41 / 0.24e2 - t73 * t75 / 0.24e2;
  t82 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t78);
  tvsigma0 = 0.2e1 * rho[0] * t82;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t87 = t17 / t49 / rho[0];
  t94 = t55 * rho[0];
  t96 = 0.1e1 / t18 / t94;
  t97 = t28 * t96;
  t98 = t97 * t40;
  t101 = t97 * t36;
  t104 = t23 * t23;
  t105 = 0.1e1 / t104;
  t106 = t20 * t105;
  t107 = t106 * sigma[0];
  t108 = t55 * t55;
  t110 = 0.1e1 / t49 / t108;
  t111 = t110 * params->beta;
  t112 = t28 * t28;
  t113 = params->beta * t112;
  t114 = t113 * t21;
  t115 = t24 * t26;
  t116 = t112 * t21;
  t121 = t105 * sigma[0];
  t123 = 0.1e1 / t49 / t55;
  t127 = 0.3e1 * t28 * t20 * t121 * t123 + 0.36e2;
  t128 = sqrt(t127);
  t130 = t116 * t115 * t30 / 0.12e2 + t128 / 0.6e1;
  t131 = log(t130);
  t132 = t30 * t131;
  t136 = 0.1e1 + t114 * t115 * t132 / 0.4e1;
  t137 = 0.1e1 / t136;
  t138 = t111 * t137;
  t141 = -0.7e1 / 0.27e2 * t27 * t98 - 0.11e2 / 0.27e2 * t27 * t101 + t107 * t138 / 0.9e1;
  t146 = my_piecewise3(t2, 0, t6 * t87 * t44 / 0.12e2 - t6 * t51 * t64 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t141);
  tv2rho20 = 0.2e1 * rho[0] * t146 + 0.4e1 * t69;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t157 = 0.1e1 / t49 / t94;
  t158 = t157 * params->beta;
  t159 = t158 * t137;
  t162 = t73 * t59 / 0.18e2 + t73 * t61 / 0.9e1 - t106 * t159 / 0.24e2;
  t167 = my_piecewise3(t2, 0, -t6 * t51 * t78 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t162);
  tv2rhosigma0 = 0.2e1 * rho[0] * t167 + 0.2e1 * t82;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t171 = 0.1e1 / t26 / sigma[0];
  t172 = t25 * t171;
  t175 = 0.1e1 / sigma[0];
  t176 = t106 * t175;
  t177 = t123 * params->beta;
  t178 = t177 * t137;
  t181 = t172 * t41 / 0.48e2 + t176 * t178 / 0.64e2;
  t185 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t181);
  tv2sigma20 = 0.2e1 * rho[0] * t185;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t188 = t17 * t123;
  t200 = t28 / t18 / t108;
  t201 = t200 * t40;
  t204 = t200 * t36;
  t207 = t108 * rho[0];
  t210 = 0.1e1 / t49 / t207 * params->beta;
  t211 = t210 * t137;
  t214 = t136 * t136;
  t215 = 0.1e1 / t214;
  t216 = t57 * t131;
  t220 = t113 * t25;
  t221 = t26 * t30;
  t226 = 0.1e1 / t128 * t28;
  t227 = t226 * t20;
  t231 = -t116 * t115 * t57 / 0.9e1 - 0.2e1 / 0.3e1 * t227 * t121 * t157;
  t232 = 0.1e1 / t130;
  t233 = t231 * t232;
  t237 = -t114 * t115 * t216 / 0.3e1 + t220 * t221 * t233 / 0.4e1;
  t238 = t215 * t237;
  t242 = 0.7e2 / 0.81e2 * t27 * t201 + 0.46e2 / 0.27e2 * t27 * t204 - 0.25e2 / 0.27e2 * t107 * t211 - t107 * t111 * t238 / 0.9e1;
  t247 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t188 * t44 + t6 * t87 * t64 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t51 * t141 - 0.3e1 / 0.8e1 * t6 * t19 * t242);
  tv3rho30 = 0.2e1 * rho[0] * t247 + 0.6e1 * t146;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t263 = t106 * t157;
  t264 = params->beta * t215;
  t265 = t264 * t237;
  t268 = -0.7e1 / 0.54e2 * t73 * t98 - t73 * t101 / 0.3e1 + 0.19e2 / 0.72e2 * t106 * t138 + t263 * t265 / 0.24e2;
  t273 = my_piecewise3(t2, 0, t6 * t87 * t78 / 0.12e2 - t6 * t51 * t162 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t268);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t273 + 0.4e1 * t167;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t285 = t177 * t238;
  t288 = -t172 * t59 / 0.36e2 - t172 * t61 / 0.36e2 - t176 * t159 / 0.24e2 - t176 * t285 / 0.64e2;
  t293 = my_piecewise3(t2, 0, -t6 * t51 * t181 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t288);
  tv3rhosigma20 = 0.2e1 * rho[0] * t293 + 0.2e1 * t185;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t296 = sigma[0] * sigma[0];
  t299 = t25 / t26 / t296;
  t305 = t106 / t296;
  t308 = t24 * t72;
  t318 = t116 * t308 * t30 / 0.24e2 + t226 * t106 * t123 / 0.4e1;
  t319 = t318 * t232;
  t323 = t114 * t308 * t132 / 0.8e1 + t220 * t221 * t319 / 0.4e1;
  t324 = t215 * t323;
  t325 = t177 * t324;
  t328 = -t299 * t41 / 0.32e2 + t299 * t75 / 0.96e2 - t305 * t178 / 0.64e2 - t176 * t325 / 0.64e2;
  t332 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t328);
  tv3sigma30 = 0.2e1 * rho[0] * t332;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t349 = 0.1e1 / t18 / t207;
  t350 = t28 * t349;
  t357 = t108 * t55;
  t368 = 0.1e1 / t214 / t136;
  t369 = t237 * t237;
  t370 = t368 * t369;
  t378 = t26 * t57;
  t387 = 0.1e1 / t128 / t127 * t112;
  t388 = t387 * t21;
  t390 = 0.1e1 / t23 / t22;
  t406 = t231 * t231;
  t407 = t130 * t130;
  t408 = 0.1e1 / t407;
  t413 = 0.7e1 / 0.9e1 * t114 * t115 * t96 * t131 - 0.2e1 / 0.3e1 * t220 * t378 * t233 + t220 * t221 * (0.7e1 / 0.27e2 * t116 * t115 * t96 - 0.8e1 / 0.3e1 * t388 * t390 * t296 / t18 / t108 / t94 + 0.22e2 / 0.9e1 * t227 * t121 * t110) * t232 / 0.4e1 - t220 * t221 * t406 * t408 / 0.4e1;
  t414 = t215 * t413;
  t423 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t157 * t44 - 0.5e1 / 0.9e1 * t6 * t188 * t64 + t6 * t87 * t141 / 0.2e1 - t6 * t51 * t242 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.91e3 / 0.243e3 * t27 * t350 * t40 - 0.2074e4 / 0.243e3 * t27 * t350 * t36 + 0.563e3 / 0.81e2 * t107 / t49 / t357 * params->beta * t137 + 0.13e2 / 0.9e1 * t107 * t210 * t238 + 0.2e1 / 0.9e1 * t107 * t111 * t370 - t107 * t111 * t414 / 0.9e1));
  tv4rho40 = 0.2e1 * rho[0] * t423 + 0.8e1 * t247;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t445 = params->beta * t368;
  t457 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t188 * t78 + t6 * t87 * t162 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t51 * t268 - 0.3e1 / 0.8e1 * t6 * t19 * (0.35e2 / 0.81e2 * t73 * t201 + 0.104e3 / 0.81e2 * t73 * t204 - 0.169e3 / 0.108e3 * t106 * t211 - 0.5e1 / 0.12e2 * t106 * t110 * t265 - t263 * t445 * t369 / 0.12e2 + t263 * t264 * t413 / 0.24e2));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t457 + 0.6e1 * t273;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t487 = my_piecewise3(t2, 0, t6 * t87 * t181 / 0.12e2 - t6 * t51 * t288 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (0.7e1 / 0.108e3 * t172 * t98 + 0.11e2 / 0.108e3 * t172 * t101 + t176 * t138 / 0.8e1 + t176 * t158 * t238 / 0.12e2 + t176 * t177 * t370 / 0.32e2 - t176 * t177 * t414 / 0.64e2));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t487 + 0.4e1 * t293;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t513 = t72 * t30;
  t550 = my_piecewise3(t2, 0, -t6 * t51 * t328 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t299 * t59 / 0.24e2 + t299 * t61 / 0.36e2 + 0.5e1 / 0.96e2 * t305 * t159 + t305 * t285 / 0.64e2 + t176 * t158 * t324 / 0.24e2 + t106 * t175 * t123 * t445 * t323 * t237 / 0.32e2 - t176 * t177 * t215 * (-t114 * t308 * t216 / 0.6e1 + t220 * t513 * t233 / 0.8e1 - t220 * t378 * t319 / 0.3e1 + t220 * t221 * (-t116 * t308 * t57 / 0.18e2 + t388 * t390 / t18 / t357 * sigma[0] - 0.2e1 / 0.3e1 * t226 * t263) * t232 / 0.4e1 - t220 * t221 * t318 * t408 * t231 / 0.4e1) / 0.64e2));
  tv4rhosigma30 = 0.2e1 * rho[0] * t550 + 0.2e1 * t332;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t553 = t296 * sigma[0];
  t556 = t25 / t26 / t553;
  t567 = t323 * t323;
  t572 = t24 * t171;
  t591 = t318 * t318;
  t605 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (0.5e1 / 0.64e2 * t556 * t41 - t556 * t75 / 0.24e2 + 0.7e1 / 0.256e3 * t106 / t553 * t178 + t305 * t325 / 0.32e2 + t176 * t177 * t368 * t567 / 0.32e2 - t176 * t177 * t215 * (-t114 * t572 * t132 / 0.16e2 + t220 * t513 * t319 / 0.4e1 + t220 * t221 * (-t116 * t572 * t30 / 0.48e2 - 0.3e1 / 0.8e1 * t387 * t21 * t390 * t349) * t232 / 0.4e1 - t220 * t221 * t591 * t408 / 0.4e1) / 0.64e2));
  tv4sigma40 = 0.2e1 * rho[0] * t605;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t40;
  double t41, t42, t44, t45, t49, t53, t54, t55;
  double t56, t57, t58, t60, t61, t62, t63, t65;
  double t66, t68, t69, t70, t72, t73, t77, t81;
  double tzk0;

  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t38 = t34 * t37;
  t40 = t33 * t38 / 0.12e2;
  t41 = xc_integrate(func0, NULL, 0.0, t40);
  t42 = log(t40);
  t44 = xc_integrate(func1, NULL, 0.0, t40);
  t45 = t41 * t42 - t44;
  t49 = 0.1e1 - t33 * t38 * t45 / 0.12e2;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = my_piecewise5(t14, t11, t10, t15, -t17);
  t56 = 0.1e1 + t55;
  t57 = t56 <= p->zeta_threshold;
  t58 = POW_1_3(t56);
  t60 = my_piecewise3(t57, t22, t58 * t56);
  t61 = t60 * t26;
  t62 = sqrt(sigma[2]);
  t63 = POW_1_3(rho[1]);
  t65 = 0.1e1 / t63 / rho[1];
  t66 = t62 * t65;
  t68 = t33 * t66 / 0.12e2;
  t69 = xc_integrate(func0, NULL, 0.0, t68);
  t70 = log(t68);
  t72 = xc_integrate(func1, NULL, 0.0, t68);
  t73 = t69 * t70 - t72;
  t77 = 0.1e1 - t33 * t66 * t73 / 0.12e2;
  t81 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t77);
  tzk0 = t53 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t40;
  double t41, t42, t44, t45, t49, t53, t54, t55;
  double t56, t57, t58, t60, t61, t62, t63, t65;
  double t66, t68, t69, t70, t72, t73, t77, t81;
  double tzk0;

  double t82, t83, t84, t85, t86, t89, t90, t94;
  double t95, t96, t99, t100, t102, t103, t109, t114;
  double t116, t119, t120, t124, t127, t129, tvrho0, t132;
  double t133, t136, t137, t142, t144, t147, t148, t152;
  double t154, t155, t161, t166, tvrho1, t169, t170, t176;
  double t180, tvsigma0, tvsigma1, t181, t182, t188, t192, tvsigma2;

  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t38 = t34 * t37;
  t40 = t33 * t38 / 0.12e2;
  t41 = xc_integrate(func0, NULL, 0.0, t40);
  t42 = log(t40);
  t44 = xc_integrate(func1, NULL, 0.0, t40);
  t45 = t41 * t42 - t44;
  t49 = 0.1e1 - t33 * t38 * t45 / 0.12e2;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = my_piecewise5(t14, t11, t10, t15, -t17);
  t56 = 0.1e1 + t55;
  t57 = t56 <= p->zeta_threshold;
  t58 = POW_1_3(t56);
  t60 = my_piecewise3(t57, t22, t58 * t56);
  t61 = t60 * t26;
  t62 = sqrt(sigma[2]);
  t63 = POW_1_3(rho[1]);
  t65 = 0.1e1 / t63 / rho[1];
  t66 = t62 * t65;
  t68 = t33 * t66 / 0.12e2;
  t69 = xc_integrate(func0, NULL, 0.0, t68);
  t70 = log(t68);
  t72 = xc_integrate(func1, NULL, 0.0, t68);
  t73 = t69 * t70 - t72;
  t77 = 0.1e1 - t33 * t66 * t73 / 0.12e2;
  t81 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t77);
  tzk0 = t53 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t6 * t6;
  t83 = 0.1e1 / t82;
  t84 = t16 * t83;
  t85 = t7 - t84;
  t86 = my_piecewise5(t10, 0, t14, 0, t85);
  t89 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t86);
  t90 = t89 * t26;
  t94 = t26 * t26;
  t95 = 0.1e1 / t94;
  t96 = t25 * t95;
  t99 = t5 * t96 * t49 / 0.8e1;
  t100 = rho[0] * rho[0];
  t102 = 0.1e1 / t35 / t100;
  t103 = t34 * t102;
  t109 = t33 * t103 * t41 / 0.9e1 + t33 * t103 * t45 / 0.9e1;
  t114 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t49 - t99 - 0.3e1 / 0.8e1 * t5 * t27 * t109);
  t116 = my_piecewise5(t14, 0, t10, 0, -t85);
  t119 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t116);
  t120 = t119 * t26;
  t124 = t60 * t95;
  t127 = t5 * t124 * t77 / 0.8e1;
  t129 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t120 * t77 - t127);
  tvrho0 = t53 + t81 + t6 * (t114 + t129);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t132 = -t7 - t84;
  t133 = my_piecewise5(t10, 0, t14, 0, t132);
  t136 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t133);
  t137 = t136 * t26;
  t142 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t137 * t49 - t99);
  t144 = my_piecewise5(t14, 0, t10, 0, -t132);
  t147 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t144);
  t148 = t147 * t26;
  t152 = rho[1] * rho[1];
  t154 = 0.1e1 / t63 / t152;
  t155 = t62 * t154;
  t161 = t33 * t155 * t69 / 0.9e1 + t33 * t155 * t73 / 0.9e1;
  t166 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t148 * t77 - t127 - 0.3e1 / 0.8e1 * t5 * t61 * t161);
  tvrho1 = t53 + t81 + t6 * (t142 + t166);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t169 = 0.1e1 / t34;
  t170 = t169 * t37;
  t176 = -t33 * t170 * t41 / 0.24e2 - t33 * t170 * t45 / 0.24e2;
  t180 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t176);
  tvsigma0 = t6 * t180;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t181 = 0.1e1 / t62;
  t182 = t181 * t65;
  t188 = -t33 * t182 * t69 / 0.24e2 - t33 * t182 * t73 / 0.24e2;
  t192 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t188);
  tvsigma2 = t6 * t192;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t40;
  double t41, t42, t44, t45, t49, t53, t54, t55;
  double t56, t57, t58, t60, t61, t62, t63, t65;
  double t66, t68, t69, t70, t72, t73, t77, t81;
  double tzk0;

  double t82, t83, t84, t85, t86, t89, t90, t94;
  double t95, t96, t99, t100, t102, t103, t109, t114;
  double t116, t119, t120, t124, t127, t129, tvrho0, t132;
  double t133, t136, t137, t142, t144, t147, t148, t152;
  double t154, t155, t161, t166, tvrho1, t169, t170, t176;
  double t180, tvsigma0, tvsigma1, t181, t182, t188, t192, tvsigma2;

  double t195, t196, t197, t200, t201, t202, t204, t205;
  double t209, t210, t214, t216, t222, t223, t226, t228;
  double t230, t232, t233, t240, t241, t242, t243, t244;
  double t245, t247, t249, t250, t251, t252, t253, t256;
  double t257, t258, t260, t264, t265, t267, t268, t269;
  double t273, t274, t275, t276, t279, t284, t285, t286;
  double t287, t291, t295, t296, t300, t302, t304, t307;
  double t309, tv2rho20, t312, t315, t316, t320, t321, t325;
  double t327, t335, t336, t339, t343, t344, t348, t350;
  double t357, t360, tv2rho21, t365, t369, t370, t374, t375;
  double t381, t382, t386, t390, t391, t400, t402, t403;
  double t410, t411, t412, t414, t416, t419, t421, t425;
  double t426, t428, t429, t430, t434, t435, t436, t437;
  double t440, t445, tv2rho22, t453, t454, t462, t463, t464;
  double t467, t472, tv2rhosigma0, tv2rhosigma1, t479, t481, tv2rhosigma2, t487;
  double tv2rhosigma3, tv2rhosigma4, t492, t500, t501, t502, t505, t510;
  double tv2rhosigma5, t513, t518, t519, t521, t524, t528, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t530, t535, t536, t538;
  double t541, t545, tv2sigma25;

  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t38 = t34 * t37;
  t40 = t33 * t38 / 0.12e2;
  t41 = xc_integrate(func0, NULL, 0.0, t40);
  t42 = log(t40);
  t44 = xc_integrate(func1, NULL, 0.0, t40);
  t45 = t41 * t42 - t44;
  t49 = 0.1e1 - t33 * t38 * t45 / 0.12e2;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = my_piecewise5(t14, t11, t10, t15, -t17);
  t56 = 0.1e1 + t55;
  t57 = t56 <= p->zeta_threshold;
  t58 = POW_1_3(t56);
  t60 = my_piecewise3(t57, t22, t58 * t56);
  t61 = t60 * t26;
  t62 = sqrt(sigma[2]);
  t63 = POW_1_3(rho[1]);
  t65 = 0.1e1 / t63 / rho[1];
  t66 = t62 * t65;
  t68 = t33 * t66 / 0.12e2;
  t69 = xc_integrate(func0, NULL, 0.0, t68);
  t70 = log(t68);
  t72 = xc_integrate(func1, NULL, 0.0, t68);
  t73 = t69 * t70 - t72;
  t77 = 0.1e1 - t33 * t66 * t73 / 0.12e2;
  t81 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t77);
  tzk0 = t53 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t6 * t6;
  t83 = 0.1e1 / t82;
  t84 = t16 * t83;
  t85 = t7 - t84;
  t86 = my_piecewise5(t10, 0, t14, 0, t85);
  t89 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t86);
  t90 = t89 * t26;
  t94 = t26 * t26;
  t95 = 0.1e1 / t94;
  t96 = t25 * t95;
  t99 = t5 * t96 * t49 / 0.8e1;
  t100 = rho[0] * rho[0];
  t102 = 0.1e1 / t35 / t100;
  t103 = t34 * t102;
  t109 = t33 * t103 * t41 / 0.9e1 + t33 * t103 * t45 / 0.9e1;
  t114 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t49 - t99 - 0.3e1 / 0.8e1 * t5 * t27 * t109);
  t116 = my_piecewise5(t14, 0, t10, 0, -t85);
  t119 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t116);
  t120 = t119 * t26;
  t124 = t60 * t95;
  t127 = t5 * t124 * t77 / 0.8e1;
  t129 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t120 * t77 - t127);
  tvrho0 = t53 + t81 + t6 * (t114 + t129);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t132 = -t7 - t84;
  t133 = my_piecewise5(t10, 0, t14, 0, t132);
  t136 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t133);
  t137 = t136 * t26;
  t142 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t137 * t49 - t99);
  t144 = my_piecewise5(t14, 0, t10, 0, -t132);
  t147 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t144);
  t148 = t147 * t26;
  t152 = rho[1] * rho[1];
  t154 = 0.1e1 / t63 / t152;
  t155 = t62 * t154;
  t161 = t33 * t155 * t69 / 0.9e1 + t33 * t155 * t73 / 0.9e1;
  t166 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t148 * t77 - t127 - 0.3e1 / 0.8e1 * t5 * t61 * t161);
  tvrho1 = t53 + t81 + t6 * (t142 + t166);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t169 = 0.1e1 / t34;
  t170 = t169 * t37;
  t176 = -t33 * t170 * t41 / 0.24e2 - t33 * t170 * t45 / 0.24e2;
  t180 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t176);
  tvsigma0 = t6 * t180;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t181 = 0.1e1 / t62;
  t182 = t181 * t65;
  t188 = -t33 * t182 * t69 / 0.24e2 - t33 * t182 * t73 / 0.24e2;
  t192 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t188);
  tvsigma2 = t6 * t192;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t195 = t23 * t23;
  t196 = 0.1e1 / t195;
  t197 = t86 * t86;
  t200 = t82 * t6;
  t201 = 0.1e1 / t200;
  t202 = t16 * t201;
  t204 = -0.2e1 * t83 + 0.2e1 * t202;
  t205 = my_piecewise5(t10, 0, t14, 0, t204);
  t209 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t196 * t197 + 0.4e1 / 0.3e1 * t23 * t205);
  t210 = t209 * t26;
  t214 = t89 * t95;
  t216 = t5 * t214 * t49;
  t222 = 0.1e1 / t94 / t6;
  t223 = t25 * t222;
  t226 = t5 * t223 * t49 / 0.12e2;
  t228 = t5 * t96 * t109;
  t230 = t100 * rho[0];
  t232 = 0.1e1 / t35 / t230;
  t233 = t34 * t232;
  t240 = t31 * t31;
  t241 = 0.1e1 / t240;
  t242 = t28 * t241;
  t243 = t242 * sigma[0];
  t244 = t100 * t100;
  t245 = t35 * t35;
  t247 = 0.1e1 / t245 / t244;
  t249 = M_CBRT2;
  t250 = params->beta * t249;
  t251 = t250 * t29;
  t252 = t32 * t34;
  t253 = t249 * t29;
  t256 = t249 * t249;
  t257 = t256 * t28;
  t258 = t241 * sigma[0];
  t260 = 0.1e1 / t245 / t100;
  t264 = 0.6e1 * t257 * t258 * t260 + 0.144e3;
  t265 = sqrt(t264);
  t267 = t253 * t252 * t37 / 0.12e2 + t265 / 0.12e2;
  t268 = log(t267);
  t269 = t37 * t268;
  t273 = 0.1e1 + t251 * t252 * t269 / 0.4e1;
  t274 = 0.1e1 / t273;
  t275 = t249 * t274;
  t276 = t247 * params->beta * t275;
  t279 = -0.7e1 / 0.27e2 * t33 * t233 * t45 - 0.11e2 / 0.27e2 * t33 * t233 * t41 + t243 * t276 / 0.18e2;
  t284 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t210 * t49 - t216 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t90 * t109 + t226 - t228 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t279);
  t285 = t58 * t58;
  t286 = 0.1e1 / t285;
  t287 = t116 * t116;
  t291 = my_piecewise5(t14, 0, t10, 0, -t204);
  t295 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t286 * t287 + 0.4e1 / 0.3e1 * t58 * t291);
  t296 = t295 * t26;
  t300 = t119 * t95;
  t302 = t5 * t300 * t77;
  t304 = t60 * t222;
  t307 = t5 * t304 * t77 / 0.12e2;
  t309 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t296 * t77 - t302 / 0.4e1 + t307);
  tv2rho20 = 0.2e1 * t114 + 0.2e1 * t129 + t6 * (t284 + t309);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t312 = t196 * t133;
  t315 = 0.2e1 * t202;
  t316 = my_piecewise5(t10, 0, t14, 0, t315);
  t320 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t312 * t86 + 0.4e1 / 0.3e1 * t23 * t316);
  t321 = t320 * t26;
  t325 = t136 * t95;
  t327 = t5 * t325 * t49;
  t335 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t321 * t49 - t327 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t137 * t109 - t216 / 0.8e1 + t226 - t228 / 0.8e1);
  t336 = t286 * t144;
  t339 = my_piecewise5(t14, 0, t10, 0, -t315);
  t343 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t336 * t116 + 0.4e1 / 0.3e1 * t58 * t339);
  t344 = t343 * t26;
  t348 = t147 * t95;
  t350 = t5 * t348 * t77;
  t357 = t5 * t124 * t161;
  t360 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t344 * t77 - t350 / 0.8e1 - t302 / 0.8e1 + t307 - 0.3e1 / 0.8e1 * t5 * t120 * t161 - t357 / 0.8e1);
  tv2rho21 = t114 + t129 + t142 + t166 + t6 * (t335 + t360);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t365 = t133 * t133;
  t369 = 0.2e1 * t83 + 0.2e1 * t202;
  t370 = my_piecewise5(t10, 0, t14, 0, t369);
  t374 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t196 * t365 + 0.4e1 / 0.3e1 * t23 * t370);
  t375 = t374 * t26;
  t381 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t375 * t49 - t327 / 0.4e1 + t226);
  t382 = t144 * t144;
  t386 = my_piecewise5(t14, 0, t10, 0, -t369);
  t390 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t286 * t382 + 0.4e1 / 0.3e1 * t58 * t386);
  t391 = t390 * t26;
  t400 = t152 * rho[1];
  t402 = 0.1e1 / t63 / t400;
  t403 = t62 * t402;
  t410 = t242 * sigma[2];
  t411 = t152 * t152;
  t412 = t63 * t63;
  t414 = 0.1e1 / t412 / t411;
  t416 = t32 * t62;
  t419 = t241 * sigma[2];
  t421 = 0.1e1 / t412 / t152;
  t425 = 0.6e1 * t257 * t419 * t421 + 0.144e3;
  t426 = sqrt(t425);
  t428 = t253 * t416 * t65 / 0.12e2 + t426 / 0.12e2;
  t429 = log(t428);
  t430 = t65 * t429;
  t434 = 0.1e1 + t251 * t416 * t430 / 0.4e1;
  t435 = 0.1e1 / t434;
  t436 = t249 * t435;
  t437 = t414 * params->beta * t436;
  t440 = -0.7e1 / 0.27e2 * t33 * t403 * t73 - 0.11e2 / 0.27e2 * t33 * t403 * t69 + t410 * t437 / 0.18e2;
  t445 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t391 * t77 - t350 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t148 * t161 + t307 - t357 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t61 * t440);
  tv2rho22 = 0.2e1 * t142 + 0.2e1 * t166 + t6 * (t381 + t445);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t453 = t5 * t96 * t176 / 0.8e1;
  t454 = t169 * t102;
  t462 = 0.1e1 / t245 / t230;
  t463 = t242 * t462;
  t464 = t250 * t274;
  t467 = t33 * t454 * t45 / 0.18e2 + t33 * t454 * t41 / 0.9e1 - t463 * t464 / 0.48e2;
  t472 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t176 - t453 - 0.3e1 / 0.8e1 * t5 * t27 * t467);
  tv2rhosigma0 = t6 * t472 + t180;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t479 = t5 * t124 * t188 / 0.8e1;
  t481 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t120 * t188 - t479);
  tv2rhosigma2 = t6 * t481 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t487 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t137 * t176 - t453);
  tv2rhosigma3 = t6 * t487 + t180;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t492 = t181 * t154;
  t500 = 0.1e1 / t412 / t400;
  t501 = t242 * t500;
  t502 = t250 * t435;
  t505 = t33 * t492 * t73 / 0.18e2 + t33 * t492 * t69 / 0.9e1 - t501 * t502 / 0.48e2;
  t510 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t148 * t188 - t479 - 0.3e1 / 0.8e1 * t5 * t61 * t505);
  tv2rhosigma5 = t6 * t510 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t513 = 0.1e1 / t34 / sigma[0];
  t518 = 0.1e1 / sigma[0];
  t519 = t242 * t518;
  t521 = t260 * params->beta * t275;
  t524 = t33 * t513 * t37 * t45 / 0.48e2 + t519 * t521 / 0.128e3;
  t528 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t524);
  tv2sigma20 = t6 * t528;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t530 = 0.1e1 / t62 / sigma[2];
  t535 = 0.1e1 / sigma[2];
  t536 = t242 * t535;
  t538 = t421 * params->beta * t436;
  t541 = t33 * t530 * t65 * t73 / 0.48e2 + t536 * t538 / 0.128e3;
  t545 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t541);
  tv2sigma25 = t6 * t545;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t40;
  double t41, t42, t44, t45, t49, t53, t54, t55;
  double t56, t57, t58, t60, t61, t62, t63, t65;
  double t66, t68, t69, t70, t72, t73, t77, t81;
  double tzk0;

  double t82, t83, t84, t85, t86, t89, t90, t94;
  double t95, t96, t99, t100, t102, t103, t109, t114;
  double t116, t119, t120, t124, t127, t129, tvrho0, t132;
  double t133, t136, t137, t142, t144, t147, t148, t152;
  double t154, t155, t161, t166, tvrho1, t169, t170, t176;
  double t180, tvsigma0, tvsigma1, t181, t182, t188, t192, tvsigma2;

  double t195, t196, t197, t200, t201, t202, t204, t205;
  double t209, t210, t214, t216, t222, t223, t226, t228;
  double t230, t232, t233, t240, t241, t242, t243, t244;
  double t245, t247, t249, t250, t251, t252, t253, t256;
  double t257, t258, t260, t264, t265, t267, t268, t269;
  double t273, t274, t275, t276, t279, t284, t285, t286;
  double t287, t291, t295, t296, t300, t302, t304, t307;
  double t309, tv2rho20, t312, t315, t316, t320, t321, t325;
  double t327, t335, t336, t339, t343, t344, t348, t350;
  double t357, t360, tv2rho21, t365, t369, t370, t374, t375;
  double t381, t382, t386, t390, t391, t400, t402, t403;
  double t410, t411, t412, t414, t416, t419, t421, t425;
  double t426, t428, t429, t430, t434, t435, t436, t437;
  double t440, t445, tv2rho22, t453, t454, t462, t463, t464;
  double t467, t472, tv2rhosigma0, tv2rhosigma1, t479, t481, tv2rhosigma2, t487;
  double tv2rhosigma3, tv2rhosigma4, t492, t500, t501, t502, t505, t510;
  double tv2rhosigma5, t513, t518, t519, t521, t524, t528, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t530, t535, t536, t538;
  double t541, t545, tv2sigma25;

  double t549, t550, t553, t556, t557, t558, t560, t561;
  double t565, t566, t570, t572, t577, t579, t582, t588;
  double t589, t592, t594, t597, t600, t601, t608, t610;
  double t616, t617, t618, t619, t623, t628, t629, t633;
  double t634, t635, t639, t641, t644, t649, t651, t652;
  double t655, t659, t663, t664, t668, t670, t672, t674;
  double t676, t679, t681, tv3rho30, t684, t685, t686, t689;
  double t694, t695, t696, t697, t701, t702, t706, t709;
  double t713, t715, t719, t728, t729, t730, t733, t739;
  double t743, t744, t748, t751, t752, t754, t763, t765;
  double t768, tv3rho31, t771, t776, t779, t780, t784, t785;
  double t789, t791, t800, t801, t806, t810, t814, t815;
  double t819, t821, t828, t836, t838, t839, tv3rho32, t844;
  double t850, t851, t855, t856, t863, t864, t870, t874;
  double t875, t891, t892, t899, t901, t907, t908, t909;
  double t910, t918, t919, t923, t924, t925, t929, t931;
  double t934, t939, tv3rho33, t947, t954, t956, t958, t965;
  double t970, t975, tv3rho2sigma0, tv3rho2sigma1, t982, t986, t988, tv3rho2sigma2;
  double t994, t1002, tv3rho2sigma3, tv3rho2sigma4, t1008, t1015, t1018, tv3rho2sigma5;
  double t1026, tv3rho2sigma6, tv3rho2sigma7, t1037, t1044, t1049, t1054, tv3rho2sigma8;
  double t1061, t1062, t1070, t1074, t1077, t1082, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1089, t1091, tv3rhosigma25, t1097, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1102, t1110, t1114, t1117;
  double t1122, tv3rhosigma211, t1124, t1126, t1127, t1134, t1135, t1138;
  double t1148, t1149, t1153, t1155, t1158, t1162, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1163;
  double t1165, t1166, t1173, t1174, t1177, t1187, t1188, t1192;
  double t1194, t1197, t1201, tv3sigma39;

  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t38 = t34 * t37;
  t40 = t33 * t38 / 0.12e2;
  t41 = xc_integrate(func0, NULL, 0.0, t40);
  t42 = log(t40);
  t44 = xc_integrate(func1, NULL, 0.0, t40);
  t45 = t41 * t42 - t44;
  t49 = 0.1e1 - t33 * t38 * t45 / 0.12e2;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = my_piecewise5(t14, t11, t10, t15, -t17);
  t56 = 0.1e1 + t55;
  t57 = t56 <= p->zeta_threshold;
  t58 = POW_1_3(t56);
  t60 = my_piecewise3(t57, t22, t58 * t56);
  t61 = t60 * t26;
  t62 = sqrt(sigma[2]);
  t63 = POW_1_3(rho[1]);
  t65 = 0.1e1 / t63 / rho[1];
  t66 = t62 * t65;
  t68 = t33 * t66 / 0.12e2;
  t69 = xc_integrate(func0, NULL, 0.0, t68);
  t70 = log(t68);
  t72 = xc_integrate(func1, NULL, 0.0, t68);
  t73 = t69 * t70 - t72;
  t77 = 0.1e1 - t33 * t66 * t73 / 0.12e2;
  t81 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t77);
  tzk0 = t53 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t6 * t6;
  t83 = 0.1e1 / t82;
  t84 = t16 * t83;
  t85 = t7 - t84;
  t86 = my_piecewise5(t10, 0, t14, 0, t85);
  t89 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t86);
  t90 = t89 * t26;
  t94 = t26 * t26;
  t95 = 0.1e1 / t94;
  t96 = t25 * t95;
  t99 = t5 * t96 * t49 / 0.8e1;
  t100 = rho[0] * rho[0];
  t102 = 0.1e1 / t35 / t100;
  t103 = t34 * t102;
  t109 = t33 * t103 * t41 / 0.9e1 + t33 * t103 * t45 / 0.9e1;
  t114 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t49 - t99 - 0.3e1 / 0.8e1 * t5 * t27 * t109);
  t116 = my_piecewise5(t14, 0, t10, 0, -t85);
  t119 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t116);
  t120 = t119 * t26;
  t124 = t60 * t95;
  t127 = t5 * t124 * t77 / 0.8e1;
  t129 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t120 * t77 - t127);
  tvrho0 = t53 + t81 + t6 * (t114 + t129);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t132 = -t7 - t84;
  t133 = my_piecewise5(t10, 0, t14, 0, t132);
  t136 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t133);
  t137 = t136 * t26;
  t142 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t137 * t49 - t99);
  t144 = my_piecewise5(t14, 0, t10, 0, -t132);
  t147 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t144);
  t148 = t147 * t26;
  t152 = rho[1] * rho[1];
  t154 = 0.1e1 / t63 / t152;
  t155 = t62 * t154;
  t161 = t33 * t155 * t69 / 0.9e1 + t33 * t155 * t73 / 0.9e1;
  t166 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t148 * t77 - t127 - 0.3e1 / 0.8e1 * t5 * t61 * t161);
  tvrho1 = t53 + t81 + t6 * (t142 + t166);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t169 = 0.1e1 / t34;
  t170 = t169 * t37;
  t176 = -t33 * t170 * t41 / 0.24e2 - t33 * t170 * t45 / 0.24e2;
  t180 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t176);
  tvsigma0 = t6 * t180;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t181 = 0.1e1 / t62;
  t182 = t181 * t65;
  t188 = -t33 * t182 * t69 / 0.24e2 - t33 * t182 * t73 / 0.24e2;
  t192 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t188);
  tvsigma2 = t6 * t192;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t195 = t23 * t23;
  t196 = 0.1e1 / t195;
  t197 = t86 * t86;
  t200 = t82 * t6;
  t201 = 0.1e1 / t200;
  t202 = t16 * t201;
  t204 = -0.2e1 * t83 + 0.2e1 * t202;
  t205 = my_piecewise5(t10, 0, t14, 0, t204);
  t209 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t196 * t197 + 0.4e1 / 0.3e1 * t23 * t205);
  t210 = t209 * t26;
  t214 = t89 * t95;
  t216 = t5 * t214 * t49;
  t222 = 0.1e1 / t94 / t6;
  t223 = t25 * t222;
  t226 = t5 * t223 * t49 / 0.12e2;
  t228 = t5 * t96 * t109;
  t230 = t100 * rho[0];
  t232 = 0.1e1 / t35 / t230;
  t233 = t34 * t232;
  t240 = t31 * t31;
  t241 = 0.1e1 / t240;
  t242 = t28 * t241;
  t243 = t242 * sigma[0];
  t244 = t100 * t100;
  t245 = t35 * t35;
  t247 = 0.1e1 / t245 / t244;
  t249 = M_CBRT2;
  t250 = params->beta * t249;
  t251 = t250 * t29;
  t252 = t32 * t34;
  t253 = t249 * t29;
  t256 = t249 * t249;
  t257 = t256 * t28;
  t258 = t241 * sigma[0];
  t260 = 0.1e1 / t245 / t100;
  t264 = 0.6e1 * t257 * t258 * t260 + 0.144e3;
  t265 = sqrt(t264);
  t267 = t253 * t252 * t37 / 0.12e2 + t265 / 0.12e2;
  t268 = log(t267);
  t269 = t37 * t268;
  t273 = 0.1e1 + t251 * t252 * t269 / 0.4e1;
  t274 = 0.1e1 / t273;
  t275 = t249 * t274;
  t276 = t247 * params->beta * t275;
  t279 = -0.7e1 / 0.27e2 * t33 * t233 * t45 - 0.11e2 / 0.27e2 * t33 * t233 * t41 + t243 * t276 / 0.18e2;
  t284 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t210 * t49 - t216 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t90 * t109 + t226 - t228 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t279);
  t285 = t58 * t58;
  t286 = 0.1e1 / t285;
  t287 = t116 * t116;
  t291 = my_piecewise5(t14, 0, t10, 0, -t204);
  t295 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t286 * t287 + 0.4e1 / 0.3e1 * t58 * t291);
  t296 = t295 * t26;
  t300 = t119 * t95;
  t302 = t5 * t300 * t77;
  t304 = t60 * t222;
  t307 = t5 * t304 * t77 / 0.12e2;
  t309 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t296 * t77 - t302 / 0.4e1 + t307);
  tv2rho20 = 0.2e1 * t114 + 0.2e1 * t129 + t6 * (t284 + t309);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t312 = t196 * t133;
  t315 = 0.2e1 * t202;
  t316 = my_piecewise5(t10, 0, t14, 0, t315);
  t320 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t312 * t86 + 0.4e1 / 0.3e1 * t23 * t316);
  t321 = t320 * t26;
  t325 = t136 * t95;
  t327 = t5 * t325 * t49;
  t335 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t321 * t49 - t327 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t137 * t109 - t216 / 0.8e1 + t226 - t228 / 0.8e1);
  t336 = t286 * t144;
  t339 = my_piecewise5(t14, 0, t10, 0, -t315);
  t343 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t336 * t116 + 0.4e1 / 0.3e1 * t58 * t339);
  t344 = t343 * t26;
  t348 = t147 * t95;
  t350 = t5 * t348 * t77;
  t357 = t5 * t124 * t161;
  t360 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t344 * t77 - t350 / 0.8e1 - t302 / 0.8e1 + t307 - 0.3e1 / 0.8e1 * t5 * t120 * t161 - t357 / 0.8e1);
  tv2rho21 = t114 + t129 + t142 + t166 + t6 * (t335 + t360);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t365 = t133 * t133;
  t369 = 0.2e1 * t83 + 0.2e1 * t202;
  t370 = my_piecewise5(t10, 0, t14, 0, t369);
  t374 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t196 * t365 + 0.4e1 / 0.3e1 * t23 * t370);
  t375 = t374 * t26;
  t381 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t375 * t49 - t327 / 0.4e1 + t226);
  t382 = t144 * t144;
  t386 = my_piecewise5(t14, 0, t10, 0, -t369);
  t390 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t286 * t382 + 0.4e1 / 0.3e1 * t58 * t386);
  t391 = t390 * t26;
  t400 = t152 * rho[1];
  t402 = 0.1e1 / t63 / t400;
  t403 = t62 * t402;
  t410 = t242 * sigma[2];
  t411 = t152 * t152;
  t412 = t63 * t63;
  t414 = 0.1e1 / t412 / t411;
  t416 = t32 * t62;
  t419 = t241 * sigma[2];
  t421 = 0.1e1 / t412 / t152;
  t425 = 0.6e1 * t257 * t419 * t421 + 0.144e3;
  t426 = sqrt(t425);
  t428 = t253 * t416 * t65 / 0.12e2 + t426 / 0.12e2;
  t429 = log(t428);
  t430 = t65 * t429;
  t434 = 0.1e1 + t251 * t416 * t430 / 0.4e1;
  t435 = 0.1e1 / t434;
  t436 = t249 * t435;
  t437 = t414 * params->beta * t436;
  t440 = -0.7e1 / 0.27e2 * t33 * t403 * t73 - 0.11e2 / 0.27e2 * t33 * t403 * t69 + t410 * t437 / 0.18e2;
  t445 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t391 * t77 - t350 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t148 * t161 + t307 - t357 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t61 * t440);
  tv2rho22 = 0.2e1 * t142 + 0.2e1 * t166 + t6 * (t381 + t445);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t453 = t5 * t96 * t176 / 0.8e1;
  t454 = t169 * t102;
  t462 = 0.1e1 / t245 / t230;
  t463 = t242 * t462;
  t464 = t250 * t274;
  t467 = t33 * t454 * t45 / 0.18e2 + t33 * t454 * t41 / 0.9e1 - t463 * t464 / 0.48e2;
  t472 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t176 - t453 - 0.3e1 / 0.8e1 * t5 * t27 * t467);
  tv2rhosigma0 = t6 * t472 + t180;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t479 = t5 * t124 * t188 / 0.8e1;
  t481 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t120 * t188 - t479);
  tv2rhosigma2 = t6 * t481 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t487 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t137 * t176 - t453);
  tv2rhosigma3 = t6 * t487 + t180;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t492 = t181 * t154;
  t500 = 0.1e1 / t412 / t400;
  t501 = t242 * t500;
  t502 = t250 * t435;
  t505 = t33 * t492 * t73 / 0.18e2 + t33 * t492 * t69 / 0.9e1 - t501 * t502 / 0.48e2;
  t510 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t148 * t188 - t479 - 0.3e1 / 0.8e1 * t5 * t61 * t505);
  tv2rhosigma5 = t6 * t510 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t513 = 0.1e1 / t34 / sigma[0];
  t518 = 0.1e1 / sigma[0];
  t519 = t242 * t518;
  t521 = t260 * params->beta * t275;
  t524 = t33 * t513 * t37 * t45 / 0.48e2 + t519 * t521 / 0.128e3;
  t528 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t524);
  tv2sigma20 = t6 * t528;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t530 = 0.1e1 / t62 / sigma[2];
  t535 = 0.1e1 / sigma[2];
  t536 = t242 * t535;
  t538 = t421 * params->beta * t436;
  t541 = t33 * t530 * t65 * t73 / 0.48e2 + t536 * t538 / 0.128e3;
  t545 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t541);
  tv2sigma25 = t6 * t545;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t549 = 0.1e1 / t195 / t19;
  t550 = t197 * t86;
  t553 = t196 * t86;
  t556 = t82 * t82;
  t557 = 0.1e1 / t556;
  t558 = t16 * t557;
  t560 = 0.6e1 * t201 - 0.6e1 * t558;
  t561 = my_piecewise5(t10, 0, t14, 0, t560);
  t565 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t549 * t550 + 0.4e1 / 0.3e1 * t553 * t205 + 0.4e1 / 0.3e1 * t23 * t561);
  t566 = t565 * t26;
  t570 = t209 * t95;
  t572 = t5 * t570 * t49;
  t577 = t89 * t222;
  t579 = t5 * t577 * t49;
  t582 = t5 * t214 * t109;
  t588 = 0.1e1 / t94 / t82;
  t589 = t25 * t588;
  t592 = 0.5e1 / 0.36e2 * t5 * t589 * t49;
  t594 = t5 * t223 * t109;
  t597 = t5 * t96 * t279;
  t600 = 0.1e1 / t35 / t244;
  t601 = t34 * t600;
  t608 = t244 * rho[0];
  t610 = 0.1e1 / t245 / t608;
  t616 = t242 * sigma[0] * t247;
  t617 = t273 * t273;
  t618 = 0.1e1 / t617;
  t619 = t102 * t268;
  t623 = t250 * t33;
  t628 = 0.1e1 / t265 * t256;
  t629 = t628 * t28;
  t633 = -t253 * t252 * t102 / 0.9e1 - 0.2e1 / 0.3e1 * t629 * t258 * t462;
  t634 = 0.1e1 / t267;
  t635 = t633 * t634;
  t639 = -t251 * t252 * t619 / 0.3e1 + t623 * t38 * t635 / 0.4e1;
  t641 = t250 * t618 * t639;
  t644 = 0.7e2 / 0.81e2 * t33 * t601 * t45 + 0.46e2 / 0.27e2 * t33 * t601 * t41 - 0.25e2 / 0.54e2 * t243 * t610 * params->beta * t275 - t616 * t641 / 0.18e2;
  t649 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t566 * t49 - 0.3e1 / 0.8e1 * t572 - 0.9e1 / 0.8e1 * t5 * t210 * t109 + t579 / 0.4e1 - 0.3e1 / 0.4e1 * t582 - 0.9e1 / 0.8e1 * t5 * t90 * t279 - t592 + t594 / 0.4e1 - 0.3e1 / 0.8e1 * t597 - 0.3e1 / 0.8e1 * t5 * t27 * t644);
  t651 = 0.1e1 / t285 / t56;
  t652 = t287 * t116;
  t655 = t286 * t116;
  t659 = my_piecewise5(t14, 0, t10, 0, -t560);
  t663 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t651 * t652 + 0.4e1 / 0.3e1 * t655 * t291 + 0.4e1 / 0.3e1 * t58 * t659);
  t664 = t663 * t26;
  t668 = t295 * t95;
  t670 = t5 * t668 * t77;
  t672 = t119 * t222;
  t674 = t5 * t672 * t77;
  t676 = t60 * t588;
  t679 = 0.5e1 / 0.36e2 * t5 * t676 * t77;
  t681 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t664 * t77 - 0.3e1 / 0.8e1 * t670 + t674 / 0.4e1 - t679);
  tv3rho30 = 0.3e1 * t284 + 0.3e1 * t309 + t6 * (t649 + t681);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t684 = 0.2e1 * t335;
  t685 = 0.2e1 * t360;
  t686 = t549 * t133;
  t689 = t196 * t316;
  t694 = 0.2e1 * t201;
  t695 = 0.6e1 * t558;
  t696 = t694 - t695;
  t697 = my_piecewise5(t10, 0, t14, 0, t696);
  t701 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t686 * t197 + 0.8e1 / 0.9e1 * t689 * t86 + 0.4e1 / 0.9e1 * t312 * t205 + 0.4e1 / 0.3e1 * t23 * t697);
  t702 = t701 * t26;
  t706 = t320 * t95;
  t709 = t5 * t706 * t49 / 0.4e1;
  t713 = t136 * t222;
  t715 = t5 * t713 * t49;
  t719 = t5 * t325 * t109 / 0.4e1;
  t728 = -0.3e1 / 0.8e1 * t5 * t702 * t49 - t709 - 0.3e1 / 0.4e1 * t5 * t321 * t109 + t715 / 0.12e2 - t719 - 0.3e1 / 0.8e1 * t5 * t137 * t279 - t572 / 0.8e1 + t579 / 0.6e1 - t582 / 0.4e1 - t592 + t594 / 0.6e1 - t597 / 0.8e1;
  t729 = my_piecewise3(t1, 0, t728);
  t730 = t651 * t144;
  t733 = t286 * t339;
  t739 = my_piecewise5(t14, 0, t10, 0, -t696);
  t743 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t730 * t287 + 0.8e1 / 0.9e1 * t733 * t116 + 0.4e1 / 0.9e1 * t336 * t291 + 0.4e1 / 0.3e1 * t58 * t739);
  t744 = t743 * t26;
  t748 = t343 * t95;
  t751 = t5 * t748 * t77 / 0.4e1;
  t752 = t147 * t222;
  t754 = t5 * t752 * t77;
  t763 = t5 * t300 * t161 / 0.4e1;
  t765 = t5 * t304 * t161;
  t768 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t744 * t77 - t751 + t754 / 0.12e2 - t670 / 0.8e1 + t674 / 0.6e1 - t679 - 0.3e1 / 0.8e1 * t5 * t296 * t161 - t763 + t765 / 0.12e2);
  tv3rho31 = t284 + t309 + t684 + t685 + t6 * (t729 + t768);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t771 = t549 * t365;
  t776 = t196 * t370;
  t779 = -t694 - t695;
  t780 = my_piecewise5(t10, 0, t14, 0, t779);
  t784 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t771 * t86 + 0.8e1 / 0.9e1 * t312 * t316 + 0.4e1 / 0.9e1 * t776 * t86 + 0.4e1 / 0.3e1 * t23 * t780);
  t785 = t784 * t26;
  t789 = t374 * t95;
  t791 = t5 * t789 * t49;
  t800 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t785 * t49 - t791 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t375 * t109 - t709 + t715 / 0.6e1 - t719 + t579 / 0.12e2 - t592 + t594 / 0.12e2);
  t801 = t651 * t382;
  t806 = t286 * t386;
  t810 = my_piecewise5(t14, 0, t10, 0, -t779);
  t814 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t801 * t116 + 0.8e1 / 0.9e1 * t336 * t339 + 0.4e1 / 0.9e1 * t806 * t116 + 0.4e1 / 0.3e1 * t58 * t810);
  t815 = t814 * t26;
  t819 = t390 * t95;
  t821 = t5 * t819 * t77;
  t828 = t5 * t348 * t161;
  t836 = t5 * t124 * t440;
  t838 = -0.3e1 / 0.8e1 * t5 * t815 * t77 - t821 / 0.8e1 - t751 + t754 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t344 * t161 - t828 / 0.4e1 + t674 / 0.12e2 - t679 - t763 + t765 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t120 * t440 - t836 / 0.8e1;
  t839 = my_piecewise3(t54, 0, t838);
  tv3rho32 = t684 + t685 + t381 + t445 + t6 * (t800 + t839);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t844 = t365 * t133;
  t850 = -0.6e1 * t201 - 0.6e1 * t558;
  t851 = my_piecewise5(t10, 0, t14, 0, t850);
  t855 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t549 * t844 + 0.4e1 / 0.3e1 * t312 * t370 + 0.4e1 / 0.3e1 * t23 * t851);
  t856 = t855 * t26;
  t863 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t856 * t49 - 0.3e1 / 0.8e1 * t791 + t715 / 0.4e1 - t592);
  t864 = t382 * t144;
  t870 = my_piecewise5(t14, 0, t10, 0, -t850);
  t874 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t651 * t864 + 0.4e1 / 0.3e1 * t336 * t386 + 0.4e1 / 0.3e1 * t58 * t870);
  t875 = t874 * t26;
  t891 = 0.1e1 / t63 / t411;
  t892 = t62 * t891;
  t899 = t411 * rho[1];
  t901 = 0.1e1 / t412 / t899;
  t907 = t242 * sigma[2] * t414;
  t908 = t434 * t434;
  t909 = 0.1e1 / t908;
  t910 = t154 * t429;
  t918 = 0.1e1 / t426 * t256;
  t919 = t918 * t28;
  t923 = -t253 * t416 * t154 / 0.9e1 - 0.2e1 / 0.3e1 * t919 * t419 * t500;
  t924 = 0.1e1 / t428;
  t925 = t923 * t924;
  t929 = -t251 * t416 * t910 / 0.3e1 + t623 * t66 * t925 / 0.4e1;
  t931 = t250 * t909 * t929;
  t934 = 0.7e2 / 0.81e2 * t33 * t892 * t73 + 0.46e2 / 0.27e2 * t33 * t892 * t69 - 0.25e2 / 0.54e2 * t410 * t901 * params->beta * t436 - t907 * t931 / 0.18e2;
  t939 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t875 * t77 - 0.3e1 / 0.8e1 * t821 - 0.9e1 / 0.8e1 * t5 * t391 * t161 + t754 / 0.4e1 - 0.3e1 / 0.4e1 * t828 - 0.9e1 / 0.8e1 * t5 * t148 * t440 - t679 + t765 / 0.4e1 - 0.3e1 / 0.8e1 * t836 - 0.3e1 / 0.8e1 * t5 * t61 * t934);
  tv3rho33 = 0.3e1 * t381 + 0.3e1 * t445 + t6 * (t863 + t939);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t947 = t5 * t214 * t176;
  t954 = t5 * t223 * t176 / 0.12e2;
  t956 = t5 * t96 * t467;
  t958 = t169 * t232;
  t965 = t242 * t247;
  t970 = -0.7e1 / 0.54e2 * t33 * t958 * t45 - t33 * t958 * t41 / 0.3e1 + 0.19e2 / 0.144e3 * t965 * t464 + t463 * t641 / 0.48e2;
  t975 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t210 * t176 - t947 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t90 * t467 + t954 - t956 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t970);
  tv3rho2sigma0 = t6 * t975 + 0.2e1 * t472;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t982 = t5 * t300 * t188;
  t986 = t5 * t304 * t188 / 0.12e2;
  t988 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t296 * t188 - t982 / 0.4e1 + t986);
  tv3rho2sigma2 = t6 * t988 + 0.2e1 * t481;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t994 = t5 * t325 * t176;
  t1002 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t321 * t176 - t994 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t137 * t467 - t947 / 0.8e1 + t954 - t956 / 0.8e1);
  tv3rho2sigma3 = t6 * t1002 + t472 + t487;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1008 = t5 * t348 * t188;
  t1015 = t5 * t124 * t505;
  t1018 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t344 * t188 - t1008 / 0.8e1 - t982 / 0.8e1 + t986 - 0.3e1 / 0.8e1 * t5 * t120 * t505 - t1015 / 0.8e1);
  tv3rho2sigma5 = t6 * t1018 + t481 + t510;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1026 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t375 * t176 - t994 / 0.4e1 + t954);
  tv3rho2sigma6 = t6 * t1026 + 0.2e1 * t487;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1037 = t181 * t402;
  t1044 = t242 * t414;
  t1049 = -0.7e1 / 0.54e2 * t33 * t1037 * t73 - t33 * t1037 * t69 / 0.3e1 + 0.19e2 / 0.144e3 * t1044 * t502 + t501 * t931 / 0.48e2;
  t1054 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t391 * t188 - t1008 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t148 * t505 + t986 - t1015 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t61 * t1049);
  tv3rho2sigma8 = t6 * t1054 + 0.2e1 * t510;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1061 = t5 * t96 * t524 / 0.8e1;
  t1062 = t513 * t102;
  t1070 = t462 * params->beta * t275;
  t1074 = t242 * t518 * t260;
  t1077 = -t33 * t1062 * t45 / 0.36e2 - t33 * t1062 * t41 / 0.36e2 - t519 * t1070 / 0.48e2 - t1074 * t641 / 0.128e3;
  t1082 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t524 - t1061 - 0.3e1 / 0.8e1 * t5 * t27 * t1077);
  tv3rhosigma20 = t6 * t1082 + t528;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1089 = t5 * t124 * t541 / 0.8e1;
  t1091 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t120 * t541 - t1089);
  tv3rhosigma25 = t6 * t1091 + t545;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1097 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t137 * t524 - t1061);
  tv3rhosigma26 = t6 * t1097 + t528;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1102 = t530 * t154;
  t1110 = t500 * params->beta * t436;
  t1114 = t242 * t535 * t421;
  t1117 = -t33 * t1102 * t73 / 0.36e2 - t33 * t1102 * t69 / 0.36e2 - t536 * t1110 / 0.48e2 - t1114 * t931 / 0.128e3;
  t1122 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t148 * t541 - t1089 - 0.3e1 / 0.8e1 * t5 * t61 * t1117);
  tv3rhosigma211 = t6 * t1122 + t545;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1124 = sigma[0] * sigma[0];
  t1126 = 0.1e1 / t34 / t1124;
  t1127 = t1126 * t37;
  t1134 = 0.1e1 / t1124;
  t1135 = t242 * t1134;
  t1138 = t32 * t169;
  t1148 = t253 * t1138 * t37 / 0.24e2 + t628 * t242 * t260 / 0.4e1;
  t1149 = t1148 * t634;
  t1153 = t251 * t1138 * t269 / 0.8e1 + t623 * t38 * t1149 / 0.4e1;
  t1155 = t250 * t618 * t1153;
  t1158 = -t33 * t1127 * t45 / 0.32e2 + t33 * t1127 * t41 / 0.96e2 - t1135 * t521 / 0.128e3 - t1074 * t1155 / 0.128e3;
  t1162 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1158);
  tv3sigma30 = t6 * t1162;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1163 = sigma[2] * sigma[2];
  t1165 = 0.1e1 / t62 / t1163;
  t1166 = t1165 * t65;
  t1173 = 0.1e1 / t1163;
  t1174 = t242 * t1173;
  t1177 = t32 * t181;
  t1187 = t253 * t1177 * t65 / 0.24e2 + t918 * t242 * t421 / 0.4e1;
  t1188 = t1187 * t924;
  t1192 = t251 * t1177 * t430 / 0.8e1 + t623 * t66 * t1188 / 0.4e1;
  t1194 = t250 * t909 * t1192;
  t1197 = -t33 * t1166 * t73 / 0.32e2 + t33 * t1166 * t69 / 0.96e2 - t1174 * t538 / 0.128e3 - t1114 * t1194 / 0.128e3;
  t1201 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t1197);
  tv3sigma39 = t6 * t1201;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t37, t38, t40;
  double t41, t42, t44, t45, t49, t53, t54, t55;
  double t56, t57, t58, t60, t61, t62, t63, t65;
  double t66, t68, t69, t70, t72, t73, t77, t81;
  double tzk0;

  double t82, t83, t84, t85, t86, t89, t90, t94;
  double t95, t96, t99, t100, t102, t103, t109, t114;
  double t116, t119, t120, t124, t127, t129, tvrho0, t132;
  double t133, t136, t137, t142, t144, t147, t148, t152;
  double t154, t155, t161, t166, tvrho1, t169, t170, t176;
  double t180, tvsigma0, tvsigma1, t181, t182, t188, t192, tvsigma2;

  double t195, t196, t197, t200, t201, t202, t204, t205;
  double t209, t210, t214, t216, t222, t223, t226, t228;
  double t230, t232, t233, t240, t241, t242, t243, t244;
  double t245, t247, t249, t250, t251, t252, t253, t256;
  double t257, t258, t260, t264, t265, t267, t268, t269;
  double t273, t274, t275, t276, t279, t284, t285, t286;
  double t287, t291, t295, t296, t300, t302, t304, t307;
  double t309, tv2rho20, t312, t315, t316, t320, t321, t325;
  double t327, t335, t336, t339, t343, t344, t348, t350;
  double t357, t360, tv2rho21, t365, t369, t370, t374, t375;
  double t381, t382, t386, t390, t391, t400, t402, t403;
  double t410, t411, t412, t414, t416, t419, t421, t425;
  double t426, t428, t429, t430, t434, t435, t436, t437;
  double t440, t445, tv2rho22, t453, t454, t462, t463, t464;
  double t467, t472, tv2rhosigma0, tv2rhosigma1, t479, t481, tv2rhosigma2, t487;
  double tv2rhosigma3, tv2rhosigma4, t492, t500, t501, t502, t505, t510;
  double tv2rhosigma5, t513, t518, t519, t521, t524, t528, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t530, t535, t536, t538;
  double t541, t545, tv2sigma25;

  double t549, t550, t553, t556, t557, t558, t560, t561;
  double t565, t566, t570, t572, t577, t579, t582, t588;
  double t589, t592, t594, t597, t600, t601, t608, t610;
  double t616, t617, t618, t619, t623, t628, t629, t633;
  double t634, t635, t639, t641, t644, t649, t651, t652;
  double t655, t659, t663, t664, t668, t670, t672, t674;
  double t676, t679, t681, tv3rho30, t684, t685, t686, t689;
  double t694, t695, t696, t697, t701, t702, t706, t709;
  double t713, t715, t719, t728, t729, t730, t733, t739;
  double t743, t744, t748, t751, t752, t754, t763, t765;
  double t768, tv3rho31, t771, t776, t779, t780, t784, t785;
  double t789, t791, t800, t801, t806, t810, t814, t815;
  double t819, t821, t828, t836, t838, t839, tv3rho32, t844;
  double t850, t851, t855, t856, t863, t864, t870, t874;
  double t875, t891, t892, t899, t901, t907, t908, t909;
  double t910, t918, t919, t923, t924, t925, t929, t931;
  double t934, t939, tv3rho33, t947, t954, t956, t958, t965;
  double t970, t975, tv3rho2sigma0, tv3rho2sigma1, t982, t986, t988, tv3rho2sigma2;
  double t994, t1002, tv3rho2sigma3, tv3rho2sigma4, t1008, t1015, t1018, tv3rho2sigma5;
  double t1026, tv3rho2sigma6, tv3rho2sigma7, t1037, t1044, t1049, t1054, tv3rho2sigma8;
  double t1061, t1062, t1070, t1074, t1077, t1082, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1089, t1091, tv3rhosigma25, t1097, tv3rhosigma26;
  double tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1102, t1110, t1114, t1117;
  double t1122, tv3rhosigma211, t1124, t1126, t1127, t1134, t1135, t1138;
  double t1148, t1149, t1153, t1155, t1158, t1162, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1163;
  double t1165, t1166, t1173, t1174, t1177, t1187, t1188, t1192;
  double t1194, t1197, t1201, tv3sigma39;

  double t1204, t1206, t1207, t1213, t1220, t1222, t1223, t1227;
  double t1236, t1242, t1244, t1250, t1253, t1256, t1259, t1260;
  double t1267, t1279, t1280, t1282, t1297, t1298, t1300, t1316;
  double t1317, t1318, t1325, t1334, t1338, t1342, t1345, t1349;
  double t1350, t1351, t1352, t1354, t1355, t1361, t1367, t1371;
  double t1378, t1382, t1386, t1391, t1393, tv4rho40, t1414, t1415;
  double t1416, t1417, t1421, t1430, t1436, t1437, t1439, t1452;
  double t1453, t1456, t1460, t1465, t1466, t1484, t1488, t1495;
  double t1499, t1500, t1503, t1512, t1515, t1516, t1518, t1520;
  double t1521, tv4rho41, t1530, t1534, t1544, t1557, t1561, t1570;
  double t1586, t1587, t1596, t1609, t1613, t1620, t1624, t1633;
  double t1636, t1647, t1650, t1652, t1653, tv4rho42, t1673, t1674;
  double t1678, t1685, t1696, t1697, t1714, t1718, t1725, t1733;
  double t1742, t1752, t1754, t1755, tv4rho43, t1760, t1765, t1771;
  double t1772, t1776, t1785, t1792, t1797, t1803, t1807, t1822;
  double t1823, t1830, t1842, t1843, t1845, t1860, t1861, t1877;
  double t1878, t1879, t1886, t1895, t1896, tv4rho44, t1904, t1910;
  double t1913, t1920, t1922, t1925, t1927, t1948, tv4rho3sigma0, tv4rho3sigma1;
  double t1955, t1958, t1962, t1964, tv4rho3sigma2, t1966, t1972, t1977;
  double t1981, t1990, t1991, tv4rho3sigma3, tv4rho3sigma4, t1993, t1999, t2001;
  double t2010, t2012, t2015, tv4rho3sigma5, t2021, t2030, tv4rho3sigma6, tv4rho3sigma7;
  double t2036, t2043, t2051, t2053, t2054, tv4rho3sigma8, t2063, tv4rho3sigma9;
  double tv4rho3sigma10, t2080, t2101, tv4rho3sigma11, t2108, t2115, t2117, t2119;
  double t2129, t2141, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t2148;
  double t2152, t2154, tv4rho2sigma25, t2160, t2168, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28;
  double tv4rho2sigma29, tv4rho2sigma210, t2174, t2181, t2184, tv4rho2sigma211, t2192, tv4rho2sigma212;
  double tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t2203, t2213, t2225, tv4rho2sigma217;
  double t2232, t2233, t2243, t2293, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33;
  double tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t2300, t2302, tv4rhosigma39;
  double t2308, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316;
  double tv4rhosigma317, tv4rhosigma318, t2313, t2323, t2373, tv4rhosigma319, t2375, t2378;
  double t2391, t2396, t2406, t2415, t2429, tv4sigma40, tv4sigma41, tv4sigma42;
  double tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410;
  double tv4sigma411, tv4sigma412, tv4sigma413, t2430, t2433, t2446, t2451, t2469;
  double t2483, tv4sigma414;

  gga_x_fd_lb94_params *params;

  assert(p->params != NULL);
  params = (gga_x_fd_lb94_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = 0.1e1 / t31;
  t33 = t29 * t32;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t38 = t34 * t37;
  t40 = t33 * t38 / 0.12e2;
  t41 = xc_integrate(func0, NULL, 0.0, t40);
  t42 = log(t40);
  t44 = xc_integrate(func1, NULL, 0.0, t40);
  t45 = t41 * t42 - t44;
  t49 = 0.1e1 - t33 * t38 * t45 / 0.12e2;
  t53 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t49);
  t54 = rho[1] <= p->dens_threshold;
  t55 = my_piecewise5(t14, t11, t10, t15, -t17);
  t56 = 0.1e1 + t55;
  t57 = t56 <= p->zeta_threshold;
  t58 = POW_1_3(t56);
  t60 = my_piecewise3(t57, t22, t58 * t56);
  t61 = t60 * t26;
  t62 = sqrt(sigma[2]);
  t63 = POW_1_3(rho[1]);
  t65 = 0.1e1 / t63 / rho[1];
  t66 = t62 * t65;
  t68 = t33 * t66 / 0.12e2;
  t69 = xc_integrate(func0, NULL, 0.0, t68);
  t70 = log(t68);
  t72 = xc_integrate(func1, NULL, 0.0, t68);
  t73 = t69 * t70 - t72;
  t77 = 0.1e1 - t33 * t66 * t73 / 0.12e2;
  t81 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t77);
  tzk0 = t53 + t81;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t82 = t6 * t6;
  t83 = 0.1e1 / t82;
  t84 = t16 * t83;
  t85 = t7 - t84;
  t86 = my_piecewise5(t10, 0, t14, 0, t85);
  t89 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t86);
  t90 = t89 * t26;
  t94 = t26 * t26;
  t95 = 0.1e1 / t94;
  t96 = t25 * t95;
  t99 = t5 * t96 * t49 / 0.8e1;
  t100 = rho[0] * rho[0];
  t102 = 0.1e1 / t35 / t100;
  t103 = t34 * t102;
  t109 = t33 * t103 * t41 / 0.9e1 + t33 * t103 * t45 / 0.9e1;
  t114 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t49 - t99 - 0.3e1 / 0.8e1 * t5 * t27 * t109);
  t116 = my_piecewise5(t14, 0, t10, 0, -t85);
  t119 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t116);
  t120 = t119 * t26;
  t124 = t60 * t95;
  t127 = t5 * t124 * t77 / 0.8e1;
  t129 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t120 * t77 - t127);
  tvrho0 = t53 + t81 + t6 * (t114 + t129);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t132 = -t7 - t84;
  t133 = my_piecewise5(t10, 0, t14, 0, t132);
  t136 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t133);
  t137 = t136 * t26;
  t142 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t137 * t49 - t99);
  t144 = my_piecewise5(t14, 0, t10, 0, -t132);
  t147 = my_piecewise3(t57, 0, 0.4e1 / 0.3e1 * t58 * t144);
  t148 = t147 * t26;
  t152 = rho[1] * rho[1];
  t154 = 0.1e1 / t63 / t152;
  t155 = t62 * t154;
  t161 = t33 * t155 * t69 / 0.9e1 + t33 * t155 * t73 / 0.9e1;
  t166 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t148 * t77 - t127 - 0.3e1 / 0.8e1 * t5 * t61 * t161);
  tvrho1 = t53 + t81 + t6 * (t142 + t166);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t169 = 0.1e1 / t34;
  t170 = t169 * t37;
  t176 = -t33 * t170 * t41 / 0.24e2 - t33 * t170 * t45 / 0.24e2;
  t180 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t176);
  tvsigma0 = t6 * t180;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t181 = 0.1e1 / t62;
  t182 = t181 * t65;
  t188 = -t33 * t182 * t69 / 0.24e2 - t33 * t182 * t73 / 0.24e2;
  t192 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t188);
  tvsigma2 = t6 * t192;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t195 = t23 * t23;
  t196 = 0.1e1 / t195;
  t197 = t86 * t86;
  t200 = t82 * t6;
  t201 = 0.1e1 / t200;
  t202 = t16 * t201;
  t204 = -0.2e1 * t83 + 0.2e1 * t202;
  t205 = my_piecewise5(t10, 0, t14, 0, t204);
  t209 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t196 * t197 + 0.4e1 / 0.3e1 * t23 * t205);
  t210 = t209 * t26;
  t214 = t89 * t95;
  t216 = t5 * t214 * t49;
  t222 = 0.1e1 / t94 / t6;
  t223 = t25 * t222;
  t226 = t5 * t223 * t49 / 0.12e2;
  t228 = t5 * t96 * t109;
  t230 = t100 * rho[0];
  t232 = 0.1e1 / t35 / t230;
  t233 = t34 * t232;
  t240 = t31 * t31;
  t241 = 0.1e1 / t240;
  t242 = t28 * t241;
  t243 = t242 * sigma[0];
  t244 = t100 * t100;
  t245 = t35 * t35;
  t247 = 0.1e1 / t245 / t244;
  t249 = M_CBRT2;
  t250 = params->beta * t249;
  t251 = t250 * t29;
  t252 = t32 * t34;
  t253 = t249 * t29;
  t256 = t249 * t249;
  t257 = t256 * t28;
  t258 = t241 * sigma[0];
  t260 = 0.1e1 / t245 / t100;
  t264 = 0.6e1 * t257 * t258 * t260 + 0.144e3;
  t265 = sqrt(t264);
  t267 = t253 * t252 * t37 / 0.12e2 + t265 / 0.12e2;
  t268 = log(t267);
  t269 = t37 * t268;
  t273 = 0.1e1 + t251 * t252 * t269 / 0.4e1;
  t274 = 0.1e1 / t273;
  t275 = t249 * t274;
  t276 = t247 * params->beta * t275;
  t279 = -0.7e1 / 0.27e2 * t33 * t233 * t45 - 0.11e2 / 0.27e2 * t33 * t233 * t41 + t243 * t276 / 0.18e2;
  t284 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t210 * t49 - t216 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t90 * t109 + t226 - t228 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t279);
  t285 = t58 * t58;
  t286 = 0.1e1 / t285;
  t287 = t116 * t116;
  t291 = my_piecewise5(t14, 0, t10, 0, -t204);
  t295 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t286 * t287 + 0.4e1 / 0.3e1 * t58 * t291);
  t296 = t295 * t26;
  t300 = t119 * t95;
  t302 = t5 * t300 * t77;
  t304 = t60 * t222;
  t307 = t5 * t304 * t77 / 0.12e2;
  t309 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t296 * t77 - t302 / 0.4e1 + t307);
  tv2rho20 = 0.2e1 * t114 + 0.2e1 * t129 + t6 * (t284 + t309);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t312 = t196 * t133;
  t315 = 0.2e1 * t202;
  t316 = my_piecewise5(t10, 0, t14, 0, t315);
  t320 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t312 * t86 + 0.4e1 / 0.3e1 * t23 * t316);
  t321 = t320 * t26;
  t325 = t136 * t95;
  t327 = t5 * t325 * t49;
  t335 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t321 * t49 - t327 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t137 * t109 - t216 / 0.8e1 + t226 - t228 / 0.8e1);
  t336 = t286 * t144;
  t339 = my_piecewise5(t14, 0, t10, 0, -t315);
  t343 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t336 * t116 + 0.4e1 / 0.3e1 * t58 * t339);
  t344 = t343 * t26;
  t348 = t147 * t95;
  t350 = t5 * t348 * t77;
  t357 = t5 * t124 * t161;
  t360 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t344 * t77 - t350 / 0.8e1 - t302 / 0.8e1 + t307 - 0.3e1 / 0.8e1 * t5 * t120 * t161 - t357 / 0.8e1);
  tv2rho21 = t114 + t129 + t142 + t166 + t6 * (t335 + t360);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t365 = t133 * t133;
  t369 = 0.2e1 * t83 + 0.2e1 * t202;
  t370 = my_piecewise5(t10, 0, t14, 0, t369);
  t374 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t196 * t365 + 0.4e1 / 0.3e1 * t23 * t370);
  t375 = t374 * t26;
  t381 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t375 * t49 - t327 / 0.4e1 + t226);
  t382 = t144 * t144;
  t386 = my_piecewise5(t14, 0, t10, 0, -t369);
  t390 = my_piecewise3(t57, 0, 0.4e1 / 0.9e1 * t286 * t382 + 0.4e1 / 0.3e1 * t58 * t386);
  t391 = t390 * t26;
  t400 = t152 * rho[1];
  t402 = 0.1e1 / t63 / t400;
  t403 = t62 * t402;
  t410 = t242 * sigma[2];
  t411 = t152 * t152;
  t412 = t63 * t63;
  t414 = 0.1e1 / t412 / t411;
  t416 = t32 * t62;
  t419 = t241 * sigma[2];
  t421 = 0.1e1 / t412 / t152;
  t425 = 0.6e1 * t257 * t419 * t421 + 0.144e3;
  t426 = sqrt(t425);
  t428 = t253 * t416 * t65 / 0.12e2 + t426 / 0.12e2;
  t429 = log(t428);
  t430 = t65 * t429;
  t434 = 0.1e1 + t251 * t416 * t430 / 0.4e1;
  t435 = 0.1e1 / t434;
  t436 = t249 * t435;
  t437 = t414 * params->beta * t436;
  t440 = -0.7e1 / 0.27e2 * t33 * t403 * t73 - 0.11e2 / 0.27e2 * t33 * t403 * t69 + t410 * t437 / 0.18e2;
  t445 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t391 * t77 - t350 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t148 * t161 + t307 - t357 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t61 * t440);
  tv2rho22 = 0.2e1 * t142 + 0.2e1 * t166 + t6 * (t381 + t445);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t453 = t5 * t96 * t176 / 0.8e1;
  t454 = t169 * t102;
  t462 = 0.1e1 / t245 / t230;
  t463 = t242 * t462;
  t464 = t250 * t274;
  t467 = t33 * t454 * t45 / 0.18e2 + t33 * t454 * t41 / 0.9e1 - t463 * t464 / 0.48e2;
  t472 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t176 - t453 - 0.3e1 / 0.8e1 * t5 * t27 * t467);
  tv2rhosigma0 = t6 * t472 + t180;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t479 = t5 * t124 * t188 / 0.8e1;
  t481 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t120 * t188 - t479);
  tv2rhosigma2 = t6 * t481 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t487 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t137 * t176 - t453);
  tv2rhosigma3 = t6 * t487 + t180;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t492 = t181 * t154;
  t500 = 0.1e1 / t412 / t400;
  t501 = t242 * t500;
  t502 = t250 * t435;
  t505 = t33 * t492 * t73 / 0.18e2 + t33 * t492 * t69 / 0.9e1 - t501 * t502 / 0.48e2;
  t510 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t148 * t188 - t479 - 0.3e1 / 0.8e1 * t5 * t61 * t505);
  tv2rhosigma5 = t6 * t510 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t513 = 0.1e1 / t34 / sigma[0];
  t518 = 0.1e1 / sigma[0];
  t519 = t242 * t518;
  t521 = t260 * params->beta * t275;
  t524 = t33 * t513 * t37 * t45 / 0.48e2 + t519 * t521 / 0.128e3;
  t528 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t524);
  tv2sigma20 = t6 * t528;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t530 = 0.1e1 / t62 / sigma[2];
  t535 = 0.1e1 / sigma[2];
  t536 = t242 * t535;
  t538 = t421 * params->beta * t436;
  t541 = t33 * t530 * t65 * t73 / 0.48e2 + t536 * t538 / 0.128e3;
  t545 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t541);
  tv2sigma25 = t6 * t545;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t549 = 0.1e1 / t195 / t19;
  t550 = t197 * t86;
  t553 = t196 * t86;
  t556 = t82 * t82;
  t557 = 0.1e1 / t556;
  t558 = t16 * t557;
  t560 = 0.6e1 * t201 - 0.6e1 * t558;
  t561 = my_piecewise5(t10, 0, t14, 0, t560);
  t565 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t549 * t550 + 0.4e1 / 0.3e1 * t553 * t205 + 0.4e1 / 0.3e1 * t23 * t561);
  t566 = t565 * t26;
  t570 = t209 * t95;
  t572 = t5 * t570 * t49;
  t577 = t89 * t222;
  t579 = t5 * t577 * t49;
  t582 = t5 * t214 * t109;
  t588 = 0.1e1 / t94 / t82;
  t589 = t25 * t588;
  t592 = 0.5e1 / 0.36e2 * t5 * t589 * t49;
  t594 = t5 * t223 * t109;
  t597 = t5 * t96 * t279;
  t600 = 0.1e1 / t35 / t244;
  t601 = t34 * t600;
  t608 = t244 * rho[0];
  t610 = 0.1e1 / t245 / t608;
  t616 = t242 * sigma[0] * t247;
  t617 = t273 * t273;
  t618 = 0.1e1 / t617;
  t619 = t102 * t268;
  t623 = t250 * t33;
  t628 = 0.1e1 / t265 * t256;
  t629 = t628 * t28;
  t633 = -t253 * t252 * t102 / 0.9e1 - 0.2e1 / 0.3e1 * t629 * t258 * t462;
  t634 = 0.1e1 / t267;
  t635 = t633 * t634;
  t639 = -t251 * t252 * t619 / 0.3e1 + t623 * t38 * t635 / 0.4e1;
  t641 = t250 * t618 * t639;
  t644 = 0.7e2 / 0.81e2 * t33 * t601 * t45 + 0.46e2 / 0.27e2 * t33 * t601 * t41 - 0.25e2 / 0.54e2 * t243 * t610 * params->beta * t275 - t616 * t641 / 0.18e2;
  t649 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t566 * t49 - 0.3e1 / 0.8e1 * t572 - 0.9e1 / 0.8e1 * t5 * t210 * t109 + t579 / 0.4e1 - 0.3e1 / 0.4e1 * t582 - 0.9e1 / 0.8e1 * t5 * t90 * t279 - t592 + t594 / 0.4e1 - 0.3e1 / 0.8e1 * t597 - 0.3e1 / 0.8e1 * t5 * t27 * t644);
  t651 = 0.1e1 / t285 / t56;
  t652 = t287 * t116;
  t655 = t286 * t116;
  t659 = my_piecewise5(t14, 0, t10, 0, -t560);
  t663 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t651 * t652 + 0.4e1 / 0.3e1 * t655 * t291 + 0.4e1 / 0.3e1 * t58 * t659);
  t664 = t663 * t26;
  t668 = t295 * t95;
  t670 = t5 * t668 * t77;
  t672 = t119 * t222;
  t674 = t5 * t672 * t77;
  t676 = t60 * t588;
  t679 = 0.5e1 / 0.36e2 * t5 * t676 * t77;
  t681 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t664 * t77 - 0.3e1 / 0.8e1 * t670 + t674 / 0.4e1 - t679);
  tv3rho30 = 0.3e1 * t284 + 0.3e1 * t309 + t6 * (t649 + t681);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t684 = 0.2e1 * t335;
  t685 = 0.2e1 * t360;
  t686 = t549 * t133;
  t689 = t196 * t316;
  t694 = 0.2e1 * t201;
  t695 = 0.6e1 * t558;
  t696 = t694 - t695;
  t697 = my_piecewise5(t10, 0, t14, 0, t696);
  t701 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t686 * t197 + 0.8e1 / 0.9e1 * t689 * t86 + 0.4e1 / 0.9e1 * t312 * t205 + 0.4e1 / 0.3e1 * t23 * t697);
  t702 = t701 * t26;
  t706 = t320 * t95;
  t709 = t5 * t706 * t49 / 0.4e1;
  t713 = t136 * t222;
  t715 = t5 * t713 * t49;
  t719 = t5 * t325 * t109 / 0.4e1;
  t728 = -0.3e1 / 0.8e1 * t5 * t702 * t49 - t709 - 0.3e1 / 0.4e1 * t5 * t321 * t109 + t715 / 0.12e2 - t719 - 0.3e1 / 0.8e1 * t5 * t137 * t279 - t572 / 0.8e1 + t579 / 0.6e1 - t582 / 0.4e1 - t592 + t594 / 0.6e1 - t597 / 0.8e1;
  t729 = my_piecewise3(t1, 0, t728);
  t730 = t651 * t144;
  t733 = t286 * t339;
  t739 = my_piecewise5(t14, 0, t10, 0, -t696);
  t743 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t730 * t287 + 0.8e1 / 0.9e1 * t733 * t116 + 0.4e1 / 0.9e1 * t336 * t291 + 0.4e1 / 0.3e1 * t58 * t739);
  t744 = t743 * t26;
  t748 = t343 * t95;
  t751 = t5 * t748 * t77 / 0.4e1;
  t752 = t147 * t222;
  t754 = t5 * t752 * t77;
  t763 = t5 * t300 * t161 / 0.4e1;
  t765 = t5 * t304 * t161;
  t768 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t744 * t77 - t751 + t754 / 0.12e2 - t670 / 0.8e1 + t674 / 0.6e1 - t679 - 0.3e1 / 0.8e1 * t5 * t296 * t161 - t763 + t765 / 0.12e2);
  tv3rho31 = t284 + t309 + t684 + t685 + t6 * (t729 + t768);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t771 = t549 * t365;
  t776 = t196 * t370;
  t779 = -t694 - t695;
  t780 = my_piecewise5(t10, 0, t14, 0, t779);
  t784 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t771 * t86 + 0.8e1 / 0.9e1 * t312 * t316 + 0.4e1 / 0.9e1 * t776 * t86 + 0.4e1 / 0.3e1 * t23 * t780);
  t785 = t784 * t26;
  t789 = t374 * t95;
  t791 = t5 * t789 * t49;
  t800 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t785 * t49 - t791 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t375 * t109 - t709 + t715 / 0.6e1 - t719 + t579 / 0.12e2 - t592 + t594 / 0.12e2);
  t801 = t651 * t382;
  t806 = t286 * t386;
  t810 = my_piecewise5(t14, 0, t10, 0, -t779);
  t814 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t801 * t116 + 0.8e1 / 0.9e1 * t336 * t339 + 0.4e1 / 0.9e1 * t806 * t116 + 0.4e1 / 0.3e1 * t58 * t810);
  t815 = t814 * t26;
  t819 = t390 * t95;
  t821 = t5 * t819 * t77;
  t828 = t5 * t348 * t161;
  t836 = t5 * t124 * t440;
  t838 = -0.3e1 / 0.8e1 * t5 * t815 * t77 - t821 / 0.8e1 - t751 + t754 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t344 * t161 - t828 / 0.4e1 + t674 / 0.12e2 - t679 - t763 + t765 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t120 * t440 - t836 / 0.8e1;
  t839 = my_piecewise3(t54, 0, t838);
  tv3rho32 = t684 + t685 + t381 + t445 + t6 * (t800 + t839);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t844 = t365 * t133;
  t850 = -0.6e1 * t201 - 0.6e1 * t558;
  t851 = my_piecewise5(t10, 0, t14, 0, t850);
  t855 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t549 * t844 + 0.4e1 / 0.3e1 * t312 * t370 + 0.4e1 / 0.3e1 * t23 * t851);
  t856 = t855 * t26;
  t863 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t856 * t49 - 0.3e1 / 0.8e1 * t791 + t715 / 0.4e1 - t592);
  t864 = t382 * t144;
  t870 = my_piecewise5(t14, 0, t10, 0, -t850);
  t874 = my_piecewise3(t57, 0, -0.8e1 / 0.27e2 * t651 * t864 + 0.4e1 / 0.3e1 * t336 * t386 + 0.4e1 / 0.3e1 * t58 * t870);
  t875 = t874 * t26;
  t891 = 0.1e1 / t63 / t411;
  t892 = t62 * t891;
  t899 = t411 * rho[1];
  t901 = 0.1e1 / t412 / t899;
  t907 = t242 * sigma[2] * t414;
  t908 = t434 * t434;
  t909 = 0.1e1 / t908;
  t910 = t154 * t429;
  t918 = 0.1e1 / t426 * t256;
  t919 = t918 * t28;
  t923 = -t253 * t416 * t154 / 0.9e1 - 0.2e1 / 0.3e1 * t919 * t419 * t500;
  t924 = 0.1e1 / t428;
  t925 = t923 * t924;
  t929 = -t251 * t416 * t910 / 0.3e1 + t623 * t66 * t925 / 0.4e1;
  t931 = t250 * t909 * t929;
  t934 = 0.7e2 / 0.81e2 * t33 * t892 * t73 + 0.46e2 / 0.27e2 * t33 * t892 * t69 - 0.25e2 / 0.54e2 * t410 * t901 * params->beta * t436 - t907 * t931 / 0.18e2;
  t939 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t875 * t77 - 0.3e1 / 0.8e1 * t821 - 0.9e1 / 0.8e1 * t5 * t391 * t161 + t754 / 0.4e1 - 0.3e1 / 0.4e1 * t828 - 0.9e1 / 0.8e1 * t5 * t148 * t440 - t679 + t765 / 0.4e1 - 0.3e1 / 0.8e1 * t836 - 0.3e1 / 0.8e1 * t5 * t61 * t934);
  tv3rho33 = 0.3e1 * t381 + 0.3e1 * t445 + t6 * (t863 + t939);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t947 = t5 * t214 * t176;
  t954 = t5 * t223 * t176 / 0.12e2;
  t956 = t5 * t96 * t467;
  t958 = t169 * t232;
  t965 = t242 * t247;
  t970 = -0.7e1 / 0.54e2 * t33 * t958 * t45 - t33 * t958 * t41 / 0.3e1 + 0.19e2 / 0.144e3 * t965 * t464 + t463 * t641 / 0.48e2;
  t975 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t210 * t176 - t947 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t90 * t467 + t954 - t956 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t970);
  tv3rho2sigma0 = t6 * t975 + 0.2e1 * t472;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t982 = t5 * t300 * t188;
  t986 = t5 * t304 * t188 / 0.12e2;
  t988 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t296 * t188 - t982 / 0.4e1 + t986);
  tv3rho2sigma2 = t6 * t988 + 0.2e1 * t481;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t994 = t5 * t325 * t176;
  t1002 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t321 * t176 - t994 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t137 * t467 - t947 / 0.8e1 + t954 - t956 / 0.8e1);
  tv3rho2sigma3 = t6 * t1002 + t472 + t487;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1008 = t5 * t348 * t188;
  t1015 = t5 * t124 * t505;
  t1018 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t344 * t188 - t1008 / 0.8e1 - t982 / 0.8e1 + t986 - 0.3e1 / 0.8e1 * t5 * t120 * t505 - t1015 / 0.8e1);
  tv3rho2sigma5 = t6 * t1018 + t481 + t510;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1026 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t375 * t176 - t994 / 0.4e1 + t954);
  tv3rho2sigma6 = t6 * t1026 + 0.2e1 * t487;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1037 = t181 * t402;
  t1044 = t242 * t414;
  t1049 = -0.7e1 / 0.54e2 * t33 * t1037 * t73 - t33 * t1037 * t69 / 0.3e1 + 0.19e2 / 0.144e3 * t1044 * t502 + t501 * t931 / 0.48e2;
  t1054 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t391 * t188 - t1008 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t148 * t505 + t986 - t1015 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t61 * t1049);
  tv3rho2sigma8 = t6 * t1054 + 0.2e1 * t510;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1061 = t5 * t96 * t524 / 0.8e1;
  t1062 = t513 * t102;
  t1070 = t462 * params->beta * t275;
  t1074 = t242 * t518 * t260;
  t1077 = -t33 * t1062 * t45 / 0.36e2 - t33 * t1062 * t41 / 0.36e2 - t519 * t1070 / 0.48e2 - t1074 * t641 / 0.128e3;
  t1082 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t524 - t1061 - 0.3e1 / 0.8e1 * t5 * t27 * t1077);
  tv3rhosigma20 = t6 * t1082 + t528;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1089 = t5 * t124 * t541 / 0.8e1;
  t1091 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t120 * t541 - t1089);
  tv3rhosigma25 = t6 * t1091 + t545;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1097 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t137 * t524 - t1061);
  tv3rhosigma26 = t6 * t1097 + t528;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1102 = t530 * t154;
  t1110 = t500 * params->beta * t436;
  t1114 = t242 * t535 * t421;
  t1117 = -t33 * t1102 * t73 / 0.36e2 - t33 * t1102 * t69 / 0.36e2 - t536 * t1110 / 0.48e2 - t1114 * t931 / 0.128e3;
  t1122 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t148 * t541 - t1089 - 0.3e1 / 0.8e1 * t5 * t61 * t1117);
  tv3rhosigma211 = t6 * t1122 + t545;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1124 = sigma[0] * sigma[0];
  t1126 = 0.1e1 / t34 / t1124;
  t1127 = t1126 * t37;
  t1134 = 0.1e1 / t1124;
  t1135 = t242 * t1134;
  t1138 = t32 * t169;
  t1148 = t253 * t1138 * t37 / 0.24e2 + t628 * t242 * t260 / 0.4e1;
  t1149 = t1148 * t634;
  t1153 = t251 * t1138 * t269 / 0.8e1 + t623 * t38 * t1149 / 0.4e1;
  t1155 = t250 * t618 * t1153;
  t1158 = -t33 * t1127 * t45 / 0.32e2 + t33 * t1127 * t41 / 0.96e2 - t1135 * t521 / 0.128e3 - t1074 * t1155 / 0.128e3;
  t1162 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1158);
  tv3sigma30 = t6 * t1162;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1163 = sigma[2] * sigma[2];
  t1165 = 0.1e1 / t62 / t1163;
  t1166 = t1165 * t65;
  t1173 = 0.1e1 / t1163;
  t1174 = t242 * t1173;
  t1177 = t32 * t181;
  t1187 = t253 * t1177 * t65 / 0.24e2 + t918 * t242 * t421 / 0.4e1;
  t1188 = t1187 * t924;
  t1192 = t251 * t1177 * t430 / 0.8e1 + t623 * t66 * t1188 / 0.4e1;
  t1194 = t250 * t909 * t1192;
  t1197 = -t33 * t1166 * t73 / 0.32e2 + t33 * t1166 * t69 / 0.96e2 - t1174 * t538 / 0.128e3 - t1114 * t1194 / 0.128e3;
  t1201 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * t1197);
  tv3sigma39 = t6 * t1201;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1204 = t19 * t19;
  t1206 = 0.1e1 / t195 / t1204;
  t1207 = t197 * t197;
  t1213 = t205 * t205;
  t1220 = t16 / t556 / t6;
  t1222 = -0.24e2 * t557 + 0.24e2 * t1220;
  t1223 = my_piecewise5(t10, 0, t14, 0, t1222);
  t1227 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1206 * t1207 - 0.16e2 / 0.9e1 * t549 * t197 * t205 + 0.4e1 / 0.3e1 * t196 * t1213 + 0.16e2 / 0.9e1 * t553 * t561 + 0.4e1 / 0.3e1 * t23 * t1223);
  t1236 = t5 * t570 * t109;
  t1242 = t5 * t577 * t109;
  t1244 = t5 * t214 * t279;
  t1250 = t5 * t589 * t109;
  t1253 = t5 * t223 * t279;
  t1256 = t5 * t96 * t644;
  t1259 = 0.1e1 / t35 / t608;
  t1260 = t34 * t1259;
  t1267 = t244 * t100;
  t1279 = 0.1e1 / t617 / t273;
  t1280 = t639 * t639;
  t1282 = t250 * t1279 * t1280;
  t1297 = 0.1e1 / t265 / t264 * t249;
  t1298 = t1297 * t29;
  t1300 = 0.1e1 / t31 / t30;
  t1316 = t633 * t633;
  t1317 = t267 * t267;
  t1318 = 0.1e1 / t1317;
  t1325 = t250 * t618 * (0.7e1 / 0.9e1 * t251 * t252 * t232 * t268 - 0.2e1 / 0.3e1 * t623 * t103 * t635 + t623 * t38 * (0.7e1 / 0.27e2 * t253 * t252 * t232 - 0.32e2 / 0.3e1 * t1298 * t1300 * t1124 / t35 / t244 / t230 + 0.22e2 / 0.9e1 * t629 * t258 * t247) * t634 / 0.4e1 - t623 * t38 * t1316 * t1318 / 0.4e1);
  t1334 = t5 * t565 * t95 * t49;
  t1338 = t5 * t209 * t222 * t49;
  t1342 = t5 * t89 * t588 * t49;
  t1345 = 0.1e1 / t94 / t200;
  t1349 = 0.1e2 / 0.27e2 * t5 * t25 * t1345 * t49;
  t1350 = -0.3e1 / 0.8e1 * t5 * t1227 * t26 * t49 - 0.3e1 / 0.2e1 * t5 * t566 * t109 - 0.3e1 / 0.2e1 * t1236 - 0.9e1 / 0.4e1 * t5 * t210 * t279 + t1242 - 0.3e1 / 0.2e1 * t1244 - 0.3e1 / 0.2e1 * t5 * t90 * t644 - 0.5e1 / 0.9e1 * t1250 + t1253 / 0.2e1 - t1256 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.91e3 / 0.243e3 * t33 * t1260 * t45 - 0.2074e4 / 0.243e3 * t33 * t1260 * t41 + 0.563e3 / 0.162e3 * t243 / t245 / t1267 * params->beta * t275 + 0.13e2 / 0.18e2 * t242 * sigma[0] * t610 * t641 + t616 * t1282 / 0.9e1 - t616 * t1325 / 0.18e2) - t1334 / 0.2e1 + t1338 / 0.2e1 - 0.5e1 / 0.9e1 * t1342 + t1349;
  t1351 = my_piecewise3(t1, 0, t1350);
  t1352 = t56 * t56;
  t1354 = 0.1e1 / t285 / t1352;
  t1355 = t287 * t287;
  t1361 = t291 * t291;
  t1367 = my_piecewise5(t14, 0, t10, 0, -t1222);
  t1371 = my_piecewise3(t57, 0, 0.4e2 / 0.81e2 * t1354 * t1355 - 0.16e2 / 0.9e1 * t651 * t287 * t291 + 0.4e1 / 0.3e1 * t286 * t1361 + 0.16e2 / 0.9e1 * t655 * t659 + 0.4e1 / 0.3e1 * t58 * t1367);
  t1378 = t5 * t663 * t95 * t77;
  t1382 = t5 * t295 * t222 * t77;
  t1386 = t5 * t119 * t588 * t77;
  t1391 = 0.1e2 / 0.27e2 * t5 * t60 * t1345 * t77;
  t1393 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t1371 * t26 * t77 - t1378 / 0.2e1 + t1382 / 0.2e1 - 0.5e1 / 0.9e1 * t1386 + t1391);
  tv4rho40 = 0.4e1 * t649 + 0.4e1 * t681 + t6 * (t1351 + t1393);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1414 = 0.12e2 * t557;
  t1415 = 0.24e2 * t1220;
  t1416 = -t1414 + t1415;
  t1417 = my_piecewise5(t10, 0, t14, 0, t1416);
  t1421 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1206 * t133 * t550 - 0.8e1 / 0.9e1 * t549 * t316 * t197 - 0.8e1 / 0.9e1 * t686 * t86 * t205 + 0.4e1 / 0.3e1 * t196 * t697 * t86 + 0.4e1 / 0.3e1 * t689 * t205 + 0.4e1 / 0.9e1 * t312 * t561 + 0.4e1 / 0.3e1 * t23 * t1417);
  t1430 = t5 * t706 * t109;
  t1436 = t5 * t713 * t109;
  t1437 = t1436 / 0.4e1;
  t1439 = t5 * t325 * t279;
  t1452 = t5 * t320 * t222 * t49;
  t1453 = t1452 / 0.4e1;
  t1456 = t5 * t136 * t588 * t49;
  t1460 = t5 * t701 * t95 * t49;
  t1465 = -0.3e1 / 0.8e1 * t5 * t1421 * t26 * t49 - 0.9e1 / 0.8e1 * t5 * t702 * t109 - 0.3e1 / 0.4e1 * t1430 - 0.9e1 / 0.8e1 * t5 * t321 * t279 + t1437 - 0.3e1 / 0.8e1 * t1439 - 0.3e1 / 0.8e1 * t5 * t137 * t644 - 0.3e1 / 0.8e1 * t1236 + t1242 / 0.2e1 - 0.3e1 / 0.8e1 * t1244 - 0.5e1 / 0.12e2 * t1250 + t1253 / 0.4e1 - t1256 / 0.8e1 + t1453 - 0.5e1 / 0.36e2 * t1456 - 0.3e1 / 0.8e1 * t1460 - t1334 / 0.8e1 + t1338 / 0.4e1 - 0.5e1 / 0.12e2 * t1342 + t1349;
  t1466 = my_piecewise3(t1, 0, t1465);
  t1484 = my_piecewise5(t14, 0, t10, 0, -t1416);
  t1488 = my_piecewise3(t57, 0, 0.4e2 / 0.81e2 * t1354 * t144 * t652 - 0.8e1 / 0.9e1 * t651 * t339 * t287 - 0.8e1 / 0.9e1 * t730 * t116 * t291 + 0.4e1 / 0.3e1 * t286 * t739 * t116 + 0.4e1 / 0.3e1 * t733 * t291 + 0.4e1 / 0.9e1 * t336 * t659 + 0.4e1 / 0.3e1 * t58 * t1484);
  t1495 = t5 * t743 * t95 * t77;
  t1499 = t5 * t343 * t222 * t77;
  t1500 = t1499 / 0.4e1;
  t1503 = t5 * t147 * t588 * t77;
  t1512 = t5 * t668 * t161;
  t1515 = t5 * t672 * t161;
  t1516 = t1515 / 0.4e1;
  t1518 = t5 * t676 * t161;
  t1520 = -0.3e1 / 0.8e1 * t5 * t1488 * t26 * t77 - 0.3e1 / 0.8e1 * t1495 + t1500 - 0.5e1 / 0.36e2 * t1503 - t1378 / 0.8e1 + t1382 / 0.4e1 - 0.5e1 / 0.12e2 * t1386 + t1391 - 0.3e1 / 0.8e1 * t5 * t664 * t161 - 0.3e1 / 0.8e1 * t1512 + t1516 - 0.5e1 / 0.36e2 * t1518;
  t1521 = my_piecewise3(t54, 0, t1520);
  tv4rho41 = t649 + t681 + 0.3e1 * t729 + 0.3e1 * t768 + t6 * (t1466 + t1521);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1530 = t5 * t784 * t95 * t49;
  t1534 = t5 * t374 * t222 * t49;
  t1544 = t316 * t316;
  t1557 = my_piecewise5(t10, 0, t14, 0, t1415);
  t1561 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1206 * t365 * t197 - 0.32e2 / 0.27e2 * t686 * t86 * t316 - 0.8e1 / 0.27e2 * t771 * t205 + 0.8e1 / 0.9e1 * t196 * t1544 + 0.8e1 / 0.9e1 * t312 * t697 - 0.8e1 / 0.27e2 * t549 * t370 * t197 + 0.8e1 / 0.9e1 * t196 * t780 * t86 + 0.4e1 / 0.9e1 * t776 * t205 + 0.4e1 / 0.3e1 * t23 * t1557);
  t1570 = t5 * t789 * t109;
  t1586 = -t1530 / 0.4e1 + t1534 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t1561 * t26 * t49 - 0.3e1 / 0.4e1 * t5 * t785 * t109 - t1570 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t375 * t279 - t1430 / 0.2e1 + t1436 / 0.3e1 - t1439 / 0.4e1 + t1242 / 0.6e1 - 0.5e1 / 0.18e2 * t1250 + t1253 / 0.12e2 + t1452 / 0.3e1 - 0.5e1 / 0.18e2 * t1456 - t1460 / 0.4e1 + t1338 / 0.12e2 - 0.5e1 / 0.18e2 * t1342 + t1349;
  t1587 = my_piecewise3(t1, 0, t1586);
  t1596 = t339 * t339;
  t1609 = my_piecewise5(t14, 0, t10, 0, -t1415);
  t1613 = my_piecewise3(t57, 0, 0.4e2 / 0.81e2 * t1354 * t382 * t287 - 0.32e2 / 0.27e2 * t730 * t116 * t339 - 0.8e1 / 0.27e2 * t801 * t291 + 0.8e1 / 0.9e1 * t286 * t1596 + 0.8e1 / 0.9e1 * t336 * t739 - 0.8e1 / 0.27e2 * t651 * t386 * t287 + 0.8e1 / 0.9e1 * t286 * t810 * t116 + 0.4e1 / 0.9e1 * t806 * t291 + 0.4e1 / 0.3e1 * t58 * t1609);
  t1620 = t5 * t814 * t95 * t77;
  t1624 = t5 * t390 * t222 * t77;
  t1633 = t5 * t748 * t161;
  t1636 = t5 * t752 * t161;
  t1647 = t5 * t300 * t440;
  t1650 = t5 * t304 * t440;
  t1652 = -0.3e1 / 0.8e1 * t5 * t1613 * t26 * t77 - t1620 / 0.4e1 + t1624 / 0.12e2 - t1495 / 0.4e1 + t1499 / 0.3e1 - 0.5e1 / 0.18e2 * t1503 - 0.3e1 / 0.4e1 * t5 * t744 * t161 - t1633 / 0.2e1 + t1636 / 0.6e1 + t1382 / 0.12e2 - 0.5e1 / 0.18e2 * t1386 + t1391 - t1512 / 0.4e1 + t1515 / 0.3e1 - 0.5e1 / 0.18e2 * t1518 - 0.3e1 / 0.8e1 * t5 * t296 * t440 - t1647 / 0.4e1 + t1650 / 0.12e2;
  t1653 = my_piecewise3(t54, 0, t1652);
  tv4rho42 = 0.2e1 * t729 + 0.2e1 * t768 + 0.2e1 * t800 + 0.2e1 * t839 + t6 * (t1587 + t1653);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1673 = t1414 + t1415;
  t1674 = my_piecewise5(t10, 0, t14, 0, t1673);
  t1678 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1206 * t844 * t86 - 0.8e1 / 0.9e1 * t771 * t316 - 0.8e1 / 0.9e1 * t686 * t370 * t86 + 0.4e1 / 0.3e1 * t689 * t370 + 0.4e1 / 0.3e1 * t312 * t780 + 0.4e1 / 0.9e1 * t196 * t851 * t86 + 0.4e1 / 0.3e1 * t23 * t1674);
  t1685 = t5 * t855 * t95 * t49;
  t1696 = -0.3e1 / 0.8e1 * t5 * t1678 * t26 * t49 - t1685 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t856 * t109 - 0.3e1 / 0.8e1 * t1530 + t1534 / 0.4e1 - 0.3e1 / 0.8e1 * t1570 + t1453 - 0.5e1 / 0.12e2 * t1456 + t1437 - 0.5e1 / 0.36e2 * t1342 + t1349 - 0.5e1 / 0.36e2 * t1250;
  t1697 = my_piecewise3(t1, 0, t1696);
  t1714 = my_piecewise5(t14, 0, t10, 0, -t1673);
  t1718 = my_piecewise3(t57, 0, 0.4e2 / 0.81e2 * t1354 * t864 * t116 - 0.8e1 / 0.9e1 * t801 * t339 - 0.8e1 / 0.9e1 * t730 * t386 * t116 + 0.4e1 / 0.3e1 * t733 * t386 + 0.4e1 / 0.3e1 * t336 * t810 + 0.4e1 / 0.9e1 * t286 * t870 * t116 + 0.4e1 / 0.3e1 * t58 * t1714);
  t1725 = t5 * t874 * t95 * t77;
  t1733 = t5 * t819 * t161;
  t1742 = t5 * t348 * t440;
  t1752 = t5 * t124 * t934;
  t1754 = -0.3e1 / 0.8e1 * t5 * t1718 * t26 * t77 - t1725 / 0.8e1 - 0.3e1 / 0.8e1 * t1620 + t1624 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t815 * t161 - 0.3e1 / 0.8e1 * t1733 + t1500 - 0.5e1 / 0.12e2 * t1503 - 0.3e1 / 0.4e1 * t1633 + t1636 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t344 * t440 - 0.3e1 / 0.8e1 * t1742 - 0.5e1 / 0.36e2 * t1386 + t1391 + t1516 - 0.5e1 / 0.12e2 * t1518 - 0.3e1 / 0.8e1 * t1647 + t1650 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t120 * t934 - t1752 / 0.8e1;
  t1755 = my_piecewise3(t54, 0, t1754);
  tv4rho43 = 0.3e1 * t800 + 0.3e1 * t839 + t863 + t939 + t6 * (t1697 + t1755);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1760 = t365 * t365;
  t1765 = t370 * t370;
  t1771 = 0.24e2 * t557 + 0.24e2 * t1220;
  t1772 = my_piecewise5(t10, 0, t14, 0, t1771);
  t1776 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1206 * t1760 - 0.16e2 / 0.9e1 * t771 * t370 + 0.4e1 / 0.3e1 * t196 * t1765 + 0.16e2 / 0.9e1 * t312 * t851 + 0.4e1 / 0.3e1 * t23 * t1772);
  t1785 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1776 * t26 * t49 - t1685 / 0.2e1 + t1534 / 0.2e1 - 0.5e1 / 0.9e1 * t1456 + t1349);
  t1792 = t382 * t382;
  t1797 = t386 * t386;
  t1803 = my_piecewise5(t14, 0, t10, 0, -t1771);
  t1807 = my_piecewise3(t57, 0, 0.4e2 / 0.81e2 * t1354 * t1792 - 0.16e2 / 0.9e1 * t801 * t386 + 0.4e1 / 0.3e1 * t286 * t1797 + 0.16e2 / 0.9e1 * t336 * t870 + 0.4e1 / 0.3e1 * t58 * t1803);
  t1822 = 0.1e1 / t63 / t899;
  t1823 = t62 * t1822;
  t1830 = t411 * t152;
  t1842 = 0.1e1 / t908 / t434;
  t1843 = t929 * t929;
  t1845 = t250 * t1842 * t1843;
  t1860 = 0.1e1 / t426 / t425 * t249;
  t1861 = t1860 * t29;
  t1877 = t923 * t923;
  t1878 = t428 * t428;
  t1879 = 0.1e1 / t1878;
  t1886 = t250 * t909 * (0.7e1 / 0.9e1 * t251 * t416 * t402 * t429 - 0.2e1 / 0.3e1 * t623 * t155 * t925 + t623 * t66 * (0.7e1 / 0.27e2 * t253 * t416 * t402 - 0.32e2 / 0.3e1 * t1861 * t1300 * t1163 / t63 / t411 / t400 + 0.22e2 / 0.9e1 * t919 * t419 * t414) * t924 / 0.4e1 - t623 * t66 * t1877 * t1879 / 0.4e1);
  t1895 = -t1725 / 0.2e1 - 0.3e1 / 0.2e1 * t1733 - 0.3e1 / 0.2e1 * t1742 - t1752 / 0.2e1 + t1624 / 0.2e1 + t1636 + t1650 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t1807 * t26 * t77 - 0.3e1 / 0.2e1 * t5 * t875 * t161 - 0.9e1 / 0.4e1 * t5 * t391 * t440 - 0.3e1 / 0.2e1 * t5 * t148 * t934 - 0.3e1 / 0.8e1 * t5 * t61 * (-0.91e3 / 0.243e3 * t33 * t1823 * t73 - 0.2074e4 / 0.243e3 * t33 * t1823 * t69 + 0.563e3 / 0.162e3 * t410 / t412 / t1830 * params->beta * t436 + 0.13e2 / 0.18e2 * t242 * sigma[2] * t901 * t931 + t907 * t1845 / 0.9e1 - t907 * t1886 / 0.18e2) - 0.5e1 / 0.9e1 * t1503 - 0.5e1 / 0.9e1 * t1518 + t1391;
  t1896 = my_piecewise3(t54, 0, t1895);
  tv4rho44 = 0.4e1 * t863 + 0.4e1 * t939 + t6 * (t1785 + t1896);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1904 = t5 * t570 * t176;
  t1910 = t5 * t577 * t176;
  t1913 = t5 * t214 * t467;
  t1920 = 0.5e1 / 0.36e2 * t5 * t589 * t176;
  t1922 = t5 * t223 * t467;
  t1925 = t5 * t96 * t970;
  t1927 = t169 * t600;
  t1948 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t566 * t176 - 0.3e1 / 0.8e1 * t1904 - 0.9e1 / 0.8e1 * t5 * t210 * t467 + t1910 / 0.4e1 - 0.3e1 / 0.4e1 * t1913 - 0.9e1 / 0.8e1 * t5 * t90 * t970 - t1920 + t1922 / 0.4e1 - 0.3e1 / 0.8e1 * t1925 - 0.3e1 / 0.8e1 * t5 * t27 * (0.35e2 / 0.81e2 * t33 * t1927 * t45 + 0.104e3 / 0.81e2 * t33 * t1927 * t41 - 0.169e3 / 0.216e3 * t242 * t610 * t464 - 0.5e1 / 0.24e2 * t965 * t641 - t463 * t1282 / 0.24e2 + t463 * t1325 / 0.48e2));
  tv4rho3sigma0 = t6 * t1948 + 0.3e1 * t975;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1955 = t5 * t668 * t188;
  t1958 = t5 * t672 * t188;
  t1962 = 0.5e1 / 0.36e2 * t5 * t676 * t188;
  t1964 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t664 * t188 - 0.3e1 / 0.8e1 * t1955 + t1958 / 0.4e1 - t1962);
  tv4rho3sigma2 = t6 * t1964 + 0.3e1 * t988;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1966 = 0.2e1 * t1002;
  t1972 = t5 * t706 * t176 / 0.4e1;
  t1977 = t5 * t713 * t176;
  t1981 = t5 * t325 * t467 / 0.4e1;
  t1990 = -0.3e1 / 0.8e1 * t5 * t702 * t176 - t1972 - 0.3e1 / 0.4e1 * t5 * t321 * t467 + t1977 / 0.12e2 - t1981 - 0.3e1 / 0.8e1 * t5 * t137 * t970 - t1904 / 0.8e1 + t1910 / 0.6e1 - t1913 / 0.4e1 - t1920 + t1922 / 0.6e1 - t1925 / 0.8e1;
  t1991 = my_piecewise3(t1, 0, t1990);
  tv4rho3sigma3 = t6 * t1991 + t1966 + t975;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1993 = 0.2e1 * t1018;
  t1999 = t5 * t748 * t188 / 0.4e1;
  t2001 = t5 * t752 * t188;
  t2010 = t5 * t300 * t505 / 0.4e1;
  t2012 = t5 * t304 * t505;
  t2015 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t744 * t188 - t1999 + t2001 / 0.12e2 - t1955 / 0.8e1 + t1958 / 0.6e1 - t1962 - 0.3e1 / 0.8e1 * t5 * t296 * t505 - t2010 + t2012 / 0.12e2);
  tv4rho3sigma5 = t6 * t2015 + t1993 + t988;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2021 = t5 * t789 * t176;
  t2030 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t785 * t176 - t2021 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t375 * t467 - t1972 + t1977 / 0.6e1 - t1981 + t1910 / 0.12e2 - t1920 + t1922 / 0.12e2);
  tv4rho3sigma6 = t6 * t2030 + t1026 + t1966;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2036 = t5 * t819 * t188;
  t2043 = t5 * t348 * t505;
  t2051 = t5 * t124 * t1049;
  t2053 = -0.3e1 / 0.8e1 * t5 * t815 * t188 - t2036 / 0.8e1 - t1999 + t2001 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t344 * t505 - t2043 / 0.4e1 + t1958 / 0.12e2 - t1962 - t2010 + t2012 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t120 * t1049 - t2051 / 0.8e1;
  t2054 = my_piecewise3(t54, 0, t2053);
  tv4rho3sigma8 = t6 * t2054 + t1054 + t1993;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2063 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t856 * t176 - 0.3e1 / 0.8e1 * t2021 + t1977 / 0.4e1 - t1920);
  tv4rho3sigma9 = t6 * t2063 + 0.3e1 * t1026;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2080 = t181 * t891;
  t2101 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t875 * t188 - 0.3e1 / 0.8e1 * t2036 - 0.9e1 / 0.8e1 * t5 * t391 * t505 + t2001 / 0.4e1 - 0.3e1 / 0.4e1 * t2043 - 0.9e1 / 0.8e1 * t5 * t148 * t1049 - t1962 + t2012 / 0.4e1 - 0.3e1 / 0.8e1 * t2051 - 0.3e1 / 0.8e1 * t5 * t61 * (0.35e2 / 0.81e2 * t33 * t2080 * t73 + 0.104e3 / 0.81e2 * t33 * t2080 * t69 - 0.169e3 / 0.216e3 * t242 * t901 * t502 - 0.5e1 / 0.24e2 * t1044 * t931 - t501 * t1845 / 0.24e2 + t501 * t1886 / 0.48e2));
  tv4rho3sigma11 = t6 * t2101 + 0.3e1 * t1054;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2108 = t5 * t214 * t524;
  t2115 = t5 * t223 * t524 / 0.12e2;
  t2117 = t5 * t96 * t1077;
  t2119 = t513 * t232;
  t2129 = t242 * t518 * t462;
  t2141 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t210 * t524 - t2108 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t90 * t1077 + t2115 - t2117 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (0.7e1 / 0.108e3 * t33 * t2119 * t45 + 0.11e2 / 0.108e3 * t33 * t2119 * t41 + t519 * t276 / 0.16e2 + t2129 * t641 / 0.24e2 + t1074 * t1282 / 0.64e2 - t1074 * t1325 / 0.128e3));
  tv4rho2sigma20 = t6 * t2141 + 0.2e1 * t1082;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2148 = t5 * t300 * t541;
  t2152 = t5 * t304 * t541 / 0.12e2;
  t2154 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t296 * t541 - t2148 / 0.4e1 + t2152);
  tv4rho2sigma25 = t6 * t2154 + 0.2e1 * t1091;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2160 = t5 * t325 * t524;
  t2168 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t321 * t524 - t2160 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t137 * t1077 - t2108 / 0.8e1 + t2115 - t2117 / 0.8e1);
  tv4rho2sigma26 = t6 * t2168 + t1082 + t1097;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2174 = t5 * t348 * t541;
  t2181 = t5 * t124 * t1117;
  t2184 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t344 * t541 - t2174 / 0.8e1 - t2148 / 0.8e1 + t2152 - 0.3e1 / 0.8e1 * t5 * t120 * t1117 - t2181 / 0.8e1);
  tv4rho2sigma211 = t6 * t2184 + t1091 + t1122;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2192 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t375 * t524 - t2160 / 0.4e1 + t2115);
  tv4rho2sigma212 = t6 * t2192 + 0.2e1 * t1097;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2203 = t530 * t402;
  t2213 = t242 * t535 * t500;
  t2225 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t391 * t541 - t2174 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t148 * t1117 + t2152 - t2181 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t61 * (0.7e1 / 0.108e3 * t33 * t2203 * t73 + 0.11e2 / 0.108e3 * t33 * t2203 * t69 + t536 * t437 / 0.16e2 + t2213 * t931 / 0.24e2 + t1114 * t1845 / 0.64e2 - t1114 * t1886 / 0.128e3));
  tv4rho2sigma217 = t6 * t2225 + 0.2e1 * t1122;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2232 = t5 * t96 * t1158 / 0.8e1;
  t2233 = t1126 * t102;
  t2243 = t242 * t1134 * t260;
  t2293 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t90 * t1158 - t2232 - 0.3e1 / 0.8e1 * t5 * t27 * (t33 * t2233 * t45 / 0.24e2 + t33 * t2233 * t41 / 0.36e2 + 0.5e1 / 0.192e3 * t1135 * t1070 + t2243 * t641 / 0.128e3 + t2129 * t1155 / 0.48e2 + t1074 * t250 * t1279 * t1153 * t639 / 0.64e2 - t1074 * t250 * t618 * (-t251 * t1138 * t619 / 0.6e1 + t623 * t170 * t635 / 0.8e1 - t623 * t103 * t1149 / 0.3e1 + t623 * t38 * (-t253 * t1138 * t102 / 0.18e2 + 0.4e1 * t1298 * t1300 / t35 / t1267 * sigma[0] - 0.2e1 / 0.3e1 * t628 * t463) * t634 / 0.4e1 - t623 * t38 * t1148 * t1318 * t633 / 0.4e1) / 0.128e3));
  tv4rhosigma30 = t6 * t2293 + t1162;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2300 = t5 * t124 * t1197 / 0.8e1;
  t2302 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t120 * t1197 - t2300);
  tv4rhosigma39 = t6 * t2302 + t1201;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2308 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t137 * t1158 - t2232);
  tv4rhosigma310 = t6 * t2308 + t1162;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2313 = t1165 * t154;
  t2323 = t242 * t1173 * t421;
  t2373 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t148 * t1197 - t2300 - 0.3e1 / 0.8e1 * t5 * t61 * (t33 * t2313 * t73 / 0.24e2 + t33 * t2313 * t69 / 0.36e2 + 0.5e1 / 0.192e3 * t1174 * t1110 + t2323 * t931 / 0.128e3 + t2213 * t1194 / 0.48e2 + t1114 * t250 * t1842 * t1192 * t929 / 0.64e2 - t1114 * t250 * t909 * (-t251 * t1177 * t910 / 0.6e1 + t623 * t182 * t925 / 0.8e1 - t623 * t155 * t1188 / 0.3e1 + t623 * t66 * (-t253 * t1177 * t154 / 0.18e2 + 0.4e1 * t1861 * t1300 / t63 / t1830 * sigma[2] - 0.2e1 / 0.3e1 * t918 * t501) * t924 / 0.4e1 - t623 * t66 * t1187 * t1879 * t923 / 0.4e1) / 0.128e3));
  tv4rhosigma319 = t6 * t2373 + t1201;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2375 = t1124 * sigma[0];
  t2378 = 0.1e1 / t34 / t2375 * t37;
  t2391 = t1153 * t1153;
  t2396 = t32 * t513;
  t2406 = t29 * t1300;
  t2415 = t1148 * t1148;
  t2429 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (0.5e1 / 0.64e2 * t33 * t2378 * t45 - t33 * t2378 * t41 / 0.24e2 + 0.7e1 / 0.512e3 * t242 / t2375 * t521 + t2243 * t1155 / 0.64e2 + t1074 * t250 * t1279 * t2391 / 0.64e2 - t1074 * t250 * t618 * (-t251 * t2396 * t269 / 0.16e2 + t623 * t170 * t1149 / 0.4e1 + t623 * t38 * (-t253 * t2396 * t37 / 0.48e2 - 0.3e1 / 0.2e1 * t1297 * t2406 * t1259) * t634 / 0.4e1 - t623 * t38 * t2415 * t1318 / 0.4e1) / 0.128e3));
  tv4sigma40 = t6 * t2429;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2430 = t1163 * sigma[2];
  t2433 = 0.1e1 / t62 / t2430 * t65;
  t2446 = t1192 * t1192;
  t2451 = t32 * t530;
  t2469 = t1187 * t1187;
  t2483 = my_piecewise3(t54, 0, -0.3e1 / 0.8e1 * t5 * t61 * (0.5e1 / 0.64e2 * t33 * t2433 * t73 - t33 * t2433 * t69 / 0.24e2 + 0.7e1 / 0.512e3 * t242 / t2430 * t538 + t2323 * t1194 / 0.64e2 + t1114 * t250 * t1842 * t2446 / 0.64e2 - t1114 * t250 * t909 * (-t251 * t2451 * t430 / 0.16e2 + t623 * t182 * t1188 / 0.4e1 + t623 * t66 * (-t253 * t2451 * t65 / 0.48e2 - 0.3e1 / 0.2e1 * t1860 * t2406 * t1822) * t924 / 0.4e1 - t623 * t66 * t2469 * t1879 / 0.4e1) / 0.128e3));
  tv4sigma414 = t6 * t2483;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

