/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_htbs.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t30, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t43, t45, t47, t48, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t64, t66, t67;
  double t68, t71, t72, t74, t76, t77, t78, t79;
  double t80, t82, t83, t86, t87, t88, t89, t91;
  double t94, t95, t97, t100, t101, t105, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t25 = t21 / t23;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = t32 / 0.12e2;
  t34 = t33 < 0.6e0;
  t35 = t23 * t23;
  t36 = 0.1e1 / t35;
  t37 = t20 * t36;
  t38 = t27 * t27;
  t39 = sigma[0] * t38;
  t40 = rho[0] * rho[0];
  t41 = t18 * t18;
  t43 = 0.1e1 / t41 / t40;
  t45 = t37 * t39 * t43;
  t47 = t37 * sigma[0];
  t48 = t38 * t43;
  t50 = exp(-t45 / 0.24e2);
  t51 = t48 * t50;
  t55 = 0.1e1 / t23 / t22;
  t56 = t21 * t55;
  t57 = sigma[0] * sigma[0];
  t58 = t57 * t27;
  t59 = t40 * t40;
  t60 = t59 * rho[0];
  t62 = 0.1e1 / t18 / t60;
  t64 = t56 * t58 * t62;
  t66 = 0.1e1 + 0.27560657413756315278e-4 * t64;
  t67 = log(t66);
  t68 = 0.804e0 + 0.5e1 / 0.972e3 * t45 + 0.4002424276710846245e-2 * t47 * t51 + t67;
  t71 = 0.1804e1 - 0.646416e0 / t68;
  t72 = 0.26e1 < t33;
  t74 = exp(-0.1137619054542480583e-1 * t45);
  t76 = 0.1804e1 - 0.804e0 * t74;
  t77 = 0.190125e0 * t32;
  t78 = 0.195e0 * t45;
  t79 = t26 * sigma[0];
  t80 = 0.1e1 / t59;
  t82 = 0.17625664237781674824e-1 * t79 * t80;
  t83 = 0.52083333333333333334e-2 * t64;
  t86 = t20 / t35 / t22;
  t87 = t26 * t57;
  t88 = t87 * t38;
  t89 = t59 * t40;
  t91 = 0.1e1 / t41 / t89;
  t94 = 0.32552083333333333334e-3 * t86 * t88 * t91;
  t95 = -0.40608e0 + t77 - t78 + t82 - t83 + t94;
  t97 = 0.140608e1 - t77 + t78 - t82 + t83 - t94;
  t100 = my_piecewise3(t72, t76, t97 * t71 + t95 * t76);
  t101 = my_piecewise3(t34, t71, t100);
  t105 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t101);
  tzk0 = 0.2e1 * t105;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t30, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t43, t45, t47, t48, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t64, t66, t67;
  double t68, t71, t72, t74, t76, t77, t78, t79;
  double t80, t82, t83, t86, t87, t88, t89, t91;
  double t94, t95, t97, t100, t101, t105, tzk0;

  double t107, t111, t112, t113, t115, t117, t119, t120;
  double t123, t125, t126, t127, t130, t131, t134, t137;
  double t141, t146, t152, t154, t158, t161, t163, t166;
  double t168, t172, t173, t178, tvrho0, t181, t185, t186;
  double t187, t190, t193, t196, t199, t200, t207, t211;
  double t215, t219, t224, t225, t229, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t25 = t21 / t23;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = t32 / 0.12e2;
  t34 = t33 < 0.6e0;
  t35 = t23 * t23;
  t36 = 0.1e1 / t35;
  t37 = t20 * t36;
  t38 = t27 * t27;
  t39 = sigma[0] * t38;
  t40 = rho[0] * rho[0];
  t41 = t18 * t18;
  t43 = 0.1e1 / t41 / t40;
  t45 = t37 * t39 * t43;
  t47 = t37 * sigma[0];
  t48 = t38 * t43;
  t50 = exp(-t45 / 0.24e2);
  t51 = t48 * t50;
  t55 = 0.1e1 / t23 / t22;
  t56 = t21 * t55;
  t57 = sigma[0] * sigma[0];
  t58 = t57 * t27;
  t59 = t40 * t40;
  t60 = t59 * rho[0];
  t62 = 0.1e1 / t18 / t60;
  t64 = t56 * t58 * t62;
  t66 = 0.1e1 + 0.27560657413756315278e-4 * t64;
  t67 = log(t66);
  t68 = 0.804e0 + 0.5e1 / 0.972e3 * t45 + 0.4002424276710846245e-2 * t47 * t51 + t67;
  t71 = 0.1804e1 - 0.646416e0 / t68;
  t72 = 0.26e1 < t33;
  t74 = exp(-0.1137619054542480583e-1 * t45);
  t76 = 0.1804e1 - 0.804e0 * t74;
  t77 = 0.190125e0 * t32;
  t78 = 0.195e0 * t45;
  t79 = t26 * sigma[0];
  t80 = 0.1e1 / t59;
  t82 = 0.17625664237781674824e-1 * t79 * t80;
  t83 = 0.52083333333333333334e-2 * t64;
  t86 = t20 / t35 / t22;
  t87 = t26 * t57;
  t88 = t87 * t38;
  t89 = t59 * t40;
  t91 = 0.1e1 / t41 / t89;
  t94 = 0.32552083333333333334e-3 * t86 * t88 * t91;
  t95 = -0.40608e0 + t77 - t78 + t82 - t83 + t94;
  t97 = 0.140608e1 - t77 + t78 - t82 + t83 - t94;
  t100 = my_piecewise3(t72, t76, t97 * t71 + t95 * t76);
  t101 = my_piecewise3(t34, t71, t100);
  t105 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t101);
  tzk0 = 0.2e1 * t105;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t107 = t17 / t41;
  t111 = t68 * t68;
  t112 = 0.1e1 / t111;
  t113 = t40 * rho[0];
  t115 = 0.1e1 / t41 / t113;
  t117 = t37 * t39 * t115;
  t119 = t38 * t115;
  t120 = t119 * t50;
  t123 = t56 * t57;
  t125 = 0.1e1 / t18 / t89;
  t126 = t27 * t125;
  t127 = t126 * t50;
  t130 = 0.1e1 / t66;
  t131 = t126 * t130;
  t134 = -0.1e2 / 0.729e3 * t117 - 0.10673131404562256653e-1 * t47 * t120 + 0.88942761704685472111e-3 * t123 * t127 - 0.14699017287336701482e-3 * t123 * t131;
  t137 = t119 * t74;
  t141 = 0.1e1 / t18 / t40;
  t146 = 0.1e1 / t60;
  t152 = t59 * t113;
  t154 = 0.1e1 / t41 / t152;
  t158 = -0.2535e0 * t25 * t28 * t141 + 0.52e0 * t117 - 0.70502656951126699296e-1 * t79 * t146 + 0.27777777777777777778e-1 * t56 * t58 * t125 - 0.21701388888888888889e-2 * t86 * t88 * t154;
  t161 = t95 * t20 * t36;
  t163 = t39 * t115 * t74;
  t166 = -t158;
  t168 = t97 * t112;
  t172 = my_piecewise3(t72, -0.243905525293907837e-1 * t47 * t137, t158 * t76 - 0.243905525293907837e-1 * t161 * t163 + t166 * t71 + 0.646416e0 * t168 * t134);
  t173 = my_piecewise3(t34, 0.646416e0 * t112 * t134, t172);
  t178 = my_piecewise3(t2, 0, -t6 * t107 * t101 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t173);
  tvrho0 = 0.2e1 * rho[0] * t178 + 0.2e1 * t105;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t181 = t37 * t48;
  t185 = t56 * sigma[0];
  t186 = t27 * t62;
  t187 = t186 * t50;
  t190 = t186 * t130;
  t193 = 0.5e1 / 0.972e3 * t181 + 0.4002424276710846245e-2 * t37 * t51 - 0.33353535639257052042e-3 * t185 * t187 + 0.55121314827512630556e-4 * t185 * t190;
  t196 = t48 * t74;
  t199 = 0.1e1 / t26;
  t200 = t199 * t27;
  t207 = sigma[0] * t27;
  t211 = t79 * t38;
  t215 = 0.950625e-1 * t25 * t200 * t30 - 0.195e0 * t181 + 0.26438496356672512236e-1 * t26 * t80 - 0.10416666666666666667e-1 * t56 * t207 * t62 + 0.81380208333333333335e-3 * t86 * t211 * t91;
  t219 = -t215;
  t224 = my_piecewise3(t72, 0.91464571985215438873e-2 * t37 * t196, t215 * t76 + 0.91464571985215438873e-2 * t161 * t196 + t219 * t71 + 0.646416e0 * t168 * t193);
  t225 = my_piecewise3(t34, 0.646416e0 * t112 * t193, t224);
  t229 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t225);
  tvsigma0 = 0.2e1 * rho[0] * t229;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t30, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t43, t45, t47, t48, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t64, t66, t67;
  double t68, t71, t72, t74, t76, t77, t78, t79;
  double t80, t82, t83, t86, t87, t88, t89, t91;
  double t94, t95, t97, t100, t101, t105, tzk0;

  double t107, t111, t112, t113, t115, t117, t119, t120;
  double t123, t125, t126, t127, t130, t131, t134, t137;
  double t141, t146, t152, t154, t158, t161, t163, t166;
  double t168, t172, t173, t178, tvrho0, t181, t185, t186;
  double t187, t190, t193, t196, t199, t200, t207, t211;
  double t215, t219, t224, t225, t229, tvsigma0;

  double t234, t242, t243, t247, t249, t251, t252, t256;
  double t257, t258, t261, t262, t263, t264, t265, t266;
  double t267, t271, t276, t277, t278, t279, t281, t283;
  double t284, t285, t288, t292, t295, t300, t305, t312;
  double t316, t319, t323, t327, t329, t332, t334, t337;
  double t343, t344, t349, tv2rho20, t355, t358, t362, t363;
  double t367, t368, t369, t375, t376, t378, t383, t405;
  double t408, t415, t416, t419, t421, t426, t432, t433;
  double t438, tv2rhosigma0, t441, t446, t447, t455, t457, t460;
  double t464, t467, t468, t476, t480, t486, t495, t496;
  double t500, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t25 = t21 / t23;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = t32 / 0.12e2;
  t34 = t33 < 0.6e0;
  t35 = t23 * t23;
  t36 = 0.1e1 / t35;
  t37 = t20 * t36;
  t38 = t27 * t27;
  t39 = sigma[0] * t38;
  t40 = rho[0] * rho[0];
  t41 = t18 * t18;
  t43 = 0.1e1 / t41 / t40;
  t45 = t37 * t39 * t43;
  t47 = t37 * sigma[0];
  t48 = t38 * t43;
  t50 = exp(-t45 / 0.24e2);
  t51 = t48 * t50;
  t55 = 0.1e1 / t23 / t22;
  t56 = t21 * t55;
  t57 = sigma[0] * sigma[0];
  t58 = t57 * t27;
  t59 = t40 * t40;
  t60 = t59 * rho[0];
  t62 = 0.1e1 / t18 / t60;
  t64 = t56 * t58 * t62;
  t66 = 0.1e1 + 0.27560657413756315278e-4 * t64;
  t67 = log(t66);
  t68 = 0.804e0 + 0.5e1 / 0.972e3 * t45 + 0.4002424276710846245e-2 * t47 * t51 + t67;
  t71 = 0.1804e1 - 0.646416e0 / t68;
  t72 = 0.26e1 < t33;
  t74 = exp(-0.1137619054542480583e-1 * t45);
  t76 = 0.1804e1 - 0.804e0 * t74;
  t77 = 0.190125e0 * t32;
  t78 = 0.195e0 * t45;
  t79 = t26 * sigma[0];
  t80 = 0.1e1 / t59;
  t82 = 0.17625664237781674824e-1 * t79 * t80;
  t83 = 0.52083333333333333334e-2 * t64;
  t86 = t20 / t35 / t22;
  t87 = t26 * t57;
  t88 = t87 * t38;
  t89 = t59 * t40;
  t91 = 0.1e1 / t41 / t89;
  t94 = 0.32552083333333333334e-3 * t86 * t88 * t91;
  t95 = -0.40608e0 + t77 - t78 + t82 - t83 + t94;
  t97 = 0.140608e1 - t77 + t78 - t82 + t83 - t94;
  t100 = my_piecewise3(t72, t76, t97 * t71 + t95 * t76);
  t101 = my_piecewise3(t34, t71, t100);
  t105 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t101);
  tzk0 = 0.2e1 * t105;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t107 = t17 / t41;
  t111 = t68 * t68;
  t112 = 0.1e1 / t111;
  t113 = t40 * rho[0];
  t115 = 0.1e1 / t41 / t113;
  t117 = t37 * t39 * t115;
  t119 = t38 * t115;
  t120 = t119 * t50;
  t123 = t56 * t57;
  t125 = 0.1e1 / t18 / t89;
  t126 = t27 * t125;
  t127 = t126 * t50;
  t130 = 0.1e1 / t66;
  t131 = t126 * t130;
  t134 = -0.1e2 / 0.729e3 * t117 - 0.10673131404562256653e-1 * t47 * t120 + 0.88942761704685472111e-3 * t123 * t127 - 0.14699017287336701482e-3 * t123 * t131;
  t137 = t119 * t74;
  t141 = 0.1e1 / t18 / t40;
  t146 = 0.1e1 / t60;
  t152 = t59 * t113;
  t154 = 0.1e1 / t41 / t152;
  t158 = -0.2535e0 * t25 * t28 * t141 + 0.52e0 * t117 - 0.70502656951126699296e-1 * t79 * t146 + 0.27777777777777777778e-1 * t56 * t58 * t125 - 0.21701388888888888889e-2 * t86 * t88 * t154;
  t161 = t95 * t20 * t36;
  t163 = t39 * t115 * t74;
  t166 = -t158;
  t168 = t97 * t112;
  t172 = my_piecewise3(t72, -0.243905525293907837e-1 * t47 * t137, t158 * t76 - 0.243905525293907837e-1 * t161 * t163 + t166 * t71 + 0.646416e0 * t168 * t134);
  t173 = my_piecewise3(t34, 0.646416e0 * t112 * t134, t172);
  t178 = my_piecewise3(t2, 0, -t6 * t107 * t101 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t173);
  tvrho0 = 0.2e1 * rho[0] * t178 + 0.2e1 * t105;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t181 = t37 * t48;
  t185 = t56 * sigma[0];
  t186 = t27 * t62;
  t187 = t186 * t50;
  t190 = t186 * t130;
  t193 = 0.5e1 / 0.972e3 * t181 + 0.4002424276710846245e-2 * t37 * t51 - 0.33353535639257052042e-3 * t185 * t187 + 0.55121314827512630556e-4 * t185 * t190;
  t196 = t48 * t74;
  t199 = 0.1e1 / t26;
  t200 = t199 * t27;
  t207 = sigma[0] * t27;
  t211 = t79 * t38;
  t215 = 0.950625e-1 * t25 * t200 * t30 - 0.195e0 * t181 + 0.26438496356672512236e-1 * t26 * t80 - 0.10416666666666666667e-1 * t56 * t207 * t62 + 0.81380208333333333335e-3 * t86 * t211 * t91;
  t219 = -t215;
  t224 = my_piecewise3(t72, 0.91464571985215438873e-2 * t37 * t196, t215 * t76 + 0.91464571985215438873e-2 * t161 * t196 + t219 * t71 + 0.646416e0 * t168 * t193);
  t225 = my_piecewise3(t34, 0.646416e0 * t112 * t193, t224);
  t229 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t225);
  tvsigma0 = 0.2e1 * rho[0] * t229;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t234 = t17 / t41 / rho[0];
  t242 = 0.1e1 / t111 / t68;
  t243 = t134 * t134;
  t247 = 0.1e1 / t41 / t59;
  t249 = t37 * t39 * t247;
  t251 = t38 * t247;
  t252 = t251 * t50;
  t256 = 0.1e1 / t18 / t152;
  t257 = t27 * t256;
  t258 = t257 * t50;
  t261 = t22 * t22;
  t262 = 0.1e1 / t261;
  t263 = t57 * sigma[0];
  t264 = t262 * t263;
  t265 = t59 * t59;
  t266 = t265 * t40;
  t267 = 0.1e1 / t266;
  t271 = t257 * t130;
  t276 = t20 / t35 / t261;
  t277 = t57 * t57;
  t278 = t276 * t277;
  t279 = t265 * t59;
  t281 = 0.1e1 / t41 / t279;
  t283 = t66 * t66;
  t284 = 0.1e1 / t283;
  t285 = t38 * t281 * t284;
  t288 = 0.11e3 / 0.2187e4 * t249 + 0.39134815150061607728e-1 * t47 * t252 - 0.800484855342169249e-2 * t123 * t258 + 0.11859034893958062948e-2 * t264 * t267 * t50 + 0.93093776153132442719e-3 * t123 * t271 - 0.12963666552805392131e-6 * t278 * t285;
  t292 = t251 * t74;
  t295 = t257 * t74;
  t300 = 0.1e1 / t18 / t113;
  t305 = 0.1e1 / t89;
  t312 = 0.1e1 / t41 / t265;
  t316 = 0.5915e0 * t25 * t28 * t300 - 0.19066666666666666667e1 * t249 + 0.35251328475563349648e0 * t79 * t305 - 0.17592592592592592593e0 * t56 * t58 * t256 + 0.16637731481481481482e-1 * t86 * t88 * t312;
  t319 = t158 * t20 * t36;
  t323 = t39 * t247 * t74;
  t327 = t95 * t21 * t55;
  t329 = t58 * t256 * t74;
  t332 = -t316;
  t334 = t166 * t112;
  t337 = t97 * t242;
  t343 = my_piecewise3(t72, 0.89432025941099540233e-1 * t47 * t292 - 0.14798483897735600909e-2 * t123 * t295, t316 * t76 - 0.487811050587815674e-1 * t319 * t163 + 0.89432025941099540233e-1 * t161 * t323 - 0.14798483897735600909e-2 * t327 * t329 + t332 * t71 + 0.1292832e1 * t334 * t134 - 0.1292832e1 * t337 * t243 + 0.646416e0 * t168 * t288);
  t344 = my_piecewise3(t34, -0.1292832e1 * t242 * t243 + 0.646416e0 * t112 * t288, t343);
  t349 = my_piecewise3(t2, 0, t6 * t234 * t101 / 0.12e2 - t6 * t107 * t173 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t344);
  tv2rho20 = 0.2e1 * rho[0] * t349 + 0.4e1 * t178;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t355 = t242 * t193;
  t358 = t37 * t119;
  t362 = t56 * t27;
  t363 = t125 * sigma[0];
  t367 = t262 * t57;
  t368 = t265 * rho[0];
  t369 = 0.1e1 / t368;
  t375 = t276 * t263;
  t376 = t265 * t113;
  t378 = 0.1e1 / t41 / t376;
  t383 = -0.1e2 / 0.729e3 * t358 - 0.10673131404562256653e-1 * t37 * t120 + 0.26682828511405641633e-2 * t362 * t363 * t50 - 0.44471380852342736056e-3 * t367 * t369 * t50 - 0.29398034574673402963e-3 * t185 * t131 + 0.48613749573020220489e-7 * t375 * t38 * t378 * t284;
  t405 = -0.12675e0 * t25 * t200 * t141 + 0.52e0 * t358 - 0.10575398542669004894e0 * t26 * t146 + 0.55555555555555555557e-1 * t56 * t207 * t125 - 0.54253472222222222223e-2 * t86 * t211 * t154;
  t408 = t215 * t20 * t36;
  t415 = sigma[0] * t74;
  t416 = t126 * t415;
  t419 = -t405;
  t421 = t219 * t112;
  t426 = t193 * t134;
  t432 = my_piecewise3(t72, -0.24390552529390783699e-1 * t37 * t137 + 0.55494314616508503409e-3 * t362 * t363 * t74, t405 * t76 - 0.243905525293907837e-1 * t408 * t163 + 0.91464571985215438873e-2 * t319 * t196 - 0.24390552529390783699e-1 * t161 * t137 + 0.55494314616508503409e-3 * t327 * t416 + t419 * t71 + 0.646416e0 * t421 * t134 + 0.646416e0 * t334 * t193 - 0.1292832e1 * t337 * t426 + 0.646416e0 * t168 * t383);
  t433 = my_piecewise3(t34, -0.1292832e1 * t355 * t134 + 0.646416e0 * t112 * t383, t432);
  t438 = my_piecewise3(t2, 0, -t6 * t107 * t225 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t433);
  tv2rhosigma0 = 0.2e1 * rho[0] * t438 + 0.2e1 * t229;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t441 = t193 * t193;
  t446 = t262 * sigma[0];
  t447 = 0.1e1 / t265;
  t455 = 0.1e1 / t41 / t266;
  t457 = t38 * t455 * t284;
  t460 = -0.66707071278514104084e-3 * t56 * t187 + 0.16676767819628526021e-3 * t446 * t447 * t50 + 0.55121314827512630556e-4 * t56 * t190 - 0.18230156089882582683e-7 * t276 * t57 * t457;
  t464 = t186 * t74;
  t467 = 0.1e1 / t79;
  t468 = t467 * t27;
  t476 = t26 * t38;
  t480 = -0.4753125e-1 * t25 * t468 * t30 + 0.13219248178336256118e-1 * t199 * t80 - 0.10416666666666666667e-1 * t56 * t186 + 0.1220703125e-2 * t86 * t476 * t91;
  t486 = -t480;
  t495 = my_piecewise3(t72, -0.20810367981190688778e-3 * t56 * t464, t480 * t76 + 0.18292914397043087775e-1 * t408 * t196 - 0.20810367981190688778e-3 * t327 * t464 + t486 * t71 + 0.1292832e1 * t421 * t193 - 0.1292832e1 * t337 * t441 + 0.646416e0 * t168 * t460);
  t496 = my_piecewise3(t34, -0.1292832e1 * t242 * t441 + 0.646416e0 * t112 * t460, t495);
  t500 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t496);
  tv2sigma20 = 0.2e1 * rho[0] * t500;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t30, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t43, t45, t47, t48, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t64, t66, t67;
  double t68, t71, t72, t74, t76, t77, t78, t79;
  double t80, t82, t83, t86, t87, t88, t89, t91;
  double t94, t95, t97, t100, t101, t105, tzk0;

  double t107, t111, t112, t113, t115, t117, t119, t120;
  double t123, t125, t126, t127, t130, t131, t134, t137;
  double t141, t146, t152, t154, t158, t161, t163, t166;
  double t168, t172, t173, t178, tvrho0, t181, t185, t186;
  double t187, t190, t193, t196, t199, t200, t207, t211;
  double t215, t219, t224, t225, t229, tvsigma0;

  double t234, t242, t243, t247, t249, t251, t252, t256;
  double t257, t258, t261, t262, t263, t264, t265, t266;
  double t267, t271, t276, t277, t278, t279, t281, t283;
  double t284, t285, t288, t292, t295, t300, t305, t312;
  double t316, t319, t323, t327, t329, t332, t334, t337;
  double t343, t344, t349, tv2rho20, t355, t358, t362, t363;
  double t367, t368, t369, t375, t376, t378, t383, t405;
  double t408, t415, t416, t419, t421, t426, t432, t433;
  double t438, tv2rhosigma0, t441, t446, t447, t455, t457, t460;
  double t464, t467, t468, t476, t480, t486, t495, t496;
  double t500, tv2sigma20;

  double t503, t513, t514, t515, t518, t522, t524, t526;
  double t527, t531, t532, t536, t540, t541, t543, t545;
  double t546, t549, t553, t556, t557, t559, t562, t565;
  double t569, t580, t585, t592, t596, t599, t605, t609;
  double t613, t616, t617, t620, t622, t625, t630, t633;
  double t638, t639, t640, t645, tv3rho30, t655, t658, t663;
  double t667, t671, t672, t682, t684, t688, t702, t711;
  double t715, t730, t732, t739, t742, t743, t746, t751;
  double t754, t757, t768, t770, t771, t776, tv3rho2sigma0, t782;
  double t787, t792, t793, t801, t802, t806, t807, t811;
  double t815, t832, t835, t848, t851, t853, t864, t867;
  double t872, t877, t878, t879, t884, tv3rhosigma20, t887, t902;
  double t906, t912, t913, t919, t923, t932, t942, t947;
  double t948, t949, t953, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t25 = t21 / t23;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = t32 / 0.12e2;
  t34 = t33 < 0.6e0;
  t35 = t23 * t23;
  t36 = 0.1e1 / t35;
  t37 = t20 * t36;
  t38 = t27 * t27;
  t39 = sigma[0] * t38;
  t40 = rho[0] * rho[0];
  t41 = t18 * t18;
  t43 = 0.1e1 / t41 / t40;
  t45 = t37 * t39 * t43;
  t47 = t37 * sigma[0];
  t48 = t38 * t43;
  t50 = exp(-t45 / 0.24e2);
  t51 = t48 * t50;
  t55 = 0.1e1 / t23 / t22;
  t56 = t21 * t55;
  t57 = sigma[0] * sigma[0];
  t58 = t57 * t27;
  t59 = t40 * t40;
  t60 = t59 * rho[0];
  t62 = 0.1e1 / t18 / t60;
  t64 = t56 * t58 * t62;
  t66 = 0.1e1 + 0.27560657413756315278e-4 * t64;
  t67 = log(t66);
  t68 = 0.804e0 + 0.5e1 / 0.972e3 * t45 + 0.4002424276710846245e-2 * t47 * t51 + t67;
  t71 = 0.1804e1 - 0.646416e0 / t68;
  t72 = 0.26e1 < t33;
  t74 = exp(-0.1137619054542480583e-1 * t45);
  t76 = 0.1804e1 - 0.804e0 * t74;
  t77 = 0.190125e0 * t32;
  t78 = 0.195e0 * t45;
  t79 = t26 * sigma[0];
  t80 = 0.1e1 / t59;
  t82 = 0.17625664237781674824e-1 * t79 * t80;
  t83 = 0.52083333333333333334e-2 * t64;
  t86 = t20 / t35 / t22;
  t87 = t26 * t57;
  t88 = t87 * t38;
  t89 = t59 * t40;
  t91 = 0.1e1 / t41 / t89;
  t94 = 0.32552083333333333334e-3 * t86 * t88 * t91;
  t95 = -0.40608e0 + t77 - t78 + t82 - t83 + t94;
  t97 = 0.140608e1 - t77 + t78 - t82 + t83 - t94;
  t100 = my_piecewise3(t72, t76, t97 * t71 + t95 * t76);
  t101 = my_piecewise3(t34, t71, t100);
  t105 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t101);
  tzk0 = 0.2e1 * t105;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t107 = t17 / t41;
  t111 = t68 * t68;
  t112 = 0.1e1 / t111;
  t113 = t40 * rho[0];
  t115 = 0.1e1 / t41 / t113;
  t117 = t37 * t39 * t115;
  t119 = t38 * t115;
  t120 = t119 * t50;
  t123 = t56 * t57;
  t125 = 0.1e1 / t18 / t89;
  t126 = t27 * t125;
  t127 = t126 * t50;
  t130 = 0.1e1 / t66;
  t131 = t126 * t130;
  t134 = -0.1e2 / 0.729e3 * t117 - 0.10673131404562256653e-1 * t47 * t120 + 0.88942761704685472111e-3 * t123 * t127 - 0.14699017287336701482e-3 * t123 * t131;
  t137 = t119 * t74;
  t141 = 0.1e1 / t18 / t40;
  t146 = 0.1e1 / t60;
  t152 = t59 * t113;
  t154 = 0.1e1 / t41 / t152;
  t158 = -0.2535e0 * t25 * t28 * t141 + 0.52e0 * t117 - 0.70502656951126699296e-1 * t79 * t146 + 0.27777777777777777778e-1 * t56 * t58 * t125 - 0.21701388888888888889e-2 * t86 * t88 * t154;
  t161 = t95 * t20 * t36;
  t163 = t39 * t115 * t74;
  t166 = -t158;
  t168 = t97 * t112;
  t172 = my_piecewise3(t72, -0.243905525293907837e-1 * t47 * t137, t158 * t76 - 0.243905525293907837e-1 * t161 * t163 + t166 * t71 + 0.646416e0 * t168 * t134);
  t173 = my_piecewise3(t34, 0.646416e0 * t112 * t134, t172);
  t178 = my_piecewise3(t2, 0, -t6 * t107 * t101 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t173);
  tvrho0 = 0.2e1 * rho[0] * t178 + 0.2e1 * t105;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t181 = t37 * t48;
  t185 = t56 * sigma[0];
  t186 = t27 * t62;
  t187 = t186 * t50;
  t190 = t186 * t130;
  t193 = 0.5e1 / 0.972e3 * t181 + 0.4002424276710846245e-2 * t37 * t51 - 0.33353535639257052042e-3 * t185 * t187 + 0.55121314827512630556e-4 * t185 * t190;
  t196 = t48 * t74;
  t199 = 0.1e1 / t26;
  t200 = t199 * t27;
  t207 = sigma[0] * t27;
  t211 = t79 * t38;
  t215 = 0.950625e-1 * t25 * t200 * t30 - 0.195e0 * t181 + 0.26438496356672512236e-1 * t26 * t80 - 0.10416666666666666667e-1 * t56 * t207 * t62 + 0.81380208333333333335e-3 * t86 * t211 * t91;
  t219 = -t215;
  t224 = my_piecewise3(t72, 0.91464571985215438873e-2 * t37 * t196, t215 * t76 + 0.91464571985215438873e-2 * t161 * t196 + t219 * t71 + 0.646416e0 * t168 * t193);
  t225 = my_piecewise3(t34, 0.646416e0 * t112 * t193, t224);
  t229 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t225);
  tvsigma0 = 0.2e1 * rho[0] * t229;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t234 = t17 / t41 / rho[0];
  t242 = 0.1e1 / t111 / t68;
  t243 = t134 * t134;
  t247 = 0.1e1 / t41 / t59;
  t249 = t37 * t39 * t247;
  t251 = t38 * t247;
  t252 = t251 * t50;
  t256 = 0.1e1 / t18 / t152;
  t257 = t27 * t256;
  t258 = t257 * t50;
  t261 = t22 * t22;
  t262 = 0.1e1 / t261;
  t263 = t57 * sigma[0];
  t264 = t262 * t263;
  t265 = t59 * t59;
  t266 = t265 * t40;
  t267 = 0.1e1 / t266;
  t271 = t257 * t130;
  t276 = t20 / t35 / t261;
  t277 = t57 * t57;
  t278 = t276 * t277;
  t279 = t265 * t59;
  t281 = 0.1e1 / t41 / t279;
  t283 = t66 * t66;
  t284 = 0.1e1 / t283;
  t285 = t38 * t281 * t284;
  t288 = 0.11e3 / 0.2187e4 * t249 + 0.39134815150061607728e-1 * t47 * t252 - 0.800484855342169249e-2 * t123 * t258 + 0.11859034893958062948e-2 * t264 * t267 * t50 + 0.93093776153132442719e-3 * t123 * t271 - 0.12963666552805392131e-6 * t278 * t285;
  t292 = t251 * t74;
  t295 = t257 * t74;
  t300 = 0.1e1 / t18 / t113;
  t305 = 0.1e1 / t89;
  t312 = 0.1e1 / t41 / t265;
  t316 = 0.5915e0 * t25 * t28 * t300 - 0.19066666666666666667e1 * t249 + 0.35251328475563349648e0 * t79 * t305 - 0.17592592592592592593e0 * t56 * t58 * t256 + 0.16637731481481481482e-1 * t86 * t88 * t312;
  t319 = t158 * t20 * t36;
  t323 = t39 * t247 * t74;
  t327 = t95 * t21 * t55;
  t329 = t58 * t256 * t74;
  t332 = -t316;
  t334 = t166 * t112;
  t337 = t97 * t242;
  t343 = my_piecewise3(t72, 0.89432025941099540233e-1 * t47 * t292 - 0.14798483897735600909e-2 * t123 * t295, t316 * t76 - 0.487811050587815674e-1 * t319 * t163 + 0.89432025941099540233e-1 * t161 * t323 - 0.14798483897735600909e-2 * t327 * t329 + t332 * t71 + 0.1292832e1 * t334 * t134 - 0.1292832e1 * t337 * t243 + 0.646416e0 * t168 * t288);
  t344 = my_piecewise3(t34, -0.1292832e1 * t242 * t243 + 0.646416e0 * t112 * t288, t343);
  t349 = my_piecewise3(t2, 0, t6 * t234 * t101 / 0.12e2 - t6 * t107 * t173 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t344);
  tv2rho20 = 0.2e1 * rho[0] * t349 + 0.4e1 * t178;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t355 = t242 * t193;
  t358 = t37 * t119;
  t362 = t56 * t27;
  t363 = t125 * sigma[0];
  t367 = t262 * t57;
  t368 = t265 * rho[0];
  t369 = 0.1e1 / t368;
  t375 = t276 * t263;
  t376 = t265 * t113;
  t378 = 0.1e1 / t41 / t376;
  t383 = -0.1e2 / 0.729e3 * t358 - 0.10673131404562256653e-1 * t37 * t120 + 0.26682828511405641633e-2 * t362 * t363 * t50 - 0.44471380852342736056e-3 * t367 * t369 * t50 - 0.29398034574673402963e-3 * t185 * t131 + 0.48613749573020220489e-7 * t375 * t38 * t378 * t284;
  t405 = -0.12675e0 * t25 * t200 * t141 + 0.52e0 * t358 - 0.10575398542669004894e0 * t26 * t146 + 0.55555555555555555557e-1 * t56 * t207 * t125 - 0.54253472222222222223e-2 * t86 * t211 * t154;
  t408 = t215 * t20 * t36;
  t415 = sigma[0] * t74;
  t416 = t126 * t415;
  t419 = -t405;
  t421 = t219 * t112;
  t426 = t193 * t134;
  t432 = my_piecewise3(t72, -0.24390552529390783699e-1 * t37 * t137 + 0.55494314616508503409e-3 * t362 * t363 * t74, t405 * t76 - 0.243905525293907837e-1 * t408 * t163 + 0.91464571985215438873e-2 * t319 * t196 - 0.24390552529390783699e-1 * t161 * t137 + 0.55494314616508503409e-3 * t327 * t416 + t419 * t71 + 0.646416e0 * t421 * t134 + 0.646416e0 * t334 * t193 - 0.1292832e1 * t337 * t426 + 0.646416e0 * t168 * t383);
  t433 = my_piecewise3(t34, -0.1292832e1 * t355 * t134 + 0.646416e0 * t112 * t383, t432);
  t438 = my_piecewise3(t2, 0, -t6 * t107 * t225 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t433);
  tv2rhosigma0 = 0.2e1 * rho[0] * t438 + 0.2e1 * t229;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t441 = t193 * t193;
  t446 = t262 * sigma[0];
  t447 = 0.1e1 / t265;
  t455 = 0.1e1 / t41 / t266;
  t457 = t38 * t455 * t284;
  t460 = -0.66707071278514104084e-3 * t56 * t187 + 0.16676767819628526021e-3 * t446 * t447 * t50 + 0.55121314827512630556e-4 * t56 * t190 - 0.18230156089882582683e-7 * t276 * t57 * t457;
  t464 = t186 * t74;
  t467 = 0.1e1 / t79;
  t468 = t467 * t27;
  t476 = t26 * t38;
  t480 = -0.4753125e-1 * t25 * t468 * t30 + 0.13219248178336256118e-1 * t199 * t80 - 0.10416666666666666667e-1 * t56 * t186 + 0.1220703125e-2 * t86 * t476 * t91;
  t486 = -t480;
  t495 = my_piecewise3(t72, -0.20810367981190688778e-3 * t56 * t464, t480 * t76 + 0.18292914397043087775e-1 * t408 * t196 - 0.20810367981190688778e-3 * t327 * t464 + t486 * t71 + 0.1292832e1 * t421 * t193 - 0.1292832e1 * t337 * t441 + 0.646416e0 * t168 * t460);
  t496 = my_piecewise3(t34, -0.1292832e1 * t242 * t441 + 0.646416e0 * t112 * t460, t495);
  t500 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t496);
  tv2sigma20 = 0.2e1 * rho[0] * t500;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t503 = t17 * t43;
  t513 = t111 * t111;
  t514 = 0.1e1 / t513;
  t515 = t243 * t134;
  t518 = t242 * t134;
  t522 = 0.1e1 / t41 / t60;
  t524 = t37 * t39 * t522;
  t526 = t38 * t522;
  t527 = t526 * t50;
  t531 = 0.1e1 / t18 / t265;
  t532 = t27 * t531;
  t536 = 0.1e1 / t376;
  t540 = t262 * t277;
  t541 = t265 * t60;
  t543 = 0.1e1 / t41 / t541;
  t545 = t38 * t50;
  t546 = t37 * t545;
  t549 = t532 * t130;
  t553 = t38 * t543 * t284;
  t556 = t277 * t57;
  t557 = t265 * t265;
  t559 = 0.1e1 / t557 / t113;
  t562 = 0.1e1 / t283 / t66;
  t565 = -0.154e4 / 0.6561e4 * t524 - 0.1826291373669541694e0 * t47 * t527 + 0.67398848313994991088e-1 * t123 * t532 * t50 - 0.22532166298520319601e-1 * t264 * t536 * t50 + 0.13176705437731181053e-3 * t540 * t543 * t546 - 0.68268769178963791327e-2 * t123 * t549 + 0.24630966450330245049e-5 * t278 * t553 - 0.48197932879823405316e-13 * t556 * t559 * t562;
  t569 = t526 * t74;
  t580 = 0.1e1 / t18 / t59;
  t585 = 0.1e1 / t152;
  t592 = 0.1e1 / t41 / t368;
  t596 = -0.19716666666666666667e1 * t25 * t28 * t580 + 0.88977777777777777779e1 * t524 - 0.21150797085338009789e1 * t79 * t585 + 0.12901234567901234568e1 * t56 * t58 * t531 - 0.14419367283950617284e0 * t86 * t88 * t592;
  t599 = t316 * t20 * t36;
  t605 = t158 * t21 * t55;
  t609 = t39 * t522 * t74;
  t613 = t58 * t531 * t74;
  t616 = t95 * t263;
  t617 = t536 * t74;
  t620 = -t596;
  t622 = t332 * t112;
  t625 = t166 * t242;
  t630 = t97 * t514;
  t633 = t134 * t288;
  t638 = t596 * t76 - 0.731716575881723511e-1 * t599 * t163 + 0.2682960778232986207e0 * t319 * t323 - 0.44395451693206802728e-2 * t605 * t329 - 0.41734945439179785442e0 * t161 * t609 + 0.16278332287509161e-1 * t327 * t613 - 0.55305022007122575148e-5 * t616 * t617 + t620 * t71 + 0.1939248e1 * t622 * t134 - 0.3878496e1 * t625 * t243 + 0.1939248e1 * t334 * t288 + 0.3878496e1 * t630 * t515 - 0.3878496e1 * t337 * t633 + 0.646416e0 * t168 * t565;
  t639 = my_piecewise3(t72, -0.41734945439179785442e0 * t47 * t569 + 0.16278332287509161e-1 * t123 * t532 * t74 - 0.55305022007122575148e-5 * t263 * t536 * t74, t638);
  t640 = my_piecewise3(t34, 0.3878496e1 * t514 * t515 - 0.3878496e1 * t518 * t288 + 0.646416e0 * t112 * t565, t639);
  t645 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t503 * t101 + t6 * t234 * t173 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t107 * t344 - 0.3e1 / 0.8e1 * t6 * t19 * t640);
  tv3rho30 = 0.2e1 * rho[0] * t645 + 0.6e1 * t349;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t655 = t514 * t193;
  t658 = t242 * t383;
  t663 = t37 * t251;
  t667 = t256 * sigma[0];
  t671 = t262 * t267;
  t672 = t57 * t50;
  t682 = t277 * sigma[0];
  t684 = 0.1e1 / t557 / t40;
  t688 = 0.11e3 / 0.2187e4 * t663 + 0.39134815150061607728e-1 * t37 * t252 - 0.19270931702681852291e-1 * t362 * t667 * t50 + 0.75601347448982651294e-2 * t671 * t672 - 0.49412645391491928951e-4 * t264 * t281 * t546 + 0.18618755230626488543e-2 * t185 * t271 - 0.82643374274134374831e-6 * t375 * t285 + 0.18074224829933776993e-13 * t682 * t684 * t562;
  t702 = t215 * t21 * t55;
  t711 = t257 * t415;
  t715 = t405 * t20 * t36;
  t730 = -0.29575e0 * t25 * t200 * t300 + 0.19066666666666666667e1 * t663 - 0.5287699271334502447e0 * t26 * t305 + 0.35185185185185185186e0 * t56 * t207 * t256 - 0.41594328703703703704e-1 * t86 * t211 * t312;
  t732 = -t730;
  t739 = t193 * t243;
  t742 = t95 * t267;
  t743 = t57 * t74;
  t746 = t219 * t242;
  t751 = t383 * t134;
  t754 = t193 * t288;
  t757 = t419 * t112;
  t768 = 0.3878496e1 * t630 * t739 + 0.20739383252670965681e-5 * t742 * t743 - 0.1292832e1 * t746 * t243 - 0.2585664e1 * t625 * t426 - 0.2585664e1 * t337 * t751 - 0.1292832e1 * t337 * t754 + 0.1292832e1 * t757 * t134 + 0.646416e0 * t421 * t288 + 0.646416e0 * t622 * t193 + 0.1292832e1 * t334 * t383 + 0.646416e0 * t168 * t688;
  t770 = my_piecewise3(t72, 0.8943202594109954023e-1 * t37 * t292 - 0.49944883154857653068e-2 * t362 * t667 * t74 + 0.20739383252670965681e-5 * t267 * t57 * t74, -0.14798483897735600909e-2 * t702 * t329 - 0.48781105058781567398e-1 * t319 * t137 + 0.11098862923301700682e-2 * t605 * t416 + 0.8943202594109954023e-1 * t161 * t292 - 0.49944883154857653068e-2 * t327 * t711 - 0.487811050587815674e-1 * t715 * t163 + t730 * t71 + t732 * t76 + 0.91464571985215438873e-2 * t599 * t196 + 0.89432025941099540233e-1 * t408 * t323 + t768);
  t771 = my_piecewise3(t34, 0.3878496e1 * t655 * t243 - 0.2585664e1 * t658 * t134 - 0.1292832e1 * t355 * t288 + 0.646416e0 * t112 * t688, t770);
  t776 = my_piecewise3(t2, 0, t6 * t234 * t225 / 0.12e2 - t6 * t107 * t433 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t771);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t776 + 0.4e1 * t438;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t782 = t514 * t441;
  t787 = t242 * t460;
  t792 = t262 * t369;
  t793 = sigma[0] * t50;
  t801 = t276 * t38;
  t802 = t378 * t284;
  t806 = t557 * rho[0];
  t807 = 0.1e1 / t806;
  t811 = 0.35577104681874188845e-2 * t56 * t127 - 0.22235690426171368028e-2 * t792 * t793 + 0.18529742021809473357e-4 * t367 * t378 * t546 - 0.29398034574673402963e-3 * t56 * t131 + 0.24306874786510110244e-6 * t801 * t802 * t57 - 0.67778343112251663721e-14 * t277 * t807 * t562;
  t815 = t126 * t74;
  t832 = 0.63375e-1 * t25 * t468 * t141 - 0.52876992713345024472e-1 * t199 * t146 + 0.55555555555555555557e-1 * t56 * t126 - 0.81380208333333333333e-2 * t86 * t476 * t154;
  t835 = t480 * t20 * t36;
  t848 = t95 * t369;
  t851 = -t832;
  t853 = t486 * t112;
  t864 = t441 * t134;
  t867 = t193 * t383;
  t872 = t460 * t134;
  t877 = t832 * t76 - 0.243905525293907837e-1 * t835 * t163 + 0.18292914397043087775e-1 * t715 * t196 - 0.487811050587815674e-1 * t408 * t137 + 0.11098862923301700682e-2 * t702 * t416 - 0.20810367981190688778e-3 * t605 * t464 + 0.11098862923301700682e-2 * t327 * t815 - 0.77772687197516121301e-6 * t848 * t415 + t851 * t71 + 0.646416e0 * t853 * t134 + 0.1292832e1 * t757 * t193 - 0.2585664e1 * t746 * t426 + 0.1292832e1 * t421 * t383 - 0.1292832e1 * t625 * t441 + 0.3878496e1 * t630 * t864 - 0.2585664e1 * t337 * t867 + 0.646416e0 * t334 * t460 - 0.1292832e1 * t337 * t872 + 0.646416e0 * t168 * t811;
  t878 = my_piecewise3(t72, 0.11098862923301700682e-2 * t56 * t815 - 0.77772687197516121301e-6 * t369 * sigma[0] * t74, t877);
  t879 = my_piecewise3(t34, 0.3878496e1 * t782 * t134 - 0.2585664e1 * t355 * t383 - 0.1292832e1 * t787 * t134 + 0.646416e0 * t112 * t811, t878);
  t884 = my_piecewise3(t2, 0, -t6 * t107 * t496 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t879);
  tv3rhosigma20 = 0.2e1 * rho[0] * t884 + 0.2e1 * t500;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t887 = t441 * t193;
  t902 = 0.1e1 / t557;
  t906 = 0.50030303458885578063e-3 * t262 * t447 * t50 - 0.69486532581785525088e-5 * t446 * t455 * t546 - 0.54690468269647748049e-7 * t801 * t455 * t284 * sigma[0] + 0.25416878667094373895e-14 * t263 * t902 * t562;
  t912 = 0.1e1 / t87;
  t913 = t912 * t27;
  t919 = t199 * t38;
  t923 = 0.71296875e-1 * t25 * t913 * t30 - 0.6609624089168128059e-2 * t467 * t80 + 0.6103515625e-3 * t86 * t919 * t91;
  t932 = -t923;
  t942 = t193 * t460;
  t947 = t923 * t76 + 0.27439371595564631662e-1 * t835 * t196 - 0.62431103943572066335e-3 * t702 * t464 + 0.29164757699068545486e-6 * t95 * t447 * t74 + t932 * t71 + 0.1939248e1 * t853 * t193 - 0.3878496e1 * t746 * t441 + 0.1939248e1 * t421 * t460 + 0.3878496e1 * t630 * t887 - 0.3878496e1 * t337 * t942 + 0.646416e0 * t168 * t906;
  t948 = my_piecewise3(t72, 0.29164757699068545486e-6 * t447 * t74, t947);
  t949 = my_piecewise3(t34, 0.3878496e1 * t514 * t887 - 0.3878496e1 * t355 * t460 + 0.646416e0 * t112 * t906, t948);
  t953 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t949);
  tv3sigma30 = 0.2e1 * rho[0] * t953;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t25, t26, t27, t28, t30, t32, t33;
  double t34, t35, t36, t37, t38, t39, t40, t41;
  double t43, t45, t47, t48, t50, t51, t55, t56;
  double t57, t58, t59, t60, t62, t64, t66, t67;
  double t68, t71, t72, t74, t76, t77, t78, t79;
  double t80, t82, t83, t86, t87, t88, t89, t91;
  double t94, t95, t97, t100, t101, t105, tzk0;

  double t107, t111, t112, t113, t115, t117, t119, t120;
  double t123, t125, t126, t127, t130, t131, t134, t137;
  double t141, t146, t152, t154, t158, t161, t163, t166;
  double t168, t172, t173, t178, tvrho0, t181, t185, t186;
  double t187, t190, t193, t196, t199, t200, t207, t211;
  double t215, t219, t224, t225, t229, tvsigma0;

  double t234, t242, t243, t247, t249, t251, t252, t256;
  double t257, t258, t261, t262, t263, t264, t265, t266;
  double t267, t271, t276, t277, t278, t279, t281, t283;
  double t284, t285, t288, t292, t295, t300, t305, t312;
  double t316, t319, t323, t327, t329, t332, t334, t337;
  double t343, t344, t349, tv2rho20, t355, t358, t362, t363;
  double t367, t368, t369, t375, t376, t378, t383, t405;
  double t408, t415, t416, t419, t421, t426, t432, t433;
  double t438, tv2rhosigma0, t441, t446, t447, t455, t457, t460;
  double t464, t467, t468, t476, t480, t486, t495, t496;
  double t500, tv2sigma20;

  double t503, t513, t514, t515, t518, t522, t524, t526;
  double t527, t531, t532, t536, t540, t541, t543, t545;
  double t546, t549, t553, t556, t557, t559, t562, t565;
  double t569, t580, t585, t592, t596, t599, t605, t609;
  double t613, t616, t617, t620, t622, t625, t630, t633;
  double t638, t639, t640, t645, tv3rho30, t655, t658, t663;
  double t667, t671, t672, t682, t684, t688, t702, t711;
  double t715, t730, t732, t739, t742, t743, t746, t751;
  double t754, t757, t768, t770, t771, t776, tv3rho2sigma0, t782;
  double t787, t792, t793, t801, t802, t806, t807, t811;
  double t815, t832, t835, t848, t851, t853, t864, t867;
  double t872, t877, t878, t879, t884, tv3rhosigma20, t887, t902;
  double t906, t912, t913, t919, t923, t932, t942, t947;
  double t948, t949, t953, tv3sigma30;

  double t970, t971, t977, t983, t985, t990, t991, t995;
  double t999, t1001, t1010, t1025, t1030, t1031, t1035, t1050;
  double t1051, t1061, t1064, t1069, t1092, t1096, t1099, t1100;
  double t1104, t1108, t1131, t1134, t1136, t1137, t1142, tv4rho40;
  double t1170, t1174, t1205, t1241, t1245, t1272, t1305, t1321;
  double t1324, t1327, t1330, t1332, t1333, t1338, tv4rho3sigma0, t1355;
  double t1398, t1437, t1444, t1459, t1462, t1465, t1523, t1527;
  double t1530, t1531, t1536, tv4rho2sigma20, t1560, t1582, t1608, t1629;
  double t1638, t1677, t1681, t1683, t1684, t1689, tv4rhosigma30, t1692;
  double t1697, t1724, t1751, t1782, t1783, t1784, t1788, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = t20 * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t25 = t21 / t23;
  t26 = sqrt(sigma[0]);
  t27 = M_CBRT2;
  t28 = t26 * t27;
  t30 = 0.1e1 / t18 / rho[0];
  t32 = t25 * t28 * t30;
  t33 = t32 / 0.12e2;
  t34 = t33 < 0.6e0;
  t35 = t23 * t23;
  t36 = 0.1e1 / t35;
  t37 = t20 * t36;
  t38 = t27 * t27;
  t39 = sigma[0] * t38;
  t40 = rho[0] * rho[0];
  t41 = t18 * t18;
  t43 = 0.1e1 / t41 / t40;
  t45 = t37 * t39 * t43;
  t47 = t37 * sigma[0];
  t48 = t38 * t43;
  t50 = exp(-t45 / 0.24e2);
  t51 = t48 * t50;
  t55 = 0.1e1 / t23 / t22;
  t56 = t21 * t55;
  t57 = sigma[0] * sigma[0];
  t58 = t57 * t27;
  t59 = t40 * t40;
  t60 = t59 * rho[0];
  t62 = 0.1e1 / t18 / t60;
  t64 = t56 * t58 * t62;
  t66 = 0.1e1 + 0.27560657413756315278e-4 * t64;
  t67 = log(t66);
  t68 = 0.804e0 + 0.5e1 / 0.972e3 * t45 + 0.4002424276710846245e-2 * t47 * t51 + t67;
  t71 = 0.1804e1 - 0.646416e0 / t68;
  t72 = 0.26e1 < t33;
  t74 = exp(-0.1137619054542480583e-1 * t45);
  t76 = 0.1804e1 - 0.804e0 * t74;
  t77 = 0.190125e0 * t32;
  t78 = 0.195e0 * t45;
  t79 = t26 * sigma[0];
  t80 = 0.1e1 / t59;
  t82 = 0.17625664237781674824e-1 * t79 * t80;
  t83 = 0.52083333333333333334e-2 * t64;
  t86 = t20 / t35 / t22;
  t87 = t26 * t57;
  t88 = t87 * t38;
  t89 = t59 * t40;
  t91 = 0.1e1 / t41 / t89;
  t94 = 0.32552083333333333334e-3 * t86 * t88 * t91;
  t95 = -0.40608e0 + t77 - t78 + t82 - t83 + t94;
  t97 = 0.140608e1 - t77 + t78 - t82 + t83 - t94;
  t100 = my_piecewise3(t72, t76, t97 * t71 + t95 * t76);
  t101 = my_piecewise3(t34, t71, t100);
  t105 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t101);
  tzk0 = 0.2e1 * t105;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t107 = t17 / t41;
  t111 = t68 * t68;
  t112 = 0.1e1 / t111;
  t113 = t40 * rho[0];
  t115 = 0.1e1 / t41 / t113;
  t117 = t37 * t39 * t115;
  t119 = t38 * t115;
  t120 = t119 * t50;
  t123 = t56 * t57;
  t125 = 0.1e1 / t18 / t89;
  t126 = t27 * t125;
  t127 = t126 * t50;
  t130 = 0.1e1 / t66;
  t131 = t126 * t130;
  t134 = -0.1e2 / 0.729e3 * t117 - 0.10673131404562256653e-1 * t47 * t120 + 0.88942761704685472111e-3 * t123 * t127 - 0.14699017287336701482e-3 * t123 * t131;
  t137 = t119 * t74;
  t141 = 0.1e1 / t18 / t40;
  t146 = 0.1e1 / t60;
  t152 = t59 * t113;
  t154 = 0.1e1 / t41 / t152;
  t158 = -0.2535e0 * t25 * t28 * t141 + 0.52e0 * t117 - 0.70502656951126699296e-1 * t79 * t146 + 0.27777777777777777778e-1 * t56 * t58 * t125 - 0.21701388888888888889e-2 * t86 * t88 * t154;
  t161 = t95 * t20 * t36;
  t163 = t39 * t115 * t74;
  t166 = -t158;
  t168 = t97 * t112;
  t172 = my_piecewise3(t72, -0.243905525293907837e-1 * t47 * t137, t158 * t76 - 0.243905525293907837e-1 * t161 * t163 + t166 * t71 + 0.646416e0 * t168 * t134);
  t173 = my_piecewise3(t34, 0.646416e0 * t112 * t134, t172);
  t178 = my_piecewise3(t2, 0, -t6 * t107 * t101 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t173);
  tvrho0 = 0.2e1 * rho[0] * t178 + 0.2e1 * t105;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t181 = t37 * t48;
  t185 = t56 * sigma[0];
  t186 = t27 * t62;
  t187 = t186 * t50;
  t190 = t186 * t130;
  t193 = 0.5e1 / 0.972e3 * t181 + 0.4002424276710846245e-2 * t37 * t51 - 0.33353535639257052042e-3 * t185 * t187 + 0.55121314827512630556e-4 * t185 * t190;
  t196 = t48 * t74;
  t199 = 0.1e1 / t26;
  t200 = t199 * t27;
  t207 = sigma[0] * t27;
  t211 = t79 * t38;
  t215 = 0.950625e-1 * t25 * t200 * t30 - 0.195e0 * t181 + 0.26438496356672512236e-1 * t26 * t80 - 0.10416666666666666667e-1 * t56 * t207 * t62 + 0.81380208333333333335e-3 * t86 * t211 * t91;
  t219 = -t215;
  t224 = my_piecewise3(t72, 0.91464571985215438873e-2 * t37 * t196, t215 * t76 + 0.91464571985215438873e-2 * t161 * t196 + t219 * t71 + 0.646416e0 * t168 * t193);
  t225 = my_piecewise3(t34, 0.646416e0 * t112 * t193, t224);
  t229 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t225);
  tvsigma0 = 0.2e1 * rho[0] * t229;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t234 = t17 / t41 / rho[0];
  t242 = 0.1e1 / t111 / t68;
  t243 = t134 * t134;
  t247 = 0.1e1 / t41 / t59;
  t249 = t37 * t39 * t247;
  t251 = t38 * t247;
  t252 = t251 * t50;
  t256 = 0.1e1 / t18 / t152;
  t257 = t27 * t256;
  t258 = t257 * t50;
  t261 = t22 * t22;
  t262 = 0.1e1 / t261;
  t263 = t57 * sigma[0];
  t264 = t262 * t263;
  t265 = t59 * t59;
  t266 = t265 * t40;
  t267 = 0.1e1 / t266;
  t271 = t257 * t130;
  t276 = t20 / t35 / t261;
  t277 = t57 * t57;
  t278 = t276 * t277;
  t279 = t265 * t59;
  t281 = 0.1e1 / t41 / t279;
  t283 = t66 * t66;
  t284 = 0.1e1 / t283;
  t285 = t38 * t281 * t284;
  t288 = 0.11e3 / 0.2187e4 * t249 + 0.39134815150061607728e-1 * t47 * t252 - 0.800484855342169249e-2 * t123 * t258 + 0.11859034893958062948e-2 * t264 * t267 * t50 + 0.93093776153132442719e-3 * t123 * t271 - 0.12963666552805392131e-6 * t278 * t285;
  t292 = t251 * t74;
  t295 = t257 * t74;
  t300 = 0.1e1 / t18 / t113;
  t305 = 0.1e1 / t89;
  t312 = 0.1e1 / t41 / t265;
  t316 = 0.5915e0 * t25 * t28 * t300 - 0.19066666666666666667e1 * t249 + 0.35251328475563349648e0 * t79 * t305 - 0.17592592592592592593e0 * t56 * t58 * t256 + 0.16637731481481481482e-1 * t86 * t88 * t312;
  t319 = t158 * t20 * t36;
  t323 = t39 * t247 * t74;
  t327 = t95 * t21 * t55;
  t329 = t58 * t256 * t74;
  t332 = -t316;
  t334 = t166 * t112;
  t337 = t97 * t242;
  t343 = my_piecewise3(t72, 0.89432025941099540233e-1 * t47 * t292 - 0.14798483897735600909e-2 * t123 * t295, t316 * t76 - 0.487811050587815674e-1 * t319 * t163 + 0.89432025941099540233e-1 * t161 * t323 - 0.14798483897735600909e-2 * t327 * t329 + t332 * t71 + 0.1292832e1 * t334 * t134 - 0.1292832e1 * t337 * t243 + 0.646416e0 * t168 * t288);
  t344 = my_piecewise3(t34, -0.1292832e1 * t242 * t243 + 0.646416e0 * t112 * t288, t343);
  t349 = my_piecewise3(t2, 0, t6 * t234 * t101 / 0.12e2 - t6 * t107 * t173 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t344);
  tv2rho20 = 0.2e1 * rho[0] * t349 + 0.4e1 * t178;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t355 = t242 * t193;
  t358 = t37 * t119;
  t362 = t56 * t27;
  t363 = t125 * sigma[0];
  t367 = t262 * t57;
  t368 = t265 * rho[0];
  t369 = 0.1e1 / t368;
  t375 = t276 * t263;
  t376 = t265 * t113;
  t378 = 0.1e1 / t41 / t376;
  t383 = -0.1e2 / 0.729e3 * t358 - 0.10673131404562256653e-1 * t37 * t120 + 0.26682828511405641633e-2 * t362 * t363 * t50 - 0.44471380852342736056e-3 * t367 * t369 * t50 - 0.29398034574673402963e-3 * t185 * t131 + 0.48613749573020220489e-7 * t375 * t38 * t378 * t284;
  t405 = -0.12675e0 * t25 * t200 * t141 + 0.52e0 * t358 - 0.10575398542669004894e0 * t26 * t146 + 0.55555555555555555557e-1 * t56 * t207 * t125 - 0.54253472222222222223e-2 * t86 * t211 * t154;
  t408 = t215 * t20 * t36;
  t415 = sigma[0] * t74;
  t416 = t126 * t415;
  t419 = -t405;
  t421 = t219 * t112;
  t426 = t193 * t134;
  t432 = my_piecewise3(t72, -0.24390552529390783699e-1 * t37 * t137 + 0.55494314616508503409e-3 * t362 * t363 * t74, t405 * t76 - 0.243905525293907837e-1 * t408 * t163 + 0.91464571985215438873e-2 * t319 * t196 - 0.24390552529390783699e-1 * t161 * t137 + 0.55494314616508503409e-3 * t327 * t416 + t419 * t71 + 0.646416e0 * t421 * t134 + 0.646416e0 * t334 * t193 - 0.1292832e1 * t337 * t426 + 0.646416e0 * t168 * t383);
  t433 = my_piecewise3(t34, -0.1292832e1 * t355 * t134 + 0.646416e0 * t112 * t383, t432);
  t438 = my_piecewise3(t2, 0, -t6 * t107 * t225 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t433);
  tv2rhosigma0 = 0.2e1 * rho[0] * t438 + 0.2e1 * t229;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t441 = t193 * t193;
  t446 = t262 * sigma[0];
  t447 = 0.1e1 / t265;
  t455 = 0.1e1 / t41 / t266;
  t457 = t38 * t455 * t284;
  t460 = -0.66707071278514104084e-3 * t56 * t187 + 0.16676767819628526021e-3 * t446 * t447 * t50 + 0.55121314827512630556e-4 * t56 * t190 - 0.18230156089882582683e-7 * t276 * t57 * t457;
  t464 = t186 * t74;
  t467 = 0.1e1 / t79;
  t468 = t467 * t27;
  t476 = t26 * t38;
  t480 = -0.4753125e-1 * t25 * t468 * t30 + 0.13219248178336256118e-1 * t199 * t80 - 0.10416666666666666667e-1 * t56 * t186 + 0.1220703125e-2 * t86 * t476 * t91;
  t486 = -t480;
  t495 = my_piecewise3(t72, -0.20810367981190688778e-3 * t56 * t464, t480 * t76 + 0.18292914397043087775e-1 * t408 * t196 - 0.20810367981190688778e-3 * t327 * t464 + t486 * t71 + 0.1292832e1 * t421 * t193 - 0.1292832e1 * t337 * t441 + 0.646416e0 * t168 * t460);
  t496 = my_piecewise3(t34, -0.1292832e1 * t242 * t441 + 0.646416e0 * t112 * t460, t495);
  t500 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t496);
  tv2sigma20 = 0.2e1 * rho[0] * t500;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t503 = t17 * t43;
  t513 = t111 * t111;
  t514 = 0.1e1 / t513;
  t515 = t243 * t134;
  t518 = t242 * t134;
  t522 = 0.1e1 / t41 / t60;
  t524 = t37 * t39 * t522;
  t526 = t38 * t522;
  t527 = t526 * t50;
  t531 = 0.1e1 / t18 / t265;
  t532 = t27 * t531;
  t536 = 0.1e1 / t376;
  t540 = t262 * t277;
  t541 = t265 * t60;
  t543 = 0.1e1 / t41 / t541;
  t545 = t38 * t50;
  t546 = t37 * t545;
  t549 = t532 * t130;
  t553 = t38 * t543 * t284;
  t556 = t277 * t57;
  t557 = t265 * t265;
  t559 = 0.1e1 / t557 / t113;
  t562 = 0.1e1 / t283 / t66;
  t565 = -0.154e4 / 0.6561e4 * t524 - 0.1826291373669541694e0 * t47 * t527 + 0.67398848313994991088e-1 * t123 * t532 * t50 - 0.22532166298520319601e-1 * t264 * t536 * t50 + 0.13176705437731181053e-3 * t540 * t543 * t546 - 0.68268769178963791327e-2 * t123 * t549 + 0.24630966450330245049e-5 * t278 * t553 - 0.48197932879823405316e-13 * t556 * t559 * t562;
  t569 = t526 * t74;
  t580 = 0.1e1 / t18 / t59;
  t585 = 0.1e1 / t152;
  t592 = 0.1e1 / t41 / t368;
  t596 = -0.19716666666666666667e1 * t25 * t28 * t580 + 0.88977777777777777779e1 * t524 - 0.21150797085338009789e1 * t79 * t585 + 0.12901234567901234568e1 * t56 * t58 * t531 - 0.14419367283950617284e0 * t86 * t88 * t592;
  t599 = t316 * t20 * t36;
  t605 = t158 * t21 * t55;
  t609 = t39 * t522 * t74;
  t613 = t58 * t531 * t74;
  t616 = t95 * t263;
  t617 = t536 * t74;
  t620 = -t596;
  t622 = t332 * t112;
  t625 = t166 * t242;
  t630 = t97 * t514;
  t633 = t134 * t288;
  t638 = t596 * t76 - 0.731716575881723511e-1 * t599 * t163 + 0.2682960778232986207e0 * t319 * t323 - 0.44395451693206802728e-2 * t605 * t329 - 0.41734945439179785442e0 * t161 * t609 + 0.16278332287509161e-1 * t327 * t613 - 0.55305022007122575148e-5 * t616 * t617 + t620 * t71 + 0.1939248e1 * t622 * t134 - 0.3878496e1 * t625 * t243 + 0.1939248e1 * t334 * t288 + 0.3878496e1 * t630 * t515 - 0.3878496e1 * t337 * t633 + 0.646416e0 * t168 * t565;
  t639 = my_piecewise3(t72, -0.41734945439179785442e0 * t47 * t569 + 0.16278332287509161e-1 * t123 * t532 * t74 - 0.55305022007122575148e-5 * t263 * t536 * t74, t638);
  t640 = my_piecewise3(t34, 0.3878496e1 * t514 * t515 - 0.3878496e1 * t518 * t288 + 0.646416e0 * t112 * t565, t639);
  t645 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t503 * t101 + t6 * t234 * t173 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t107 * t344 - 0.3e1 / 0.8e1 * t6 * t19 * t640);
  tv3rho30 = 0.2e1 * rho[0] * t645 + 0.6e1 * t349;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t655 = t514 * t193;
  t658 = t242 * t383;
  t663 = t37 * t251;
  t667 = t256 * sigma[0];
  t671 = t262 * t267;
  t672 = t57 * t50;
  t682 = t277 * sigma[0];
  t684 = 0.1e1 / t557 / t40;
  t688 = 0.11e3 / 0.2187e4 * t663 + 0.39134815150061607728e-1 * t37 * t252 - 0.19270931702681852291e-1 * t362 * t667 * t50 + 0.75601347448982651294e-2 * t671 * t672 - 0.49412645391491928951e-4 * t264 * t281 * t546 + 0.18618755230626488543e-2 * t185 * t271 - 0.82643374274134374831e-6 * t375 * t285 + 0.18074224829933776993e-13 * t682 * t684 * t562;
  t702 = t215 * t21 * t55;
  t711 = t257 * t415;
  t715 = t405 * t20 * t36;
  t730 = -0.29575e0 * t25 * t200 * t300 + 0.19066666666666666667e1 * t663 - 0.5287699271334502447e0 * t26 * t305 + 0.35185185185185185186e0 * t56 * t207 * t256 - 0.41594328703703703704e-1 * t86 * t211 * t312;
  t732 = -t730;
  t739 = t193 * t243;
  t742 = t95 * t267;
  t743 = t57 * t74;
  t746 = t219 * t242;
  t751 = t383 * t134;
  t754 = t193 * t288;
  t757 = t419 * t112;
  t768 = 0.3878496e1 * t630 * t739 + 0.20739383252670965681e-5 * t742 * t743 - 0.1292832e1 * t746 * t243 - 0.2585664e1 * t625 * t426 - 0.2585664e1 * t337 * t751 - 0.1292832e1 * t337 * t754 + 0.1292832e1 * t757 * t134 + 0.646416e0 * t421 * t288 + 0.646416e0 * t622 * t193 + 0.1292832e1 * t334 * t383 + 0.646416e0 * t168 * t688;
  t770 = my_piecewise3(t72, 0.8943202594109954023e-1 * t37 * t292 - 0.49944883154857653068e-2 * t362 * t667 * t74 + 0.20739383252670965681e-5 * t267 * t57 * t74, -0.14798483897735600909e-2 * t702 * t329 - 0.48781105058781567398e-1 * t319 * t137 + 0.11098862923301700682e-2 * t605 * t416 + 0.8943202594109954023e-1 * t161 * t292 - 0.49944883154857653068e-2 * t327 * t711 - 0.487811050587815674e-1 * t715 * t163 + t730 * t71 + t732 * t76 + 0.91464571985215438873e-2 * t599 * t196 + 0.89432025941099540233e-1 * t408 * t323 + t768);
  t771 = my_piecewise3(t34, 0.3878496e1 * t655 * t243 - 0.2585664e1 * t658 * t134 - 0.1292832e1 * t355 * t288 + 0.646416e0 * t112 * t688, t770);
  t776 = my_piecewise3(t2, 0, t6 * t234 * t225 / 0.12e2 - t6 * t107 * t433 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t771);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t776 + 0.4e1 * t438;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t782 = t514 * t441;
  t787 = t242 * t460;
  t792 = t262 * t369;
  t793 = sigma[0] * t50;
  t801 = t276 * t38;
  t802 = t378 * t284;
  t806 = t557 * rho[0];
  t807 = 0.1e1 / t806;
  t811 = 0.35577104681874188845e-2 * t56 * t127 - 0.22235690426171368028e-2 * t792 * t793 + 0.18529742021809473357e-4 * t367 * t378 * t546 - 0.29398034574673402963e-3 * t56 * t131 + 0.24306874786510110244e-6 * t801 * t802 * t57 - 0.67778343112251663721e-14 * t277 * t807 * t562;
  t815 = t126 * t74;
  t832 = 0.63375e-1 * t25 * t468 * t141 - 0.52876992713345024472e-1 * t199 * t146 + 0.55555555555555555557e-1 * t56 * t126 - 0.81380208333333333333e-2 * t86 * t476 * t154;
  t835 = t480 * t20 * t36;
  t848 = t95 * t369;
  t851 = -t832;
  t853 = t486 * t112;
  t864 = t441 * t134;
  t867 = t193 * t383;
  t872 = t460 * t134;
  t877 = t832 * t76 - 0.243905525293907837e-1 * t835 * t163 + 0.18292914397043087775e-1 * t715 * t196 - 0.487811050587815674e-1 * t408 * t137 + 0.11098862923301700682e-2 * t702 * t416 - 0.20810367981190688778e-3 * t605 * t464 + 0.11098862923301700682e-2 * t327 * t815 - 0.77772687197516121301e-6 * t848 * t415 + t851 * t71 + 0.646416e0 * t853 * t134 + 0.1292832e1 * t757 * t193 - 0.2585664e1 * t746 * t426 + 0.1292832e1 * t421 * t383 - 0.1292832e1 * t625 * t441 + 0.3878496e1 * t630 * t864 - 0.2585664e1 * t337 * t867 + 0.646416e0 * t334 * t460 - 0.1292832e1 * t337 * t872 + 0.646416e0 * t168 * t811;
  t878 = my_piecewise3(t72, 0.11098862923301700682e-2 * t56 * t815 - 0.77772687197516121301e-6 * t369 * sigma[0] * t74, t877);
  t879 = my_piecewise3(t34, 0.3878496e1 * t782 * t134 - 0.2585664e1 * t355 * t383 - 0.1292832e1 * t787 * t134 + 0.646416e0 * t112 * t811, t878);
  t884 = my_piecewise3(t2, 0, -t6 * t107 * t496 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t879);
  tv3rhosigma20 = 0.2e1 * rho[0] * t884 + 0.2e1 * t500;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t887 = t441 * t193;
  t902 = 0.1e1 / t557;
  t906 = 0.50030303458885578063e-3 * t262 * t447 * t50 - 0.69486532581785525088e-5 * t446 * t455 * t546 - 0.54690468269647748049e-7 * t801 * t455 * t284 * sigma[0] + 0.25416878667094373895e-14 * t263 * t902 * t562;
  t912 = 0.1e1 / t87;
  t913 = t912 * t27;
  t919 = t199 * t38;
  t923 = 0.71296875e-1 * t25 * t913 * t30 - 0.6609624089168128059e-2 * t467 * t80 + 0.6103515625e-3 * t86 * t919 * t91;
  t932 = -t923;
  t942 = t193 * t460;
  t947 = t923 * t76 + 0.27439371595564631662e-1 * t835 * t196 - 0.62431103943572066335e-3 * t702 * t464 + 0.29164757699068545486e-6 * t95 * t447 * t74 + t932 * t71 + 0.1939248e1 * t853 * t193 - 0.3878496e1 * t746 * t441 + 0.1939248e1 * t421 * t460 + 0.3878496e1 * t630 * t887 - 0.3878496e1 * t337 * t942 + 0.646416e0 * t168 * t906;
  t948 = my_piecewise3(t72, 0.29164757699068545486e-6 * t447 * t74, t947);
  t949 = my_piecewise3(t34, 0.3878496e1 * t514 * t887 - 0.3878496e1 * t355 * t460 + 0.646416e0 * t112 * t906, t948);
  t953 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t949);
  tv3sigma30 = 0.2e1 * rho[0] * t953;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t970 = 0.1e1 / t513 / t68;
  t971 = t243 * t243;
  t977 = t288 * t288;
  t983 = t37 * t39 * t91;
  t985 = t38 * t91;
  t990 = 0.1e1 / t18 / t368;
  t991 = t27 * t990;
  t995 = 0.1e1 / t279;
  t999 = t265 * t89;
  t1001 = 0.1e1 / t41 / t999;
  t1010 = t56 * t27 * t50;
  t1025 = t277 * t277;
  t1030 = t283 * t283;
  t1031 = 0.1e1 / t1030;
  t1035 = 0.2618e5 / 0.19683e5 * t983 + 0.10348984450794069599e1 * t47 * t985 * t50 - 0.60224132203150363004e0 * t123 * t991 * t50 + 0.33771896036905017039e0 * t264 * t995 * t50 - 0.43043904429921858107e-2 * t540 * t1001 * t546 + 0.29281567639402624562e-4 * t262 * t682 / t18 / t806 * t1010 + 0.56890640982469826106e-1 * t123 * t991 * t130 - 0.39683223725532061467e-4 * t278 * t38 * t1001 * t284 + 0.1831521449433289402e-11 * t556 / t557 / t59 * t562 - 0.2125386745843254731e-16 * t1025 / t18 / t557 / t368 * t1031 * t362;
  t1050 = t36 * t38;
  t1051 = t1050 * t74;
  t1061 = t332 * t242;
  t1064 = t166 * t514;
  t1069 = t97 * t970;
  t1092 = -0.8543888888888888889e1 * t25 * t28 * t62 + 0.50420740740740740741e2 * t983 - 0.14805557959736606852e2 * t79 * t447 + 0.1075102880658436214e2 * t56 * t58 * t990 - 0.13938721707818930041e1 * t86 * t88 * t455;
  t1096 = -0.2212200880284903006e-4 * t158 * t263 * t617 + 0.12167104841566966533e-3 * t616 * t995 * t74 - 0.7756992e1 * t1061 * t243 + 0.15513984e2 * t1064 * t515 - 0.15513984e2 * t625 * t633 - 0.15513984e2 * t1069 * t971 + 0.23270976e2 * t630 * t243 * t288 - 0.3878496e1 * t337 * t977 - 0.5171328e1 * t337 * t134 * t565 + t1092 * t71 - t1092 * t76;
  t1099 = t38 * t74;
  t1100 = t37 * t1099;
  t1104 = t596 * t20 * t36;
  t1108 = t316 * t21 * t55;
  t1131 = t620 * t112;
  t1134 = -0.16777612492585030876e-6 * t95 * t277 * t1001 * t1100 - 0.975622101175631348e-1 * t1104 * t163 - 0.88790903386413605456e-2 * t1108 * t329 + 0.65113329150036644001e-1 * t605 * t613 - 0.16097461928759059212e0 * t327 * t58 * t990 * t74 + 0.2364980241553521175e1 * t161 * t39 * t91 * t74 + 0.5365921556465972414e0 * t599 * t323 - 0.16693978175671914177e1 * t319 * t609 + 0.646416e0 * t168 * t1035 + 0.3878496e1 * t622 * t288 + 0.2585664e1 * t334 * t565 + 0.2585664e1 * t1131 * t134;
  t1136 = my_piecewise3(t72, 0.2364980241553521175e1 * t47 * t985 * t74 - 0.16097461928759059212e0 * t123 * t991 * t74 + 0.12167104841566966533e-3 * t263 * t995 * t74 - 0.16777612492585030876e-6 * t277 * t1001 * t20 * t1051, t1096 + t1134);
  t1137 = my_piecewise3(t34, -0.15513984e2 * t970 * t971 + 0.23270976e2 * t514 * t243 * t288 - 0.3878496e1 * t242 * t977 - 0.5171328e1 * t518 * t565 + 0.646416e0 * t112 * t1035, t1136);
  t1142 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t115 * t101 - 0.5e1 / 0.9e1 * t6 * t503 * t173 + t6 * t234 * t344 / 0.2e1 - t6 * t107 * t640 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1137);
  tv4rho40 = 0.2e1 * rho[0] * t1142 + 0.8e1 * t645;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1170 = t37 * t526;
  t1174 = t531 * sigma[0];
  t1205 = -0.154e4 / 0.6561e4 * t1170 - 0.1826291373669541694e0 * t37 * t527 + 0.1500167914085694963e0 * t362 * t1174 * t50 - 0.10129592305255845435e0 * t262 * t536 * t672 + 0.14659084799475938922e-2 * t262 * t543 * t263 * t546 - 0.10980587864775984211e-4 * t540 / t18 / t557 * t1010 - 0.13653753835792758265e-1 * t185 * t549 + 0.12110225171412370482e-4 * t375 * t553 - 0.63259786904768219474e-12 * t682 * t559 * t562 + 0.79702002969122052411e-17 * t277 * t263 / t18 / t557 / t265 * t1031 * t362;
  t1241 = t732 * t20 * t36;
  t1245 = t405 * t21 * t55;
  t1272 = -0.41734945439179785441e0 * t161 * t569 + 0.91464571985215438873e-2 * t1104 * t196 - 0.73171657588172351097e-1 * t599 * t137 + 0.26829607782329862069e0 * t319 * t292 + 0.11635488e2 * t630 * t426 * t288 - 0.1498346494645729592e-1 * t605 * t711 + 0.16648294384952551023e-2 * t1108 * t416 + 0.42052358409398665917e-1 * t327 * t532 * t415 - 0.731716575881723511e-1 * t1241 * t163 - 0.44395451693206802728e-2 * t1245 * t329 + 0.2682960778232986207e0 * t715 * t323 - 0.41734945439179785442e0 * t408 * t609 + 0.16278332287509161e-1 * t702 * t613 + 0.62916046847193865785e-7 * t95 * t543 * t263 * t1100 - 0.3878496e1 * t625 * t754 - 0.3878496e1 * t337 * t688 * t134 - 0.3878496e1 * t337 * t383 * t288 - 0.1292832e1 * t337 * t193 * t565 - 0.55305022007122575148e-5 * t215 * t263 * t617;
  t1305 = -0.98583333333333333333e0 * t25 * t200 * t580 + 0.88977777777777777779e1 * t1170 - 0.31726195628007014682e1 * t26 * t585 + 0.25802469135802469136e1 * t56 * t207 * t531 - 0.3604841820987654321e0 * t86 * t211 * t592;
  t1321 = t419 * t242;
  t1324 = t730 * t112;
  t1327 = t219 * t514;
  t1330 = 0.62218149758012897043e-5 * t158 * t267 * t743 - 0.39404828180074834793e-4 * t95 * t536 * t743 + 0.11635488e2 * t1064 * t739 + 0.11635488e2 * t630 * t383 * t243 - 0.15513984e2 * t1069 * t193 * t515 - 0.3878496e1 * t746 * t633 - 0.3878496e1 * t1061 * t426 - 0.7756992e1 * t625 * t751 + t1305 * t76 - t1305 * t71 + 0.646416e0 * t1131 * t193 + 0.1939248e1 * t622 * t383 + 0.1939248e1 * t334 * t688 + 0.646416e0 * t168 * t1205 + 0.1939248e1 * t757 * t288 + 0.646416e0 * t421 * t565 - 0.3878496e1 * t1321 * t243 + 0.1939248e1 * t1324 * t134 + 0.3878496e1 * t1327 * t515;
  t1332 = my_piecewise3(t72, -0.41734945439179785441e0 * t37 * t569 + 0.42052358409398665917e-1 * t362 * t1174 * t74 - 0.39404828180074834793e-4 * t536 * t57 * t74 + 0.62916046847193865785e-7 * t543 * t263 * t20 * t1051, t1272 + t1330);
  t1333 = my_piecewise3(t34, -0.15513984e2 * t970 * t193 * t515 + 0.11635488e2 * t514 * t383 * t243 + 0.11635488e2 * t655 * t633 - 0.3878496e1 * t242 * t688 * t134 - 0.3878496e1 * t658 * t288 - 0.1292832e1 * t355 * t565 + 0.646416e0 * t112 * t1205, t1332);
  t1338 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t503 * t225 + t6 * t234 * t433 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t107 * t771 - 0.3e1 / 0.8e1 * t6 * t19 * t1333);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1338 + 0.6e1 * t776;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1355 = t383 * t383;
  t1398 = -0.22532166298520319602e-1 * t56 * t258 + 0.24755735341137456404e-1 * t671 * t793 - 0.46324355054523683393e-3 * t262 * t281 * t57 * t546 + 0.41177204492909940793e-5 * t264 / t18 / t265 / t152 * t1010 + 0.18618755230626488543e-2 * t56 * t271 - 0.30950753894822873711e-5 * t801 * t281 * t284 * t57 + 0.20559430744049671329e-12 * t684 * t562 * t277 - 0.29888251113420769653e-17 * t556 / t18 / t557 / t152 * t1031 * t362;
  t1437 = t851 * t112;
  t1444 = t486 * t242;
  t1459 = t832 * t20 * t36;
  t1462 = 0.1292832e1 * t421 * t688 - 0.1292832e1 * t1061 * t441 + 0.1292832e1 * t1437 * t134 + 0.646416e0 * t853 * t288 - 0.2585664e1 * t337 * t1355 - 0.1292832e1 * t1444 * t243 + 0.646416e0 * t622 * t460 + 0.15513984e2 * t630 * t426 * t383 + 0.89432025941099540233e-1 * t835 * t323 - 0.23593517567697699669e-7 * t95 * t281 * t57 * t1100 - 0.487811050587815674e-1 * t1459 * t163;
  t1465 = t480 * t21 * t55;
  t1523 = 0.147875e0 * t25 * t468 * t300 - 0.26438496356672512236e0 * t199 * t305 + 0.35185185185185185186e0 * t56 * t257 - 0.62391493055555555555e-1 * t86 * t476 * t312;
  t1527 = 0.11147418498310644053e-4 * t742 * t415 - 0.5171328e1 * t1321 * t426 - 0.5171328e1 * t746 * t751 - 0.2585664e1 * t746 * t754 + 0.7756992e1 * t1064 * t864 + 0.3878496e1 * t630 * t460 * t243 - 0.15513984e2 * t1069 * t441 * t243 + 0.7756992e1 * t1327 * t739 + 0.3878496e1 * t630 * t441 * t288 + t1523 * t71 - t1523 * t76;
  t1530 = my_piecewise3(t72, -0.70292798514244104319e-2 * t56 * t295 + 0.11147418498310644053e-4 * t267 * sigma[0] * t74 - 0.23593517567697699669e-7 * t281 * t57 * t20 * t1051, -0.975622101175631348e-1 * t715 * t137 + 0.17886405188219908047e0 * t408 * t292 + 0.18292914397043087775e-1 * t1241 * t196 - 0.20810367981190688778e-3 * t1108 * t464 + 0.22197725846603401364e-2 * t605 * t815 - 0.70292798514244104319e-2 * t327 * t295 + 0.1292832e1 * t334 * t811 + 0.646416e0 * t168 * t1398 + 0.1292832e1 * t1324 * t193 + 0.2585664e1 * t757 * t383 + t1462 - 0.14798483897735600909e-2 * t1465 * t329 + 0.22197725846603401364e-2 * t1245 * t416 - 0.99889766309715306138e-2 * t702 * t711 - 0.5171328e1 * t625 * t867 + 0.41478766505341931362e-5 * t215 * t267 * t743 - 0.1555453743950322426e-5 * t158 * t369 * t415 - 0.2585664e1 * t337 * t193 * t688 - 0.2585664e1 * t625 * t872 - 0.2585664e1 * t337 * t811 * t134 - 0.1292832e1 * t337 * t460 * t288 + t1527);
  t1531 = my_piecewise3(t34, -0.15513984e2 * t970 * t441 * t243 + 0.15513984e2 * t655 * t751 + 0.3878496e1 * t782 * t288 - 0.2585664e1 * t242 * t1355 - 0.2585664e1 * t355 * t688 + 0.3878496e1 * t514 * t460 * t243 - 0.2585664e1 * t242 * t811 * t134 - 0.1292832e1 * t787 * t288 + 0.646416e0 * t112 * t1398, t1530);
  t1536 = my_piecewise3(t2, 0, t6 * t234 * t496 / 0.12e2 - t6 * t107 * t879 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1531);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1536 + 0.4e1 * t884;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1560 = t36 * sigma[0];
  t1582 = -0.4002424276710846245e-2 * t792 * t50 + 0.1297081941526663135e-3 * t262 * t378 * t20 * t1560 * t545 - 0.15441451684841227797e-5 * t367 / t18 / t999 * t1010 + 0.58336499487624264586e-6 * t801 * t802 * sigma[0] - 0.61000508801026497348e-13 * t807 * t562 * t263 + 0.1120809416753278862e-17 * t682 / t18 / t557 / t89 * t1031 * t362;
  t1608 = t932 * t112;
  t1629 = 0.11635488e2 * t630 * t942 * t134 + 0.33296588769905102045e-2 * t702 * t815 + 0.27439371595564631662e-1 * t1459 * t196 - 0.62431103943572066335e-3 * t1245 * t464 - 0.73171657588172351099e-1 * t835 * t137 + 0.29164757699068545486e-6 * t158 * t447 * t74 + 0.646416e0 * t1608 * t134 + 0.1939248e1 * t1437 * t193 + 0.1939248e1 * t853 * t383 - 0.3878496e1 * t1321 * t441 - 0.23331806159254836389e-5 * t848 * t74 + 0.646416e0 * t334 * t906 + 0.646416e0 * t168 * t1582 + 0.1939248e1 * t757 * t460 + 0.1939248e1 * t421 * t811 + 0.3878496e1 * t1064 * t887;
  t1638 = t923 * t20 * t36;
  t1677 = 0.950625e-1 * t25 * t913 * t141 - 0.26438496356672512236e-1 * t467 * t146 + 0.40690104166666666667e-2 * t86 * t919 * t154;
  t1681 = 0.16648294384952551023e-2 * t1465 * t416 + 0.88475690878866373752e-8 * t95 * t378 * t20 * t1560 * t1099 - 0.243905525293907837e-1 * t1638 * t163 - 0.3878496e1 * t746 * t872 + 0.11635488e2 * t630 * t441 * t383 - 0.3878496e1 * t625 * t942 - 0.3878496e1 * t337 * t383 * t460 - 0.3878496e1 * t337 * t193 * t811 - 0.1292832e1 * t337 * t906 * t134 - 0.23331806159254836391e-5 * t215 * t369 * t415 - 0.3878496e1 * t1444 * t426 + 0.11635488e2 * t1327 * t864 - 0.7756992e1 * t746 * t867 - 0.15513984e2 * t1069 * t887 * t134 + t1677 * t71 - t1677 * t76;
  t1683 = my_piecewise3(t72, -0.23331806159254836389e-5 * t369 * t74 + 0.88475690878866373752e-8 * t378 * t20 * t36 * t39 * t74, t1629 + t1681);
  t1684 = my_piecewise3(t34, -0.15513984e2 * t970 * t887 * t134 + 0.11635488e2 * t782 * t383 + 0.11635488e2 * t655 * t872 - 0.3878496e1 * t658 * t460 - 0.3878496e1 * t355 * t811 - 0.1292832e1 * t242 * t906 * t134 + 0.646416e0 * t112 * t1582, t1683);
  t1689 = my_piecewise3(t2, 0, -t6 * t107 * t949 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1684);
  tv4rhosigma30 = 0.2e1 * rho[0] * t1689 + 0.2e1 * t953;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1692 = t441 * t441;
  t1697 = t460 * t460;
  t1724 = -0.27794613032714210035e-4 * t262 * t455 * t20 * t1050 * t50 + 0.5790544381815460424e-6 * t446 / t18 / t541 * t1010 + 0.15250127200256624337e-13 * t902 * t562 * t57 - 0.54690468269647748049e-7 * t276 * t457 - 0.42030353128247957323e-18 * t277 / t18 / t557 / t60 * t1031 * t362;
  t1751 = 0.1782421875e0 * t25 / t26 / t263 * t27 * t30 - 0.99144361337521920885e-2 * t912 * t80 + 0.30517578125e-3 * t86 * t467 * t38 * t91;
  t1782 = 0.36585828794086175549e-1 * t1638 * t196 - 0.12486220788714413267e-2 * t1465 * t464 - 0.33178384079574890157e-8 * t95 * t455 * t20 * t1051 + t1751 * t71 - t1751 * t76 + 0.3878496e1 * t853 * t460 + 0.2585664e1 * t421 * t906 + 0.646416e0 * t168 * t1724 + 0.11665903079627418195e-5 * t215 * t447 * t74 + 0.2585664e1 * t1608 * t193 - 0.7756992e1 * t1444 * t441 + 0.15513984e2 * t1327 * t887 - 0.15513984e2 * t746 * t942 - 0.15513984e2 * t1069 * t1692 + 0.23270976e2 * t630 * t441 * t460 - 0.3878496e1 * t337 * t1697 - 0.5171328e1 * t337 * t193 * t906;
  t1783 = my_piecewise3(t72, -0.33178384079574890157e-8 * t455 * t20 * t1051, t1782);
  t1784 = my_piecewise3(t34, -0.15513984e2 * t970 * t1692 + 0.23270976e2 * t782 * t460 - 0.3878496e1 * t242 * t1697 - 0.5171328e1 * t355 * t906 + 0.646416e0 * t112 * t1724, t1783);
  t1788 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1784);
  tv4sigma40 = 0.2e1 * rho[0] * t1788;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t33, t34, t35, t37, t39, t40, t41;
  double t42, t43, t44, t45, t46, t48, t49, t50;
  double t53, t58, t59, t60, t61, t62, t64, t66;
  double t68, t69, t70, t73, t74, t76, t78, t79;
  double t80, t81, t82, t84, t85, t88, t89, t90;
  double t92, t95, t96, t98, t101, t102, t106, t107;
  double t108, t109, t110, t111, t113, t114, t115, t116;
  double t118, t120, t121, t122, t123, t124, t126, t127;
  double t128, t131, t135, t136, t137, t139, t141, t143;
  double t144, t145, t148, t149, t151, t153, t154, t155;
  double t156, t157, t159, t160, t161, t162, t164, t167;
  double t168, t170, t173, t174, t178, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t33 = t29 / t31;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = t39 / 0.12e2;
  t41 = t40 < 0.6e0;
  t42 = t31 * t31;
  t43 = 0.1e1 / t42;
  t44 = t28 * t43;
  t45 = rho[0] * rho[0];
  t46 = t35 * t35;
  t48 = 0.1e1 / t46 / t45;
  t49 = sigma[0] * t48;
  t50 = t44 * t49;
  t53 = exp(-t50 / 0.24e2);
  t58 = 0.1e1 / t31 / t30;
  t59 = t29 * t58;
  t60 = sigma[0] * sigma[0];
  t61 = t45 * t45;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t35 / t62;
  t66 = t59 * t60 * t64;
  t68 = 0.1e1 + 0.13780328706878157639e-4 * t66;
  t69 = log(t68);
  t70 = 0.804e0 + 0.5e1 / 0.972e3 * t50 + 0.4002424276710846245e-2 * t44 * t49 * t53 + t69;
  t73 = 0.1804e1 - 0.646416e0 / t70;
  t74 = 0.26e1 < t40;
  t76 = exp(-0.1137619054542480583e-1 * t50);
  t78 = 0.1804e1 - 0.804e0 * t76;
  t79 = 0.190125e0 * t39;
  t80 = 0.195e0 * t50;
  t81 = t34 * sigma[0];
  t82 = 0.1e1 / t61;
  t84 = 0.88128321188908374119e-2 * t81 * t82;
  t85 = 0.26041666666666666667e-2 * t66;
  t88 = t28 / t42 / t30;
  t89 = t34 * t60;
  t90 = t61 * t45;
  t92 = 0.1e1 / t46 / t90;
  t95 = 0.16276041666666666667e-3 * t88 * t89 * t92;
  t96 = -0.40608e0 + t79 - t80 + t84 - t85 + t95;
  t98 = 0.140608e1 - t79 + t80 - t84 + t85 - t95;
  t101 = my_piecewise3(t74, t78, t98 * t73 + t96 * t78);
  t102 = my_piecewise3(t41, t73, t101);
  t106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t102);
  t107 = rho[1] <= p->dens_threshold;
  t108 = my_piecewise5(t14, t11, t10, t15, -t17);
  t109 = 0.1e1 + t108;
  t110 = t109 <= p->zeta_threshold;
  t111 = POW_1_3(t109);
  t113 = my_piecewise3(t110, t22, t111 * t109);
  t114 = t113 * t26;
  t115 = sqrt(sigma[2]);
  t116 = POW_1_3(rho[1]);
  t118 = 0.1e1 / t116 / rho[1];
  t120 = t33 * t115 * t118;
  t121 = t120 / 0.12e2;
  t122 = t121 < 0.6e0;
  t123 = rho[1] * rho[1];
  t124 = t116 * t116;
  t126 = 0.1e1 / t124 / t123;
  t127 = sigma[2] * t126;
  t128 = t44 * t127;
  t131 = exp(-t128 / 0.24e2);
  t135 = sigma[2] * sigma[2];
  t136 = t123 * t123;
  t137 = t136 * rho[1];
  t139 = 0.1e1 / t116 / t137;
  t141 = t59 * t135 * t139;
  t143 = 0.1e1 + 0.13780328706878157639e-4 * t141;
  t144 = log(t143);
  t145 = 0.804e0 + 0.5e1 / 0.972e3 * t128 + 0.4002424276710846245e-2 * t44 * t127 * t131 + t144;
  t148 = 0.1804e1 - 0.646416e0 / t145;
  t149 = 0.26e1 < t121;
  t151 = exp(-0.1137619054542480583e-1 * t128);
  t153 = 0.1804e1 - 0.804e0 * t151;
  t154 = 0.190125e0 * t120;
  t155 = 0.195e0 * t128;
  t156 = t115 * sigma[2];
  t157 = 0.1e1 / t136;
  t159 = 0.88128321188908374119e-2 * t156 * t157;
  t160 = 0.26041666666666666667e-2 * t141;
  t161 = t115 * t135;
  t162 = t136 * t123;
  t164 = 0.1e1 / t124 / t162;
  t167 = 0.16276041666666666667e-3 * t88 * t161 * t164;
  t168 = -0.40608e0 + t154 - t155 + t159 - t160 + t167;
  t170 = 0.140608e1 - t154 + t155 - t159 + t160 - t167;
  t173 = my_piecewise3(t149, t153, t170 * t148 + t168 * t153);
  t174 = my_piecewise3(t122, t148, t173);
  t178 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t174);
  tzk0 = t106 + t178;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t33, t34, t35, t37, t39, t40, t41;
  double t42, t43, t44, t45, t46, t48, t49, t50;
  double t53, t58, t59, t60, t61, t62, t64, t66;
  double t68, t69, t70, t73, t74, t76, t78, t79;
  double t80, t81, t82, t84, t85, t88, t89, t90;
  double t92, t95, t96, t98, t101, t102, t106, t107;
  double t108, t109, t110, t111, t113, t114, t115, t116;
  double t118, t120, t121, t122, t123, t124, t126, t127;
  double t128, t131, t135, t136, t137, t139, t141, t143;
  double t144, t145, t148, t149, t151, t153, t154, t155;
  double t156, t157, t159, t160, t161, t162, t164, t167;
  double t168, t170, t173, t174, t178, tzk0;

  double t179, t180, t181, t182, t183, t186, t187, t191;
  double t192, t193, t196, t197, t198, t199, t201, t202;
  double t203, t209, t210, t214, t218, t221, t225, t230;
  double t235, t237, t241, t243, t244, t247, t249, t253;
  double t254, t259, t261, t264, t265, t269, t272, t274;
  double tvrho0, t277, t278, t281, t282, t287, t289, t292;
  double t293, t297, t298, t299, t301, t302, t303, t309;
  double t310, t314, t318, t321, t325, t330, t335, t337;
  double t341, t343, t344, t347, t349, t353, t354, t359;
  double tvrho1, t362, t367, t374, t380, t392, t395, t398;
  double t403, t404, t408, tvsigma0, tvsigma1, t409, t414, t421;
  double t427, t439, t442, t445, t450, t451, t455, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t33 = t29 / t31;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = t39 / 0.12e2;
  t41 = t40 < 0.6e0;
  t42 = t31 * t31;
  t43 = 0.1e1 / t42;
  t44 = t28 * t43;
  t45 = rho[0] * rho[0];
  t46 = t35 * t35;
  t48 = 0.1e1 / t46 / t45;
  t49 = sigma[0] * t48;
  t50 = t44 * t49;
  t53 = exp(-t50 / 0.24e2);
  t58 = 0.1e1 / t31 / t30;
  t59 = t29 * t58;
  t60 = sigma[0] * sigma[0];
  t61 = t45 * t45;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t35 / t62;
  t66 = t59 * t60 * t64;
  t68 = 0.1e1 + 0.13780328706878157639e-4 * t66;
  t69 = log(t68);
  t70 = 0.804e0 + 0.5e1 / 0.972e3 * t50 + 0.4002424276710846245e-2 * t44 * t49 * t53 + t69;
  t73 = 0.1804e1 - 0.646416e0 / t70;
  t74 = 0.26e1 < t40;
  t76 = exp(-0.1137619054542480583e-1 * t50);
  t78 = 0.1804e1 - 0.804e0 * t76;
  t79 = 0.190125e0 * t39;
  t80 = 0.195e0 * t50;
  t81 = t34 * sigma[0];
  t82 = 0.1e1 / t61;
  t84 = 0.88128321188908374119e-2 * t81 * t82;
  t85 = 0.26041666666666666667e-2 * t66;
  t88 = t28 / t42 / t30;
  t89 = t34 * t60;
  t90 = t61 * t45;
  t92 = 0.1e1 / t46 / t90;
  t95 = 0.16276041666666666667e-3 * t88 * t89 * t92;
  t96 = -0.40608e0 + t79 - t80 + t84 - t85 + t95;
  t98 = 0.140608e1 - t79 + t80 - t84 + t85 - t95;
  t101 = my_piecewise3(t74, t78, t98 * t73 + t96 * t78);
  t102 = my_piecewise3(t41, t73, t101);
  t106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t102);
  t107 = rho[1] <= p->dens_threshold;
  t108 = my_piecewise5(t14, t11, t10, t15, -t17);
  t109 = 0.1e1 + t108;
  t110 = t109 <= p->zeta_threshold;
  t111 = POW_1_3(t109);
  t113 = my_piecewise3(t110, t22, t111 * t109);
  t114 = t113 * t26;
  t115 = sqrt(sigma[2]);
  t116 = POW_1_3(rho[1]);
  t118 = 0.1e1 / t116 / rho[1];
  t120 = t33 * t115 * t118;
  t121 = t120 / 0.12e2;
  t122 = t121 < 0.6e0;
  t123 = rho[1] * rho[1];
  t124 = t116 * t116;
  t126 = 0.1e1 / t124 / t123;
  t127 = sigma[2] * t126;
  t128 = t44 * t127;
  t131 = exp(-t128 / 0.24e2);
  t135 = sigma[2] * sigma[2];
  t136 = t123 * t123;
  t137 = t136 * rho[1];
  t139 = 0.1e1 / t116 / t137;
  t141 = t59 * t135 * t139;
  t143 = 0.1e1 + 0.13780328706878157639e-4 * t141;
  t144 = log(t143);
  t145 = 0.804e0 + 0.5e1 / 0.972e3 * t128 + 0.4002424276710846245e-2 * t44 * t127 * t131 + t144;
  t148 = 0.1804e1 - 0.646416e0 / t145;
  t149 = 0.26e1 < t121;
  t151 = exp(-0.1137619054542480583e-1 * t128);
  t153 = 0.1804e1 - 0.804e0 * t151;
  t154 = 0.190125e0 * t120;
  t155 = 0.195e0 * t128;
  t156 = t115 * sigma[2];
  t157 = 0.1e1 / t136;
  t159 = 0.88128321188908374119e-2 * t156 * t157;
  t160 = 0.26041666666666666667e-2 * t141;
  t161 = t115 * t135;
  t162 = t136 * t123;
  t164 = 0.1e1 / t124 / t162;
  t167 = 0.16276041666666666667e-3 * t88 * t161 * t164;
  t168 = -0.40608e0 + t154 - t155 + t159 - t160 + t167;
  t170 = 0.140608e1 - t154 + t155 - t159 + t160 - t167;
  t173 = my_piecewise3(t149, t153, t170 * t148 + t168 * t153);
  t174 = my_piecewise3(t122, t148, t173);
  t178 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t174);
  tzk0 = t106 + t178;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t179 = t6 * t6;
  t180 = 0.1e1 / t179;
  t181 = t16 * t180;
  t182 = t7 - t181;
  t183 = my_piecewise5(t10, 0, t14, 0, t182);
  t186 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t183);
  t187 = t186 * t26;
  t191 = t26 * t26;
  t192 = 0.1e1 / t191;
  t193 = t25 * t192;
  t196 = t5 * t193 * t102 / 0.8e1;
  t197 = t70 * t70;
  t198 = 0.1e1 / t197;
  t199 = t45 * rho[0];
  t201 = 0.1e1 / t46 / t199;
  t202 = sigma[0] * t201;
  t203 = t44 * t202;
  t209 = 0.1e1 / t35 / t90;
  t210 = t60 * t209;
  t214 = 0.1e1 / t68;
  t218 = -0.1e2 / 0.729e3 * t203 - 0.10673131404562256653e-1 * t44 * t202 * t53 + 0.44471380852342736056e-3 * t59 * t210 * t53 - 0.73495086436683507408e-4 * t59 * t210 * t214;
  t221 = t202 * t76;
  t225 = 0.1e1 / t35 / t45;
  t230 = 0.1e1 / t62;
  t235 = t61 * t199;
  t237 = 0.1e1 / t46 / t235;
  t241 = -0.2535e0 * t33 * t34 * t225 + 0.52e0 * t203 - 0.35251328475563349648e-1 * t81 * t230 + 0.13888888888888888889e-1 * t59 * t210 - 0.10850694444444444445e-2 * t88 * t89 * t237;
  t243 = t96 * t28;
  t244 = t243 * t43;
  t247 = -t241;
  t249 = t98 * t198;
  t253 = my_piecewise3(t74, -0.243905525293907837e-1 * t44 * t221, t241 * t78 - 0.243905525293907837e-1 * t244 * t221 + t247 * t73 + 0.646416e0 * t249 * t218);
  t254 = my_piecewise3(t41, 0.646416e0 * t198 * t218, t253);
  t259 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t187 * t102 - t196 - 0.3e1 / 0.8e1 * t5 * t27 * t254);
  t261 = my_piecewise5(t14, 0, t10, 0, -t182);
  t264 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t261);
  t265 = t264 * t26;
  t269 = t113 * t192;
  t272 = t5 * t269 * t174 / 0.8e1;
  t274 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t265 * t174 - t272);
  tvrho0 = t106 + t178 + t6 * (t259 + t274);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t277 = -t7 - t181;
  t278 = my_piecewise5(t10, 0, t14, 0, t277);
  t281 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t278);
  t282 = t281 * t26;
  t287 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t102 - t196);
  t289 = my_piecewise5(t14, 0, t10, 0, -t277);
  t292 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t289);
  t293 = t292 * t26;
  t297 = t145 * t145;
  t298 = 0.1e1 / t297;
  t299 = t123 * rho[1];
  t301 = 0.1e1 / t124 / t299;
  t302 = sigma[2] * t301;
  t303 = t44 * t302;
  t309 = 0.1e1 / t116 / t162;
  t310 = t135 * t309;
  t314 = 0.1e1 / t143;
  t318 = -0.1e2 / 0.729e3 * t303 - 0.10673131404562256653e-1 * t44 * t302 * t131 + 0.44471380852342736056e-3 * t59 * t310 * t131 - 0.73495086436683507408e-4 * t59 * t310 * t314;
  t321 = t302 * t151;
  t325 = 0.1e1 / t116 / t123;
  t330 = 0.1e1 / t137;
  t335 = t136 * t299;
  t337 = 0.1e1 / t124 / t335;
  t341 = -0.2535e0 * t33 * t115 * t325 + 0.52e0 * t303 - 0.35251328475563349648e-1 * t156 * t330 + 0.13888888888888888889e-1 * t59 * t310 - 0.10850694444444444445e-2 * t88 * t161 * t337;
  t343 = t168 * t28;
  t344 = t343 * t43;
  t347 = -t341;
  t349 = t170 * t298;
  t353 = my_piecewise3(t149, -0.243905525293907837e-1 * t44 * t321, t341 * t153 - 0.243905525293907837e-1 * t344 * t321 + t347 * t148 + 0.646416e0 * t349 * t318);
  t354 = my_piecewise3(t122, 0.646416e0 * t298 * t318, t353);
  t359 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t293 * t174 - t272 - 0.3e1 / 0.8e1 * t5 * t114 * t354);
  tvrho1 = t106 + t178 + t6 * (t287 + t359);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t362 = t44 * t48;
  t367 = sigma[0] * t64;
  t374 = 0.5e1 / 0.972e3 * t362 + 0.4002424276710846245e-2 * t44 * t48 * t53 - 0.16676767819628526021e-3 * t59 * t367 * t53 + 0.27560657413756315278e-4 * t59 * t367 * t214;
  t380 = 0.1e1 / t34;
  t392 = 0.950625e-1 * t33 * t380 * t37 - 0.195e0 * t362 + 0.13219248178336256118e-1 * t34 * t82 - 0.52083333333333333334e-2 * t59 * t367 + 0.40690104166666666668e-3 * t88 * t81 * t92;
  t395 = t43 * t48 * t76;
  t398 = -t392;
  t403 = my_piecewise3(t74, 0.91464571985215438873e-2 * t44 * t48 * t76, t392 * t78 + 0.91464571985215438873e-2 * t243 * t395 + t398 * t73 + 0.646416e0 * t249 * t374);
  t404 = my_piecewise3(t41, 0.646416e0 * t198 * t374, t403);
  t408 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t404);
  tvsigma0 = t6 * t408;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t409 = t44 * t126;
  t414 = sigma[2] * t139;
  t421 = 0.5e1 / 0.972e3 * t409 + 0.4002424276710846245e-2 * t44 * t126 * t131 - 0.16676767819628526021e-3 * t59 * t414 * t131 + 0.27560657413756315278e-4 * t59 * t414 * t314;
  t427 = 0.1e1 / t115;
  t439 = 0.950625e-1 * t33 * t427 * t118 - 0.195e0 * t409 + 0.13219248178336256118e-1 * t115 * t157 - 0.52083333333333333334e-2 * t59 * t414 + 0.40690104166666666668e-3 * t88 * t156 * t164;
  t442 = t43 * t126 * t151;
  t445 = -t439;
  t450 = my_piecewise3(t149, 0.91464571985215438873e-2 * t44 * t126 * t151, t439 * t153 + 0.91464571985215438873e-2 * t343 * t442 + t445 * t148 + 0.646416e0 * t349 * t421);
  t451 = my_piecewise3(t122, 0.646416e0 * t298 * t421, t450);
  t455 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t451);
  tvsigma2 = t6 * t455;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t33, t34, t35, t37, t39, t40, t41;
  double t42, t43, t44, t45, t46, t48, t49, t50;
  double t53, t58, t59, t60, t61, t62, t64, t66;
  double t68, t69, t70, t73, t74, t76, t78, t79;
  double t80, t81, t82, t84, t85, t88, t89, t90;
  double t92, t95, t96, t98, t101, t102, t106, t107;
  double t108, t109, t110, t111, t113, t114, t115, t116;
  double t118, t120, t121, t122, t123, t124, t126, t127;
  double t128, t131, t135, t136, t137, t139, t141, t143;
  double t144, t145, t148, t149, t151, t153, t154, t155;
  double t156, t157, t159, t160, t161, t162, t164, t167;
  double t168, t170, t173, t174, t178, tzk0;

  double t179, t180, t181, t182, t183, t186, t187, t191;
  double t192, t193, t196, t197, t198, t199, t201, t202;
  double t203, t209, t210, t214, t218, t221, t225, t230;
  double t235, t237, t241, t243, t244, t247, t249, t253;
  double t254, t259, t261, t264, t265, t269, t272, t274;
  double tvrho0, t277, t278, t281, t282, t287, t289, t292;
  double t293, t297, t298, t299, t301, t302, t303, t309;
  double t310, t314, t318, t321, t325, t330, t335, t337;
  double t341, t343, t344, t347, t349, t353, t354, t359;
  double tvrho1, t362, t367, t374, t380, t392, t395, t398;
  double t403, t404, t408, tvsigma0, tvsigma1, t409, t414, t421;
  double t427, t439, t442, t445, t450, t451, t455, tvsigma2;

  double t458, t459, t460, t463, t464, t465, t467, t468;
  double t472, t473, t477, t479, t485, t486, t489, t491;
  double t494, t495, t499, t500, t501, t507, t508, t512;
  double t513, t514, t515, t516, t517, t518, t527, t528;
  double t529, t531, t533, t534, t538, t542, t545, t550;
  double t555, t561, t565, t567, t568, t573, t574, t577;
  double t579, t582, t588, t589, t594, t595, t596, t597;
  double t601, t605, t606, t610, t612, t614, t617, t619;
  double tv2rho20, t622, t625, t626, t630, t631, t635, t637;
  double t645, t646, t649, t653, t654, t658, t660, t667;
  double t670, tv2rho21, t675, t679, t680, t684, t685, t691;
  double t692, t696, t700, t701, t711, t712, t716, t717;
  double t718, t724, t725, t729, t730, t731, t732, t733;
  double t740, t741, t743, t745, t746, t750, t754, t757;
  double t762, t767, t773, t777, t779, t780, t785, t786;
  double t789, t791, t794, t800, t801, t806, tv2rho22, t814;
  double t815, t818, t823, t827, t828, t829, t836, t838;
  double t843, t850, t865, t867, t868, t874, t879, t881;
  double t886, t892, t893, t898, tv2rhosigma0, tv2rhosigma1, t905, t907;
  double tv2rhosigma2, t913, tv2rhosigma3, tv2rhosigma4, t918, t921, t926, t930;
  double t931, t932, t939, t941, t946, t953, t968, t970;
  double t971, t977, t982, t984, t989, t995, t996, t1001;
  double tv2rhosigma5, t1003, t1009, t1010, t1018, t1023, t1030, t1041;
  double t1046, t1049, t1058, t1059, t1063, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t1064, t1070, t1071, t1079, t1084, t1091;
  double t1102, t1107, t1110, t1119, t1120, t1124, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t33 = t29 / t31;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = t39 / 0.12e2;
  t41 = t40 < 0.6e0;
  t42 = t31 * t31;
  t43 = 0.1e1 / t42;
  t44 = t28 * t43;
  t45 = rho[0] * rho[0];
  t46 = t35 * t35;
  t48 = 0.1e1 / t46 / t45;
  t49 = sigma[0] * t48;
  t50 = t44 * t49;
  t53 = exp(-t50 / 0.24e2);
  t58 = 0.1e1 / t31 / t30;
  t59 = t29 * t58;
  t60 = sigma[0] * sigma[0];
  t61 = t45 * t45;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t35 / t62;
  t66 = t59 * t60 * t64;
  t68 = 0.1e1 + 0.13780328706878157639e-4 * t66;
  t69 = log(t68);
  t70 = 0.804e0 + 0.5e1 / 0.972e3 * t50 + 0.4002424276710846245e-2 * t44 * t49 * t53 + t69;
  t73 = 0.1804e1 - 0.646416e0 / t70;
  t74 = 0.26e1 < t40;
  t76 = exp(-0.1137619054542480583e-1 * t50);
  t78 = 0.1804e1 - 0.804e0 * t76;
  t79 = 0.190125e0 * t39;
  t80 = 0.195e0 * t50;
  t81 = t34 * sigma[0];
  t82 = 0.1e1 / t61;
  t84 = 0.88128321188908374119e-2 * t81 * t82;
  t85 = 0.26041666666666666667e-2 * t66;
  t88 = t28 / t42 / t30;
  t89 = t34 * t60;
  t90 = t61 * t45;
  t92 = 0.1e1 / t46 / t90;
  t95 = 0.16276041666666666667e-3 * t88 * t89 * t92;
  t96 = -0.40608e0 + t79 - t80 + t84 - t85 + t95;
  t98 = 0.140608e1 - t79 + t80 - t84 + t85 - t95;
  t101 = my_piecewise3(t74, t78, t98 * t73 + t96 * t78);
  t102 = my_piecewise3(t41, t73, t101);
  t106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t102);
  t107 = rho[1] <= p->dens_threshold;
  t108 = my_piecewise5(t14, t11, t10, t15, -t17);
  t109 = 0.1e1 + t108;
  t110 = t109 <= p->zeta_threshold;
  t111 = POW_1_3(t109);
  t113 = my_piecewise3(t110, t22, t111 * t109);
  t114 = t113 * t26;
  t115 = sqrt(sigma[2]);
  t116 = POW_1_3(rho[1]);
  t118 = 0.1e1 / t116 / rho[1];
  t120 = t33 * t115 * t118;
  t121 = t120 / 0.12e2;
  t122 = t121 < 0.6e0;
  t123 = rho[1] * rho[1];
  t124 = t116 * t116;
  t126 = 0.1e1 / t124 / t123;
  t127 = sigma[2] * t126;
  t128 = t44 * t127;
  t131 = exp(-t128 / 0.24e2);
  t135 = sigma[2] * sigma[2];
  t136 = t123 * t123;
  t137 = t136 * rho[1];
  t139 = 0.1e1 / t116 / t137;
  t141 = t59 * t135 * t139;
  t143 = 0.1e1 + 0.13780328706878157639e-4 * t141;
  t144 = log(t143);
  t145 = 0.804e0 + 0.5e1 / 0.972e3 * t128 + 0.4002424276710846245e-2 * t44 * t127 * t131 + t144;
  t148 = 0.1804e1 - 0.646416e0 / t145;
  t149 = 0.26e1 < t121;
  t151 = exp(-0.1137619054542480583e-1 * t128);
  t153 = 0.1804e1 - 0.804e0 * t151;
  t154 = 0.190125e0 * t120;
  t155 = 0.195e0 * t128;
  t156 = t115 * sigma[2];
  t157 = 0.1e1 / t136;
  t159 = 0.88128321188908374119e-2 * t156 * t157;
  t160 = 0.26041666666666666667e-2 * t141;
  t161 = t115 * t135;
  t162 = t136 * t123;
  t164 = 0.1e1 / t124 / t162;
  t167 = 0.16276041666666666667e-3 * t88 * t161 * t164;
  t168 = -0.40608e0 + t154 - t155 + t159 - t160 + t167;
  t170 = 0.140608e1 - t154 + t155 - t159 + t160 - t167;
  t173 = my_piecewise3(t149, t153, t170 * t148 + t168 * t153);
  t174 = my_piecewise3(t122, t148, t173);
  t178 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t174);
  tzk0 = t106 + t178;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t179 = t6 * t6;
  t180 = 0.1e1 / t179;
  t181 = t16 * t180;
  t182 = t7 - t181;
  t183 = my_piecewise5(t10, 0, t14, 0, t182);
  t186 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t183);
  t187 = t186 * t26;
  t191 = t26 * t26;
  t192 = 0.1e1 / t191;
  t193 = t25 * t192;
  t196 = t5 * t193 * t102 / 0.8e1;
  t197 = t70 * t70;
  t198 = 0.1e1 / t197;
  t199 = t45 * rho[0];
  t201 = 0.1e1 / t46 / t199;
  t202 = sigma[0] * t201;
  t203 = t44 * t202;
  t209 = 0.1e1 / t35 / t90;
  t210 = t60 * t209;
  t214 = 0.1e1 / t68;
  t218 = -0.1e2 / 0.729e3 * t203 - 0.10673131404562256653e-1 * t44 * t202 * t53 + 0.44471380852342736056e-3 * t59 * t210 * t53 - 0.73495086436683507408e-4 * t59 * t210 * t214;
  t221 = t202 * t76;
  t225 = 0.1e1 / t35 / t45;
  t230 = 0.1e1 / t62;
  t235 = t61 * t199;
  t237 = 0.1e1 / t46 / t235;
  t241 = -0.2535e0 * t33 * t34 * t225 + 0.52e0 * t203 - 0.35251328475563349648e-1 * t81 * t230 + 0.13888888888888888889e-1 * t59 * t210 - 0.10850694444444444445e-2 * t88 * t89 * t237;
  t243 = t96 * t28;
  t244 = t243 * t43;
  t247 = -t241;
  t249 = t98 * t198;
  t253 = my_piecewise3(t74, -0.243905525293907837e-1 * t44 * t221, t241 * t78 - 0.243905525293907837e-1 * t244 * t221 + t247 * t73 + 0.646416e0 * t249 * t218);
  t254 = my_piecewise3(t41, 0.646416e0 * t198 * t218, t253);
  t259 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t187 * t102 - t196 - 0.3e1 / 0.8e1 * t5 * t27 * t254);
  t261 = my_piecewise5(t14, 0, t10, 0, -t182);
  t264 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t261);
  t265 = t264 * t26;
  t269 = t113 * t192;
  t272 = t5 * t269 * t174 / 0.8e1;
  t274 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t265 * t174 - t272);
  tvrho0 = t106 + t178 + t6 * (t259 + t274);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t277 = -t7 - t181;
  t278 = my_piecewise5(t10, 0, t14, 0, t277);
  t281 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t278);
  t282 = t281 * t26;
  t287 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t102 - t196);
  t289 = my_piecewise5(t14, 0, t10, 0, -t277);
  t292 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t289);
  t293 = t292 * t26;
  t297 = t145 * t145;
  t298 = 0.1e1 / t297;
  t299 = t123 * rho[1];
  t301 = 0.1e1 / t124 / t299;
  t302 = sigma[2] * t301;
  t303 = t44 * t302;
  t309 = 0.1e1 / t116 / t162;
  t310 = t135 * t309;
  t314 = 0.1e1 / t143;
  t318 = -0.1e2 / 0.729e3 * t303 - 0.10673131404562256653e-1 * t44 * t302 * t131 + 0.44471380852342736056e-3 * t59 * t310 * t131 - 0.73495086436683507408e-4 * t59 * t310 * t314;
  t321 = t302 * t151;
  t325 = 0.1e1 / t116 / t123;
  t330 = 0.1e1 / t137;
  t335 = t136 * t299;
  t337 = 0.1e1 / t124 / t335;
  t341 = -0.2535e0 * t33 * t115 * t325 + 0.52e0 * t303 - 0.35251328475563349648e-1 * t156 * t330 + 0.13888888888888888889e-1 * t59 * t310 - 0.10850694444444444445e-2 * t88 * t161 * t337;
  t343 = t168 * t28;
  t344 = t343 * t43;
  t347 = -t341;
  t349 = t170 * t298;
  t353 = my_piecewise3(t149, -0.243905525293907837e-1 * t44 * t321, t341 * t153 - 0.243905525293907837e-1 * t344 * t321 + t347 * t148 + 0.646416e0 * t349 * t318);
  t354 = my_piecewise3(t122, 0.646416e0 * t298 * t318, t353);
  t359 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t293 * t174 - t272 - 0.3e1 / 0.8e1 * t5 * t114 * t354);
  tvrho1 = t106 + t178 + t6 * (t287 + t359);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t362 = t44 * t48;
  t367 = sigma[0] * t64;
  t374 = 0.5e1 / 0.972e3 * t362 + 0.4002424276710846245e-2 * t44 * t48 * t53 - 0.16676767819628526021e-3 * t59 * t367 * t53 + 0.27560657413756315278e-4 * t59 * t367 * t214;
  t380 = 0.1e1 / t34;
  t392 = 0.950625e-1 * t33 * t380 * t37 - 0.195e0 * t362 + 0.13219248178336256118e-1 * t34 * t82 - 0.52083333333333333334e-2 * t59 * t367 + 0.40690104166666666668e-3 * t88 * t81 * t92;
  t395 = t43 * t48 * t76;
  t398 = -t392;
  t403 = my_piecewise3(t74, 0.91464571985215438873e-2 * t44 * t48 * t76, t392 * t78 + 0.91464571985215438873e-2 * t243 * t395 + t398 * t73 + 0.646416e0 * t249 * t374);
  t404 = my_piecewise3(t41, 0.646416e0 * t198 * t374, t403);
  t408 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t404);
  tvsigma0 = t6 * t408;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t409 = t44 * t126;
  t414 = sigma[2] * t139;
  t421 = 0.5e1 / 0.972e3 * t409 + 0.4002424276710846245e-2 * t44 * t126 * t131 - 0.16676767819628526021e-3 * t59 * t414 * t131 + 0.27560657413756315278e-4 * t59 * t414 * t314;
  t427 = 0.1e1 / t115;
  t439 = 0.950625e-1 * t33 * t427 * t118 - 0.195e0 * t409 + 0.13219248178336256118e-1 * t115 * t157 - 0.52083333333333333334e-2 * t59 * t414 + 0.40690104166666666668e-3 * t88 * t156 * t164;
  t442 = t43 * t126 * t151;
  t445 = -t439;
  t450 = my_piecewise3(t149, 0.91464571985215438873e-2 * t44 * t126 * t151, t439 * t153 + 0.91464571985215438873e-2 * t343 * t442 + t445 * t148 + 0.646416e0 * t349 * t421);
  t451 = my_piecewise3(t122, 0.646416e0 * t298 * t421, t450);
  t455 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t451);
  tvsigma2 = t6 * t455;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t458 = t23 * t23;
  t459 = 0.1e1 / t458;
  t460 = t183 * t183;
  t463 = t179 * t6;
  t464 = 0.1e1 / t463;
  t465 = t16 * t464;
  t467 = -0.2e1 * t180 + 0.2e1 * t465;
  t468 = my_piecewise5(t10, 0, t14, 0, t467);
  t472 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t459 * t460 + 0.4e1 / 0.3e1 * t23 * t468);
  t473 = t472 * t26;
  t477 = t186 * t192;
  t479 = t5 * t477 * t102;
  t485 = 0.1e1 / t191 / t6;
  t486 = t25 * t485;
  t489 = t5 * t486 * t102 / 0.12e2;
  t491 = t5 * t193 * t254;
  t494 = 0.1e1 / t197 / t70;
  t495 = t218 * t218;
  t499 = 0.1e1 / t46 / t61;
  t500 = sigma[0] * t499;
  t501 = t44 * t500;
  t507 = 0.1e1 / t35 / t235;
  t508 = t60 * t507;
  t512 = t30 * t30;
  t513 = 0.1e1 / t512;
  t514 = t60 * sigma[0];
  t515 = t513 * t514;
  t516 = t61 * t61;
  t517 = t516 * t45;
  t518 = 0.1e1 / t517;
  t527 = t28 / t42 / t512;
  t528 = t60 * t60;
  t529 = t516 * t61;
  t531 = 0.1e1 / t46 / t529;
  t533 = t68 * t68;
  t534 = 0.1e1 / t533;
  t538 = 0.11e3 / 0.2187e4 * t501 + 0.39134815150061607728e-1 * t44 * t500 * t53 - 0.4002424276710846245e-2 * t59 * t508 * t53 + 0.29647587234895157371e-3 * t515 * t518 * t53 + 0.46546888076566221358e-3 * t59 * t508 * t214 - 0.32409166382013480325e-7 * t527 * t528 * t531 * t534;
  t542 = t500 * t76;
  t545 = t508 * t76;
  t550 = 0.1e1 / t35 / t199;
  t555 = 0.1e1 / t90;
  t561 = 0.1e1 / t46 / t516;
  t565 = 0.5915e0 * t33 * t34 * t550 - 0.19066666666666666667e1 * t501 + 0.17625664237781674824e0 * t81 * t555 - 0.87962962962962962964e-1 * t59 * t508 + 0.83188657407407407412e-2 * t88 * t89 * t561;
  t567 = t241 * t28;
  t568 = t567 * t43;
  t573 = t96 * t29;
  t574 = t573 * t58;
  t577 = -t565;
  t579 = t247 * t198;
  t582 = t98 * t494;
  t588 = my_piecewise3(t74, 0.89432025941099540233e-1 * t44 * t542 - 0.73992419488678004547e-3 * t59 * t545, t565 * t78 - 0.487811050587815674e-1 * t568 * t221 + 0.89432025941099540233e-1 * t244 * t542 - 0.73992419488678004547e-3 * t574 * t545 + t577 * t73 + 0.1292832e1 * t579 * t218 - 0.1292832e1 * t582 * t495 + 0.646416e0 * t249 * t538);
  t589 = my_piecewise3(t41, -0.1292832e1 * t494 * t495 + 0.646416e0 * t198 * t538, t588);
  t594 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t473 * t102 - t479 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t187 * t254 + t489 - t491 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t589);
  t595 = t111 * t111;
  t596 = 0.1e1 / t595;
  t597 = t261 * t261;
  t601 = my_piecewise5(t14, 0, t10, 0, -t467);
  t605 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t596 * t597 + 0.4e1 / 0.3e1 * t111 * t601);
  t606 = t605 * t26;
  t610 = t264 * t192;
  t612 = t5 * t610 * t174;
  t614 = t113 * t485;
  t617 = t5 * t614 * t174 / 0.12e2;
  t619 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t606 * t174 - t612 / 0.4e1 + t617);
  tv2rho20 = 0.2e1 * t259 + 0.2e1 * t274 + t6 * (t594 + t619);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t622 = t459 * t278;
  t625 = 0.2e1 * t465;
  t626 = my_piecewise5(t10, 0, t14, 0, t625);
  t630 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t622 * t183 + 0.4e1 / 0.3e1 * t23 * t626);
  t631 = t630 * t26;
  t635 = t281 * t192;
  t637 = t5 * t635 * t102;
  t645 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t631 * t102 - t637 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t282 * t254 - t479 / 0.8e1 + t489 - t491 / 0.8e1);
  t646 = t596 * t289;
  t649 = my_piecewise5(t14, 0, t10, 0, -t625);
  t653 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t646 * t261 + 0.4e1 / 0.3e1 * t111 * t649);
  t654 = t653 * t26;
  t658 = t292 * t192;
  t660 = t5 * t658 * t174;
  t667 = t5 * t269 * t354;
  t670 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t654 * t174 - t660 / 0.8e1 - t612 / 0.8e1 + t617 - 0.3e1 / 0.8e1 * t5 * t265 * t354 - t667 / 0.8e1);
  tv2rho21 = t259 + t274 + t287 + t359 + t6 * (t645 + t670);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t675 = t278 * t278;
  t679 = 0.2e1 * t180 + 0.2e1 * t465;
  t680 = my_piecewise5(t10, 0, t14, 0, t679);
  t684 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t459 * t675 + 0.4e1 / 0.3e1 * t23 * t680);
  t685 = t684 * t26;
  t691 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t685 * t102 - t637 / 0.4e1 + t489);
  t692 = t289 * t289;
  t696 = my_piecewise5(t14, 0, t10, 0, -t679);
  t700 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t596 * t692 + 0.4e1 / 0.3e1 * t111 * t696);
  t701 = t700 * t26;
  t711 = 0.1e1 / t297 / t145;
  t712 = t318 * t318;
  t716 = 0.1e1 / t124 / t136;
  t717 = sigma[2] * t716;
  t718 = t44 * t717;
  t724 = 0.1e1 / t116 / t335;
  t725 = t135 * t724;
  t729 = t135 * sigma[2];
  t730 = t513 * t729;
  t731 = t136 * t136;
  t732 = t731 * t123;
  t733 = 0.1e1 / t732;
  t740 = t135 * t135;
  t741 = t731 * t136;
  t743 = 0.1e1 / t124 / t741;
  t745 = t143 * t143;
  t746 = 0.1e1 / t745;
  t750 = 0.11e3 / 0.2187e4 * t718 + 0.39134815150061607728e-1 * t44 * t717 * t131 - 0.4002424276710846245e-2 * t59 * t725 * t131 + 0.29647587234895157371e-3 * t730 * t733 * t131 + 0.46546888076566221358e-3 * t59 * t725 * t314 - 0.32409166382013480325e-7 * t527 * t740 * t743 * t746;
  t754 = t717 * t151;
  t757 = t725 * t151;
  t762 = 0.1e1 / t116 / t299;
  t767 = 0.1e1 / t162;
  t773 = 0.1e1 / t124 / t731;
  t777 = 0.5915e0 * t33 * t115 * t762 - 0.19066666666666666667e1 * t718 + 0.17625664237781674824e0 * t156 * t767 - 0.87962962962962962964e-1 * t59 * t725 + 0.83188657407407407412e-2 * t88 * t161 * t773;
  t779 = t341 * t28;
  t780 = t779 * t43;
  t785 = t168 * t29;
  t786 = t785 * t58;
  t789 = -t777;
  t791 = t347 * t298;
  t794 = t170 * t711;
  t800 = my_piecewise3(t149, 0.89432025941099540233e-1 * t44 * t754 - 0.73992419488678004547e-3 * t59 * t757, t777 * t153 - 0.487811050587815674e-1 * t780 * t321 + 0.89432025941099540233e-1 * t344 * t754 - 0.73992419488678004547e-3 * t786 * t757 + t789 * t148 + 0.1292832e1 * t791 * t318 - 0.1292832e1 * t794 * t712 + 0.646416e0 * t349 * t750);
  t801 = my_piecewise3(t122, -0.1292832e1 * t711 * t712 + 0.646416e0 * t298 * t750, t800);
  t806 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t701 * t174 - t660 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t293 * t354 + t617 - t667 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t801);
  tv2rho22 = 0.2e1 * t287 + 0.2e1 * t359 + t6 * (t691 + t806);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t814 = t5 * t193 * t404 / 0.8e1;
  t815 = t494 * t374;
  t818 = t44 * t201;
  t823 = t209 * sigma[0];
  t827 = t513 * t60;
  t828 = t516 * rho[0];
  t829 = 0.1e1 / t828;
  t836 = t516 * t199;
  t838 = 0.1e1 / t46 / t836;
  t843 = -0.1e2 / 0.729e3 * t818 - 0.10673131404562256653e-1 * t44 * t201 * t53 + 0.13341414255702820817e-2 * t59 * t823 * t53 - 0.11117845213085684014e-3 * t827 * t829 * t53 - 0.14699017287336701482e-3 * t59 * t823 * t214 + 0.12153437393255055122e-7 * t527 * t514 * t838 * t534;
  t850 = t823 * t76;
  t865 = -0.12675e0 * t33 * t380 * t225 + 0.52e0 * t818 - 0.52876992713345024472e-1 * t34 * t230 + 0.27777777777777777778e-1 * t59 * t823 - 0.27126736111111111112e-2 * t88 * t81 * t237;
  t867 = t392 * t28;
  t868 = t867 * t43;
  t874 = t43 * t201 * t76;
  t879 = -t865;
  t881 = t398 * t198;
  t886 = t374 * t218;
  t892 = my_piecewise3(t74, -0.24390552529390783699e-1 * t44 * t201 * t76 + 0.27747157308254251705e-3 * t59 * t850, t865 * t78 - 0.243905525293907837e-1 * t868 * t221 + 0.91464571985215438873e-2 * t567 * t395 - 0.24390552529390783699e-1 * t243 * t874 + 0.27747157308254251705e-3 * t574 * t850 + t879 * t73 + 0.646416e0 * t881 * t218 + 0.646416e0 * t579 * t374 - 0.1292832e1 * t582 * t886 + 0.646416e0 * t249 * t843);
  t893 = my_piecewise3(t41, -0.1292832e1 * t815 * t218 + 0.646416e0 * t198 * t843, t892);
  t898 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t187 * t404 - t814 - 0.3e1 / 0.8e1 * t5 * t27 * t893);
  tv2rhosigma0 = t6 * t898 + t408;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t905 = t5 * t269 * t451 / 0.8e1;
  t907 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t265 * t451 - t905);
  tv2rhosigma2 = t6 * t907 + t455;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t913 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t404 - t814);
  tv2rhosigma3 = t6 * t913 + t408;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t918 = t711 * t421;
  t921 = t44 * t301;
  t926 = t309 * sigma[2];
  t930 = t513 * t135;
  t931 = t731 * rho[1];
  t932 = 0.1e1 / t931;
  t939 = t731 * t299;
  t941 = 0.1e1 / t124 / t939;
  t946 = -0.1e2 / 0.729e3 * t921 - 0.10673131404562256653e-1 * t44 * t301 * t131 + 0.13341414255702820817e-2 * t59 * t926 * t131 - 0.11117845213085684014e-3 * t930 * t932 * t131 - 0.14699017287336701482e-3 * t59 * t926 * t314 + 0.12153437393255055122e-7 * t527 * t729 * t941 * t746;
  t953 = t926 * t151;
  t968 = -0.12675e0 * t33 * t427 * t325 + 0.52e0 * t921 - 0.52876992713345024472e-1 * t115 * t330 + 0.27777777777777777778e-1 * t59 * t926 - 0.27126736111111111112e-2 * t88 * t156 * t337;
  t970 = t439 * t28;
  t971 = t970 * t43;
  t977 = t43 * t301 * t151;
  t982 = -t968;
  t984 = t445 * t298;
  t989 = t421 * t318;
  t995 = my_piecewise3(t149, -0.24390552529390783699e-1 * t44 * t301 * t151 + 0.27747157308254251705e-3 * t59 * t953, t968 * t153 - 0.243905525293907837e-1 * t971 * t321 + 0.91464571985215438873e-2 * t779 * t442 - 0.24390552529390783699e-1 * t343 * t977 + 0.27747157308254251705e-3 * t786 * t953 + t982 * t148 + 0.646416e0 * t984 * t318 + 0.646416e0 * t791 * t421 - 0.1292832e1 * t794 * t989 + 0.646416e0 * t349 * t946);
  t996 = my_piecewise3(t122, -0.1292832e1 * t918 * t318 + 0.646416e0 * t298 * t946, t995);
  t1001 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t293 * t451 - t905 - 0.3e1 / 0.8e1 * t5 * t114 * t996);
  tv2rhosigma5 = t6 * t1001 + t455;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1003 = t374 * t374;
  t1009 = t513 * sigma[0];
  t1010 = 0.1e1 / t516;
  t1018 = 0.1e1 / t46 / t517;
  t1023 = -0.33353535639257052042e-3 * t59 * t64 * t53 + 0.41691919549071315052e-4 * t1009 * t1010 * t53 + 0.27560657413756315278e-4 * t59 * t64 * t214 - 0.45575390224706456708e-8 * t527 * t60 * t1018 * t534;
  t1030 = 0.1e1 / t81;
  t1041 = -0.4753125e-1 * t33 * t1030 * t37 + 0.6609624089168128059e-2 * t380 * t82 - 0.52083333333333333334e-2 * t59 * t64 + 0.61035156250000000002e-3 * t88 * t34 * t92;
  t1046 = t58 * t64 * t76;
  t1049 = -t1041;
  t1058 = my_piecewise3(t74, -0.10405183990595344389e-3 * t59 * t64 * t76, t1041 * t78 + 0.18292914397043087775e-1 * t867 * t395 - 0.10405183990595344389e-3 * t573 * t1046 + t1049 * t73 + 0.1292832e1 * t881 * t374 - 0.1292832e1 * t582 * t1003 + 0.646416e0 * t249 * t1023);
  t1059 = my_piecewise3(t41, -0.1292832e1 * t494 * t1003 + 0.646416e0 * t198 * t1023, t1058);
  t1063 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1059);
  tv2sigma20 = t6 * t1063;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1064 = t421 * t421;
  t1070 = t513 * sigma[2];
  t1071 = 0.1e1 / t731;
  t1079 = 0.1e1 / t124 / t732;
  t1084 = -0.33353535639257052042e-3 * t59 * t139 * t131 + 0.41691919549071315052e-4 * t1070 * t1071 * t131 + 0.27560657413756315278e-4 * t59 * t139 * t314 - 0.45575390224706456708e-8 * t527 * t135 * t1079 * t746;
  t1091 = 0.1e1 / t156;
  t1102 = -0.4753125e-1 * t33 * t1091 * t118 + 0.6609624089168128059e-2 * t427 * t157 - 0.52083333333333333334e-2 * t59 * t139 + 0.61035156250000000002e-3 * t88 * t115 * t164;
  t1107 = t58 * t139 * t151;
  t1110 = -t1102;
  t1119 = my_piecewise3(t149, -0.10405183990595344389e-3 * t59 * t139 * t151, t1102 * t153 + 0.18292914397043087775e-1 * t970 * t442 - 0.10405183990595344389e-3 * t785 * t1107 + t1110 * t148 + 0.1292832e1 * t984 * t421 - 0.1292832e1 * t794 * t1064 + 0.646416e0 * t349 * t1084);
  t1120 = my_piecewise3(t122, -0.1292832e1 * t711 * t1064 + 0.646416e0 * t298 * t1084, t1119);
  t1124 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t1120);
  tv2sigma25 = t6 * t1124;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t33, t34, t35, t37, t39, t40, t41;
  double t42, t43, t44, t45, t46, t48, t49, t50;
  double t53, t58, t59, t60, t61, t62, t64, t66;
  double t68, t69, t70, t73, t74, t76, t78, t79;
  double t80, t81, t82, t84, t85, t88, t89, t90;
  double t92, t95, t96, t98, t101, t102, t106, t107;
  double t108, t109, t110, t111, t113, t114, t115, t116;
  double t118, t120, t121, t122, t123, t124, t126, t127;
  double t128, t131, t135, t136, t137, t139, t141, t143;
  double t144, t145, t148, t149, t151, t153, t154, t155;
  double t156, t157, t159, t160, t161, t162, t164, t167;
  double t168, t170, t173, t174, t178, tzk0;

  double t179, t180, t181, t182, t183, t186, t187, t191;
  double t192, t193, t196, t197, t198, t199, t201, t202;
  double t203, t209, t210, t214, t218, t221, t225, t230;
  double t235, t237, t241, t243, t244, t247, t249, t253;
  double t254, t259, t261, t264, t265, t269, t272, t274;
  double tvrho0, t277, t278, t281, t282, t287, t289, t292;
  double t293, t297, t298, t299, t301, t302, t303, t309;
  double t310, t314, t318, t321, t325, t330, t335, t337;
  double t341, t343, t344, t347, t349, t353, t354, t359;
  double tvrho1, t362, t367, t374, t380, t392, t395, t398;
  double t403, t404, t408, tvsigma0, tvsigma1, t409, t414, t421;
  double t427, t439, t442, t445, t450, t451, t455, tvsigma2;

  double t458, t459, t460, t463, t464, t465, t467, t468;
  double t472, t473, t477, t479, t485, t486, t489, t491;
  double t494, t495, t499, t500, t501, t507, t508, t512;
  double t513, t514, t515, t516, t517, t518, t527, t528;
  double t529, t531, t533, t534, t538, t542, t545, t550;
  double t555, t561, t565, t567, t568, t573, t574, t577;
  double t579, t582, t588, t589, t594, t595, t596, t597;
  double t601, t605, t606, t610, t612, t614, t617, t619;
  double tv2rho20, t622, t625, t626, t630, t631, t635, t637;
  double t645, t646, t649, t653, t654, t658, t660, t667;
  double t670, tv2rho21, t675, t679, t680, t684, t685, t691;
  double t692, t696, t700, t701, t711, t712, t716, t717;
  double t718, t724, t725, t729, t730, t731, t732, t733;
  double t740, t741, t743, t745, t746, t750, t754, t757;
  double t762, t767, t773, t777, t779, t780, t785, t786;
  double t789, t791, t794, t800, t801, t806, tv2rho22, t814;
  double t815, t818, t823, t827, t828, t829, t836, t838;
  double t843, t850, t865, t867, t868, t874, t879, t881;
  double t886, t892, t893, t898, tv2rhosigma0, tv2rhosigma1, t905, t907;
  double tv2rhosigma2, t913, tv2rhosigma3, tv2rhosigma4, t918, t921, t926, t930;
  double t931, t932, t939, t941, t946, t953, t968, t970;
  double t971, t977, t982, t984, t989, t995, t996, t1001;
  double tv2rhosigma5, t1003, t1009, t1010, t1018, t1023, t1030, t1041;
  double t1046, t1049, t1058, t1059, t1063, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t1064, t1070, t1071, t1079, t1084, t1091;
  double t1102, t1107, t1110, t1119, t1120, t1124, tv2sigma25;

  double t1128, t1129, t1132, t1135, t1136, t1137, t1139, t1140;
  double t1144, t1145, t1149, t1151, t1156, t1158, t1161, t1167;
  double t1168, t1171, t1173, t1176, t1178, t1179, t1180, t1183;
  double t1187, t1188, t1189, t1195, t1196, t1200, t1204, t1205;
  double t1207, t1209, t1219, t1220, t1222, t1225, t1228, t1232;
  double t1235, t1243, t1248, t1254, t1258, t1260, t1261, t1266;
  double t1267, t1274, t1275, t1278, t1280, t1283, t1288, t1291;
  double t1296, t1297, t1298, t1303, t1305, t1306, t1309, t1313;
  double t1317, t1318, t1322, t1324, t1326, t1328, t1330, t1333;
  double t1335, tv3rho30, t1338, t1339, t1340, t1343, t1348, t1349;
  double t1350, t1351, t1355, t1356, t1360, t1363, t1367, t1369;
  double t1373, t1382, t1383, t1384, t1387, t1393, t1397, t1398;
  double t1402, t1405, t1406, t1408, t1417, t1419, t1422, tv3rho31;
  double t1425, t1430, t1433, t1434, t1438, t1439, t1443, t1445;
  double t1454, t1455, t1460, t1464, t1468, t1469, t1473, t1475;
  double t1482, t1490, t1492, t1493, tv3rho32, t1498, t1504, t1505;
  double t1509, t1510, t1517, t1518, t1524, t1528, t1529, t1544;
  double t1545, t1546, t1549, t1553, t1554, t1555, t1561, t1562;
  double t1566, t1570, t1571, t1573, t1575, t1585, t1586, t1588;
  double t1591, t1594, t1598, t1601, t1609, t1614, t1620, t1624;
  double t1626, t1627, t1632, t1633, t1640, t1641, t1644, t1646;
  double t1649, t1654, t1657, t1662, t1663, t1664, t1669, tv3rho33;
  double t1677, t1684, t1686, t1688, t1691, t1696, t1701, t1705;
  double t1706, t1719, t1721, t1725, t1732, t1739, t1740, t1743;
  double t1744, t1752, t1768, t1770, t1774, t1784, t1789, t1792;
  double t1795, t1796, t1799, t1806, t1808, t1809, t1814, tv3rho2sigma0;
  double tv3rho2sigma1, t1821, t1825, t1827, tv3rho2sigma2, t1833, t1841, tv3rho2sigma3;
  double tv3rho2sigma4, t1847, t1854, t1857, tv3rho2sigma5, t1865, tv3rho2sigma6, tv3rho2sigma7;
  double t1876, t1879, t1884, t1889, t1893, t1894, t1907, t1909;
  double t1913, t1920, t1927, t1940, t1956, t1958, t1962, t1967;
  double t1968, t1971, t1972, t1981, t1984, t1987, t1988, t1991;
  double t1994, t1996, t1997, t2002, tv3rho2sigma8, t2009, t2010, t2015;
  double t2021, t2022, t2031, t2035, t2036, t2040, t2061, t2063;
  double t2064, t2076, t2079, t2080, t2083, t2085, t2096, t2099;
  double t2104, t2109, t2110, t2111, t2116, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22;
  double tv3rhosigma23, tv3rhosigma24, t2123, t2125, tv3rhosigma25, t2131, tv3rhosigma26, tv3rhosigma27;
  double tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2136, t2141, t2147, t2148, t2157;
  double t2161, t2162, t2166, t2187, t2189, t2190, t2202, t2205;
  double t2206, t2209, t2211, t2222, t2225, t2230, t2235, t2236;
  double t2237, t2242, tv3rhosigma211, t2244, t2255, t2259, t2263, t2269;
  double t2278, t2287, t2297, t2302, t2303, t2304, t2308, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t2309, t2320, t2324, t2328, t2334, t2343, t2352, t2362;
  double t2367, t2368, t2369, t2373, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t33 = t29 / t31;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = t39 / 0.12e2;
  t41 = t40 < 0.6e0;
  t42 = t31 * t31;
  t43 = 0.1e1 / t42;
  t44 = t28 * t43;
  t45 = rho[0] * rho[0];
  t46 = t35 * t35;
  t48 = 0.1e1 / t46 / t45;
  t49 = sigma[0] * t48;
  t50 = t44 * t49;
  t53 = exp(-t50 / 0.24e2);
  t58 = 0.1e1 / t31 / t30;
  t59 = t29 * t58;
  t60 = sigma[0] * sigma[0];
  t61 = t45 * t45;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t35 / t62;
  t66 = t59 * t60 * t64;
  t68 = 0.1e1 + 0.13780328706878157639e-4 * t66;
  t69 = log(t68);
  t70 = 0.804e0 + 0.5e1 / 0.972e3 * t50 + 0.4002424276710846245e-2 * t44 * t49 * t53 + t69;
  t73 = 0.1804e1 - 0.646416e0 / t70;
  t74 = 0.26e1 < t40;
  t76 = exp(-0.1137619054542480583e-1 * t50);
  t78 = 0.1804e1 - 0.804e0 * t76;
  t79 = 0.190125e0 * t39;
  t80 = 0.195e0 * t50;
  t81 = t34 * sigma[0];
  t82 = 0.1e1 / t61;
  t84 = 0.88128321188908374119e-2 * t81 * t82;
  t85 = 0.26041666666666666667e-2 * t66;
  t88 = t28 / t42 / t30;
  t89 = t34 * t60;
  t90 = t61 * t45;
  t92 = 0.1e1 / t46 / t90;
  t95 = 0.16276041666666666667e-3 * t88 * t89 * t92;
  t96 = -0.40608e0 + t79 - t80 + t84 - t85 + t95;
  t98 = 0.140608e1 - t79 + t80 - t84 + t85 - t95;
  t101 = my_piecewise3(t74, t78, t98 * t73 + t96 * t78);
  t102 = my_piecewise3(t41, t73, t101);
  t106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t102);
  t107 = rho[1] <= p->dens_threshold;
  t108 = my_piecewise5(t14, t11, t10, t15, -t17);
  t109 = 0.1e1 + t108;
  t110 = t109 <= p->zeta_threshold;
  t111 = POW_1_3(t109);
  t113 = my_piecewise3(t110, t22, t111 * t109);
  t114 = t113 * t26;
  t115 = sqrt(sigma[2]);
  t116 = POW_1_3(rho[1]);
  t118 = 0.1e1 / t116 / rho[1];
  t120 = t33 * t115 * t118;
  t121 = t120 / 0.12e2;
  t122 = t121 < 0.6e0;
  t123 = rho[1] * rho[1];
  t124 = t116 * t116;
  t126 = 0.1e1 / t124 / t123;
  t127 = sigma[2] * t126;
  t128 = t44 * t127;
  t131 = exp(-t128 / 0.24e2);
  t135 = sigma[2] * sigma[2];
  t136 = t123 * t123;
  t137 = t136 * rho[1];
  t139 = 0.1e1 / t116 / t137;
  t141 = t59 * t135 * t139;
  t143 = 0.1e1 + 0.13780328706878157639e-4 * t141;
  t144 = log(t143);
  t145 = 0.804e0 + 0.5e1 / 0.972e3 * t128 + 0.4002424276710846245e-2 * t44 * t127 * t131 + t144;
  t148 = 0.1804e1 - 0.646416e0 / t145;
  t149 = 0.26e1 < t121;
  t151 = exp(-0.1137619054542480583e-1 * t128);
  t153 = 0.1804e1 - 0.804e0 * t151;
  t154 = 0.190125e0 * t120;
  t155 = 0.195e0 * t128;
  t156 = t115 * sigma[2];
  t157 = 0.1e1 / t136;
  t159 = 0.88128321188908374119e-2 * t156 * t157;
  t160 = 0.26041666666666666667e-2 * t141;
  t161 = t115 * t135;
  t162 = t136 * t123;
  t164 = 0.1e1 / t124 / t162;
  t167 = 0.16276041666666666667e-3 * t88 * t161 * t164;
  t168 = -0.40608e0 + t154 - t155 + t159 - t160 + t167;
  t170 = 0.140608e1 - t154 + t155 - t159 + t160 - t167;
  t173 = my_piecewise3(t149, t153, t170 * t148 + t168 * t153);
  t174 = my_piecewise3(t122, t148, t173);
  t178 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t174);
  tzk0 = t106 + t178;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t179 = t6 * t6;
  t180 = 0.1e1 / t179;
  t181 = t16 * t180;
  t182 = t7 - t181;
  t183 = my_piecewise5(t10, 0, t14, 0, t182);
  t186 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t183);
  t187 = t186 * t26;
  t191 = t26 * t26;
  t192 = 0.1e1 / t191;
  t193 = t25 * t192;
  t196 = t5 * t193 * t102 / 0.8e1;
  t197 = t70 * t70;
  t198 = 0.1e1 / t197;
  t199 = t45 * rho[0];
  t201 = 0.1e1 / t46 / t199;
  t202 = sigma[0] * t201;
  t203 = t44 * t202;
  t209 = 0.1e1 / t35 / t90;
  t210 = t60 * t209;
  t214 = 0.1e1 / t68;
  t218 = -0.1e2 / 0.729e3 * t203 - 0.10673131404562256653e-1 * t44 * t202 * t53 + 0.44471380852342736056e-3 * t59 * t210 * t53 - 0.73495086436683507408e-4 * t59 * t210 * t214;
  t221 = t202 * t76;
  t225 = 0.1e1 / t35 / t45;
  t230 = 0.1e1 / t62;
  t235 = t61 * t199;
  t237 = 0.1e1 / t46 / t235;
  t241 = -0.2535e0 * t33 * t34 * t225 + 0.52e0 * t203 - 0.35251328475563349648e-1 * t81 * t230 + 0.13888888888888888889e-1 * t59 * t210 - 0.10850694444444444445e-2 * t88 * t89 * t237;
  t243 = t96 * t28;
  t244 = t243 * t43;
  t247 = -t241;
  t249 = t98 * t198;
  t253 = my_piecewise3(t74, -0.243905525293907837e-1 * t44 * t221, t241 * t78 - 0.243905525293907837e-1 * t244 * t221 + t247 * t73 + 0.646416e0 * t249 * t218);
  t254 = my_piecewise3(t41, 0.646416e0 * t198 * t218, t253);
  t259 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t187 * t102 - t196 - 0.3e1 / 0.8e1 * t5 * t27 * t254);
  t261 = my_piecewise5(t14, 0, t10, 0, -t182);
  t264 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t261);
  t265 = t264 * t26;
  t269 = t113 * t192;
  t272 = t5 * t269 * t174 / 0.8e1;
  t274 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t265 * t174 - t272);
  tvrho0 = t106 + t178 + t6 * (t259 + t274);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t277 = -t7 - t181;
  t278 = my_piecewise5(t10, 0, t14, 0, t277);
  t281 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t278);
  t282 = t281 * t26;
  t287 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t102 - t196);
  t289 = my_piecewise5(t14, 0, t10, 0, -t277);
  t292 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t289);
  t293 = t292 * t26;
  t297 = t145 * t145;
  t298 = 0.1e1 / t297;
  t299 = t123 * rho[1];
  t301 = 0.1e1 / t124 / t299;
  t302 = sigma[2] * t301;
  t303 = t44 * t302;
  t309 = 0.1e1 / t116 / t162;
  t310 = t135 * t309;
  t314 = 0.1e1 / t143;
  t318 = -0.1e2 / 0.729e3 * t303 - 0.10673131404562256653e-1 * t44 * t302 * t131 + 0.44471380852342736056e-3 * t59 * t310 * t131 - 0.73495086436683507408e-4 * t59 * t310 * t314;
  t321 = t302 * t151;
  t325 = 0.1e1 / t116 / t123;
  t330 = 0.1e1 / t137;
  t335 = t136 * t299;
  t337 = 0.1e1 / t124 / t335;
  t341 = -0.2535e0 * t33 * t115 * t325 + 0.52e0 * t303 - 0.35251328475563349648e-1 * t156 * t330 + 0.13888888888888888889e-1 * t59 * t310 - 0.10850694444444444445e-2 * t88 * t161 * t337;
  t343 = t168 * t28;
  t344 = t343 * t43;
  t347 = -t341;
  t349 = t170 * t298;
  t353 = my_piecewise3(t149, -0.243905525293907837e-1 * t44 * t321, t341 * t153 - 0.243905525293907837e-1 * t344 * t321 + t347 * t148 + 0.646416e0 * t349 * t318);
  t354 = my_piecewise3(t122, 0.646416e0 * t298 * t318, t353);
  t359 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t293 * t174 - t272 - 0.3e1 / 0.8e1 * t5 * t114 * t354);
  tvrho1 = t106 + t178 + t6 * (t287 + t359);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t362 = t44 * t48;
  t367 = sigma[0] * t64;
  t374 = 0.5e1 / 0.972e3 * t362 + 0.4002424276710846245e-2 * t44 * t48 * t53 - 0.16676767819628526021e-3 * t59 * t367 * t53 + 0.27560657413756315278e-4 * t59 * t367 * t214;
  t380 = 0.1e1 / t34;
  t392 = 0.950625e-1 * t33 * t380 * t37 - 0.195e0 * t362 + 0.13219248178336256118e-1 * t34 * t82 - 0.52083333333333333334e-2 * t59 * t367 + 0.40690104166666666668e-3 * t88 * t81 * t92;
  t395 = t43 * t48 * t76;
  t398 = -t392;
  t403 = my_piecewise3(t74, 0.91464571985215438873e-2 * t44 * t48 * t76, t392 * t78 + 0.91464571985215438873e-2 * t243 * t395 + t398 * t73 + 0.646416e0 * t249 * t374);
  t404 = my_piecewise3(t41, 0.646416e0 * t198 * t374, t403);
  t408 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t404);
  tvsigma0 = t6 * t408;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t409 = t44 * t126;
  t414 = sigma[2] * t139;
  t421 = 0.5e1 / 0.972e3 * t409 + 0.4002424276710846245e-2 * t44 * t126 * t131 - 0.16676767819628526021e-3 * t59 * t414 * t131 + 0.27560657413756315278e-4 * t59 * t414 * t314;
  t427 = 0.1e1 / t115;
  t439 = 0.950625e-1 * t33 * t427 * t118 - 0.195e0 * t409 + 0.13219248178336256118e-1 * t115 * t157 - 0.52083333333333333334e-2 * t59 * t414 + 0.40690104166666666668e-3 * t88 * t156 * t164;
  t442 = t43 * t126 * t151;
  t445 = -t439;
  t450 = my_piecewise3(t149, 0.91464571985215438873e-2 * t44 * t126 * t151, t439 * t153 + 0.91464571985215438873e-2 * t343 * t442 + t445 * t148 + 0.646416e0 * t349 * t421);
  t451 = my_piecewise3(t122, 0.646416e0 * t298 * t421, t450);
  t455 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t451);
  tvsigma2 = t6 * t455;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t458 = t23 * t23;
  t459 = 0.1e1 / t458;
  t460 = t183 * t183;
  t463 = t179 * t6;
  t464 = 0.1e1 / t463;
  t465 = t16 * t464;
  t467 = -0.2e1 * t180 + 0.2e1 * t465;
  t468 = my_piecewise5(t10, 0, t14, 0, t467);
  t472 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t459 * t460 + 0.4e1 / 0.3e1 * t23 * t468);
  t473 = t472 * t26;
  t477 = t186 * t192;
  t479 = t5 * t477 * t102;
  t485 = 0.1e1 / t191 / t6;
  t486 = t25 * t485;
  t489 = t5 * t486 * t102 / 0.12e2;
  t491 = t5 * t193 * t254;
  t494 = 0.1e1 / t197 / t70;
  t495 = t218 * t218;
  t499 = 0.1e1 / t46 / t61;
  t500 = sigma[0] * t499;
  t501 = t44 * t500;
  t507 = 0.1e1 / t35 / t235;
  t508 = t60 * t507;
  t512 = t30 * t30;
  t513 = 0.1e1 / t512;
  t514 = t60 * sigma[0];
  t515 = t513 * t514;
  t516 = t61 * t61;
  t517 = t516 * t45;
  t518 = 0.1e1 / t517;
  t527 = t28 / t42 / t512;
  t528 = t60 * t60;
  t529 = t516 * t61;
  t531 = 0.1e1 / t46 / t529;
  t533 = t68 * t68;
  t534 = 0.1e1 / t533;
  t538 = 0.11e3 / 0.2187e4 * t501 + 0.39134815150061607728e-1 * t44 * t500 * t53 - 0.4002424276710846245e-2 * t59 * t508 * t53 + 0.29647587234895157371e-3 * t515 * t518 * t53 + 0.46546888076566221358e-3 * t59 * t508 * t214 - 0.32409166382013480325e-7 * t527 * t528 * t531 * t534;
  t542 = t500 * t76;
  t545 = t508 * t76;
  t550 = 0.1e1 / t35 / t199;
  t555 = 0.1e1 / t90;
  t561 = 0.1e1 / t46 / t516;
  t565 = 0.5915e0 * t33 * t34 * t550 - 0.19066666666666666667e1 * t501 + 0.17625664237781674824e0 * t81 * t555 - 0.87962962962962962964e-1 * t59 * t508 + 0.83188657407407407412e-2 * t88 * t89 * t561;
  t567 = t241 * t28;
  t568 = t567 * t43;
  t573 = t96 * t29;
  t574 = t573 * t58;
  t577 = -t565;
  t579 = t247 * t198;
  t582 = t98 * t494;
  t588 = my_piecewise3(t74, 0.89432025941099540233e-1 * t44 * t542 - 0.73992419488678004547e-3 * t59 * t545, t565 * t78 - 0.487811050587815674e-1 * t568 * t221 + 0.89432025941099540233e-1 * t244 * t542 - 0.73992419488678004547e-3 * t574 * t545 + t577 * t73 + 0.1292832e1 * t579 * t218 - 0.1292832e1 * t582 * t495 + 0.646416e0 * t249 * t538);
  t589 = my_piecewise3(t41, -0.1292832e1 * t494 * t495 + 0.646416e0 * t198 * t538, t588);
  t594 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t473 * t102 - t479 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t187 * t254 + t489 - t491 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t589);
  t595 = t111 * t111;
  t596 = 0.1e1 / t595;
  t597 = t261 * t261;
  t601 = my_piecewise5(t14, 0, t10, 0, -t467);
  t605 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t596 * t597 + 0.4e1 / 0.3e1 * t111 * t601);
  t606 = t605 * t26;
  t610 = t264 * t192;
  t612 = t5 * t610 * t174;
  t614 = t113 * t485;
  t617 = t5 * t614 * t174 / 0.12e2;
  t619 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t606 * t174 - t612 / 0.4e1 + t617);
  tv2rho20 = 0.2e1 * t259 + 0.2e1 * t274 + t6 * (t594 + t619);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t622 = t459 * t278;
  t625 = 0.2e1 * t465;
  t626 = my_piecewise5(t10, 0, t14, 0, t625);
  t630 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t622 * t183 + 0.4e1 / 0.3e1 * t23 * t626);
  t631 = t630 * t26;
  t635 = t281 * t192;
  t637 = t5 * t635 * t102;
  t645 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t631 * t102 - t637 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t282 * t254 - t479 / 0.8e1 + t489 - t491 / 0.8e1);
  t646 = t596 * t289;
  t649 = my_piecewise5(t14, 0, t10, 0, -t625);
  t653 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t646 * t261 + 0.4e1 / 0.3e1 * t111 * t649);
  t654 = t653 * t26;
  t658 = t292 * t192;
  t660 = t5 * t658 * t174;
  t667 = t5 * t269 * t354;
  t670 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t654 * t174 - t660 / 0.8e1 - t612 / 0.8e1 + t617 - 0.3e1 / 0.8e1 * t5 * t265 * t354 - t667 / 0.8e1);
  tv2rho21 = t259 + t274 + t287 + t359 + t6 * (t645 + t670);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t675 = t278 * t278;
  t679 = 0.2e1 * t180 + 0.2e1 * t465;
  t680 = my_piecewise5(t10, 0, t14, 0, t679);
  t684 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t459 * t675 + 0.4e1 / 0.3e1 * t23 * t680);
  t685 = t684 * t26;
  t691 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t685 * t102 - t637 / 0.4e1 + t489);
  t692 = t289 * t289;
  t696 = my_piecewise5(t14, 0, t10, 0, -t679);
  t700 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t596 * t692 + 0.4e1 / 0.3e1 * t111 * t696);
  t701 = t700 * t26;
  t711 = 0.1e1 / t297 / t145;
  t712 = t318 * t318;
  t716 = 0.1e1 / t124 / t136;
  t717 = sigma[2] * t716;
  t718 = t44 * t717;
  t724 = 0.1e1 / t116 / t335;
  t725 = t135 * t724;
  t729 = t135 * sigma[2];
  t730 = t513 * t729;
  t731 = t136 * t136;
  t732 = t731 * t123;
  t733 = 0.1e1 / t732;
  t740 = t135 * t135;
  t741 = t731 * t136;
  t743 = 0.1e1 / t124 / t741;
  t745 = t143 * t143;
  t746 = 0.1e1 / t745;
  t750 = 0.11e3 / 0.2187e4 * t718 + 0.39134815150061607728e-1 * t44 * t717 * t131 - 0.4002424276710846245e-2 * t59 * t725 * t131 + 0.29647587234895157371e-3 * t730 * t733 * t131 + 0.46546888076566221358e-3 * t59 * t725 * t314 - 0.32409166382013480325e-7 * t527 * t740 * t743 * t746;
  t754 = t717 * t151;
  t757 = t725 * t151;
  t762 = 0.1e1 / t116 / t299;
  t767 = 0.1e1 / t162;
  t773 = 0.1e1 / t124 / t731;
  t777 = 0.5915e0 * t33 * t115 * t762 - 0.19066666666666666667e1 * t718 + 0.17625664237781674824e0 * t156 * t767 - 0.87962962962962962964e-1 * t59 * t725 + 0.83188657407407407412e-2 * t88 * t161 * t773;
  t779 = t341 * t28;
  t780 = t779 * t43;
  t785 = t168 * t29;
  t786 = t785 * t58;
  t789 = -t777;
  t791 = t347 * t298;
  t794 = t170 * t711;
  t800 = my_piecewise3(t149, 0.89432025941099540233e-1 * t44 * t754 - 0.73992419488678004547e-3 * t59 * t757, t777 * t153 - 0.487811050587815674e-1 * t780 * t321 + 0.89432025941099540233e-1 * t344 * t754 - 0.73992419488678004547e-3 * t786 * t757 + t789 * t148 + 0.1292832e1 * t791 * t318 - 0.1292832e1 * t794 * t712 + 0.646416e0 * t349 * t750);
  t801 = my_piecewise3(t122, -0.1292832e1 * t711 * t712 + 0.646416e0 * t298 * t750, t800);
  t806 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t701 * t174 - t660 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t293 * t354 + t617 - t667 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t801);
  tv2rho22 = 0.2e1 * t287 + 0.2e1 * t359 + t6 * (t691 + t806);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t814 = t5 * t193 * t404 / 0.8e1;
  t815 = t494 * t374;
  t818 = t44 * t201;
  t823 = t209 * sigma[0];
  t827 = t513 * t60;
  t828 = t516 * rho[0];
  t829 = 0.1e1 / t828;
  t836 = t516 * t199;
  t838 = 0.1e1 / t46 / t836;
  t843 = -0.1e2 / 0.729e3 * t818 - 0.10673131404562256653e-1 * t44 * t201 * t53 + 0.13341414255702820817e-2 * t59 * t823 * t53 - 0.11117845213085684014e-3 * t827 * t829 * t53 - 0.14699017287336701482e-3 * t59 * t823 * t214 + 0.12153437393255055122e-7 * t527 * t514 * t838 * t534;
  t850 = t823 * t76;
  t865 = -0.12675e0 * t33 * t380 * t225 + 0.52e0 * t818 - 0.52876992713345024472e-1 * t34 * t230 + 0.27777777777777777778e-1 * t59 * t823 - 0.27126736111111111112e-2 * t88 * t81 * t237;
  t867 = t392 * t28;
  t868 = t867 * t43;
  t874 = t43 * t201 * t76;
  t879 = -t865;
  t881 = t398 * t198;
  t886 = t374 * t218;
  t892 = my_piecewise3(t74, -0.24390552529390783699e-1 * t44 * t201 * t76 + 0.27747157308254251705e-3 * t59 * t850, t865 * t78 - 0.243905525293907837e-1 * t868 * t221 + 0.91464571985215438873e-2 * t567 * t395 - 0.24390552529390783699e-1 * t243 * t874 + 0.27747157308254251705e-3 * t574 * t850 + t879 * t73 + 0.646416e0 * t881 * t218 + 0.646416e0 * t579 * t374 - 0.1292832e1 * t582 * t886 + 0.646416e0 * t249 * t843);
  t893 = my_piecewise3(t41, -0.1292832e1 * t815 * t218 + 0.646416e0 * t198 * t843, t892);
  t898 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t187 * t404 - t814 - 0.3e1 / 0.8e1 * t5 * t27 * t893);
  tv2rhosigma0 = t6 * t898 + t408;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t905 = t5 * t269 * t451 / 0.8e1;
  t907 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t265 * t451 - t905);
  tv2rhosigma2 = t6 * t907 + t455;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t913 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t404 - t814);
  tv2rhosigma3 = t6 * t913 + t408;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t918 = t711 * t421;
  t921 = t44 * t301;
  t926 = t309 * sigma[2];
  t930 = t513 * t135;
  t931 = t731 * rho[1];
  t932 = 0.1e1 / t931;
  t939 = t731 * t299;
  t941 = 0.1e1 / t124 / t939;
  t946 = -0.1e2 / 0.729e3 * t921 - 0.10673131404562256653e-1 * t44 * t301 * t131 + 0.13341414255702820817e-2 * t59 * t926 * t131 - 0.11117845213085684014e-3 * t930 * t932 * t131 - 0.14699017287336701482e-3 * t59 * t926 * t314 + 0.12153437393255055122e-7 * t527 * t729 * t941 * t746;
  t953 = t926 * t151;
  t968 = -0.12675e0 * t33 * t427 * t325 + 0.52e0 * t921 - 0.52876992713345024472e-1 * t115 * t330 + 0.27777777777777777778e-1 * t59 * t926 - 0.27126736111111111112e-2 * t88 * t156 * t337;
  t970 = t439 * t28;
  t971 = t970 * t43;
  t977 = t43 * t301 * t151;
  t982 = -t968;
  t984 = t445 * t298;
  t989 = t421 * t318;
  t995 = my_piecewise3(t149, -0.24390552529390783699e-1 * t44 * t301 * t151 + 0.27747157308254251705e-3 * t59 * t953, t968 * t153 - 0.243905525293907837e-1 * t971 * t321 + 0.91464571985215438873e-2 * t779 * t442 - 0.24390552529390783699e-1 * t343 * t977 + 0.27747157308254251705e-3 * t786 * t953 + t982 * t148 + 0.646416e0 * t984 * t318 + 0.646416e0 * t791 * t421 - 0.1292832e1 * t794 * t989 + 0.646416e0 * t349 * t946);
  t996 = my_piecewise3(t122, -0.1292832e1 * t918 * t318 + 0.646416e0 * t298 * t946, t995);
  t1001 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t293 * t451 - t905 - 0.3e1 / 0.8e1 * t5 * t114 * t996);
  tv2rhosigma5 = t6 * t1001 + t455;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1003 = t374 * t374;
  t1009 = t513 * sigma[0];
  t1010 = 0.1e1 / t516;
  t1018 = 0.1e1 / t46 / t517;
  t1023 = -0.33353535639257052042e-3 * t59 * t64 * t53 + 0.41691919549071315052e-4 * t1009 * t1010 * t53 + 0.27560657413756315278e-4 * t59 * t64 * t214 - 0.45575390224706456708e-8 * t527 * t60 * t1018 * t534;
  t1030 = 0.1e1 / t81;
  t1041 = -0.4753125e-1 * t33 * t1030 * t37 + 0.6609624089168128059e-2 * t380 * t82 - 0.52083333333333333334e-2 * t59 * t64 + 0.61035156250000000002e-3 * t88 * t34 * t92;
  t1046 = t58 * t64 * t76;
  t1049 = -t1041;
  t1058 = my_piecewise3(t74, -0.10405183990595344389e-3 * t59 * t64 * t76, t1041 * t78 + 0.18292914397043087775e-1 * t867 * t395 - 0.10405183990595344389e-3 * t573 * t1046 + t1049 * t73 + 0.1292832e1 * t881 * t374 - 0.1292832e1 * t582 * t1003 + 0.646416e0 * t249 * t1023);
  t1059 = my_piecewise3(t41, -0.1292832e1 * t494 * t1003 + 0.646416e0 * t198 * t1023, t1058);
  t1063 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1059);
  tv2sigma20 = t6 * t1063;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1064 = t421 * t421;
  t1070 = t513 * sigma[2];
  t1071 = 0.1e1 / t731;
  t1079 = 0.1e1 / t124 / t732;
  t1084 = -0.33353535639257052042e-3 * t59 * t139 * t131 + 0.41691919549071315052e-4 * t1070 * t1071 * t131 + 0.27560657413756315278e-4 * t59 * t139 * t314 - 0.45575390224706456708e-8 * t527 * t135 * t1079 * t746;
  t1091 = 0.1e1 / t156;
  t1102 = -0.4753125e-1 * t33 * t1091 * t118 + 0.6609624089168128059e-2 * t427 * t157 - 0.52083333333333333334e-2 * t59 * t139 + 0.61035156250000000002e-3 * t88 * t115 * t164;
  t1107 = t58 * t139 * t151;
  t1110 = -t1102;
  t1119 = my_piecewise3(t149, -0.10405183990595344389e-3 * t59 * t139 * t151, t1102 * t153 + 0.18292914397043087775e-1 * t970 * t442 - 0.10405183990595344389e-3 * t785 * t1107 + t1110 * t148 + 0.1292832e1 * t984 * t421 - 0.1292832e1 * t794 * t1064 + 0.646416e0 * t349 * t1084);
  t1120 = my_piecewise3(t122, -0.1292832e1 * t711 * t1064 + 0.646416e0 * t298 * t1084, t1119);
  t1124 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t1120);
  tv2sigma25 = t6 * t1124;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1128 = 0.1e1 / t458 / t19;
  t1129 = t460 * t183;
  t1132 = t459 * t183;
  t1135 = t179 * t179;
  t1136 = 0.1e1 / t1135;
  t1137 = t16 * t1136;
  t1139 = 0.6e1 * t464 - 0.6e1 * t1137;
  t1140 = my_piecewise5(t10, 0, t14, 0, t1139);
  t1144 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1128 * t1129 + 0.4e1 / 0.3e1 * t1132 * t468 + 0.4e1 / 0.3e1 * t23 * t1140);
  t1145 = t1144 * t26;
  t1149 = t472 * t192;
  t1151 = t5 * t1149 * t102;
  t1156 = t186 * t485;
  t1158 = t5 * t1156 * t102;
  t1161 = t5 * t477 * t254;
  t1167 = 0.1e1 / t191 / t179;
  t1168 = t25 * t1167;
  t1171 = 0.5e1 / 0.36e2 * t5 * t1168 * t102;
  t1173 = t5 * t486 * t254;
  t1176 = t5 * t193 * t589;
  t1178 = t197 * t197;
  t1179 = 0.1e1 / t1178;
  t1180 = t495 * t218;
  t1183 = t494 * t218;
  t1187 = 0.1e1 / t46 / t62;
  t1188 = sigma[0] * t1187;
  t1189 = t44 * t1188;
  t1195 = 0.1e1 / t35 / t516;
  t1196 = t60 * t1195;
  t1200 = 0.1e1 / t836;
  t1204 = t513 * t528;
  t1205 = t516 * t62;
  t1207 = 0.1e1 / t46 / t1205;
  t1209 = t44 * t53;
  t1219 = t528 * t60;
  t1220 = t516 * t516;
  t1222 = 0.1e1 / t1220 / t199;
  t1225 = 0.1e1 / t533 / t68;
  t1228 = -0.154e4 / 0.6561e4 * t1189 - 0.1826291373669541694e0 * t44 * t1188 * t53 + 0.33699424156997495545e-1 * t59 * t1196 * t53 - 0.56330415746300799004e-2 * t515 * t1200 * t53 + 0.32941763594327952634e-4 * t1204 * t1207 * t1209 - 0.34134384589481895663e-2 * t59 * t1196 * t214 + 0.61577416125825612618e-6 * t527 * t528 * t1207 * t534 - 0.3012370804988962832e-14 * t1219 * t1222 * t1225;
  t1232 = t1188 * t76;
  t1235 = t1196 * t76;
  t1243 = 0.1e1 / t35 / t61;
  t1248 = 0.1e1 / t235;
  t1254 = 0.1e1 / t46 / t828;
  t1258 = -0.19716666666666666667e1 * t33 * t34 * t1243 + 0.88977777777777777779e1 * t1189 - 0.10575398542669004894e1 * t81 * t1248 + 0.6450617283950617284e0 * t59 * t1196 - 0.72096836419753086424e-1 * t88 * t89 * t1254;
  t1260 = t565 * t28;
  t1261 = t1260 * t43;
  t1266 = t241 * t29;
  t1267 = t1266 * t58;
  t1274 = t96 * t514;
  t1275 = t1200 * t76;
  t1278 = -t1258;
  t1280 = t577 * t198;
  t1283 = t247 * t494;
  t1288 = t98 * t1179;
  t1291 = t218 * t538;
  t1296 = t1258 * t78 - 0.731716575881723511e-1 * t1261 * t221 + 0.2682960778232986207e0 * t568 * t542 - 0.22197725846603401364e-2 * t1267 * t545 - 0.41734945439179785442e0 * t244 * t1232 + 0.81391661437545805002e-2 * t574 * t1235 - 0.13826255501780643787e-5 * t1274 * t1275 + t1278 * t73 + 0.1939248e1 * t1280 * t218 - 0.3878496e1 * t1283 * t495 + 0.1939248e1 * t579 * t538 + 0.3878496e1 * t1288 * t1180 - 0.3878496e1 * t582 * t1291 + 0.646416e0 * t249 * t1228;
  t1297 = my_piecewise3(t74, -0.41734945439179785442e0 * t44 * t1232 + 0.81391661437545805002e-2 * t59 * t1235 - 0.13826255501780643787e-5 * t514 * t1200 * t76, t1296);
  t1298 = my_piecewise3(t41, 0.3878496e1 * t1179 * t1180 - 0.3878496e1 * t1183 * t538 + 0.646416e0 * t198 * t1228, t1297);
  t1303 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1145 * t102 - 0.3e1 / 0.8e1 * t1151 - 0.9e1 / 0.8e1 * t5 * t473 * t254 + t1158 / 0.4e1 - 0.3e1 / 0.4e1 * t1161 - 0.9e1 / 0.8e1 * t5 * t187 * t589 - t1171 + t1173 / 0.4e1 - 0.3e1 / 0.8e1 * t1176 - 0.3e1 / 0.8e1 * t5 * t27 * t1298);
  t1305 = 0.1e1 / t595 / t109;
  t1306 = t597 * t261;
  t1309 = t596 * t261;
  t1313 = my_piecewise5(t14, 0, t10, 0, -t1139);
  t1317 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1305 * t1306 + 0.4e1 / 0.3e1 * t1309 * t601 + 0.4e1 / 0.3e1 * t111 * t1313);
  t1318 = t1317 * t26;
  t1322 = t605 * t192;
  t1324 = t5 * t1322 * t174;
  t1326 = t264 * t485;
  t1328 = t5 * t1326 * t174;
  t1330 = t113 * t1167;
  t1333 = 0.5e1 / 0.36e2 * t5 * t1330 * t174;
  t1335 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1318 * t174 - 0.3e1 / 0.8e1 * t1324 + t1328 / 0.4e1 - t1333);
  tv3rho30 = 0.3e1 * t594 + 0.3e1 * t619 + t6 * (t1303 + t1335);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1338 = 0.2e1 * t645;
  t1339 = 0.2e1 * t670;
  t1340 = t1128 * t278;
  t1343 = t459 * t626;
  t1348 = 0.2e1 * t464;
  t1349 = 0.6e1 * t1137;
  t1350 = t1348 - t1349;
  t1351 = my_piecewise5(t10, 0, t14, 0, t1350);
  t1355 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1340 * t460 + 0.8e1 / 0.9e1 * t1343 * t183 + 0.4e1 / 0.9e1 * t622 * t468 + 0.4e1 / 0.3e1 * t23 * t1351);
  t1356 = t1355 * t26;
  t1360 = t630 * t192;
  t1363 = t5 * t1360 * t102 / 0.4e1;
  t1367 = t281 * t485;
  t1369 = t5 * t1367 * t102;
  t1373 = t5 * t635 * t254 / 0.4e1;
  t1382 = -0.3e1 / 0.8e1 * t5 * t1356 * t102 - t1363 - 0.3e1 / 0.4e1 * t5 * t631 * t254 + t1369 / 0.12e2 - t1373 - 0.3e1 / 0.8e1 * t5 * t282 * t589 - t1151 / 0.8e1 + t1158 / 0.6e1 - t1161 / 0.4e1 - t1171 + t1173 / 0.6e1 - t1176 / 0.8e1;
  t1383 = my_piecewise3(t1, 0, t1382);
  t1384 = t1305 * t289;
  t1387 = t596 * t649;
  t1393 = my_piecewise5(t14, 0, t10, 0, -t1350);
  t1397 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1384 * t597 + 0.8e1 / 0.9e1 * t1387 * t261 + 0.4e1 / 0.9e1 * t646 * t601 + 0.4e1 / 0.3e1 * t111 * t1393);
  t1398 = t1397 * t26;
  t1402 = t653 * t192;
  t1405 = t5 * t1402 * t174 / 0.4e1;
  t1406 = t292 * t485;
  t1408 = t5 * t1406 * t174;
  t1417 = t5 * t610 * t354 / 0.4e1;
  t1419 = t5 * t614 * t354;
  t1422 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1398 * t174 - t1405 + t1408 / 0.12e2 - t1324 / 0.8e1 + t1328 / 0.6e1 - t1333 - 0.3e1 / 0.8e1 * t5 * t606 * t354 - t1417 + t1419 / 0.12e2);
  tv3rho31 = t594 + t619 + t1338 + t1339 + t6 * (t1383 + t1422);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1425 = t1128 * t675;
  t1430 = t459 * t680;
  t1433 = -t1348 - t1349;
  t1434 = my_piecewise5(t10, 0, t14, 0, t1433);
  t1438 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1425 * t183 + 0.8e1 / 0.9e1 * t622 * t626 + 0.4e1 / 0.9e1 * t1430 * t183 + 0.4e1 / 0.3e1 * t23 * t1434);
  t1439 = t1438 * t26;
  t1443 = t684 * t192;
  t1445 = t5 * t1443 * t102;
  t1454 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1439 * t102 - t1445 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t685 * t254 - t1363 + t1369 / 0.6e1 - t1373 + t1158 / 0.12e2 - t1171 + t1173 / 0.12e2);
  t1455 = t1305 * t692;
  t1460 = t596 * t696;
  t1464 = my_piecewise5(t14, 0, t10, 0, -t1433);
  t1468 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1455 * t261 + 0.8e1 / 0.9e1 * t646 * t649 + 0.4e1 / 0.9e1 * t1460 * t261 + 0.4e1 / 0.3e1 * t111 * t1464);
  t1469 = t1468 * t26;
  t1473 = t700 * t192;
  t1475 = t5 * t1473 * t174;
  t1482 = t5 * t658 * t354;
  t1490 = t5 * t269 * t801;
  t1492 = -0.3e1 / 0.8e1 * t5 * t1469 * t174 - t1475 / 0.8e1 - t1405 + t1408 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t654 * t354 - t1482 / 0.4e1 + t1328 / 0.12e2 - t1333 - t1417 + t1419 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t265 * t801 - t1490 / 0.8e1;
  t1493 = my_piecewise3(t107, 0, t1492);
  tv3rho32 = t1338 + t1339 + t691 + t806 + t6 * (t1454 + t1493);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1498 = t675 * t278;
  t1504 = -0.6e1 * t464 - 0.6e1 * t1137;
  t1505 = my_piecewise5(t10, 0, t14, 0, t1504);
  t1509 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1128 * t1498 + 0.4e1 / 0.3e1 * t622 * t680 + 0.4e1 / 0.3e1 * t23 * t1505);
  t1510 = t1509 * t26;
  t1517 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1510 * t102 - 0.3e1 / 0.8e1 * t1445 + t1369 / 0.4e1 - t1171);
  t1518 = t692 * t289;
  t1524 = my_piecewise5(t14, 0, t10, 0, -t1504);
  t1528 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1305 * t1518 + 0.4e1 / 0.3e1 * t646 * t696 + 0.4e1 / 0.3e1 * t111 * t1524);
  t1529 = t1528 * t26;
  t1544 = t297 * t297;
  t1545 = 0.1e1 / t1544;
  t1546 = t712 * t318;
  t1549 = t711 * t318;
  t1553 = 0.1e1 / t124 / t137;
  t1554 = sigma[2] * t1553;
  t1555 = t44 * t1554;
  t1561 = 0.1e1 / t116 / t731;
  t1562 = t135 * t1561;
  t1566 = 0.1e1 / t939;
  t1570 = t513 * t740;
  t1571 = t731 * t137;
  t1573 = 0.1e1 / t124 / t1571;
  t1575 = t44 * t131;
  t1585 = t740 * t135;
  t1586 = t731 * t731;
  t1588 = 0.1e1 / t1586 / t299;
  t1591 = 0.1e1 / t745 / t143;
  t1594 = -0.154e4 / 0.6561e4 * t1555 - 0.1826291373669541694e0 * t44 * t1554 * t131 + 0.33699424156997495545e-1 * t59 * t1562 * t131 - 0.56330415746300799004e-2 * t730 * t1566 * t131 + 0.32941763594327952634e-4 * t1570 * t1573 * t1575 - 0.34134384589481895663e-2 * t59 * t1562 * t314 + 0.61577416125825612618e-6 * t527 * t740 * t1573 * t746 - 0.3012370804988962832e-14 * t1585 * t1588 * t1591;
  t1598 = t1554 * t151;
  t1601 = t1562 * t151;
  t1609 = 0.1e1 / t116 / t136;
  t1614 = 0.1e1 / t335;
  t1620 = 0.1e1 / t124 / t931;
  t1624 = -0.19716666666666666667e1 * t33 * t115 * t1609 + 0.88977777777777777779e1 * t1555 - 0.10575398542669004894e1 * t156 * t1614 + 0.6450617283950617284e0 * t59 * t1562 - 0.72096836419753086424e-1 * t88 * t161 * t1620;
  t1626 = t777 * t28;
  t1627 = t1626 * t43;
  t1632 = t341 * t29;
  t1633 = t1632 * t58;
  t1640 = t168 * t729;
  t1641 = t1566 * t151;
  t1644 = -t1624;
  t1646 = t789 * t298;
  t1649 = t347 * t711;
  t1654 = t170 * t1545;
  t1657 = t318 * t750;
  t1662 = t1624 * t153 - 0.731716575881723511e-1 * t1627 * t321 + 0.2682960778232986207e0 * t780 * t754 - 0.22197725846603401364e-2 * t1633 * t757 - 0.41734945439179785442e0 * t344 * t1598 + 0.81391661437545805002e-2 * t786 * t1601 - 0.13826255501780643787e-5 * t1640 * t1641 + t1644 * t148 + 0.1939248e1 * t1646 * t318 - 0.3878496e1 * t1649 * t712 + 0.1939248e1 * t791 * t750 + 0.3878496e1 * t1654 * t1546 - 0.3878496e1 * t794 * t1657 + 0.646416e0 * t349 * t1594;
  t1663 = my_piecewise3(t149, -0.41734945439179785442e0 * t44 * t1598 + 0.81391661437545805002e-2 * t59 * t1601 - 0.13826255501780643787e-5 * t729 * t1566 * t151, t1662);
  t1664 = my_piecewise3(t122, 0.3878496e1 * t1545 * t1546 - 0.3878496e1 * t1549 * t750 + 0.646416e0 * t298 * t1594, t1663);
  t1669 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1529 * t174 - 0.3e1 / 0.8e1 * t1475 - 0.9e1 / 0.8e1 * t5 * t701 * t354 + t1408 / 0.4e1 - 0.3e1 / 0.4e1 * t1482 - 0.9e1 / 0.8e1 * t5 * t293 * t801 - t1333 + t1419 / 0.4e1 - 0.3e1 / 0.8e1 * t1490 - 0.3e1 / 0.8e1 * t5 * t114 * t1664);
  tv3rho33 = 0.3e1 * t691 + 0.3e1 * t806 + t6 * (t1517 + t1669);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1677 = t5 * t477 * t404;
  t1684 = t5 * t486 * t404 / 0.12e2;
  t1686 = t5 * t193 * t893;
  t1688 = t1179 * t374;
  t1691 = t494 * t843;
  t1696 = t44 * t499;
  t1701 = t507 * sigma[0];
  t1705 = t513 * t518;
  t1706 = t60 * t53;
  t1719 = t528 * sigma[0];
  t1721 = 0.1e1 / t1220 / t45;
  t1725 = 0.11e3 / 0.2187e4 * t1696 + 0.39134815150061607728e-1 * t44 * t499 * t53 - 0.96354658513409261456e-2 * t59 * t1701 * t53 + 0.18900336862245662824e-2 * t1705 * t1706 - 0.12353161347872982238e-4 * t515 * t531 * t1209 + 0.93093776153132442719e-3 * t59 * t1701 * t214 - 0.20660843568533593707e-6 * t527 * t514 * t531 * t534 + 0.1129639051870861062e-14 * t1719 * t1721 * t1225;
  t1732 = t1701 * t76;
  t1739 = t865 * t28;
  t1740 = t1739 * t43;
  t1743 = t392 * t29;
  t1744 = t1743 * t58;
  t1752 = t43 * t499 * t76;
  t1768 = -0.29575e0 * t33 * t380 * t550 + 0.19066666666666666667e1 * t1696 - 0.26438496356672512236e0 * t34 * t555 + 0.17592592592592592593e0 * t59 * t1701 - 0.20797164351851851853e-1 * t88 * t81 * t561;
  t1770 = -t1768;
  t1774 = t879 * t198;
  t1784 = t374 * t495;
  t1789 = t843 * t218;
  t1792 = t374 * t538;
  t1795 = t96 * t518;
  t1796 = t60 * t76;
  t1799 = t398 * t494;
  t1806 = 0.646416e0 * t881 * t538 + 0.646416e0 * t1280 * t374 + 0.1292832e1 * t579 * t843 + 0.3878496e1 * t1288 * t1784 + 0.91464571985215438873e-2 * t1260 * t395 - 0.2585664e1 * t582 * t1789 - 0.1292832e1 * t582 * t1792 + 0.51848458131677414201e-6 * t1795 * t1796 - 0.1292832e1 * t1799 * t495 - 0.2585664e1 * t1283 * t886 + 0.89432025941099540233e-1 * t868 * t542;
  t1808 = my_piecewise3(t74, 0.8943202594109954023e-1 * t44 * t499 * t76 - 0.24972441577428826534e-2 * t59 * t1732 + 0.51848458131677414201e-6 * t518 * t60 * t76, -0.487811050587815674e-1 * t1740 * t221 - 0.73992419488678004547e-3 * t1744 * t545 - 0.48781105058781567398e-1 * t567 * t874 + 0.5549431461650850341e-3 * t1267 * t850 + 0.8943202594109954023e-1 * t243 * t1752 - 0.24972441577428826534e-2 * t574 * t1732 + t1768 * t73 + t1770 * t78 + 0.646416e0 * t249 * t1725 + 0.1292832e1 * t1774 * t218 + t1806);
  t1809 = my_piecewise3(t41, 0.3878496e1 * t1688 * t495 - 0.2585664e1 * t1691 * t218 - 0.1292832e1 * t815 * t538 + 0.646416e0 * t198 * t1725, t1808);
  t1814 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t473 * t404 - t1677 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t187 * t893 + t1684 - t1686 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1809);
  tv3rho2sigma0 = t6 * t1814 + 0.2e1 * t898;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1821 = t5 * t610 * t451;
  t1825 = t5 * t614 * t451 / 0.12e2;
  t1827 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t606 * t451 - t1821 / 0.4e1 + t1825);
  tv3rho2sigma2 = t6 * t1827 + 0.2e1 * t907;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1833 = t5 * t635 * t404;
  t1841 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t631 * t404 - t1833 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t282 * t893 - t1677 / 0.8e1 + t1684 - t1686 / 0.8e1);
  tv3rho2sigma3 = t6 * t1841 + t898 + t913;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1847 = t5 * t658 * t451;
  t1854 = t5 * t269 * t996;
  t1857 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t654 * t451 - t1847 / 0.8e1 - t1821 / 0.8e1 + t1825 - 0.3e1 / 0.8e1 * t5 * t265 * t996 - t1854 / 0.8e1);
  tv3rho2sigma5 = t6 * t1857 + t1001 + t907;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1865 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t685 * t404 - t1833 / 0.4e1 + t1684);
  tv3rho2sigma6 = t6 * t1865 + 0.2e1 * t913;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1876 = t1545 * t421;
  t1879 = t711 * t946;
  t1884 = t44 * t716;
  t1889 = t724 * sigma[2];
  t1893 = t513 * t733;
  t1894 = t135 * t131;
  t1907 = t740 * sigma[2];
  t1909 = 0.1e1 / t1586 / t123;
  t1913 = 0.11e3 / 0.2187e4 * t1884 + 0.39134815150061607728e-1 * t44 * t716 * t131 - 0.96354658513409261456e-2 * t59 * t1889 * t131 + 0.18900336862245662824e-2 * t1893 * t1894 - 0.12353161347872982238e-4 * t730 * t743 * t1575 + 0.93093776153132442719e-3 * t59 * t1889 * t314 - 0.20660843568533593707e-6 * t527 * t729 * t743 * t746 + 0.1129639051870861062e-14 * t1907 * t1909 * t1591;
  t1920 = t1889 * t151;
  t1927 = t982 * t298;
  t1940 = t421 * t712;
  t1956 = -0.29575e0 * t33 * t427 * t762 + 0.19066666666666666667e1 * t1884 - 0.26438496356672512236e0 * t115 * t767 + 0.17592592592592592593e0 * t59 * t1889 - 0.20797164351851851853e-1 * t88 * t156 * t773;
  t1958 = -t1956;
  t1962 = t43 * t716 * t151;
  t1967 = t968 * t28;
  t1968 = t1967 * t43;
  t1971 = t439 * t29;
  t1972 = t1971 * t58;
  t1981 = t946 * t318;
  t1984 = t421 * t750;
  t1987 = t168 * t733;
  t1988 = t135 * t151;
  t1991 = t445 * t711;
  t1994 = 0.8943202594109954023e-1 * t343 * t1962 - 0.24972441577428826534e-2 * t786 * t1920 - 0.487811050587815674e-1 * t1968 * t321 - 0.73992419488678004547e-3 * t1972 * t757 - 0.48781105058781567398e-1 * t779 * t977 + 0.5549431461650850341e-3 * t1633 * t953 - 0.2585664e1 * t1649 * t989 - 0.2585664e1 * t794 * t1981 - 0.1292832e1 * t794 * t1984 + 0.51848458131677414201e-6 * t1987 * t1988 - 0.1292832e1 * t1991 * t712;
  t1996 = my_piecewise3(t149, 0.8943202594109954023e-1 * t44 * t716 * t151 - 0.24972441577428826534e-2 * t59 * t1920 + 0.51848458131677414201e-6 * t733 * t135 * t151, 0.1292832e1 * t1927 * t318 + 0.646416e0 * t984 * t750 + 0.646416e0 * t1646 * t421 + 0.1292832e1 * t791 * t946 + 0.646416e0 * t349 * t1913 + 0.89432025941099540233e-1 * t971 * t754 + 0.3878496e1 * t1654 * t1940 + 0.91464571985215438873e-2 * t1626 * t442 + t1956 * t148 + t1958 * t153 + t1994);
  t1997 = my_piecewise3(t122, 0.3878496e1 * t1876 * t712 - 0.2585664e1 * t1879 * t318 - 0.1292832e1 * t918 * t750 + 0.646416e0 * t298 * t1913, t1996);
  t2002 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t701 * t451 - t1847 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t293 * t996 + t1825 - t1854 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t1997);
  tv3rho2sigma8 = t6 * t2002 + 0.2e1 * t1001;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2009 = t5 * t193 * t1059 / 0.8e1;
  t2010 = t1179 * t1003;
  t2015 = t494 * t1023;
  t2021 = t513 * t829;
  t2022 = sigma[0] * t53;
  t2031 = t838 * t534;
  t2035 = t1220 * rho[0];
  t2036 = 0.1e1 / t2035;
  t2040 = 0.17788552340937094422e-2 * t59 * t209 * t53 - 0.5558922606542842007e-3 * t2021 * t2022 + 0.46324355054523683391e-5 * t827 * t838 * t1209 - 0.14699017287336701482e-3 * t59 * t209 * t214 + 0.60767186966275275611e-7 * t527 * t2031 * t60 - 0.42361464445157289826e-15 * t528 * t2036 * t1225;
  t2061 = 0.63375e-1 * t33 * t1030 * t225 - 0.26438496356672512236e-1 * t380 * t230 + 0.27777777777777777778e-1 * t59 * t209 - 0.40690104166666666668e-2 * t88 * t34 * t237;
  t2063 = t1041 * t28;
  t2064 = t2063 * t43;
  t2076 = t58 * t209 * t76;
  t2079 = t96 * t829;
  t2080 = sigma[0] * t76;
  t2083 = -t2061;
  t2085 = t1049 * t198;
  t2096 = t1003 * t218;
  t2099 = t374 * t843;
  t2104 = t1023 * t218;
  t2109 = t2061 * t78 - 0.243905525293907837e-1 * t2064 * t221 + 0.18292914397043087775e-1 * t1739 * t395 - 0.487811050587815674e-1 * t867 * t874 + 0.55494314616508503411e-3 * t1744 * t850 - 0.10405183990595344389e-3 * t1266 * t1046 + 0.55494314616508503408e-3 * t573 * t2076 - 0.19443171799379030325e-6 * t2079 * t2080 + t2083 * t73 + 0.646416e0 * t2085 * t218 + 0.1292832e1 * t1774 * t374 - 0.2585664e1 * t1799 * t886 + 0.1292832e1 * t881 * t843 - 0.1292832e1 * t1283 * t1003 + 0.3878496e1 * t1288 * t2096 - 0.2585664e1 * t582 * t2099 + 0.646416e0 * t579 * t1023 - 0.1292832e1 * t582 * t2104 + 0.646416e0 * t249 * t2040;
  t2110 = my_piecewise3(t74, 0.55494314616508503408e-3 * t59 * t209 * t76 - 0.19443171799379030325e-6 * t829 * sigma[0] * t76, t2109);
  t2111 = my_piecewise3(t41, 0.3878496e1 * t2010 * t218 - 0.2585664e1 * t815 * t843 - 0.1292832e1 * t2015 * t218 + 0.646416e0 * t198 * t2040, t2110);
  t2116 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t187 * t1059 - t2009 - 0.3e1 / 0.8e1 * t5 * t27 * t2111);
  tv3rhosigma20 = t6 * t2116 + t1063;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2123 = t5 * t269 * t1120 / 0.8e1;
  t2125 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t265 * t1120 - t2123);
  tv3rhosigma25 = t6 * t2125 + t1124;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2131 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t1059 - t2009);
  tv3rhosigma26 = t6 * t2131 + t1063;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2136 = t1545 * t1064;
  t2141 = t711 * t1084;
  t2147 = t513 * t932;
  t2148 = sigma[2] * t131;
  t2157 = t941 * t746;
  t2161 = t1586 * rho[1];
  t2162 = 0.1e1 / t2161;
  t2166 = 0.17788552340937094422e-2 * t59 * t309 * t131 - 0.5558922606542842007e-3 * t2147 * t2148 + 0.46324355054523683391e-5 * t930 * t941 * t1575 - 0.14699017287336701482e-3 * t59 * t309 * t314 + 0.60767186966275275611e-7 * t527 * t2157 * t135 - 0.42361464445157289826e-15 * t740 * t2162 * t1591;
  t2187 = 0.63375e-1 * t33 * t1091 * t325 - 0.26438496356672512236e-1 * t427 * t330 + 0.27777777777777777778e-1 * t59 * t309 - 0.40690104166666666668e-2 * t88 * t115 * t337;
  t2189 = t1102 * t28;
  t2190 = t2189 * t43;
  t2202 = t58 * t309 * t151;
  t2205 = t168 * t932;
  t2206 = sigma[2] * t151;
  t2209 = -t2187;
  t2211 = t1110 * t298;
  t2222 = t1064 * t318;
  t2225 = t421 * t946;
  t2230 = t1084 * t318;
  t2235 = t2187 * t153 - 0.243905525293907837e-1 * t2190 * t321 + 0.18292914397043087775e-1 * t1967 * t442 - 0.487811050587815674e-1 * t970 * t977 + 0.55494314616508503411e-3 * t1972 * t953 - 0.10405183990595344389e-3 * t1632 * t1107 + 0.55494314616508503408e-3 * t785 * t2202 - 0.19443171799379030325e-6 * t2205 * t2206 + t2209 * t148 + 0.646416e0 * t2211 * t318 + 0.1292832e1 * t1927 * t421 - 0.2585664e1 * t1991 * t989 + 0.1292832e1 * t984 * t946 - 0.1292832e1 * t1649 * t1064 + 0.3878496e1 * t1654 * t2222 - 0.2585664e1 * t794 * t2225 + 0.646416e0 * t791 * t1084 - 0.1292832e1 * t794 * t2230 + 0.646416e0 * t349 * t2166;
  t2236 = my_piecewise3(t149, 0.55494314616508503408e-3 * t59 * t309 * t151 - 0.19443171799379030325e-6 * t932 * sigma[2] * t151, t2235);
  t2237 = my_piecewise3(t122, 0.3878496e1 * t2136 * t318 - 0.2585664e1 * t918 * t946 - 0.1292832e1 * t2141 * t318 + 0.646416e0 * t298 * t2166, t2236);
  t2242 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t293 * t1120 - t2123 - 0.3e1 / 0.8e1 * t5 * t114 * t2237);
  tv3rhosigma211 = t6 * t2242 + t1124;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2244 = t1003 * t374;
  t2255 = t1018 * t534;
  t2259 = 0.1e1 / t1220;
  t2263 = 0.12507575864721394516e-3 * t513 * t1010 * t53 - 0.17371633145446381272e-5 * t1009 * t1018 * t1209 - 0.13672617067411937012e-7 * t527 * t2255 * sigma[0] + 0.15885549166933983685e-15 * t514 * t2259 * t1225;
  t2269 = 0.1e1 / t89;
  t2278 = 0.71296875e-1 * t33 * t2269 * t37 - 0.33048120445840640295e-2 * t1030 * t82 + 0.30517578125000000001e-3 * t88 * t380 * t92;
  t2287 = -t2278;
  t2297 = t374 * t1023;
  t2302 = t2278 * t78 + 0.27439371595564631662e-1 * t2063 * t395 - 0.31215551971786033168e-3 * t1743 * t1046 + 0.72911894247671363718e-7 * t96 * t1010 * t76 + t2287 * t73 + 0.1939248e1 * t2085 * t374 - 0.3878496e1 * t1799 * t1003 + 0.1939248e1 * t881 * t1023 + 0.3878496e1 * t1288 * t2244 - 0.3878496e1 * t582 * t2297 + 0.646416e0 * t249 * t2263;
  t2303 = my_piecewise3(t74, 0.72911894247671363718e-7 * t1010 * t76, t2302);
  t2304 = my_piecewise3(t41, 0.3878496e1 * t1179 * t2244 - 0.3878496e1 * t815 * t1023 + 0.646416e0 * t198 * t2263, t2303);
  t2308 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2304);
  tv3sigma30 = t6 * t2308;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2309 = t1064 * t421;
  t2320 = t1079 * t746;
  t2324 = 0.1e1 / t1586;
  t2328 = 0.12507575864721394516e-3 * t513 * t1071 * t131 - 0.17371633145446381272e-5 * t1070 * t1079 * t1575 - 0.13672617067411937012e-7 * t527 * t2320 * sigma[2] + 0.15885549166933983685e-15 * t729 * t2324 * t1591;
  t2334 = 0.1e1 / t161;
  t2343 = 0.71296875e-1 * t33 * t2334 * t118 - 0.33048120445840640295e-2 * t1091 * t157 + 0.30517578125000000001e-3 * t88 * t427 * t164;
  t2352 = -t2343;
  t2362 = t421 * t1084;
  t2367 = t2343 * t153 + 0.27439371595564631662e-1 * t2189 * t442 - 0.31215551971786033168e-3 * t1971 * t1107 + 0.72911894247671363718e-7 * t168 * t1071 * t151 + t2352 * t148 + 0.1939248e1 * t2211 * t421 - 0.3878496e1 * t1991 * t1064 + 0.1939248e1 * t984 * t1084 + 0.3878496e1 * t1654 * t2309 - 0.3878496e1 * t794 * t2362 + 0.646416e0 * t349 * t2328;
  t2368 = my_piecewise3(t149, 0.72911894247671363718e-7 * t1071 * t151, t2367);
  t2369 = my_piecewise3(t122, 0.3878496e1 * t1545 * t2309 - 0.3878496e1 * t918 * t1084 + 0.646416e0 * t298 * t2328, t2368);
  t2373 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t2369);
  tv3sigma39 = t6 * t2373;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t33, t34, t35, t37, t39, t40, t41;
  double t42, t43, t44, t45, t46, t48, t49, t50;
  double t53, t58, t59, t60, t61, t62, t64, t66;
  double t68, t69, t70, t73, t74, t76, t78, t79;
  double t80, t81, t82, t84, t85, t88, t89, t90;
  double t92, t95, t96, t98, t101, t102, t106, t107;
  double t108, t109, t110, t111, t113, t114, t115, t116;
  double t118, t120, t121, t122, t123, t124, t126, t127;
  double t128, t131, t135, t136, t137, t139, t141, t143;
  double t144, t145, t148, t149, t151, t153, t154, t155;
  double t156, t157, t159, t160, t161, t162, t164, t167;
  double t168, t170, t173, t174, t178, tzk0;

  double t179, t180, t181, t182, t183, t186, t187, t191;
  double t192, t193, t196, t197, t198, t199, t201, t202;
  double t203, t209, t210, t214, t218, t221, t225, t230;
  double t235, t237, t241, t243, t244, t247, t249, t253;
  double t254, t259, t261, t264, t265, t269, t272, t274;
  double tvrho0, t277, t278, t281, t282, t287, t289, t292;
  double t293, t297, t298, t299, t301, t302, t303, t309;
  double t310, t314, t318, t321, t325, t330, t335, t337;
  double t341, t343, t344, t347, t349, t353, t354, t359;
  double tvrho1, t362, t367, t374, t380, t392, t395, t398;
  double t403, t404, t408, tvsigma0, tvsigma1, t409, t414, t421;
  double t427, t439, t442, t445, t450, t451, t455, tvsigma2;

  double t458, t459, t460, t463, t464, t465, t467, t468;
  double t472, t473, t477, t479, t485, t486, t489, t491;
  double t494, t495, t499, t500, t501, t507, t508, t512;
  double t513, t514, t515, t516, t517, t518, t527, t528;
  double t529, t531, t533, t534, t538, t542, t545, t550;
  double t555, t561, t565, t567, t568, t573, t574, t577;
  double t579, t582, t588, t589, t594, t595, t596, t597;
  double t601, t605, t606, t610, t612, t614, t617, t619;
  double tv2rho20, t622, t625, t626, t630, t631, t635, t637;
  double t645, t646, t649, t653, t654, t658, t660, t667;
  double t670, tv2rho21, t675, t679, t680, t684, t685, t691;
  double t692, t696, t700, t701, t711, t712, t716, t717;
  double t718, t724, t725, t729, t730, t731, t732, t733;
  double t740, t741, t743, t745, t746, t750, t754, t757;
  double t762, t767, t773, t777, t779, t780, t785, t786;
  double t789, t791, t794, t800, t801, t806, tv2rho22, t814;
  double t815, t818, t823, t827, t828, t829, t836, t838;
  double t843, t850, t865, t867, t868, t874, t879, t881;
  double t886, t892, t893, t898, tv2rhosigma0, tv2rhosigma1, t905, t907;
  double tv2rhosigma2, t913, tv2rhosigma3, tv2rhosigma4, t918, t921, t926, t930;
  double t931, t932, t939, t941, t946, t953, t968, t970;
  double t971, t977, t982, t984, t989, t995, t996, t1001;
  double tv2rhosigma5, t1003, t1009, t1010, t1018, t1023, t1030, t1041;
  double t1046, t1049, t1058, t1059, t1063, tv2sigma20, tv2sigma21, tv2sigma22;
  double tv2sigma23, tv2sigma24, t1064, t1070, t1071, t1079, t1084, t1091;
  double t1102, t1107, t1110, t1119, t1120, t1124, tv2sigma25;

  double t1128, t1129, t1132, t1135, t1136, t1137, t1139, t1140;
  double t1144, t1145, t1149, t1151, t1156, t1158, t1161, t1167;
  double t1168, t1171, t1173, t1176, t1178, t1179, t1180, t1183;
  double t1187, t1188, t1189, t1195, t1196, t1200, t1204, t1205;
  double t1207, t1209, t1219, t1220, t1222, t1225, t1228, t1232;
  double t1235, t1243, t1248, t1254, t1258, t1260, t1261, t1266;
  double t1267, t1274, t1275, t1278, t1280, t1283, t1288, t1291;
  double t1296, t1297, t1298, t1303, t1305, t1306, t1309, t1313;
  double t1317, t1318, t1322, t1324, t1326, t1328, t1330, t1333;
  double t1335, tv3rho30, t1338, t1339, t1340, t1343, t1348, t1349;
  double t1350, t1351, t1355, t1356, t1360, t1363, t1367, t1369;
  double t1373, t1382, t1383, t1384, t1387, t1393, t1397, t1398;
  double t1402, t1405, t1406, t1408, t1417, t1419, t1422, tv3rho31;
  double t1425, t1430, t1433, t1434, t1438, t1439, t1443, t1445;
  double t1454, t1455, t1460, t1464, t1468, t1469, t1473, t1475;
  double t1482, t1490, t1492, t1493, tv3rho32, t1498, t1504, t1505;
  double t1509, t1510, t1517, t1518, t1524, t1528, t1529, t1544;
  double t1545, t1546, t1549, t1553, t1554, t1555, t1561, t1562;
  double t1566, t1570, t1571, t1573, t1575, t1585, t1586, t1588;
  double t1591, t1594, t1598, t1601, t1609, t1614, t1620, t1624;
  double t1626, t1627, t1632, t1633, t1640, t1641, t1644, t1646;
  double t1649, t1654, t1657, t1662, t1663, t1664, t1669, tv3rho33;
  double t1677, t1684, t1686, t1688, t1691, t1696, t1701, t1705;
  double t1706, t1719, t1721, t1725, t1732, t1739, t1740, t1743;
  double t1744, t1752, t1768, t1770, t1774, t1784, t1789, t1792;
  double t1795, t1796, t1799, t1806, t1808, t1809, t1814, tv3rho2sigma0;
  double tv3rho2sigma1, t1821, t1825, t1827, tv3rho2sigma2, t1833, t1841, tv3rho2sigma3;
  double tv3rho2sigma4, t1847, t1854, t1857, tv3rho2sigma5, t1865, tv3rho2sigma6, tv3rho2sigma7;
  double t1876, t1879, t1884, t1889, t1893, t1894, t1907, t1909;
  double t1913, t1920, t1927, t1940, t1956, t1958, t1962, t1967;
  double t1968, t1971, t1972, t1981, t1984, t1987, t1988, t1991;
  double t1994, t1996, t1997, t2002, tv3rho2sigma8, t2009, t2010, t2015;
  double t2021, t2022, t2031, t2035, t2036, t2040, t2061, t2063;
  double t2064, t2076, t2079, t2080, t2083, t2085, t2096, t2099;
  double t2104, t2109, t2110, t2111, t2116, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22;
  double tv3rhosigma23, tv3rhosigma24, t2123, t2125, tv3rhosigma25, t2131, tv3rhosigma26, tv3rhosigma27;
  double tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t2136, t2141, t2147, t2148, t2157;
  double t2161, t2162, t2166, t2187, t2189, t2190, t2202, t2205;
  double t2206, t2209, t2211, t2222, t2225, t2230, t2235, t2236;
  double t2237, t2242, tv3rhosigma211, t2244, t2255, t2259, t2263, t2269;
  double t2278, t2287, t2297, t2302, t2303, t2304, t2308, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t2309, t2320, t2324, t2328, t2334, t2343, t2352, t2362;
  double t2367, t2368, t2369, t2373, tv3sigma39;

  double t2377, t2378, t2384, t2389, t2390, t2397, t2401, t2405;
  double t2407, t2415, t2421, t2430, t2435, t2438, t2441, t2445;
  double t2448, t2454, t2458, t2462, t2463, t2485, t2491, t2498;
  double t2499, t2510, t2513, t2530, t2532, t2533, t2538, t2541;
  double t2544, t2547, t2551, t2554, t2558, t2562, t2568, t2571;
  double t2575, t2577, t2578, t2584, t2591, t2593, t2594, t2598;
  double t2607, t2609, t2610, t2611, t2613, t2614, t2620, t2626;
  double t2630, t2637, t2641, t2645, t2650, t2652, tv4rho40, t2659;
  double t2663, t2667, t2668, t2673, t2674, t2676, t2679, t2700;
  double t2701, t2702, t2703, t2707, t2724, t2725, t2743, t2747;
  double t2754, t2758, t2759, t2762, t2771, t2774, t2775, t2777;
  double t2779, t2780, tv4rho41, t2798, t2811, t2815, t2824, t2828;
  double t2832, t2845, t2846, t2855, t2868, t2872, t2879, t2883;
  double t2892, t2895, t2906, t2909, t2911, t2912, tv4rho42, t2932;
  double t2933, t2937, t2944, t2955, t2956, t2973, t2977, t2984;
  double t2992, t3001, t3011, t3013, t3014, tv4rho43, t3019, t3024;
  double t3030, t3031, t3035, t3044, t3046, t3047, t3053, t3058;
  double t3059, t3066, t3070, t3074, t3076, t3084, t3090, t3099;
  double t3104, t3107, t3110, t3114, t3117, t3123, t3142, t3149;
  double t3154, t3165, t3169, t3172, t3176, t3177, t3194, t3199;
  double t3201, t3202, t3212, t3217, t3223, t3227, t3243, t3244;
  double tv4rho44, t3252, t3258, t3261, t3268, t3270, t3273, t3290;
  double t3295, t3314, t3328, t3335, t3402, t3404, t3421, t3425;
  double t3426, t3443, t3446, t3449, t3452, t3454, t3455, t3460;
  double tv4rho3sigma0, tv4rho3sigma1, t3467, t3470, t3474, t3476, tv4rho3sigma2, t3478;
  double t3484, t3489, t3493, t3502, t3503, tv4rho3sigma3, tv4rho3sigma4, t3505;
  double t3511, t3513, t3522, t3524, t3527, tv4rho3sigma5, t3533, t3542;
  double tv4rho3sigma6, tv4rho3sigma7, t3548, t3555, t3563, t3565, t3566, tv4rho3sigma8;
  double t3575, tv4rho3sigma9, tv4rho3sigma10, t3607, t3612, t3631, t3645, t3652;
  double t3719, t3721, t3732, t3740, t3741, t3748, t3763, t3766;
  double t3769, t3771, t3772, t3777, tv4rho3sigma11, t3784, t3791, t3793;
  double t3802, t3846, t3878, t3890, t3894, t3895, t3926, t3957;
  double t3968, t3977, t3980, t3981, t3986, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22;
  double tv4rho2sigma23, tv4rho2sigma24, t3993, t3997, t3999, tv4rho2sigma25, t4005, t4013;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t4019, t4026, t4029;
  double tv4rho2sigma211, t4037, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t4055;
  double t4099, t4125, t4129, t4130, t4141, t4177, t4208, t4219;
  double t4230, t4233, t4234, t4239, tv4rho2sigma217, t4246, t4265, t4286;
  double t4293, t4297, t4315, t4342, t4348, t4383, t4385, t4386;
  double t4391, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36;
  double tv4rhosigma37, tv4rhosigma38, t4398, t4400, tv4rhosigma39, t4406, tv4rhosigma310, tv4rhosigma311;
  double tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t4429;
  double t4450, t4457, t4461, t4479, t4494, t4507, t4547, t4549;
  double t4550, t4555, tv4rhosigma319, t4557, t4562, t4586, t4631, t4642;
  double t4643, t4644, t4648, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44;
  double tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412;
  double tv4sigma413, t4649, t4654, t4678, t4696, t4734, t4735, t4736;
  double t4740, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t33 = t29 / t31;
  t34 = sqrt(sigma[0]);
  t35 = POW_1_3(rho[0]);
  t37 = 0.1e1 / t35 / rho[0];
  t39 = t33 * t34 * t37;
  t40 = t39 / 0.12e2;
  t41 = t40 < 0.6e0;
  t42 = t31 * t31;
  t43 = 0.1e1 / t42;
  t44 = t28 * t43;
  t45 = rho[0] * rho[0];
  t46 = t35 * t35;
  t48 = 0.1e1 / t46 / t45;
  t49 = sigma[0] * t48;
  t50 = t44 * t49;
  t53 = exp(-t50 / 0.24e2);
  t58 = 0.1e1 / t31 / t30;
  t59 = t29 * t58;
  t60 = sigma[0] * sigma[0];
  t61 = t45 * t45;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t35 / t62;
  t66 = t59 * t60 * t64;
  t68 = 0.1e1 + 0.13780328706878157639e-4 * t66;
  t69 = log(t68);
  t70 = 0.804e0 + 0.5e1 / 0.972e3 * t50 + 0.4002424276710846245e-2 * t44 * t49 * t53 + t69;
  t73 = 0.1804e1 - 0.646416e0 / t70;
  t74 = 0.26e1 < t40;
  t76 = exp(-0.1137619054542480583e-1 * t50);
  t78 = 0.1804e1 - 0.804e0 * t76;
  t79 = 0.190125e0 * t39;
  t80 = 0.195e0 * t50;
  t81 = t34 * sigma[0];
  t82 = 0.1e1 / t61;
  t84 = 0.88128321188908374119e-2 * t81 * t82;
  t85 = 0.26041666666666666667e-2 * t66;
  t88 = t28 / t42 / t30;
  t89 = t34 * t60;
  t90 = t61 * t45;
  t92 = 0.1e1 / t46 / t90;
  t95 = 0.16276041666666666667e-3 * t88 * t89 * t92;
  t96 = -0.40608e0 + t79 - t80 + t84 - t85 + t95;
  t98 = 0.140608e1 - t79 + t80 - t84 + t85 - t95;
  t101 = my_piecewise3(t74, t78, t98 * t73 + t96 * t78);
  t102 = my_piecewise3(t41, t73, t101);
  t106 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t102);
  t107 = rho[1] <= p->dens_threshold;
  t108 = my_piecewise5(t14, t11, t10, t15, -t17);
  t109 = 0.1e1 + t108;
  t110 = t109 <= p->zeta_threshold;
  t111 = POW_1_3(t109);
  t113 = my_piecewise3(t110, t22, t111 * t109);
  t114 = t113 * t26;
  t115 = sqrt(sigma[2]);
  t116 = POW_1_3(rho[1]);
  t118 = 0.1e1 / t116 / rho[1];
  t120 = t33 * t115 * t118;
  t121 = t120 / 0.12e2;
  t122 = t121 < 0.6e0;
  t123 = rho[1] * rho[1];
  t124 = t116 * t116;
  t126 = 0.1e1 / t124 / t123;
  t127 = sigma[2] * t126;
  t128 = t44 * t127;
  t131 = exp(-t128 / 0.24e2);
  t135 = sigma[2] * sigma[2];
  t136 = t123 * t123;
  t137 = t136 * rho[1];
  t139 = 0.1e1 / t116 / t137;
  t141 = t59 * t135 * t139;
  t143 = 0.1e1 + 0.13780328706878157639e-4 * t141;
  t144 = log(t143);
  t145 = 0.804e0 + 0.5e1 / 0.972e3 * t128 + 0.4002424276710846245e-2 * t44 * t127 * t131 + t144;
  t148 = 0.1804e1 - 0.646416e0 / t145;
  t149 = 0.26e1 < t121;
  t151 = exp(-0.1137619054542480583e-1 * t128);
  t153 = 0.1804e1 - 0.804e0 * t151;
  t154 = 0.190125e0 * t120;
  t155 = 0.195e0 * t128;
  t156 = t115 * sigma[2];
  t157 = 0.1e1 / t136;
  t159 = 0.88128321188908374119e-2 * t156 * t157;
  t160 = 0.26041666666666666667e-2 * t141;
  t161 = t115 * t135;
  t162 = t136 * t123;
  t164 = 0.1e1 / t124 / t162;
  t167 = 0.16276041666666666667e-3 * t88 * t161 * t164;
  t168 = -0.40608e0 + t154 - t155 + t159 - t160 + t167;
  t170 = 0.140608e1 - t154 + t155 - t159 + t160 - t167;
  t173 = my_piecewise3(t149, t153, t170 * t148 + t168 * t153);
  t174 = my_piecewise3(t122, t148, t173);
  t178 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t174);
  tzk0 = t106 + t178;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t179 = t6 * t6;
  t180 = 0.1e1 / t179;
  t181 = t16 * t180;
  t182 = t7 - t181;
  t183 = my_piecewise5(t10, 0, t14, 0, t182);
  t186 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t183);
  t187 = t186 * t26;
  t191 = t26 * t26;
  t192 = 0.1e1 / t191;
  t193 = t25 * t192;
  t196 = t5 * t193 * t102 / 0.8e1;
  t197 = t70 * t70;
  t198 = 0.1e1 / t197;
  t199 = t45 * rho[0];
  t201 = 0.1e1 / t46 / t199;
  t202 = sigma[0] * t201;
  t203 = t44 * t202;
  t209 = 0.1e1 / t35 / t90;
  t210 = t60 * t209;
  t214 = 0.1e1 / t68;
  t218 = -0.1e2 / 0.729e3 * t203 - 0.10673131404562256653e-1 * t44 * t202 * t53 + 0.44471380852342736056e-3 * t59 * t210 * t53 - 0.73495086436683507408e-4 * t59 * t210 * t214;
  t221 = t202 * t76;
  t225 = 0.1e1 / t35 / t45;
  t230 = 0.1e1 / t62;
  t235 = t61 * t199;
  t237 = 0.1e1 / t46 / t235;
  t241 = -0.2535e0 * t33 * t34 * t225 + 0.52e0 * t203 - 0.35251328475563349648e-1 * t81 * t230 + 0.13888888888888888889e-1 * t59 * t210 - 0.10850694444444444445e-2 * t88 * t89 * t237;
  t243 = t96 * t28;
  t244 = t243 * t43;
  t247 = -t241;
  t249 = t98 * t198;
  t253 = my_piecewise3(t74, -0.243905525293907837e-1 * t44 * t221, t241 * t78 - 0.243905525293907837e-1 * t244 * t221 + t247 * t73 + 0.646416e0 * t249 * t218);
  t254 = my_piecewise3(t41, 0.646416e0 * t198 * t218, t253);
  t259 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t187 * t102 - t196 - 0.3e1 / 0.8e1 * t5 * t27 * t254);
  t261 = my_piecewise5(t14, 0, t10, 0, -t182);
  t264 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t261);
  t265 = t264 * t26;
  t269 = t113 * t192;
  t272 = t5 * t269 * t174 / 0.8e1;
  t274 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t265 * t174 - t272);
  tvrho0 = t106 + t178 + t6 * (t259 + t274);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t277 = -t7 - t181;
  t278 = my_piecewise5(t10, 0, t14, 0, t277);
  t281 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t278);
  t282 = t281 * t26;
  t287 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t102 - t196);
  t289 = my_piecewise5(t14, 0, t10, 0, -t277);
  t292 = my_piecewise3(t110, 0, 0.4e1 / 0.3e1 * t111 * t289);
  t293 = t292 * t26;
  t297 = t145 * t145;
  t298 = 0.1e1 / t297;
  t299 = t123 * rho[1];
  t301 = 0.1e1 / t124 / t299;
  t302 = sigma[2] * t301;
  t303 = t44 * t302;
  t309 = 0.1e1 / t116 / t162;
  t310 = t135 * t309;
  t314 = 0.1e1 / t143;
  t318 = -0.1e2 / 0.729e3 * t303 - 0.10673131404562256653e-1 * t44 * t302 * t131 + 0.44471380852342736056e-3 * t59 * t310 * t131 - 0.73495086436683507408e-4 * t59 * t310 * t314;
  t321 = t302 * t151;
  t325 = 0.1e1 / t116 / t123;
  t330 = 0.1e1 / t137;
  t335 = t136 * t299;
  t337 = 0.1e1 / t124 / t335;
  t341 = -0.2535e0 * t33 * t115 * t325 + 0.52e0 * t303 - 0.35251328475563349648e-1 * t156 * t330 + 0.13888888888888888889e-1 * t59 * t310 - 0.10850694444444444445e-2 * t88 * t161 * t337;
  t343 = t168 * t28;
  t344 = t343 * t43;
  t347 = -t341;
  t349 = t170 * t298;
  t353 = my_piecewise3(t149, -0.243905525293907837e-1 * t44 * t321, t341 * t153 - 0.243905525293907837e-1 * t344 * t321 + t347 * t148 + 0.646416e0 * t349 * t318);
  t354 = my_piecewise3(t122, 0.646416e0 * t298 * t318, t353);
  t359 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t293 * t174 - t272 - 0.3e1 / 0.8e1 * t5 * t114 * t354);
  tvrho1 = t106 + t178 + t6 * (t287 + t359);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t362 = t44 * t48;
  t367 = sigma[0] * t64;
  t374 = 0.5e1 / 0.972e3 * t362 + 0.4002424276710846245e-2 * t44 * t48 * t53 - 0.16676767819628526021e-3 * t59 * t367 * t53 + 0.27560657413756315278e-4 * t59 * t367 * t214;
  t380 = 0.1e1 / t34;
  t392 = 0.950625e-1 * t33 * t380 * t37 - 0.195e0 * t362 + 0.13219248178336256118e-1 * t34 * t82 - 0.52083333333333333334e-2 * t59 * t367 + 0.40690104166666666668e-3 * t88 * t81 * t92;
  t395 = t43 * t48 * t76;
  t398 = -t392;
  t403 = my_piecewise3(t74, 0.91464571985215438873e-2 * t44 * t48 * t76, t392 * t78 + 0.91464571985215438873e-2 * t243 * t395 + t398 * t73 + 0.646416e0 * t249 * t374);
  t404 = my_piecewise3(t41, 0.646416e0 * t198 * t374, t403);
  t408 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t404);
  tvsigma0 = t6 * t408;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t409 = t44 * t126;
  t414 = sigma[2] * t139;
  t421 = 0.5e1 / 0.972e3 * t409 + 0.4002424276710846245e-2 * t44 * t126 * t131 - 0.16676767819628526021e-3 * t59 * t414 * t131 + 0.27560657413756315278e-4 * t59 * t414 * t314;
  t427 = 0.1e1 / t115;
  t439 = 0.950625e-1 * t33 * t427 * t118 - 0.195e0 * t409 + 0.13219248178336256118e-1 * t115 * t157 - 0.52083333333333333334e-2 * t59 * t414 + 0.40690104166666666668e-3 * t88 * t156 * t164;
  t442 = t43 * t126 * t151;
  t445 = -t439;
  t450 = my_piecewise3(t149, 0.91464571985215438873e-2 * t44 * t126 * t151, t439 * t153 + 0.91464571985215438873e-2 * t343 * t442 + t445 * t148 + 0.646416e0 * t349 * t421);
  t451 = my_piecewise3(t122, 0.646416e0 * t298 * t421, t450);
  t455 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t451);
  tvsigma2 = t6 * t455;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t458 = t23 * t23;
  t459 = 0.1e1 / t458;
  t460 = t183 * t183;
  t463 = t179 * t6;
  t464 = 0.1e1 / t463;
  t465 = t16 * t464;
  t467 = -0.2e1 * t180 + 0.2e1 * t465;
  t468 = my_piecewise5(t10, 0, t14, 0, t467);
  t472 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t459 * t460 + 0.4e1 / 0.3e1 * t23 * t468);
  t473 = t472 * t26;
  t477 = t186 * t192;
  t479 = t5 * t477 * t102;
  t485 = 0.1e1 / t191 / t6;
  t486 = t25 * t485;
  t489 = t5 * t486 * t102 / 0.12e2;
  t491 = t5 * t193 * t254;
  t494 = 0.1e1 / t197 / t70;
  t495 = t218 * t218;
  t499 = 0.1e1 / t46 / t61;
  t500 = sigma[0] * t499;
  t501 = t44 * t500;
  t507 = 0.1e1 / t35 / t235;
  t508 = t60 * t507;
  t512 = t30 * t30;
  t513 = 0.1e1 / t512;
  t514 = t60 * sigma[0];
  t515 = t513 * t514;
  t516 = t61 * t61;
  t517 = t516 * t45;
  t518 = 0.1e1 / t517;
  t527 = t28 / t42 / t512;
  t528 = t60 * t60;
  t529 = t516 * t61;
  t531 = 0.1e1 / t46 / t529;
  t533 = t68 * t68;
  t534 = 0.1e1 / t533;
  t538 = 0.11e3 / 0.2187e4 * t501 + 0.39134815150061607728e-1 * t44 * t500 * t53 - 0.4002424276710846245e-2 * t59 * t508 * t53 + 0.29647587234895157371e-3 * t515 * t518 * t53 + 0.46546888076566221358e-3 * t59 * t508 * t214 - 0.32409166382013480325e-7 * t527 * t528 * t531 * t534;
  t542 = t500 * t76;
  t545 = t508 * t76;
  t550 = 0.1e1 / t35 / t199;
  t555 = 0.1e1 / t90;
  t561 = 0.1e1 / t46 / t516;
  t565 = 0.5915e0 * t33 * t34 * t550 - 0.19066666666666666667e1 * t501 + 0.17625664237781674824e0 * t81 * t555 - 0.87962962962962962964e-1 * t59 * t508 + 0.83188657407407407412e-2 * t88 * t89 * t561;
  t567 = t241 * t28;
  t568 = t567 * t43;
  t573 = t96 * t29;
  t574 = t573 * t58;
  t577 = -t565;
  t579 = t247 * t198;
  t582 = t98 * t494;
  t588 = my_piecewise3(t74, 0.89432025941099540233e-1 * t44 * t542 - 0.73992419488678004547e-3 * t59 * t545, t565 * t78 - 0.487811050587815674e-1 * t568 * t221 + 0.89432025941099540233e-1 * t244 * t542 - 0.73992419488678004547e-3 * t574 * t545 + t577 * t73 + 0.1292832e1 * t579 * t218 - 0.1292832e1 * t582 * t495 + 0.646416e0 * t249 * t538);
  t589 = my_piecewise3(t41, -0.1292832e1 * t494 * t495 + 0.646416e0 * t198 * t538, t588);
  t594 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t473 * t102 - t479 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t187 * t254 + t489 - t491 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t589);
  t595 = t111 * t111;
  t596 = 0.1e1 / t595;
  t597 = t261 * t261;
  t601 = my_piecewise5(t14, 0, t10, 0, -t467);
  t605 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t596 * t597 + 0.4e1 / 0.3e1 * t111 * t601);
  t606 = t605 * t26;
  t610 = t264 * t192;
  t612 = t5 * t610 * t174;
  t614 = t113 * t485;
  t617 = t5 * t614 * t174 / 0.12e2;
  t619 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t606 * t174 - t612 / 0.4e1 + t617);
  tv2rho20 = 0.2e1 * t259 + 0.2e1 * t274 + t6 * (t594 + t619);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t622 = t459 * t278;
  t625 = 0.2e1 * t465;
  t626 = my_piecewise5(t10, 0, t14, 0, t625);
  t630 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t622 * t183 + 0.4e1 / 0.3e1 * t23 * t626);
  t631 = t630 * t26;
  t635 = t281 * t192;
  t637 = t5 * t635 * t102;
  t645 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t631 * t102 - t637 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t282 * t254 - t479 / 0.8e1 + t489 - t491 / 0.8e1);
  t646 = t596 * t289;
  t649 = my_piecewise5(t14, 0, t10, 0, -t625);
  t653 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t646 * t261 + 0.4e1 / 0.3e1 * t111 * t649);
  t654 = t653 * t26;
  t658 = t292 * t192;
  t660 = t5 * t658 * t174;
  t667 = t5 * t269 * t354;
  t670 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t654 * t174 - t660 / 0.8e1 - t612 / 0.8e1 + t617 - 0.3e1 / 0.8e1 * t5 * t265 * t354 - t667 / 0.8e1);
  tv2rho21 = t259 + t274 + t287 + t359 + t6 * (t645 + t670);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t675 = t278 * t278;
  t679 = 0.2e1 * t180 + 0.2e1 * t465;
  t680 = my_piecewise5(t10, 0, t14, 0, t679);
  t684 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t459 * t675 + 0.4e1 / 0.3e1 * t23 * t680);
  t685 = t684 * t26;
  t691 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t685 * t102 - t637 / 0.4e1 + t489);
  t692 = t289 * t289;
  t696 = my_piecewise5(t14, 0, t10, 0, -t679);
  t700 = my_piecewise3(t110, 0, 0.4e1 / 0.9e1 * t596 * t692 + 0.4e1 / 0.3e1 * t111 * t696);
  t701 = t700 * t26;
  t711 = 0.1e1 / t297 / t145;
  t712 = t318 * t318;
  t716 = 0.1e1 / t124 / t136;
  t717 = sigma[2] * t716;
  t718 = t44 * t717;
  t724 = 0.1e1 / t116 / t335;
  t725 = t135 * t724;
  t729 = t135 * sigma[2];
  t730 = t513 * t729;
  t731 = t136 * t136;
  t732 = t731 * t123;
  t733 = 0.1e1 / t732;
  t740 = t135 * t135;
  t741 = t731 * t136;
  t743 = 0.1e1 / t124 / t741;
  t745 = t143 * t143;
  t746 = 0.1e1 / t745;
  t750 = 0.11e3 / 0.2187e4 * t718 + 0.39134815150061607728e-1 * t44 * t717 * t131 - 0.4002424276710846245e-2 * t59 * t725 * t131 + 0.29647587234895157371e-3 * t730 * t733 * t131 + 0.46546888076566221358e-3 * t59 * t725 * t314 - 0.32409166382013480325e-7 * t527 * t740 * t743 * t746;
  t754 = t717 * t151;
  t757 = t725 * t151;
  t762 = 0.1e1 / t116 / t299;
  t767 = 0.1e1 / t162;
  t773 = 0.1e1 / t124 / t731;
  t777 = 0.5915e0 * t33 * t115 * t762 - 0.19066666666666666667e1 * t718 + 0.17625664237781674824e0 * t156 * t767 - 0.87962962962962962964e-1 * t59 * t725 + 0.83188657407407407412e-2 * t88 * t161 * t773;
  t779 = t341 * t28;
  t780 = t779 * t43;
  t785 = t168 * t29;
  t786 = t785 * t58;
  t789 = -t777;
  t791 = t347 * t298;
  t794 = t170 * t711;
  t800 = my_piecewise3(t149, 0.89432025941099540233e-1 * t44 * t754 - 0.73992419488678004547e-3 * t59 * t757, t777 * t153 - 0.487811050587815674e-1 * t780 * t321 + 0.89432025941099540233e-1 * t344 * t754 - 0.73992419488678004547e-3 * t786 * t757 + t789 * t148 + 0.1292832e1 * t791 * t318 - 0.1292832e1 * t794 * t712 + 0.646416e0 * t349 * t750);
  t801 = my_piecewise3(t122, -0.1292832e1 * t711 * t712 + 0.646416e0 * t298 * t750, t800);
  t806 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t701 * t174 - t660 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t293 * t354 + t617 - t667 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t801);
  tv2rho22 = 0.2e1 * t287 + 0.2e1 * t359 + t6 * (t691 + t806);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t814 = t5 * t193 * t404 / 0.8e1;
  t815 = t494 * t374;
  t818 = t44 * t201;
  t823 = t209 * sigma[0];
  t827 = t513 * t60;
  t828 = t516 * rho[0];
  t829 = 0.1e1 / t828;
  t836 = t516 * t199;
  t838 = 0.1e1 / t46 / t836;
  t843 = -0.1e2 / 0.729e3 * t818 - 0.10673131404562256653e-1 * t44 * t201 * t53 + 0.13341414255702820817e-2 * t59 * t823 * t53 - 0.11117845213085684014e-3 * t827 * t829 * t53 - 0.14699017287336701482e-3 * t59 * t823 * t214 + 0.12153437393255055122e-7 * t527 * t514 * t838 * t534;
  t850 = t823 * t76;
  t865 = -0.12675e0 * t33 * t380 * t225 + 0.52e0 * t818 - 0.52876992713345024472e-1 * t34 * t230 + 0.27777777777777777778e-1 * t59 * t823 - 0.27126736111111111112e-2 * t88 * t81 * t237;
  t867 = t392 * t28;
  t868 = t867 * t43;
  t874 = t43 * t201 * t76;
  t879 = -t865;
  t881 = t398 * t198;
  t886 = t374 * t218;
  t892 = my_piecewise3(t74, -0.24390552529390783699e-1 * t44 * t201 * t76 + 0.27747157308254251705e-3 * t59 * t850, t865 * t78 - 0.243905525293907837e-1 * t868 * t221 + 0.91464571985215438873e-2 * t567 * t395 - 0.24390552529390783699e-1 * t243 * t874 + 0.27747157308254251705e-3 * t574 * t850 + t879 * t73 + 0.646416e0 * t881 * t218 + 0.646416e0 * t579 * t374 - 0.1292832e1 * t582 * t886 + 0.646416e0 * t249 * t843);
  t893 = my_piecewise3(t41, -0.1292832e1 * t815 * t218 + 0.646416e0 * t198 * t843, t892);
  t898 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t187 * t404 - t814 - 0.3e1 / 0.8e1 * t5 * t27 * t893);
  tv2rhosigma0 = t6 * t898 + t408;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t905 = t5 * t269 * t451 / 0.8e1;
  t907 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t265 * t451 - t905);
  tv2rhosigma2 = t6 * t907 + t455;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t913 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t404 - t814);
  tv2rhosigma3 = t6 * t913 + t408;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t918 = t711 * t421;
  t921 = t44 * t301;
  t926 = t309 * sigma[2];
  t930 = t513 * t135;
  t931 = t731 * rho[1];
  t932 = 0.1e1 / t931;
  t939 = t731 * t299;
  t941 = 0.1e1 / t124 / t939;
  t946 = -0.1e2 / 0.729e3 * t921 - 0.10673131404562256653e-1 * t44 * t301 * t131 + 0.13341414255702820817e-2 * t59 * t926 * t131 - 0.11117845213085684014e-3 * t930 * t932 * t131 - 0.14699017287336701482e-3 * t59 * t926 * t314 + 0.12153437393255055122e-7 * t527 * t729 * t941 * t746;
  t953 = t926 * t151;
  t968 = -0.12675e0 * t33 * t427 * t325 + 0.52e0 * t921 - 0.52876992713345024472e-1 * t115 * t330 + 0.27777777777777777778e-1 * t59 * t926 - 0.27126736111111111112e-2 * t88 * t156 * t337;
  t970 = t439 * t28;
  t971 = t970 * t43;
  t977 = t43 * t301 * t151;
  t982 = -t968;
  t984 = t445 * t298;
  t989 = t421 * t318;
  t995 = my_piecewise3(t149, -0.24390552529390783699e-1 * t44 * t301 * t151 + 0.27747157308254251705e-3 * t59 * t953, t968 * t153 - 0.243905525293907837e-1 * t971 * t321 + 0.91464571985215438873e-2 * t779 * t442 - 0.24390552529390783699e-1 * t343 * t977 + 0.27747157308254251705e-3 * t786 * t953 + t982 * t148 + 0.646416e0 * t984 * t318 + 0.646416e0 * t791 * t421 - 0.1292832e1 * t794 * t989 + 0.646416e0 * t349 * t946);
  t996 = my_piecewise3(t122, -0.1292832e1 * t918 * t318 + 0.646416e0 * t298 * t946, t995);
  t1001 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t293 * t451 - t905 - 0.3e1 / 0.8e1 * t5 * t114 * t996);
  tv2rhosigma5 = t6 * t1001 + t455;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t1003 = t374 * t374;
  t1009 = t513 * sigma[0];
  t1010 = 0.1e1 / t516;
  t1018 = 0.1e1 / t46 / t517;
  t1023 = -0.33353535639257052042e-3 * t59 * t64 * t53 + 0.41691919549071315052e-4 * t1009 * t1010 * t53 + 0.27560657413756315278e-4 * t59 * t64 * t214 - 0.45575390224706456708e-8 * t527 * t60 * t1018 * t534;
  t1030 = 0.1e1 / t81;
  t1041 = -0.4753125e-1 * t33 * t1030 * t37 + 0.6609624089168128059e-2 * t380 * t82 - 0.52083333333333333334e-2 * t59 * t64 + 0.61035156250000000002e-3 * t88 * t34 * t92;
  t1046 = t58 * t64 * t76;
  t1049 = -t1041;
  t1058 = my_piecewise3(t74, -0.10405183990595344389e-3 * t59 * t64 * t76, t1041 * t78 + 0.18292914397043087775e-1 * t867 * t395 - 0.10405183990595344389e-3 * t573 * t1046 + t1049 * t73 + 0.1292832e1 * t881 * t374 - 0.1292832e1 * t582 * t1003 + 0.646416e0 * t249 * t1023);
  t1059 = my_piecewise3(t41, -0.1292832e1 * t494 * t1003 + 0.646416e0 * t198 * t1023, t1058);
  t1063 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1059);
  tv2sigma20 = t6 * t1063;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t1064 = t421 * t421;
  t1070 = t513 * sigma[2];
  t1071 = 0.1e1 / t731;
  t1079 = 0.1e1 / t124 / t732;
  t1084 = -0.33353535639257052042e-3 * t59 * t139 * t131 + 0.41691919549071315052e-4 * t1070 * t1071 * t131 + 0.27560657413756315278e-4 * t59 * t139 * t314 - 0.45575390224706456708e-8 * t527 * t135 * t1079 * t746;
  t1091 = 0.1e1 / t156;
  t1102 = -0.4753125e-1 * t33 * t1091 * t118 + 0.6609624089168128059e-2 * t427 * t157 - 0.52083333333333333334e-2 * t59 * t139 + 0.61035156250000000002e-3 * t88 * t115 * t164;
  t1107 = t58 * t139 * t151;
  t1110 = -t1102;
  t1119 = my_piecewise3(t149, -0.10405183990595344389e-3 * t59 * t139 * t151, t1102 * t153 + 0.18292914397043087775e-1 * t970 * t442 - 0.10405183990595344389e-3 * t785 * t1107 + t1110 * t148 + 0.1292832e1 * t984 * t421 - 0.1292832e1 * t794 * t1064 + 0.646416e0 * t349 * t1084);
  t1120 = my_piecewise3(t122, -0.1292832e1 * t711 * t1064 + 0.646416e0 * t298 * t1084, t1119);
  t1124 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t1120);
  tv2sigma25 = t6 * t1124;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1128 = 0.1e1 / t458 / t19;
  t1129 = t460 * t183;
  t1132 = t459 * t183;
  t1135 = t179 * t179;
  t1136 = 0.1e1 / t1135;
  t1137 = t16 * t1136;
  t1139 = 0.6e1 * t464 - 0.6e1 * t1137;
  t1140 = my_piecewise5(t10, 0, t14, 0, t1139);
  t1144 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1128 * t1129 + 0.4e1 / 0.3e1 * t1132 * t468 + 0.4e1 / 0.3e1 * t23 * t1140);
  t1145 = t1144 * t26;
  t1149 = t472 * t192;
  t1151 = t5 * t1149 * t102;
  t1156 = t186 * t485;
  t1158 = t5 * t1156 * t102;
  t1161 = t5 * t477 * t254;
  t1167 = 0.1e1 / t191 / t179;
  t1168 = t25 * t1167;
  t1171 = 0.5e1 / 0.36e2 * t5 * t1168 * t102;
  t1173 = t5 * t486 * t254;
  t1176 = t5 * t193 * t589;
  t1178 = t197 * t197;
  t1179 = 0.1e1 / t1178;
  t1180 = t495 * t218;
  t1183 = t494 * t218;
  t1187 = 0.1e1 / t46 / t62;
  t1188 = sigma[0] * t1187;
  t1189 = t44 * t1188;
  t1195 = 0.1e1 / t35 / t516;
  t1196 = t60 * t1195;
  t1200 = 0.1e1 / t836;
  t1204 = t513 * t528;
  t1205 = t516 * t62;
  t1207 = 0.1e1 / t46 / t1205;
  t1209 = t44 * t53;
  t1219 = t528 * t60;
  t1220 = t516 * t516;
  t1222 = 0.1e1 / t1220 / t199;
  t1225 = 0.1e1 / t533 / t68;
  t1228 = -0.154e4 / 0.6561e4 * t1189 - 0.1826291373669541694e0 * t44 * t1188 * t53 + 0.33699424156997495545e-1 * t59 * t1196 * t53 - 0.56330415746300799004e-2 * t515 * t1200 * t53 + 0.32941763594327952634e-4 * t1204 * t1207 * t1209 - 0.34134384589481895663e-2 * t59 * t1196 * t214 + 0.61577416125825612618e-6 * t527 * t528 * t1207 * t534 - 0.3012370804988962832e-14 * t1219 * t1222 * t1225;
  t1232 = t1188 * t76;
  t1235 = t1196 * t76;
  t1243 = 0.1e1 / t35 / t61;
  t1248 = 0.1e1 / t235;
  t1254 = 0.1e1 / t46 / t828;
  t1258 = -0.19716666666666666667e1 * t33 * t34 * t1243 + 0.88977777777777777779e1 * t1189 - 0.10575398542669004894e1 * t81 * t1248 + 0.6450617283950617284e0 * t59 * t1196 - 0.72096836419753086424e-1 * t88 * t89 * t1254;
  t1260 = t565 * t28;
  t1261 = t1260 * t43;
  t1266 = t241 * t29;
  t1267 = t1266 * t58;
  t1274 = t96 * t514;
  t1275 = t1200 * t76;
  t1278 = -t1258;
  t1280 = t577 * t198;
  t1283 = t247 * t494;
  t1288 = t98 * t1179;
  t1291 = t218 * t538;
  t1296 = t1258 * t78 - 0.731716575881723511e-1 * t1261 * t221 + 0.2682960778232986207e0 * t568 * t542 - 0.22197725846603401364e-2 * t1267 * t545 - 0.41734945439179785442e0 * t244 * t1232 + 0.81391661437545805002e-2 * t574 * t1235 - 0.13826255501780643787e-5 * t1274 * t1275 + t1278 * t73 + 0.1939248e1 * t1280 * t218 - 0.3878496e1 * t1283 * t495 + 0.1939248e1 * t579 * t538 + 0.3878496e1 * t1288 * t1180 - 0.3878496e1 * t582 * t1291 + 0.646416e0 * t249 * t1228;
  t1297 = my_piecewise3(t74, -0.41734945439179785442e0 * t44 * t1232 + 0.81391661437545805002e-2 * t59 * t1235 - 0.13826255501780643787e-5 * t514 * t1200 * t76, t1296);
  t1298 = my_piecewise3(t41, 0.3878496e1 * t1179 * t1180 - 0.3878496e1 * t1183 * t538 + 0.646416e0 * t198 * t1228, t1297);
  t1303 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1145 * t102 - 0.3e1 / 0.8e1 * t1151 - 0.9e1 / 0.8e1 * t5 * t473 * t254 + t1158 / 0.4e1 - 0.3e1 / 0.4e1 * t1161 - 0.9e1 / 0.8e1 * t5 * t187 * t589 - t1171 + t1173 / 0.4e1 - 0.3e1 / 0.8e1 * t1176 - 0.3e1 / 0.8e1 * t5 * t27 * t1298);
  t1305 = 0.1e1 / t595 / t109;
  t1306 = t597 * t261;
  t1309 = t596 * t261;
  t1313 = my_piecewise5(t14, 0, t10, 0, -t1139);
  t1317 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1305 * t1306 + 0.4e1 / 0.3e1 * t1309 * t601 + 0.4e1 / 0.3e1 * t111 * t1313);
  t1318 = t1317 * t26;
  t1322 = t605 * t192;
  t1324 = t5 * t1322 * t174;
  t1326 = t264 * t485;
  t1328 = t5 * t1326 * t174;
  t1330 = t113 * t1167;
  t1333 = 0.5e1 / 0.36e2 * t5 * t1330 * t174;
  t1335 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1318 * t174 - 0.3e1 / 0.8e1 * t1324 + t1328 / 0.4e1 - t1333);
  tv3rho30 = 0.3e1 * t594 + 0.3e1 * t619 + t6 * (t1303 + t1335);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1338 = 0.2e1 * t645;
  t1339 = 0.2e1 * t670;
  t1340 = t1128 * t278;
  t1343 = t459 * t626;
  t1348 = 0.2e1 * t464;
  t1349 = 0.6e1 * t1137;
  t1350 = t1348 - t1349;
  t1351 = my_piecewise5(t10, 0, t14, 0, t1350);
  t1355 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1340 * t460 + 0.8e1 / 0.9e1 * t1343 * t183 + 0.4e1 / 0.9e1 * t622 * t468 + 0.4e1 / 0.3e1 * t23 * t1351);
  t1356 = t1355 * t26;
  t1360 = t630 * t192;
  t1363 = t5 * t1360 * t102 / 0.4e1;
  t1367 = t281 * t485;
  t1369 = t5 * t1367 * t102;
  t1373 = t5 * t635 * t254 / 0.4e1;
  t1382 = -0.3e1 / 0.8e1 * t5 * t1356 * t102 - t1363 - 0.3e1 / 0.4e1 * t5 * t631 * t254 + t1369 / 0.12e2 - t1373 - 0.3e1 / 0.8e1 * t5 * t282 * t589 - t1151 / 0.8e1 + t1158 / 0.6e1 - t1161 / 0.4e1 - t1171 + t1173 / 0.6e1 - t1176 / 0.8e1;
  t1383 = my_piecewise3(t1, 0, t1382);
  t1384 = t1305 * t289;
  t1387 = t596 * t649;
  t1393 = my_piecewise5(t14, 0, t10, 0, -t1350);
  t1397 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1384 * t597 + 0.8e1 / 0.9e1 * t1387 * t261 + 0.4e1 / 0.9e1 * t646 * t601 + 0.4e1 / 0.3e1 * t111 * t1393);
  t1398 = t1397 * t26;
  t1402 = t653 * t192;
  t1405 = t5 * t1402 * t174 / 0.4e1;
  t1406 = t292 * t485;
  t1408 = t5 * t1406 * t174;
  t1417 = t5 * t610 * t354 / 0.4e1;
  t1419 = t5 * t614 * t354;
  t1422 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1398 * t174 - t1405 + t1408 / 0.12e2 - t1324 / 0.8e1 + t1328 / 0.6e1 - t1333 - 0.3e1 / 0.8e1 * t5 * t606 * t354 - t1417 + t1419 / 0.12e2);
  tv3rho31 = t594 + t619 + t1338 + t1339 + t6 * (t1383 + t1422);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1425 = t1128 * t675;
  t1430 = t459 * t680;
  t1433 = -t1348 - t1349;
  t1434 = my_piecewise5(t10, 0, t14, 0, t1433);
  t1438 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1425 * t183 + 0.8e1 / 0.9e1 * t622 * t626 + 0.4e1 / 0.9e1 * t1430 * t183 + 0.4e1 / 0.3e1 * t23 * t1434);
  t1439 = t1438 * t26;
  t1443 = t684 * t192;
  t1445 = t5 * t1443 * t102;
  t1454 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1439 * t102 - t1445 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t685 * t254 - t1363 + t1369 / 0.6e1 - t1373 + t1158 / 0.12e2 - t1171 + t1173 / 0.12e2);
  t1455 = t1305 * t692;
  t1460 = t596 * t696;
  t1464 = my_piecewise5(t14, 0, t10, 0, -t1433);
  t1468 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1455 * t261 + 0.8e1 / 0.9e1 * t646 * t649 + 0.4e1 / 0.9e1 * t1460 * t261 + 0.4e1 / 0.3e1 * t111 * t1464);
  t1469 = t1468 * t26;
  t1473 = t700 * t192;
  t1475 = t5 * t1473 * t174;
  t1482 = t5 * t658 * t354;
  t1490 = t5 * t269 * t801;
  t1492 = -0.3e1 / 0.8e1 * t5 * t1469 * t174 - t1475 / 0.8e1 - t1405 + t1408 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t654 * t354 - t1482 / 0.4e1 + t1328 / 0.12e2 - t1333 - t1417 + t1419 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t265 * t801 - t1490 / 0.8e1;
  t1493 = my_piecewise3(t107, 0, t1492);
  tv3rho32 = t1338 + t1339 + t691 + t806 + t6 * (t1454 + t1493);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1498 = t675 * t278;
  t1504 = -0.6e1 * t464 - 0.6e1 * t1137;
  t1505 = my_piecewise5(t10, 0, t14, 0, t1504);
  t1509 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1128 * t1498 + 0.4e1 / 0.3e1 * t622 * t680 + 0.4e1 / 0.3e1 * t23 * t1505);
  t1510 = t1509 * t26;
  t1517 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1510 * t102 - 0.3e1 / 0.8e1 * t1445 + t1369 / 0.4e1 - t1171);
  t1518 = t692 * t289;
  t1524 = my_piecewise5(t14, 0, t10, 0, -t1504);
  t1528 = my_piecewise3(t110, 0, -0.8e1 / 0.27e2 * t1305 * t1518 + 0.4e1 / 0.3e1 * t646 * t696 + 0.4e1 / 0.3e1 * t111 * t1524);
  t1529 = t1528 * t26;
  t1544 = t297 * t297;
  t1545 = 0.1e1 / t1544;
  t1546 = t712 * t318;
  t1549 = t711 * t318;
  t1553 = 0.1e1 / t124 / t137;
  t1554 = sigma[2] * t1553;
  t1555 = t44 * t1554;
  t1561 = 0.1e1 / t116 / t731;
  t1562 = t135 * t1561;
  t1566 = 0.1e1 / t939;
  t1570 = t513 * t740;
  t1571 = t731 * t137;
  t1573 = 0.1e1 / t124 / t1571;
  t1575 = t44 * t131;
  t1585 = t740 * t135;
  t1586 = t731 * t731;
  t1588 = 0.1e1 / t1586 / t299;
  t1591 = 0.1e1 / t745 / t143;
  t1594 = -0.154e4 / 0.6561e4 * t1555 - 0.1826291373669541694e0 * t44 * t1554 * t131 + 0.33699424156997495545e-1 * t59 * t1562 * t131 - 0.56330415746300799004e-2 * t730 * t1566 * t131 + 0.32941763594327952634e-4 * t1570 * t1573 * t1575 - 0.34134384589481895663e-2 * t59 * t1562 * t314 + 0.61577416125825612618e-6 * t527 * t740 * t1573 * t746 - 0.3012370804988962832e-14 * t1585 * t1588 * t1591;
  t1598 = t1554 * t151;
  t1601 = t1562 * t151;
  t1609 = 0.1e1 / t116 / t136;
  t1614 = 0.1e1 / t335;
  t1620 = 0.1e1 / t124 / t931;
  t1624 = -0.19716666666666666667e1 * t33 * t115 * t1609 + 0.88977777777777777779e1 * t1555 - 0.10575398542669004894e1 * t156 * t1614 + 0.6450617283950617284e0 * t59 * t1562 - 0.72096836419753086424e-1 * t88 * t161 * t1620;
  t1626 = t777 * t28;
  t1627 = t1626 * t43;
  t1632 = t341 * t29;
  t1633 = t1632 * t58;
  t1640 = t168 * t729;
  t1641 = t1566 * t151;
  t1644 = -t1624;
  t1646 = t789 * t298;
  t1649 = t347 * t711;
  t1654 = t170 * t1545;
  t1657 = t318 * t750;
  t1662 = t1624 * t153 - 0.731716575881723511e-1 * t1627 * t321 + 0.2682960778232986207e0 * t780 * t754 - 0.22197725846603401364e-2 * t1633 * t757 - 0.41734945439179785442e0 * t344 * t1598 + 0.81391661437545805002e-2 * t786 * t1601 - 0.13826255501780643787e-5 * t1640 * t1641 + t1644 * t148 + 0.1939248e1 * t1646 * t318 - 0.3878496e1 * t1649 * t712 + 0.1939248e1 * t791 * t750 + 0.3878496e1 * t1654 * t1546 - 0.3878496e1 * t794 * t1657 + 0.646416e0 * t349 * t1594;
  t1663 = my_piecewise3(t149, -0.41734945439179785442e0 * t44 * t1598 + 0.81391661437545805002e-2 * t59 * t1601 - 0.13826255501780643787e-5 * t729 * t1566 * t151, t1662);
  t1664 = my_piecewise3(t122, 0.3878496e1 * t1545 * t1546 - 0.3878496e1 * t1549 * t750 + 0.646416e0 * t298 * t1594, t1663);
  t1669 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1529 * t174 - 0.3e1 / 0.8e1 * t1475 - 0.9e1 / 0.8e1 * t5 * t701 * t354 + t1408 / 0.4e1 - 0.3e1 / 0.4e1 * t1482 - 0.9e1 / 0.8e1 * t5 * t293 * t801 - t1333 + t1419 / 0.4e1 - 0.3e1 / 0.8e1 * t1490 - 0.3e1 / 0.8e1 * t5 * t114 * t1664);
  tv3rho33 = 0.3e1 * t691 + 0.3e1 * t806 + t6 * (t1517 + t1669);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1677 = t5 * t477 * t404;
  t1684 = t5 * t486 * t404 / 0.12e2;
  t1686 = t5 * t193 * t893;
  t1688 = t1179 * t374;
  t1691 = t494 * t843;
  t1696 = t44 * t499;
  t1701 = t507 * sigma[0];
  t1705 = t513 * t518;
  t1706 = t60 * t53;
  t1719 = t528 * sigma[0];
  t1721 = 0.1e1 / t1220 / t45;
  t1725 = 0.11e3 / 0.2187e4 * t1696 + 0.39134815150061607728e-1 * t44 * t499 * t53 - 0.96354658513409261456e-2 * t59 * t1701 * t53 + 0.18900336862245662824e-2 * t1705 * t1706 - 0.12353161347872982238e-4 * t515 * t531 * t1209 + 0.93093776153132442719e-3 * t59 * t1701 * t214 - 0.20660843568533593707e-6 * t527 * t514 * t531 * t534 + 0.1129639051870861062e-14 * t1719 * t1721 * t1225;
  t1732 = t1701 * t76;
  t1739 = t865 * t28;
  t1740 = t1739 * t43;
  t1743 = t392 * t29;
  t1744 = t1743 * t58;
  t1752 = t43 * t499 * t76;
  t1768 = -0.29575e0 * t33 * t380 * t550 + 0.19066666666666666667e1 * t1696 - 0.26438496356672512236e0 * t34 * t555 + 0.17592592592592592593e0 * t59 * t1701 - 0.20797164351851851853e-1 * t88 * t81 * t561;
  t1770 = -t1768;
  t1774 = t879 * t198;
  t1784 = t374 * t495;
  t1789 = t843 * t218;
  t1792 = t374 * t538;
  t1795 = t96 * t518;
  t1796 = t60 * t76;
  t1799 = t398 * t494;
  t1806 = 0.646416e0 * t881 * t538 + 0.646416e0 * t1280 * t374 + 0.1292832e1 * t579 * t843 + 0.3878496e1 * t1288 * t1784 + 0.91464571985215438873e-2 * t1260 * t395 - 0.2585664e1 * t582 * t1789 - 0.1292832e1 * t582 * t1792 + 0.51848458131677414201e-6 * t1795 * t1796 - 0.1292832e1 * t1799 * t495 - 0.2585664e1 * t1283 * t886 + 0.89432025941099540233e-1 * t868 * t542;
  t1808 = my_piecewise3(t74, 0.8943202594109954023e-1 * t44 * t499 * t76 - 0.24972441577428826534e-2 * t59 * t1732 + 0.51848458131677414201e-6 * t518 * t60 * t76, -0.487811050587815674e-1 * t1740 * t221 - 0.73992419488678004547e-3 * t1744 * t545 - 0.48781105058781567398e-1 * t567 * t874 + 0.5549431461650850341e-3 * t1267 * t850 + 0.8943202594109954023e-1 * t243 * t1752 - 0.24972441577428826534e-2 * t574 * t1732 + t1768 * t73 + t1770 * t78 + 0.646416e0 * t249 * t1725 + 0.1292832e1 * t1774 * t218 + t1806);
  t1809 = my_piecewise3(t41, 0.3878496e1 * t1688 * t495 - 0.2585664e1 * t1691 * t218 - 0.1292832e1 * t815 * t538 + 0.646416e0 * t198 * t1725, t1808);
  t1814 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t473 * t404 - t1677 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t187 * t893 + t1684 - t1686 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1809);
  tv3rho2sigma0 = t6 * t1814 + 0.2e1 * t898;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1821 = t5 * t610 * t451;
  t1825 = t5 * t614 * t451 / 0.12e2;
  t1827 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t606 * t451 - t1821 / 0.4e1 + t1825);
  tv3rho2sigma2 = t6 * t1827 + 0.2e1 * t907;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1833 = t5 * t635 * t404;
  t1841 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t631 * t404 - t1833 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t282 * t893 - t1677 / 0.8e1 + t1684 - t1686 / 0.8e1);
  tv3rho2sigma3 = t6 * t1841 + t898 + t913;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1847 = t5 * t658 * t451;
  t1854 = t5 * t269 * t996;
  t1857 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t654 * t451 - t1847 / 0.8e1 - t1821 / 0.8e1 + t1825 - 0.3e1 / 0.8e1 * t5 * t265 * t996 - t1854 / 0.8e1);
  tv3rho2sigma5 = t6 * t1857 + t1001 + t907;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1865 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t685 * t404 - t1833 / 0.4e1 + t1684);
  tv3rho2sigma6 = t6 * t1865 + 0.2e1 * t913;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1876 = t1545 * t421;
  t1879 = t711 * t946;
  t1884 = t44 * t716;
  t1889 = t724 * sigma[2];
  t1893 = t513 * t733;
  t1894 = t135 * t131;
  t1907 = t740 * sigma[2];
  t1909 = 0.1e1 / t1586 / t123;
  t1913 = 0.11e3 / 0.2187e4 * t1884 + 0.39134815150061607728e-1 * t44 * t716 * t131 - 0.96354658513409261456e-2 * t59 * t1889 * t131 + 0.18900336862245662824e-2 * t1893 * t1894 - 0.12353161347872982238e-4 * t730 * t743 * t1575 + 0.93093776153132442719e-3 * t59 * t1889 * t314 - 0.20660843568533593707e-6 * t527 * t729 * t743 * t746 + 0.1129639051870861062e-14 * t1907 * t1909 * t1591;
  t1920 = t1889 * t151;
  t1927 = t982 * t298;
  t1940 = t421 * t712;
  t1956 = -0.29575e0 * t33 * t427 * t762 + 0.19066666666666666667e1 * t1884 - 0.26438496356672512236e0 * t115 * t767 + 0.17592592592592592593e0 * t59 * t1889 - 0.20797164351851851853e-1 * t88 * t156 * t773;
  t1958 = -t1956;
  t1962 = t43 * t716 * t151;
  t1967 = t968 * t28;
  t1968 = t1967 * t43;
  t1971 = t439 * t29;
  t1972 = t1971 * t58;
  t1981 = t946 * t318;
  t1984 = t421 * t750;
  t1987 = t168 * t733;
  t1988 = t135 * t151;
  t1991 = t445 * t711;
  t1994 = 0.8943202594109954023e-1 * t343 * t1962 - 0.24972441577428826534e-2 * t786 * t1920 - 0.487811050587815674e-1 * t1968 * t321 - 0.73992419488678004547e-3 * t1972 * t757 - 0.48781105058781567398e-1 * t779 * t977 + 0.5549431461650850341e-3 * t1633 * t953 - 0.2585664e1 * t1649 * t989 - 0.2585664e1 * t794 * t1981 - 0.1292832e1 * t794 * t1984 + 0.51848458131677414201e-6 * t1987 * t1988 - 0.1292832e1 * t1991 * t712;
  t1996 = my_piecewise3(t149, 0.8943202594109954023e-1 * t44 * t716 * t151 - 0.24972441577428826534e-2 * t59 * t1920 + 0.51848458131677414201e-6 * t733 * t135 * t151, 0.1292832e1 * t1927 * t318 + 0.646416e0 * t984 * t750 + 0.646416e0 * t1646 * t421 + 0.1292832e1 * t791 * t946 + 0.646416e0 * t349 * t1913 + 0.89432025941099540233e-1 * t971 * t754 + 0.3878496e1 * t1654 * t1940 + 0.91464571985215438873e-2 * t1626 * t442 + t1956 * t148 + t1958 * t153 + t1994);
  t1997 = my_piecewise3(t122, 0.3878496e1 * t1876 * t712 - 0.2585664e1 * t1879 * t318 - 0.1292832e1 * t918 * t750 + 0.646416e0 * t298 * t1913, t1996);
  t2002 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t701 * t451 - t1847 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t293 * t996 + t1825 - t1854 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t1997);
  tv3rho2sigma8 = t6 * t2002 + 0.2e1 * t1001;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t2009 = t5 * t193 * t1059 / 0.8e1;
  t2010 = t1179 * t1003;
  t2015 = t494 * t1023;
  t2021 = t513 * t829;
  t2022 = sigma[0] * t53;
  t2031 = t838 * t534;
  t2035 = t1220 * rho[0];
  t2036 = 0.1e1 / t2035;
  t2040 = 0.17788552340937094422e-2 * t59 * t209 * t53 - 0.5558922606542842007e-3 * t2021 * t2022 + 0.46324355054523683391e-5 * t827 * t838 * t1209 - 0.14699017287336701482e-3 * t59 * t209 * t214 + 0.60767186966275275611e-7 * t527 * t2031 * t60 - 0.42361464445157289826e-15 * t528 * t2036 * t1225;
  t2061 = 0.63375e-1 * t33 * t1030 * t225 - 0.26438496356672512236e-1 * t380 * t230 + 0.27777777777777777778e-1 * t59 * t209 - 0.40690104166666666668e-2 * t88 * t34 * t237;
  t2063 = t1041 * t28;
  t2064 = t2063 * t43;
  t2076 = t58 * t209 * t76;
  t2079 = t96 * t829;
  t2080 = sigma[0] * t76;
  t2083 = -t2061;
  t2085 = t1049 * t198;
  t2096 = t1003 * t218;
  t2099 = t374 * t843;
  t2104 = t1023 * t218;
  t2109 = t2061 * t78 - 0.243905525293907837e-1 * t2064 * t221 + 0.18292914397043087775e-1 * t1739 * t395 - 0.487811050587815674e-1 * t867 * t874 + 0.55494314616508503411e-3 * t1744 * t850 - 0.10405183990595344389e-3 * t1266 * t1046 + 0.55494314616508503408e-3 * t573 * t2076 - 0.19443171799379030325e-6 * t2079 * t2080 + t2083 * t73 + 0.646416e0 * t2085 * t218 + 0.1292832e1 * t1774 * t374 - 0.2585664e1 * t1799 * t886 + 0.1292832e1 * t881 * t843 - 0.1292832e1 * t1283 * t1003 + 0.3878496e1 * t1288 * t2096 - 0.2585664e1 * t582 * t2099 + 0.646416e0 * t579 * t1023 - 0.1292832e1 * t582 * t2104 + 0.646416e0 * t249 * t2040;
  t2110 = my_piecewise3(t74, 0.55494314616508503408e-3 * t59 * t209 * t76 - 0.19443171799379030325e-6 * t829 * sigma[0] * t76, t2109);
  t2111 = my_piecewise3(t41, 0.3878496e1 * t2010 * t218 - 0.2585664e1 * t815 * t843 - 0.1292832e1 * t2015 * t218 + 0.646416e0 * t198 * t2040, t2110);
  t2116 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t187 * t1059 - t2009 - 0.3e1 / 0.8e1 * t5 * t27 * t2111);
  tv3rhosigma20 = t6 * t2116 + t1063;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t2123 = t5 * t269 * t1120 / 0.8e1;
  t2125 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t265 * t1120 - t2123);
  tv3rhosigma25 = t6 * t2125 + t1124;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t2131 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t1059 - t2009);
  tv3rhosigma26 = t6 * t2131 + t1063;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t2136 = t1545 * t1064;
  t2141 = t711 * t1084;
  t2147 = t513 * t932;
  t2148 = sigma[2] * t131;
  t2157 = t941 * t746;
  t2161 = t1586 * rho[1];
  t2162 = 0.1e1 / t2161;
  t2166 = 0.17788552340937094422e-2 * t59 * t309 * t131 - 0.5558922606542842007e-3 * t2147 * t2148 + 0.46324355054523683391e-5 * t930 * t941 * t1575 - 0.14699017287336701482e-3 * t59 * t309 * t314 + 0.60767186966275275611e-7 * t527 * t2157 * t135 - 0.42361464445157289826e-15 * t740 * t2162 * t1591;
  t2187 = 0.63375e-1 * t33 * t1091 * t325 - 0.26438496356672512236e-1 * t427 * t330 + 0.27777777777777777778e-1 * t59 * t309 - 0.40690104166666666668e-2 * t88 * t115 * t337;
  t2189 = t1102 * t28;
  t2190 = t2189 * t43;
  t2202 = t58 * t309 * t151;
  t2205 = t168 * t932;
  t2206 = sigma[2] * t151;
  t2209 = -t2187;
  t2211 = t1110 * t298;
  t2222 = t1064 * t318;
  t2225 = t421 * t946;
  t2230 = t1084 * t318;
  t2235 = t2187 * t153 - 0.243905525293907837e-1 * t2190 * t321 + 0.18292914397043087775e-1 * t1967 * t442 - 0.487811050587815674e-1 * t970 * t977 + 0.55494314616508503411e-3 * t1972 * t953 - 0.10405183990595344389e-3 * t1632 * t1107 + 0.55494314616508503408e-3 * t785 * t2202 - 0.19443171799379030325e-6 * t2205 * t2206 + t2209 * t148 + 0.646416e0 * t2211 * t318 + 0.1292832e1 * t1927 * t421 - 0.2585664e1 * t1991 * t989 + 0.1292832e1 * t984 * t946 - 0.1292832e1 * t1649 * t1064 + 0.3878496e1 * t1654 * t2222 - 0.2585664e1 * t794 * t2225 + 0.646416e0 * t791 * t1084 - 0.1292832e1 * t794 * t2230 + 0.646416e0 * t349 * t2166;
  t2236 = my_piecewise3(t149, 0.55494314616508503408e-3 * t59 * t309 * t151 - 0.19443171799379030325e-6 * t932 * sigma[2] * t151, t2235);
  t2237 = my_piecewise3(t122, 0.3878496e1 * t2136 * t318 - 0.2585664e1 * t918 * t946 - 0.1292832e1 * t2141 * t318 + 0.646416e0 * t298 * t2166, t2236);
  t2242 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t293 * t1120 - t2123 - 0.3e1 / 0.8e1 * t5 * t114 * t2237);
  tv3rhosigma211 = t6 * t2242 + t1124;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2244 = t1003 * t374;
  t2255 = t1018 * t534;
  t2259 = 0.1e1 / t1220;
  t2263 = 0.12507575864721394516e-3 * t513 * t1010 * t53 - 0.17371633145446381272e-5 * t1009 * t1018 * t1209 - 0.13672617067411937012e-7 * t527 * t2255 * sigma[0] + 0.15885549166933983685e-15 * t514 * t2259 * t1225;
  t2269 = 0.1e1 / t89;
  t2278 = 0.71296875e-1 * t33 * t2269 * t37 - 0.33048120445840640295e-2 * t1030 * t82 + 0.30517578125000000001e-3 * t88 * t380 * t92;
  t2287 = -t2278;
  t2297 = t374 * t1023;
  t2302 = t2278 * t78 + 0.27439371595564631662e-1 * t2063 * t395 - 0.31215551971786033168e-3 * t1743 * t1046 + 0.72911894247671363718e-7 * t96 * t1010 * t76 + t2287 * t73 + 0.1939248e1 * t2085 * t374 - 0.3878496e1 * t1799 * t1003 + 0.1939248e1 * t881 * t1023 + 0.3878496e1 * t1288 * t2244 - 0.3878496e1 * t582 * t2297 + 0.646416e0 * t249 * t2263;
  t2303 = my_piecewise3(t74, 0.72911894247671363718e-7 * t1010 * t76, t2302);
  t2304 = my_piecewise3(t41, 0.3878496e1 * t1179 * t2244 - 0.3878496e1 * t815 * t1023 + 0.646416e0 * t198 * t2263, t2303);
  t2308 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t2304);
  tv3sigma30 = t6 * t2308;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2309 = t1064 * t421;
  t2320 = t1079 * t746;
  t2324 = 0.1e1 / t1586;
  t2328 = 0.12507575864721394516e-3 * t513 * t1071 * t131 - 0.17371633145446381272e-5 * t1070 * t1079 * t1575 - 0.13672617067411937012e-7 * t527 * t2320 * sigma[2] + 0.15885549166933983685e-15 * t729 * t2324 * t1591;
  t2334 = 0.1e1 / t161;
  t2343 = 0.71296875e-1 * t33 * t2334 * t118 - 0.33048120445840640295e-2 * t1091 * t157 + 0.30517578125000000001e-3 * t88 * t427 * t164;
  t2352 = -t2343;
  t2362 = t421 * t1084;
  t2367 = t2343 * t153 + 0.27439371595564631662e-1 * t2189 * t442 - 0.31215551971786033168e-3 * t1971 * t1107 + 0.72911894247671363718e-7 * t168 * t1071 * t151 + t2352 * t148 + 0.1939248e1 * t2211 * t421 - 0.3878496e1 * t1991 * t1064 + 0.1939248e1 * t984 * t1084 + 0.3878496e1 * t1654 * t2309 - 0.3878496e1 * t794 * t2362 + 0.646416e0 * t349 * t2328;
  t2368 = my_piecewise3(t149, 0.72911894247671363718e-7 * t1071 * t151, t2367);
  t2369 = my_piecewise3(t122, 0.3878496e1 * t1545 * t2309 - 0.3878496e1 * t918 * t1084 + 0.646416e0 * t298 * t2328, t2368);
  t2373 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t2369);
  tv3sigma39 = t6 * t2373;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2377 = 0.1e1 / t1178 / t70;
  t2378 = t495 * t495;
  t2384 = t538 * t538;
  t2389 = sigma[0] * t92;
  t2390 = t44 * t2389;
  t2397 = t60 / t35 / t828;
  t2401 = 0.1e1 / t529;
  t2405 = t516 * t90;
  t2407 = 0.1e1 / t46 / t2405;
  t2415 = t59 * t53;
  t2421 = t528 * t2407;
  t2430 = t528 * t528;
  t2435 = t533 * t533;
  t2438 = 0.1e1 / t2435 * t29 * t58;
  t2441 = 0.2618e5 / 0.19683e5 * t2390 + 0.10348984450794069599e1 * t44 * t2389 * t53 - 0.30112066101575181503e0 * t59 * t2397 * t53 + 0.84429740092262542601e-1 * t515 * t2401 * t53 - 0.10760976107480464527e-2 * t1204 * t2407 * t1209 + 0.36601959549253280704e-5 * t513 * t1719 / t35 / t2035 * t2415 + 0.28445320491234913052e-1 * t59 * t2397 * t214 - 0.99208059313830153663e-5 * t527 * t2421 * t534 + 0.11447009058958058762e-12 * t1219 / t1220 / t61 * t1225 - 0.66418335807601710336e-18 * t2430 / t35 / t1220 / t828 * t2438;
  t2445 = t2389 * t76;
  t2448 = t2397 * t76;
  t2454 = t44 * t76;
  t2458 = t1258 * t28;
  t2462 = t565 * t29;
  t2463 = t2462 * t58;
  t2485 = -0.8543888888888888889e1 * t33 * t34 * t64 + 0.50420740740740740741e2 * t2390 - 0.74027789798683034258e1 * t81 * t1010 + 0.537551440329218107e1 * t59 * t2397 - 0.6969360853909465021e0 * t88 * t89 * t1018;
  t2491 = t1278 * t198;
  t2498 = -0.975622101175631348e-1 * t2458 * t43 * t221 - 0.44395451693206802728e-2 * t2463 * t545 + 0.32556664575018322e-1 * t1267 * t1235 - 0.80487309643795296057e-1 * t574 * t2448 - 0.41944031231462577189e-7 * t96 * t528 * t2407 * t2454 + t2485 * t73 - t2485 * t78 + 0.646416e0 * t249 * t2441 + 0.2585664e1 * t2491 * t218 + 0.3878496e1 * t1280 * t538 + 0.2585664e1 * t579 * t1228;
  t2499 = t98 * t2377;
  t2510 = t577 * t494;
  t2513 = t247 * t1179;
  t2530 = -0.15513984e2 * t2499 * t2378 + 0.23270976e2 * t1288 * t495 * t538 - 0.3878496e1 * t582 * t2384 - 0.5171328e1 * t582 * t218 * t1228 - 0.7756992e1 * t2510 * t495 + 0.15513984e2 * t2513 * t1180 - 0.15513984e2 * t1283 * t1291 - 0.55305022007122575148e-5 * t241 * t514 * t1275 + 0.30417762103917416332e-4 * t1274 * t2401 * t76 + 0.2364980241553521175e1 * t244 * t2445 + 0.5365921556465972414e0 * t1261 * t542 - 0.16693978175671914177e1 * t568 * t1232;
  t2532 = my_piecewise3(t74, 0.2364980241553521175e1 * t44 * t2445 - 0.80487309643795296057e-1 * t59 * t2448 + 0.30417762103917416332e-4 * t514 * t2401 * t76 - 0.41944031231462577189e-7 * t2421 * t2454, t2498 + t2530);
  t2533 = my_piecewise3(t41, -0.15513984e2 * t2377 * t2378 + 0.23270976e2 * t1179 * t495 * t538 - 0.3878496e1 * t494 * t2384 - 0.5171328e1 * t1183 * t1228 + 0.646416e0 * t198 * t2441, t2532);
  t2538 = t5 * t193 * t1298;
  t2541 = t5 * t486 * t589;
  t2544 = t5 * t1168 * t254;
  t2547 = 0.1e1 / t191 / t463;
  t2551 = 0.1e2 / 0.27e2 * t5 * t25 * t2547 * t102;
  t2554 = t5 * t186 * t1167 * t102;
  t2558 = t5 * t1144 * t192 * t102;
  t2562 = t5 * t472 * t485 * t102;
  t2568 = t5 * t477 * t589;
  t2571 = t5 * t1156 * t254;
  t2575 = t19 * t19;
  t2577 = 0.1e1 / t458 / t2575;
  t2578 = t460 * t460;
  t2584 = t468 * t468;
  t2591 = t16 / t1135 / t6;
  t2593 = -0.24e2 * t1136 + 0.24e2 * t2591;
  t2594 = my_piecewise5(t10, 0, t14, 0, t2593);
  t2598 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2577 * t2578 - 0.16e2 / 0.9e1 * t1128 * t460 * t468 + 0.4e1 / 0.3e1 * t459 * t2584 + 0.16e2 / 0.9e1 * t1132 * t1140 + 0.4e1 / 0.3e1 * t23 * t2594);
  t2607 = t5 * t1149 * t254;
  t2609 = -0.3e1 / 0.8e1 * t5 * t27 * t2533 - t2538 / 0.2e1 + t2541 / 0.2e1 - 0.5e1 / 0.9e1 * t2544 + t2551 - 0.5e1 / 0.9e1 * t2554 - t2558 / 0.2e1 + t2562 / 0.2e1 - 0.3e1 / 0.2e1 * t5 * t187 * t1298 - 0.3e1 / 0.2e1 * t2568 + t2571 - 0.9e1 / 0.4e1 * t5 * t473 * t589 - 0.3e1 / 0.8e1 * t5 * t2598 * t26 * t102 - 0.3e1 / 0.2e1 * t5 * t1145 * t254 - 0.3e1 / 0.2e1 * t2607;
  t2610 = my_piecewise3(t1, 0, t2609);
  t2611 = t109 * t109;
  t2613 = 0.1e1 / t595 / t2611;
  t2614 = t597 * t597;
  t2620 = t601 * t601;
  t2626 = my_piecewise5(t14, 0, t10, 0, -t2593);
  t2630 = my_piecewise3(t110, 0, 0.4e2 / 0.81e2 * t2613 * t2614 - 0.16e2 / 0.9e1 * t1305 * t597 * t601 + 0.4e1 / 0.3e1 * t596 * t2620 + 0.16e2 / 0.9e1 * t1309 * t1313 + 0.4e1 / 0.3e1 * t111 * t2626);
  t2637 = t5 * t1317 * t192 * t174;
  t2641 = t5 * t605 * t485 * t174;
  t2645 = t5 * t264 * t1167 * t174;
  t2650 = 0.1e2 / 0.27e2 * t5 * t113 * t2547 * t174;
  t2652 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t2630 * t26 * t174 - t2637 / 0.2e1 + t2641 / 0.2e1 - 0.5e1 / 0.9e1 * t2645 + t2650);
  tv4rho40 = 0.4e1 * t1303 + 0.4e1 * t1335 + t6 * (t2610 + t2652);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2659 = t5 * t281 * t1167 * t102;
  t2663 = t5 * t1355 * t192 * t102;
  t2667 = t5 * t630 * t485 * t102;
  t2668 = t2667 / 0.4e1;
  t2673 = t5 * t1367 * t254;
  t2674 = t2673 / 0.4e1;
  t2676 = t5 * t635 * t589;
  t2679 = t5 * t1360 * t254;
  t2700 = 0.12e2 * t1136;
  t2701 = 0.24e2 * t2591;
  t2702 = -t2700 + t2701;
  t2703 = my_piecewise5(t10, 0, t14, 0, t2702);
  t2707 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2577 * t278 * t1129 - 0.8e1 / 0.9e1 * t1128 * t626 * t460 - 0.8e1 / 0.9e1 * t1340 * t183 * t468 + 0.4e1 / 0.3e1 * t459 * t1351 * t183 + 0.4e1 / 0.3e1 * t1343 * t468 + 0.4e1 / 0.9e1 * t622 * t1140 + 0.4e1 / 0.3e1 * t23 * t2703);
  t2724 = -0.5e1 / 0.36e2 * t2659 - 0.3e1 / 0.8e1 * t2663 + t2668 - 0.3e1 / 0.8e1 * t5 * t282 * t1298 + t2674 - 0.3e1 / 0.8e1 * t2676 - 0.3e1 / 0.4e1 * t2679 - 0.9e1 / 0.8e1 * t5 * t631 * t589 - 0.3e1 / 0.8e1 * t5 * t2707 * t26 * t102 - 0.9e1 / 0.8e1 * t5 * t1356 * t254 - t2538 / 0.8e1 + t2541 / 0.4e1 - 0.5e1 / 0.12e2 * t2544 + t2551 - 0.5e1 / 0.12e2 * t2554 - t2558 / 0.8e1 + t2562 / 0.4e1 - 0.3e1 / 0.8e1 * t2568 + t2571 / 0.2e1 - 0.3e1 / 0.8e1 * t2607;
  t2725 = my_piecewise3(t1, 0, t2724);
  t2743 = my_piecewise5(t14, 0, t10, 0, -t2702);
  t2747 = my_piecewise3(t110, 0, 0.4e2 / 0.81e2 * t2613 * t289 * t1306 - 0.8e1 / 0.9e1 * t1305 * t649 * t597 - 0.8e1 / 0.9e1 * t1384 * t261 * t601 + 0.4e1 / 0.3e1 * t596 * t1393 * t261 + 0.4e1 / 0.3e1 * t1387 * t601 + 0.4e1 / 0.9e1 * t646 * t1313 + 0.4e1 / 0.3e1 * t111 * t2743);
  t2754 = t5 * t1397 * t192 * t174;
  t2758 = t5 * t653 * t485 * t174;
  t2759 = t2758 / 0.4e1;
  t2762 = t5 * t292 * t1167 * t174;
  t2771 = t5 * t1322 * t354;
  t2774 = t5 * t1326 * t354;
  t2775 = t2774 / 0.4e1;
  t2777 = t5 * t1330 * t354;
  t2779 = -0.3e1 / 0.8e1 * t5 * t2747 * t26 * t174 - 0.3e1 / 0.8e1 * t2754 + t2759 - 0.5e1 / 0.36e2 * t2762 - t2637 / 0.8e1 + t2641 / 0.4e1 - 0.5e1 / 0.12e2 * t2645 + t2650 - 0.3e1 / 0.8e1 * t5 * t1318 * t354 - 0.3e1 / 0.8e1 * t2771 + t2775 - 0.5e1 / 0.36e2 * t2777;
  t2780 = my_piecewise3(t107, 0, t2779);
  tv4rho41 = t1303 + t1335 + 0.3e1 * t1383 + 0.3e1 * t1422 + t6 * (t2725 + t2780);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2798 = t626 * t626;
  t2811 = my_piecewise5(t10, 0, t14, 0, t2701);
  t2815 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2577 * t675 * t460 - 0.32e2 / 0.27e2 * t1340 * t183 * t626 - 0.8e1 / 0.27e2 * t1425 * t468 + 0.8e1 / 0.9e1 * t459 * t2798 + 0.8e1 / 0.9e1 * t622 * t1351 - 0.8e1 / 0.27e2 * t1128 * t680 * t460 + 0.8e1 / 0.9e1 * t459 * t1434 * t183 + 0.4e1 / 0.9e1 * t1430 * t468 + 0.4e1 / 0.3e1 * t23 * t2811);
  t2824 = t5 * t1443 * t254;
  t2828 = t5 * t684 * t485 * t102;
  t2832 = t5 * t1438 * t192 * t102;
  t2845 = -0.3e1 / 0.8e1 * t5 * t685 * t589 - 0.3e1 / 0.8e1 * t5 * t2815 * t26 * t102 - 0.3e1 / 0.4e1 * t5 * t1439 * t254 - t2824 / 0.4e1 + t2828 / 0.12e2 - t2832 / 0.4e1 - 0.5e1 / 0.18e2 * t2659 - t2663 / 0.4e1 + t2667 / 0.3e1 + t2673 / 0.3e1 - t2676 / 0.4e1 - t2679 / 0.2e1 + t2541 / 0.12e2 - 0.5e1 / 0.18e2 * t2544 + t2551 - 0.5e1 / 0.18e2 * t2554 + t2562 / 0.12e2 + t2571 / 0.6e1;
  t2846 = my_piecewise3(t1, 0, t2845);
  t2855 = t649 * t649;
  t2868 = my_piecewise5(t14, 0, t10, 0, -t2701);
  t2872 = my_piecewise3(t110, 0, 0.4e2 / 0.81e2 * t2613 * t692 * t597 - 0.32e2 / 0.27e2 * t1384 * t261 * t649 - 0.8e1 / 0.27e2 * t1455 * t601 + 0.8e1 / 0.9e1 * t596 * t2855 + 0.8e1 / 0.9e1 * t646 * t1393 - 0.8e1 / 0.27e2 * t1305 * t696 * t597 + 0.8e1 / 0.9e1 * t596 * t1464 * t261 + 0.4e1 / 0.9e1 * t1460 * t601 + 0.4e1 / 0.3e1 * t111 * t2868);
  t2879 = t5 * t1468 * t192 * t174;
  t2883 = t5 * t700 * t485 * t174;
  t2892 = t5 * t1402 * t354;
  t2895 = t5 * t1406 * t354;
  t2906 = t5 * t610 * t801;
  t2909 = t5 * t614 * t801;
  t2911 = -0.3e1 / 0.8e1 * t5 * t2872 * t26 * t174 - t2879 / 0.4e1 + t2883 / 0.12e2 - t2754 / 0.4e1 + t2758 / 0.3e1 - 0.5e1 / 0.18e2 * t2762 - 0.3e1 / 0.4e1 * t5 * t1398 * t354 - t2892 / 0.2e1 + t2895 / 0.6e1 + t2641 / 0.12e2 - 0.5e1 / 0.18e2 * t2645 + t2650 - t2771 / 0.4e1 + t2774 / 0.3e1 - 0.5e1 / 0.18e2 * t2777 - 0.3e1 / 0.8e1 * t5 * t606 * t801 - t2906 / 0.4e1 + t2909 / 0.12e2;
  t2912 = my_piecewise3(t107, 0, t2911);
  tv4rho42 = 0.2e1 * t1383 + 0.2e1 * t1422 + 0.2e1 * t1454 + 0.2e1 * t1493 + t6 * (t2846 + t2912);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2932 = t2700 + t2701;
  t2933 = my_piecewise5(t10, 0, t14, 0, t2932);
  t2937 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2577 * t1498 * t183 - 0.8e1 / 0.9e1 * t1425 * t626 - 0.8e1 / 0.9e1 * t1340 * t680 * t183 + 0.4e1 / 0.3e1 * t1343 * t680 + 0.4e1 / 0.3e1 * t622 * t1434 + 0.4e1 / 0.9e1 * t459 * t1505 * t183 + 0.4e1 / 0.3e1 * t23 * t2933);
  t2944 = t5 * t1509 * t192 * t102;
  t2955 = -0.3e1 / 0.8e1 * t5 * t2937 * t26 * t102 - t2944 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1510 * t254 - 0.3e1 / 0.8e1 * t2832 + t2828 / 0.4e1 - 0.3e1 / 0.8e1 * t2824 + t2668 - 0.5e1 / 0.12e2 * t2659 + t2674 - 0.5e1 / 0.36e2 * t2554 + t2551 - 0.5e1 / 0.36e2 * t2544;
  t2956 = my_piecewise3(t1, 0, t2955);
  t2973 = my_piecewise5(t14, 0, t10, 0, -t2932);
  t2977 = my_piecewise3(t110, 0, 0.4e2 / 0.81e2 * t2613 * t1518 * t261 - 0.8e1 / 0.9e1 * t1455 * t649 - 0.8e1 / 0.9e1 * t1384 * t696 * t261 + 0.4e1 / 0.3e1 * t1387 * t696 + 0.4e1 / 0.3e1 * t646 * t1464 + 0.4e1 / 0.9e1 * t596 * t1524 * t261 + 0.4e1 / 0.3e1 * t111 * t2973);
  t2984 = t5 * t1528 * t192 * t174;
  t2992 = t5 * t1473 * t354;
  t3001 = t5 * t658 * t801;
  t3011 = t5 * t269 * t1664;
  t3013 = -0.3e1 / 0.8e1 * t5 * t2977 * t26 * t174 - t2984 / 0.8e1 - 0.3e1 / 0.8e1 * t2879 + t2883 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1469 * t354 - 0.3e1 / 0.8e1 * t2992 + t2759 - 0.5e1 / 0.12e2 * t2762 - 0.3e1 / 0.4e1 * t2892 + t2895 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t654 * t801 - 0.3e1 / 0.8e1 * t3001 - 0.5e1 / 0.36e2 * t2645 + t2650 + t2775 - 0.5e1 / 0.12e2 * t2777 - 0.3e1 / 0.8e1 * t2906 + t2909 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t265 * t1664 - t3011 / 0.8e1;
  t3014 = my_piecewise3(t107, 0, t3013);
  tv4rho43 = 0.3e1 * t1454 + 0.3e1 * t1493 + t1517 + t1669 + t6 * (t2956 + t3014);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t3019 = t675 * t675;
  t3024 = t680 * t680;
  t3030 = 0.24e2 * t1136 + 0.24e2 * t2591;
  t3031 = my_piecewise5(t10, 0, t14, 0, t3030);
  t3035 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2577 * t3019 - 0.16e2 / 0.9e1 * t1425 * t680 + 0.4e1 / 0.3e1 * t459 * t3024 + 0.16e2 / 0.9e1 * t622 * t1505 + 0.4e1 / 0.3e1 * t23 * t3031);
  t3044 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t3035 * t26 * t102 - t2944 / 0.2e1 + t2828 / 0.2e1 - 0.5e1 / 0.9e1 * t2659 + t2551);
  t3046 = 0.1e1 / t1544 / t145;
  t3047 = t712 * t712;
  t3053 = t750 * t750;
  t3058 = sigma[2] * t164;
  t3059 = t44 * t3058;
  t3066 = t135 / t116 / t931;
  t3070 = 0.1e1 / t741;
  t3074 = t731 * t162;
  t3076 = 0.1e1 / t124 / t3074;
  t3084 = t59 * t131;
  t3090 = t740 * t3076;
  t3099 = t740 * t740;
  t3104 = t745 * t745;
  t3107 = 0.1e1 / t3104 * t29 * t58;
  t3110 = 0.2618e5 / 0.19683e5 * t3059 + 0.10348984450794069599e1 * t44 * t3058 * t131 - 0.30112066101575181503e0 * t59 * t3066 * t131 + 0.84429740092262542601e-1 * t730 * t3070 * t131 - 0.10760976107480464527e-2 * t1570 * t3076 * t1575 + 0.36601959549253280704e-5 * t513 * t1907 / t116 / t2161 * t3084 + 0.28445320491234913052e-1 * t59 * t3066 * t314 - 0.99208059313830153663e-5 * t527 * t3090 * t746 + 0.11447009058958058762e-12 * t1585 / t1586 / t136 * t1591 - 0.66418335807601710336e-18 * t3099 / t116 / t1586 / t931 * t3107;
  t3114 = t3058 * t151;
  t3117 = t3066 * t151;
  t3123 = t44 * t151;
  t3142 = -0.8543888888888888889e1 * t33 * t115 * t139 + 0.50420740740740740741e2 * t3059 - 0.74027789798683034258e1 * t156 * t1071 + 0.537551440329218107e1 * t59 * t3066 - 0.6969360853909465021e0 * t88 * t161 * t1079;
  t3149 = t347 * t1545;
  t3154 = t170 * t3046;
  t3165 = 0.646416e0 * t349 * t3110 + 0.2585664e1 * t791 * t1594 + t3142 * t148 - t3142 * t153 - 0.5171328e1 * t794 * t318 * t1594 + 0.15513984e2 * t3149 * t1546 - 0.15513984e2 * t1649 * t1657 - 0.15513984e2 * t3154 * t3047 + 0.23270976e2 * t1654 * t712 * t750 - 0.3878496e1 * t794 * t3053 - 0.55305022007122575148e-5 * t341 * t729 * t1641;
  t3169 = t789 * t711;
  t3172 = t1624 * t28;
  t3176 = t777 * t29;
  t3177 = t3176 * t58;
  t3194 = t1644 * t298;
  t3199 = 0.30417762103917416332e-4 * t1640 * t3070 * t151 - 0.7756992e1 * t3169 * t712 - 0.975622101175631348e-1 * t3172 * t43 * t321 - 0.44395451693206802728e-2 * t3177 * t757 + 0.32556664575018322e-1 * t1633 * t1601 - 0.80487309643795296057e-1 * t786 * t3117 - 0.41944031231462577189e-7 * t168 * t740 * t3076 * t3123 - 0.16693978175671914177e1 * t780 * t1598 + 0.2364980241553521175e1 * t344 * t3114 + 0.5365921556465972414e0 * t1627 * t754 + 0.2585664e1 * t3194 * t318 + 0.3878496e1 * t1646 * t750;
  t3201 = my_piecewise3(t149, 0.2364980241553521175e1 * t44 * t3114 - 0.80487309643795296057e-1 * t59 * t3117 + 0.30417762103917416332e-4 * t729 * t3070 * t151 - 0.41944031231462577189e-7 * t3090 * t3123, t3165 + t3199);
  t3202 = my_piecewise3(t122, -0.15513984e2 * t3046 * t3047 + 0.23270976e2 * t1545 * t712 * t750 - 0.3878496e1 * t711 * t3053 - 0.5171328e1 * t1549 * t1594 + 0.646416e0 * t298 * t3110, t3201);
  t3212 = t692 * t692;
  t3217 = t696 * t696;
  t3223 = my_piecewise5(t14, 0, t10, 0, -t3030);
  t3227 = my_piecewise3(t110, 0, 0.4e2 / 0.81e2 * t2613 * t3212 - 0.16e2 / 0.9e1 * t1455 * t696 + 0.4e1 / 0.3e1 * t596 * t3217 + 0.16e2 / 0.9e1 * t646 * t1524 + 0.4e1 / 0.3e1 * t111 * t3223);
  t3243 = -0.3e1 / 0.8e1 * t5 * t114 * t3202 - 0.3e1 / 0.2e1 * t5 * t293 * t1664 - 0.9e1 / 0.4e1 * t5 * t701 * t801 - 0.3e1 / 0.8e1 * t5 * t3227 * t26 * t174 - 0.3e1 / 0.2e1 * t5 * t1529 * t354 - t2984 / 0.2e1 - 0.3e1 / 0.2e1 * t2992 - 0.3e1 / 0.2e1 * t3001 - t3011 / 0.2e1 + t2883 / 0.2e1 + t2895 + t2909 / 0.2e1 - 0.5e1 / 0.9e1 * t2777 - 0.5e1 / 0.9e1 * t2762 + t2650;
  t3244 = my_piecewise3(t107, 0, t3243);
  tv4rho44 = 0.4e1 * t1517 + 0.4e1 * t1669 + t6 * (t3044 + t3244);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t3252 = t5 * t1149 * t404;
  t3258 = t5 * t1156 * t404;
  t3261 = t5 * t477 * t893;
  t3268 = 0.5e1 / 0.36e2 * t5 * t1168 * t404;
  t3270 = t5 * t486 * t893;
  t3273 = t5 * t193 * t1809;
  t3290 = t44 * t1187;
  t3295 = t1195 * sigma[0];
  t3314 = t514 * t1207;
  t3328 = -0.154e4 / 0.6561e4 * t3290 - 0.1826291373669541694e0 * t44 * t1187 * t53 + 0.75008395704284748149e-1 * t59 * t3295 * t53 - 0.25323980763139613588e-1 * t513 * t1200 * t1706 + 0.36647711998689847306e-3 * t513 * t1207 * t514 * t1209 - 0.13725734830969980264e-5 * t1204 / t35 / t1220 * t2415 - 0.68268769178963791327e-2 * t59 * t3295 * t214 + 0.30275562928530926203e-5 * t527 * t3314 * t534 - 0.3953736681548013717e-13 * t1719 * t1222 * t1225 + 0.24906875927850641376e-18 * t528 * t514 / t35 / t1220 / t516 * t2438;
  t3335 = t3295 * t76;
  t3402 = 0.98583333333333333333e0 * t33 * t380 * t1243 - 0.88977777777777777779e1 * t3290 + 0.15863097814003507342e1 * t34 * t1248 - 0.12901234567901234568e1 * t59 * t3295 + 0.18024209104938271606e0 * t88 * t81 * t1254;
  t3404 = -0.7756992e1 * t1283 * t1789 - 0.13826255501780643787e-5 * t392 * t514 * t1275 + 0.1555453743950322426e-5 * t241 * t518 * t1796 - 0.98512070450187086981e-5 * t96 * t1200 * t1796 - 0.3878496e1 * t582 * t1725 * t218 - 0.3878496e1 * t582 * t843 * t538 - 0.3878496e1 * t1799 * t1291 - 0.3878496e1 * t2510 * t886 - 0.1292832e1 * t582 * t374 * t1228 + 0.11635488e2 * t2513 * t1784 + 0.11635488e2 * t1288 * t843 * t495 - 0.3878496e1 * t1283 * t1792 - 0.15513984e2 * t2499 * t374 * t1180 + 0.11635488e2 * t1288 * t886 * t538 - 0.73171657588172351097e-1 * t1260 * t874 + 0.26829607782329862069e0 * t567 * t1752 - 0.41734945439179785441e0 * t243 * t43 * t1187 * t76 + 0.91464571985215438873e-2 * t2458 * t395 + t3402 * t73;
  t3421 = t1770 * t28;
  t3425 = t865 * t29;
  t3426 = t3425 * t58;
  t3443 = t1768 * t198;
  t3446 = t398 * t1179;
  t3449 = t879 * t494;
  t3452 = -t3402 * t78 + 0.81391661437545805002e-2 * t1744 * t1235 + 0.2682960778232986207e0 * t1740 * t542 + 0.15729011711798466446e-7 * t96 * t1207 * t514 * t2454 - 0.74917324732286479603e-2 * t1267 * t1732 + 0.83241471924762755115e-3 * t2463 * t850 + 0.21026179204699332958e-1 * t574 * t3335 - 0.731716575881723511e-1 * t3421 * t43 * t221 - 0.22197725846603401364e-2 * t3426 * t545 - 0.41734945439179785442e0 * t868 * t1232 + 0.646416e0 * t2491 * t374 + 0.1939248e1 * t1280 * t843 + 0.1939248e1 * t579 * t1725 + 0.646416e0 * t249 * t3328 + 0.1939248e1 * t1774 * t538 + 0.646416e0 * t881 * t1228 + 0.1939248e1 * t3443 * t218 + 0.3878496e1 * t3446 * t1180 - 0.3878496e1 * t3449 * t495;
  t3454 = my_piecewise3(t74, -0.41734945439179785441e0 * t44 * t1187 * t76 + 0.21026179204699332958e-1 * t59 * t3335 - 0.98512070450187086981e-5 * t1200 * t60 * t76 + 0.15729011711798466446e-7 * t3314 * t2454, t3404 + t3452);
  t3455 = my_piecewise3(t41, -0.15513984e2 * t2377 * t374 * t1180 + 0.11635488e2 * t1179 * t843 * t495 + 0.11635488e2 * t1688 * t1291 - 0.3878496e1 * t494 * t1725 * t218 - 0.3878496e1 * t1691 * t538 - 0.1292832e1 * t815 * t1228 + 0.646416e0 * t198 * t3328, t3454);
  t3460 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1145 * t404 - 0.3e1 / 0.8e1 * t3252 - 0.9e1 / 0.8e1 * t5 * t473 * t893 + t3258 / 0.4e1 - 0.3e1 / 0.4e1 * t3261 - 0.9e1 / 0.8e1 * t5 * t187 * t1809 - t3268 + t3270 / 0.4e1 - 0.3e1 / 0.8e1 * t3273 - 0.3e1 / 0.8e1 * t5 * t27 * t3455);
  tv4rho3sigma0 = t6 * t3460 + 0.3e1 * t1814;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t3467 = t5 * t1322 * t451;
  t3470 = t5 * t1326 * t451;
  t3474 = 0.5e1 / 0.36e2 * t5 * t1330 * t451;
  t3476 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1318 * t451 - 0.3e1 / 0.8e1 * t3467 + t3470 / 0.4e1 - t3474);
  tv4rho3sigma2 = t6 * t3476 + 0.3e1 * t1827;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t3478 = 0.2e1 * t1841;
  t3484 = t5 * t1360 * t404 / 0.4e1;
  t3489 = t5 * t1367 * t404;
  t3493 = t5 * t635 * t893 / 0.4e1;
  t3502 = -0.3e1 / 0.8e1 * t5 * t1356 * t404 - t3484 - 0.3e1 / 0.4e1 * t5 * t631 * t893 + t3489 / 0.12e2 - t3493 - 0.3e1 / 0.8e1 * t5 * t282 * t1809 - t3252 / 0.8e1 + t3258 / 0.6e1 - t3261 / 0.4e1 - t3268 + t3270 / 0.6e1 - t3273 / 0.8e1;
  t3503 = my_piecewise3(t1, 0, t3502);
  tv4rho3sigma3 = t6 * t3503 + t1814 + t3478;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t3505 = 0.2e1 * t1857;
  t3511 = t5 * t1402 * t451 / 0.4e1;
  t3513 = t5 * t1406 * t451;
  t3522 = t5 * t610 * t996 / 0.4e1;
  t3524 = t5 * t614 * t996;
  t3527 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1398 * t451 - t3511 + t3513 / 0.12e2 - t3467 / 0.8e1 + t3470 / 0.6e1 - t3474 - 0.3e1 / 0.8e1 * t5 * t606 * t996 - t3522 + t3524 / 0.12e2);
  tv4rho3sigma5 = t6 * t3527 + t1827 + t3505;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t3533 = t5 * t1443 * t404;
  t3542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1439 * t404 - t3533 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t685 * t893 - t3484 + t3489 / 0.6e1 - t3493 + t3258 / 0.12e2 - t3268 + t3270 / 0.12e2);
  tv4rho3sigma6 = t6 * t3542 + t1865 + t3478;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t3548 = t5 * t1473 * t451;
  t3555 = t5 * t658 * t996;
  t3563 = t5 * t269 * t1997;
  t3565 = -0.3e1 / 0.8e1 * t5 * t1469 * t451 - t3548 / 0.8e1 - t3511 + t3513 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t654 * t996 - t3555 / 0.4e1 + t3470 / 0.12e2 - t3474 - t3522 + t3524 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t265 * t1997 - t3563 / 0.8e1;
  t3566 = my_piecewise3(t107, 0, t3565);
  tv4rho3sigma8 = t6 * t3566 + t2002 + t3505;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t3575 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1510 * t404 - 0.3e1 / 0.8e1 * t3533 + t3489 / 0.4e1 - t3268);
  tv4rho3sigma9 = t6 * t3575 + 0.3e1 * t1865;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t3607 = t44 * t1553;
  t3612 = t1561 * sigma[2];
  t3631 = t729 * t1573;
  t3645 = -0.154e4 / 0.6561e4 * t3607 - 0.1826291373669541694e0 * t44 * t1553 * t131 + 0.75008395704284748149e-1 * t59 * t3612 * t131 - 0.25323980763139613588e-1 * t513 * t1566 * t1894 + 0.36647711998689847306e-3 * t513 * t1573 * t729 * t1575 - 0.13725734830969980264e-5 * t1570 / t116 / t1586 * t3084 - 0.68268769178963791327e-2 * t59 * t3612 * t314 + 0.30275562928530926203e-5 * t527 * t3631 * t746 - 0.3953736681548013717e-13 * t1907 * t1588 * t1591 + 0.24906875927850641376e-18 * t740 * t729 / t116 / t1586 / t731 * t3107;
  t3652 = t3612 * t151;
  t3719 = -0.98583333333333333333e0 * t33 * t427 * t1609 + 0.88977777777777777779e1 * t3607 - 0.15863097814003507342e1 * t115 * t1614 + 0.12901234567901234568e1 * t59 * t3612 - 0.18024209104938271606e0 * t88 * t156 * t1620;
  t3721 = -0.15513984e2 * t3154 * t421 * t1546 + 0.11635488e2 * t1654 * t946 * t712 - 0.3878496e1 * t1991 * t1657 - 0.3878496e1 * t3169 * t989 + 0.11635488e2 * t1654 * t989 * t750 + 0.91464571985215438873e-2 * t3172 * t442 - 0.7756992e1 * t1649 * t1981 - 0.3878496e1 * t794 * t1913 * t318 + 0.11635488e2 * t3149 * t1940 - 0.3878496e1 * t1649 * t1984 - 0.3878496e1 * t794 * t946 * t750 - 0.98512070450187086981e-5 * t168 * t1566 * t1988 - 0.13826255501780643787e-5 * t439 * t729 * t1641 + 0.1555453743950322426e-5 * t341 * t733 * t1988 - 0.1292832e1 * t794 * t421 * t1594 + 0.26829607782329862069e0 * t779 * t1962 - 0.73171657588172351097e-1 * t1626 * t977 - 0.41734945439179785441e0 * t343 * t43 * t1553 * t151 + t3719 * t153;
  t3732 = t1958 * t28;
  t3740 = t968 * t29;
  t3741 = t3740 * t58;
  t3748 = t982 * t711;
  t3763 = t1956 * t298;
  t3766 = t445 * t1545;
  t3769 = -t3719 * t148 - 0.41734945439179785442e0 * t971 * t1598 + 0.15729011711798466446e-7 * t168 * t1573 * t729 * t3123 + 0.83241471924762755115e-3 * t3177 * t953 - 0.731716575881723511e-1 * t3732 * t43 * t321 + 0.21026179204699332958e-1 * t786 * t3652 - 0.74917324732286479603e-2 * t1633 * t1920 - 0.22197725846603401364e-2 * t3741 * t757 + 0.2682960778232986207e0 * t1968 * t754 + 0.81391661437545805002e-2 * t1972 * t1601 - 0.3878496e1 * t3748 * t712 + 0.646416e0 * t349 * t3645 + 0.1939248e1 * t1927 * t750 + 0.646416e0 * t984 * t1594 + 0.646416e0 * t3194 * t421 + 0.1939248e1 * t1646 * t946 + 0.1939248e1 * t791 * t1913 + 0.1939248e1 * t3763 * t318 + 0.3878496e1 * t3766 * t1546;
  t3771 = my_piecewise3(t149, -0.41734945439179785441e0 * t44 * t1553 * t151 + 0.21026179204699332958e-1 * t59 * t3652 - 0.98512070450187086981e-5 * t1566 * t135 * t151 + 0.15729011711798466446e-7 * t3631 * t3123, t3721 + t3769);
  t3772 = my_piecewise3(t122, -0.15513984e2 * t3046 * t421 * t1546 + 0.11635488e2 * t1545 * t946 * t712 + 0.11635488e2 * t1876 * t1657 - 0.3878496e1 * t711 * t1913 * t318 - 0.3878496e1 * t1879 * t750 - 0.1292832e1 * t918 * t1594 + 0.646416e0 * t298 * t3645, t3771);
  t3777 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t1529 * t451 - 0.3e1 / 0.8e1 * t3548 - 0.9e1 / 0.8e1 * t5 * t701 * t996 + t3513 / 0.4e1 - 0.3e1 / 0.4e1 * t3555 - 0.9e1 / 0.8e1 * t5 * t293 * t1997 - t3474 + t3524 / 0.4e1 - 0.3e1 / 0.8e1 * t3563 - 0.3e1 / 0.8e1 * t5 * t114 * t3772);
  tv4rho3sigma11 = t6 * t3777 + 0.3e1 * t2002;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t3784 = t5 * t477 * t1059;
  t3791 = t5 * t486 * t1059 / 0.12e2;
  t3793 = t5 * t193 * t2111;
  t3802 = t843 * t843;
  t3846 = -0.11266083149260159801e-1 * t59 * t507 * t53 + 0.61889338352843641011e-2 * t1705 * t2022 - 0.11581088763630920848e-3 * t513 * t531 * t60 * t1209 + 0.5147150561613742599e-6 * t515 / t35 / t516 / t235 * t2415 + 0.93093776153132442719e-3 * t59 * t507 * t214 - 0.77376884737057184278e-6 * t527 * t531 * t534 * t60 + 0.1284964421503104458e-13 * t1721 * t1225 * t528 - 0.93400784729439905162e-19 * t1219 / t35 / t1220 / t235 * t2438;
  t3878 = 0.147875e0 * t33 * t1030 * t550 - 0.13219248178336256118e0 * t380 * t555 + 0.17592592592592592593e0 * t59 * t507 - 0.31195746527777777779e-1 * t88 * t34 * t561;
  t3890 = t2061 * t28;
  t3894 = t1041 * t29;
  t3895 = t3894 * t58;
  t3926 = 0.89432025941099540233e-1 * t2064 * t542 + 0.17886405188219908047e0 * t867 * t1752 + 0.11098862923301700682e-2 * t1266 * t2076 - 0.35146399257122052158e-2 * t573 * t58 * t507 * t76 - 0.975622101175631348e-1 * t1739 * t874 + 0.15513984e2 * t1288 * t886 * t843 - 0.10405183990595344389e-3 * t2462 * t1046 + 0.18292914397043087775e-1 * t3421 * t395 - 0.15513984e2 * t2499 * t1003 * t495 + 0.7756992e1 * t3446 * t1784 - 0.3888634359875806065e-6 * t241 * t829 * t2080;
  t3957 = t2083 * t198;
  t3968 = t1049 * t494;
  t3977 = 0.1292832e1 * t881 * t1725 - 0.1292832e1 * t2510 * t1003 + 0.1292832e1 * t3957 * t218 + 0.646416e0 * t2085 * t538 + 0.1292832e1 * t3443 * t374 + 0.2585664e1 * t1774 * t843 - 0.2585664e1 * t582 * t3802 - 0.1292832e1 * t3968 * t495 + 0.646416e0 * t1280 * t1023 + 0.1292832e1 * t579 * t2040 + 0.646416e0 * t249 * t3846;
  t3980 = my_piecewise3(t74, -0.35146399257122052158e-2 * t59 * t507 * t76 + 0.27868546245776610132e-5 * t518 * sigma[0] * t76 - 0.58983793919244249171e-8 * t531 * t60 * t2454, -0.2585664e1 * t582 * t2040 * t218 - 0.1292832e1 * t582 * t1023 * t538 - 0.2585664e1 * t1283 * t2104 + t3878 * t73 - t3878 * t78 + 0.11098862923301700682e-2 * t3426 * t850 - 0.49944883154857653069e-2 * t1744 * t1732 - 0.58983793919244249171e-8 * t96 * t531 * t60 * t2454 - 0.487811050587815674e-1 * t3890 * t43 * t221 - 0.73992419488678004547e-3 * t3895 * t545 + t3926 + 0.27868546245776610132e-5 * t1795 * t2080 + 0.3878496e1 * t1288 * t1023 * t495 - 0.2585664e1 * t582 * t374 * t1725 - 0.5171328e1 * t3449 * t886 - 0.5171328e1 * t1799 * t1789 - 0.2585664e1 * t1799 * t1792 + 0.1036969162633548284e-5 * t392 * t518 * t1796 + 0.7756992e1 * t2513 * t2096 - 0.5171328e1 * t1283 * t2099 + 0.3878496e1 * t1288 * t1003 * t538 + t3977);
  t3981 = my_piecewise3(t41, -0.15513984e2 * t2377 * t1003 * t495 + 0.15513984e2 * t1688 * t1789 + 0.3878496e1 * t2010 * t538 - 0.2585664e1 * t494 * t3802 - 0.2585664e1 * t815 * t1725 + 0.3878496e1 * t1179 * t1023 * t495 - 0.2585664e1 * t494 * t2040 * t218 - 0.1292832e1 * t2015 * t538 + 0.646416e0 * t198 * t3846, t3980);
  t3986 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t473 * t1059 - t3784 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t187 * t2111 + t3791 - t3793 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t3981);
  tv4rho2sigma20 = t6 * t3986 + 0.2e1 * t2116;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t3993 = t5 * t610 * t1120;
  t3997 = t5 * t614 * t1120 / 0.12e2;
  t3999 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t606 * t1120 - t3993 / 0.4e1 + t3997);
  tv4rho2sigma25 = t6 * t3999 + 0.2e1 * t2125;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t4005 = t5 * t635 * t1059;
  t4013 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t631 * t1059 - t4005 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t282 * t2111 - t3784 / 0.8e1 + t3791 - t3793 / 0.8e1);
  tv4rho2sigma26 = t6 * t4013 + t2116 + t2131;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t4019 = t5 * t658 * t1120;
  t4026 = t5 * t269 * t2237;
  t4029 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t654 * t1120 - t4019 / 0.8e1 - t3993 / 0.8e1 + t3997 - 0.3e1 / 0.8e1 * t5 * t265 * t2237 - t4026 / 0.8e1);
  tv4rho2sigma211 = t6 * t4029 + t2125 + t2242;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t4037 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t685 * t1059 - t4005 / 0.4e1 + t3791);
  tv4rho2sigma212 = t6 * t4037 + 0.2e1 * t2131;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t4055 = t946 * t946;
  t4099 = -0.11266083149260159801e-1 * t59 * t724 * t131 + 0.61889338352843641011e-2 * t1893 * t2148 - 0.11581088763630920848e-3 * t513 * t743 * t135 * t1575 + 0.5147150561613742599e-6 * t730 / t116 / t731 / t335 * t3084 + 0.93093776153132442719e-3 * t59 * t724 * t314 - 0.77376884737057184278e-6 * t527 * t743 * t746 * t135 + 0.1284964421503104458e-13 * t1909 * t1591 * t740 - 0.93400784729439905162e-19 * t1585 / t116 / t1586 / t335 * t3107;
  t4125 = 0.147875e0 * t33 * t1091 * t762 - 0.13219248178336256118e0 * t427 * t767 + 0.17592592592592592593e0 * t59 * t724 - 0.31195746527777777779e-1 * t88 * t115 * t773;
  t4129 = t1102 * t29;
  t4130 = t4129 * t58;
  t4141 = t2187 * t28;
  t4177 = 0.15513984e2 * t1654 * t989 * t946 - 0.975622101175631348e-1 * t1967 * t977 + 0.17886405188219908047e0 * t970 * t1962 + 0.11098862923301700682e-2 * t1632 * t2202 - 0.35146399257122052158e-2 * t785 * t58 * t724 * t151 - 0.5171328e1 * t3748 * t989 - 0.5171328e1 * t1991 * t1981 + 0.1036969162633548284e-5 * t439 * t733 * t1988 - 0.3888634359875806065e-6 * t341 * t932 * t2206 + 0.27868546245776610132e-5 * t1987 * t2206 - 0.2585664e1 * t1991 * t1984;
  t4208 = t1110 * t711;
  t4219 = t2209 * t298;
  t4230 = -0.2585664e1 * t794 * t4055 - 0.1292832e1 * t4208 * t712 + 0.646416e0 * t349 * t4099 - 0.1292832e1 * t3169 * t1064 + 0.646416e0 * t1646 * t1084 + 0.1292832e1 * t791 * t2166 + 0.1292832e1 * t4219 * t318 + 0.646416e0 * t2211 * t750 + 0.1292832e1 * t3763 * t421 + 0.2585664e1 * t1927 * t946 + 0.1292832e1 * t984 * t1913;
  t4233 = my_piecewise3(t149, -0.35146399257122052158e-2 * t59 * t724 * t151 + 0.27868546245776610132e-5 * t733 * sigma[2] * t151 - 0.58983793919244249171e-8 * t743 * t135 * t3123, 0.89432025941099540233e-1 * t2190 * t754 + t4125 * t148 - t4125 * t153 - 0.73992419488678004547e-3 * t4130 * t757 + 0.11098862923301700682e-2 * t3741 * t953 - 0.49944883154857653069e-2 * t1972 * t1920 - 0.58983793919244249171e-8 * t168 * t743 * t135 * t3123 - 0.487811050587815674e-1 * t4141 * t43 * t321 + 0.18292914397043087775e-1 * t3732 * t442 - 0.10405183990595344389e-3 * t3176 * t1107 + t4177 + 0.7756992e1 * t3149 * t2222 - 0.5171328e1 * t1649 * t2225 + 0.3878496e1 * t1654 * t1064 * t750 - 0.2585664e1 * t794 * t421 * t1913 - 0.2585664e1 * t1649 * t2230 - 0.2585664e1 * t794 * t2166 * t318 - 0.1292832e1 * t794 * t1084 * t750 + 0.7756992e1 * t3766 * t1940 + 0.3878496e1 * t1654 * t1084 * t712 - 0.15513984e2 * t3154 * t1064 * t712 + t4230);
  t4234 = my_piecewise3(t122, -0.15513984e2 * t3046 * t1064 * t712 + 0.15513984e2 * t1876 * t1981 + 0.3878496e1 * t2136 * t750 - 0.2585664e1 * t711 * t4055 - 0.2585664e1 * t918 * t1913 + 0.3878496e1 * t1545 * t1084 * t712 - 0.2585664e1 * t711 * t2166 * t318 - 0.1292832e1 * t2141 * t750 + 0.646416e0 * t298 * t4099, t4233);
  t4239 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t701 * t1120 - t4019 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t293 * t2237 + t3997 - t4026 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t114 * t4234);
  tv4rho2sigma217 = t6 * t4239 + 0.2e1 * t2242;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t4246 = t5 * t193 * t2304 / 0.8e1;
  t4265 = t43 * sigma[0];
  t4286 = -0.10006060691777115613e-2 * t2021 * t53 + 0.32427048538166578375e-4 * t513 * t838 * t28 * t4265 * t53 - 0.19301814606051534747e-6 * t827 / t35 / t2405 * t2415 + 0.14584124871906066146e-6 * t527 * t2031 * sigma[0] - 0.38125318000641560843e-14 * t2036 * t1225 * t514 + 0.35025294273539964436e-19 * t1719 / t35 / t1220 / t90 * t2438;
  t4293 = t4265 * t76;
  t4297 = t2278 * t28;
  t4315 = 0.950625e-1 * t33 * t2269 * t225 - 0.13219248178336256118e-1 * t1030 * t230 + 0.20345052083333333334e-2 * t88 * t380 * t237;
  t4342 = -0.243905525293907837e-1 * t4297 * t43 * t221 + 0.83241471924762755114e-3 * t3895 * t850 + 0.22118922719716593439e-8 * t96 * t838 * t28 * t4293 + t4315 * t73 - t4315 * t78 + 0.11635488e2 * t1288 * t2297 * t218 + 0.27439371595564631662e-1 * t3890 * t395 - 0.31215551971786033168e-3 * t3425 * t1046 - 0.73171657588172351099e-1 * t2063 * t874 + 0.16648294384952551023e-2 * t1743 * t2076 + 0.1939248e1 * t3957 * t374 + 0.1939248e1 * t2085 * t843 - 0.3878496e1 * t3449 * t1003 + 0.1939248e1 * t881 * t2040 + 0.3878496e1 * t2513 * t2244 + 0.646416e0 * t579 * t2263;
  t4348 = t2287 * t198;
  t4383 = -0.58329515398137090974e-6 * t2079 * t76 + 0.72911894247671363718e-7 * t241 * t1010 * t76 + 0.646416e0 * t4348 * t218 + 0.646416e0 * t249 * t4286 + 0.1939248e1 * t1774 * t1023 - 0.3878496e1 * t3968 * t886 + 0.11635488e2 * t3446 * t2096 - 0.7756992e1 * t1799 * t2099 - 0.3878496e1 * t1799 * t2104 - 0.58329515398137090976e-6 * t392 * t829 * t2080 - 0.3878496e1 * t582 * t843 * t1023 - 0.3878496e1 * t582 * t374 * t2040 - 0.1292832e1 * t582 * t2263 * t218 - 0.15513984e2 * t2499 * t2244 * t218 + 0.11635488e2 * t1288 * t1003 * t843 - 0.3878496e1 * t1283 * t2297;
  t4385 = my_piecewise3(t74, -0.58329515398137090974e-6 * t829 * t76 + 0.22118922719716593439e-8 * t838 * t28 * t4293, t4342 + t4383);
  t4386 = my_piecewise3(t41, -0.15513984e2 * t2377 * t2244 * t218 + 0.11635488e2 * t2010 * t843 + 0.11635488e2 * t1688 * t2104 - 0.3878496e1 * t1691 * t1023 - 0.3878496e1 * t815 * t2040 - 0.1292832e1 * t494 * t2263 * t218 + 0.646416e0 * t198 * t4286, t4385);
  t4391 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t187 * t2304 - t4246 - 0.3e1 / 0.8e1 * t5 * t27 * t4386);
  tv4rhosigma30 = t6 * t4391 + t2308;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t4398 = t5 * t269 * t2369 / 0.8e1;
  t4400 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t265 * t2369 - t4398);
  tv4rhosigma39 = t6 * t4400 + t2373;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t4406 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t282 * t2304 - t4246);
  tv4rhosigma310 = t6 * t4406 + t2308;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t4429 = t43 * sigma[2];
  t4450 = -0.10006060691777115613e-2 * t2147 * t131 + 0.32427048538166578375e-4 * t513 * t941 * t28 * t4429 * t131 - 0.19301814606051534747e-6 * t930 / t116 / t3074 * t3084 + 0.14584124871906066146e-6 * t527 * t2157 * sigma[2] - 0.38125318000641560843e-14 * t2162 * t1591 * t729 + 0.35025294273539964436e-19 * t1907 / t116 / t1586 / t162 * t3107;
  t4457 = t4429 * t151;
  t4461 = t2343 * t28;
  t4479 = 0.950625e-1 * t33 * t2334 * t325 - 0.13219248178336256118e-1 * t1091 * t330 + 0.20345052083333333334e-2 * t88 * t427 * t337;
  t4494 = t2352 * t298;
  t4507 = -0.243905525293907837e-1 * t4461 * t43 * t321 + 0.83241471924762755114e-3 * t4130 * t953 + 0.22118922719716593439e-8 * t168 * t941 * t28 * t4457 + t4479 * t148 - t4479 * t153 - 0.58329515398137090974e-6 * t2205 * t151 + 0.3878496e1 * t3149 * t2309 + 0.646416e0 * t791 * t2328 + 0.646416e0 * t349 * t4450 + 0.72911894247671363718e-7 * t341 * t1071 * t151 + 0.646416e0 * t4494 * t318 + 0.1939248e1 * t4219 * t421 + 0.1939248e1 * t2211 * t946 - 0.3878496e1 * t3748 * t1064 + 0.1939248e1 * t1927 * t1084 + 0.1939248e1 * t984 * t2166;
  t4547 = -0.73171657588172351099e-1 * t2189 * t977 + 0.16648294384952551023e-2 * t1971 * t2202 + 0.27439371595564631662e-1 * t4141 * t442 - 0.31215551971786033168e-3 * t3740 * t1107 + 0.11635488e2 * t1654 * t2362 * t318 + 0.11635488e2 * t3766 * t2222 - 0.7756992e1 * t1991 * t2225 - 0.3878496e1 * t1991 * t2230 - 0.58329515398137090976e-6 * t439 * t932 * t2206 - 0.3878496e1 * t794 * t946 * t1084 - 0.3878496e1 * t794 * t421 * t2166 - 0.1292832e1 * t794 * t2328 * t318 - 0.3878496e1 * t4208 * t989 - 0.15513984e2 * t3154 * t2309 * t318 + 0.11635488e2 * t1654 * t1064 * t946 - 0.3878496e1 * t1649 * t2362;
  t4549 = my_piecewise3(t149, -0.58329515398137090974e-6 * t932 * t151 + 0.22118922719716593439e-8 * t941 * t28 * t4457, t4507 + t4547);
  t4550 = my_piecewise3(t122, -0.15513984e2 * t3046 * t2309 * t318 + 0.11635488e2 * t2136 * t946 + 0.11635488e2 * t1876 * t2230 - 0.3878496e1 * t1879 * t1084 - 0.3878496e1 * t918 * t2166 - 0.1292832e1 * t711 * t2328 * t318 + 0.646416e0 * t298 * t4450, t4549);
  t4555 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t293 * t2369 - t4398 - 0.3e1 / 0.8e1 * t5 * t114 * t4550);
  tv4rhosigma319 = t6 * t4555 + t2373;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t4557 = t1003 * t1003;
  t4562 = t1023 * t1023;
  t4586 = -0.69486532581785525089e-5 * t513 * t1018 * t1209 + 0.723818047726932553e-7 * t1009 / t35 / t1205 * t2415 + 0.95313295001603902108e-15 * t2259 * t1225 * t60 - 0.13672617067411937012e-7 * t527 * t2255 - 0.13134485352577486664e-19 * t528 / t35 / t1220 / t62 * t2438;
  t4631 = 0.1782421875e0 * t33 / t34 / t514 * t37 - 0.49572180668760960442e-2 * t2269 * t82 + 0.152587890625e-3 * t88 * t1030 * t92;
  t4642 = 0.646416e0 * t249 * t4586 + 0.29164757699068545488e-6 * t392 * t1010 * t76 + 0.2585664e1 * t4348 * t374 + 0.3878496e1 * t2085 * t1023 + 0.2585664e1 * t881 * t2263 - 0.15513984e2 * t2499 * t4557 + 0.23270976e2 * t1288 * t1003 * t1023 - 0.3878496e1 * t582 * t4562 - 0.5171328e1 * t582 * t374 * t2263 - 0.7756992e1 * t3968 * t1003 + 0.15513984e2 * t3446 * t2244 - 0.15513984e2 * t1799 * t2297 + t4631 * t73 - t4631 * t78 - 0.82945960198937225395e-9 * t96 * t1018 * t2454 + 0.36585828794086175549e-1 * t4297 * t395 - 0.62431103943572066335e-3 * t3894 * t1046;
  t4643 = my_piecewise3(t74, -0.82945960198937225395e-9 * t1018 * t28 * t43 * t76, t4642);
  t4644 = my_piecewise3(t41, -0.15513984e2 * t2377 * t4557 + 0.23270976e2 * t2010 * t1023 - 0.3878496e1 * t494 * t4562 - 0.5171328e1 * t815 * t2263 + 0.646416e0 * t198 * t4586, t4643);
  t4648 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t4644);
  tv4sigma40 = t6 * t4648;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t4649 = t1064 * t1064;
  t4654 = t1084 * t1084;
  t4678 = -0.69486532581785525089e-5 * t513 * t1079 * t1575 + 0.723818047726932553e-7 * t1070 / t116 / t1571 * t3084 + 0.95313295001603902108e-15 * t2324 * t1591 * t135 - 0.13672617067411937012e-7 * t527 * t2320 - 0.13134485352577486664e-19 * t740 / t116 / t1586 / t137 * t3107;
  t4696 = 0.1782421875e0 * t33 / t115 / t729 * t118 - 0.49572180668760960442e-2 * t2334 * t157 + 0.152587890625e-3 * t88 * t1091 * t164;
  t4734 = t4696 * t148 - t4696 * t153 - 0.15513984e2 * t3154 * t4649 + 0.23270976e2 * t1654 * t1064 * t1084 - 0.3878496e1 * t794 * t4654 - 0.5171328e1 * t794 * t421 * t2328 + 0.15513984e2 * t3766 * t2309 - 0.15513984e2 * t1991 * t2362 - 0.82945960198937225395e-9 * t168 * t1079 * t3123 + 0.36585828794086175549e-1 * t4461 * t442 - 0.62431103943572066335e-3 * t4129 * t1107 - 0.7756992e1 * t4208 * t1064 + 0.29164757699068545488e-6 * t439 * t1071 * t151 + 0.2585664e1 * t4494 * t421 + 0.3878496e1 * t2211 * t1084 + 0.2585664e1 * t984 * t2328 + 0.646416e0 * t349 * t4678;
  t4735 = my_piecewise3(t149, -0.82945960198937225395e-9 * t1079 * t28 * t43 * t151, t4734);
  t4736 = my_piecewise3(t122, -0.15513984e2 * t3046 * t4649 + 0.23270976e2 * t2136 * t1084 - 0.3878496e1 * t711 * t4654 - 0.5171328e1 * t918 * t2328 + 0.646416e0 * t298 * t4678, t4735);
  t4740 = my_piecewise3(t107, 0, -0.3e1 / 0.8e1 * t5 * t114 * t4736);
  tv4sigma414 = t6 * t4740;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

