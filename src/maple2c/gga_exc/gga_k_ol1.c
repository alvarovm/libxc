/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_k_ol1.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t24, t25, t26, t27, t29, t32, t33, t35;
  double t39, t41, t42, t43, t44, t47, t51, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t24 = M_CBRT2;
  t25 = t24 * t24;
  t26 = sigma[0] * t25;
  t27 = rho[0] * rho[0];
  t29 = 0.1e1 / t22 / t27;
  t32 = sqrt(sigma[0]);
  t33 = t25 * t32;
  t35 = 0.1e1 / t21 / rho[0];
  t39 = M_CBRT6;
  t41 = M_PI * M_PI;
  t42 = POW_1_3(t41);
  t43 = t42 * t42;
  t44 = 0.1e1 / t43;
  t47 = 0.1e1 + 0.5e1 / 0.9e1 * (t26 * t29 / 0.72e2 + 0.677e-2 * t33 * t35) * t39 * t44;
  t51 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t20 * t22 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t24, t25, t26, t27, t29, t32, t33, t35;
  double t39, t41, t42, t43, t44, t47, t51, tzk0;

  double t52, t57, t58, t60, t64, t67, t69, t74;
  double tvrho0, t80, t83, t88, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t24 = M_CBRT2;
  t25 = t24 * t24;
  t26 = sigma[0] * t25;
  t27 = rho[0] * rho[0];
  t29 = 0.1e1 / t22 / t27;
  t32 = sqrt(sigma[0]);
  t33 = t25 * t32;
  t35 = 0.1e1 / t21 / rho[0];
  t39 = M_CBRT6;
  t41 = M_PI * M_PI;
  t42 = POW_1_3(t41);
  t43 = t42 * t42;
  t44 = 0.1e1 / t43;
  t47 = 0.1e1 + 0.5e1 / 0.9e1 * (t26 * t29 / 0.72e2 + 0.677e-2 * t33 * t35) * t39 * t44;
  t51 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t20 * t22 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t21;
  t57 = t7 * t20;
  t58 = t27 * rho[0];
  t60 = 0.1e1 / t22 / t58;
  t64 = 0.1e1 / t21 / t27;
  t67 = -t26 * t60 / 0.27e2 - 0.90266666666666666666e-2 * t33 * t64;
  t69 = t39 * t44;
  t74 = my_piecewise3(t2, 0, t7 * t20 * t52 * t47 / 0.1e2 + t57 * t22 * t67 * t69 / 0.12e2);
  tvrho0 = 0.2e1 * rho[0] * t74 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t80 = t25 / t32;
  t83 = t25 * t29 / 0.72e2 + 0.3385e-2 * t80 * t35;
  t88 = my_piecewise3(t2, 0, t57 * t22 * t83 * t69 / 0.12e2);
  tvsigma0 = 0.2e1 * rho[0] * t88;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t24, t25, t26, t27, t29, t32, t33, t35;
  double t39, t41, t42, t43, t44, t47, t51, tzk0;

  double t52, t57, t58, t60, t64, t67, t69, t74;
  double tvrho0, t80, t83, t88, tvsigma0;

  double t99, t101, t105, t108, t114, tv2rho20, t125, t131;
  double tv2rhosigma0, t134, t136, t140, t143, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t24 = M_CBRT2;
  t25 = t24 * t24;
  t26 = sigma[0] * t25;
  t27 = rho[0] * rho[0];
  t29 = 0.1e1 / t22 / t27;
  t32 = sqrt(sigma[0]);
  t33 = t25 * t32;
  t35 = 0.1e1 / t21 / rho[0];
  t39 = M_CBRT6;
  t41 = M_PI * M_PI;
  t42 = POW_1_3(t41);
  t43 = t42 * t42;
  t44 = 0.1e1 / t43;
  t47 = 0.1e1 + 0.5e1 / 0.9e1 * (t26 * t29 / 0.72e2 + 0.677e-2 * t33 * t35) * t39 * t44;
  t51 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t20 * t22 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t21;
  t57 = t7 * t20;
  t58 = t27 * rho[0];
  t60 = 0.1e1 / t22 / t58;
  t64 = 0.1e1 / t21 / t27;
  t67 = -t26 * t60 / 0.27e2 - 0.90266666666666666666e-2 * t33 * t64;
  t69 = t39 * t44;
  t74 = my_piecewise3(t2, 0, t7 * t20 * t52 * t47 / 0.1e2 + t57 * t22 * t67 * t69 / 0.12e2);
  tvrho0 = 0.2e1 * rho[0] * t74 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t80 = t25 / t32;
  t83 = t25 * t29 / 0.72e2 + 0.3385e-2 * t80 * t35;
  t88 = my_piecewise3(t2, 0, t57 * t22 * t83 * t69 / 0.12e2);
  tvsigma0 = 0.2e1 * rho[0] * t88;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t99 = t27 * t27;
  t101 = 0.1e1 / t22 / t99;
  t105 = 0.1e1 / t21 / t58;
  t108 = 0.11e2 / 0.81e2 * t26 * t101 + 0.21062222222222222222e-1 * t33 * t105;
  t114 = my_piecewise3(t2, 0, -t7 * t20 * t35 * t47 / 0.3e2 + t57 * t52 * t67 * t69 / 0.9e1 + t57 * t22 * t108 * t69 / 0.12e2);
  tv2rho20 = 0.2e1 * rho[0] * t114 + 0.4e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t125 = -t25 * t60 / 0.27e2 - 0.45133333333333333333e-2 * t80 * t64;
  t131 = my_piecewise3(t2, 0, t57 * t52 * t83 * t69 / 0.18e2 + t57 * t22 * t125 * t69 / 0.12e2);
  tv2rhosigma0 = 0.2e1 * rho[0] * t131 + 0.2e1 * t88;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t134 = t4 * t20;
  t136 = t134 / t22;
  t140 = t25 / t32 / sigma[0] * t69;
  t143 = my_piecewise3(t2, 0, -0.64895402177010868827e-3 * t136 * t140);
  tv2sigma20 = 0.2e1 * rho[0] * t143;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t24, t25, t26, t27, t29, t32, t33, t35;
  double t39, t41, t42, t43, t44, t47, t51, tzk0;

  double t52, t57, t58, t60, t64, t67, t69, t74;
  double tvrho0, t80, t83, t88, tvsigma0;

  double t99, t101, t105, t108, t114, tv2rho20, t125, t131;
  double tv2rhosigma0, t134, t136, t140, t143, tv2sigma20;

  double t158, t160, t164, t167, t173, tv3rho30, t189, t195;
  double tv3rho2sigma0, t200, t203, tv3rhosigma20, t206, t210, t213, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t24 = M_CBRT2;
  t25 = t24 * t24;
  t26 = sigma[0] * t25;
  t27 = rho[0] * rho[0];
  t29 = 0.1e1 / t22 / t27;
  t32 = sqrt(sigma[0]);
  t33 = t25 * t32;
  t35 = 0.1e1 / t21 / rho[0];
  t39 = M_CBRT6;
  t41 = M_PI * M_PI;
  t42 = POW_1_3(t41);
  t43 = t42 * t42;
  t44 = 0.1e1 / t43;
  t47 = 0.1e1 + 0.5e1 / 0.9e1 * (t26 * t29 / 0.72e2 + 0.677e-2 * t33 * t35) * t39 * t44;
  t51 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t20 * t22 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t21;
  t57 = t7 * t20;
  t58 = t27 * rho[0];
  t60 = 0.1e1 / t22 / t58;
  t64 = 0.1e1 / t21 / t27;
  t67 = -t26 * t60 / 0.27e2 - 0.90266666666666666666e-2 * t33 * t64;
  t69 = t39 * t44;
  t74 = my_piecewise3(t2, 0, t7 * t20 * t52 * t47 / 0.1e2 + t57 * t22 * t67 * t69 / 0.12e2);
  tvrho0 = 0.2e1 * rho[0] * t74 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t80 = t25 / t32;
  t83 = t25 * t29 / 0.72e2 + 0.3385e-2 * t80 * t35;
  t88 = my_piecewise3(t2, 0, t57 * t22 * t83 * t69 / 0.12e2);
  tvsigma0 = 0.2e1 * rho[0] * t88;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t99 = t27 * t27;
  t101 = 0.1e1 / t22 / t99;
  t105 = 0.1e1 / t21 / t58;
  t108 = 0.11e2 / 0.81e2 * t26 * t101 + 0.21062222222222222222e-1 * t33 * t105;
  t114 = my_piecewise3(t2, 0, -t7 * t20 * t35 * t47 / 0.3e2 + t57 * t52 * t67 * t69 / 0.9e1 + t57 * t22 * t108 * t69 / 0.12e2);
  tv2rho20 = 0.2e1 * rho[0] * t114 + 0.4e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t125 = -t25 * t60 / 0.27e2 - 0.45133333333333333333e-2 * t80 * t64;
  t131 = my_piecewise3(t2, 0, t57 * t52 * t83 * t69 / 0.18e2 + t57 * t22 * t125 * t69 / 0.12e2);
  tv2rhosigma0 = 0.2e1 * rho[0] * t131 + 0.2e1 * t88;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t134 = t4 * t20;
  t136 = t134 / t22;
  t140 = t25 / t32 / sigma[0] * t69;
  t143 = my_piecewise3(t2, 0, -0.64895402177010868827e-3 * t136 * t140);
  tv2sigma20 = 0.2e1 * rho[0] * t143;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t158 = t99 * rho[0];
  t160 = 0.1e1 / t22 / t158;
  t164 = 0.1e1 / t21 / t99;
  t167 = -0.154e3 / 0.243e3 * t26 * t160 - 0.70207407407407407407e-1 * t33 * t164;
  t173 = my_piecewise3(t2, 0, 0.2e1 / 0.45e2 * t7 * t20 * t64 * t47 - t57 * t35 * t67 * t69 / 0.18e2 + t57 * t52 * t108 * t69 / 0.6e1 + t57 * t22 * t167 * t69 / 0.12e2);
  tv3rho30 = 0.2e1 * rho[0] * t173 + 0.6e1 * t114;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t189 = 0.11e2 / 0.81e2 * t25 * t101 + 0.10531111111111111111e-1 * t80 * t105;
  t195 = my_piecewise3(t2, 0, -t57 * t35 * t83 * t69 / 0.54e2 + t57 * t52 * t125 * t69 / 0.9e1 + t57 * t22 * t189 * t69 / 0.12e2);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t195 + 0.4e1 * t131;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t200 = t134 / t22 / rho[0];
  t203 = my_piecewise3(t2, 0, 0.43263601451340579218e-3 * t200 * t140);
  tv3rhosigma20 = 0.2e1 * rho[0] * t203 + 0.2e1 * t143;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t206 = sigma[0] * sigma[0];
  t210 = t25 / t32 / t206 * t69;
  t213 = my_piecewise3(t2, 0, 0.9734310326551630324e-3 * t136 * t210);
  tv3sigma30 = 0.2e1 * rho[0] * t213;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t5, t7, t8, t9, t11;
  double t12, t14, t15, t17, t18, t20, t21, t22;
  double t24, t25, t26, t27, t29, t32, t33, t35;
  double t39, t41, t42, t43, t44, t47, t51, tzk0;

  double t52, t57, t58, t60, t64, t67, t69, t74;
  double tvrho0, t80, t83, t88, tvsigma0;

  double t99, t101, t105, t108, t114, tv2rho20, t125, t131;
  double tv2rhosigma0, t134, t136, t140, t143, tv2sigma20;

  double t158, t160, t164, t167, t173, tv3rho30, t189, t195;
  double tv3rho2sigma0, t200, t203, tv3rhosigma20, t206, t210, t213, tv3sigma30;

  double t247, tv4rho40, t273, tv4rho3sigma0, t280, tv4rho2sigma20, t285, tv4rhosigma30;
  double t295, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = t3 * t3;
  t5 = M_CBRTPI;
  t7 = t4 * t5 * M_PI;
  t8 = 0.1e1 <= p->zeta_threshold;
  t9 = p->zeta_threshold - 0.1e1;
  t11 = my_piecewise5(t8, t9, t8, -t9, 0);
  t12 = 0.1e1 + t11;
  t14 = POW_1_3(p->zeta_threshold);
  t15 = t14 * t14;
  t17 = POW_1_3(t12);
  t18 = t17 * t17;
  t20 = my_piecewise3(t12 <= p->zeta_threshold, t15 * p->zeta_threshold, t18 * t12);
  t21 = POW_1_3(rho[0]);
  t22 = t21 * t21;
  t24 = M_CBRT2;
  t25 = t24 * t24;
  t26 = sigma[0] * t25;
  t27 = rho[0] * rho[0];
  t29 = 0.1e1 / t22 / t27;
  t32 = sqrt(sigma[0]);
  t33 = t25 * t32;
  t35 = 0.1e1 / t21 / rho[0];
  t39 = M_CBRT6;
  t41 = M_PI * M_PI;
  t42 = POW_1_3(t41);
  t43 = t42 * t42;
  t44 = 0.1e1 / t43;
  t47 = 0.1e1 + 0.5e1 / 0.9e1 * (t26 * t29 / 0.72e2 + 0.677e-2 * t33 * t35) * t39 * t44;
  t51 = my_piecewise3(t2, 0, 0.3e1 / 0.2e2 * t7 * t20 * t22 * t47);
  tzk0 = 0.2e1 * t51;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t52 = 0.1e1 / t21;
  t57 = t7 * t20;
  t58 = t27 * rho[0];
  t60 = 0.1e1 / t22 / t58;
  t64 = 0.1e1 / t21 / t27;
  t67 = -t26 * t60 / 0.27e2 - 0.90266666666666666666e-2 * t33 * t64;
  t69 = t39 * t44;
  t74 = my_piecewise3(t2, 0, t7 * t20 * t52 * t47 / 0.1e2 + t57 * t22 * t67 * t69 / 0.12e2);
  tvrho0 = 0.2e1 * rho[0] * t74 + 0.2e1 * t51;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t80 = t25 / t32;
  t83 = t25 * t29 / 0.72e2 + 0.3385e-2 * t80 * t35;
  t88 = my_piecewise3(t2, 0, t57 * t22 * t83 * t69 / 0.12e2);
  tvsigma0 = 0.2e1 * rho[0] * t88;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t99 = t27 * t27;
  t101 = 0.1e1 / t22 / t99;
  t105 = 0.1e1 / t21 / t58;
  t108 = 0.11e2 / 0.81e2 * t26 * t101 + 0.21062222222222222222e-1 * t33 * t105;
  t114 = my_piecewise3(t2, 0, -t7 * t20 * t35 * t47 / 0.3e2 + t57 * t52 * t67 * t69 / 0.9e1 + t57 * t22 * t108 * t69 / 0.12e2);
  tv2rho20 = 0.2e1 * rho[0] * t114 + 0.4e1 * t74;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t125 = -t25 * t60 / 0.27e2 - 0.45133333333333333333e-2 * t80 * t64;
  t131 = my_piecewise3(t2, 0, t57 * t52 * t83 * t69 / 0.18e2 + t57 * t22 * t125 * t69 / 0.12e2);
  tv2rhosigma0 = 0.2e1 * rho[0] * t131 + 0.2e1 * t88;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t134 = t4 * t20;
  t136 = t134 / t22;
  t140 = t25 / t32 / sigma[0] * t69;
  t143 = my_piecewise3(t2, 0, -0.64895402177010868827e-3 * t136 * t140);
  tv2sigma20 = 0.2e1 * rho[0] * t143;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t158 = t99 * rho[0];
  t160 = 0.1e1 / t22 / t158;
  t164 = 0.1e1 / t21 / t99;
  t167 = -0.154e3 / 0.243e3 * t26 * t160 - 0.70207407407407407407e-1 * t33 * t164;
  t173 = my_piecewise3(t2, 0, 0.2e1 / 0.45e2 * t7 * t20 * t64 * t47 - t57 * t35 * t67 * t69 / 0.18e2 + t57 * t52 * t108 * t69 / 0.6e1 + t57 * t22 * t167 * t69 / 0.12e2);
  tv3rho30 = 0.2e1 * rho[0] * t173 + 0.6e1 * t114;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t189 = 0.11e2 / 0.81e2 * t25 * t101 + 0.10531111111111111111e-1 * t80 * t105;
  t195 = my_piecewise3(t2, 0, -t57 * t35 * t83 * t69 / 0.54e2 + t57 * t52 * t125 * t69 / 0.9e1 + t57 * t22 * t189 * t69 / 0.12e2);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t195 + 0.4e1 * t131;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t200 = t134 / t22 / rho[0];
  t203 = my_piecewise3(t2, 0, 0.43263601451340579218e-3 * t200 * t140);
  tv3rhosigma20 = 0.2e1 * rho[0] * t203 + 0.2e1 * t143;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t206 = sigma[0] * sigma[0];
  t210 = t25 / t32 / t206 * t69;
  t213 = my_piecewise3(t2, 0, 0.9734310326551630324e-3 * t136 * t210);
  tv3sigma30 = 0.2e1 * rho[0] * t213;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t247 = my_piecewise3(t2, 0, -0.14e2 / 0.135e3 * t7 * t20 * t105 * t47 + 0.8e1 / 0.81e2 * t57 * t64 * t67 * t69 - t57 * t35 * t108 * t69 / 0.9e1 + 0.2e1 / 0.9e1 * t57 * t52 * t167 * t69 + t57 * t22 * (0.2618e4 / 0.729e3 * t26 / t22 / t99 / t27 + 0.30423209876543209876e0 * t33 / t21 / t158) * t69 / 0.12e2);
  tv4rho40 = 0.2e1 * rho[0] * t247 + 0.8e1 * t173;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t273 = my_piecewise3(t2, 0, 0.2e1 / 0.81e2 * t57 * t64 * t83 * t69 - t57 * t35 * t125 * t69 / 0.18e2 + t57 * t52 * t189 * t69 / 0.6e1 + t57 * t22 * (-0.154e3 / 0.243e3 * t25 * t160 - 0.35103703703703703703e-1 * t80 * t164) * t69 / 0.12e2);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t273 + 0.6e1 * t195;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t280 = my_piecewise3(t2, 0, -0.72106002418900965363e-3 * t134 * t29 * t140);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t280 + 0.4e1 * t203;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t285 = my_piecewise3(t2, 0, -0.64895402177010868827e-3 * t200 * t210);
  tv4rhosigma30 = 0.2e1 * rho[0] * t285 + 0.2e1 * t213;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t295 = my_piecewise3(t2, 0, -0.2433577581637907581e-2 * t136 * t25 / t32 / t206 / sigma[0] * t69);
  tv4sigma40 = 0.2e1 * rho[0] * t295;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t32, t33, t34, t36, t39, t40, t41, t43;
  double t47, t49, t50, t51, t52, t55, t59, t60;
  double t61, t62, t63, t64, t65, t67, t69, t70;
  double t71, t73, t76, t77, t79, t86, t90, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t39 = M_CBRT2;
  t40 = sqrt(sigma[0]);
  t41 = t39 * t40;
  t43 = 0.1e1 / t33 / rho[0];
  t47 = M_CBRT6;
  t49 = M_PI * M_PI;
  t50 = POW_1_3(t49);
  t51 = t50 * t50;
  t52 = 0.1e1 / t51;
  t55 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[0] * t36 / 0.72e2 + 0.677e-2 * t41 * t43) * t47 * t52;
  t59 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t28 * t30 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = my_piecewise5(t15, t12, t11, t16, -t18);
  t62 = 0.1e1 + t61;
  t63 = t62 <= p->zeta_threshold;
  t64 = POW_1_3(t62);
  t65 = t64 * t64;
  t67 = my_piecewise3(t63, t24, t65 * t62);
  t69 = rho[1] * rho[1];
  t70 = POW_1_3(rho[1]);
  t71 = t70 * t70;
  t73 = 0.1e1 / t71 / t69;
  t76 = sqrt(sigma[2]);
  t77 = t39 * t76;
  t79 = 0.1e1 / t70 / rho[1];
  t86 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[2] * t73 / 0.72e2 + 0.677e-2 * t77 * t79) * t47 * t52;
  t90 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t67 * t30 * t86);
  tzk0 = t59 + t90;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t32, t33, t34, t36, t39, t40, t41, t43;
  double t47, t49, t50, t51, t52, t55, t59, t60;
  double t61, t62, t63, t64, t65, t67, t69, t70;
  double t71, t73, t76, t77, t79, t86, t90, tzk0;

  double t91, t92, t93, t94, t95, t98, t103, t107;
  double t108, t109, t111, t115, t118, t120, t121, t125;
  double t127, t130, t138, t140, tvrho0, t143, t144, t147;
  double t153, t155, t158, t163, t164, t166, t170, t173;
  double t175, t179, tvrho1, t184, t187, t189, t192, tvsigma0;
  double tvsigma1, t195, t198, t200, t203, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t39 = M_CBRT2;
  t40 = sqrt(sigma[0]);
  t41 = t39 * t40;
  t43 = 0.1e1 / t33 / rho[0];
  t47 = M_CBRT6;
  t49 = M_PI * M_PI;
  t50 = POW_1_3(t49);
  t51 = t50 * t50;
  t52 = 0.1e1 / t51;
  t55 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[0] * t36 / 0.72e2 + 0.677e-2 * t41 * t43) * t47 * t52;
  t59 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t28 * t30 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = my_piecewise5(t15, t12, t11, t16, -t18);
  t62 = 0.1e1 + t61;
  t63 = t62 <= p->zeta_threshold;
  t64 = POW_1_3(t62);
  t65 = t64 * t64;
  t67 = my_piecewise3(t63, t24, t65 * t62);
  t69 = rho[1] * rho[1];
  t70 = POW_1_3(rho[1]);
  t71 = t70 * t70;
  t73 = 0.1e1 / t71 / t69;
  t76 = sqrt(sigma[2]);
  t77 = t39 * t76;
  t79 = 0.1e1 / t70 / rho[1];
  t86 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[2] * t73 / 0.72e2 + 0.677e-2 * t77 * t79) * t47 * t52;
  t90 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t67 * t30 * t86);
  tzk0 = t59 + t90;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t91 = t7 * t7;
  t92 = 0.1e1 / t91;
  t93 = t17 * t92;
  t94 = t8 - t93;
  t95 = my_piecewise5(t11, 0, t15, 0, t94);
  t98 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t95);
  t103 = 0.1e1 / t29;
  t107 = t6 * t28 * t103 * t55 / 0.1e2;
  t108 = t6 * t28;
  t109 = t32 * rho[0];
  t111 = 0.1e1 / t34 / t109;
  t115 = 0.1e1 / t33 / t32;
  t118 = -sigma[0] * t111 / 0.27e2 - 0.90266666666666666666e-2 * t41 * t115;
  t120 = t47 * t52;
  t121 = t30 * t118 * t120;
  t125 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t98 * t30 * t55 + t107 + t108 * t121 / 0.12e2);
  t127 = my_piecewise5(t15, 0, t11, 0, -t94);
  t130 = my_piecewise3(t63, 0, 0.5e1 / 0.3e1 * t65 * t127);
  t138 = t6 * t67 * t103 * t86 / 0.1e2;
  t140 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t130 * t30 * t86 + t138);
  tvrho0 = t59 + t90 + t7 * (t125 + t140);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t143 = -t8 - t93;
  t144 = my_piecewise5(t11, 0, t15, 0, t143);
  t147 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t144);
  t153 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t147 * t30 * t55 + t107);
  t155 = my_piecewise5(t15, 0, t11, 0, -t143);
  t158 = my_piecewise3(t63, 0, 0.5e1 / 0.3e1 * t65 * t155);
  t163 = t6 * t67;
  t164 = t69 * rho[1];
  t166 = 0.1e1 / t71 / t164;
  t170 = 0.1e1 / t70 / t69;
  t173 = -sigma[2] * t166 / 0.27e2 - 0.90266666666666666666e-2 * t77 * t170;
  t175 = t30 * t173 * t120;
  t179 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t158 * t30 * t86 + t138 + t163 * t175 / 0.12e2);
  tvrho1 = t59 + t90 + t7 * (t153 + t179);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t184 = t39 / t40;
  t187 = t36 / 0.72e2 + 0.3385e-2 * t184 * t43;
  t189 = t30 * t187 * t120;
  t192 = my_piecewise3(t1, 0, t108 * t189 / 0.12e2);
  tvsigma0 = t7 * t192;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t195 = t39 / t76;
  t198 = t73 / 0.72e2 + 0.3385e-2 * t195 * t79;
  t200 = t30 * t198 * t120;
  t203 = my_piecewise3(t60, 0, t163 * t200 / 0.12e2);
  tvsigma2 = t7 * t203;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t32, t33, t34, t36, t39, t40, t41, t43;
  double t47, t49, t50, t51, t52, t55, t59, t60;
  double t61, t62, t63, t64, t65, t67, t69, t70;
  double t71, t73, t76, t77, t79, t86, t90, tzk0;

  double t91, t92, t93, t94, t95, t98, t103, t107;
  double t108, t109, t111, t115, t118, t120, t121, t125;
  double t127, t130, t138, t140, tvrho0, t143, t144, t147;
  double t153, t155, t158, t163, t164, t166, t170, t173;
  double t175, t179, tvrho1, t184, t187, t189, t192, tvsigma0;
  double tvsigma1, t195, t198, t200, t203, tvsigma2;

  double t206, t207, t210, t211, t212, t214, t215, t219;
  double t226, t228, t232, t236, t238, t239, t241, t243;
  double t247, t250, t252, t256, t257, t258, t262, t266;
  double t273, t278, t280, tv2rho20, t283, t286, t287, t291;
  double t298, t300, t306, t307, t310, t314, t321, t324;
  double t328, t329, t332, tv2rho21, t337, t341, t342, t346;
  double t353, t354, t358, t362, t368, t372, t374, t378;
  double t381, t383, t387, tv2rho22, t393, t395, t399, t401;
  double t405, tv2rhosigma0, tv2rhosigma1, t410, t412, t414, tv2rhosigma2, t419;
  double tv2rhosigma3, tv2rhosigma4, t426, t428, t432, tv2rhosigma5, t434, t435;
  double t436, t438, t440, t443, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t444, t445, t447, t449, t452, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t39 = M_CBRT2;
  t40 = sqrt(sigma[0]);
  t41 = t39 * t40;
  t43 = 0.1e1 / t33 / rho[0];
  t47 = M_CBRT6;
  t49 = M_PI * M_PI;
  t50 = POW_1_3(t49);
  t51 = t50 * t50;
  t52 = 0.1e1 / t51;
  t55 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[0] * t36 / 0.72e2 + 0.677e-2 * t41 * t43) * t47 * t52;
  t59 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t28 * t30 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = my_piecewise5(t15, t12, t11, t16, -t18);
  t62 = 0.1e1 + t61;
  t63 = t62 <= p->zeta_threshold;
  t64 = POW_1_3(t62);
  t65 = t64 * t64;
  t67 = my_piecewise3(t63, t24, t65 * t62);
  t69 = rho[1] * rho[1];
  t70 = POW_1_3(rho[1]);
  t71 = t70 * t70;
  t73 = 0.1e1 / t71 / t69;
  t76 = sqrt(sigma[2]);
  t77 = t39 * t76;
  t79 = 0.1e1 / t70 / rho[1];
  t86 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[2] * t73 / 0.72e2 + 0.677e-2 * t77 * t79) * t47 * t52;
  t90 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t67 * t30 * t86);
  tzk0 = t59 + t90;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t91 = t7 * t7;
  t92 = 0.1e1 / t91;
  t93 = t17 * t92;
  t94 = t8 - t93;
  t95 = my_piecewise5(t11, 0, t15, 0, t94);
  t98 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t95);
  t103 = 0.1e1 / t29;
  t107 = t6 * t28 * t103 * t55 / 0.1e2;
  t108 = t6 * t28;
  t109 = t32 * rho[0];
  t111 = 0.1e1 / t34 / t109;
  t115 = 0.1e1 / t33 / t32;
  t118 = -sigma[0] * t111 / 0.27e2 - 0.90266666666666666666e-2 * t41 * t115;
  t120 = t47 * t52;
  t121 = t30 * t118 * t120;
  t125 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t98 * t30 * t55 + t107 + t108 * t121 / 0.12e2);
  t127 = my_piecewise5(t15, 0, t11, 0, -t94);
  t130 = my_piecewise3(t63, 0, 0.5e1 / 0.3e1 * t65 * t127);
  t138 = t6 * t67 * t103 * t86 / 0.1e2;
  t140 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t130 * t30 * t86 + t138);
  tvrho0 = t59 + t90 + t7 * (t125 + t140);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t143 = -t8 - t93;
  t144 = my_piecewise5(t11, 0, t15, 0, t143);
  t147 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t144);
  t153 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t147 * t30 * t55 + t107);
  t155 = my_piecewise5(t15, 0, t11, 0, -t143);
  t158 = my_piecewise3(t63, 0, 0.5e1 / 0.3e1 * t65 * t155);
  t163 = t6 * t67;
  t164 = t69 * rho[1];
  t166 = 0.1e1 / t71 / t164;
  t170 = 0.1e1 / t70 / t69;
  t173 = -sigma[2] * t166 / 0.27e2 - 0.90266666666666666666e-2 * t77 * t170;
  t175 = t30 * t173 * t120;
  t179 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t158 * t30 * t86 + t138 + t163 * t175 / 0.12e2);
  tvrho1 = t59 + t90 + t7 * (t153 + t179);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t184 = t39 / t40;
  t187 = t36 / 0.72e2 + 0.3385e-2 * t184 * t43;
  t189 = t30 * t187 * t120;
  t192 = my_piecewise3(t1, 0, t108 * t189 / 0.12e2);
  tvsigma0 = t7 * t192;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t195 = t39 / t76;
  t198 = t73 / 0.72e2 + 0.3385e-2 * t195 * t79;
  t200 = t30 * t198 * t120;
  t203 = my_piecewise3(t60, 0, t163 * t200 / 0.12e2);
  tvsigma2 = t7 * t203;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t206 = 0.1e1 / t25;
  t207 = t95 * t95;
  t210 = t91 * t7;
  t211 = 0.1e1 / t210;
  t212 = t17 * t211;
  t214 = -0.2e1 * t92 + 0.2e1 * t212;
  t215 = my_piecewise5(t11, 0, t15, 0, t214);
  t219 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t206 * t207 + 0.5e1 / 0.3e1 * t26 * t215);
  t226 = t6 * t98 * t103 * t55;
  t228 = t6 * t98;
  t232 = 0.1e1 / t29 / t7;
  t236 = t6 * t28 * t232 * t55 / 0.3e2;
  t238 = t103 * t118 * t120;
  t239 = t108 * t238;
  t241 = t32 * t32;
  t243 = 0.1e1 / t34 / t241;
  t247 = 0.1e1 / t33 / t109;
  t250 = 0.11e2 / 0.81e2 * sigma[0] * t243 + 0.21062222222222222222e-1 * t41 * t247;
  t252 = t30 * t250 * t120;
  t256 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t219 * t30 * t55 + t226 / 0.5e1 + t228 * t121 / 0.6e1 - t236 + t239 / 0.9e1 + t108 * t252 / 0.12e2);
  t257 = 0.1e1 / t64;
  t258 = t127 * t127;
  t262 = my_piecewise5(t15, 0, t11, 0, -t214);
  t266 = my_piecewise3(t63, 0, 0.1e2 / 0.9e1 * t257 * t258 + 0.5e1 / 0.3e1 * t65 * t262);
  t273 = t6 * t130 * t103 * t86;
  t278 = t6 * t67 * t232 * t86 / 0.3e2;
  t280 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t266 * t30 * t86 + t273 / 0.5e1 - t278);
  tv2rho20 = 0.2e1 * t125 + 0.2e1 * t140 + t7 * (t256 + t280);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t283 = t206 * t144;
  t286 = 0.2e1 * t212;
  t287 = my_piecewise5(t11, 0, t15, 0, t286);
  t291 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t283 * t95 + 0.5e1 / 0.3e1 * t26 * t287);
  t298 = t6 * t147 * t103 * t55;
  t300 = t6 * t147;
  t306 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t291 * t30 * t55 + t298 / 0.1e2 + t300 * t121 / 0.12e2 + t226 / 0.1e2 - t236 + t239 / 0.18e2);
  t307 = t257 * t155;
  t310 = my_piecewise5(t15, 0, t11, 0, -t286);
  t314 = my_piecewise3(t63, 0, 0.1e2 / 0.9e1 * t307 * t127 + 0.5e1 / 0.3e1 * t65 * t310);
  t321 = t6 * t158 * t103 * t86;
  t324 = t6 * t130;
  t328 = t103 * t173 * t120;
  t329 = t163 * t328;
  t332 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t314 * t30 * t86 + t321 / 0.1e2 + t273 / 0.1e2 - t278 + t324 * t175 / 0.12e2 + t329 / 0.18e2);
  tv2rho21 = t125 + t140 + t153 + t179 + t7 * (t306 + t332);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t337 = t144 * t144;
  t341 = 0.2e1 * t92 + 0.2e1 * t212;
  t342 = my_piecewise5(t11, 0, t15, 0, t341);
  t346 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t206 * t337 + 0.5e1 / 0.3e1 * t26 * t342);
  t353 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t346 * t30 * t55 + t298 / 0.5e1 - t236);
  t354 = t155 * t155;
  t358 = my_piecewise5(t15, 0, t11, 0, -t341);
  t362 = my_piecewise3(t63, 0, 0.1e2 / 0.9e1 * t257 * t354 + 0.5e1 / 0.3e1 * t65 * t358);
  t368 = t6 * t158;
  t372 = t69 * t69;
  t374 = 0.1e1 / t71 / t372;
  t378 = 0.1e1 / t70 / t164;
  t381 = 0.11e2 / 0.81e2 * sigma[2] * t374 + 0.21062222222222222222e-1 * t77 * t378;
  t383 = t30 * t381 * t120;
  t387 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t362 * t30 * t86 + t321 / 0.5e1 + t368 * t175 / 0.6e1 - t278 + t329 / 0.9e1 + t163 * t383 / 0.12e2);
  tv2rho22 = 0.2e1 * t153 + 0.2e1 * t179 + t7 * (t353 + t387);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t393 = t103 * t187 * t120;
  t395 = t108 * t393 / 0.18e2;
  t399 = -t111 / 0.27e2 - 0.45133333333333333333e-2 * t184 * t115;
  t401 = t30 * t399 * t120;
  t405 = my_piecewise3(t1, 0, t228 * t189 / 0.12e2 + t395 + t108 * t401 / 0.12e2);
  tv2rhosigma0 = t405 * t7 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t410 = t103 * t198 * t120;
  t412 = t163 * t410 / 0.18e2;
  t414 = my_piecewise3(t60, 0, t324 * t200 / 0.12e2 + t412);
  tv2rhosigma2 = t414 * t7 + t203;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t419 = my_piecewise3(t1, 0, t300 * t189 / 0.12e2 + t395);
  tv2rhosigma3 = t419 * t7 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t426 = -t166 / 0.27e2 - 0.45133333333333333333e-2 * t195 * t170;
  t428 = t30 * t426 * t120;
  t432 = my_piecewise3(t60, 0, t368 * t200 / 0.12e2 + t412 + t163 * t428 / 0.12e2);
  tv2rhosigma5 = t432 * t7 + t203;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t434 = t3 * t28;
  t435 = t30 * t39;
  t436 = t434 * t435;
  t438 = 0.1e1 / t40 / sigma[0];
  t440 = t438 * t43 * t120;
  t443 = my_piecewise3(t1, 0, -0.64895402177010868827e-3 * t436 * t440);
  tv2sigma20 = t7 * t443;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t444 = t3 * t67;
  t445 = t444 * t435;
  t447 = 0.1e1 / t76 / sigma[2];
  t449 = t447 * t79 * t120;
  t452 = my_piecewise3(t60, 0, -0.64895402177010868827e-3 * t445 * t449);
  tv2sigma25 = t7 * t452;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t32, t33, t34, t36, t39, t40, t41, t43;
  double t47, t49, t50, t51, t52, t55, t59, t60;
  double t61, t62, t63, t64, t65, t67, t69, t70;
  double t71, t73, t76, t77, t79, t86, t90, tzk0;

  double t91, t92, t93, t94, t95, t98, t103, t107;
  double t108, t109, t111, t115, t118, t120, t121, t125;
  double t127, t130, t138, t140, tvrho0, t143, t144, t147;
  double t153, t155, t158, t163, t164, t166, t170, t173;
  double t175, t179, tvrho1, t184, t187, t189, t192, tvsigma0;
  double tvsigma1, t195, t198, t200, t203, tvsigma2;

  double t206, t207, t210, t211, t212, t214, t215, t219;
  double t226, t228, t232, t236, t238, t239, t241, t243;
  double t247, t250, t252, t256, t257, t258, t262, t266;
  double t273, t278, t280, tv2rho20, t283, t286, t287, t291;
  double t298, t300, t306, t307, t310, t314, t321, t324;
  double t328, t329, t332, tv2rho21, t337, t341, t342, t346;
  double t353, t354, t358, t362, t368, t372, t374, t378;
  double t381, t383, t387, tv2rho22, t393, t395, t399, t401;
  double t405, tv2rhosigma0, tv2rhosigma1, t410, t412, t414, tv2rhosigma2, t419;
  double tv2rhosigma3, tv2rhosigma4, t426, t428, t432, tv2rhosigma5, t434, t435;
  double t436, t438, t440, t443, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t444, t445, t447, t449, t452, tv2sigma25;

  double t456, t457, t460, t463, t464, t465, t467, t468;
  double t472, t479, t481, t486, t488, t493, t497, t499;
  double t500, t503, t504, t506, t508, t512, t515, t517;
  double t521, t523, t524, t527, t531, t535, t542, t546;
  double t551, t553, tv3rho30, t556, t557, t558, t561, t566;
  double t567, t568, t569, t573, t581, t582, t587, t590;
  double t598, t599, t600, t603, t609, t613, t621, t624;
  double t628, t632, t634, t635, t638, tv3rho31, t641, t646;
  double t649, t650, t654, t661, t663, t670, t671, t676;
  double t680, t684, t691, t694, t697, t704, t705, t707;
  double t708, tv3rho32, t713, t719, t720, t724, t732, t733;
  double t739, t743, t749, t758, t760, t764, t767, t769;
  double t773, tv3rho33, t779, t784, t786, t788, t789, t794;
  double t796, t800, tv3rho2sigma0, tv3rho2sigma1, t805, t808, t810, t812;
  double tv3rho2sigma2, t816, t823, tv3rho2sigma3, tv3rho2sigma4, t827, t833, t834;
  double t837, tv3rho2sigma5, t844, tv3rho2sigma6, tv3rho2sigma7, t856, t858, t862;
  double tv3rho2sigma8, t864, t865, t868, t869, t871, t873, t877;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t879, t880, t883;
  double t885, t887, tv3rhosigma25, t889, t890, t894, tv3rhosigma26, tv3rhosigma27;
  double tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t896, t897, t901, t905, tv3rhosigma211;
  double t907, t909, t911, t914, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t915, t917, t919;
  double t922, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t39 = M_CBRT2;
  t40 = sqrt(sigma[0]);
  t41 = t39 * t40;
  t43 = 0.1e1 / t33 / rho[0];
  t47 = M_CBRT6;
  t49 = M_PI * M_PI;
  t50 = POW_1_3(t49);
  t51 = t50 * t50;
  t52 = 0.1e1 / t51;
  t55 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[0] * t36 / 0.72e2 + 0.677e-2 * t41 * t43) * t47 * t52;
  t59 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t28 * t30 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = my_piecewise5(t15, t12, t11, t16, -t18);
  t62 = 0.1e1 + t61;
  t63 = t62 <= p->zeta_threshold;
  t64 = POW_1_3(t62);
  t65 = t64 * t64;
  t67 = my_piecewise3(t63, t24, t65 * t62);
  t69 = rho[1] * rho[1];
  t70 = POW_1_3(rho[1]);
  t71 = t70 * t70;
  t73 = 0.1e1 / t71 / t69;
  t76 = sqrt(sigma[2]);
  t77 = t39 * t76;
  t79 = 0.1e1 / t70 / rho[1];
  t86 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[2] * t73 / 0.72e2 + 0.677e-2 * t77 * t79) * t47 * t52;
  t90 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t67 * t30 * t86);
  tzk0 = t59 + t90;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t91 = t7 * t7;
  t92 = 0.1e1 / t91;
  t93 = t17 * t92;
  t94 = t8 - t93;
  t95 = my_piecewise5(t11, 0, t15, 0, t94);
  t98 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t95);
  t103 = 0.1e1 / t29;
  t107 = t6 * t28 * t103 * t55 / 0.1e2;
  t108 = t6 * t28;
  t109 = t32 * rho[0];
  t111 = 0.1e1 / t34 / t109;
  t115 = 0.1e1 / t33 / t32;
  t118 = -sigma[0] * t111 / 0.27e2 - 0.90266666666666666666e-2 * t41 * t115;
  t120 = t47 * t52;
  t121 = t30 * t118 * t120;
  t125 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t98 * t30 * t55 + t107 + t108 * t121 / 0.12e2);
  t127 = my_piecewise5(t15, 0, t11, 0, -t94);
  t130 = my_piecewise3(t63, 0, 0.5e1 / 0.3e1 * t65 * t127);
  t138 = t6 * t67 * t103 * t86 / 0.1e2;
  t140 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t130 * t30 * t86 + t138);
  tvrho0 = t59 + t90 + t7 * (t125 + t140);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t143 = -t8 - t93;
  t144 = my_piecewise5(t11, 0, t15, 0, t143);
  t147 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t144);
  t153 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t147 * t30 * t55 + t107);
  t155 = my_piecewise5(t15, 0, t11, 0, -t143);
  t158 = my_piecewise3(t63, 0, 0.5e1 / 0.3e1 * t65 * t155);
  t163 = t6 * t67;
  t164 = t69 * rho[1];
  t166 = 0.1e1 / t71 / t164;
  t170 = 0.1e1 / t70 / t69;
  t173 = -sigma[2] * t166 / 0.27e2 - 0.90266666666666666666e-2 * t77 * t170;
  t175 = t30 * t173 * t120;
  t179 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t158 * t30 * t86 + t138 + t163 * t175 / 0.12e2);
  tvrho1 = t59 + t90 + t7 * (t153 + t179);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t184 = t39 / t40;
  t187 = t36 / 0.72e2 + 0.3385e-2 * t184 * t43;
  t189 = t30 * t187 * t120;
  t192 = my_piecewise3(t1, 0, t108 * t189 / 0.12e2);
  tvsigma0 = t7 * t192;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t195 = t39 / t76;
  t198 = t73 / 0.72e2 + 0.3385e-2 * t195 * t79;
  t200 = t30 * t198 * t120;
  t203 = my_piecewise3(t60, 0, t163 * t200 / 0.12e2);
  tvsigma2 = t7 * t203;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t206 = 0.1e1 / t25;
  t207 = t95 * t95;
  t210 = t91 * t7;
  t211 = 0.1e1 / t210;
  t212 = t17 * t211;
  t214 = -0.2e1 * t92 + 0.2e1 * t212;
  t215 = my_piecewise5(t11, 0, t15, 0, t214);
  t219 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t206 * t207 + 0.5e1 / 0.3e1 * t26 * t215);
  t226 = t6 * t98 * t103 * t55;
  t228 = t6 * t98;
  t232 = 0.1e1 / t29 / t7;
  t236 = t6 * t28 * t232 * t55 / 0.3e2;
  t238 = t103 * t118 * t120;
  t239 = t108 * t238;
  t241 = t32 * t32;
  t243 = 0.1e1 / t34 / t241;
  t247 = 0.1e1 / t33 / t109;
  t250 = 0.11e2 / 0.81e2 * sigma[0] * t243 + 0.21062222222222222222e-1 * t41 * t247;
  t252 = t30 * t250 * t120;
  t256 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t219 * t30 * t55 + t226 / 0.5e1 + t228 * t121 / 0.6e1 - t236 + t239 / 0.9e1 + t108 * t252 / 0.12e2);
  t257 = 0.1e1 / t64;
  t258 = t127 * t127;
  t262 = my_piecewise5(t15, 0, t11, 0, -t214);
  t266 = my_piecewise3(t63, 0, 0.1e2 / 0.9e1 * t257 * t258 + 0.5e1 / 0.3e1 * t65 * t262);
  t273 = t6 * t130 * t103 * t86;
  t278 = t6 * t67 * t232 * t86 / 0.3e2;
  t280 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t266 * t30 * t86 + t273 / 0.5e1 - t278);
  tv2rho20 = 0.2e1 * t125 + 0.2e1 * t140 + t7 * (t256 + t280);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t283 = t206 * t144;
  t286 = 0.2e1 * t212;
  t287 = my_piecewise5(t11, 0, t15, 0, t286);
  t291 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t283 * t95 + 0.5e1 / 0.3e1 * t26 * t287);
  t298 = t6 * t147 * t103 * t55;
  t300 = t6 * t147;
  t306 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t291 * t30 * t55 + t298 / 0.1e2 + t300 * t121 / 0.12e2 + t226 / 0.1e2 - t236 + t239 / 0.18e2);
  t307 = t257 * t155;
  t310 = my_piecewise5(t15, 0, t11, 0, -t286);
  t314 = my_piecewise3(t63, 0, 0.1e2 / 0.9e1 * t307 * t127 + 0.5e1 / 0.3e1 * t65 * t310);
  t321 = t6 * t158 * t103 * t86;
  t324 = t6 * t130;
  t328 = t103 * t173 * t120;
  t329 = t163 * t328;
  t332 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t314 * t30 * t86 + t321 / 0.1e2 + t273 / 0.1e2 - t278 + t324 * t175 / 0.12e2 + t329 / 0.18e2);
  tv2rho21 = t125 + t140 + t153 + t179 + t7 * (t306 + t332);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t337 = t144 * t144;
  t341 = 0.2e1 * t92 + 0.2e1 * t212;
  t342 = my_piecewise5(t11, 0, t15, 0, t341);
  t346 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t206 * t337 + 0.5e1 / 0.3e1 * t26 * t342);
  t353 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t346 * t30 * t55 + t298 / 0.5e1 - t236);
  t354 = t155 * t155;
  t358 = my_piecewise5(t15, 0, t11, 0, -t341);
  t362 = my_piecewise3(t63, 0, 0.1e2 / 0.9e1 * t257 * t354 + 0.5e1 / 0.3e1 * t65 * t358);
  t368 = t6 * t158;
  t372 = t69 * t69;
  t374 = 0.1e1 / t71 / t372;
  t378 = 0.1e1 / t70 / t164;
  t381 = 0.11e2 / 0.81e2 * sigma[2] * t374 + 0.21062222222222222222e-1 * t77 * t378;
  t383 = t30 * t381 * t120;
  t387 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t362 * t30 * t86 + t321 / 0.5e1 + t368 * t175 / 0.6e1 - t278 + t329 / 0.9e1 + t163 * t383 / 0.12e2);
  tv2rho22 = 0.2e1 * t153 + 0.2e1 * t179 + t7 * (t353 + t387);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t393 = t103 * t187 * t120;
  t395 = t108 * t393 / 0.18e2;
  t399 = -t111 / 0.27e2 - 0.45133333333333333333e-2 * t184 * t115;
  t401 = t30 * t399 * t120;
  t405 = my_piecewise3(t1, 0, t228 * t189 / 0.12e2 + t395 + t108 * t401 / 0.12e2);
  tv2rhosigma0 = t405 * t7 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t410 = t103 * t198 * t120;
  t412 = t163 * t410 / 0.18e2;
  t414 = my_piecewise3(t60, 0, t324 * t200 / 0.12e2 + t412);
  tv2rhosigma2 = t414 * t7 + t203;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t419 = my_piecewise3(t1, 0, t300 * t189 / 0.12e2 + t395);
  tv2rhosigma3 = t419 * t7 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t426 = -t166 / 0.27e2 - 0.45133333333333333333e-2 * t195 * t170;
  t428 = t30 * t426 * t120;
  t432 = my_piecewise3(t60, 0, t368 * t200 / 0.12e2 + t412 + t163 * t428 / 0.12e2);
  tv2rhosigma5 = t432 * t7 + t203;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t434 = t3 * t28;
  t435 = t30 * t39;
  t436 = t434 * t435;
  t438 = 0.1e1 / t40 / sigma[0];
  t440 = t438 * t43 * t120;
  t443 = my_piecewise3(t1, 0, -0.64895402177010868827e-3 * t436 * t440);
  tv2sigma20 = t7 * t443;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t444 = t3 * t67;
  t445 = t444 * t435;
  t447 = 0.1e1 / t76 / sigma[2];
  t449 = t447 * t79 * t120;
  t452 = my_piecewise3(t60, 0, -0.64895402177010868827e-3 * t445 * t449);
  tv2sigma25 = t7 * t452;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t456 = 0.1e1 / t25 / t20;
  t457 = t207 * t95;
  t460 = t206 * t95;
  t463 = t91 * t91;
  t464 = 0.1e1 / t463;
  t465 = t17 * t464;
  t467 = 0.6e1 * t211 - 0.6e1 * t465;
  t468 = my_piecewise5(t11, 0, t15, 0, t467);
  t472 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t456 * t457 + 0.1e2 / 0.3e1 * t460 * t215 + 0.5e1 / 0.3e1 * t26 * t468);
  t479 = t6 * t219 * t103 * t55;
  t481 = t6 * t219;
  t486 = t6 * t98 * t232 * t55;
  t488 = t228 * t238;
  t493 = 0.1e1 / t29 / t91;
  t497 = 0.2e1 / 0.45e2 * t6 * t28 * t493 * t55;
  t499 = t232 * t118 * t120;
  t500 = t108 * t499;
  t503 = t103 * t250 * t120;
  t504 = t108 * t503;
  t506 = t241 * rho[0];
  t508 = 0.1e1 / t34 / t506;
  t512 = 0.1e1 / t33 / t241;
  t515 = -0.154e3 / 0.243e3 * sigma[0] * t508 - 0.70207407407407407407e-1 * t41 * t512;
  t517 = t30 * t515 * t120;
  t521 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t472 * t30 * t55 + 0.3e1 / 0.1e2 * t479 + t481 * t121 / 0.4e1 - t486 / 0.1e2 + t488 / 0.3e1 + t228 * t252 / 0.4e1 + t497 - t500 / 0.18e2 + t504 / 0.6e1 + t108 * t517 / 0.12e2);
  t523 = 0.1e1 / t64 / t62;
  t524 = t258 * t127;
  t527 = t257 * t127;
  t531 = my_piecewise5(t15, 0, t11, 0, -t467);
  t535 = my_piecewise3(t63, 0, -0.1e2 / 0.27e2 * t523 * t524 + 0.1e2 / 0.3e1 * t527 * t262 + 0.5e1 / 0.3e1 * t65 * t531);
  t542 = t6 * t266 * t103 * t86;
  t546 = t6 * t130 * t232 * t86;
  t551 = 0.2e1 / 0.45e2 * t6 * t67 * t493 * t86;
  t553 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t535 * t30 * t86 + 0.3e1 / 0.1e2 * t542 - t546 / 0.1e2 + t551);
  tv3rho30 = 0.3e1 * t256 + 0.3e1 * t280 + t7 * (t521 + t553);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t556 = 0.2e1 * t306;
  t557 = 0.2e1 * t332;
  t558 = t456 * t144;
  t561 = t206 * t287;
  t566 = 0.2e1 * t211;
  t567 = 0.6e1 * t465;
  t568 = t566 - t567;
  t569 = my_piecewise5(t11, 0, t15, 0, t568);
  t573 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t558 * t207 + 0.2e2 / 0.9e1 * t561 * t95 + 0.1e2 / 0.9e1 * t283 * t215 + 0.5e1 / 0.3e1 * t26 * t569);
  t581 = t6 * t291 * t103 * t55 / 0.5e1;
  t582 = t6 * t291;
  t587 = t6 * t147 * t232 * t55;
  t590 = t300 * t238 / 0.9e1;
  t598 = 0.3e1 / 0.2e2 * t6 * t573 * t30 * t55 + t581 + t582 * t121 / 0.6e1 - t587 / 0.3e2 + t590 + t300 * t252 / 0.12e2 + t479 / 0.1e2 - t486 / 0.15e2 + t488 / 0.9e1 + t497 - t500 / 0.27e2 + t504 / 0.18e2;
  t599 = my_piecewise3(t1, 0, t598);
  t600 = t523 * t155;
  t603 = t257 * t310;
  t609 = my_piecewise5(t15, 0, t11, 0, -t568);
  t613 = my_piecewise3(t63, 0, -0.1e2 / 0.27e2 * t600 * t258 + 0.2e2 / 0.9e1 * t603 * t127 + 0.1e2 / 0.9e1 * t307 * t262 + 0.5e1 / 0.3e1 * t65 * t609);
  t621 = t6 * t314 * t103 * t86 / 0.5e1;
  t624 = t6 * t158 * t232 * t86;
  t628 = t6 * t266;
  t632 = t324 * t328 / 0.9e1;
  t634 = t232 * t173 * t120;
  t635 = t163 * t634;
  t638 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t613 * t30 * t86 + t621 - t624 / 0.3e2 + t542 / 0.1e2 - t546 / 0.15e2 + t551 + t628 * t175 / 0.12e2 + t632 - t635 / 0.54e2);
  tv3rho31 = t256 + t280 + t556 + t557 + t7 * (t599 + t638);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t641 = t456 * t337;
  t646 = t206 * t342;
  t649 = -t566 - t567;
  t650 = my_piecewise5(t11, 0, t15, 0, t649);
  t654 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t641 * t95 + 0.2e2 / 0.9e1 * t283 * t287 + 0.1e2 / 0.9e1 * t646 * t95 + 0.5e1 / 0.3e1 * t26 * t650);
  t661 = t6 * t346 * t103 * t55;
  t663 = t6 * t346;
  t670 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t654 * t30 * t55 + t661 / 0.1e2 + t663 * t121 / 0.12e2 + t581 - t587 / 0.15e2 + t590 - t486 / 0.3e2 + t497 - t500 / 0.54e2);
  t671 = t523 * t354;
  t676 = t257 * t358;
  t680 = my_piecewise5(t15, 0, t11, 0, -t649);
  t684 = my_piecewise3(t63, 0, -0.1e2 / 0.27e2 * t671 * t127 + 0.2e2 / 0.9e1 * t307 * t310 + 0.1e2 / 0.9e1 * t676 * t127 + 0.5e1 / 0.3e1 * t65 * t680);
  t691 = t6 * t362 * t103 * t86;
  t694 = t6 * t314;
  t697 = t368 * t328;
  t704 = t103 * t381 * t120;
  t705 = t163 * t704;
  t707 = 0.3e1 / 0.2e2 * t6 * t684 * t30 * t86 + t691 / 0.1e2 + t621 - t624 / 0.15e2 + t694 * t175 / 0.6e1 + t697 / 0.9e1 - t546 / 0.3e2 + t551 + t632 - t635 / 0.27e2 + t324 * t383 / 0.12e2 + t705 / 0.18e2;
  t708 = my_piecewise3(t60, 0, t707);
  tv3rho32 = t556 + t557 + t353 + t387 + t7 * (t670 + t708);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t713 = t337 * t144;
  t719 = -0.6e1 * t211 - 0.6e1 * t465;
  t720 = my_piecewise5(t11, 0, t15, 0, t719);
  t724 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t456 * t713 + 0.1e2 / 0.3e1 * t283 * t342 + 0.5e1 / 0.3e1 * t26 * t720);
  t732 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t724 * t30 * t55 + 0.3e1 / 0.1e2 * t661 - t587 / 0.1e2 + t497);
  t733 = t354 * t155;
  t739 = my_piecewise5(t15, 0, t11, 0, -t719);
  t743 = my_piecewise3(t63, 0, -0.1e2 / 0.27e2 * t523 * t733 + 0.1e2 / 0.3e1 * t307 * t358 + 0.5e1 / 0.3e1 * t65 * t739);
  t749 = t6 * t362;
  t758 = t372 * rho[1];
  t760 = 0.1e1 / t71 / t758;
  t764 = 0.1e1 / t70 / t372;
  t767 = -0.154e3 / 0.243e3 * sigma[2] * t760 - 0.70207407407407407407e-1 * t77 * t764;
  t769 = t30 * t767 * t120;
  t773 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t743 * t30 * t86 + 0.3e1 / 0.1e2 * t691 + t749 * t175 / 0.4e1 - t624 / 0.1e2 + t697 / 0.3e1 + t368 * t383 / 0.4e1 + t551 - t635 / 0.18e2 + t705 / 0.6e1 + t163 * t769 / 0.12e2);
  tv3rho33 = 0.3e1 * t353 + 0.3e1 * t387 + t7 * (t732 + t773);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t779 = t228 * t393;
  t784 = t232 * t187 * t120;
  t786 = t108 * t784 / 0.54e2;
  t788 = t103 * t399 * t120;
  t789 = t108 * t788;
  t794 = 0.11e2 / 0.81e2 * t243 + 0.10531111111111111111e-1 * t184 * t247;
  t796 = t30 * t794 * t120;
  t800 = my_piecewise3(t1, 0, t481 * t189 / 0.12e2 + t779 / 0.9e1 + t228 * t401 / 0.6e1 - t786 + t789 / 0.9e1 + t108 * t796 / 0.12e2);
  tv3rho2sigma0 = t7 * t800 + 0.2e1 * t405;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t805 = t324 * t410;
  t808 = t232 * t198 * t120;
  t810 = t163 * t808 / 0.54e2;
  t812 = my_piecewise3(t60, 0, t628 * t200 / 0.12e2 + t805 / 0.9e1 - t810);
  tv3rho2sigma2 = t7 * t812 + 0.2e1 * t414;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t816 = t300 * t393;
  t823 = my_piecewise3(t1, 0, t582 * t189 / 0.12e2 + t816 / 0.18e2 + t300 * t401 / 0.12e2 + t779 / 0.18e2 - t786 + t789 / 0.18e2);
  tv3rho2sigma3 = t7 * t823 + t405 + t419;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t827 = t368 * t410;
  t833 = t103 * t426 * t120;
  t834 = t163 * t833;
  t837 = my_piecewise3(t60, 0, t694 * t200 / 0.12e2 + t827 / 0.18e2 + t805 / 0.18e2 - t810 + t324 * t428 / 0.12e2 + t834 / 0.18e2);
  tv3rho2sigma5 = t7 * t837 + t414 + t432;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t844 = my_piecewise3(t1, 0, t663 * t189 / 0.12e2 + t816 / 0.9e1 - t786);
  tv3rho2sigma6 = t7 * t844 + 0.2e1 * t419;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t856 = 0.11e2 / 0.81e2 * t374 + 0.10531111111111111111e-1 * t195 * t378;
  t858 = t30 * t856 * t120;
  t862 = my_piecewise3(t60, 0, t749 * t200 / 0.12e2 + t827 / 0.9e1 + t368 * t428 / 0.6e1 - t810 + t834 / 0.9e1 + t163 * t858 / 0.12e2);
  tv3rho2sigma8 = t7 * t862 + 0.2e1 * t432;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t864 = t3 * t98;
  t865 = t864 * t435;
  t868 = t103 * t39;
  t869 = t434 * t868;
  t871 = 0.43263601451340579218e-3 * t869 * t440;
  t873 = t438 * t115 * t120;
  t877 = my_piecewise3(t1, 0, -0.64895402177010868827e-3 * t865 * t440 - t871 + 0.86527202902681158436e-3 * t436 * t873);
  tv3rhosigma20 = t7 * t877 + t443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t879 = t3 * t130;
  t880 = t879 * t435;
  t883 = t444 * t868;
  t885 = 0.43263601451340579218e-3 * t883 * t449;
  t887 = my_piecewise3(t60, 0, -0.64895402177010868827e-3 * t880 * t449 - t885);
  tv3rhosigma25 = t7 * t887 + t452;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t889 = t3 * t147;
  t890 = t889 * t435;
  t894 = my_piecewise3(t1, 0, -0.64895402177010868827e-3 * t890 * t440 - t871);
  tv3rhosigma26 = t7 * t894 + t443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t896 = t3 * t158;
  t897 = t896 * t435;
  t901 = t447 * t170 * t120;
  t905 = my_piecewise3(t60, 0, -0.64895402177010868827e-3 * t897 * t449 - t885 + 0.86527202902681158436e-3 * t445 * t901);
  tv3rhosigma211 = t7 * t905 + t452;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t907 = sigma[0] * sigma[0];
  t909 = 0.1e1 / t40 / t907;
  t911 = t909 * t43 * t120;
  t914 = my_piecewise3(t1, 0, 0.9734310326551630324e-3 * t436 * t911);
  tv3sigma30 = t7 * t914;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t915 = sigma[2] * sigma[2];
  t917 = 0.1e1 / t76 / t915;
  t919 = t917 * t79 * t120;
  t922 = my_piecewise3(t60, 0, 0.9734310326551630324e-3 * t445 * t919);
  tv3sigma39 = t7 * t922;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t11;
  double t12, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t24, t25, t26, t28, t29, t30;
  double t32, t33, t34, t36, t39, t40, t41, t43;
  double t47, t49, t50, t51, t52, t55, t59, t60;
  double t61, t62, t63, t64, t65, t67, t69, t70;
  double t71, t73, t76, t77, t79, t86, t90, tzk0;

  double t91, t92, t93, t94, t95, t98, t103, t107;
  double t108, t109, t111, t115, t118, t120, t121, t125;
  double t127, t130, t138, t140, tvrho0, t143, t144, t147;
  double t153, t155, t158, t163, t164, t166, t170, t173;
  double t175, t179, tvrho1, t184, t187, t189, t192, tvsigma0;
  double tvsigma1, t195, t198, t200, t203, tvsigma2;

  double t206, t207, t210, t211, t212, t214, t215, t219;
  double t226, t228, t232, t236, t238, t239, t241, t243;
  double t247, t250, t252, t256, t257, t258, t262, t266;
  double t273, t278, t280, tv2rho20, t283, t286, t287, t291;
  double t298, t300, t306, t307, t310, t314, t321, t324;
  double t328, t329, t332, tv2rho21, t337, t341, t342, t346;
  double t353, t354, t358, t362, t368, t372, t374, t378;
  double t381, t383, t387, tv2rho22, t393, t395, t399, t401;
  double t405, tv2rhosigma0, tv2rhosigma1, t410, t412, t414, tv2rhosigma2, t419;
  double tv2rhosigma3, tv2rhosigma4, t426, t428, t432, tv2rhosigma5, t434, t435;
  double t436, t438, t440, t443, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t444, t445, t447, t449, t452, tv2sigma25;

  double t456, t457, t460, t463, t464, t465, t467, t468;
  double t472, t479, t481, t486, t488, t493, t497, t499;
  double t500, t503, t504, t506, t508, t512, t515, t517;
  double t521, t523, t524, t527, t531, t535, t542, t546;
  double t551, t553, tv3rho30, t556, t557, t558, t561, t566;
  double t567, t568, t569, t573, t581, t582, t587, t590;
  double t598, t599, t600, t603, t609, t613, t621, t624;
  double t628, t632, t634, t635, t638, tv3rho31, t641, t646;
  double t649, t650, t654, t661, t663, t670, t671, t676;
  double t680, t684, t691, t694, t697, t704, t705, t707;
  double t708, tv3rho32, t713, t719, t720, t724, t732, t733;
  double t739, t743, t749, t758, t760, t764, t767, t769;
  double t773, tv3rho33, t779, t784, t786, t788, t789, t794;
  double t796, t800, tv3rho2sigma0, tv3rho2sigma1, t805, t808, t810, t812;
  double tv3rho2sigma2, t816, t823, tv3rho2sigma3, tv3rho2sigma4, t827, t833, t834;
  double t837, tv3rho2sigma5, t844, tv3rho2sigma6, tv3rho2sigma7, t856, t858, t862;
  double tv3rho2sigma8, t864, t865, t868, t869, t871, t873, t877;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t879, t880, t883;
  double t885, t887, tv3rhosigma25, t889, t890, t894, tv3rhosigma26, tv3rhosigma27;
  double tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t896, t897, t901, t905, tv3rhosigma211;
  double t907, t909, t911, t914, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33;
  double tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t915, t917, t919;
  double t922, tv3sigma39;

  double t925, t928, t932, t934, t940, t944, t948, t964;
  double t966, t967, t973, t980, t982, t983, t987, t994;
  double t998, t1002, t1005, t1009, t1010, t1011, t1012, t1014;
  double t1015, t1021, t1027, t1031, t1038, t1042, t1046, t1051;
  double t1053, tv4rho40, t1060, t1064, t1065, t1068, t1070, t1073;
  double t1077, t1078, t1079, t1105, t1106, t1107, t1108, t1112;
  double t1120, t1121, t1139, t1143, t1150, t1154, t1155, t1158;
  double t1163, t1166, t1168, t1169, t1172, t1174, t1175, tv4rho41;
  double t1190, t1203, t1207, t1214, t1218, t1223, t1226, t1238;
  double t1239, t1248, t1261, t1265, t1272, t1276, t1281, t1284;
  double t1286, t1295, t1299, t1301, t1302, tv4rho42, t1322, t1323;
  double t1327, t1334, t1336, t1345, t1346, t1363, t1367, t1374;
  double t1378, t1381, t1388, t1398, t1400, t1401, tv4rho43, t1406;
  double t1411, t1417, t1418, t1422, t1431, t1432, t1437, t1443;
  double t1447, t1461, t1482, t1483, tv4rho44, t1489, t1493, t1495;
  double t1502, t1505, t1509, t1520, tv4rho3sigma0, tv4rho3sigma1, t1525, t1527;
  double t1532, t1534, tv4rho3sigma2, t1536, t1540, t1543, t1546, t1554;
  double t1555, tv4rho3sigma3, tv4rho3sigma4, t1557, t1561, t1562, t1569, t1572;
  double t1575, tv4rho3sigma5, t1579, t1587, tv4rho3sigma6, tv4rho3sigma7, t1591, t1596;
  double t1604, t1606, t1607, tv4rho3sigma8, t1615, tv4rho3sigma9, tv4rho3sigma10, t1638;
  double tv4rho3sigma11, t1646, t1650, t1653, t1654, t1661, tv4rho2sigma20, tv4rho2sigma21;
  double tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t1669, t1673, t1675, tv4rho2sigma25, t1682;
  double t1689, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t1696, t1701;
  double t1704, tv4rho2sigma211, t1713, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216;
  double t1729, tv4rho2sigma217, t1734, t1740, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33;
  double tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t1745, t1747, tv4rhosigma39;
  double t1752, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316;
  double tv4rhosigma317, tv4rhosigma318, t1761, tv4rhosigma319, t1770, tv4sigma40, tv4sigma41, tv4sigma42;
  double tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410;
  double tv4sigma411, tv4sigma412, tv4sigma413, t1778, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = t2 * t2;
  t4 = M_CBRTPI;
  t6 = t3 * t4 * M_PI;
  t7 = rho[0] + rho[1];
  t8 = 0.1e1 / t7;
  t11 = 0.2e1 * rho[0] * t8 <= p->zeta_threshold;
  t12 = p->zeta_threshold - 0.1e1;
  t15 = 0.2e1 * rho[1] * t8 <= p->zeta_threshold;
  t16 = -t12;
  t17 = rho[0] - rho[1];
  t18 = t17 * t8;
  t19 = my_piecewise5(t11, t12, t15, t16, t18);
  t20 = 0.1e1 + t19;
  t21 = t20 <= p->zeta_threshold;
  t22 = POW_1_3(p->zeta_threshold);
  t23 = t22 * t22;
  t24 = t23 * p->zeta_threshold;
  t25 = POW_1_3(t20);
  t26 = t25 * t25;
  t28 = my_piecewise3(t21, t24, t26 * t20);
  t29 = POW_1_3(t7);
  t30 = t29 * t29;
  t32 = rho[0] * rho[0];
  t33 = POW_1_3(rho[0]);
  t34 = t33 * t33;
  t36 = 0.1e1 / t34 / t32;
  t39 = M_CBRT2;
  t40 = sqrt(sigma[0]);
  t41 = t39 * t40;
  t43 = 0.1e1 / t33 / rho[0];
  t47 = M_CBRT6;
  t49 = M_PI * M_PI;
  t50 = POW_1_3(t49);
  t51 = t50 * t50;
  t52 = 0.1e1 / t51;
  t55 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[0] * t36 / 0.72e2 + 0.677e-2 * t41 * t43) * t47 * t52;
  t59 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t28 * t30 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = my_piecewise5(t15, t12, t11, t16, -t18);
  t62 = 0.1e1 + t61;
  t63 = t62 <= p->zeta_threshold;
  t64 = POW_1_3(t62);
  t65 = t64 * t64;
  t67 = my_piecewise3(t63, t24, t65 * t62);
  t69 = rho[1] * rho[1];
  t70 = POW_1_3(rho[1]);
  t71 = t70 * t70;
  t73 = 0.1e1 / t71 / t69;
  t76 = sqrt(sigma[2]);
  t77 = t39 * t76;
  t79 = 0.1e1 / t70 / rho[1];
  t86 = 0.1e1 + 0.5e1 / 0.9e1 * (sigma[2] * t73 / 0.72e2 + 0.677e-2 * t77 * t79) * t47 * t52;
  t90 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t67 * t30 * t86);
  tzk0 = t59 + t90;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t91 = t7 * t7;
  t92 = 0.1e1 / t91;
  t93 = t17 * t92;
  t94 = t8 - t93;
  t95 = my_piecewise5(t11, 0, t15, 0, t94);
  t98 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t95);
  t103 = 0.1e1 / t29;
  t107 = t6 * t28 * t103 * t55 / 0.1e2;
  t108 = t6 * t28;
  t109 = t32 * rho[0];
  t111 = 0.1e1 / t34 / t109;
  t115 = 0.1e1 / t33 / t32;
  t118 = -sigma[0] * t111 / 0.27e2 - 0.90266666666666666666e-2 * t41 * t115;
  t120 = t47 * t52;
  t121 = t30 * t118 * t120;
  t125 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t98 * t30 * t55 + t107 + t108 * t121 / 0.12e2);
  t127 = my_piecewise5(t15, 0, t11, 0, -t94);
  t130 = my_piecewise3(t63, 0, 0.5e1 / 0.3e1 * t65 * t127);
  t138 = t6 * t67 * t103 * t86 / 0.1e2;
  t140 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t130 * t30 * t86 + t138);
  tvrho0 = t59 + t90 + t7 * (t125 + t140);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t143 = -t8 - t93;
  t144 = my_piecewise5(t11, 0, t15, 0, t143);
  t147 = my_piecewise3(t21, 0, 0.5e1 / 0.3e1 * t26 * t144);
  t153 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t147 * t30 * t55 + t107);
  t155 = my_piecewise5(t15, 0, t11, 0, -t143);
  t158 = my_piecewise3(t63, 0, 0.5e1 / 0.3e1 * t65 * t155);
  t163 = t6 * t67;
  t164 = t69 * rho[1];
  t166 = 0.1e1 / t71 / t164;
  t170 = 0.1e1 / t70 / t69;
  t173 = -sigma[2] * t166 / 0.27e2 - 0.90266666666666666666e-2 * t77 * t170;
  t175 = t30 * t173 * t120;
  t179 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t158 * t30 * t86 + t138 + t163 * t175 / 0.12e2);
  tvrho1 = t59 + t90 + t7 * (t153 + t179);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t184 = t39 / t40;
  t187 = t36 / 0.72e2 + 0.3385e-2 * t184 * t43;
  t189 = t30 * t187 * t120;
  t192 = my_piecewise3(t1, 0, t108 * t189 / 0.12e2);
  tvsigma0 = t7 * t192;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t195 = t39 / t76;
  t198 = t73 / 0.72e2 + 0.3385e-2 * t195 * t79;
  t200 = t30 * t198 * t120;
  t203 = my_piecewise3(t60, 0, t163 * t200 / 0.12e2);
  tvsigma2 = t7 * t203;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t206 = 0.1e1 / t25;
  t207 = t95 * t95;
  t210 = t91 * t7;
  t211 = 0.1e1 / t210;
  t212 = t17 * t211;
  t214 = -0.2e1 * t92 + 0.2e1 * t212;
  t215 = my_piecewise5(t11, 0, t15, 0, t214);
  t219 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t206 * t207 + 0.5e1 / 0.3e1 * t26 * t215);
  t226 = t6 * t98 * t103 * t55;
  t228 = t6 * t98;
  t232 = 0.1e1 / t29 / t7;
  t236 = t6 * t28 * t232 * t55 / 0.3e2;
  t238 = t103 * t118 * t120;
  t239 = t108 * t238;
  t241 = t32 * t32;
  t243 = 0.1e1 / t34 / t241;
  t247 = 0.1e1 / t33 / t109;
  t250 = 0.11e2 / 0.81e2 * sigma[0] * t243 + 0.21062222222222222222e-1 * t41 * t247;
  t252 = t30 * t250 * t120;
  t256 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t219 * t30 * t55 + t226 / 0.5e1 + t228 * t121 / 0.6e1 - t236 + t239 / 0.9e1 + t108 * t252 / 0.12e2);
  t257 = 0.1e1 / t64;
  t258 = t127 * t127;
  t262 = my_piecewise5(t15, 0, t11, 0, -t214);
  t266 = my_piecewise3(t63, 0, 0.1e2 / 0.9e1 * t257 * t258 + 0.5e1 / 0.3e1 * t65 * t262);
  t273 = t6 * t130 * t103 * t86;
  t278 = t6 * t67 * t232 * t86 / 0.3e2;
  t280 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t266 * t30 * t86 + t273 / 0.5e1 - t278);
  tv2rho20 = 0.2e1 * t125 + 0.2e1 * t140 + t7 * (t256 + t280);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t283 = t206 * t144;
  t286 = 0.2e1 * t212;
  t287 = my_piecewise5(t11, 0, t15, 0, t286);
  t291 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t283 * t95 + 0.5e1 / 0.3e1 * t26 * t287);
  t298 = t6 * t147 * t103 * t55;
  t300 = t6 * t147;
  t306 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t291 * t30 * t55 + t298 / 0.1e2 + t300 * t121 / 0.12e2 + t226 / 0.1e2 - t236 + t239 / 0.18e2);
  t307 = t257 * t155;
  t310 = my_piecewise5(t15, 0, t11, 0, -t286);
  t314 = my_piecewise3(t63, 0, 0.1e2 / 0.9e1 * t307 * t127 + 0.5e1 / 0.3e1 * t65 * t310);
  t321 = t6 * t158 * t103 * t86;
  t324 = t6 * t130;
  t328 = t103 * t173 * t120;
  t329 = t163 * t328;
  t332 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t314 * t30 * t86 + t321 / 0.1e2 + t273 / 0.1e2 - t278 + t324 * t175 / 0.12e2 + t329 / 0.18e2);
  tv2rho21 = t125 + t140 + t153 + t179 + t7 * (t306 + t332);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t337 = t144 * t144;
  t341 = 0.2e1 * t92 + 0.2e1 * t212;
  t342 = my_piecewise5(t11, 0, t15, 0, t341);
  t346 = my_piecewise3(t21, 0, 0.1e2 / 0.9e1 * t206 * t337 + 0.5e1 / 0.3e1 * t26 * t342);
  t353 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t346 * t30 * t55 + t298 / 0.5e1 - t236);
  t354 = t155 * t155;
  t358 = my_piecewise5(t15, 0, t11, 0, -t341);
  t362 = my_piecewise3(t63, 0, 0.1e2 / 0.9e1 * t257 * t354 + 0.5e1 / 0.3e1 * t65 * t358);
  t368 = t6 * t158;
  t372 = t69 * t69;
  t374 = 0.1e1 / t71 / t372;
  t378 = 0.1e1 / t70 / t164;
  t381 = 0.11e2 / 0.81e2 * sigma[2] * t374 + 0.21062222222222222222e-1 * t77 * t378;
  t383 = t30 * t381 * t120;
  t387 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t362 * t30 * t86 + t321 / 0.5e1 + t368 * t175 / 0.6e1 - t278 + t329 / 0.9e1 + t163 * t383 / 0.12e2);
  tv2rho22 = 0.2e1 * t153 + 0.2e1 * t179 + t7 * (t353 + t387);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t393 = t103 * t187 * t120;
  t395 = t108 * t393 / 0.18e2;
  t399 = -t111 / 0.27e2 - 0.45133333333333333333e-2 * t184 * t115;
  t401 = t30 * t399 * t120;
  t405 = my_piecewise3(t1, 0, t228 * t189 / 0.12e2 + t395 + t108 * t401 / 0.12e2);
  tv2rhosigma0 = t405 * t7 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t410 = t103 * t198 * t120;
  t412 = t163 * t410 / 0.18e2;
  t414 = my_piecewise3(t60, 0, t324 * t200 / 0.12e2 + t412);
  tv2rhosigma2 = t414 * t7 + t203;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t419 = my_piecewise3(t1, 0, t300 * t189 / 0.12e2 + t395);
  tv2rhosigma3 = t419 * t7 + t192;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t426 = -t166 / 0.27e2 - 0.45133333333333333333e-2 * t195 * t170;
  t428 = t30 * t426 * t120;
  t432 = my_piecewise3(t60, 0, t368 * t200 / 0.12e2 + t412 + t163 * t428 / 0.12e2);
  tv2rhosigma5 = t432 * t7 + t203;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t434 = t3 * t28;
  t435 = t30 * t39;
  t436 = t434 * t435;
  t438 = 0.1e1 / t40 / sigma[0];
  t440 = t438 * t43 * t120;
  t443 = my_piecewise3(t1, 0, -0.64895402177010868827e-3 * t436 * t440);
  tv2sigma20 = t7 * t443;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t444 = t3 * t67;
  t445 = t444 * t435;
  t447 = 0.1e1 / t76 / sigma[2];
  t449 = t447 * t79 * t120;
  t452 = my_piecewise3(t60, 0, -0.64895402177010868827e-3 * t445 * t449);
  tv2sigma25 = t7 * t452;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t456 = 0.1e1 / t25 / t20;
  t457 = t207 * t95;
  t460 = t206 * t95;
  t463 = t91 * t91;
  t464 = 0.1e1 / t463;
  t465 = t17 * t464;
  t467 = 0.6e1 * t211 - 0.6e1 * t465;
  t468 = my_piecewise5(t11, 0, t15, 0, t467);
  t472 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t456 * t457 + 0.1e2 / 0.3e1 * t460 * t215 + 0.5e1 / 0.3e1 * t26 * t468);
  t479 = t6 * t219 * t103 * t55;
  t481 = t6 * t219;
  t486 = t6 * t98 * t232 * t55;
  t488 = t228 * t238;
  t493 = 0.1e1 / t29 / t91;
  t497 = 0.2e1 / 0.45e2 * t6 * t28 * t493 * t55;
  t499 = t232 * t118 * t120;
  t500 = t108 * t499;
  t503 = t103 * t250 * t120;
  t504 = t108 * t503;
  t506 = t241 * rho[0];
  t508 = 0.1e1 / t34 / t506;
  t512 = 0.1e1 / t33 / t241;
  t515 = -0.154e3 / 0.243e3 * sigma[0] * t508 - 0.70207407407407407407e-1 * t41 * t512;
  t517 = t30 * t515 * t120;
  t521 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t472 * t30 * t55 + 0.3e1 / 0.1e2 * t479 + t481 * t121 / 0.4e1 - t486 / 0.1e2 + t488 / 0.3e1 + t228 * t252 / 0.4e1 + t497 - t500 / 0.18e2 + t504 / 0.6e1 + t108 * t517 / 0.12e2);
  t523 = 0.1e1 / t64 / t62;
  t524 = t258 * t127;
  t527 = t257 * t127;
  t531 = my_piecewise5(t15, 0, t11, 0, -t467);
  t535 = my_piecewise3(t63, 0, -0.1e2 / 0.27e2 * t523 * t524 + 0.1e2 / 0.3e1 * t527 * t262 + 0.5e1 / 0.3e1 * t65 * t531);
  t542 = t6 * t266 * t103 * t86;
  t546 = t6 * t130 * t232 * t86;
  t551 = 0.2e1 / 0.45e2 * t6 * t67 * t493 * t86;
  t553 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t535 * t30 * t86 + 0.3e1 / 0.1e2 * t542 - t546 / 0.1e2 + t551);
  tv3rho30 = 0.3e1 * t256 + 0.3e1 * t280 + t7 * (t521 + t553);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t556 = 0.2e1 * t306;
  t557 = 0.2e1 * t332;
  t558 = t456 * t144;
  t561 = t206 * t287;
  t566 = 0.2e1 * t211;
  t567 = 0.6e1 * t465;
  t568 = t566 - t567;
  t569 = my_piecewise5(t11, 0, t15, 0, t568);
  t573 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t558 * t207 + 0.2e2 / 0.9e1 * t561 * t95 + 0.1e2 / 0.9e1 * t283 * t215 + 0.5e1 / 0.3e1 * t26 * t569);
  t581 = t6 * t291 * t103 * t55 / 0.5e1;
  t582 = t6 * t291;
  t587 = t6 * t147 * t232 * t55;
  t590 = t300 * t238 / 0.9e1;
  t598 = 0.3e1 / 0.2e2 * t6 * t573 * t30 * t55 + t581 + t582 * t121 / 0.6e1 - t587 / 0.3e2 + t590 + t300 * t252 / 0.12e2 + t479 / 0.1e2 - t486 / 0.15e2 + t488 / 0.9e1 + t497 - t500 / 0.27e2 + t504 / 0.18e2;
  t599 = my_piecewise3(t1, 0, t598);
  t600 = t523 * t155;
  t603 = t257 * t310;
  t609 = my_piecewise5(t15, 0, t11, 0, -t568);
  t613 = my_piecewise3(t63, 0, -0.1e2 / 0.27e2 * t600 * t258 + 0.2e2 / 0.9e1 * t603 * t127 + 0.1e2 / 0.9e1 * t307 * t262 + 0.5e1 / 0.3e1 * t65 * t609);
  t621 = t6 * t314 * t103 * t86 / 0.5e1;
  t624 = t6 * t158 * t232 * t86;
  t628 = t6 * t266;
  t632 = t324 * t328 / 0.9e1;
  t634 = t232 * t173 * t120;
  t635 = t163 * t634;
  t638 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t613 * t30 * t86 + t621 - t624 / 0.3e2 + t542 / 0.1e2 - t546 / 0.15e2 + t551 + t628 * t175 / 0.12e2 + t632 - t635 / 0.54e2);
  tv3rho31 = t256 + t280 + t556 + t557 + t7 * (t599 + t638);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t641 = t456 * t337;
  t646 = t206 * t342;
  t649 = -t566 - t567;
  t650 = my_piecewise5(t11, 0, t15, 0, t649);
  t654 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t641 * t95 + 0.2e2 / 0.9e1 * t283 * t287 + 0.1e2 / 0.9e1 * t646 * t95 + 0.5e1 / 0.3e1 * t26 * t650);
  t661 = t6 * t346 * t103 * t55;
  t663 = t6 * t346;
  t670 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t654 * t30 * t55 + t661 / 0.1e2 + t663 * t121 / 0.12e2 + t581 - t587 / 0.15e2 + t590 - t486 / 0.3e2 + t497 - t500 / 0.54e2);
  t671 = t523 * t354;
  t676 = t257 * t358;
  t680 = my_piecewise5(t15, 0, t11, 0, -t649);
  t684 = my_piecewise3(t63, 0, -0.1e2 / 0.27e2 * t671 * t127 + 0.2e2 / 0.9e1 * t307 * t310 + 0.1e2 / 0.9e1 * t676 * t127 + 0.5e1 / 0.3e1 * t65 * t680);
  t691 = t6 * t362 * t103 * t86;
  t694 = t6 * t314;
  t697 = t368 * t328;
  t704 = t103 * t381 * t120;
  t705 = t163 * t704;
  t707 = 0.3e1 / 0.2e2 * t6 * t684 * t30 * t86 + t691 / 0.1e2 + t621 - t624 / 0.15e2 + t694 * t175 / 0.6e1 + t697 / 0.9e1 - t546 / 0.3e2 + t551 + t632 - t635 / 0.27e2 + t324 * t383 / 0.12e2 + t705 / 0.18e2;
  t708 = my_piecewise3(t60, 0, t707);
  tv3rho32 = t556 + t557 + t353 + t387 + t7 * (t670 + t708);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t713 = t337 * t144;
  t719 = -0.6e1 * t211 - 0.6e1 * t465;
  t720 = my_piecewise5(t11, 0, t15, 0, t719);
  t724 = my_piecewise3(t21, 0, -0.1e2 / 0.27e2 * t456 * t713 + 0.1e2 / 0.3e1 * t283 * t342 + 0.5e1 / 0.3e1 * t26 * t720);
  t732 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t724 * t30 * t55 + 0.3e1 / 0.1e2 * t661 - t587 / 0.1e2 + t497);
  t733 = t354 * t155;
  t739 = my_piecewise5(t15, 0, t11, 0, -t719);
  t743 = my_piecewise3(t63, 0, -0.1e2 / 0.27e2 * t523 * t733 + 0.1e2 / 0.3e1 * t307 * t358 + 0.5e1 / 0.3e1 * t65 * t739);
  t749 = t6 * t362;
  t758 = t372 * rho[1];
  t760 = 0.1e1 / t71 / t758;
  t764 = 0.1e1 / t70 / t372;
  t767 = -0.154e3 / 0.243e3 * sigma[2] * t760 - 0.70207407407407407407e-1 * t77 * t764;
  t769 = t30 * t767 * t120;
  t773 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t743 * t30 * t86 + 0.3e1 / 0.1e2 * t691 + t749 * t175 / 0.4e1 - t624 / 0.1e2 + t697 / 0.3e1 + t368 * t383 / 0.4e1 + t551 - t635 / 0.18e2 + t705 / 0.6e1 + t163 * t769 / 0.12e2);
  tv3rho33 = 0.3e1 * t353 + 0.3e1 * t387 + t7 * (t732 + t773);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t779 = t228 * t393;
  t784 = t232 * t187 * t120;
  t786 = t108 * t784 / 0.54e2;
  t788 = t103 * t399 * t120;
  t789 = t108 * t788;
  t794 = 0.11e2 / 0.81e2 * t243 + 0.10531111111111111111e-1 * t184 * t247;
  t796 = t30 * t794 * t120;
  t800 = my_piecewise3(t1, 0, t481 * t189 / 0.12e2 + t779 / 0.9e1 + t228 * t401 / 0.6e1 - t786 + t789 / 0.9e1 + t108 * t796 / 0.12e2);
  tv3rho2sigma0 = t7 * t800 + 0.2e1 * t405;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t805 = t324 * t410;
  t808 = t232 * t198 * t120;
  t810 = t163 * t808 / 0.54e2;
  t812 = my_piecewise3(t60, 0, t628 * t200 / 0.12e2 + t805 / 0.9e1 - t810);
  tv3rho2sigma2 = t7 * t812 + 0.2e1 * t414;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t816 = t300 * t393;
  t823 = my_piecewise3(t1, 0, t582 * t189 / 0.12e2 + t816 / 0.18e2 + t300 * t401 / 0.12e2 + t779 / 0.18e2 - t786 + t789 / 0.18e2);
  tv3rho2sigma3 = t7 * t823 + t405 + t419;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t827 = t368 * t410;
  t833 = t103 * t426 * t120;
  t834 = t163 * t833;
  t837 = my_piecewise3(t60, 0, t694 * t200 / 0.12e2 + t827 / 0.18e2 + t805 / 0.18e2 - t810 + t324 * t428 / 0.12e2 + t834 / 0.18e2);
  tv3rho2sigma5 = t7 * t837 + t414 + t432;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t844 = my_piecewise3(t1, 0, t663 * t189 / 0.12e2 + t816 / 0.9e1 - t786);
  tv3rho2sigma6 = t7 * t844 + 0.2e1 * t419;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t856 = 0.11e2 / 0.81e2 * t374 + 0.10531111111111111111e-1 * t195 * t378;
  t858 = t30 * t856 * t120;
  t862 = my_piecewise3(t60, 0, t749 * t200 / 0.12e2 + t827 / 0.9e1 + t368 * t428 / 0.6e1 - t810 + t834 / 0.9e1 + t163 * t858 / 0.12e2);
  tv3rho2sigma8 = t7 * t862 + 0.2e1 * t432;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t864 = t3 * t98;
  t865 = t864 * t435;
  t868 = t103 * t39;
  t869 = t434 * t868;
  t871 = 0.43263601451340579218e-3 * t869 * t440;
  t873 = t438 * t115 * t120;
  t877 = my_piecewise3(t1, 0, -0.64895402177010868827e-3 * t865 * t440 - t871 + 0.86527202902681158436e-3 * t436 * t873);
  tv3rhosigma20 = t7 * t877 + t443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t879 = t3 * t130;
  t880 = t879 * t435;
  t883 = t444 * t868;
  t885 = 0.43263601451340579218e-3 * t883 * t449;
  t887 = my_piecewise3(t60, 0, -0.64895402177010868827e-3 * t880 * t449 - t885);
  tv3rhosigma25 = t7 * t887 + t452;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t889 = t3 * t147;
  t890 = t889 * t435;
  t894 = my_piecewise3(t1, 0, -0.64895402177010868827e-3 * t890 * t440 - t871);
  tv3rhosigma26 = t7 * t894 + t443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t896 = t3 * t158;
  t897 = t896 * t435;
  t901 = t447 * t170 * t120;
  t905 = my_piecewise3(t60, 0, -0.64895402177010868827e-3 * t897 * t449 - t885 + 0.86527202902681158436e-3 * t445 * t901);
  tv3rhosigma211 = t7 * t905 + t452;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t907 = sigma[0] * sigma[0];
  t909 = 0.1e1 / t40 / t907;
  t911 = t909 * t43 * t120;
  t914 = my_piecewise3(t1, 0, 0.9734310326551630324e-3 * t436 * t911);
  tv3sigma30 = t7 * t914;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t915 = sigma[2] * sigma[2];
  t917 = 0.1e1 / t76 / t915;
  t919 = t917 * t79 * t120;
  t922 = my_piecewise3(t60, 0, 0.9734310326551630324e-3 * t445 * t919);
  tv3sigma39 = t7 * t922;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t925 = t6 * t472;
  t928 = t481 * t238;
  t932 = t228 * t499;
  t934 = t228 * t503;
  t940 = t108 * t493 * t118 * t120;
  t944 = t108 * t232 * t250 * t120;
  t948 = t108 * t103 * t515 * t120;
  t964 = t20 * t20;
  t966 = 0.1e1 / t25 / t964;
  t967 = t207 * t207;
  t973 = t215 * t215;
  t980 = t17 / t463 / t7;
  t982 = -0.24e2 * t464 + 0.24e2 * t980;
  t983 = my_piecewise5(t11, 0, t15, 0, t982);
  t987 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t966 * t967 - 0.2e2 / 0.9e1 * t456 * t207 * t215 + 0.1e2 / 0.3e1 * t206 * t973 + 0.4e2 / 0.9e1 * t460 * t468 + 0.5e1 / 0.3e1 * t26 * t983);
  t994 = t6 * t472 * t103 * t55;
  t998 = t6 * t219 * t232 * t55;
  t1002 = t6 * t98 * t493 * t55;
  t1005 = 0.1e1 / t29 / t210;
  t1009 = 0.14e2 / 0.135e3 * t6 * t28 * t1005 * t55;
  t1010 = t925 * t121 / 0.3e1 + 0.2e1 / 0.3e1 * t928 + t481 * t252 / 0.2e1 - 0.2e1 / 0.9e1 * t932 + 0.2e1 / 0.3e1 * t934 + t228 * t517 / 0.3e1 + 0.8e1 / 0.81e2 * t940 - t944 / 0.9e1 + 0.2e1 / 0.9e1 * t948 + t108 * t30 * (0.2618e4 / 0.729e3 * sigma[0] / t34 / t241 / t32 + 0.30423209876543209876e0 * t41 / t33 / t506) * t120 / 0.12e2 + 0.3e1 / 0.2e2 * t6 * t987 * t30 * t55 + 0.2e1 / 0.5e1 * t994 - t998 / 0.5e1 + 0.8e1 / 0.45e2 * t1002 - t1009;
  t1011 = my_piecewise3(t1, 0, t1010);
  t1012 = t62 * t62;
  t1014 = 0.1e1 / t64 / t1012;
  t1015 = t258 * t258;
  t1021 = t262 * t262;
  t1027 = my_piecewise5(t15, 0, t11, 0, -t982);
  t1031 = my_piecewise3(t63, 0, 0.4e2 / 0.81e2 * t1014 * t1015 - 0.2e2 / 0.9e1 * t523 * t258 * t262 + 0.1e2 / 0.3e1 * t257 * t1021 + 0.4e2 / 0.9e1 * t527 * t531 + 0.5e1 / 0.3e1 * t65 * t1027);
  t1038 = t6 * t535 * t103 * t86;
  t1042 = t6 * t266 * t232 * t86;
  t1046 = t6 * t130 * t493 * t86;
  t1051 = 0.14e2 / 0.135e3 * t6 * t67 * t1005 * t86;
  t1053 = my_piecewise3(t60, 0, 0.3e1 / 0.2e2 * t6 * t1031 * t30 * t86 + 0.2e1 / 0.5e1 * t1038 - t1042 / 0.5e1 + 0.8e1 / 0.45e2 * t1046 - t1051);
  tv4rho40 = 0.4e1 * t521 + 0.4e1 * t553 + t7 * (t1011 + t1053);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1060 = t6 * t573 * t103 * t55;
  t1064 = t6 * t291 * t232 * t55;
  t1065 = t1064 / 0.1e2;
  t1068 = t6 * t147 * t493 * t55;
  t1070 = t6 * t573;
  t1073 = t582 * t238;
  t1077 = t300 * t499;
  t1078 = t1077 / 0.18e2;
  t1079 = t300 * t503;
  t1105 = 0.12e2 * t464;
  t1106 = 0.24e2 * t980;
  t1107 = -t1105 + t1106;
  t1108 = my_piecewise5(t11, 0, t15, 0, t1107);
  t1112 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t966 * t144 * t457 - 0.1e2 / 0.9e1 * t456 * t287 * t207 - 0.1e2 / 0.9e1 * t558 * t95 * t215 + 0.1e2 / 0.3e1 * t206 * t569 * t95 + 0.1e2 / 0.3e1 * t561 * t215 + 0.1e2 / 0.9e1 * t283 * t468 + 0.5e1 / 0.3e1 * t26 * t1108);
  t1120 = 0.3e1 / 0.1e2 * t1060 - t1065 + 0.2e1 / 0.45e2 * t1068 + t1070 * t121 / 0.4e1 + t1073 / 0.3e1 + t582 * t252 / 0.4e1 - t1078 + t1079 / 0.6e1 + t300 * t517 / 0.12e2 + t928 / 0.6e1 - t932 / 0.9e1 + t934 / 0.6e1 + 0.2e1 / 0.27e2 * t940 - t944 / 0.18e2 + t948 / 0.18e2 + 0.3e1 / 0.2e2 * t6 * t1112 * t30 * t55 + t994 / 0.1e2 - t998 / 0.1e2 + 0.2e1 / 0.15e2 * t1002 - t1009;
  t1121 = my_piecewise3(t1, 0, t1120);
  t1139 = my_piecewise5(t15, 0, t11, 0, -t1107);
  t1143 = my_piecewise3(t63, 0, 0.4e2 / 0.81e2 * t1014 * t155 * t524 - 0.1e2 / 0.9e1 * t523 * t310 * t258 - 0.1e2 / 0.9e1 * t600 * t127 * t262 + 0.1e2 / 0.3e1 * t257 * t609 * t127 + 0.1e2 / 0.3e1 * t603 * t262 + 0.1e2 / 0.9e1 * t307 * t531 + 0.5e1 / 0.3e1 * t65 * t1139);
  t1150 = t6 * t613 * t103 * t86;
  t1154 = t6 * t314 * t232 * t86;
  t1155 = t1154 / 0.1e2;
  t1158 = t6 * t158 * t493 * t86;
  t1163 = t6 * t535;
  t1166 = t628 * t328;
  t1168 = t324 * t634;
  t1169 = t1168 / 0.18e2;
  t1172 = t163 * t493 * t173 * t120;
  t1174 = 0.3e1 / 0.2e2 * t6 * t1143 * t30 * t86 + 0.3e1 / 0.1e2 * t1150 - t1155 + 0.2e1 / 0.45e2 * t1158 + t1038 / 0.1e2 - t1042 / 0.1e2 + 0.2e1 / 0.15e2 * t1046 - t1051 + t1163 * t175 / 0.12e2 + t1166 / 0.6e1 - t1169 + 0.2e1 / 0.81e2 * t1172;
  t1175 = my_piecewise3(t60, 0, t1174);
  tv4rho41 = t521 + t553 + 0.3e1 * t599 + 0.3e1 * t638 + t7 * (t1121 + t1175);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1190 = t287 * t287;
  t1203 = my_piecewise5(t11, 0, t15, 0, t1106);
  t1207 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t966 * t337 * t207 - 0.4e2 / 0.27e2 * t558 * t95 * t287 - 0.1e2 / 0.27e2 * t641 * t215 + 0.2e2 / 0.9e1 * t206 * t1190 + 0.2e2 / 0.9e1 * t283 * t569 - 0.1e2 / 0.27e2 * t456 * t342 * t207 + 0.2e2 / 0.9e1 * t206 * t650 * t95 + 0.1e2 / 0.9e1 * t646 * t215 + 0.5e1 / 0.3e1 * t26 * t1203);
  t1214 = t6 * t654 * t103 * t55;
  t1218 = t6 * t346 * t232 * t55;
  t1223 = t6 * t654;
  t1226 = t663 * t238;
  t1238 = 0.3e1 / 0.2e2 * t6 * t1207 * t30 * t55 + t1214 / 0.5e1 - t1218 / 0.3e2 + t1060 / 0.5e1 - 0.2e1 / 0.15e2 * t1064 + 0.4e1 / 0.45e2 * t1068 + t1223 * t121 / 0.6e1 + t1226 / 0.9e1 + t663 * t252 / 0.12e2 + 0.2e1 / 0.9e1 * t1073 - 0.2e1 / 0.27e2 * t1077 + t1079 / 0.9e1 - t932 / 0.27e2 + 0.4e1 / 0.81e2 * t940 - t944 / 0.54e2 - t998 / 0.3e2 + 0.4e1 / 0.45e2 * t1002 - t1009;
  t1239 = my_piecewise3(t1, 0, t1238);
  t1248 = t310 * t310;
  t1261 = my_piecewise5(t15, 0, t11, 0, -t1106);
  t1265 = my_piecewise3(t63, 0, 0.4e2 / 0.81e2 * t1014 * t354 * t258 - 0.4e2 / 0.27e2 * t600 * t127 * t310 - 0.1e2 / 0.27e2 * t671 * t262 + 0.2e2 / 0.9e1 * t257 * t1248 + 0.2e2 / 0.9e1 * t307 * t609 - 0.1e2 / 0.27e2 * t523 * t358 * t258 + 0.2e2 / 0.9e1 * t257 * t680 * t127 + 0.1e2 / 0.9e1 * t676 * t262 + 0.5e1 / 0.3e1 * t65 * t1261);
  t1272 = t6 * t684 * t103 * t86;
  t1276 = t6 * t362 * t232 * t86;
  t1281 = t6 * t613;
  t1284 = t694 * t328;
  t1286 = t368 * t634;
  t1295 = t324 * t704;
  t1299 = t163 * t232 * t381 * t120;
  t1301 = 0.3e1 / 0.2e2 * t6 * t1265 * t30 * t86 + t1272 / 0.5e1 - t1276 / 0.3e2 + t1150 / 0.5e1 - 0.2e1 / 0.15e2 * t1154 + 0.4e1 / 0.45e2 * t1158 + t1281 * t175 / 0.6e1 + 0.2e1 / 0.9e1 * t1284 - t1286 / 0.27e2 - t1042 / 0.3e2 + 0.4e1 / 0.45e2 * t1046 - t1051 + t1166 / 0.9e1 - 0.2e1 / 0.27e2 * t1168 + 0.4e1 / 0.81e2 * t1172 + t628 * t383 / 0.12e2 + t1295 / 0.9e1 - t1299 / 0.54e2;
  t1302 = my_piecewise3(t60, 0, t1301);
  tv4rho42 = 0.2e1 * t599 + 0.2e1 * t638 + 0.2e1 * t670 + 0.2e1 * t708 + t7 * (t1239 + t1302);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1322 = t1105 + t1106;
  t1323 = my_piecewise5(t11, 0, t15, 0, t1322);
  t1327 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t966 * t713 * t95 - 0.1e2 / 0.9e1 * t641 * t287 - 0.1e2 / 0.9e1 * t558 * t342 * t95 + 0.1e2 / 0.3e1 * t561 * t342 + 0.1e2 / 0.3e1 * t283 * t650 + 0.1e2 / 0.9e1 * t206 * t720 * t95 + 0.5e1 / 0.3e1 * t26 * t1323);
  t1334 = t6 * t724 * t103 * t55;
  t1336 = t6 * t724;
  t1345 = 0.3e1 / 0.2e2 * t6 * t1327 * t30 * t55 + t1334 / 0.1e2 + t1336 * t121 / 0.12e2 + 0.3e1 / 0.1e2 * t1214 - t1218 / 0.1e2 + t1226 / 0.6e1 - t1065 + 0.2e1 / 0.15e2 * t1068 - t1078 + 0.2e1 / 0.45e2 * t1002 - t1009 + 0.2e1 / 0.81e2 * t940;
  t1346 = my_piecewise3(t1, 0, t1345);
  t1363 = my_piecewise5(t15, 0, t11, 0, -t1322);
  t1367 = my_piecewise3(t63, 0, 0.4e2 / 0.81e2 * t1014 * t733 * t127 - 0.1e2 / 0.9e1 * t671 * t310 - 0.1e2 / 0.9e1 * t600 * t358 * t127 + 0.1e2 / 0.3e1 * t603 * t358 + 0.1e2 / 0.3e1 * t307 * t680 + 0.1e2 / 0.9e1 * t257 * t739 * t127 + 0.5e1 / 0.3e1 * t65 * t1363);
  t1374 = t6 * t743 * t103 * t86;
  t1378 = t6 * t684;
  t1381 = t749 * t328;
  t1388 = t368 * t704;
  t1398 = t163 * t103 * t767 * t120;
  t1400 = 0.3e1 / 0.2e2 * t6 * t1367 * t30 * t86 + t1374 / 0.1e2 + 0.3e1 / 0.1e2 * t1272 - t1276 / 0.1e2 + t1378 * t175 / 0.4e1 + t1381 / 0.6e1 - t1155 + 0.2e1 / 0.15e2 * t1158 + t1284 / 0.3e1 - t1286 / 0.9e1 + t694 * t383 / 0.4e1 + t1388 / 0.6e1 + 0.2e1 / 0.45e2 * t1046 - t1051 - t1169 + 0.2e1 / 0.27e2 * t1172 + t1295 / 0.6e1 - t1299 / 0.18e2 + t324 * t769 / 0.12e2 + t1398 / 0.18e2;
  t1401 = my_piecewise3(t60, 0, t1400);
  tv4rho43 = 0.3e1 * t670 + 0.3e1 * t708 + t732 + t773 + t7 * (t1346 + t1401);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1406 = t337 * t337;
  t1411 = t342 * t342;
  t1417 = 0.24e2 * t464 + 0.24e2 * t980;
  t1418 = my_piecewise5(t11, 0, t15, 0, t1417);
  t1422 = my_piecewise3(t21, 0, 0.4e2 / 0.81e2 * t966 * t1406 - 0.2e2 / 0.9e1 * t641 * t342 + 0.1e2 / 0.3e1 * t206 * t1411 + 0.4e2 / 0.9e1 * t283 * t720 + 0.5e1 / 0.3e1 * t26 * t1418);
  t1431 = my_piecewise3(t1, 0, 0.3e1 / 0.2e2 * t6 * t1422 * t30 * t55 + 0.2e1 / 0.5e1 * t1334 - t1218 / 0.5e1 + 0.8e1 / 0.45e2 * t1068 - t1009);
  t1432 = t354 * t354;
  t1437 = t358 * t358;
  t1443 = my_piecewise5(t15, 0, t11, 0, -t1417);
  t1447 = my_piecewise3(t63, 0, 0.4e2 / 0.81e2 * t1014 * t1432 - 0.2e2 / 0.9e1 * t671 * t358 + 0.1e2 / 0.3e1 * t257 * t1437 + 0.4e2 / 0.9e1 * t307 * t739 + 0.5e1 / 0.3e1 * t65 * t1443);
  t1461 = t6 * t743;
  t1482 = 0.3e1 / 0.2e2 * t6 * t1447 * t30 * t86 + 0.2e1 / 0.9e1 * t1398 + 0.2e1 / 0.3e1 * t1381 + 0.2e1 / 0.3e1 * t1388 - t1299 / 0.9e1 - 0.2e1 / 0.9e1 * t1286 + 0.8e1 / 0.81e2 * t1172 + 0.2e1 / 0.5e1 * t1374 - t1276 / 0.5e1 + 0.8e1 / 0.45e2 * t1158 + t1461 * t175 / 0.3e1 + t749 * t383 / 0.2e1 + t368 * t769 / 0.3e1 + t163 * t30 * (0.2618e4 / 0.729e3 * sigma[2] / t71 / t372 / t69 + 0.30423209876543209876e0 * t77 / t70 / t758) * t120 / 0.12e2 - t1051;
  t1483 = my_piecewise3(t60, 0, t1482);
  tv4rho44 = 0.4e1 * t732 + 0.4e1 * t773 + t7 * (t1431 + t1483);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1489 = t481 * t393;
  t1493 = t228 * t784;
  t1495 = t228 * t788;
  t1502 = 0.2e1 / 0.81e2 * t108 * t493 * t187 * t120;
  t1505 = t108 * t232 * t399 * t120;
  t1509 = t108 * t103 * t794 * t120;
  t1520 = my_piecewise3(t1, 0, t925 * t189 / 0.12e2 + t1489 / 0.6e1 + t481 * t401 / 0.4e1 - t1493 / 0.18e2 + t1495 / 0.3e1 + t228 * t796 / 0.4e1 + t1502 - t1505 / 0.18e2 + t1509 / 0.6e1 + t108 * t30 * (-0.154e3 / 0.243e3 * t508 - 0.35103703703703703703e-1 * t184 * t512) * t120 / 0.12e2);
  tv4rho3sigma0 = t7 * t1520 + 0.3e1 * t800;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1525 = t628 * t410;
  t1527 = t324 * t808;
  t1532 = 0.2e1 / 0.81e2 * t163 * t493 * t198 * t120;
  t1534 = my_piecewise3(t60, 0, t1163 * t200 / 0.12e2 + t1525 / 0.6e1 - t1527 / 0.18e2 + t1532);
  tv4rho3sigma2 = t7 * t1534 + 0.3e1 * t812;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1536 = 0.2e1 * t823;
  t1540 = t582 * t393 / 0.9e1;
  t1543 = t300 * t784;
  t1546 = t300 * t788 / 0.9e1;
  t1554 = t1070 * t189 / 0.12e2 + t1540 + t582 * t401 / 0.6e1 - t1543 / 0.54e2 + t1546 + t300 * t796 / 0.12e2 + t1489 / 0.18e2 - t1493 / 0.27e2 + t1495 / 0.9e1 + t1502 - t1505 / 0.27e2 + t1509 / 0.18e2;
  t1555 = my_piecewise3(t1, 0, t1554);
  tv4rho3sigma3 = t7 * t1555 + t1536 + t800;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1557 = 0.2e1 * t837;
  t1561 = t694 * t410 / 0.9e1;
  t1562 = t368 * t808;
  t1569 = t324 * t833 / 0.9e1;
  t1572 = t163 * t232 * t426 * t120;
  t1575 = my_piecewise3(t60, 0, t1281 * t200 / 0.12e2 + t1561 - t1562 / 0.54e2 + t1525 / 0.18e2 - t1527 / 0.27e2 + t1532 + t628 * t428 / 0.12e2 + t1569 - t1572 / 0.54e2);
  tv4rho3sigma5 = t7 * t1575 + t1557 + t812;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t1579 = t663 * t393;
  t1587 = my_piecewise3(t1, 0, t1223 * t189 / 0.12e2 + t1579 / 0.18e2 + t663 * t401 / 0.12e2 + t1540 - t1543 / 0.27e2 + t1546 - t1493 / 0.54e2 + t1502 - t1505 / 0.54e2);
  tv4rho3sigma6 = t7 * t1587 + t1536 + t844;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t1591 = t749 * t410;
  t1596 = t368 * t833;
  t1604 = t163 * t103 * t856 * t120;
  t1606 = t1378 * t200 / 0.12e2 + t1591 / 0.18e2 + t1561 - t1562 / 0.27e2 + t694 * t428 / 0.6e1 + t1596 / 0.9e1 - t1527 / 0.54e2 + t1532 + t1569 - t1572 / 0.27e2 + t324 * t858 / 0.12e2 + t1604 / 0.18e2;
  t1607 = my_piecewise3(t60, 0, t1606);
  tv4rho3sigma8 = t7 * t1607 + t1557 + t862;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t1615 = my_piecewise3(t1, 0, t1336 * t189 / 0.12e2 + t1579 / 0.6e1 - t1543 / 0.18e2 + t1502);
  tv4rho3sigma9 = t7 * t1615 + 0.3e1 * t844;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t1638 = my_piecewise3(t60, 0, t1461 * t200 / 0.12e2 + t1591 / 0.6e1 + t749 * t428 / 0.4e1 - t1562 / 0.18e2 + t1596 / 0.3e1 + t368 * t858 / 0.4e1 + t1532 - t1572 / 0.18e2 + t1604 / 0.6e1 + t163 * t30 * (-0.154e3 / 0.243e3 * t760 - 0.35103703703703703703e-1 * t195 * t764) * t120 / 0.12e2);
  tv4rho3sigma11 = t7 * t1638 + 0.3e1 * t862;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t1646 = t864 * t868 * t440;
  t1650 = t232 * t39;
  t1653 = 0.14421200483780193073e-3 * t434 * t1650 * t440;
  t1654 = t869 * t873;
  t1661 = my_piecewise3(t1, 0, -0.64895402177010868827e-3 * t3 * t219 * t435 * t440 - 0.86527202902681158436e-3 * t1646 + 0.17305440580536231687e-2 * t865 * t873 + t1653 + 0.11536960387024154458e-2 * t1654 - 0.20189680677292270302e-2 * t436 * t438 * t247 * t120);
  tv4rho2sigma20 = t7 * t1661 + 0.2e1 * t877;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t1669 = t879 * t868 * t449;
  t1673 = 0.14421200483780193073e-3 * t444 * t1650 * t449;
  t1675 = my_piecewise3(t60, 0, -0.64895402177010868827e-3 * t3 * t266 * t435 * t449 - 0.86527202902681158436e-3 * t1669 + t1673);
  tv4rho2sigma25 = t7 * t1675 + 0.2e1 * t887;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t1682 = t889 * t868 * t440;
  t1689 = my_piecewise3(t1, 0, -0.64895402177010868827e-3 * t3 * t291 * t435 * t440 - 0.43263601451340579218e-3 * t1682 + 0.86527202902681158436e-3 * t890 * t873 - 0.43263601451340579218e-3 * t1646 + t1653 + 0.57684801935120772291e-3 * t1654);
  tv4rho2sigma26 = t7 * t1689 + t877 + t894;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t1696 = t896 * t868 * t449;
  t1701 = t883 * t901;
  t1704 = my_piecewise3(t60, 0, -0.64895402177010868827e-3 * t3 * t314 * t435 * t449 - 0.43263601451340579218e-3 * t1696 - 0.43263601451340579218e-3 * t1669 + t1673 + 0.86527202902681158436e-3 * t880 * t901 + 0.57684801935120772291e-3 * t1701);
  tv4rho2sigma211 = t7 * t1704 + t887 + t905;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t1713 = my_piecewise3(t1, 0, -0.64895402177010868827e-3 * t3 * t346 * t435 * t440 - 0.86527202902681158436e-3 * t1682 + t1653);
  tv4rho2sigma212 = t7 * t1713 + 0.2e1 * t894;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t1729 = my_piecewise3(t60, 0, -0.64895402177010868827e-3 * t3 * t362 * t435 * t449 - 0.86527202902681158436e-3 * t1696 + 0.17305440580536231687e-2 * t897 * t901 + t1673 + 0.11536960387024154458e-2 * t1701 - 0.20189680677292270302e-2 * t445 * t447 * t378 * t120);
  tv4rho2sigma217 = t7 * t1729 + 0.2e1 * t905;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t1734 = 0.64895402177010868827e-3 * t869 * t911;
  t1740 = my_piecewise3(t1, 0, 0.9734310326551630324e-3 * t865 * t911 + t1734 - 0.12979080435402173765e-2 * t436 * t909 * t115 * t120);
  tv4rhosigma30 = t7 * t1740 + t914;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t1745 = 0.64895402177010868827e-3 * t883 * t919;
  t1747 = my_piecewise3(t60, 0, 0.9734310326551630324e-3 * t880 * t919 + t1745);
  tv4rhosigma39 = t7 * t1747 + t922;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t1752 = my_piecewise3(t1, 0, 0.9734310326551630324e-3 * t890 * t911 + t1734);
  tv4rhosigma310 = t7 * t1752 + t914;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t1761 = my_piecewise3(t60, 0, 0.9734310326551630324e-3 * t897 * t919 + t1745 - 0.12979080435402173765e-2 * t445 * t917 * t170 * t120);
  tv4rhosigma319 = t7 * t1761 + t922;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t1770 = my_piecewise3(t1, 0, -0.2433577581637907581e-2 * t436 / t40 / t907 / sigma[0] * t43 * t120);
  tv4sigma40 = t7 * t1770;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t1778 = my_piecewise3(t60, 0, -0.2433577581637907581e-2 * t445 / t76 / t915 / sigma[2] * t79 * t120);
  tv4sigma414 = t7 * t1778;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

