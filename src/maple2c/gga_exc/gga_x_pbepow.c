/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_pbepow.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t38, t39, t40, t41, t42;
  double t44, t45, t48, t52, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t38 = 0.91464571985215458336e0 * t25 * t34 * t32 + 0.804e0;
  t39 = 0.1e1 / t38;
  t40 = t33 * t39;
  t41 = t26 * t40;
  t42 = pow(t41, 0.1e3);
  t44 = 0.13344141567995010044e-3 * t42 - 0.1e1;
  t45 = t33 * t44;
  t48 = 0.1e1 - 0.91464571985215458336e-2 * t26 * t45;
  t52 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t48);
  tzk0 = 0.2e1 * t52;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t38, t39, t40, t41, t42;
  double t44, t45, t48, t52, tzk0;

  double t54, t58, t60, t61, t62, t65, t66, t69;
  double t72, t73, t74, t75, t76, t78, t80, t81;
  double t82, t85, t86, t90, t95, tvrho0, t102, t106;
  double t109, t110, t114, t118, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t38 = 0.91464571985215458336e0 * t25 * t34 * t32 + 0.804e0;
  t39 = 0.1e1 / t38;
  t40 = t33 * t39;
  t41 = t26 * t40;
  t42 = pow(t41, 0.1e3);
  t44 = 0.13344141567995010044e-3 * t42 - 0.1e1;
  t45 = t33 * t44;
  t48 = 0.1e1 - 0.91464571985215458336e-2 * t26 * t45;
  t52 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t48);
  tzk0 = 0.2e1 * t52;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t54 = t17 / t30;
  t58 = t29 * rho[0];
  t60 = 0.1e1 / t30 / t58;
  t61 = t28 * t60;
  t62 = t61 * t44;
  t65 = pow(t41, 0.99e2);
  t66 = t61 * t39;
  t69 = t20 * t20;
  t72 = t69 / t22 / t21;
  t73 = sigma[0] * sigma[0];
  t74 = t72 * t73;
  t75 = t29 * t29;
  t76 = t75 * t29;
  t78 = 0.1e1 / t18 / t76;
  t80 = t38 * t38;
  t81 = 0.1e1 / t80;
  t82 = t27 * t78 * t81;
  t85 = -0.8e1 / 0.3e1 * t26 * t66 + 0.4878110505878157778e1 * t74 * t82;
  t86 = t65 * t85;
  t90 = 0.2439055252939078889e-1 * t26 * t62 - 0.12205161970267854748e-3 * t26 * t33 * t86;
  t95 = my_piecewise3(t2, 0, -t6 * t54 * t48 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t90);
  tvrho0 = 0.2e1 * rho[0] * t95 + 0.2e1 * t52;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t102 = t75 * rho[0];
  t106 = t27 / t18 / t102 * t81;
  t109 = t25 * t40 - 0.18292914397043091667e1 * t72 * sigma[0] * t106;
  t110 = t65 * t109;
  t114 = -0.91464571985215458336e-2 * t25 * t45 - 0.12205161970267854748e-3 * t26 * t33 * t110;
  t118 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t114);
  tvsigma0 = 0.2e1 * rho[0] * t118;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t38, t39, t40, t41, t42;
  double t44, t45, t48, t52, tzk0;

  double t54, t58, t60, t61, t62, t65, t66, t69;
  double t72, t73, t74, t75, t76, t78, t80, t81;
  double t82, t85, t86, t90, t95, tvrho0, t102, t106;
  double t109, t110, t114, t118, tvsigma0;

  double t123, t131, t132, t133, t139, t140, t141, t145;
  double t148, t150, t152, t155, t156, t157, t158, t161;
  double t164, t165, t169, t174, tv2rho20, t182, t183, t190;
  double t191, t192, t193, t198, t203, t204, t208, t209;
  double t213, t218, tv2rhosigma0, t224, t225, t231, t235, t236;
  double t240, t244, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t38 = 0.91464571985215458336e0 * t25 * t34 * t32 + 0.804e0;
  t39 = 0.1e1 / t38;
  t40 = t33 * t39;
  t41 = t26 * t40;
  t42 = pow(t41, 0.1e3);
  t44 = 0.13344141567995010044e-3 * t42 - 0.1e1;
  t45 = t33 * t44;
  t48 = 0.1e1 - 0.91464571985215458336e-2 * t26 * t45;
  t52 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t48);
  tzk0 = 0.2e1 * t52;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t54 = t17 / t30;
  t58 = t29 * rho[0];
  t60 = 0.1e1 / t30 / t58;
  t61 = t28 * t60;
  t62 = t61 * t44;
  t65 = pow(t41, 0.99e2);
  t66 = t61 * t39;
  t69 = t20 * t20;
  t72 = t69 / t22 / t21;
  t73 = sigma[0] * sigma[0];
  t74 = t72 * t73;
  t75 = t29 * t29;
  t76 = t75 * t29;
  t78 = 0.1e1 / t18 / t76;
  t80 = t38 * t38;
  t81 = 0.1e1 / t80;
  t82 = t27 * t78 * t81;
  t85 = -0.8e1 / 0.3e1 * t26 * t66 + 0.4878110505878157778e1 * t74 * t82;
  t86 = t65 * t85;
  t90 = 0.2439055252939078889e-1 * t26 * t62 - 0.12205161970267854748e-3 * t26 * t33 * t86;
  t95 = my_piecewise3(t2, 0, -t6 * t54 * t48 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t90);
  tvrho0 = 0.2e1 * rho[0] * t95 + 0.2e1 * t52;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t102 = t75 * rho[0];
  t106 = t27 / t18 / t102 * t81;
  t109 = t25 * t40 - 0.18292914397043091667e1 * t72 * sigma[0] * t106;
  t110 = t65 * t109;
  t114 = -0.91464571985215458336e-2 * t25 * t45 - 0.12205161970267854748e-3 * t26 * t33 * t110;
  t118 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t114);
  tvsigma0 = 0.2e1 * rho[0] * t118;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t123 = t17 / t30 / rho[0];
  t131 = 0.1e1 / t30 / t75;
  t132 = t28 * t131;
  t133 = t132 * t44;
  t139 = pow(t41, 0.98e2);
  t140 = t85 * t85;
  t141 = t139 * t140;
  t145 = t132 * t39;
  t148 = t75 * t58;
  t150 = 0.1e1 / t18 / t148;
  t152 = t27 * t150 * t81;
  t155 = t73 * sigma[0];
  t156 = t75 * t75;
  t157 = t156 * t29;
  t158 = 0.1e1 / t157;
  t161 = 0.1e1 / t80 / t38;
  t164 = 0.88e2 / 0.9e1 * t26 * t145 - 0.43902994552903420002e2 * t74 * t152 + 0.29314670967520808781e1 * t155 * t158 * t161;
  t165 = t65 * t164;
  t169 = -0.89432025941099559263e-1 * t26 * t133 + 0.65094197174761891991e-3 * t26 * t61 * t86 - 0.12083110350565176201e-1 * t26 * t33 * t141 - 0.12205161970267854748e-3 * t26 * t33 * t165;
  t174 = my_piecewise3(t2, 0, t6 * t123 * t48 / 0.12e2 - t6 * t54 * t90 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t169);
  tv2rho20 = 0.2e1 * rho[0] * t174 + 0.4e1 * t95;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t182 = t25 * t28;
  t183 = t32 * t65;
  t190 = t25 * t34;
  t191 = t32 * t139;
  t192 = t109 * t85;
  t193 = t191 * t192;
  t198 = t72 * t27;
  t203 = t156 * rho[0];
  t204 = 0.1e1 / t203;
  t208 = -0.8e1 / 0.3e1 * t25 * t66 + 0.14634331517634473334e2 * t198 * t78 * t81 * sigma[0] - 0.10993001612820303293e1 * t73 * t204 * t161;
  t209 = t65 * t208;
  t213 = 0.2439055252939078889e-1 * t25 * t62 - 0.12205161970267854748e-3 * t182 * t183 * t85 + 0.32547098587380945995e-3 * t26 * t61 * t110 - 0.12083110350565176201e-1 * t190 * t193 - 0.12205161970267854748e-3 * t26 * t33 * t209;
  t218 = my_piecewise3(t2, 0, -t6 * t54 * t114 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t213);
  tv2rhosigma0 = 0.2e1 * rho[0] * t218 + 0.2e1 * t118;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t224 = t109 * t109;
  t225 = t139 * t224;
  t231 = 0.1e1 / t156;
  t235 = -0.36585828794086183334e1 * t72 * t106 + 0.41223756048076137346e0 * sigma[0] * t231 * t161;
  t236 = t65 * t235;
  t240 = -0.24410323940535709496e-3 * t182 * t183 * t109 - 0.12083110350565176201e-1 * t26 * t33 * t225 - 0.12205161970267854748e-3 * t26 * t33 * t236;
  t244 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t240);
  tv2sigma20 = 0.2e1 * rho[0] * t244;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t38, t39, t40, t41, t42;
  double t44, t45, t48, t52, tzk0;

  double t54, t58, t60, t61, t62, t65, t66, t69;
  double t72, t73, t74, t75, t76, t78, t80, t81;
  double t82, t85, t86, t90, t95, tvrho0, t102, t106;
  double t109, t110, t114, t118, tvsigma0;

  double t123, t131, t132, t133, t139, t140, t141, t145;
  double t148, t150, t152, t155, t156, t157, t158, t161;
  double t164, t165, t169, t174, tv2rho20, t182, t183, t190;
  double t191, t192, t193, t198, t203, t204, t208, t209;
  double t213, t218, tv2rhosigma0, t224, t225, t231, t235, t236;
  double t240, t244, tv2sigma20;

  double t247, t259, t260, t272, t273, t274, t278, t279;
  double t282, t286, t291, t292, t296, t297, t299, t301;
  double t302, t306, t307, t311, t316, tv3rho30, t328, t341;
  double t342, t348, t349, t350, t353, t354, t357, t358;
  double t367, t370, t372, t377, t378, t382, t387, tv3rho2sigma0;
  double t404, t405, t408, t409, t415, t416, t421, t425;
  double t430, t431, t435, t440, tv3rhosigma20, t449, t450, t454;
  double t455, t461, t466, t467, t471, t475, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t38 = 0.91464571985215458336e0 * t25 * t34 * t32 + 0.804e0;
  t39 = 0.1e1 / t38;
  t40 = t33 * t39;
  t41 = t26 * t40;
  t42 = pow(t41, 0.1e3);
  t44 = 0.13344141567995010044e-3 * t42 - 0.1e1;
  t45 = t33 * t44;
  t48 = 0.1e1 - 0.91464571985215458336e-2 * t26 * t45;
  t52 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t48);
  tzk0 = 0.2e1 * t52;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t54 = t17 / t30;
  t58 = t29 * rho[0];
  t60 = 0.1e1 / t30 / t58;
  t61 = t28 * t60;
  t62 = t61 * t44;
  t65 = pow(t41, 0.99e2);
  t66 = t61 * t39;
  t69 = t20 * t20;
  t72 = t69 / t22 / t21;
  t73 = sigma[0] * sigma[0];
  t74 = t72 * t73;
  t75 = t29 * t29;
  t76 = t75 * t29;
  t78 = 0.1e1 / t18 / t76;
  t80 = t38 * t38;
  t81 = 0.1e1 / t80;
  t82 = t27 * t78 * t81;
  t85 = -0.8e1 / 0.3e1 * t26 * t66 + 0.4878110505878157778e1 * t74 * t82;
  t86 = t65 * t85;
  t90 = 0.2439055252939078889e-1 * t26 * t62 - 0.12205161970267854748e-3 * t26 * t33 * t86;
  t95 = my_piecewise3(t2, 0, -t6 * t54 * t48 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t90);
  tvrho0 = 0.2e1 * rho[0] * t95 + 0.2e1 * t52;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t102 = t75 * rho[0];
  t106 = t27 / t18 / t102 * t81;
  t109 = t25 * t40 - 0.18292914397043091667e1 * t72 * sigma[0] * t106;
  t110 = t65 * t109;
  t114 = -0.91464571985215458336e-2 * t25 * t45 - 0.12205161970267854748e-3 * t26 * t33 * t110;
  t118 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t114);
  tvsigma0 = 0.2e1 * rho[0] * t118;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t123 = t17 / t30 / rho[0];
  t131 = 0.1e1 / t30 / t75;
  t132 = t28 * t131;
  t133 = t132 * t44;
  t139 = pow(t41, 0.98e2);
  t140 = t85 * t85;
  t141 = t139 * t140;
  t145 = t132 * t39;
  t148 = t75 * t58;
  t150 = 0.1e1 / t18 / t148;
  t152 = t27 * t150 * t81;
  t155 = t73 * sigma[0];
  t156 = t75 * t75;
  t157 = t156 * t29;
  t158 = 0.1e1 / t157;
  t161 = 0.1e1 / t80 / t38;
  t164 = 0.88e2 / 0.9e1 * t26 * t145 - 0.43902994552903420002e2 * t74 * t152 + 0.29314670967520808781e1 * t155 * t158 * t161;
  t165 = t65 * t164;
  t169 = -0.89432025941099559263e-1 * t26 * t133 + 0.65094197174761891991e-3 * t26 * t61 * t86 - 0.12083110350565176201e-1 * t26 * t33 * t141 - 0.12205161970267854748e-3 * t26 * t33 * t165;
  t174 = my_piecewise3(t2, 0, t6 * t123 * t48 / 0.12e2 - t6 * t54 * t90 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t169);
  tv2rho20 = 0.2e1 * rho[0] * t174 + 0.4e1 * t95;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t182 = t25 * t28;
  t183 = t32 * t65;
  t190 = t25 * t34;
  t191 = t32 * t139;
  t192 = t109 * t85;
  t193 = t191 * t192;
  t198 = t72 * t27;
  t203 = t156 * rho[0];
  t204 = 0.1e1 / t203;
  t208 = -0.8e1 / 0.3e1 * t25 * t66 + 0.14634331517634473334e2 * t198 * t78 * t81 * sigma[0] - 0.10993001612820303293e1 * t73 * t204 * t161;
  t209 = t65 * t208;
  t213 = 0.2439055252939078889e-1 * t25 * t62 - 0.12205161970267854748e-3 * t182 * t183 * t85 + 0.32547098587380945995e-3 * t26 * t61 * t110 - 0.12083110350565176201e-1 * t190 * t193 - 0.12205161970267854748e-3 * t26 * t33 * t209;
  t218 = my_piecewise3(t2, 0, -t6 * t54 * t114 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t213);
  tv2rhosigma0 = 0.2e1 * rho[0] * t218 + 0.2e1 * t118;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t224 = t109 * t109;
  t225 = t139 * t224;
  t231 = 0.1e1 / t156;
  t235 = -0.36585828794086183334e1 * t72 * t106 + 0.41223756048076137346e0 * sigma[0] * t231 * t161;
  t236 = t65 * t235;
  t240 = -0.24410323940535709496e-3 * t182 * t183 * t109 - 0.12083110350565176201e-1 * t26 * t33 * t225 - 0.12205161970267854748e-3 * t26 * t33 * t236;
  t244 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t240);
  tv2sigma20 = 0.2e1 * rho[0] * t244;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t247 = t17 * t32;
  t259 = t28 / t30 / t102;
  t260 = t259 * t44;
  t272 = pow(t41, 0.97e2);
  t273 = t140 * t85;
  t274 = t272 * t273;
  t278 = t85 * t164;
  t279 = t191 * t278;
  t282 = t259 * t39;
  t286 = 0.1e1 / t18 / t156;
  t291 = t156 * t58;
  t292 = 0.1e1 / t291;
  t296 = t73 * t73;
  t297 = t156 * t102;
  t299 = 0.1e1 / t30 / t297;
  t301 = t80 * t80;
  t302 = 0.1e1 / t301;
  t306 = -0.1232e4 / 0.27e2 * t26 * t282 + 0.36965237388987817829e3 * t74 * t27 * t286 * t81 - 0.55697874838289536684e2 * t155 * t292 * t161 + 0.21450030663453701616e2 * t296 * t299 * t302 * t182;
  t307 = t65 * t306;
  t311 = 0.41734945439179794323e0 * t26 * t260 - 0.35801808446119040595e-2 * t26 * t132 * t86 + 0.96664882804521409607e-1 * t26 * t61 * t141 + 0.97641295762142837986e-3 * t26 * t61 * t165 - 0.11841448143553872677e1 * t26 * t33 * t274 - 0.36249331051695528603e-1 * t190 * t279 - 0.12205161970267854748e-3 * t26 * t33 * t307;
  t316 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t247 * t48 + t6 * t123 * t90 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t54 * t169 - 0.3e1 / 0.8e1 * t6 * t19 * t311);
  tv3rho30 = 0.2e1 * rho[0] * t316 + 0.6e1 * t174;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t328 = t60 * t65;
  t341 = t60 * t139;
  t342 = t341 * t192;
  t348 = t32 * t272;
  t349 = t109 * t140;
  t350 = t348 * t349;
  t353 = t208 * t85;
  t354 = t191 * t353;
  t357 = t109 * t164;
  t358 = t191 * t357;
  t367 = t158 * t161;
  t370 = t156 * t75;
  t372 = 0.1e1 / t30 / t370;
  t377 = 0.88e2 / 0.9e1 * t25 * t145 - 0.10569239429402675186e3 * t198 * t150 * t81 * sigma[0] + 0.18688102741794515598e2 * t367 * t73 - 0.80437614987951381061e1 * t155 * t372 * t302 * t182;
  t378 = t65 * t377;
  t382 = -0.89432025941099559263e-1 * t25 * t133 + 0.65094197174761891991e-3 * t182 * t328 * t85 - 0.12083110350565176201e-1 * t182 * t191 * t140 - 0.12205161970267854748e-3 * t182 * t183 * t164 - 0.11933936148706346865e-2 * t26 * t132 * t110 + 0.64443255203014273071e-1 * t190 * t342 + 0.6509419717476189199e-3 * t26 * t61 * t209 - 0.11841448143553872677e1 * t190 * t350 - 0.24166220701130352402e-1 * t190 * t354 - 0.12083110350565176201e-1 * t190 * t358 - 0.12205161970267854748e-3 * t26 * t33 * t378;
  t387 = my_piecewise3(t2, 0, t6 * t123 * t114 / 0.12e2 - t6 * t54 * t213 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t382);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t387 + 0.4e1 * t218;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t404 = t224 * t85;
  t405 = t348 * t404;
  t408 = t109 * t208;
  t409 = t191 * t408;
  t415 = t235 * t85;
  t416 = t191 * t415;
  t421 = t204 * t161;
  t425 = 0.1e1 / t30 / t291;
  t430 = 0.19512442023512631111e2 * t72 * t82 - 0.54965008064101516462e1 * t421 * sigma[0] + 0.30164105620481767896e1 * t73 * t425 * t302 * t182;
  t431 = t65 * t430;
  t435 = 0.65094197174761891989e-3 * t182 * t328 * t109 - 0.24166220701130352401e-1 * t182 * t193 - 0.24410323940535709496e-3 * t182 * t183 * t208 + 0.32221627601507136536e-1 * t26 * t61 * t225 - 0.11841448143553872677e1 * t190 * t405 - 0.24166220701130352402e-1 * t190 * t409 + 0.32547098587380945995e-3 * t26 * t61 * t236 - 0.12083110350565176201e-1 * t190 * t416 - 0.12205161970267854748e-3 * t26 * t33 * t431;
  t440 = my_piecewise3(t2, 0, -t6 * t54 * t240 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t435);
  tv3rhosigma20 = 0.2e1 * rho[0] * t440 + 0.2e1 * t244;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t449 = t224 * t109;
  t450 = t272 * t449;
  t454 = t109 * t235;
  t455 = t191 * t454;
  t461 = 0.1e1 / t30 / t157;
  t466 = 0.12367126814422841204e1 * t231 * t161 - 0.11311539607680662961e1 * sigma[0] * t461 * t302 * t182;
  t467 = t65 * t466;
  t471 = -0.36249331051695528602e-1 * t182 * t191 * t224 - 0.36615485910803564244e-3 * t182 * t183 * t235 - 0.11841448143553872677e1 * t26 * t33 * t450 - 0.36249331051695528603e-1 * t190 * t455 - 0.12205161970267854748e-3 * t26 * t33 * t467;
  t475 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t471);
  tv3sigma30 = 0.2e1 * rho[0] * t475;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t32, t33, t34, t38, t39, t40, t41, t42;
  double t44, t45, t48, t52, tzk0;

  double t54, t58, t60, t61, t62, t65, t66, t69;
  double t72, t73, t74, t75, t76, t78, t80, t81;
  double t82, t85, t86, t90, t95, tvrho0, t102, t106;
  double t109, t110, t114, t118, tvsigma0;

  double t123, t131, t132, t133, t139, t140, t141, t145;
  double t148, t150, t152, t155, t156, t157, t158, t161;
  double t164, t165, t169, t174, tv2rho20, t182, t183, t190;
  double t191, t192, t193, t198, t203, t204, t208, t209;
  double t213, t218, tv2rhosigma0, t224, t225, t231, t235, t236;
  double t240, t244, tv2sigma20;

  double t247, t259, t260, t272, t273, t274, t278, t279;
  double t282, t286, t291, t292, t296, t297, t299, t301;
  double t302, t306, t307, t311, t316, tv3rho30, t328, t341;
  double t342, t348, t349, t350, t353, t354, t357, t358;
  double t367, t370, t372, t377, t378, t382, t387, tv3rho2sigma0;
  double t404, t405, t408, t409, t415, t416, t421, t425;
  double t430, t431, t435, t440, tv3rhosigma20, t449, t450, t454;
  double t455, t461, t466, t467, t471, t475, tv3sigma30;

  double t493, t515, t516, t525, t547, t555, t561, t570;
  double t575, tv4rho40, t658, t668, t672, t681, t687, tv4rho3sigma0;
  double t724, t739, t786, t792, tv4rho2sigma20, t864, t869, tv4rhosigma30;
  double t880, t889, t916, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = t25 * sigma[0];
  t27 = M_CBRT2;
  t28 = t27 * t27;
  t29 = rho[0] * rho[0];
  t30 = t18 * t18;
  t32 = 0.1e1 / t30 / t29;
  t33 = t28 * t32;
  t34 = sigma[0] * t28;
  t38 = 0.91464571985215458336e0 * t25 * t34 * t32 + 0.804e0;
  t39 = 0.1e1 / t38;
  t40 = t33 * t39;
  t41 = t26 * t40;
  t42 = pow(t41, 0.1e3);
  t44 = 0.13344141567995010044e-3 * t42 - 0.1e1;
  t45 = t33 * t44;
  t48 = 0.1e1 - 0.91464571985215458336e-2 * t26 * t45;
  t52 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t48);
  tzk0 = 0.2e1 * t52;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t54 = t17 / t30;
  t58 = t29 * rho[0];
  t60 = 0.1e1 / t30 / t58;
  t61 = t28 * t60;
  t62 = t61 * t44;
  t65 = pow(t41, 0.99e2);
  t66 = t61 * t39;
  t69 = t20 * t20;
  t72 = t69 / t22 / t21;
  t73 = sigma[0] * sigma[0];
  t74 = t72 * t73;
  t75 = t29 * t29;
  t76 = t75 * t29;
  t78 = 0.1e1 / t18 / t76;
  t80 = t38 * t38;
  t81 = 0.1e1 / t80;
  t82 = t27 * t78 * t81;
  t85 = -0.8e1 / 0.3e1 * t26 * t66 + 0.4878110505878157778e1 * t74 * t82;
  t86 = t65 * t85;
  t90 = 0.2439055252939078889e-1 * t26 * t62 - 0.12205161970267854748e-3 * t26 * t33 * t86;
  t95 = my_piecewise3(t2, 0, -t6 * t54 * t48 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t90);
  tvrho0 = 0.2e1 * rho[0] * t95 + 0.2e1 * t52;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t102 = t75 * rho[0];
  t106 = t27 / t18 / t102 * t81;
  t109 = t25 * t40 - 0.18292914397043091667e1 * t72 * sigma[0] * t106;
  t110 = t65 * t109;
  t114 = -0.91464571985215458336e-2 * t25 * t45 - 0.12205161970267854748e-3 * t26 * t33 * t110;
  t118 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t114);
  tvsigma0 = 0.2e1 * rho[0] * t118;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t123 = t17 / t30 / rho[0];
  t131 = 0.1e1 / t30 / t75;
  t132 = t28 * t131;
  t133 = t132 * t44;
  t139 = pow(t41, 0.98e2);
  t140 = t85 * t85;
  t141 = t139 * t140;
  t145 = t132 * t39;
  t148 = t75 * t58;
  t150 = 0.1e1 / t18 / t148;
  t152 = t27 * t150 * t81;
  t155 = t73 * sigma[0];
  t156 = t75 * t75;
  t157 = t156 * t29;
  t158 = 0.1e1 / t157;
  t161 = 0.1e1 / t80 / t38;
  t164 = 0.88e2 / 0.9e1 * t26 * t145 - 0.43902994552903420002e2 * t74 * t152 + 0.29314670967520808781e1 * t155 * t158 * t161;
  t165 = t65 * t164;
  t169 = -0.89432025941099559263e-1 * t26 * t133 + 0.65094197174761891991e-3 * t26 * t61 * t86 - 0.12083110350565176201e-1 * t26 * t33 * t141 - 0.12205161970267854748e-3 * t26 * t33 * t165;
  t174 = my_piecewise3(t2, 0, t6 * t123 * t48 / 0.12e2 - t6 * t54 * t90 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t169);
  tv2rho20 = 0.2e1 * rho[0] * t174 + 0.4e1 * t95;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t182 = t25 * t28;
  t183 = t32 * t65;
  t190 = t25 * t34;
  t191 = t32 * t139;
  t192 = t109 * t85;
  t193 = t191 * t192;
  t198 = t72 * t27;
  t203 = t156 * rho[0];
  t204 = 0.1e1 / t203;
  t208 = -0.8e1 / 0.3e1 * t25 * t66 + 0.14634331517634473334e2 * t198 * t78 * t81 * sigma[0] - 0.10993001612820303293e1 * t73 * t204 * t161;
  t209 = t65 * t208;
  t213 = 0.2439055252939078889e-1 * t25 * t62 - 0.12205161970267854748e-3 * t182 * t183 * t85 + 0.32547098587380945995e-3 * t26 * t61 * t110 - 0.12083110350565176201e-1 * t190 * t193 - 0.12205161970267854748e-3 * t26 * t33 * t209;
  t218 = my_piecewise3(t2, 0, -t6 * t54 * t114 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t213);
  tv2rhosigma0 = 0.2e1 * rho[0] * t218 + 0.2e1 * t118;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t224 = t109 * t109;
  t225 = t139 * t224;
  t231 = 0.1e1 / t156;
  t235 = -0.36585828794086183334e1 * t72 * t106 + 0.41223756048076137346e0 * sigma[0] * t231 * t161;
  t236 = t65 * t235;
  t240 = -0.24410323940535709496e-3 * t182 * t183 * t109 - 0.12083110350565176201e-1 * t26 * t33 * t225 - 0.12205161970267854748e-3 * t26 * t33 * t236;
  t244 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t240);
  tv2sigma20 = 0.2e1 * rho[0] * t244;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t247 = t17 * t32;
  t259 = t28 / t30 / t102;
  t260 = t259 * t44;
  t272 = pow(t41, 0.97e2);
  t273 = t140 * t85;
  t274 = t272 * t273;
  t278 = t85 * t164;
  t279 = t191 * t278;
  t282 = t259 * t39;
  t286 = 0.1e1 / t18 / t156;
  t291 = t156 * t58;
  t292 = 0.1e1 / t291;
  t296 = t73 * t73;
  t297 = t156 * t102;
  t299 = 0.1e1 / t30 / t297;
  t301 = t80 * t80;
  t302 = 0.1e1 / t301;
  t306 = -0.1232e4 / 0.27e2 * t26 * t282 + 0.36965237388987817829e3 * t74 * t27 * t286 * t81 - 0.55697874838289536684e2 * t155 * t292 * t161 + 0.21450030663453701616e2 * t296 * t299 * t302 * t182;
  t307 = t65 * t306;
  t311 = 0.41734945439179794323e0 * t26 * t260 - 0.35801808446119040595e-2 * t26 * t132 * t86 + 0.96664882804521409607e-1 * t26 * t61 * t141 + 0.97641295762142837986e-3 * t26 * t61 * t165 - 0.11841448143553872677e1 * t26 * t33 * t274 - 0.36249331051695528603e-1 * t190 * t279 - 0.12205161970267854748e-3 * t26 * t33 * t307;
  t316 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t247 * t48 + t6 * t123 * t90 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t54 * t169 - 0.3e1 / 0.8e1 * t6 * t19 * t311);
  tv3rho30 = 0.2e1 * rho[0] * t316 + 0.6e1 * t174;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t328 = t60 * t65;
  t341 = t60 * t139;
  t342 = t341 * t192;
  t348 = t32 * t272;
  t349 = t109 * t140;
  t350 = t348 * t349;
  t353 = t208 * t85;
  t354 = t191 * t353;
  t357 = t109 * t164;
  t358 = t191 * t357;
  t367 = t158 * t161;
  t370 = t156 * t75;
  t372 = 0.1e1 / t30 / t370;
  t377 = 0.88e2 / 0.9e1 * t25 * t145 - 0.10569239429402675186e3 * t198 * t150 * t81 * sigma[0] + 0.18688102741794515598e2 * t367 * t73 - 0.80437614987951381061e1 * t155 * t372 * t302 * t182;
  t378 = t65 * t377;
  t382 = -0.89432025941099559263e-1 * t25 * t133 + 0.65094197174761891991e-3 * t182 * t328 * t85 - 0.12083110350565176201e-1 * t182 * t191 * t140 - 0.12205161970267854748e-3 * t182 * t183 * t164 - 0.11933936148706346865e-2 * t26 * t132 * t110 + 0.64443255203014273071e-1 * t190 * t342 + 0.6509419717476189199e-3 * t26 * t61 * t209 - 0.11841448143553872677e1 * t190 * t350 - 0.24166220701130352402e-1 * t190 * t354 - 0.12083110350565176201e-1 * t190 * t358 - 0.12205161970267854748e-3 * t26 * t33 * t378;
  t387 = my_piecewise3(t2, 0, t6 * t123 * t114 / 0.12e2 - t6 * t54 * t213 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t382);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t387 + 0.4e1 * t218;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t404 = t224 * t85;
  t405 = t348 * t404;
  t408 = t109 * t208;
  t409 = t191 * t408;
  t415 = t235 * t85;
  t416 = t191 * t415;
  t421 = t204 * t161;
  t425 = 0.1e1 / t30 / t291;
  t430 = 0.19512442023512631111e2 * t72 * t82 - 0.54965008064101516462e1 * t421 * sigma[0] + 0.30164105620481767896e1 * t73 * t425 * t302 * t182;
  t431 = t65 * t430;
  t435 = 0.65094197174761891989e-3 * t182 * t328 * t109 - 0.24166220701130352401e-1 * t182 * t193 - 0.24410323940535709496e-3 * t182 * t183 * t208 + 0.32221627601507136536e-1 * t26 * t61 * t225 - 0.11841448143553872677e1 * t190 * t405 - 0.24166220701130352402e-1 * t190 * t409 + 0.32547098587380945995e-3 * t26 * t61 * t236 - 0.12083110350565176201e-1 * t190 * t416 - 0.12205161970267854748e-3 * t26 * t33 * t431;
  t440 = my_piecewise3(t2, 0, -t6 * t54 * t240 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t435);
  tv3rhosigma20 = 0.2e1 * rho[0] * t440 + 0.2e1 * t244;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t449 = t224 * t109;
  t450 = t272 * t449;
  t454 = t109 * t235;
  t455 = t191 * t454;
  t461 = 0.1e1 / t30 / t157;
  t466 = 0.12367126814422841204e1 * t231 * t161 - 0.11311539607680662961e1 * sigma[0] * t461 * t302 * t182;
  t467 = t65 * t466;
  t471 = -0.36249331051695528602e-1 * t182 * t191 * t224 - 0.36615485910803564244e-3 * t182 * t183 * t235 - 0.11841448143553872677e1 * t26 * t33 * t450 - 0.36249331051695528603e-1 * t190 * t455 - 0.12205161970267854748e-3 * t26 * t33 * t467;
  t475 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t471);
  tv3sigma30 = 0.2e1 * rho[0] * t475;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t493 = t28 / t30 / t76;
  t515 = pow(t41, 0.96e2);
  t516 = t140 * t140;
  t525 = t164 * t164;
  t547 = t156 * t76;
  t555 = t156 * t156;
  t561 = 0.1e1 / t301 / t38;
  t570 = -0.23649802415535216783e1 * t26 * t493 * t44 + 0.22276680810918514148e-1 * t26 * t259 * t86 - 0.70887580723315700378e0 * t26 * t132 * t141 - 0.7160361689223808119e-2 * t26 * t132 * t165 + 0.12630878019790797522e2 * t26 * t61 * t274 + 0.38665953121808563843e0 * t190 * t341 * t278 + 0.13018839434952378398e-2 * t26 * t61 * t307 - 0.11486204699247256497e3 * t26 * t33 * t515 * t516 - 0.71048688861323236062e1 * t190 * t348 * t140 * t164 - 0.36249331051695528603e-1 * t26 * t33 * t139 * t525 - 0.48332441402260704804e-1 * t190 * t191 * t85 * t306 - 0.12205161970267854748e-3 * t26 * t33 * t65 * (0.20944e5 / 0.81e2 * t26 * t493 * t39 - 0.33030228247579437221e4 * t74 * t27 / t18 / t203 * t81 + 0.83481668544173147673e3 * t155 / t370 * t161 - 0.70070100167282091946e3 * t296 / t30 / t547 * t302 * t182 + 0.4185424797232085308e3 * t296 * sigma[0] / t18 / t555 / rho[0] * t561 * t198);
  t575 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t60 * t48 - 0.5e1 / 0.9e1 * t6 * t247 * t90 + t6 * t123 * t169 / 0.2e1 - t6 * t54 * t311 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * t570);
  tv4rho40 = 0.2e1 * rho[0] * t575 + 0.8e1 * t316;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t658 = t131 * t65;
  t668 = t60 * t272;
  t672 = t32 * t515;
  t681 = 0.19332976560904281921e0 * t190 * t341 * t353 + 0.96664882804521409607e-1 * t190 * t341 * t357 + 0.5569170202729628537e-2 * t26 * t259 * t110 - 0.35443790361657850189e0 * t190 * t131 * t139 * t192 + 0.41734945439179794323e0 * t25 * t260 - 0.35801808446119040595e-2 * t182 * t658 * t85 + 0.97641295762142837986e-3 * t182 * t328 * t164 - 0.12205161970267854748e-3 * t182 * t183 * t306 + 0.94731585148430981415e1 * t190 * t668 * t349 - 0.11486204699247256497e3 * t190 * t672 * t109 * t273 - 0.35524344430661618031e1 * t190 * t348 * t192 * t164;
  t687 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t247 * t114 + t6 * t123 * t213 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t54 * t382 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.36249331051695528603e-1 * t190 * t191 * t208 * t164 - 0.12083110350565176201e-1 * t190 * t191 * t109 * t306 - 0.12205161970267854748e-3 * t26 * t33 * t65 * (-0.1232e4 / 0.27e2 * t25 * t282 + 0.82277463865811594525e3 * t198 * t286 * t81 * sigma[0] - 0.25039614784757357501e3 * t292 * t161 * t73 + 0.23863159113092243048e3 * t299 * t302 * t155 * t182 - 0.15695342989620319905e3 * t296 / t18 / t555 * t561 * t198) + 0.97641295762142837985e-3 * t26 * t61 * t378 - 0.35801808446119040595e-2 * t26 * t132 * t209 - 0.11841448143553872677e1 * t182 * t348 * t273 - 0.36249331051695528603e-1 * t182 * t279 + 0.96664882804521409607e-1 * t182 * t341 * t140 - 0.35524344430661618031e1 * t190 * t348 * t208 * t140 - 0.36249331051695528603e-1 * t190 * t191 * t377 * t85 + t681));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t687 + 0.6e1 * t387;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t724 = t208 * t208;
  t739 = -0.11486204699247256497e3 * t190 * t672 * t224 * t140 - 0.47365792574215490708e1 * t190 * t348 * t192 * t208 - 0.11841448143553872677e1 * t190 * t348 * t235 * t140 + 0.64443255203014273071e-1 * t190 * t341 * t415 - 0.24166220701130352402e-1 * t190 * t191 * t430 * t85 - 0.12083110350565176201e-1 * t190 * t191 * t235 * t164 - 0.11841448143553872677e1 * t190 * t348 * t224 * t164 - 0.24166220701130352402e-1 * t26 * t33 * t139 * t724 - 0.24166220701130352402e-1 * t190 * t191 * t109 * t377 - 0.11933936148706346865e-2 * t26 * t132 * t236 - 0.11814596787219283397e0 * t26 * t132 * t225;
  t786 = 0.6315439009895398761e1 * t190 * t668 * t404 + 0.12888651040602854614e0 * t190 * t341 * t408 - 0.23682896287107745353e1 * t182 * t350 - 0.12205161970267854748e-3 * t26 * t33 * t65 * (-0.1235787994822466637e3 * t72 * t152 + 0.61194375644699688328e2 * t367 * sigma[0] - 0.7541026405120441974e2 * t372 * t302 * t73 * t182 + 0.58857536211076199641e2 * t155 / t18 / t156 / t148 * t561 * t198) + 0.6509419717476189199e-3 * t26 * t61 * t431 - 0.48332441402260704802e-1 * t182 * t354 - 0.24166220701130352401e-1 * t182 * t358 - 0.23867872297412693729e-2 * t182 * t658 * t109 + 0.12888651040602854614e0 * t182 * t342 - 0.24410323940535709496e-3 * t182 * t183 * t377 + 0.13018839434952378398e-2 * t182 * t328 * t208;
  t792 = my_piecewise3(t2, 0, t6 * t123 * t240 / 0.12e2 - t6 * t54 * t435 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t739 + t786));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t792 + 0.4e1 * t440;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t864 = 0.96664882804521409605e-1 * t182 * t341 * t224 - 0.3552434443066161803e1 * t182 * t405 - 0.72498662103391057204e-1 * t182 * t409 + 0.97641295762142837984e-3 * t182 * t328 * t235 - 0.36249331051695528602e-1 * t182 * t416 - 0.36615485910803564244e-3 * t182 * t183 * t430 + 0.31577195049476993805e1 * t26 * t61 * t450 - 0.11486204699247256497e3 * t190 * t672 * t449 * t85 - 0.35524344430661618031e1 * t190 * t348 * t224 * t208 + 0.96664882804521409608e-1 * t190 * t341 * t454 - 0.35524344430661618031e1 * t190 * t348 * t454 * t85 - 0.36249331051695528603e-1 * t190 * t191 * t208 * t235 - 0.36249331051695528603e-1 * t190 * t191 * t109 * t430 + 0.32547098587380945995e-3 * t26 * t61 * t467 - 0.12083110350565176201e-1 * t190 * t191 * t466 * t85 - 0.12205161970267854748e-3 * t26 * t33 * t65 * (-0.98937014515382729632e1 * t421 + 0.21114873934337237527e2 * t425 * t302 * t20 * t24 * sigma[0] * t28 - 0.22071576079153574865e2 * t73 / t18 / t547 * t561 * t198);
  t869 = my_piecewise3(t2, 0, -t6 * t54 * t471 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t864);
  tv4rhosigma30 = 0.2e1 * rho[0] * t869 + 0.2e1 * t475;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t880 = t224 * t224;
  t889 = t235 * t235;
  t916 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (-0.47365792574215490707e1 * t182 * t348 * t449 - 0.14499732420678211441e0 * t182 * t455 - 0.48820647881071418992e-3 * t182 * t183 * t466 - 0.11486204699247256497e3 * t26 * t33 * t515 * t880 - 0.71048688861323236062e1 * t190 * t348 * t224 * t235 - 0.36249331051695528603e-1 * t26 * t33 * t139 * t889 - 0.48332441402260704804e-1 * t190 * t191 * t109 * t466 - 0.12205161970267854748e-3 * t26 * t33 * t65 * (-0.45246158430722651844e1 * t461 * t302 * t182 + 0.82768410296825905742e1 * sigma[0] / t18 / t297 * t561 * t198)));
  tv4sigma40 = 0.2e1 * rho[0] * t916;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t39;
  double t40, t42, t43, t45, t46, t48, t52, t56;
  double t57, t58, t59, t60, t61, t63, t64, t65;
  double t66, t67, t69, t70, t71, t73, t74, t76;
  double t77, t79, t83, t87, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = 0.91464571985215458336e0 * t40 + 0.804e0;
  t43 = 0.1e1 / t42;
  t45 = t33 * t39 * t43;
  t46 = pow(t45, 0.1e3);
  t48 = 0.13344141567995010044e-3 * t46 - 0.1e1;
  t52 = 0.1e1 - 0.91464571985215458336e-2 * t33 * t39 * t48;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t14, t11, t10, t15, -t17);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t63 = my_piecewise3(t60, t22, t61 * t59);
  t64 = t63 * t26;
  t65 = rho[1] * rho[1];
  t66 = POW_1_3(rho[1]);
  t67 = t66 * t66;
  t69 = 0.1e1 / t67 / t65;
  t70 = sigma[2] * t69;
  t71 = t33 * t70;
  t73 = 0.91464571985215458336e0 * t71 + 0.804e0;
  t74 = 0.1e1 / t73;
  t76 = t33 * t70 * t74;
  t77 = pow(t76, 0.1e3);
  t79 = 0.13344141567995010044e-3 * t77 - 0.1e1;
  t83 = 0.1e1 - 0.91464571985215458336e-2 * t33 * t70 * t79;
  t87 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t83);
  tzk0 = t56 + t87;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t39;
  double t40, t42, t43, t45, t46, t48, t52, t56;
  double t57, t58, t59, t60, t61, t63, t64, t65;
  double t66, t67, t69, t70, t71, t73, t74, t76;
  double t77, t79, t83, t87, tzk0;

  double t88, t89, t90, t91, t92, t95, t96, t100;
  double t101, t102, t105, t106, t108, t109, t113, t114;
  double t115, t119, t121, t122, t123, t124, t125, t127;
  double t129, t130, t134, t135, t138, t143, t145, t148;
  double t149, t153, t156, t158, tvrho0, t161, t162, t165;
  double t166, t171, t173, t176, t177, t181, t183, t184;
  double t188, t189, t190, t194, t195, t196, t198, t200;
  double t201, t205, t206, t209, t214, tvrho1, t222, t224;
  double t229, t230, t233, t237, tvsigma0, tvsigma1, t243, t245;
  double t250, t251, t254, t258, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = 0.91464571985215458336e0 * t40 + 0.804e0;
  t43 = 0.1e1 / t42;
  t45 = t33 * t39 * t43;
  t46 = pow(t45, 0.1e3);
  t48 = 0.13344141567995010044e-3 * t46 - 0.1e1;
  t52 = 0.1e1 - 0.91464571985215458336e-2 * t33 * t39 * t48;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t14, t11, t10, t15, -t17);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t63 = my_piecewise3(t60, t22, t61 * t59);
  t64 = t63 * t26;
  t65 = rho[1] * rho[1];
  t66 = POW_1_3(rho[1]);
  t67 = t66 * t66;
  t69 = 0.1e1 / t67 / t65;
  t70 = sigma[2] * t69;
  t71 = t33 * t70;
  t73 = 0.91464571985215458336e0 * t71 + 0.804e0;
  t74 = 0.1e1 / t73;
  t76 = t33 * t70 * t74;
  t77 = pow(t76, 0.1e3);
  t79 = 0.13344141567995010044e-3 * t77 - 0.1e1;
  t83 = 0.1e1 - 0.91464571985215458336e-2 * t33 * t70 * t79;
  t87 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t83);
  tzk0 = t56 + t87;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t88 = t6 * t6;
  t89 = 0.1e1 / t88;
  t90 = t16 * t89;
  t91 = t7 - t90;
  t92 = my_piecewise5(t10, 0, t14, 0, t91);
  t95 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t92);
  t96 = t95 * t26;
  t100 = t26 * t26;
  t101 = 0.1e1 / t100;
  t102 = t25 * t101;
  t105 = t5 * t102 * t52 / 0.8e1;
  t106 = t34 * rho[0];
  t108 = 0.1e1 / t36 / t106;
  t109 = sigma[0] * t108;
  t113 = t33 * sigma[0];
  t114 = pow(t45, 0.99e2);
  t115 = t38 * t114;
  t119 = t28 * t28;
  t121 = 0.1e1 / t30 / t29;
  t122 = t119 * t121;
  t123 = sigma[0] * sigma[0];
  t124 = t34 * t34;
  t125 = t124 * t34;
  t127 = 0.1e1 / t35 / t125;
  t129 = t42 * t42;
  t130 = 0.1e1 / t129;
  t134 = -0.8e1 / 0.3e1 * t33 * t109 * t43 + 0.2439055252939078889e1 * t122 * t123 * t127 * t130;
  t135 = t115 * t134;
  t138 = 0.2439055252939078889e-1 * t33 * t109 * t48 - 0.12205161970267854748e-3 * t113 * t135;
  t143 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t52 - t105 - 0.3e1 / 0.8e1 * t5 * t27 * t138);
  t145 = my_piecewise5(t14, 0, t10, 0, -t91);
  t148 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t145);
  t149 = t148 * t26;
  t153 = t63 * t101;
  t156 = t5 * t153 * t83 / 0.8e1;
  t158 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t83 - t156);
  tvrho0 = t56 + t87 + t6 * (t143 + t158);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t161 = -t7 - t90;
  t162 = my_piecewise5(t10, 0, t14, 0, t161);
  t165 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t162);
  t166 = t165 * t26;
  t171 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t52 - t105);
  t173 = my_piecewise5(t14, 0, t10, 0, -t161);
  t176 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t173);
  t177 = t176 * t26;
  t181 = t65 * rho[1];
  t183 = 0.1e1 / t67 / t181;
  t184 = sigma[2] * t183;
  t188 = t33 * sigma[2];
  t189 = pow(t76, 0.99e2);
  t190 = t69 * t189;
  t194 = sigma[2] * sigma[2];
  t195 = t65 * t65;
  t196 = t195 * t65;
  t198 = 0.1e1 / t66 / t196;
  t200 = t73 * t73;
  t201 = 0.1e1 / t200;
  t205 = -0.8e1 / 0.3e1 * t33 * t184 * t74 + 0.2439055252939078889e1 * t122 * t194 * t198 * t201;
  t206 = t190 * t205;
  t209 = 0.2439055252939078889e-1 * t33 * t184 * t79 - 0.12205161970267854748e-3 * t188 * t206;
  t214 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t83 - t156 - 0.3e1 / 0.8e1 * t5 * t64 * t209);
  tvrho1 = t56 + t87 + t6 * (t171 + t214);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t222 = t124 * rho[0];
  t224 = 0.1e1 / t35 / t222;
  t229 = t33 * t38 * t43 - 0.91464571985215458336e0 * t122 * sigma[0] * t224 * t130;
  t230 = t115 * t229;
  t233 = -0.91464571985215458336e-2 * t33 * t38 * t48 - 0.12205161970267854748e-3 * t113 * t230;
  t237 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t233);
  tvsigma0 = t6 * t237;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t243 = t195 * rho[1];
  t245 = 0.1e1 / t66 / t243;
  t250 = t33 * t69 * t74 - 0.91464571985215458336e0 * t122 * sigma[2] * t245 * t201;
  t251 = t190 * t250;
  t254 = -0.91464571985215458336e-2 * t33 * t69 * t79 - 0.12205161970267854748e-3 * t188 * t251;
  t258 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t254);
  tvsigma2 = t6 * t258;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t39;
  double t40, t42, t43, t45, t46, t48, t52, t56;
  double t57, t58, t59, t60, t61, t63, t64, t65;
  double t66, t67, t69, t70, t71, t73, t74, t76;
  double t77, t79, t83, t87, tzk0;

  double t88, t89, t90, t91, t92, t95, t96, t100;
  double t101, t102, t105, t106, t108, t109, t113, t114;
  double t115, t119, t121, t122, t123, t124, t125, t127;
  double t129, t130, t134, t135, t138, t143, t145, t148;
  double t149, t153, t156, t158, tvrho0, t161, t162, t165;
  double t166, t171, t173, t176, t177, t181, t183, t184;
  double t188, t189, t190, t194, t195, t196, t198, t200;
  double t201, t205, t206, t209, t214, tvrho1, t222, t224;
  double t229, t230, t233, t237, tvsigma0, tvsigma1, t243, t245;
  double t250, t251, t254, t258, tvsigma2;

  double t261, t262, t263, t266, t267, t268, t270, t271;
  double t275, t276, t280, t282, t288, t289, t292, t294;
  double t297, t298, t302, t303, t306, t307, t308, t309;
  double t315, t317, t322, t323, t324, t325, t328, t331;
  double t332, t335, t340, t341, t342, t343, t347, t351;
  double t352, t356, t358, t360, t363, t365, tv2rho20, t368;
  double t371, t372, t376, t377, t381, t383, t391, t392;
  double t395, t399, t400, t404, t406, t413, t416, tv2rho21;
  double t421, t425, t426, t430, t431, t437, t438, t442;
  double t446, t447, t457, t458, t462, t463, t466, t467;
  double t468, t469, t475, t477, t482, t483, t484, t485;
  double t488, t491, t492, t495, t500, tv2rho22, t508, t514;
  double t517, t524, t528, t529, t533, t534, t537, t542;
  double tv2rhosigma0, tv2rhosigma1, t549, t551, tv2rhosigma2, t557, tv2rhosigma3, tv2rhosigma4;
  double t567, t570, t577, t581, t582, t586, t587, t590;
  double t595, tv2rhosigma5, t599, t600, t606, t610, t611, t614;
  double t618, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t621, t622;
  double t628, t632, t633, t636, t640, tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = 0.91464571985215458336e0 * t40 + 0.804e0;
  t43 = 0.1e1 / t42;
  t45 = t33 * t39 * t43;
  t46 = pow(t45, 0.1e3);
  t48 = 0.13344141567995010044e-3 * t46 - 0.1e1;
  t52 = 0.1e1 - 0.91464571985215458336e-2 * t33 * t39 * t48;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t14, t11, t10, t15, -t17);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t63 = my_piecewise3(t60, t22, t61 * t59);
  t64 = t63 * t26;
  t65 = rho[1] * rho[1];
  t66 = POW_1_3(rho[1]);
  t67 = t66 * t66;
  t69 = 0.1e1 / t67 / t65;
  t70 = sigma[2] * t69;
  t71 = t33 * t70;
  t73 = 0.91464571985215458336e0 * t71 + 0.804e0;
  t74 = 0.1e1 / t73;
  t76 = t33 * t70 * t74;
  t77 = pow(t76, 0.1e3);
  t79 = 0.13344141567995010044e-3 * t77 - 0.1e1;
  t83 = 0.1e1 - 0.91464571985215458336e-2 * t33 * t70 * t79;
  t87 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t83);
  tzk0 = t56 + t87;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t88 = t6 * t6;
  t89 = 0.1e1 / t88;
  t90 = t16 * t89;
  t91 = t7 - t90;
  t92 = my_piecewise5(t10, 0, t14, 0, t91);
  t95 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t92);
  t96 = t95 * t26;
  t100 = t26 * t26;
  t101 = 0.1e1 / t100;
  t102 = t25 * t101;
  t105 = t5 * t102 * t52 / 0.8e1;
  t106 = t34 * rho[0];
  t108 = 0.1e1 / t36 / t106;
  t109 = sigma[0] * t108;
  t113 = t33 * sigma[0];
  t114 = pow(t45, 0.99e2);
  t115 = t38 * t114;
  t119 = t28 * t28;
  t121 = 0.1e1 / t30 / t29;
  t122 = t119 * t121;
  t123 = sigma[0] * sigma[0];
  t124 = t34 * t34;
  t125 = t124 * t34;
  t127 = 0.1e1 / t35 / t125;
  t129 = t42 * t42;
  t130 = 0.1e1 / t129;
  t134 = -0.8e1 / 0.3e1 * t33 * t109 * t43 + 0.2439055252939078889e1 * t122 * t123 * t127 * t130;
  t135 = t115 * t134;
  t138 = 0.2439055252939078889e-1 * t33 * t109 * t48 - 0.12205161970267854748e-3 * t113 * t135;
  t143 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t52 - t105 - 0.3e1 / 0.8e1 * t5 * t27 * t138);
  t145 = my_piecewise5(t14, 0, t10, 0, -t91);
  t148 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t145);
  t149 = t148 * t26;
  t153 = t63 * t101;
  t156 = t5 * t153 * t83 / 0.8e1;
  t158 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t83 - t156);
  tvrho0 = t56 + t87 + t6 * (t143 + t158);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t161 = -t7 - t90;
  t162 = my_piecewise5(t10, 0, t14, 0, t161);
  t165 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t162);
  t166 = t165 * t26;
  t171 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t52 - t105);
  t173 = my_piecewise5(t14, 0, t10, 0, -t161);
  t176 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t173);
  t177 = t176 * t26;
  t181 = t65 * rho[1];
  t183 = 0.1e1 / t67 / t181;
  t184 = sigma[2] * t183;
  t188 = t33 * sigma[2];
  t189 = pow(t76, 0.99e2);
  t190 = t69 * t189;
  t194 = sigma[2] * sigma[2];
  t195 = t65 * t65;
  t196 = t195 * t65;
  t198 = 0.1e1 / t66 / t196;
  t200 = t73 * t73;
  t201 = 0.1e1 / t200;
  t205 = -0.8e1 / 0.3e1 * t33 * t184 * t74 + 0.2439055252939078889e1 * t122 * t194 * t198 * t201;
  t206 = t190 * t205;
  t209 = 0.2439055252939078889e-1 * t33 * t184 * t79 - 0.12205161970267854748e-3 * t188 * t206;
  t214 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t83 - t156 - 0.3e1 / 0.8e1 * t5 * t64 * t209);
  tvrho1 = t56 + t87 + t6 * (t171 + t214);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t222 = t124 * rho[0];
  t224 = 0.1e1 / t35 / t222;
  t229 = t33 * t38 * t43 - 0.91464571985215458336e0 * t122 * sigma[0] * t224 * t130;
  t230 = t115 * t229;
  t233 = -0.91464571985215458336e-2 * t33 * t38 * t48 - 0.12205161970267854748e-3 * t113 * t230;
  t237 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t233);
  tvsigma0 = t6 * t237;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t243 = t195 * rho[1];
  t245 = 0.1e1 / t66 / t243;
  t250 = t33 * t69 * t74 - 0.91464571985215458336e0 * t122 * sigma[2] * t245 * t201;
  t251 = t190 * t250;
  t254 = -0.91464571985215458336e-2 * t33 * t69 * t79 - 0.12205161970267854748e-3 * t188 * t251;
  t258 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t254);
  tvsigma2 = t6 * t258;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t261 = t23 * t23;
  t262 = 0.1e1 / t261;
  t263 = t92 * t92;
  t266 = t88 * t6;
  t267 = 0.1e1 / t266;
  t268 = t16 * t267;
  t270 = -0.2e1 * t89 + 0.2e1 * t268;
  t271 = my_piecewise5(t10, 0, t14, 0, t270);
  t275 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t263 + 0.4e1 / 0.3e1 * t23 * t271);
  t276 = t275 * t26;
  t280 = t95 * t101;
  t282 = t5 * t280 * t52;
  t288 = 0.1e1 / t100 / t6;
  t289 = t25 * t288;
  t292 = t5 * t289 * t52 / 0.12e2;
  t294 = t5 * t102 * t138;
  t297 = 0.1e1 / t36 / t124;
  t298 = sigma[0] * t297;
  t302 = t108 * t114;
  t303 = t302 * t134;
  t306 = pow(t45, 0.98e2);
  t307 = t38 * t306;
  t308 = t134 * t134;
  t309 = t307 * t308;
  t315 = t124 * t106;
  t317 = 0.1e1 / t35 / t315;
  t322 = t123 * sigma[0];
  t323 = t124 * t124;
  t324 = t323 * t34;
  t325 = 0.1e1 / t324;
  t328 = 0.1e1 / t129 / t42;
  t331 = 0.88e2 / 0.9e1 * t33 * t298 * t43 - 0.21951497276451710001e2 * t122 * t123 * t317 * t130 + 0.73286677418802021954e0 * t322 * t325 * t328;
  t332 = t115 * t331;
  t335 = -0.89432025941099559263e-1 * t33 * t298 * t48 + 0.65094197174761891991e-3 * t113 * t303 - 0.12083110350565176201e-1 * t113 * t309 - 0.12205161970267854748e-3 * t113 * t332;
  t340 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t52 - t282 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t96 * t138 + t292 - t294 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t335);
  t341 = t61 * t61;
  t342 = 0.1e1 / t341;
  t343 = t145 * t145;
  t347 = my_piecewise5(t14, 0, t10, 0, -t270);
  t351 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t342 * t343 + 0.4e1 / 0.3e1 * t61 * t347);
  t352 = t351 * t26;
  t356 = t148 * t101;
  t358 = t5 * t356 * t83;
  t360 = t63 * t288;
  t363 = t5 * t360 * t83 / 0.12e2;
  t365 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t352 * t83 - t358 / 0.4e1 + t363);
  tv2rho20 = 0.2e1 * t143 + 0.2e1 * t158 + t6 * (t340 + t365);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t368 = t262 * t162;
  t371 = 0.2e1 * t268;
  t372 = my_piecewise5(t10, 0, t14, 0, t371);
  t376 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t368 * t92 + 0.4e1 / 0.3e1 * t23 * t372);
  t377 = t376 * t26;
  t381 = t165 * t101;
  t383 = t5 * t381 * t52;
  t391 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t377 * t52 - t383 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t166 * t138 - t282 / 0.8e1 + t292 - t294 / 0.8e1);
  t392 = t342 * t173;
  t395 = my_piecewise5(t14, 0, t10, 0, -t371);
  t399 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t392 * t145 + 0.4e1 / 0.3e1 * t61 * t395);
  t400 = t399 * t26;
  t404 = t176 * t101;
  t406 = t5 * t404 * t83;
  t413 = t5 * t153 * t209;
  t416 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t400 * t83 - t406 / 0.8e1 - t358 / 0.8e1 + t363 - 0.3e1 / 0.8e1 * t5 * t149 * t209 - t413 / 0.8e1);
  tv2rho21 = t143 + t158 + t171 + t214 + t6 * (t391 + t416);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t421 = t162 * t162;
  t425 = 0.2e1 * t89 + 0.2e1 * t268;
  t426 = my_piecewise5(t10, 0, t14, 0, t425);
  t430 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t421 + 0.4e1 / 0.3e1 * t23 * t426);
  t431 = t430 * t26;
  t437 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t431 * t52 - t383 / 0.4e1 + t292);
  t438 = t173 * t173;
  t442 = my_piecewise5(t14, 0, t10, 0, -t425);
  t446 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t342 * t438 + 0.4e1 / 0.3e1 * t61 * t442);
  t447 = t446 * t26;
  t457 = 0.1e1 / t67 / t195;
  t458 = sigma[2] * t457;
  t462 = t183 * t189;
  t463 = t462 * t205;
  t466 = pow(t76, 0.98e2);
  t467 = t69 * t466;
  t468 = t205 * t205;
  t469 = t467 * t468;
  t475 = t195 * t181;
  t477 = 0.1e1 / t66 / t475;
  t482 = t194 * sigma[2];
  t483 = t195 * t195;
  t484 = t483 * t65;
  t485 = 0.1e1 / t484;
  t488 = 0.1e1 / t200 / t73;
  t491 = 0.88e2 / 0.9e1 * t33 * t458 * t74 - 0.21951497276451710001e2 * t122 * t194 * t477 * t201 + 0.73286677418802021954e0 * t482 * t485 * t488;
  t492 = t190 * t491;
  t495 = -0.89432025941099559263e-1 * t33 * t458 * t79 + 0.65094197174761891991e-3 * t188 * t463 - 0.12083110350565176201e-1 * t188 * t469 - 0.12205161970267854748e-3 * t188 * t492;
  t500 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t447 * t83 - t406 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t177 * t209 + t363 - t413 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * t495);
  tv2rho22 = 0.2e1 * t171 + 0.2e1 * t214 + t6 * (t437 + t500);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t508 = t5 * t102 * t233 / 0.8e1;
  t514 = t302 * t229;
  t517 = t229 * t134;
  t524 = t127 * t130;
  t528 = t323 * rho[0];
  t529 = 0.1e1 / t528;
  t533 = -0.8e1 / 0.3e1 * t33 * t108 * t43 + 0.73171657588172366669e1 * t122 * t524 * sigma[0] - 0.27482504032050758232e0 * t123 * t529 * t328;
  t534 = t115 * t533;
  t537 = 0.2439055252939078889e-1 * t33 * t108 * t48 - 0.12205161970267854748e-3 * t33 * t135 + 0.32547098587380945995e-3 * t113 * t514 - 0.12083110350565176201e-1 * t113 * t307 * t517 - 0.12205161970267854748e-3 * t113 * t534;
  t542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t233 - t508 - 0.3e1 / 0.8e1 * t5 * t27 * t537);
  tv2rhosigma0 = t6 * t542 + t237;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t549 = t5 * t153 * t254 / 0.8e1;
  t551 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t254 - t549);
  tv2rhosigma2 = t6 * t551 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t557 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t233 - t508);
  tv2rhosigma3 = t6 * t557 + t237;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t567 = t462 * t250;
  t570 = t250 * t205;
  t577 = t198 * t201;
  t581 = t483 * rho[1];
  t582 = 0.1e1 / t581;
  t586 = -0.8e1 / 0.3e1 * t33 * t183 * t74 + 0.73171657588172366669e1 * t122 * t577 * sigma[2] - 0.27482504032050758232e0 * t194 * t582 * t488;
  t587 = t190 * t586;
  t590 = 0.2439055252939078889e-1 * t33 * t183 * t79 - 0.12205161970267854748e-3 * t33 * t206 + 0.32547098587380945995e-3 * t188 * t567 - 0.12083110350565176201e-1 * t188 * t467 * t570 - 0.12205161970267854748e-3 * t188 * t587;
  t595 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t254 - t549 - 0.3e1 / 0.8e1 * t5 * t64 * t590);
  tv2rhosigma5 = t6 * t595 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t599 = t229 * t229;
  t600 = t307 * t599;
  t606 = 0.1e1 / t323;
  t610 = -0.18292914397043091667e1 * t122 * t224 * t130 + 0.10305939012019034336e0 * sigma[0] * t606 * t328;
  t611 = t115 * t610;
  t614 = -0.24410323940535709496e-3 * t33 * t230 - 0.12083110350565176201e-1 * t113 * t600 - 0.12205161970267854748e-3 * t113 * t611;
  t618 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t614);
  tv2sigma20 = t6 * t618;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t621 = t250 * t250;
  t622 = t467 * t621;
  t628 = 0.1e1 / t483;
  t632 = -0.18292914397043091667e1 * t122 * t245 * t201 + 0.10305939012019034336e0 * sigma[2] * t628 * t488;
  t633 = t190 * t632;
  t636 = -0.24410323940535709496e-3 * t33 * t251 - 0.12083110350565176201e-1 * t188 * t622 - 0.12205161970267854748e-3 * t188 * t633;
  t640 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t636);
  tv2sigma25 = t6 * t640;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t39;
  double t40, t42, t43, t45, t46, t48, t52, t56;
  double t57, t58, t59, t60, t61, t63, t64, t65;
  double t66, t67, t69, t70, t71, t73, t74, t76;
  double t77, t79, t83, t87, tzk0;

  double t88, t89, t90, t91, t92, t95, t96, t100;
  double t101, t102, t105, t106, t108, t109, t113, t114;
  double t115, t119, t121, t122, t123, t124, t125, t127;
  double t129, t130, t134, t135, t138, t143, t145, t148;
  double t149, t153, t156, t158, tvrho0, t161, t162, t165;
  double t166, t171, t173, t176, t177, t181, t183, t184;
  double t188, t189, t190, t194, t195, t196, t198, t200;
  double t201, t205, t206, t209, t214, tvrho1, t222, t224;
  double t229, t230, t233, t237, tvsigma0, tvsigma1, t243, t245;
  double t250, t251, t254, t258, tvsigma2;

  double t261, t262, t263, t266, t267, t268, t270, t271;
  double t275, t276, t280, t282, t288, t289, t292, t294;
  double t297, t298, t302, t303, t306, t307, t308, t309;
  double t315, t317, t322, t323, t324, t325, t328, t331;
  double t332, t335, t340, t341, t342, t343, t347, t351;
  double t352, t356, t358, t360, t363, t365, tv2rho20, t368;
  double t371, t372, t376, t377, t381, t383, t391, t392;
  double t395, t399, t400, t404, t406, t413, t416, tv2rho21;
  double t421, t425, t426, t430, t431, t437, t438, t442;
  double t446, t447, t457, t458, t462, t463, t466, t467;
  double t468, t469, t475, t477, t482, t483, t484, t485;
  double t488, t491, t492, t495, t500, tv2rho22, t508, t514;
  double t517, t524, t528, t529, t533, t534, t537, t542;
  double tv2rhosigma0, tv2rhosigma1, t549, t551, tv2rhosigma2, t557, tv2rhosigma3, tv2rhosigma4;
  double t567, t570, t577, t581, t582, t586, t587, t590;
  double t595, tv2rhosigma5, t599, t600, t606, t610, t611, t614;
  double t618, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t621, t622;
  double t628, t632, t633, t636, t640, tv2sigma25;

  double t644, t645, t648, t651, t652, t653, t655, t656;
  double t660, t661, t665, t667, t672, t674, t677, t683;
  double t684, t687, t689, t692, t695, t696, t700, t701;
  double t704, t705, t708, t711, t712, t713, t714, t717;
  double t725, t730, t731, t735, t736, t738, t740, t741;
  double t743, t746, t747, t750, t755, t757, t758, t761;
  double t765, t769, t770, t774, t776, t778, t780, t782;
  double t785, t787, tv3rho30, t790, t791, t792, t795, t800;
  double t801, t802, t803, t807, t808, t812, t815, t819;
  double t821, t825, t834, t835, t836, t839, t845, t849;
  double t850, t854, t857, t858, t860, t869, t871, t874;
  double tv3rho31, t877, t882, t885, t886, t890, t891, t895;
  double t897, t906, t907, t912, t916, t920, t921, t925;
  double t927, t934, t942, t944, t945, tv3rho32, t950, t956;
  double t957, t961, t962, t969, t970, t976, t980, t981;
  double t997, t998, t1002, t1003, t1006, t1007, t1010, t1013;
  double t1014, t1015, t1016, t1019, t1027, t1032, t1033, t1037;
  double t1038, t1040, t1042, t1043, t1045, t1048, t1049, t1052;
  double t1057, tv3rho33, t1065, t1072, t1074, t1085, t1091, t1094;
  double t1098, t1102, t1109, t1113, t1116, t1118, t1122, t1123;
  double t1126, t1131, tv3rho2sigma0, tv3rho2sigma1, t1138, t1142, t1144, tv3rho2sigma2;
  double t1150, t1158, tv3rho2sigma3, tv3rho2sigma4, t1164, t1171, t1174, tv3rho2sigma5;
  double t1182, tv3rho2sigma6, tv3rho2sigma7, t1202, t1208, t1211, t1215, t1219;
  double t1226, t1230, t1233, t1235, t1239, t1240, t1243, t1248;
  double tv3rho2sigma8, t1255, t1258, t1259, t1260, t1265, t1268, t1272;
  double t1276, t1279, t1285, t1289, t1293, t1294, t1297, t1302;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1309, t1311, tv3rhosigma25;
  double t1317, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1324, t1325;
  double t1326, t1331, t1334, t1338, t1342, t1345, t1351, t1355;
  double t1359, t1360, t1363, t1368, tv3rhosigma211, t1374, t1375, t1378;
  double t1385, t1389, t1390, t1393, t1397, tv3sigma30, tv3sigma31, tv3sigma32;
  double tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1402, t1403;
  double t1406, t1413, t1417, t1418, t1421, t1425, tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = 0.91464571985215458336e0 * t40 + 0.804e0;
  t43 = 0.1e1 / t42;
  t45 = t33 * t39 * t43;
  t46 = pow(t45, 0.1e3);
  t48 = 0.13344141567995010044e-3 * t46 - 0.1e1;
  t52 = 0.1e1 - 0.91464571985215458336e-2 * t33 * t39 * t48;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t14, t11, t10, t15, -t17);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t63 = my_piecewise3(t60, t22, t61 * t59);
  t64 = t63 * t26;
  t65 = rho[1] * rho[1];
  t66 = POW_1_3(rho[1]);
  t67 = t66 * t66;
  t69 = 0.1e1 / t67 / t65;
  t70 = sigma[2] * t69;
  t71 = t33 * t70;
  t73 = 0.91464571985215458336e0 * t71 + 0.804e0;
  t74 = 0.1e1 / t73;
  t76 = t33 * t70 * t74;
  t77 = pow(t76, 0.1e3);
  t79 = 0.13344141567995010044e-3 * t77 - 0.1e1;
  t83 = 0.1e1 - 0.91464571985215458336e-2 * t33 * t70 * t79;
  t87 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t83);
  tzk0 = t56 + t87;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t88 = t6 * t6;
  t89 = 0.1e1 / t88;
  t90 = t16 * t89;
  t91 = t7 - t90;
  t92 = my_piecewise5(t10, 0, t14, 0, t91);
  t95 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t92);
  t96 = t95 * t26;
  t100 = t26 * t26;
  t101 = 0.1e1 / t100;
  t102 = t25 * t101;
  t105 = t5 * t102 * t52 / 0.8e1;
  t106 = t34 * rho[0];
  t108 = 0.1e1 / t36 / t106;
  t109 = sigma[0] * t108;
  t113 = t33 * sigma[0];
  t114 = pow(t45, 0.99e2);
  t115 = t38 * t114;
  t119 = t28 * t28;
  t121 = 0.1e1 / t30 / t29;
  t122 = t119 * t121;
  t123 = sigma[0] * sigma[0];
  t124 = t34 * t34;
  t125 = t124 * t34;
  t127 = 0.1e1 / t35 / t125;
  t129 = t42 * t42;
  t130 = 0.1e1 / t129;
  t134 = -0.8e1 / 0.3e1 * t33 * t109 * t43 + 0.2439055252939078889e1 * t122 * t123 * t127 * t130;
  t135 = t115 * t134;
  t138 = 0.2439055252939078889e-1 * t33 * t109 * t48 - 0.12205161970267854748e-3 * t113 * t135;
  t143 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t52 - t105 - 0.3e1 / 0.8e1 * t5 * t27 * t138);
  t145 = my_piecewise5(t14, 0, t10, 0, -t91);
  t148 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t145);
  t149 = t148 * t26;
  t153 = t63 * t101;
  t156 = t5 * t153 * t83 / 0.8e1;
  t158 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t83 - t156);
  tvrho0 = t56 + t87 + t6 * (t143 + t158);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t161 = -t7 - t90;
  t162 = my_piecewise5(t10, 0, t14, 0, t161);
  t165 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t162);
  t166 = t165 * t26;
  t171 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t52 - t105);
  t173 = my_piecewise5(t14, 0, t10, 0, -t161);
  t176 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t173);
  t177 = t176 * t26;
  t181 = t65 * rho[1];
  t183 = 0.1e1 / t67 / t181;
  t184 = sigma[2] * t183;
  t188 = t33 * sigma[2];
  t189 = pow(t76, 0.99e2);
  t190 = t69 * t189;
  t194 = sigma[2] * sigma[2];
  t195 = t65 * t65;
  t196 = t195 * t65;
  t198 = 0.1e1 / t66 / t196;
  t200 = t73 * t73;
  t201 = 0.1e1 / t200;
  t205 = -0.8e1 / 0.3e1 * t33 * t184 * t74 + 0.2439055252939078889e1 * t122 * t194 * t198 * t201;
  t206 = t190 * t205;
  t209 = 0.2439055252939078889e-1 * t33 * t184 * t79 - 0.12205161970267854748e-3 * t188 * t206;
  t214 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t83 - t156 - 0.3e1 / 0.8e1 * t5 * t64 * t209);
  tvrho1 = t56 + t87 + t6 * (t171 + t214);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t222 = t124 * rho[0];
  t224 = 0.1e1 / t35 / t222;
  t229 = t33 * t38 * t43 - 0.91464571985215458336e0 * t122 * sigma[0] * t224 * t130;
  t230 = t115 * t229;
  t233 = -0.91464571985215458336e-2 * t33 * t38 * t48 - 0.12205161970267854748e-3 * t113 * t230;
  t237 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t233);
  tvsigma0 = t6 * t237;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t243 = t195 * rho[1];
  t245 = 0.1e1 / t66 / t243;
  t250 = t33 * t69 * t74 - 0.91464571985215458336e0 * t122 * sigma[2] * t245 * t201;
  t251 = t190 * t250;
  t254 = -0.91464571985215458336e-2 * t33 * t69 * t79 - 0.12205161970267854748e-3 * t188 * t251;
  t258 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t254);
  tvsigma2 = t6 * t258;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t261 = t23 * t23;
  t262 = 0.1e1 / t261;
  t263 = t92 * t92;
  t266 = t88 * t6;
  t267 = 0.1e1 / t266;
  t268 = t16 * t267;
  t270 = -0.2e1 * t89 + 0.2e1 * t268;
  t271 = my_piecewise5(t10, 0, t14, 0, t270);
  t275 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t263 + 0.4e1 / 0.3e1 * t23 * t271);
  t276 = t275 * t26;
  t280 = t95 * t101;
  t282 = t5 * t280 * t52;
  t288 = 0.1e1 / t100 / t6;
  t289 = t25 * t288;
  t292 = t5 * t289 * t52 / 0.12e2;
  t294 = t5 * t102 * t138;
  t297 = 0.1e1 / t36 / t124;
  t298 = sigma[0] * t297;
  t302 = t108 * t114;
  t303 = t302 * t134;
  t306 = pow(t45, 0.98e2);
  t307 = t38 * t306;
  t308 = t134 * t134;
  t309 = t307 * t308;
  t315 = t124 * t106;
  t317 = 0.1e1 / t35 / t315;
  t322 = t123 * sigma[0];
  t323 = t124 * t124;
  t324 = t323 * t34;
  t325 = 0.1e1 / t324;
  t328 = 0.1e1 / t129 / t42;
  t331 = 0.88e2 / 0.9e1 * t33 * t298 * t43 - 0.21951497276451710001e2 * t122 * t123 * t317 * t130 + 0.73286677418802021954e0 * t322 * t325 * t328;
  t332 = t115 * t331;
  t335 = -0.89432025941099559263e-1 * t33 * t298 * t48 + 0.65094197174761891991e-3 * t113 * t303 - 0.12083110350565176201e-1 * t113 * t309 - 0.12205161970267854748e-3 * t113 * t332;
  t340 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t52 - t282 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t96 * t138 + t292 - t294 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t335);
  t341 = t61 * t61;
  t342 = 0.1e1 / t341;
  t343 = t145 * t145;
  t347 = my_piecewise5(t14, 0, t10, 0, -t270);
  t351 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t342 * t343 + 0.4e1 / 0.3e1 * t61 * t347);
  t352 = t351 * t26;
  t356 = t148 * t101;
  t358 = t5 * t356 * t83;
  t360 = t63 * t288;
  t363 = t5 * t360 * t83 / 0.12e2;
  t365 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t352 * t83 - t358 / 0.4e1 + t363);
  tv2rho20 = 0.2e1 * t143 + 0.2e1 * t158 + t6 * (t340 + t365);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t368 = t262 * t162;
  t371 = 0.2e1 * t268;
  t372 = my_piecewise5(t10, 0, t14, 0, t371);
  t376 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t368 * t92 + 0.4e1 / 0.3e1 * t23 * t372);
  t377 = t376 * t26;
  t381 = t165 * t101;
  t383 = t5 * t381 * t52;
  t391 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t377 * t52 - t383 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t166 * t138 - t282 / 0.8e1 + t292 - t294 / 0.8e1);
  t392 = t342 * t173;
  t395 = my_piecewise5(t14, 0, t10, 0, -t371);
  t399 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t392 * t145 + 0.4e1 / 0.3e1 * t61 * t395);
  t400 = t399 * t26;
  t404 = t176 * t101;
  t406 = t5 * t404 * t83;
  t413 = t5 * t153 * t209;
  t416 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t400 * t83 - t406 / 0.8e1 - t358 / 0.8e1 + t363 - 0.3e1 / 0.8e1 * t5 * t149 * t209 - t413 / 0.8e1);
  tv2rho21 = t143 + t158 + t171 + t214 + t6 * (t391 + t416);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t421 = t162 * t162;
  t425 = 0.2e1 * t89 + 0.2e1 * t268;
  t426 = my_piecewise5(t10, 0, t14, 0, t425);
  t430 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t421 + 0.4e1 / 0.3e1 * t23 * t426);
  t431 = t430 * t26;
  t437 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t431 * t52 - t383 / 0.4e1 + t292);
  t438 = t173 * t173;
  t442 = my_piecewise5(t14, 0, t10, 0, -t425);
  t446 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t342 * t438 + 0.4e1 / 0.3e1 * t61 * t442);
  t447 = t446 * t26;
  t457 = 0.1e1 / t67 / t195;
  t458 = sigma[2] * t457;
  t462 = t183 * t189;
  t463 = t462 * t205;
  t466 = pow(t76, 0.98e2);
  t467 = t69 * t466;
  t468 = t205 * t205;
  t469 = t467 * t468;
  t475 = t195 * t181;
  t477 = 0.1e1 / t66 / t475;
  t482 = t194 * sigma[2];
  t483 = t195 * t195;
  t484 = t483 * t65;
  t485 = 0.1e1 / t484;
  t488 = 0.1e1 / t200 / t73;
  t491 = 0.88e2 / 0.9e1 * t33 * t458 * t74 - 0.21951497276451710001e2 * t122 * t194 * t477 * t201 + 0.73286677418802021954e0 * t482 * t485 * t488;
  t492 = t190 * t491;
  t495 = -0.89432025941099559263e-1 * t33 * t458 * t79 + 0.65094197174761891991e-3 * t188 * t463 - 0.12083110350565176201e-1 * t188 * t469 - 0.12205161970267854748e-3 * t188 * t492;
  t500 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t447 * t83 - t406 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t177 * t209 + t363 - t413 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * t495);
  tv2rho22 = 0.2e1 * t171 + 0.2e1 * t214 + t6 * (t437 + t500);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t508 = t5 * t102 * t233 / 0.8e1;
  t514 = t302 * t229;
  t517 = t229 * t134;
  t524 = t127 * t130;
  t528 = t323 * rho[0];
  t529 = 0.1e1 / t528;
  t533 = -0.8e1 / 0.3e1 * t33 * t108 * t43 + 0.73171657588172366669e1 * t122 * t524 * sigma[0] - 0.27482504032050758232e0 * t123 * t529 * t328;
  t534 = t115 * t533;
  t537 = 0.2439055252939078889e-1 * t33 * t108 * t48 - 0.12205161970267854748e-3 * t33 * t135 + 0.32547098587380945995e-3 * t113 * t514 - 0.12083110350565176201e-1 * t113 * t307 * t517 - 0.12205161970267854748e-3 * t113 * t534;
  t542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t233 - t508 - 0.3e1 / 0.8e1 * t5 * t27 * t537);
  tv2rhosigma0 = t6 * t542 + t237;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t549 = t5 * t153 * t254 / 0.8e1;
  t551 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t254 - t549);
  tv2rhosigma2 = t6 * t551 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t557 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t233 - t508);
  tv2rhosigma3 = t6 * t557 + t237;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t567 = t462 * t250;
  t570 = t250 * t205;
  t577 = t198 * t201;
  t581 = t483 * rho[1];
  t582 = 0.1e1 / t581;
  t586 = -0.8e1 / 0.3e1 * t33 * t183 * t74 + 0.73171657588172366669e1 * t122 * t577 * sigma[2] - 0.27482504032050758232e0 * t194 * t582 * t488;
  t587 = t190 * t586;
  t590 = 0.2439055252939078889e-1 * t33 * t183 * t79 - 0.12205161970267854748e-3 * t33 * t206 + 0.32547098587380945995e-3 * t188 * t567 - 0.12083110350565176201e-1 * t188 * t467 * t570 - 0.12205161970267854748e-3 * t188 * t587;
  t595 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t254 - t549 - 0.3e1 / 0.8e1 * t5 * t64 * t590);
  tv2rhosigma5 = t6 * t595 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t599 = t229 * t229;
  t600 = t307 * t599;
  t606 = 0.1e1 / t323;
  t610 = -0.18292914397043091667e1 * t122 * t224 * t130 + 0.10305939012019034336e0 * sigma[0] * t606 * t328;
  t611 = t115 * t610;
  t614 = -0.24410323940535709496e-3 * t33 * t230 - 0.12083110350565176201e-1 * t113 * t600 - 0.12205161970267854748e-3 * t113 * t611;
  t618 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t614);
  tv2sigma20 = t6 * t618;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t621 = t250 * t250;
  t622 = t467 * t621;
  t628 = 0.1e1 / t483;
  t632 = -0.18292914397043091667e1 * t122 * t245 * t201 + 0.10305939012019034336e0 * sigma[2] * t628 * t488;
  t633 = t190 * t632;
  t636 = -0.24410323940535709496e-3 * t33 * t251 - 0.12083110350565176201e-1 * t188 * t622 - 0.12205161970267854748e-3 * t188 * t633;
  t640 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t636);
  tv2sigma25 = t6 * t640;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t644 = 0.1e1 / t261 / t19;
  t645 = t263 * t92;
  t648 = t262 * t92;
  t651 = t88 * t88;
  t652 = 0.1e1 / t651;
  t653 = t16 * t652;
  t655 = 0.6e1 * t267 - 0.6e1 * t653;
  t656 = my_piecewise5(t10, 0, t14, 0, t655);
  t660 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t644 * t645 + 0.4e1 / 0.3e1 * t648 * t271 + 0.4e1 / 0.3e1 * t23 * t656);
  t661 = t660 * t26;
  t665 = t275 * t101;
  t667 = t5 * t665 * t52;
  t672 = t95 * t288;
  t674 = t5 * t672 * t52;
  t677 = t5 * t280 * t138;
  t683 = 0.1e1 / t100 / t88;
  t684 = t25 * t683;
  t687 = 0.5e1 / 0.36e2 * t5 * t684 * t52;
  t689 = t5 * t289 * t138;
  t692 = t5 * t102 * t335;
  t695 = 0.1e1 / t36 / t222;
  t696 = sigma[0] * t695;
  t700 = t297 * t114;
  t701 = t700 * t134;
  t704 = t108 * t306;
  t705 = t704 * t308;
  t708 = t302 * t331;
  t711 = pow(t45, 0.97e2);
  t712 = t38 * t711;
  t713 = t308 * t134;
  t714 = t712 * t713;
  t717 = t134 * t331;
  t725 = 0.1e1 / t35 / t323;
  t730 = t323 * t106;
  t731 = 0.1e1 / t730;
  t735 = t123 * t123;
  t736 = t323 * t222;
  t738 = 0.1e1 / t36 / t736;
  t740 = t129 * t129;
  t741 = 0.1e1 / t740;
  t743 = t741 * t28 * t32;
  t746 = -0.1232e4 / 0.27e2 * t33 * t696 * t43 + 0.18482618694493908914e3 * t122 * t123 * t725 * t130 - 0.13924468709572384171e2 * t322 * t731 * t328 + 0.53625076658634254041e1 * t735 * t738 * t743;
  t747 = t115 * t746;
  t750 = 0.41734945439179794323e0 * t33 * t696 * t48 - 0.35801808446119040595e-2 * t113 * t701 + 0.96664882804521409607e-1 * t113 * t705 + 0.97641295762142837986e-3 * t113 * t708 - 0.11841448143553872677e1 * t113 * t714 - 0.36249331051695528603e-1 * t113 * t307 * t717 - 0.12205161970267854748e-3 * t113 * t747;
  t755 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t661 * t52 - 0.3e1 / 0.8e1 * t667 - 0.9e1 / 0.8e1 * t5 * t276 * t138 + t674 / 0.4e1 - 0.3e1 / 0.4e1 * t677 - 0.9e1 / 0.8e1 * t5 * t96 * t335 - t687 + t689 / 0.4e1 - 0.3e1 / 0.8e1 * t692 - 0.3e1 / 0.8e1 * t5 * t27 * t750);
  t757 = 0.1e1 / t341 / t59;
  t758 = t343 * t145;
  t761 = t342 * t145;
  t765 = my_piecewise5(t14, 0, t10, 0, -t655);
  t769 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t757 * t758 + 0.4e1 / 0.3e1 * t761 * t347 + 0.4e1 / 0.3e1 * t61 * t765);
  t770 = t769 * t26;
  t774 = t351 * t101;
  t776 = t5 * t774 * t83;
  t778 = t148 * t288;
  t780 = t5 * t778 * t83;
  t782 = t63 * t683;
  t785 = 0.5e1 / 0.36e2 * t5 * t782 * t83;
  t787 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t770 * t83 - 0.3e1 / 0.8e1 * t776 + t780 / 0.4e1 - t785);
  tv3rho30 = 0.3e1 * t340 + 0.3e1 * t365 + t6 * (t755 + t787);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t790 = 0.2e1 * t391;
  t791 = 0.2e1 * t416;
  t792 = t644 * t162;
  t795 = t262 * t372;
  t800 = 0.2e1 * t267;
  t801 = 0.6e1 * t653;
  t802 = t800 - t801;
  t803 = my_piecewise5(t10, 0, t14, 0, t802);
  t807 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t792 * t263 + 0.8e1 / 0.9e1 * t795 * t92 + 0.4e1 / 0.9e1 * t368 * t271 + 0.4e1 / 0.3e1 * t23 * t803);
  t808 = t807 * t26;
  t812 = t376 * t101;
  t815 = t5 * t812 * t52 / 0.4e1;
  t819 = t165 * t288;
  t821 = t5 * t819 * t52;
  t825 = t5 * t381 * t138 / 0.4e1;
  t834 = -0.3e1 / 0.8e1 * t5 * t808 * t52 - t815 - 0.3e1 / 0.4e1 * t5 * t377 * t138 + t821 / 0.12e2 - t825 - 0.3e1 / 0.8e1 * t5 * t166 * t335 - t667 / 0.8e1 + t674 / 0.6e1 - t677 / 0.4e1 - t687 + t689 / 0.6e1 - t692 / 0.8e1;
  t835 = my_piecewise3(t1, 0, t834);
  t836 = t757 * t173;
  t839 = t342 * t395;
  t845 = my_piecewise5(t14, 0, t10, 0, -t802);
  t849 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t836 * t343 + 0.8e1 / 0.9e1 * t839 * t145 + 0.4e1 / 0.9e1 * t392 * t347 + 0.4e1 / 0.3e1 * t61 * t845);
  t850 = t849 * t26;
  t854 = t399 * t101;
  t857 = t5 * t854 * t83 / 0.4e1;
  t858 = t176 * t288;
  t860 = t5 * t858 * t83;
  t869 = t5 * t356 * t209 / 0.4e1;
  t871 = t5 * t360 * t209;
  t874 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t850 * t83 - t857 + t860 / 0.12e2 - t776 / 0.8e1 + t780 / 0.6e1 - t785 - 0.3e1 / 0.8e1 * t5 * t352 * t209 - t869 + t871 / 0.12e2);
  tv3rho31 = t340 + t365 + t790 + t791 + t6 * (t835 + t874);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t877 = t644 * t421;
  t882 = t262 * t426;
  t885 = -t800 - t801;
  t886 = my_piecewise5(t10, 0, t14, 0, t885);
  t890 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t877 * t92 + 0.8e1 / 0.9e1 * t368 * t372 + 0.4e1 / 0.9e1 * t882 * t92 + 0.4e1 / 0.3e1 * t23 * t886);
  t891 = t890 * t26;
  t895 = t430 * t101;
  t897 = t5 * t895 * t52;
  t906 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t891 * t52 - t897 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t431 * t138 - t815 + t821 / 0.6e1 - t825 + t674 / 0.12e2 - t687 + t689 / 0.12e2);
  t907 = t757 * t438;
  t912 = t342 * t442;
  t916 = my_piecewise5(t14, 0, t10, 0, -t885);
  t920 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t907 * t145 + 0.8e1 / 0.9e1 * t392 * t395 + 0.4e1 / 0.9e1 * t912 * t145 + 0.4e1 / 0.3e1 * t61 * t916);
  t921 = t920 * t26;
  t925 = t446 * t101;
  t927 = t5 * t925 * t83;
  t934 = t5 * t404 * t209;
  t942 = t5 * t153 * t495;
  t944 = -0.3e1 / 0.8e1 * t5 * t921 * t83 - t927 / 0.8e1 - t857 + t860 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t400 * t209 - t934 / 0.4e1 + t780 / 0.12e2 - t785 - t869 + t871 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t149 * t495 - t942 / 0.8e1;
  t945 = my_piecewise3(t57, 0, t944);
  tv3rho32 = t790 + t791 + t437 + t500 + t6 * (t906 + t945);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t950 = t421 * t162;
  t956 = -0.6e1 * t267 - 0.6e1 * t653;
  t957 = my_piecewise5(t10, 0, t14, 0, t956);
  t961 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t644 * t950 + 0.4e1 / 0.3e1 * t368 * t426 + 0.4e1 / 0.3e1 * t23 * t957);
  t962 = t961 * t26;
  t969 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t962 * t52 - 0.3e1 / 0.8e1 * t897 + t821 / 0.4e1 - t687);
  t970 = t438 * t173;
  t976 = my_piecewise5(t14, 0, t10, 0, -t956);
  t980 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t757 * t970 + 0.4e1 / 0.3e1 * t392 * t442 + 0.4e1 / 0.3e1 * t61 * t976);
  t981 = t980 * t26;
  t997 = 0.1e1 / t67 / t243;
  t998 = sigma[2] * t997;
  t1002 = t457 * t189;
  t1003 = t1002 * t205;
  t1006 = t183 * t466;
  t1007 = t1006 * t468;
  t1010 = t462 * t491;
  t1013 = pow(t76, 0.97e2);
  t1014 = t69 * t1013;
  t1015 = t468 * t205;
  t1016 = t1014 * t1015;
  t1019 = t205 * t491;
  t1027 = 0.1e1 / t66 / t483;
  t1032 = t483 * t181;
  t1033 = 0.1e1 / t1032;
  t1037 = t194 * t194;
  t1038 = t483 * t243;
  t1040 = 0.1e1 / t67 / t1038;
  t1042 = t200 * t200;
  t1043 = 0.1e1 / t1042;
  t1045 = t1043 * t28 * t32;
  t1048 = -0.1232e4 / 0.27e2 * t33 * t998 * t74 + 0.18482618694493908914e3 * t122 * t194 * t1027 * t201 - 0.13924468709572384171e2 * t482 * t1033 * t488 + 0.53625076658634254041e1 * t1037 * t1040 * t1045;
  t1049 = t190 * t1048;
  t1052 = 0.41734945439179794323e0 * t33 * t998 * t79 - 0.35801808446119040595e-2 * t188 * t1003 + 0.96664882804521409607e-1 * t188 * t1007 + 0.97641295762142837986e-3 * t188 * t1010 - 0.11841448143553872677e1 * t188 * t1016 - 0.36249331051695528603e-1 * t188 * t467 * t1019 - 0.12205161970267854748e-3 * t188 * t1049;
  t1057 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t981 * t83 - 0.3e1 / 0.8e1 * t927 - 0.9e1 / 0.8e1 * t5 * t447 * t209 + t860 / 0.4e1 - 0.3e1 / 0.4e1 * t934 - 0.9e1 / 0.8e1 * t5 * t177 * t495 - t785 + t871 / 0.4e1 - 0.3e1 / 0.8e1 * t942 - 0.3e1 / 0.8e1 * t5 * t64 * t1052);
  tv3rho33 = 0.3e1 * t437 + 0.3e1 * t500 + t6 * (t969 + t1057);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1065 = t5 * t280 * t233;
  t1072 = t5 * t289 * t233 / 0.12e2;
  t1074 = t5 * t102 * t537;
  t1085 = t700 * t229;
  t1091 = t302 * t533;
  t1094 = t229 * t308;
  t1098 = t533 * t134;
  t1102 = t229 * t331;
  t1109 = t317 * t130;
  t1113 = t325 * t328;
  t1116 = t323 * t124;
  t1118 = 0.1e1 / t36 / t1116;
  t1122 = 0.88e2 / 0.9e1 * t33 * t297 * t43 - 0.52846197147013375927e2 * t122 * t1109 * sigma[0] + 0.46720256854486288995e1 * t1113 * t123 - 0.20109403746987845265e1 * t322 * t1118 * t743;
  t1123 = t115 * t1122;
  t1126 = -0.89432025941099559263e-1 * t33 * t297 * t48 + 0.65094197174761891991e-3 * t33 * t303 - 0.12083110350565176201e-1 * t33 * t309 - 0.12205161970267854748e-3 * t33 * t332 - 0.11933936148706346865e-2 * t113 * t1085 + 0.64443255203014273071e-1 * t113 * t704 * t517 + 0.6509419717476189199e-3 * t113 * t1091 - 0.11841448143553872677e1 * t113 * t712 * t1094 - 0.24166220701130352402e-1 * t113 * t307 * t1098 - 0.12083110350565176201e-1 * t113 * t307 * t1102 - 0.12205161970267854748e-3 * t113 * t1123;
  t1131 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t233 - t1065 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t96 * t537 + t1072 - t1074 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1126);
  tv3rho2sigma0 = t6 * t1131 + 0.2e1 * t542;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1138 = t5 * t356 * t254;
  t1142 = t5 * t360 * t254 / 0.12e2;
  t1144 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t352 * t254 - t1138 / 0.4e1 + t1142);
  tv3rho2sigma2 = t6 * t1144 + 0.2e1 * t551;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1150 = t5 * t381 * t233;
  t1158 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t377 * t233 - t1150 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t166 * t537 - t1065 / 0.8e1 + t1072 - t1074 / 0.8e1);
  tv3rho2sigma3 = t6 * t1158 + t542 + t557;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1164 = t5 * t404 * t254;
  t1171 = t5 * t153 * t590;
  t1174 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t400 * t254 - t1164 / 0.8e1 - t1138 / 0.8e1 + t1142 - 0.3e1 / 0.8e1 * t5 * t149 * t590 - t1171 / 0.8e1);
  tv3rho2sigma5 = t6 * t1174 + t551 + t595;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1182 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t431 * t233 - t1150 / 0.4e1 + t1072);
  tv3rho2sigma6 = t6 * t1182 + 0.2e1 * t557;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1202 = t1002 * t250;
  t1208 = t462 * t586;
  t1211 = t250 * t468;
  t1215 = t586 * t205;
  t1219 = t250 * t491;
  t1226 = t477 * t201;
  t1230 = t485 * t488;
  t1233 = t483 * t195;
  t1235 = 0.1e1 / t67 / t1233;
  t1239 = 0.88e2 / 0.9e1 * t33 * t457 * t74 - 0.52846197147013375927e2 * t122 * t1226 * sigma[2] + 0.46720256854486288995e1 * t1230 * t194 - 0.20109403746987845265e1 * t482 * t1235 * t1045;
  t1240 = t190 * t1239;
  t1243 = -0.89432025941099559263e-1 * t33 * t457 * t79 + 0.65094197174761891991e-3 * t33 * t463 - 0.12083110350565176201e-1 * t33 * t469 - 0.12205161970267854748e-3 * t33 * t492 - 0.11933936148706346865e-2 * t188 * t1202 + 0.64443255203014273071e-1 * t188 * t1006 * t570 + 0.6509419717476189199e-3 * t188 * t1208 - 0.11841448143553872677e1 * t188 * t1014 * t1211 - 0.24166220701130352402e-1 * t188 * t467 * t1215 - 0.12083110350565176201e-1 * t188 * t467 * t1219 - 0.12205161970267854748e-3 * t188 * t1240;
  t1248 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t447 * t254 - t1164 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t177 * t590 + t1142 - t1171 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * t1243);
  tv3rho2sigma8 = t6 * t1248 + 0.2e1 * t595;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1255 = t5 * t102 * t614 / 0.8e1;
  t1258 = t33 * t38;
  t1259 = t306 * t229;
  t1260 = t1259 * t134;
  t1265 = t704 * t599;
  t1268 = t599 * t134;
  t1272 = t229 * t533;
  t1276 = t302 * t610;
  t1279 = t610 * t134;
  t1285 = t529 * t328;
  t1289 = 0.1e1 / t36 / t730;
  t1293 = 0.97562210117563155557e1 * t122 * t524 - 0.13741252016025379115e1 * t1285 * sigma[0] + 0.75410264051204419736e0 * t123 * t1289 * t743;
  t1294 = t115 * t1293;
  t1297 = 0.65094197174761891989e-3 * t33 * t514 - 0.24166220701130352401e-1 * t1258 * t1260 - 0.24410323940535709496e-3 * t33 * t534 + 0.32221627601507136536e-1 * t113 * t1265 - 0.11841448143553872677e1 * t113 * t712 * t1268 - 0.24166220701130352402e-1 * t113 * t307 * t1272 + 0.32547098587380945995e-3 * t113 * t1276 - 0.12083110350565176201e-1 * t113 * t307 * t1279 - 0.12205161970267854748e-3 * t113 * t1294;
  t1302 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t614 - t1255 - 0.3e1 / 0.8e1 * t5 * t27 * t1297);
  tv3rhosigma20 = t6 * t1302 + t618;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1309 = t5 * t153 * t636 / 0.8e1;
  t1311 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t636 - t1309);
  tv3rhosigma25 = t6 * t1311 + t640;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1317 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t614 - t1255);
  tv3rhosigma26 = t6 * t1317 + t618;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1324 = t33 * t69;
  t1325 = t466 * t250;
  t1326 = t1325 * t205;
  t1331 = t1006 * t621;
  t1334 = t621 * t205;
  t1338 = t250 * t586;
  t1342 = t462 * t632;
  t1345 = t632 * t205;
  t1351 = t582 * t488;
  t1355 = 0.1e1 / t67 / t1032;
  t1359 = 0.97562210117563155557e1 * t122 * t577 - 0.13741252016025379115e1 * t1351 * sigma[2] + 0.75410264051204419736e0 * t194 * t1355 * t1045;
  t1360 = t190 * t1359;
  t1363 = 0.65094197174761891989e-3 * t33 * t567 - 0.24166220701130352401e-1 * t1324 * t1326 - 0.24410323940535709496e-3 * t33 * t587 + 0.32221627601507136536e-1 * t188 * t1331 - 0.11841448143553872677e1 * t188 * t1014 * t1334 - 0.24166220701130352402e-1 * t188 * t467 * t1338 + 0.32547098587380945995e-3 * t188 * t1342 - 0.12083110350565176201e-1 * t188 * t467 * t1345 - 0.12205161970267854748e-3 * t188 * t1360;
  t1368 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t636 - t1309 - 0.3e1 / 0.8e1 * t5 * t64 * t1363);
  tv3rhosigma211 = t6 * t1368 + t640;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1374 = t599 * t229;
  t1375 = t712 * t1374;
  t1378 = t229 * t610;
  t1385 = 0.1e1 / t36 / t324;
  t1389 = 0.30917817036057103009e0 * t606 * t328 - 0.28278849019201657401e0 * sigma[0] * t1385 * t743;
  t1390 = t115 * t1389;
  t1393 = -0.36249331051695528602e-1 * t33 * t600 - 0.36615485910803564244e-3 * t33 * t611 - 0.11841448143553872677e1 * t113 * t1375 - 0.36249331051695528603e-1 * t113 * t307 * t1378 - 0.12205161970267854748e-3 * t113 * t1390;
  t1397 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1393);
  tv3sigma30 = t6 * t1397;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1402 = t621 * t250;
  t1403 = t1014 * t1402;
  t1406 = t250 * t632;
  t1413 = 0.1e1 / t67 / t484;
  t1417 = 0.30917817036057103009e0 * t628 * t488 - 0.28278849019201657401e0 * sigma[2] * t1413 * t1045;
  t1418 = t190 * t1417;
  t1421 = -0.36249331051695528602e-1 * t33 * t622 - 0.36615485910803564244e-3 * t33 * t633 - 0.11841448143553872677e1 * t188 * t1403 - 0.36249331051695528603e-1 * t188 * t467 * t1406 - 0.12205161970267854748e-3 * t188 * t1418;
  t1425 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t1421);
  tv3sigma39 = t6 * t1425;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t39;
  double t40, t42, t43, t45, t46, t48, t52, t56;
  double t57, t58, t59, t60, t61, t63, t64, t65;
  double t66, t67, t69, t70, t71, t73, t74, t76;
  double t77, t79, t83, t87, tzk0;

  double t88, t89, t90, t91, t92, t95, t96, t100;
  double t101, t102, t105, t106, t108, t109, t113, t114;
  double t115, t119, t121, t122, t123, t124, t125, t127;
  double t129, t130, t134, t135, t138, t143, t145, t148;
  double t149, t153, t156, t158, tvrho0, t161, t162, t165;
  double t166, t171, t173, t176, t177, t181, t183, t184;
  double t188, t189, t190, t194, t195, t196, t198, t200;
  double t201, t205, t206, t209, t214, tvrho1, t222, t224;
  double t229, t230, t233, t237, tvsigma0, tvsigma1, t243, t245;
  double t250, t251, t254, t258, tvsigma2;

  double t261, t262, t263, t266, t267, t268, t270, t271;
  double t275, t276, t280, t282, t288, t289, t292, t294;
  double t297, t298, t302, t303, t306, t307, t308, t309;
  double t315, t317, t322, t323, t324, t325, t328, t331;
  double t332, t335, t340, t341, t342, t343, t347, t351;
  double t352, t356, t358, t360, t363, t365, tv2rho20, t368;
  double t371, t372, t376, t377, t381, t383, t391, t392;
  double t395, t399, t400, t404, t406, t413, t416, tv2rho21;
  double t421, t425, t426, t430, t431, t437, t438, t442;
  double t446, t447, t457, t458, t462, t463, t466, t467;
  double t468, t469, t475, t477, t482, t483, t484, t485;
  double t488, t491, t492, t495, t500, tv2rho22, t508, t514;
  double t517, t524, t528, t529, t533, t534, t537, t542;
  double tv2rhosigma0, tv2rhosigma1, t549, t551, tv2rhosigma2, t557, tv2rhosigma3, tv2rhosigma4;
  double t567, t570, t577, t581, t582, t586, t587, t590;
  double t595, tv2rhosigma5, t599, t600, t606, t610, t611, t614;
  double t618, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t621, t622;
  double t628, t632, t633, t636, t640, tv2sigma25;

  double t644, t645, t648, t651, t652, t653, t655, t656;
  double t660, t661, t665, t667, t672, t674, t677, t683;
  double t684, t687, t689, t692, t695, t696, t700, t701;
  double t704, t705, t708, t711, t712, t713, t714, t717;
  double t725, t730, t731, t735, t736, t738, t740, t741;
  double t743, t746, t747, t750, t755, t757, t758, t761;
  double t765, t769, t770, t774, t776, t778, t780, t782;
  double t785, t787, tv3rho30, t790, t791, t792, t795, t800;
  double t801, t802, t803, t807, t808, t812, t815, t819;
  double t821, t825, t834, t835, t836, t839, t845, t849;
  double t850, t854, t857, t858, t860, t869, t871, t874;
  double tv3rho31, t877, t882, t885, t886, t890, t891, t895;
  double t897, t906, t907, t912, t916, t920, t921, t925;
  double t927, t934, t942, t944, t945, tv3rho32, t950, t956;
  double t957, t961, t962, t969, t970, t976, t980, t981;
  double t997, t998, t1002, t1003, t1006, t1007, t1010, t1013;
  double t1014, t1015, t1016, t1019, t1027, t1032, t1033, t1037;
  double t1038, t1040, t1042, t1043, t1045, t1048, t1049, t1052;
  double t1057, tv3rho33, t1065, t1072, t1074, t1085, t1091, t1094;
  double t1098, t1102, t1109, t1113, t1116, t1118, t1122, t1123;
  double t1126, t1131, tv3rho2sigma0, tv3rho2sigma1, t1138, t1142, t1144, tv3rho2sigma2;
  double t1150, t1158, tv3rho2sigma3, tv3rho2sigma4, t1164, t1171, t1174, tv3rho2sigma5;
  double t1182, tv3rho2sigma6, tv3rho2sigma7, t1202, t1208, t1211, t1215, t1219;
  double t1226, t1230, t1233, t1235, t1239, t1240, t1243, t1248;
  double tv3rho2sigma8, t1255, t1258, t1259, t1260, t1265, t1268, t1272;
  double t1276, t1279, t1285, t1289, t1293, t1294, t1297, t1302;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1309, t1311, tv3rhosigma25;
  double t1317, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1324, t1325;
  double t1326, t1331, t1334, t1338, t1342, t1345, t1351, t1355;
  double t1359, t1360, t1363, t1368, tv3rhosigma211, t1374, t1375, t1378;
  double t1385, t1389, t1390, t1393, t1397, tv3sigma30, tv3sigma31, tv3sigma32;
  double tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1402, t1403;
  double t1406, t1413, t1417, t1418, t1421, t1425, tv3sigma39;

  double t1429, t1433, t1436, t1440, t1444, t1448, t1452, t1456;
  double t1463, t1473, t1474, t1475, t1483, t1504, t1511, t1519;
  double t1526, t1531, t1534, t1540, t1543, t1549, t1551, t1553;
  double t1555, t1556, t1562, t1569, t1571, t1572, t1576, t1584;
  double t1585, t1586, t1588, t1589, t1595, t1601, t1605, t1612;
  double t1616, t1620, t1625, t1627, tv4rho40, t1634, t1638, t1642;
  double t1643, t1648, t1654, t1655, t1657, t1675, t1676, t1677;
  double t1678, t1682, t1699, t1700, t1718, t1722, t1729, t1733;
  double t1734, t1737, t1746, t1749, t1750, t1752, t1754, t1755;
  double tv4rho41, t1763, t1776, t1789, t1793, t1803, t1807, t1820;
  double t1821, t1830, t1843, t1847, t1854, t1858, t1867, t1870;
  double t1881, t1884, t1886, t1887, tv4rho42, t1907, t1908, t1912;
  double t1919, t1930, t1931, t1948, t1952, t1959, t1967, t1976;
  double t1986, t1988, t1989, tv4rho43, t1994, t1999, t2005, t2006;
  double t2010, t2019, t2022, t2026, t2030, t2037, t2047, t2048;
  double t2049, t2057, t2078, t2085, t2093, t2100, t2110, t2115;
  double t2121, t2125, t2141, t2142, tv4rho44, t2150, t2156, t2159;
  double t2166, t2168, t2171, t2256, t2260, t2266, tv4rho3sigma0, tv4rho3sigma1;
  double t2273, t2276, t2280, t2282, tv4rho3sigma2, t2284, t2290, t2295;
  double t2299, t2308, t2309, tv4rho3sigma3, tv4rho3sigma4, t2311, t2317, t2319;
  double t2328, t2330, t2333, tv4rho3sigma5, t2339, t2348, tv4rho3sigma6, tv4rho3sigma7;
  double t2354, t2361, t2369, t2371, t2372, tv4rho3sigma8, t2381, tv4rho3sigma9;
  double tv4rho3sigma10, t2481, t2485, t2491, tv4rho3sigma11, t2498, t2505, t2507;
  double t2558, t2566, t2597, t2603, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t2610, t2614, t2616, tv4rho2sigma25, t2622, t2630, tv4rho2sigma26;
  double tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t2636, t2643, t2646, tv4rho2sigma211;
  double t2654, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t2707, t2715;
  double t2753, t2759, tv4rho2sigma217, t2766, t2829, t2834, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, t2841;
  double t2843, tv4rhosigma39, t2849, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314;
  double tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t2916, t2921, tv4rhosigma319, t2930;
  double t2938, t2962, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45;
  double tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413;
  double t2970, t2978, t3002, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t39 = sigma[0] * t38;
  t40 = t33 * t39;
  t42 = 0.91464571985215458336e0 * t40 + 0.804e0;
  t43 = 0.1e1 / t42;
  t45 = t33 * t39 * t43;
  t46 = pow(t45, 0.1e3);
  t48 = 0.13344141567995010044e-3 * t46 - 0.1e1;
  t52 = 0.1e1 - 0.91464571985215458336e-2 * t33 * t39 * t48;
  t56 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t52);
  t57 = rho[1] <= p->dens_threshold;
  t58 = my_piecewise5(t14, t11, t10, t15, -t17);
  t59 = 0.1e1 + t58;
  t60 = t59 <= p->zeta_threshold;
  t61 = POW_1_3(t59);
  t63 = my_piecewise3(t60, t22, t61 * t59);
  t64 = t63 * t26;
  t65 = rho[1] * rho[1];
  t66 = POW_1_3(rho[1]);
  t67 = t66 * t66;
  t69 = 0.1e1 / t67 / t65;
  t70 = sigma[2] * t69;
  t71 = t33 * t70;
  t73 = 0.91464571985215458336e0 * t71 + 0.804e0;
  t74 = 0.1e1 / t73;
  t76 = t33 * t70 * t74;
  t77 = pow(t76, 0.1e3);
  t79 = 0.13344141567995010044e-3 * t77 - 0.1e1;
  t83 = 0.1e1 - 0.91464571985215458336e-2 * t33 * t70 * t79;
  t87 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t83);
  tzk0 = t56 + t87;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t88 = t6 * t6;
  t89 = 0.1e1 / t88;
  t90 = t16 * t89;
  t91 = t7 - t90;
  t92 = my_piecewise5(t10, 0, t14, 0, t91);
  t95 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t92);
  t96 = t95 * t26;
  t100 = t26 * t26;
  t101 = 0.1e1 / t100;
  t102 = t25 * t101;
  t105 = t5 * t102 * t52 / 0.8e1;
  t106 = t34 * rho[0];
  t108 = 0.1e1 / t36 / t106;
  t109 = sigma[0] * t108;
  t113 = t33 * sigma[0];
  t114 = pow(t45, 0.99e2);
  t115 = t38 * t114;
  t119 = t28 * t28;
  t121 = 0.1e1 / t30 / t29;
  t122 = t119 * t121;
  t123 = sigma[0] * sigma[0];
  t124 = t34 * t34;
  t125 = t124 * t34;
  t127 = 0.1e1 / t35 / t125;
  t129 = t42 * t42;
  t130 = 0.1e1 / t129;
  t134 = -0.8e1 / 0.3e1 * t33 * t109 * t43 + 0.2439055252939078889e1 * t122 * t123 * t127 * t130;
  t135 = t115 * t134;
  t138 = 0.2439055252939078889e-1 * t33 * t109 * t48 - 0.12205161970267854748e-3 * t113 * t135;
  t143 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t52 - t105 - 0.3e1 / 0.8e1 * t5 * t27 * t138);
  t145 = my_piecewise5(t14, 0, t10, 0, -t91);
  t148 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t145);
  t149 = t148 * t26;
  t153 = t63 * t101;
  t156 = t5 * t153 * t83 / 0.8e1;
  t158 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t83 - t156);
  tvrho0 = t56 + t87 + t6 * (t143 + t158);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t161 = -t7 - t90;
  t162 = my_piecewise5(t10, 0, t14, 0, t161);
  t165 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t162);
  t166 = t165 * t26;
  t171 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t52 - t105);
  t173 = my_piecewise5(t14, 0, t10, 0, -t161);
  t176 = my_piecewise3(t60, 0, 0.4e1 / 0.3e1 * t61 * t173);
  t177 = t176 * t26;
  t181 = t65 * rho[1];
  t183 = 0.1e1 / t67 / t181;
  t184 = sigma[2] * t183;
  t188 = t33 * sigma[2];
  t189 = pow(t76, 0.99e2);
  t190 = t69 * t189;
  t194 = sigma[2] * sigma[2];
  t195 = t65 * t65;
  t196 = t195 * t65;
  t198 = 0.1e1 / t66 / t196;
  t200 = t73 * t73;
  t201 = 0.1e1 / t200;
  t205 = -0.8e1 / 0.3e1 * t33 * t184 * t74 + 0.2439055252939078889e1 * t122 * t194 * t198 * t201;
  t206 = t190 * t205;
  t209 = 0.2439055252939078889e-1 * t33 * t184 * t79 - 0.12205161970267854748e-3 * t188 * t206;
  t214 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t83 - t156 - 0.3e1 / 0.8e1 * t5 * t64 * t209);
  tvrho1 = t56 + t87 + t6 * (t171 + t214);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t222 = t124 * rho[0];
  t224 = 0.1e1 / t35 / t222;
  t229 = t33 * t38 * t43 - 0.91464571985215458336e0 * t122 * sigma[0] * t224 * t130;
  t230 = t115 * t229;
  t233 = -0.91464571985215458336e-2 * t33 * t38 * t48 - 0.12205161970267854748e-3 * t113 * t230;
  t237 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t233);
  tvsigma0 = t6 * t237;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t243 = t195 * rho[1];
  t245 = 0.1e1 / t66 / t243;
  t250 = t33 * t69 * t74 - 0.91464571985215458336e0 * t122 * sigma[2] * t245 * t201;
  t251 = t190 * t250;
  t254 = -0.91464571985215458336e-2 * t33 * t69 * t79 - 0.12205161970267854748e-3 * t188 * t251;
  t258 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t254);
  tvsigma2 = t6 * t258;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t261 = t23 * t23;
  t262 = 0.1e1 / t261;
  t263 = t92 * t92;
  t266 = t88 * t6;
  t267 = 0.1e1 / t266;
  t268 = t16 * t267;
  t270 = -0.2e1 * t89 + 0.2e1 * t268;
  t271 = my_piecewise5(t10, 0, t14, 0, t270);
  t275 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t263 + 0.4e1 / 0.3e1 * t23 * t271);
  t276 = t275 * t26;
  t280 = t95 * t101;
  t282 = t5 * t280 * t52;
  t288 = 0.1e1 / t100 / t6;
  t289 = t25 * t288;
  t292 = t5 * t289 * t52 / 0.12e2;
  t294 = t5 * t102 * t138;
  t297 = 0.1e1 / t36 / t124;
  t298 = sigma[0] * t297;
  t302 = t108 * t114;
  t303 = t302 * t134;
  t306 = pow(t45, 0.98e2);
  t307 = t38 * t306;
  t308 = t134 * t134;
  t309 = t307 * t308;
  t315 = t124 * t106;
  t317 = 0.1e1 / t35 / t315;
  t322 = t123 * sigma[0];
  t323 = t124 * t124;
  t324 = t323 * t34;
  t325 = 0.1e1 / t324;
  t328 = 0.1e1 / t129 / t42;
  t331 = 0.88e2 / 0.9e1 * t33 * t298 * t43 - 0.21951497276451710001e2 * t122 * t123 * t317 * t130 + 0.73286677418802021954e0 * t322 * t325 * t328;
  t332 = t115 * t331;
  t335 = -0.89432025941099559263e-1 * t33 * t298 * t48 + 0.65094197174761891991e-3 * t113 * t303 - 0.12083110350565176201e-1 * t113 * t309 - 0.12205161970267854748e-3 * t113 * t332;
  t340 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t52 - t282 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t96 * t138 + t292 - t294 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t335);
  t341 = t61 * t61;
  t342 = 0.1e1 / t341;
  t343 = t145 * t145;
  t347 = my_piecewise5(t14, 0, t10, 0, -t270);
  t351 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t342 * t343 + 0.4e1 / 0.3e1 * t61 * t347);
  t352 = t351 * t26;
  t356 = t148 * t101;
  t358 = t5 * t356 * t83;
  t360 = t63 * t288;
  t363 = t5 * t360 * t83 / 0.12e2;
  t365 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t352 * t83 - t358 / 0.4e1 + t363);
  tv2rho20 = 0.2e1 * t143 + 0.2e1 * t158 + t6 * (t340 + t365);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t368 = t262 * t162;
  t371 = 0.2e1 * t268;
  t372 = my_piecewise5(t10, 0, t14, 0, t371);
  t376 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t368 * t92 + 0.4e1 / 0.3e1 * t23 * t372);
  t377 = t376 * t26;
  t381 = t165 * t101;
  t383 = t5 * t381 * t52;
  t391 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t377 * t52 - t383 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t166 * t138 - t282 / 0.8e1 + t292 - t294 / 0.8e1);
  t392 = t342 * t173;
  t395 = my_piecewise5(t14, 0, t10, 0, -t371);
  t399 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t392 * t145 + 0.4e1 / 0.3e1 * t61 * t395);
  t400 = t399 * t26;
  t404 = t176 * t101;
  t406 = t5 * t404 * t83;
  t413 = t5 * t153 * t209;
  t416 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t400 * t83 - t406 / 0.8e1 - t358 / 0.8e1 + t363 - 0.3e1 / 0.8e1 * t5 * t149 * t209 - t413 / 0.8e1);
  tv2rho21 = t143 + t158 + t171 + t214 + t6 * (t391 + t416);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t421 = t162 * t162;
  t425 = 0.2e1 * t89 + 0.2e1 * t268;
  t426 = my_piecewise5(t10, 0, t14, 0, t425);
  t430 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t262 * t421 + 0.4e1 / 0.3e1 * t23 * t426);
  t431 = t430 * t26;
  t437 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t431 * t52 - t383 / 0.4e1 + t292);
  t438 = t173 * t173;
  t442 = my_piecewise5(t14, 0, t10, 0, -t425);
  t446 = my_piecewise3(t60, 0, 0.4e1 / 0.9e1 * t342 * t438 + 0.4e1 / 0.3e1 * t61 * t442);
  t447 = t446 * t26;
  t457 = 0.1e1 / t67 / t195;
  t458 = sigma[2] * t457;
  t462 = t183 * t189;
  t463 = t462 * t205;
  t466 = pow(t76, 0.98e2);
  t467 = t69 * t466;
  t468 = t205 * t205;
  t469 = t467 * t468;
  t475 = t195 * t181;
  t477 = 0.1e1 / t66 / t475;
  t482 = t194 * sigma[2];
  t483 = t195 * t195;
  t484 = t483 * t65;
  t485 = 0.1e1 / t484;
  t488 = 0.1e1 / t200 / t73;
  t491 = 0.88e2 / 0.9e1 * t33 * t458 * t74 - 0.21951497276451710001e2 * t122 * t194 * t477 * t201 + 0.73286677418802021954e0 * t482 * t485 * t488;
  t492 = t190 * t491;
  t495 = -0.89432025941099559263e-1 * t33 * t458 * t79 + 0.65094197174761891991e-3 * t188 * t463 - 0.12083110350565176201e-1 * t188 * t469 - 0.12205161970267854748e-3 * t188 * t492;
  t500 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t447 * t83 - t406 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t177 * t209 + t363 - t413 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * t495);
  tv2rho22 = 0.2e1 * t171 + 0.2e1 * t214 + t6 * (t437 + t500);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t508 = t5 * t102 * t233 / 0.8e1;
  t514 = t302 * t229;
  t517 = t229 * t134;
  t524 = t127 * t130;
  t528 = t323 * rho[0];
  t529 = 0.1e1 / t528;
  t533 = -0.8e1 / 0.3e1 * t33 * t108 * t43 + 0.73171657588172366669e1 * t122 * t524 * sigma[0] - 0.27482504032050758232e0 * t123 * t529 * t328;
  t534 = t115 * t533;
  t537 = 0.2439055252939078889e-1 * t33 * t108 * t48 - 0.12205161970267854748e-3 * t33 * t135 + 0.32547098587380945995e-3 * t113 * t514 - 0.12083110350565176201e-1 * t113 * t307 * t517 - 0.12205161970267854748e-3 * t113 * t534;
  t542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t233 - t508 - 0.3e1 / 0.8e1 * t5 * t27 * t537);
  tv2rhosigma0 = t6 * t542 + t237;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t549 = t5 * t153 * t254 / 0.8e1;
  t551 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t254 - t549);
  tv2rhosigma2 = t6 * t551 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t557 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t233 - t508);
  tv2rhosigma3 = t6 * t557 + t237;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t567 = t462 * t250;
  t570 = t250 * t205;
  t577 = t198 * t201;
  t581 = t483 * rho[1];
  t582 = 0.1e1 / t581;
  t586 = -0.8e1 / 0.3e1 * t33 * t183 * t74 + 0.73171657588172366669e1 * t122 * t577 * sigma[2] - 0.27482504032050758232e0 * t194 * t582 * t488;
  t587 = t190 * t586;
  t590 = 0.2439055252939078889e-1 * t33 * t183 * t79 - 0.12205161970267854748e-3 * t33 * t206 + 0.32547098587380945995e-3 * t188 * t567 - 0.12083110350565176201e-1 * t188 * t467 * t570 - 0.12205161970267854748e-3 * t188 * t587;
  t595 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t254 - t549 - 0.3e1 / 0.8e1 * t5 * t64 * t590);
  tv2rhosigma5 = t6 * t595 + t258;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t599 = t229 * t229;
  t600 = t307 * t599;
  t606 = 0.1e1 / t323;
  t610 = -0.18292914397043091667e1 * t122 * t224 * t130 + 0.10305939012019034336e0 * sigma[0] * t606 * t328;
  t611 = t115 * t610;
  t614 = -0.24410323940535709496e-3 * t33 * t230 - 0.12083110350565176201e-1 * t113 * t600 - 0.12205161970267854748e-3 * t113 * t611;
  t618 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t614);
  tv2sigma20 = t6 * t618;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t621 = t250 * t250;
  t622 = t467 * t621;
  t628 = 0.1e1 / t483;
  t632 = -0.18292914397043091667e1 * t122 * t245 * t201 + 0.10305939012019034336e0 * sigma[2] * t628 * t488;
  t633 = t190 * t632;
  t636 = -0.24410323940535709496e-3 * t33 * t251 - 0.12083110350565176201e-1 * t188 * t622 - 0.12205161970267854748e-3 * t188 * t633;
  t640 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t636);
  tv2sigma25 = t6 * t640;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t644 = 0.1e1 / t261 / t19;
  t645 = t263 * t92;
  t648 = t262 * t92;
  t651 = t88 * t88;
  t652 = 0.1e1 / t651;
  t653 = t16 * t652;
  t655 = 0.6e1 * t267 - 0.6e1 * t653;
  t656 = my_piecewise5(t10, 0, t14, 0, t655);
  t660 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t644 * t645 + 0.4e1 / 0.3e1 * t648 * t271 + 0.4e1 / 0.3e1 * t23 * t656);
  t661 = t660 * t26;
  t665 = t275 * t101;
  t667 = t5 * t665 * t52;
  t672 = t95 * t288;
  t674 = t5 * t672 * t52;
  t677 = t5 * t280 * t138;
  t683 = 0.1e1 / t100 / t88;
  t684 = t25 * t683;
  t687 = 0.5e1 / 0.36e2 * t5 * t684 * t52;
  t689 = t5 * t289 * t138;
  t692 = t5 * t102 * t335;
  t695 = 0.1e1 / t36 / t222;
  t696 = sigma[0] * t695;
  t700 = t297 * t114;
  t701 = t700 * t134;
  t704 = t108 * t306;
  t705 = t704 * t308;
  t708 = t302 * t331;
  t711 = pow(t45, 0.97e2);
  t712 = t38 * t711;
  t713 = t308 * t134;
  t714 = t712 * t713;
  t717 = t134 * t331;
  t725 = 0.1e1 / t35 / t323;
  t730 = t323 * t106;
  t731 = 0.1e1 / t730;
  t735 = t123 * t123;
  t736 = t323 * t222;
  t738 = 0.1e1 / t36 / t736;
  t740 = t129 * t129;
  t741 = 0.1e1 / t740;
  t743 = t741 * t28 * t32;
  t746 = -0.1232e4 / 0.27e2 * t33 * t696 * t43 + 0.18482618694493908914e3 * t122 * t123 * t725 * t130 - 0.13924468709572384171e2 * t322 * t731 * t328 + 0.53625076658634254041e1 * t735 * t738 * t743;
  t747 = t115 * t746;
  t750 = 0.41734945439179794323e0 * t33 * t696 * t48 - 0.35801808446119040595e-2 * t113 * t701 + 0.96664882804521409607e-1 * t113 * t705 + 0.97641295762142837986e-3 * t113 * t708 - 0.11841448143553872677e1 * t113 * t714 - 0.36249331051695528603e-1 * t113 * t307 * t717 - 0.12205161970267854748e-3 * t113 * t747;
  t755 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t661 * t52 - 0.3e1 / 0.8e1 * t667 - 0.9e1 / 0.8e1 * t5 * t276 * t138 + t674 / 0.4e1 - 0.3e1 / 0.4e1 * t677 - 0.9e1 / 0.8e1 * t5 * t96 * t335 - t687 + t689 / 0.4e1 - 0.3e1 / 0.8e1 * t692 - 0.3e1 / 0.8e1 * t5 * t27 * t750);
  t757 = 0.1e1 / t341 / t59;
  t758 = t343 * t145;
  t761 = t342 * t145;
  t765 = my_piecewise5(t14, 0, t10, 0, -t655);
  t769 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t757 * t758 + 0.4e1 / 0.3e1 * t761 * t347 + 0.4e1 / 0.3e1 * t61 * t765);
  t770 = t769 * t26;
  t774 = t351 * t101;
  t776 = t5 * t774 * t83;
  t778 = t148 * t288;
  t780 = t5 * t778 * t83;
  t782 = t63 * t683;
  t785 = 0.5e1 / 0.36e2 * t5 * t782 * t83;
  t787 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t770 * t83 - 0.3e1 / 0.8e1 * t776 + t780 / 0.4e1 - t785);
  tv3rho30 = 0.3e1 * t340 + 0.3e1 * t365 + t6 * (t755 + t787);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t790 = 0.2e1 * t391;
  t791 = 0.2e1 * t416;
  t792 = t644 * t162;
  t795 = t262 * t372;
  t800 = 0.2e1 * t267;
  t801 = 0.6e1 * t653;
  t802 = t800 - t801;
  t803 = my_piecewise5(t10, 0, t14, 0, t802);
  t807 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t792 * t263 + 0.8e1 / 0.9e1 * t795 * t92 + 0.4e1 / 0.9e1 * t368 * t271 + 0.4e1 / 0.3e1 * t23 * t803);
  t808 = t807 * t26;
  t812 = t376 * t101;
  t815 = t5 * t812 * t52 / 0.4e1;
  t819 = t165 * t288;
  t821 = t5 * t819 * t52;
  t825 = t5 * t381 * t138 / 0.4e1;
  t834 = -0.3e1 / 0.8e1 * t5 * t808 * t52 - t815 - 0.3e1 / 0.4e1 * t5 * t377 * t138 + t821 / 0.12e2 - t825 - 0.3e1 / 0.8e1 * t5 * t166 * t335 - t667 / 0.8e1 + t674 / 0.6e1 - t677 / 0.4e1 - t687 + t689 / 0.6e1 - t692 / 0.8e1;
  t835 = my_piecewise3(t1, 0, t834);
  t836 = t757 * t173;
  t839 = t342 * t395;
  t845 = my_piecewise5(t14, 0, t10, 0, -t802);
  t849 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t836 * t343 + 0.8e1 / 0.9e1 * t839 * t145 + 0.4e1 / 0.9e1 * t392 * t347 + 0.4e1 / 0.3e1 * t61 * t845);
  t850 = t849 * t26;
  t854 = t399 * t101;
  t857 = t5 * t854 * t83 / 0.4e1;
  t858 = t176 * t288;
  t860 = t5 * t858 * t83;
  t869 = t5 * t356 * t209 / 0.4e1;
  t871 = t5 * t360 * t209;
  t874 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t850 * t83 - t857 + t860 / 0.12e2 - t776 / 0.8e1 + t780 / 0.6e1 - t785 - 0.3e1 / 0.8e1 * t5 * t352 * t209 - t869 + t871 / 0.12e2);
  tv3rho31 = t340 + t365 + t790 + t791 + t6 * (t835 + t874);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t877 = t644 * t421;
  t882 = t262 * t426;
  t885 = -t800 - t801;
  t886 = my_piecewise5(t10, 0, t14, 0, t885);
  t890 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t877 * t92 + 0.8e1 / 0.9e1 * t368 * t372 + 0.4e1 / 0.9e1 * t882 * t92 + 0.4e1 / 0.3e1 * t23 * t886);
  t891 = t890 * t26;
  t895 = t430 * t101;
  t897 = t5 * t895 * t52;
  t906 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t891 * t52 - t897 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t431 * t138 - t815 + t821 / 0.6e1 - t825 + t674 / 0.12e2 - t687 + t689 / 0.12e2);
  t907 = t757 * t438;
  t912 = t342 * t442;
  t916 = my_piecewise5(t14, 0, t10, 0, -t885);
  t920 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t907 * t145 + 0.8e1 / 0.9e1 * t392 * t395 + 0.4e1 / 0.9e1 * t912 * t145 + 0.4e1 / 0.3e1 * t61 * t916);
  t921 = t920 * t26;
  t925 = t446 * t101;
  t927 = t5 * t925 * t83;
  t934 = t5 * t404 * t209;
  t942 = t5 * t153 * t495;
  t944 = -0.3e1 / 0.8e1 * t5 * t921 * t83 - t927 / 0.8e1 - t857 + t860 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t400 * t209 - t934 / 0.4e1 + t780 / 0.12e2 - t785 - t869 + t871 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t149 * t495 - t942 / 0.8e1;
  t945 = my_piecewise3(t57, 0, t944);
  tv3rho32 = t790 + t791 + t437 + t500 + t6 * (t906 + t945);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t950 = t421 * t162;
  t956 = -0.6e1 * t267 - 0.6e1 * t653;
  t957 = my_piecewise5(t10, 0, t14, 0, t956);
  t961 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t644 * t950 + 0.4e1 / 0.3e1 * t368 * t426 + 0.4e1 / 0.3e1 * t23 * t957);
  t962 = t961 * t26;
  t969 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t962 * t52 - 0.3e1 / 0.8e1 * t897 + t821 / 0.4e1 - t687);
  t970 = t438 * t173;
  t976 = my_piecewise5(t14, 0, t10, 0, -t956);
  t980 = my_piecewise3(t60, 0, -0.8e1 / 0.27e2 * t757 * t970 + 0.4e1 / 0.3e1 * t392 * t442 + 0.4e1 / 0.3e1 * t61 * t976);
  t981 = t980 * t26;
  t997 = 0.1e1 / t67 / t243;
  t998 = sigma[2] * t997;
  t1002 = t457 * t189;
  t1003 = t1002 * t205;
  t1006 = t183 * t466;
  t1007 = t1006 * t468;
  t1010 = t462 * t491;
  t1013 = pow(t76, 0.97e2);
  t1014 = t69 * t1013;
  t1015 = t468 * t205;
  t1016 = t1014 * t1015;
  t1019 = t205 * t491;
  t1027 = 0.1e1 / t66 / t483;
  t1032 = t483 * t181;
  t1033 = 0.1e1 / t1032;
  t1037 = t194 * t194;
  t1038 = t483 * t243;
  t1040 = 0.1e1 / t67 / t1038;
  t1042 = t200 * t200;
  t1043 = 0.1e1 / t1042;
  t1045 = t1043 * t28 * t32;
  t1048 = -0.1232e4 / 0.27e2 * t33 * t998 * t74 + 0.18482618694493908914e3 * t122 * t194 * t1027 * t201 - 0.13924468709572384171e2 * t482 * t1033 * t488 + 0.53625076658634254041e1 * t1037 * t1040 * t1045;
  t1049 = t190 * t1048;
  t1052 = 0.41734945439179794323e0 * t33 * t998 * t79 - 0.35801808446119040595e-2 * t188 * t1003 + 0.96664882804521409607e-1 * t188 * t1007 + 0.97641295762142837986e-3 * t188 * t1010 - 0.11841448143553872677e1 * t188 * t1016 - 0.36249331051695528603e-1 * t188 * t467 * t1019 - 0.12205161970267854748e-3 * t188 * t1049;
  t1057 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t981 * t83 - 0.3e1 / 0.8e1 * t927 - 0.9e1 / 0.8e1 * t5 * t447 * t209 + t860 / 0.4e1 - 0.3e1 / 0.4e1 * t934 - 0.9e1 / 0.8e1 * t5 * t177 * t495 - t785 + t871 / 0.4e1 - 0.3e1 / 0.8e1 * t942 - 0.3e1 / 0.8e1 * t5 * t64 * t1052);
  tv3rho33 = 0.3e1 * t437 + 0.3e1 * t500 + t6 * (t969 + t1057);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1065 = t5 * t280 * t233;
  t1072 = t5 * t289 * t233 / 0.12e2;
  t1074 = t5 * t102 * t537;
  t1085 = t700 * t229;
  t1091 = t302 * t533;
  t1094 = t229 * t308;
  t1098 = t533 * t134;
  t1102 = t229 * t331;
  t1109 = t317 * t130;
  t1113 = t325 * t328;
  t1116 = t323 * t124;
  t1118 = 0.1e1 / t36 / t1116;
  t1122 = 0.88e2 / 0.9e1 * t33 * t297 * t43 - 0.52846197147013375927e2 * t122 * t1109 * sigma[0] + 0.46720256854486288995e1 * t1113 * t123 - 0.20109403746987845265e1 * t322 * t1118 * t743;
  t1123 = t115 * t1122;
  t1126 = -0.89432025941099559263e-1 * t33 * t297 * t48 + 0.65094197174761891991e-3 * t33 * t303 - 0.12083110350565176201e-1 * t33 * t309 - 0.12205161970267854748e-3 * t33 * t332 - 0.11933936148706346865e-2 * t113 * t1085 + 0.64443255203014273071e-1 * t113 * t704 * t517 + 0.6509419717476189199e-3 * t113 * t1091 - 0.11841448143553872677e1 * t113 * t712 * t1094 - 0.24166220701130352402e-1 * t113 * t307 * t1098 - 0.12083110350565176201e-1 * t113 * t307 * t1102 - 0.12205161970267854748e-3 * t113 * t1123;
  t1131 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t233 - t1065 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t96 * t537 + t1072 - t1074 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1126);
  tv3rho2sigma0 = t6 * t1131 + 0.2e1 * t542;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1138 = t5 * t356 * t254;
  t1142 = t5 * t360 * t254 / 0.12e2;
  t1144 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t352 * t254 - t1138 / 0.4e1 + t1142);
  tv3rho2sigma2 = t6 * t1144 + 0.2e1 * t551;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1150 = t5 * t381 * t233;
  t1158 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t377 * t233 - t1150 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t166 * t537 - t1065 / 0.8e1 + t1072 - t1074 / 0.8e1);
  tv3rho2sigma3 = t6 * t1158 + t542 + t557;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1164 = t5 * t404 * t254;
  t1171 = t5 * t153 * t590;
  t1174 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t400 * t254 - t1164 / 0.8e1 - t1138 / 0.8e1 + t1142 - 0.3e1 / 0.8e1 * t5 * t149 * t590 - t1171 / 0.8e1);
  tv3rho2sigma5 = t6 * t1174 + t551 + t595;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1182 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t431 * t233 - t1150 / 0.4e1 + t1072);
  tv3rho2sigma6 = t6 * t1182 + 0.2e1 * t557;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1202 = t1002 * t250;
  t1208 = t462 * t586;
  t1211 = t250 * t468;
  t1215 = t586 * t205;
  t1219 = t250 * t491;
  t1226 = t477 * t201;
  t1230 = t485 * t488;
  t1233 = t483 * t195;
  t1235 = 0.1e1 / t67 / t1233;
  t1239 = 0.88e2 / 0.9e1 * t33 * t457 * t74 - 0.52846197147013375927e2 * t122 * t1226 * sigma[2] + 0.46720256854486288995e1 * t1230 * t194 - 0.20109403746987845265e1 * t482 * t1235 * t1045;
  t1240 = t190 * t1239;
  t1243 = -0.89432025941099559263e-1 * t33 * t457 * t79 + 0.65094197174761891991e-3 * t33 * t463 - 0.12083110350565176201e-1 * t33 * t469 - 0.12205161970267854748e-3 * t33 * t492 - 0.11933936148706346865e-2 * t188 * t1202 + 0.64443255203014273071e-1 * t188 * t1006 * t570 + 0.6509419717476189199e-3 * t188 * t1208 - 0.11841448143553872677e1 * t188 * t1014 * t1211 - 0.24166220701130352402e-1 * t188 * t467 * t1215 - 0.12083110350565176201e-1 * t188 * t467 * t1219 - 0.12205161970267854748e-3 * t188 * t1240;
  t1248 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t447 * t254 - t1164 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t177 * t590 + t1142 - t1171 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * t1243);
  tv3rho2sigma8 = t6 * t1248 + 0.2e1 * t595;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1255 = t5 * t102 * t614 / 0.8e1;
  t1258 = t33 * t38;
  t1259 = t306 * t229;
  t1260 = t1259 * t134;
  t1265 = t704 * t599;
  t1268 = t599 * t134;
  t1272 = t229 * t533;
  t1276 = t302 * t610;
  t1279 = t610 * t134;
  t1285 = t529 * t328;
  t1289 = 0.1e1 / t36 / t730;
  t1293 = 0.97562210117563155557e1 * t122 * t524 - 0.13741252016025379115e1 * t1285 * sigma[0] + 0.75410264051204419736e0 * t123 * t1289 * t743;
  t1294 = t115 * t1293;
  t1297 = 0.65094197174761891989e-3 * t33 * t514 - 0.24166220701130352401e-1 * t1258 * t1260 - 0.24410323940535709496e-3 * t33 * t534 + 0.32221627601507136536e-1 * t113 * t1265 - 0.11841448143553872677e1 * t113 * t712 * t1268 - 0.24166220701130352402e-1 * t113 * t307 * t1272 + 0.32547098587380945995e-3 * t113 * t1276 - 0.12083110350565176201e-1 * t113 * t307 * t1279 - 0.12205161970267854748e-3 * t113 * t1294;
  t1302 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t614 - t1255 - 0.3e1 / 0.8e1 * t5 * t27 * t1297);
  tv3rhosigma20 = t6 * t1302 + t618;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1309 = t5 * t153 * t636 / 0.8e1;
  t1311 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t636 - t1309);
  tv3rhosigma25 = t6 * t1311 + t640;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1317 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t614 - t1255);
  tv3rhosigma26 = t6 * t1317 + t618;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1324 = t33 * t69;
  t1325 = t466 * t250;
  t1326 = t1325 * t205;
  t1331 = t1006 * t621;
  t1334 = t621 * t205;
  t1338 = t250 * t586;
  t1342 = t462 * t632;
  t1345 = t632 * t205;
  t1351 = t582 * t488;
  t1355 = 0.1e1 / t67 / t1032;
  t1359 = 0.97562210117563155557e1 * t122 * t577 - 0.13741252016025379115e1 * t1351 * sigma[2] + 0.75410264051204419736e0 * t194 * t1355 * t1045;
  t1360 = t190 * t1359;
  t1363 = 0.65094197174761891989e-3 * t33 * t567 - 0.24166220701130352401e-1 * t1324 * t1326 - 0.24410323940535709496e-3 * t33 * t587 + 0.32221627601507136536e-1 * t188 * t1331 - 0.11841448143553872677e1 * t188 * t1014 * t1334 - 0.24166220701130352402e-1 * t188 * t467 * t1338 + 0.32547098587380945995e-3 * t188 * t1342 - 0.12083110350565176201e-1 * t188 * t467 * t1345 - 0.12205161970267854748e-3 * t188 * t1360;
  t1368 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t636 - t1309 - 0.3e1 / 0.8e1 * t5 * t64 * t1363);
  tv3rhosigma211 = t6 * t1368 + t640;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1374 = t599 * t229;
  t1375 = t712 * t1374;
  t1378 = t229 * t610;
  t1385 = 0.1e1 / t36 / t324;
  t1389 = 0.30917817036057103009e0 * t606 * t328 - 0.28278849019201657401e0 * sigma[0] * t1385 * t743;
  t1390 = t115 * t1389;
  t1393 = -0.36249331051695528602e-1 * t33 * t600 - 0.36615485910803564244e-3 * t33 * t611 - 0.11841448143553872677e1 * t113 * t1375 - 0.36249331051695528603e-1 * t113 * t307 * t1378 - 0.12205161970267854748e-3 * t113 * t1390;
  t1397 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1393);
  tv3sigma30 = t6 * t1397;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1402 = t621 * t250;
  t1403 = t1014 * t1402;
  t1406 = t250 * t632;
  t1413 = 0.1e1 / t67 / t484;
  t1417 = 0.30917817036057103009e0 * t628 * t488 - 0.28278849019201657401e0 * sigma[2] * t1413 * t1045;
  t1418 = t190 * t1417;
  t1421 = -0.36249331051695528602e-1 * t33 * t622 - 0.36615485910803564244e-3 * t33 * t633 - 0.11841448143553872677e1 * t188 * t1403 - 0.36249331051695528603e-1 * t188 * t467 * t1406 - 0.12205161970267854748e-3 * t188 * t1418;
  t1425 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * t1421);
  tv3sigma39 = t6 * t1425;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1429 = 0.1e1 / t100 / t266;
  t1433 = 0.1e2 / 0.27e2 * t5 * t25 * t1429 * t52;
  t1436 = t5 * t95 * t683 * t52;
  t1440 = t5 * t660 * t101 * t52;
  t1444 = t5 * t275 * t288 * t52;
  t1448 = sigma[0] / t36 / t125;
  t1452 = t695 * t114;
  t1456 = t297 * t306;
  t1463 = t108 * t711;
  t1473 = pow(t45, 0.96e2);
  t1474 = t38 * t1473;
  t1475 = t308 * t308;
  t1483 = t331 * t331;
  t1504 = t323 * t125;
  t1511 = t323 * t323;
  t1519 = 0.1e1 / t740 / t42 * t119 * t121;
  t1526 = -0.23649802415535216783e1 * t33 * t1448 * t48 + 0.22276680810918514148e-1 * t113 * t1452 * t134 - 0.70887580723315700378e0 * t113 * t1456 * t308 - 0.7160361689223808119e-2 * t113 * t700 * t331 + 0.12630878019790797522e2 * t113 * t1463 * t713 + 0.38665953121808563843e0 * t113 * t704 * t717 + 0.13018839434952378398e-2 * t113 * t302 * t746 - 0.11486204699247256497e3 * t113 * t1474 * t1475 - 0.71048688861323236062e1 * t113 * t712 * t308 * t331 - 0.36249331051695528603e-1 * t113 * t307 * t1483 - 0.48332441402260704804e-1 * t113 * t307 * t134 * t746 - 0.12205161970267854748e-3 * t113 * t115 * (0.20944e5 / 0.81e2 * t33 * t1448 * t43 - 0.16515114123789718611e4 * t122 * t123 / t35 / t528 * t130 + 0.20870417136043286918e3 * t322 / t1116 * t328 - 0.17517525041820522987e3 * t735 / t36 / t1504 * t743 + 0.52317809965401066351e2 * t735 * sigma[0] / t35 / t1511 / rho[0] * t1519);
  t1531 = t5 * t289 * t335;
  t1534 = t5 * t102 * t750;
  t1540 = t5 * t684 * t138;
  t1543 = t5 * t665 * t138;
  t1549 = t5 * t672 * t138;
  t1551 = t5 * t280 * t335;
  t1553 = t19 * t19;
  t1555 = 0.1e1 / t261 / t1553;
  t1556 = t263 * t263;
  t1562 = t271 * t271;
  t1569 = t16 / t651 / t6;
  t1571 = -0.24e2 * t652 + 0.24e2 * t1569;
  t1572 = my_piecewise5(t10, 0, t14, 0, t1571);
  t1576 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1555 * t1556 - 0.16e2 / 0.9e1 * t644 * t263 * t271 + 0.4e1 / 0.3e1 * t262 * t1562 + 0.16e2 / 0.9e1 * t648 * t656 + 0.4e1 / 0.3e1 * t23 * t1572);
  t1584 = t1433 - 0.5e1 / 0.9e1 * t1436 - t1440 / 0.2e1 + t1444 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1526 + t1531 / 0.2e1 - t1534 / 0.2e1 - 0.3e1 / 0.2e1 * t5 * t96 * t750 - 0.5e1 / 0.9e1 * t1540 - 0.3e1 / 0.2e1 * t1543 - 0.9e1 / 0.4e1 * t5 * t276 * t335 + t1549 - 0.3e1 / 0.2e1 * t1551 - 0.3e1 / 0.8e1 * t5 * t1576 * t26 * t52 - 0.3e1 / 0.2e1 * t5 * t661 * t138;
  t1585 = my_piecewise3(t1, 0, t1584);
  t1586 = t59 * t59;
  t1588 = 0.1e1 / t341 / t1586;
  t1589 = t343 * t343;
  t1595 = t347 * t347;
  t1601 = my_piecewise5(t14, 0, t10, 0, -t1571);
  t1605 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1588 * t1589 - 0.16e2 / 0.9e1 * t757 * t343 * t347 + 0.4e1 / 0.3e1 * t342 * t1595 + 0.16e2 / 0.9e1 * t761 * t765 + 0.4e1 / 0.3e1 * t61 * t1601);
  t1612 = t5 * t769 * t101 * t83;
  t1616 = t5 * t351 * t288 * t83;
  t1620 = t5 * t148 * t683 * t83;
  t1625 = 0.1e2 / 0.27e2 * t5 * t63 * t1429 * t83;
  t1627 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t1605 * t26 * t83 - t1612 / 0.2e1 + t1616 / 0.2e1 - 0.5e1 / 0.9e1 * t1620 + t1625);
  tv4rho40 = 0.4e1 * t755 + 0.4e1 * t787 + t6 * (t1585 + t1627);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1634 = t5 * t165 * t683 * t52;
  t1638 = t5 * t807 * t101 * t52;
  t1642 = t5 * t376 * t288 * t52;
  t1643 = t1642 / 0.4e1;
  t1648 = t5 * t812 * t138;
  t1654 = t5 * t819 * t138;
  t1655 = t1654 / 0.4e1;
  t1657 = t5 * t381 * t335;
  t1675 = 0.12e2 * t652;
  t1676 = 0.24e2 * t1569;
  t1677 = -t1675 + t1676;
  t1678 = my_piecewise5(t10, 0, t14, 0, t1677);
  t1682 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1555 * t162 * t645 - 0.8e1 / 0.9e1 * t644 * t372 * t263 - 0.8e1 / 0.9e1 * t792 * t92 * t271 + 0.4e1 / 0.3e1 * t262 * t803 * t92 + 0.4e1 / 0.3e1 * t795 * t271 + 0.4e1 / 0.9e1 * t368 * t656 + 0.4e1 / 0.3e1 * t23 * t1678);
  t1699 = -0.5e1 / 0.36e2 * t1634 - 0.3e1 / 0.8e1 * t1638 + t1643 - 0.3e1 / 0.8e1 * t5 * t166 * t750 - 0.3e1 / 0.4e1 * t1648 - 0.9e1 / 0.8e1 * t5 * t377 * t335 + t1655 - 0.3e1 / 0.8e1 * t1657 - 0.3e1 / 0.8e1 * t5 * t1682 * t26 * t52 - 0.9e1 / 0.8e1 * t5 * t808 * t138 + t1433 - 0.5e1 / 0.12e2 * t1436 - t1440 / 0.8e1 + t1444 / 0.4e1 + t1531 / 0.4e1 - t1534 / 0.8e1 - 0.5e1 / 0.12e2 * t1540 - 0.3e1 / 0.8e1 * t1543 + t1549 / 0.2e1 - 0.3e1 / 0.8e1 * t1551;
  t1700 = my_piecewise3(t1, 0, t1699);
  t1718 = my_piecewise5(t14, 0, t10, 0, -t1677);
  t1722 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1588 * t173 * t758 - 0.8e1 / 0.9e1 * t757 * t395 * t343 - 0.8e1 / 0.9e1 * t836 * t145 * t347 + 0.4e1 / 0.3e1 * t342 * t845 * t145 + 0.4e1 / 0.3e1 * t839 * t347 + 0.4e1 / 0.9e1 * t392 * t765 + 0.4e1 / 0.3e1 * t61 * t1718);
  t1729 = t5 * t849 * t101 * t83;
  t1733 = t5 * t399 * t288 * t83;
  t1734 = t1733 / 0.4e1;
  t1737 = t5 * t176 * t683 * t83;
  t1746 = t5 * t774 * t209;
  t1749 = t5 * t778 * t209;
  t1750 = t1749 / 0.4e1;
  t1752 = t5 * t782 * t209;
  t1754 = -0.3e1 / 0.8e1 * t5 * t1722 * t26 * t83 - 0.3e1 / 0.8e1 * t1729 + t1734 - 0.5e1 / 0.36e2 * t1737 - t1612 / 0.8e1 + t1616 / 0.4e1 - 0.5e1 / 0.12e2 * t1620 + t1625 - 0.3e1 / 0.8e1 * t5 * t770 * t209 - 0.3e1 / 0.8e1 * t1746 + t1750 - 0.5e1 / 0.36e2 * t1752;
  t1755 = my_piecewise3(t57, 0, t1754);
  tv4rho41 = t755 + t787 + 0.3e1 * t835 + 0.3e1 * t874 + t6 * (t1700 + t1755);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1763 = t5 * t895 * t138;
  t1776 = t372 * t372;
  t1789 = my_piecewise5(t10, 0, t14, 0, t1676);
  t1793 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1555 * t421 * t263 - 0.32e2 / 0.27e2 * t792 * t92 * t372 - 0.8e1 / 0.27e2 * t877 * t271 + 0.8e1 / 0.9e1 * t262 * t1776 + 0.8e1 / 0.9e1 * t368 * t803 - 0.8e1 / 0.27e2 * t644 * t426 * t263 + 0.8e1 / 0.9e1 * t262 * t886 * t92 + 0.4e1 / 0.9e1 * t882 * t271 + 0.4e1 / 0.3e1 * t23 * t1789);
  t1803 = t5 * t890 * t101 * t52;
  t1807 = t5 * t430 * t288 * t52;
  t1820 = -t1763 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t431 * t335 - 0.3e1 / 0.8e1 * t5 * t1793 * t26 * t52 - 0.3e1 / 0.4e1 * t5 * t891 * t138 - t1803 / 0.4e1 + t1807 / 0.12e2 - 0.5e1 / 0.18e2 * t1634 - t1638 / 0.4e1 + t1642 / 0.3e1 - t1648 / 0.2e1 + t1654 / 0.3e1 - t1657 / 0.4e1 + t1433 - 0.5e1 / 0.18e2 * t1436 + t1444 / 0.12e2 + t1531 / 0.12e2 - 0.5e1 / 0.18e2 * t1540 + t1549 / 0.6e1;
  t1821 = my_piecewise3(t1, 0, t1820);
  t1830 = t395 * t395;
  t1843 = my_piecewise5(t14, 0, t10, 0, -t1676);
  t1847 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1588 * t438 * t343 - 0.32e2 / 0.27e2 * t836 * t145 * t395 - 0.8e1 / 0.27e2 * t907 * t347 + 0.8e1 / 0.9e1 * t342 * t1830 + 0.8e1 / 0.9e1 * t392 * t845 - 0.8e1 / 0.27e2 * t757 * t442 * t343 + 0.8e1 / 0.9e1 * t342 * t916 * t145 + 0.4e1 / 0.9e1 * t912 * t347 + 0.4e1 / 0.3e1 * t61 * t1843);
  t1854 = t5 * t920 * t101 * t83;
  t1858 = t5 * t446 * t288 * t83;
  t1867 = t5 * t854 * t209;
  t1870 = t5 * t858 * t209;
  t1881 = t5 * t356 * t495;
  t1884 = t5 * t360 * t495;
  t1886 = -0.3e1 / 0.8e1 * t5 * t1847 * t26 * t83 - t1854 / 0.4e1 + t1858 / 0.12e2 - t1729 / 0.4e1 + t1733 / 0.3e1 - 0.5e1 / 0.18e2 * t1737 - 0.3e1 / 0.4e1 * t5 * t850 * t209 - t1867 / 0.2e1 + t1870 / 0.6e1 + t1616 / 0.12e2 - 0.5e1 / 0.18e2 * t1620 + t1625 - t1746 / 0.4e1 + t1749 / 0.3e1 - 0.5e1 / 0.18e2 * t1752 - 0.3e1 / 0.8e1 * t5 * t352 * t495 - t1881 / 0.4e1 + t1884 / 0.12e2;
  t1887 = my_piecewise3(t57, 0, t1886);
  tv4rho42 = 0.2e1 * t835 + 0.2e1 * t874 + 0.2e1 * t906 + 0.2e1 * t945 + t6 * (t1821 + t1887);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1907 = t1675 + t1676;
  t1908 = my_piecewise5(t10, 0, t14, 0, t1907);
  t1912 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1555 * t950 * t92 - 0.8e1 / 0.9e1 * t877 * t372 - 0.8e1 / 0.9e1 * t792 * t426 * t92 + 0.4e1 / 0.3e1 * t795 * t426 + 0.4e1 / 0.3e1 * t368 * t886 + 0.4e1 / 0.9e1 * t262 * t957 * t92 + 0.4e1 / 0.3e1 * t23 * t1908);
  t1919 = t5 * t961 * t101 * t52;
  t1930 = -0.3e1 / 0.8e1 * t5 * t1912 * t26 * t52 - t1919 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t962 * t138 - 0.3e1 / 0.8e1 * t1803 + t1807 / 0.4e1 - 0.3e1 / 0.8e1 * t1763 + t1643 - 0.5e1 / 0.12e2 * t1634 + t1655 - 0.5e1 / 0.36e2 * t1436 + t1433 - 0.5e1 / 0.36e2 * t1540;
  t1931 = my_piecewise3(t1, 0, t1930);
  t1948 = my_piecewise5(t14, 0, t10, 0, -t1907);
  t1952 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1588 * t970 * t145 - 0.8e1 / 0.9e1 * t907 * t395 - 0.8e1 / 0.9e1 * t836 * t442 * t145 + 0.4e1 / 0.3e1 * t839 * t442 + 0.4e1 / 0.3e1 * t392 * t916 + 0.4e1 / 0.9e1 * t342 * t976 * t145 + 0.4e1 / 0.3e1 * t61 * t1948);
  t1959 = t5 * t980 * t101 * t83;
  t1967 = t5 * t925 * t209;
  t1976 = t5 * t404 * t495;
  t1986 = t5 * t153 * t1052;
  t1988 = -0.3e1 / 0.8e1 * t5 * t1952 * t26 * t83 - t1959 / 0.8e1 - 0.3e1 / 0.8e1 * t1854 + t1858 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t921 * t209 - 0.3e1 / 0.8e1 * t1967 + t1734 - 0.5e1 / 0.12e2 * t1737 - 0.3e1 / 0.4e1 * t1867 + t1870 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t400 * t495 - 0.3e1 / 0.8e1 * t1976 - 0.5e1 / 0.36e2 * t1620 + t1625 + t1750 - 0.5e1 / 0.12e2 * t1752 - 0.3e1 / 0.8e1 * t1881 + t1884 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t149 * t1052 - t1986 / 0.8e1;
  t1989 = my_piecewise3(t57, 0, t1988);
  tv4rho43 = 0.3e1 * t906 + 0.3e1 * t945 + t969 + t1057 + t6 * (t1931 + t1989);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1994 = t421 * t421;
  t1999 = t426 * t426;
  t2005 = 0.24e2 * t652 + 0.24e2 * t1569;
  t2006 = my_piecewise5(t10, 0, t14, 0, t2005);
  t2010 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1555 * t1994 - 0.16e2 / 0.9e1 * t877 * t426 + 0.4e1 / 0.3e1 * t262 * t1999 + 0.16e2 / 0.9e1 * t368 * t957 + 0.4e1 / 0.3e1 * t23 * t2006);
  t2019 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2010 * t26 * t52 - t1919 / 0.2e1 + t1807 / 0.2e1 - 0.5e1 / 0.9e1 * t1634 + t1433);
  t2022 = sigma[2] / t67 / t196;
  t2026 = t997 * t189;
  t2030 = t457 * t466;
  t2037 = t183 * t1013;
  t2047 = pow(t76, 0.96e2);
  t2048 = t69 * t2047;
  t2049 = t468 * t468;
  t2057 = t491 * t491;
  t2078 = t483 * t196;
  t2085 = t483 * t483;
  t2093 = 0.1e1 / t1042 / t73 * t119 * t121;
  t2100 = -0.23649802415535216783e1 * t33 * t2022 * t79 + 0.22276680810918514148e-1 * t188 * t2026 * t205 - 0.70887580723315700378e0 * t188 * t2030 * t468 - 0.7160361689223808119e-2 * t188 * t1002 * t491 + 0.12630878019790797522e2 * t188 * t2037 * t1015 + 0.38665953121808563843e0 * t188 * t1006 * t1019 + 0.13018839434952378398e-2 * t188 * t462 * t1048 - 0.11486204699247256497e3 * t188 * t2048 * t2049 - 0.71048688861323236062e1 * t188 * t1014 * t468 * t491 - 0.36249331051695528603e-1 * t188 * t467 * t2057 - 0.48332441402260704804e-1 * t188 * t467 * t205 * t1048 - 0.12205161970267854748e-3 * t188 * t190 * (0.20944e5 / 0.81e2 * t33 * t2022 * t74 - 0.16515114123789718611e4 * t122 * t194 / t66 / t581 * t201 + 0.20870417136043286918e3 * t482 / t1233 * t488 - 0.17517525041820522987e3 * t1037 / t67 / t2078 * t1045 + 0.52317809965401066351e2 * t1037 * sigma[2] / t66 / t2085 / rho[1] * t2093);
  t2110 = t438 * t438;
  t2115 = t442 * t442;
  t2121 = my_piecewise5(t14, 0, t10, 0, -t2005);
  t2125 = my_piecewise3(t60, 0, 0.4e2 / 0.81e2 * t1588 * t2110 - 0.16e2 / 0.9e1 * t907 * t442 + 0.4e1 / 0.3e1 * t342 * t2115 + 0.16e2 / 0.9e1 * t392 * t976 + 0.4e1 / 0.3e1 * t61 * t2121);
  t2141 = -0.3e1 / 0.8e1 * t5 * t64 * t2100 - 0.3e1 / 0.2e1 * t5 * t177 * t1052 - 0.9e1 / 0.4e1 * t5 * t447 * t495 - 0.3e1 / 0.8e1 * t5 * t2125 * t26 * t83 - 0.3e1 / 0.2e1 * t5 * t981 * t209 - t1986 / 0.2e1 - t1959 / 0.2e1 - 0.3e1 / 0.2e1 * t1967 - 0.3e1 / 0.2e1 * t1976 + t1884 / 0.2e1 + t1858 / 0.2e1 + t1870 - 0.5e1 / 0.9e1 * t1737 - 0.5e1 / 0.9e1 * t1752 + t1625;
  t2142 = my_piecewise3(t57, 0, t2141);
  tv4rho44 = 0.4e1 * t969 + 0.4e1 * t1057 + t6 * (t2019 + t2142);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t2150 = t5 * t665 * t233;
  t2156 = t5 * t672 * t233;
  t2159 = t5 * t280 * t537;
  t2166 = 0.5e1 / 0.36e2 * t5 * t684 * t233;
  t2168 = t5 * t289 * t537;
  t2171 = t5 * t102 * t1126;
  t2256 = t711 * t229;
  t2260 = -0.35801808446119040595e-2 * t113 * t700 * t533 - 0.11841448143553872677e1 * t33 * t714 - 0.36249331051695528603e-1 * t1258 * t306 * t134 * t331 + 0.96664882804521409607e-1 * t33 * t705 - 0.12205161970267854748e-3 * t33 * t747 + 0.41734945439179794323e0 * t33 * t695 * t48 - 0.35801808446119040595e-2 * t33 * t701 + 0.97641295762142837986e-3 * t33 * t708 + 0.94731585148430981415e1 * t113 * t1463 * t1094 - 0.11486204699247256497e3 * t113 * t1474 * t229 * t713 - 0.35524344430661618031e1 * t40 * t2256 * t717;
  t2266 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t661 * t233 - 0.3e1 / 0.8e1 * t2150 - 0.9e1 / 0.8e1 * t5 * t276 * t537 + t2156 / 0.4e1 - 0.3e1 / 0.4e1 * t2159 - 0.9e1 / 0.8e1 * t5 * t96 * t1126 - t2166 + t2168 / 0.4e1 - 0.3e1 / 0.8e1 * t2171 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.35524344430661618031e1 * t113 * t712 * t533 * t308 - 0.36249331051695528603e-1 * t113 * t307 * t1122 * t134 - 0.36249331051695528603e-1 * t113 * t307 * t533 * t331 - 0.12083110350565176201e-1 * t113 * t307 * t229 * t746 + 0.5569170202729628537e-2 * t113 * t1452 * t229 - 0.35443790361657850189e0 * t113 * t1456 * t517 + 0.19332976560904281921e0 * t113 * t704 * t1098 + 0.96664882804521409607e-1 * t113 * t704 * t1102 - 0.12205161970267854748e-3 * t113 * t115 * (-0.1232e4 / 0.27e2 * t33 * t695 * t43 + 0.4113873193290579726e3 * t122 * t725 * t130 * sigma[0] - 0.62599036961893393751e2 * t731 * t328 * t123 + 0.5965789778273060762e2 * t738 * t741 * t322 * t28 * t32 - 0.19619178737025399881e2 * t735 / t35 / t1511 * t1519) + 0.97641295762142837985e-3 * t113 * t302 * t1122 + t2260));
  tv4rho3sigma0 = t6 * t2266 + 0.3e1 * t1131;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t2273 = t5 * t774 * t254;
  t2276 = t5 * t778 * t254;
  t2280 = 0.5e1 / 0.36e2 * t5 * t782 * t254;
  t2282 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t770 * t254 - 0.3e1 / 0.8e1 * t2273 + t2276 / 0.4e1 - t2280);
  tv4rho3sigma2 = t6 * t2282 + 0.3e1 * t1144;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t2284 = 0.2e1 * t1158;
  t2290 = t5 * t812 * t233 / 0.4e1;
  t2295 = t5 * t819 * t233;
  t2299 = t5 * t381 * t537 / 0.4e1;
  t2308 = -0.3e1 / 0.8e1 * t5 * t808 * t233 - t2290 - 0.3e1 / 0.4e1 * t5 * t377 * t537 + t2295 / 0.12e2 - t2299 - 0.3e1 / 0.8e1 * t5 * t166 * t1126 - t2150 / 0.8e1 + t2156 / 0.6e1 - t2159 / 0.4e1 - t2166 + t2168 / 0.6e1 - t2171 / 0.8e1;
  t2309 = my_piecewise3(t1, 0, t2308);
  tv4rho3sigma3 = t6 * t2309 + t1131 + t2284;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t2311 = 0.2e1 * t1174;
  t2317 = t5 * t854 * t254 / 0.4e1;
  t2319 = t5 * t858 * t254;
  t2328 = t5 * t356 * t590 / 0.4e1;
  t2330 = t5 * t360 * t590;
  t2333 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t850 * t254 - t2317 + t2319 / 0.12e2 - t2273 / 0.8e1 + t2276 / 0.6e1 - t2280 - 0.3e1 / 0.8e1 * t5 * t352 * t590 - t2328 + t2330 / 0.12e2);
  tv4rho3sigma5 = t6 * t2333 + t1144 + t2311;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2339 = t5 * t895 * t233;
  t2348 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t891 * t233 - t2339 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t431 * t537 - t2290 + t2295 / 0.6e1 - t2299 + t2156 / 0.12e2 - t2166 + t2168 / 0.12e2);
  tv4rho3sigma6 = t6 * t2348 + t1182 + t2284;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2354 = t5 * t925 * t254;
  t2361 = t5 * t404 * t590;
  t2369 = t5 * t153 * t1243;
  t2371 = -0.3e1 / 0.8e1 * t5 * t921 * t254 - t2354 / 0.8e1 - t2317 + t2319 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t400 * t590 - t2361 / 0.4e1 + t2276 / 0.12e2 - t2280 - t2328 + t2330 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t149 * t1243 - t2369 / 0.8e1;
  t2372 = my_piecewise3(t57, 0, t2371);
  tv4rho3sigma8 = t6 * t2372 + t1248 + t2311;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2381 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t962 * t233 - 0.3e1 / 0.8e1 * t2339 + t2295 / 0.4e1 - t2166);
  tv4rho3sigma9 = t6 * t2381 + 0.3e1 * t1182;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2481 = t1013 * t250;
  t2485 = -0.35524344430661618031e1 * t188 * t1014 * t586 * t468 - 0.36249331051695528603e-1 * t188 * t467 * t1239 * t205 - 0.36249331051695528603e-1 * t188 * t467 * t586 * t491 - 0.12083110350565176201e-1 * t188 * t467 * t250 * t1048 + 0.5569170202729628537e-2 * t188 * t2026 * t250 - 0.35443790361657850189e0 * t188 * t2030 * t570 + 0.19332976560904281921e0 * t188 * t1006 * t1215 + 0.96664882804521409607e-1 * t188 * t1006 * t1219 + 0.94731585148430981415e1 * t188 * t2037 * t1211 - 0.11486204699247256497e3 * t188 * t2048 * t250 * t1015 - 0.35524344430661618031e1 * t71 * t2481 * t1019;
  t2491 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t981 * t254 - 0.3e1 / 0.8e1 * t2354 - 0.9e1 / 0.8e1 * t5 * t447 * t590 + t2319 / 0.4e1 - 0.3e1 / 0.4e1 * t2361 - 0.9e1 / 0.8e1 * t5 * t177 * t1243 - t2280 + t2330 / 0.4e1 - 0.3e1 / 0.8e1 * t2369 - 0.3e1 / 0.8e1 * t5 * t64 * (-0.12205161970267854748e-3 * t188 * t190 * (-0.1232e4 / 0.27e2 * t33 * t997 * t74 + 0.4113873193290579726e3 * t122 * t1027 * t201 * sigma[2] - 0.62599036961893393751e2 * t1033 * t488 * t194 + 0.5965789778273060762e2 * t1040 * t1043 * t482 * t28 * t32 - 0.19619178737025399881e2 * t1037 / t66 / t2085 * t2093) + 0.97641295762142837985e-3 * t188 * t462 * t1239 - 0.35801808446119040595e-2 * t188 * t1002 * t586 - 0.11841448143553872677e1 * t33 * t1016 - 0.36249331051695528603e-1 * t1324 * t466 * t205 * t491 + 0.96664882804521409607e-1 * t33 * t1007 + 0.41734945439179794323e0 * t33 * t997 * t79 - 0.35801808446119040595e-2 * t33 * t1003 + 0.97641295762142837986e-3 * t33 * t1010 - 0.12205161970267854748e-3 * t33 * t1049 + t2485));
  tv4rho3sigma11 = t6 * t2491 + 0.3e1 * t1248;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2498 = t5 * t280 * t614;
  t2505 = t5 * t289 * t614 / 0.12e2;
  t2507 = t5 * t102 * t1297;
  t2558 = 0.6509419717476189199e-3 * t113 * t302 * t1293 - 0.12205161970267854748e-3 * t113 * t115 * (-0.61789399741123331853e2 * t122 * t1109 + 0.15298593911174922082e2 * t1113 * sigma[0] - 0.18852566012801104935e2 * t1118 * t741 * t123 * t28 * t32 + 0.73571920263845249547e1 * t322 / t35 / t323 / t315 * t1519) - 0.48332441402260704802e-1 * t1258 * t306 * t533 * t134 - 0.24166220701130352401e-1 * t1258 * t1259 * t331 - 0.23867872297412693729e-2 * t33 * t1085 + 0.12888651040602854614e0 * t33 * t108 * t1260 + 0.13018839434952378398e-2 * t33 * t1091 - 0.24410323940535709496e-3 * t33 * t1123 - 0.24166220701130352402e-1 * t113 * t307 * t1293 * t134 - 0.12083110350565176201e-1 * t113 * t307 * t610 * t331 + 0.6315439009895398761e1 * t113 * t1463 * t1268;
  t2566 = t533 * t533;
  t2597 = 0.12888651040602854614e0 * t113 * t704 * t1272 - 0.11841448143553872677e1 * t113 * t712 * t599 * t331 - 0.24166220701130352402e-1 * t113 * t307 * t2566 - 0.24166220701130352402e-1 * t113 * t307 * t229 * t1122 - 0.11933936148706346865e-2 * t113 * t700 * t610 + 0.64443255203014273071e-1 * t113 * t704 * t1279 - 0.23682896287107745353e1 * t1258 * t2256 * t308 - 0.11814596787219283397e0 * t113 * t1456 * t599 - 0.11486204699247256497e3 * t113 * t1474 * t599 * t308 - 0.47365792574215490708e1 * t40 * t2256 * t1098 - 0.11841448143553872677e1 * t113 * t712 * t610 * t308;
  t2603 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t276 * t614 - t2498 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t96 * t1297 + t2505 - t2507 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t2558 + t2597));
  tv4rho2sigma20 = t6 * t2603 + 0.2e1 * t1302;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2610 = t5 * t356 * t636;
  t2614 = t5 * t360 * t636 / 0.12e2;
  t2616 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t352 * t636 - t2610 / 0.4e1 + t2614);
  tv4rho2sigma25 = t6 * t2616 + 0.2e1 * t1311;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2622 = t5 * t381 * t614;
  t2630 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t377 * t614 - t2622 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t166 * t1297 - t2498 / 0.8e1 + t2505 - t2507 / 0.8e1);
  tv4rho2sigma26 = t6 * t2630 + t1302 + t1317;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2636 = t5 * t404 * t636;
  t2643 = t5 * t153 * t1363;
  t2646 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t400 * t636 - t2636 / 0.8e1 - t2610 / 0.8e1 + t2614 - 0.3e1 / 0.8e1 * t5 * t149 * t1363 - t2643 / 0.8e1);
  tv4rho2sigma211 = t6 * t2646 + t1311 + t1368;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2654 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t431 * t614 - t2622 / 0.4e1 + t2505);
  tv4rho2sigma212 = t6 * t2654 + 0.2e1 * t1317;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2707 = t586 * t586;
  t2715 = -0.24410323940535709496e-3 * t33 * t1240 + 0.13018839434952378398e-2 * t33 * t1208 - 0.12205161970267854748e-3 * t188 * t190 * (-0.61789399741123331853e2 * t122 * t1226 + 0.15298593911174922082e2 * t1230 * sigma[2] - 0.18852566012801104935e2 * t1235 * t1043 * t194 * t28 * t32 + 0.73571920263845249547e1 * t482 / t66 / t483 / t475 * t2093) + 0.6509419717476189199e-3 * t188 * t462 * t1359 - 0.23867872297412693729e-2 * t33 * t1202 + 0.12888651040602854614e0 * t33 * t183 * t1326 - 0.48332441402260704802e-1 * t1324 * t466 * t586 * t205 - 0.24166220701130352401e-1 * t1324 * t1325 * t491 - 0.11841448143553872677e1 * t188 * t1014 * t621 * t491 - 0.24166220701130352402e-1 * t188 * t467 * t2707 - 0.24166220701130352402e-1 * t188 * t467 * t250 * t1239;
  t2753 = -0.11933936148706346865e-2 * t188 * t1002 * t632 + 0.64443255203014273071e-1 * t188 * t1006 * t1345 - 0.24166220701130352402e-1 * t188 * t467 * t1359 * t205 - 0.12083110350565176201e-1 * t188 * t467 * t632 * t491 - 0.23682896287107745353e1 * t1324 * t2481 * t468 - 0.11814596787219283397e0 * t188 * t2030 * t621 + 0.6315439009895398761e1 * t188 * t2037 * t1334 + 0.12888651040602854614e0 * t188 * t1006 * t1338 - 0.11486204699247256497e3 * t188 * t2048 * t621 * t468 - 0.47365792574215490708e1 * t71 * t2481 * t1215 - 0.11841448143553872677e1 * t188 * t1014 * t632 * t468;
  t2759 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t447 * t636 - t2636 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t177 * t1363 + t2614 - t2643 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t64 * (t2715 + t2753));
  tv4rho2sigma217 = t6 * t2759 + 0.2e1 * t1368;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2766 = t5 * t102 * t1393 / 0.8e1;
  t2829 = 0.96664882804521409605e-1 * t33 * t1265 - 0.3552434443066161803e1 * t1258 * t711 * t599 * t134 - 0.72498662103391057204e-1 * t1258 * t1259 * t533 + 0.97641295762142837984e-3 * t33 * t1276 - 0.36249331051695528602e-1 * t1258 * t306 * t610 * t134 - 0.36615485910803564244e-3 * t33 * t1294 + 0.31577195049476993805e1 * t113 * t1463 * t1374 - 0.11486204699247256497e3 * t113 * t1474 * t1374 * t134 - 0.35524344430661618031e1 * t113 * t712 * t599 * t533 + 0.96664882804521409608e-1 * t113 * t704 * t1378 - 0.35524344430661618031e1 * t40 * t2256 * t1279 - 0.36249331051695528603e-1 * t113 * t307 * t533 * t610 - 0.36249331051695528603e-1 * t113 * t307 * t229 * t1293 + 0.32547098587380945995e-3 * t113 * t302 * t1389 - 0.12083110350565176201e-1 * t113 * t307 * t1389 * t134 - 0.12205161970267854748e-3 * t113 * t115 * (-0.24734253628845682407e1 * t1285 + 0.52787184835843093816e1 * t1289 * t741 * t113 - 0.2758947009894196858e1 * t123 / t35 / t1504 * t1519);
  t2834 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t96 * t1393 - t2766 - 0.3e1 / 0.8e1 * t5 * t27 * t2829);
  tv4rhosigma30 = t6 * t2834 + t1397;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2841 = t5 * t153 * t1421 / 0.8e1;
  t2843 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t149 * t1421 - t2841);
  tv4rhosigma39 = t6 * t2843 + t1425;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2849 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t166 * t1393 - t2766);
  tv4rhosigma310 = t6 * t2849 + t1397;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2916 = 0.96664882804521409605e-1 * t33 * t1331 - 0.3552434443066161803e1 * t1324 * t1013 * t621 * t205 - 0.72498662103391057204e-1 * t1324 * t1325 * t586 + 0.97641295762142837984e-3 * t33 * t1342 - 0.36249331051695528602e-1 * t1324 * t466 * t632 * t205 - 0.36615485910803564244e-3 * t33 * t1360 + 0.31577195049476993805e1 * t188 * t2037 * t1402 - 0.11486204699247256497e3 * t188 * t2048 * t1402 * t205 - 0.35524344430661618031e1 * t188 * t1014 * t621 * t586 + 0.96664882804521409608e-1 * t188 * t1006 * t1406 - 0.35524344430661618031e1 * t71 * t2481 * t1345 - 0.36249331051695528603e-1 * t188 * t467 * t586 * t632 - 0.36249331051695528603e-1 * t188 * t467 * t250 * t1359 + 0.32547098587380945995e-3 * t188 * t462 * t1417 - 0.12083110350565176201e-1 * t188 * t467 * t1417 * t205 - 0.12205161970267854748e-3 * t188 * t190 * (-0.24734253628845682407e1 * t1351 + 0.52787184835843093816e1 * t1355 * t1043 * t188 - 0.2758947009894196858e1 * t194 / t66 / t2078 * t2093);
  t2921 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t177 * t1421 - t2841 - 0.3e1 / 0.8e1 * t5 * t64 * t2916);
  tv4rhosigma319 = t6 * t2921 + t1425;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2930 = t599 * t599;
  t2938 = t610 * t610;
  t2962 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (-0.47365792574215490707e1 * t33 * t1375 - 0.14499732420678211441e0 * t1258 * t1259 * t610 - 0.48820647881071418992e-3 * t33 * t1390 - 0.11486204699247256497e3 * t113 * t1474 * t2930 - 0.71048688861323236062e1 * t113 * t712 * t599 * t610 - 0.36249331051695528603e-1 * t113 * t307 * t2938 - 0.48332441402260704804e-1 * t113 * t307 * t229 * t1389 - 0.12205161970267854748e-3 * t113 * t115 * (-0.11311539607680662961e1 * t1385 * t741 * t33 + 0.10346051287103238217e1 * sigma[0] / t35 / t736 * t1519)));
  tv4sigma40 = t6 * t2962;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2970 = t621 * t621;
  t2978 = t632 * t632;
  t3002 = my_piecewise3(t57, 0, -0.3e1 / 0.8e1 * t5 * t64 * (-0.47365792574215490707e1 * t33 * t1403 - 0.14499732420678211441e0 * t1324 * t1325 * t632 - 0.48820647881071418992e-3 * t33 * t1418 - 0.11486204699247256497e3 * t188 * t2048 * t2970 - 0.71048688861323236062e1 * t188 * t1014 * t621 * t632 - 0.36249331051695528603e-1 * t188 * t467 * t2978 - 0.48332441402260704804e-1 * t188 * t467 * t250 * t1417 - 0.12205161970267854748e-3 * t188 * t190 * (-0.11311539607680662961e1 * t1413 * t1043 * t33 + 0.10346051287103238217e1 * sigma[2] / t66 / t1038 * t2093)));
  tv4sigma414 = t6 * t3002;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

