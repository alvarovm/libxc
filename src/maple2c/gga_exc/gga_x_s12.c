/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_s12.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t27, t28, t30, t31, t32, t33;
  double t35, t36, t39, t42, t43, t45, t47, t49;
  double t53, tzk0;

  gga_x_s12_params *params;

  assert(p->params != NULL);
  params = (gga_x_s12_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t19 * params->bx;
  t21 = params->C * sigma[0];
  t22 = M_CBRT2;
  t23 = t22 * t22;
  t24 = rho[0] * rho[0];
  t25 = t19 * t19;
  t27 = 0.1e1 / t25 / t24;
  t28 = t23 * t27;
  t30 = sigma[0] * sigma[0];
  t31 = params->D * t30;
  t32 = t24 * t24;
  t33 = t32 * rho[0];
  t35 = 0.1e1 / t19 / t33;
  t36 = t22 * t35;
  t39 = t21 * t28 + 0.2e1 * t31 * t36 + 0.1e1;
  t42 = params->B * (0.1e1 - 0.1e1 / t39);
  t43 = params->E * sigma[0];
  t45 = t43 * t28 + 0.1e1;
  t47 = 0.1e1 - 0.1e1 / t45;
  t49 = t42 * t47 + params->A;
  t53 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t49);
  tzk0 = 0.2e1 * t53;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t27, t28, t30, t31, t32, t33;
  double t35, t36, t39, t42, t43, t45, t47, t49;
  double t53, tzk0;

  double t55, t59, t61, t62, t64, t65, t68, t70;
  double t71, t74, t75, t77, t78, t79, t80, t83;
  double t88, tvrho0, t91, t93, t96, t97, t99, t102;
  double t106, tvsigma0;

  gga_x_s12_params *params;

  assert(p->params != NULL);
  params = (gga_x_s12_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t19 * params->bx;
  t21 = params->C * sigma[0];
  t22 = M_CBRT2;
  t23 = t22 * t22;
  t24 = rho[0] * rho[0];
  t25 = t19 * t19;
  t27 = 0.1e1 / t25 / t24;
  t28 = t23 * t27;
  t30 = sigma[0] * sigma[0];
  t31 = params->D * t30;
  t32 = t24 * t24;
  t33 = t32 * rho[0];
  t35 = 0.1e1 / t19 / t33;
  t36 = t22 * t35;
  t39 = t21 * t28 + 0.2e1 * t31 * t36 + 0.1e1;
  t42 = params->B * (0.1e1 - 0.1e1 / t39);
  t43 = params->E * sigma[0];
  t45 = t43 * t28 + 0.1e1;
  t47 = 0.1e1 - 0.1e1 / t45;
  t49 = t42 * t47 + params->A;
  t53 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t49);
  tzk0 = 0.2e1 * t53;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t55 = 0.1e1 / t25 * params->bx;
  t59 = t39 * t39;
  t61 = params->B / t59;
  t62 = t24 * rho[0];
  t64 = 0.1e1 / t25 / t62;
  t65 = t23 * t64;
  t68 = t32 * t24;
  t70 = 0.1e1 / t19 / t68;
  t71 = t22 * t70;
  t74 = -0.8e1 / 0.3e1 * t21 * t65 - 0.32e2 / 0.3e1 * t31 * t71;
  t75 = t74 * t47;
  t77 = t45 * t45;
  t78 = 0.1e1 / t77;
  t79 = t42 * t78;
  t80 = t43 * t65;
  t83 = t61 * t75 - 0.8e1 / 0.3e1 * t79 * t80;
  t88 = my_piecewise3(t2, 0, -t18 * t55 * t49 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t20 * t83);
  tvrho0 = 0.2e1 * rho[0] * t88 + 0.2e1 * t53;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t91 = params->C * t23;
  t93 = params->D * sigma[0];
  t96 = t91 * t27 + 0.4e1 * t93 * t36;
  t97 = t96 * t47;
  t99 = params->E * t23;
  t102 = t79 * t99 * t27 + t61 * t97;
  t106 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t102);
  tvsigma0 = 0.2e1 * rho[0] * t106;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t27, t28, t30, t31, t32, t33;
  double t35, t36, t39, t42, t43, t45, t47, t49;
  double t53, tzk0;

  double t55, t59, t61, t62, t64, t65, t68, t70;
  double t71, t74, t75, t77, t78, t79, t80, t83;
  double t88, tvrho0, t91, t93, t96, t97, t99, t102;
  double t106, tvsigma0;

  double t111, t120, t121, t122, t126, t127, t132, t133;
  double t136, t137, t139, t140, t144, t145, t146, t147;
  double t148, t151, t154, t159, tv2rho20, t172, t173, t175;
  double t176, t179, t180, t181, t183, t185, t191, t196;
  double tv2rhosigma0, t199, t200, t203, t207, t213, t217, tv2sigma20;

  gga_x_s12_params *params;

  assert(p->params != NULL);
  params = (gga_x_s12_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t19 * params->bx;
  t21 = params->C * sigma[0];
  t22 = M_CBRT2;
  t23 = t22 * t22;
  t24 = rho[0] * rho[0];
  t25 = t19 * t19;
  t27 = 0.1e1 / t25 / t24;
  t28 = t23 * t27;
  t30 = sigma[0] * sigma[0];
  t31 = params->D * t30;
  t32 = t24 * t24;
  t33 = t32 * rho[0];
  t35 = 0.1e1 / t19 / t33;
  t36 = t22 * t35;
  t39 = t21 * t28 + 0.2e1 * t31 * t36 + 0.1e1;
  t42 = params->B * (0.1e1 - 0.1e1 / t39);
  t43 = params->E * sigma[0];
  t45 = t43 * t28 + 0.1e1;
  t47 = 0.1e1 - 0.1e1 / t45;
  t49 = t42 * t47 + params->A;
  t53 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t49);
  tzk0 = 0.2e1 * t53;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t55 = 0.1e1 / t25 * params->bx;
  t59 = t39 * t39;
  t61 = params->B / t59;
  t62 = t24 * rho[0];
  t64 = 0.1e1 / t25 / t62;
  t65 = t23 * t64;
  t68 = t32 * t24;
  t70 = 0.1e1 / t19 / t68;
  t71 = t22 * t70;
  t74 = -0.8e1 / 0.3e1 * t21 * t65 - 0.32e2 / 0.3e1 * t31 * t71;
  t75 = t74 * t47;
  t77 = t45 * t45;
  t78 = 0.1e1 / t77;
  t79 = t42 * t78;
  t80 = t43 * t65;
  t83 = t61 * t75 - 0.8e1 / 0.3e1 * t79 * t80;
  t88 = my_piecewise3(t2, 0, -t18 * t55 * t49 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t20 * t83);
  tvrho0 = 0.2e1 * rho[0] * t88 + 0.2e1 * t53;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t91 = params->C * t23;
  t93 = params->D * sigma[0];
  t96 = t91 * t27 + 0.4e1 * t93 * t36;
  t97 = t96 * t47;
  t99 = params->E * t23;
  t102 = t79 * t99 * t27 + t61 * t97;
  t106 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t102);
  tvsigma0 = 0.2e1 * rho[0] * t106;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t111 = 0.1e1 / t25 / rho[0] * params->bx;
  t120 = params->B / t59 / t39;
  t121 = t74 * t74;
  t122 = t121 * t47;
  t126 = 0.1e1 / t25 / t32;
  t127 = t23 * t126;
  t132 = 0.1e1 / t19 / t32 / t62;
  t133 = t22 * t132;
  t136 = 0.88e2 / 0.9e1 * t21 * t127 + 0.608e3 / 0.9e1 * t31 * t133;
  t137 = t136 * t47;
  t139 = t74 * t78;
  t140 = t61 * t139;
  t144 = 0.1e1 / t77 / t45;
  t145 = t42 * t144;
  t146 = params->E * params->E;
  t147 = t146 * t30;
  t148 = t147 * t133;
  t151 = t43 * t127;
  t154 = -0.2e1 * t120 * t122 + t61 * t137 - 0.16e2 / 0.3e1 * t140 * t80 - 0.256e3 / 0.9e1 * t145 * t148 + 0.88e2 / 0.9e1 * t79 * t151;
  t159 = my_piecewise3(t2, 0, t18 * t111 * t49 / 0.12e2 - t18 * t55 * t83 / 0.4e1 - 0.3e1 / 0.8e1 * t18 * t20 * t154);
  tv2rho20 = 0.2e1 * rho[0] * t159 + 0.4e1 * t88;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t172 = -0.8e1 / 0.3e1 * t91 * t64 - 0.64e2 / 0.3e1 * t93 * t71;
  t173 = t172 * t47;
  t175 = t96 * t78;
  t176 = t61 * t175;
  t179 = t61 * t74;
  t180 = t78 * params->E;
  t181 = t180 * t28;
  t183 = t146 * t22;
  t185 = t183 * t70 * sigma[0];
  t191 = -0.2e1 * t120 * t97 * t74 + t61 * t173 - 0.8e1 / 0.3e1 * t176 * t80 + t179 * t181 + 0.32e2 / 0.3e1 * t145 * t185 - 0.8e1 / 0.3e1 * t79 * t99 * t64;
  t196 = my_piecewise3(t2, 0, -t18 * t55 * t102 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t20 * t191);
  tv2rhosigma0 = 0.2e1 * rho[0] * t196 + 0.2e1 * t106;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t199 = t96 * t96;
  t200 = t199 * t47;
  t203 = t61 * params->D;
  t207 = t61 * t96;
  t213 = -0.4e1 * t145 * t183 * t35 + 0.4e1 * t203 * t36 * t47 - 0.2e1 * t120 * t200 + 0.2e1 * t207 * t181;
  t217 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t213);
  tv2sigma20 = 0.2e1 * rho[0] * t217;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t27, t28, t30, t31, t32, t33;
  double t35, t36, t39, t42, t43, t45, t47, t49;
  double t53, tzk0;

  double t55, t59, t61, t62, t64, t65, t68, t70;
  double t71, t74, t75, t77, t78, t79, t80, t83;
  double t88, tvrho0, t91, t93, t96, t97, t99, t102;
  double t106, tvsigma0;

  double t111, t120, t121, t122, t126, t127, t132, t133;
  double t136, t137, t139, t140, t144, t145, t146, t147;
  double t148, t151, t154, t159, tv2rho20, t172, t173, t175;
  double t176, t179, t180, t181, t183, t185, t191, t196;
  double tv2rhosigma0, t199, t200, t203, t207, t213, t217, tv2sigma20;

  double t220, t230, t232, t233, t237, t241, t245, t246;
  double t249, t251, t252, t255, t259, t263, t268, t269;
  double t270, t271, t272, t273, t274, t275, t279, t282;
  double t285, t290, tv3rho30, t303, t306, t308, t318, t319;
  double t321, t322, t325, t326, t331, t334, t338, t341;
  double t342, t343, t348, t354, t359, tv3rho2sigma0, t371, t372;
  double t375, t382, t383, t384, t389, t392, t399, t400;
  double t410, t415, tv3rhosigma20, t418, t419, t422, t423, t424;
  double t427, t430, t431, t437, t438, t441, t445, tv3sigma30;

  gga_x_s12_params *params;

  assert(p->params != NULL);
  params = (gga_x_s12_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t19 * params->bx;
  t21 = params->C * sigma[0];
  t22 = M_CBRT2;
  t23 = t22 * t22;
  t24 = rho[0] * rho[0];
  t25 = t19 * t19;
  t27 = 0.1e1 / t25 / t24;
  t28 = t23 * t27;
  t30 = sigma[0] * sigma[0];
  t31 = params->D * t30;
  t32 = t24 * t24;
  t33 = t32 * rho[0];
  t35 = 0.1e1 / t19 / t33;
  t36 = t22 * t35;
  t39 = t21 * t28 + 0.2e1 * t31 * t36 + 0.1e1;
  t42 = params->B * (0.1e1 - 0.1e1 / t39);
  t43 = params->E * sigma[0];
  t45 = t43 * t28 + 0.1e1;
  t47 = 0.1e1 - 0.1e1 / t45;
  t49 = t42 * t47 + params->A;
  t53 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t49);
  tzk0 = 0.2e1 * t53;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t55 = 0.1e1 / t25 * params->bx;
  t59 = t39 * t39;
  t61 = params->B / t59;
  t62 = t24 * rho[0];
  t64 = 0.1e1 / t25 / t62;
  t65 = t23 * t64;
  t68 = t32 * t24;
  t70 = 0.1e1 / t19 / t68;
  t71 = t22 * t70;
  t74 = -0.8e1 / 0.3e1 * t21 * t65 - 0.32e2 / 0.3e1 * t31 * t71;
  t75 = t74 * t47;
  t77 = t45 * t45;
  t78 = 0.1e1 / t77;
  t79 = t42 * t78;
  t80 = t43 * t65;
  t83 = t61 * t75 - 0.8e1 / 0.3e1 * t79 * t80;
  t88 = my_piecewise3(t2, 0, -t18 * t55 * t49 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t20 * t83);
  tvrho0 = 0.2e1 * rho[0] * t88 + 0.2e1 * t53;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t91 = params->C * t23;
  t93 = params->D * sigma[0];
  t96 = t91 * t27 + 0.4e1 * t93 * t36;
  t97 = t96 * t47;
  t99 = params->E * t23;
  t102 = t79 * t99 * t27 + t61 * t97;
  t106 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t102);
  tvsigma0 = 0.2e1 * rho[0] * t106;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t111 = 0.1e1 / t25 / rho[0] * params->bx;
  t120 = params->B / t59 / t39;
  t121 = t74 * t74;
  t122 = t121 * t47;
  t126 = 0.1e1 / t25 / t32;
  t127 = t23 * t126;
  t132 = 0.1e1 / t19 / t32 / t62;
  t133 = t22 * t132;
  t136 = 0.88e2 / 0.9e1 * t21 * t127 + 0.608e3 / 0.9e1 * t31 * t133;
  t137 = t136 * t47;
  t139 = t74 * t78;
  t140 = t61 * t139;
  t144 = 0.1e1 / t77 / t45;
  t145 = t42 * t144;
  t146 = params->E * params->E;
  t147 = t146 * t30;
  t148 = t147 * t133;
  t151 = t43 * t127;
  t154 = -0.2e1 * t120 * t122 + t61 * t137 - 0.16e2 / 0.3e1 * t140 * t80 - 0.256e3 / 0.9e1 * t145 * t148 + 0.88e2 / 0.9e1 * t79 * t151;
  t159 = my_piecewise3(t2, 0, t18 * t111 * t49 / 0.12e2 - t18 * t55 * t83 / 0.4e1 - 0.3e1 / 0.8e1 * t18 * t20 * t154);
  tv2rho20 = 0.2e1 * rho[0] * t159 + 0.4e1 * t88;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t172 = -0.8e1 / 0.3e1 * t91 * t64 - 0.64e2 / 0.3e1 * t93 * t71;
  t173 = t172 * t47;
  t175 = t96 * t78;
  t176 = t61 * t175;
  t179 = t61 * t74;
  t180 = t78 * params->E;
  t181 = t180 * t28;
  t183 = t146 * t22;
  t185 = t183 * t70 * sigma[0];
  t191 = -0.2e1 * t120 * t97 * t74 + t61 * t173 - 0.8e1 / 0.3e1 * t176 * t80 + t179 * t181 + 0.32e2 / 0.3e1 * t145 * t185 - 0.8e1 / 0.3e1 * t79 * t99 * t64;
  t196 = my_piecewise3(t2, 0, -t18 * t55 * t102 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t20 * t191);
  tv2rhosigma0 = 0.2e1 * rho[0] * t196 + 0.2e1 * t106;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t199 = t96 * t96;
  t200 = t199 * t47;
  t203 = t61 * params->D;
  t207 = t61 * t96;
  t213 = -0.4e1 * t145 * t183 * t35 + 0.4e1 * t203 * t36 * t47 - 0.2e1 * t120 * t200 + 0.2e1 * t207 * t181;
  t217 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t213);
  tv2sigma20 = 0.2e1 * rho[0] * t217;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t220 = t27 * params->bx;
  t230 = t59 * t59;
  t232 = params->B / t230;
  t233 = t121 * t74;
  t237 = t75 * t136;
  t241 = t120 * t121 * t78;
  t245 = 0.1e1 / t25 / t33;
  t246 = t23 * t245;
  t249 = t32 * t32;
  t251 = 0.1e1 / t19 / t249;
  t252 = t22 * t251;
  t255 = -0.1232e4 / 0.27e2 * t21 * t246 - 0.13376e5 / 0.27e2 * t31 * t252;
  t259 = t61 * t136 * t78;
  t263 = t61 * t74 * t144;
  t268 = t77 * t77;
  t269 = 0.1e1 / t268;
  t270 = t42 * t269;
  t271 = t146 * params->E;
  t272 = t30 * sigma[0];
  t273 = t271 * t272;
  t274 = t249 * t62;
  t275 = 0.1e1 / t274;
  t279 = t147 * t252;
  t282 = t43 * t246;
  t285 = 0.6e1 * t232 * t233 * t47 - 0.6e1 * t120 * t237 + 0.16e2 * t241 * t80 + t61 * t255 * t47 - 0.8e1 * t259 * t80 - 0.256e3 / 0.3e1 * t263 * t148 + 0.88e2 / 0.3e1 * t140 * t151 - 0.4096e4 / 0.9e1 * t270 * t273 * t275 + 0.2816e4 / 0.9e1 * t145 * t279 - 0.1232e4 / 0.27e2 * t79 * t282;
  t290 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t18 * t220 * t49 + t18 * t111 * t83 / 0.4e1 - 0.3e1 / 0.8e1 * t18 * t55 * t154 - 0.3e1 / 0.8e1 * t18 * t20 * t285);
  tv3rho30 = 0.2e1 * rho[0] * t290 + 0.6e1 * t159;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t303 = t173 * t74;
  t306 = t120 * t175;
  t308 = t43 * t65 * t74;
  t318 = 0.88e2 / 0.9e1 * t91 * t126 + 0.1216e4 / 0.9e1 * t93 * t133;
  t319 = t318 * t47;
  t321 = t172 * t78;
  t322 = t61 * t321;
  t325 = t96 * t144;
  t326 = t61 * t325;
  t331 = t120 * t121;
  t334 = t61 * t136;
  t338 = t180 * t65;
  t341 = t249 * t24;
  t342 = 0.1e1 / t341;
  t343 = t271 * t342;
  t348 = t183 * t132 * sigma[0];
  t354 = 0.6e1 * t232 * t97 * t121 - 0.4e1 * t120 * t303 + 0.32e2 / 0.3e1 * t306 * t308 - 0.2e1 * t120 * t97 * t136 + t61 * t319 - 0.16e2 / 0.3e1 * t322 * t80 - 0.256e3 / 0.9e1 * t326 * t148 + 0.88e2 / 0.9e1 * t176 * t151 - 0.2e1 * t331 * t181 + t334 * t181 + 0.64e2 / 0.3e1 * t263 * t185 - 0.16e2 / 0.3e1 * t179 * t338 + 0.512e3 / 0.3e1 * t270 * t343 * t30 - 0.96e2 * t145 * t348 + 0.88e2 / 0.9e1 * t79 * t99 * t126;
  t359 = my_piecewise3(t2, 0, t18 * t111 * t102 / 0.12e2 - t18 * t55 * t191 / 0.4e1 - 0.3e1 / 0.8e1 * t18 * t20 * t354);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t359 + 0.4e1 * t196;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t371 = t199 * t78;
  t372 = t120 * t371;
  t375 = t120 * params->D;
  t382 = t249 * rho[0];
  t383 = 0.1e1 / t382;
  t384 = t383 * t78;
  t389 = t99 * t27 * t74;
  t392 = t61 * t172;
  t399 = t144 * t146;
  t400 = t399 * t36;
  t410 = 0.6e1 * t232 * t200 * t74 - 0.4e1 * t120 * t97 * t172 + 0.16e2 / 0.3e1 * t372 * t80 - 0.8e1 * t375 * t36 * t75 - 0.64e2 / 0.3e1 * t203 * t71 * t47 - 0.64e2 / 0.3e1 * t203 * t384 * t43 - 0.4e1 * t306 * t389 + 0.2e1 * t392 * t181 + 0.64e2 / 0.3e1 * t326 * t185 - 0.16e2 / 0.3e1 * t207 * t338 - 0.4e1 * t179 * t400 - 0.64e2 * t270 * t271 * t383 * sigma[0] + 0.64e2 / 0.3e1 * t145 * t183 * t70;
  t415 = my_piecewise3(t2, 0, -t18 * t55 * t213 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t20 * t410);
  tv3rhosigma20 = 0.2e1 * rho[0] * t415 + 0.2e1 * t217;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t418 = t199 * t96;
  t419 = t418 * t47;
  t422 = t120 * t96;
  t423 = t47 * params->D;
  t424 = t423 * t36;
  t427 = t120 * t199;
  t430 = 0.1e1 / t249;
  t431 = t430 * t78;
  t437 = t269 * t271;
  t438 = t437 * t430;
  t441 = 0.24e2 * t203 * t431 * params->E - 0.6e1 * t427 * t181 - 0.12e2 * t207 * t400 + 0.6e1 * t232 * t419 + 0.24e2 * t42 * t438 - 0.24e2 * t422 * t424;
  t445 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t441);
  tv3sigma30 = 0.2e1 * rho[0] * t445;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t27, t28, t30, t31, t32, t33;
  double t35, t36, t39, t42, t43, t45, t47, t49;
  double t53, tzk0;

  double t55, t59, t61, t62, t64, t65, t68, t70;
  double t71, t74, t75, t77, t78, t79, t80, t83;
  double t88, tvrho0, t91, t93, t96, t97, t99, t102;
  double t106, tvsigma0;

  double t111, t120, t121, t122, t126, t127, t132, t133;
  double t136, t137, t139, t140, t144, t145, t146, t147;
  double t148, t151, t154, t159, tv2rho20, t172, t173, t175;
  double t176, t179, t180, t181, t183, t185, t191, t196;
  double tv2rhosigma0, t199, t200, t203, t207, t213, t217, tv2sigma20;

  double t220, t230, t232, t233, t237, t241, t245, t246;
  double t249, t251, t252, t255, t259, t263, t268, t269;
  double t270, t271, t272, t273, t274, t275, t279, t282;
  double t285, t290, tv3rho30, t303, t306, t308, t318, t319;
  double t321, t322, t325, t326, t331, t334, t338, t341;
  double t342, t343, t348, t354, t359, tv3rho2sigma0, t371, t372;
  double t375, t382, t383, t384, t389, t392, t399, t400;
  double t410, t415, tv3rhosigma20, t418, t419, t422, t423, t424;
  double t427, t430, t431, t437, t438, t441, t445, tv3sigma30;

  double t463, t468, t485, t493, t497, t500, t507, t508;
  double t509, t518, t520, t536, t537, t544, t548, t553;
  double tv4rho40, t590, t615, t620, t630, t634, t649, t654;
  double t659, t662, t672, t678, tv4rho3sigma0, t700, t719, t732;
  double t736, t738, t742, t762, t765, t776, t799, t805;
  double tv4rho2sigma20, t823, t855, t858, t880, t886, tv4rhosigma30, t889;
  double t899, t902, t928, tv4sigma40;

  gga_x_s12_params *params;

  assert(p->params != NULL);
  params = (gga_x_s12_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = t19 * params->bx;
  t21 = params->C * sigma[0];
  t22 = M_CBRT2;
  t23 = t22 * t22;
  t24 = rho[0] * rho[0];
  t25 = t19 * t19;
  t27 = 0.1e1 / t25 / t24;
  t28 = t23 * t27;
  t30 = sigma[0] * sigma[0];
  t31 = params->D * t30;
  t32 = t24 * t24;
  t33 = t32 * rho[0];
  t35 = 0.1e1 / t19 / t33;
  t36 = t22 * t35;
  t39 = t21 * t28 + 0.2e1 * t31 * t36 + 0.1e1;
  t42 = params->B * (0.1e1 - 0.1e1 / t39);
  t43 = params->E * sigma[0];
  t45 = t43 * t28 + 0.1e1;
  t47 = 0.1e1 - 0.1e1 / t45;
  t49 = t42 * t47 + params->A;
  t53 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t49);
  tzk0 = 0.2e1 * t53;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t55 = 0.1e1 / t25 * params->bx;
  t59 = t39 * t39;
  t61 = params->B / t59;
  t62 = t24 * rho[0];
  t64 = 0.1e1 / t25 / t62;
  t65 = t23 * t64;
  t68 = t32 * t24;
  t70 = 0.1e1 / t19 / t68;
  t71 = t22 * t70;
  t74 = -0.8e1 / 0.3e1 * t21 * t65 - 0.32e2 / 0.3e1 * t31 * t71;
  t75 = t74 * t47;
  t77 = t45 * t45;
  t78 = 0.1e1 / t77;
  t79 = t42 * t78;
  t80 = t43 * t65;
  t83 = t61 * t75 - 0.8e1 / 0.3e1 * t79 * t80;
  t88 = my_piecewise3(t2, 0, -t18 * t55 * t49 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t20 * t83);
  tvrho0 = 0.2e1 * rho[0] * t88 + 0.2e1 * t53;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t91 = params->C * t23;
  t93 = params->D * sigma[0];
  t96 = t91 * t27 + 0.4e1 * t93 * t36;
  t97 = t96 * t47;
  t99 = params->E * t23;
  t102 = t79 * t99 * t27 + t61 * t97;
  t106 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t102);
  tvsigma0 = 0.2e1 * rho[0] * t106;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t111 = 0.1e1 / t25 / rho[0] * params->bx;
  t120 = params->B / t59 / t39;
  t121 = t74 * t74;
  t122 = t121 * t47;
  t126 = 0.1e1 / t25 / t32;
  t127 = t23 * t126;
  t132 = 0.1e1 / t19 / t32 / t62;
  t133 = t22 * t132;
  t136 = 0.88e2 / 0.9e1 * t21 * t127 + 0.608e3 / 0.9e1 * t31 * t133;
  t137 = t136 * t47;
  t139 = t74 * t78;
  t140 = t61 * t139;
  t144 = 0.1e1 / t77 / t45;
  t145 = t42 * t144;
  t146 = params->E * params->E;
  t147 = t146 * t30;
  t148 = t147 * t133;
  t151 = t43 * t127;
  t154 = -0.2e1 * t120 * t122 + t61 * t137 - 0.16e2 / 0.3e1 * t140 * t80 - 0.256e3 / 0.9e1 * t145 * t148 + 0.88e2 / 0.9e1 * t79 * t151;
  t159 = my_piecewise3(t2, 0, t18 * t111 * t49 / 0.12e2 - t18 * t55 * t83 / 0.4e1 - 0.3e1 / 0.8e1 * t18 * t20 * t154);
  tv2rho20 = 0.2e1 * rho[0] * t159 + 0.4e1 * t88;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t172 = -0.8e1 / 0.3e1 * t91 * t64 - 0.64e2 / 0.3e1 * t93 * t71;
  t173 = t172 * t47;
  t175 = t96 * t78;
  t176 = t61 * t175;
  t179 = t61 * t74;
  t180 = t78 * params->E;
  t181 = t180 * t28;
  t183 = t146 * t22;
  t185 = t183 * t70 * sigma[0];
  t191 = -0.2e1 * t120 * t97 * t74 + t61 * t173 - 0.8e1 / 0.3e1 * t176 * t80 + t179 * t181 + 0.32e2 / 0.3e1 * t145 * t185 - 0.8e1 / 0.3e1 * t79 * t99 * t64;
  t196 = my_piecewise3(t2, 0, -t18 * t55 * t102 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t20 * t191);
  tv2rhosigma0 = 0.2e1 * rho[0] * t196 + 0.2e1 * t106;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t199 = t96 * t96;
  t200 = t199 * t47;
  t203 = t61 * params->D;
  t207 = t61 * t96;
  t213 = -0.4e1 * t145 * t183 * t35 + 0.4e1 * t203 * t36 * t47 - 0.2e1 * t120 * t200 + 0.2e1 * t207 * t181;
  t217 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t213);
  tv2sigma20 = 0.2e1 * rho[0] * t217;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t220 = t27 * params->bx;
  t230 = t59 * t59;
  t232 = params->B / t230;
  t233 = t121 * t74;
  t237 = t75 * t136;
  t241 = t120 * t121 * t78;
  t245 = 0.1e1 / t25 / t33;
  t246 = t23 * t245;
  t249 = t32 * t32;
  t251 = 0.1e1 / t19 / t249;
  t252 = t22 * t251;
  t255 = -0.1232e4 / 0.27e2 * t21 * t246 - 0.13376e5 / 0.27e2 * t31 * t252;
  t259 = t61 * t136 * t78;
  t263 = t61 * t74 * t144;
  t268 = t77 * t77;
  t269 = 0.1e1 / t268;
  t270 = t42 * t269;
  t271 = t146 * params->E;
  t272 = t30 * sigma[0];
  t273 = t271 * t272;
  t274 = t249 * t62;
  t275 = 0.1e1 / t274;
  t279 = t147 * t252;
  t282 = t43 * t246;
  t285 = 0.6e1 * t232 * t233 * t47 - 0.6e1 * t120 * t237 + 0.16e2 * t241 * t80 + t61 * t255 * t47 - 0.8e1 * t259 * t80 - 0.256e3 / 0.3e1 * t263 * t148 + 0.88e2 / 0.3e1 * t140 * t151 - 0.4096e4 / 0.9e1 * t270 * t273 * t275 + 0.2816e4 / 0.9e1 * t145 * t279 - 0.1232e4 / 0.27e2 * t79 * t282;
  t290 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t18 * t220 * t49 + t18 * t111 * t83 / 0.4e1 - 0.3e1 / 0.8e1 * t18 * t55 * t154 - 0.3e1 / 0.8e1 * t18 * t20 * t285);
  tv3rho30 = 0.2e1 * rho[0] * t290 + 0.6e1 * t159;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t303 = t173 * t74;
  t306 = t120 * t175;
  t308 = t43 * t65 * t74;
  t318 = 0.88e2 / 0.9e1 * t91 * t126 + 0.1216e4 / 0.9e1 * t93 * t133;
  t319 = t318 * t47;
  t321 = t172 * t78;
  t322 = t61 * t321;
  t325 = t96 * t144;
  t326 = t61 * t325;
  t331 = t120 * t121;
  t334 = t61 * t136;
  t338 = t180 * t65;
  t341 = t249 * t24;
  t342 = 0.1e1 / t341;
  t343 = t271 * t342;
  t348 = t183 * t132 * sigma[0];
  t354 = 0.6e1 * t232 * t97 * t121 - 0.4e1 * t120 * t303 + 0.32e2 / 0.3e1 * t306 * t308 - 0.2e1 * t120 * t97 * t136 + t61 * t319 - 0.16e2 / 0.3e1 * t322 * t80 - 0.256e3 / 0.9e1 * t326 * t148 + 0.88e2 / 0.9e1 * t176 * t151 - 0.2e1 * t331 * t181 + t334 * t181 + 0.64e2 / 0.3e1 * t263 * t185 - 0.16e2 / 0.3e1 * t179 * t338 + 0.512e3 / 0.3e1 * t270 * t343 * t30 - 0.96e2 * t145 * t348 + 0.88e2 / 0.9e1 * t79 * t99 * t126;
  t359 = my_piecewise3(t2, 0, t18 * t111 * t102 / 0.12e2 - t18 * t55 * t191 / 0.4e1 - 0.3e1 / 0.8e1 * t18 * t20 * t354);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t359 + 0.4e1 * t196;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t371 = t199 * t78;
  t372 = t120 * t371;
  t375 = t120 * params->D;
  t382 = t249 * rho[0];
  t383 = 0.1e1 / t382;
  t384 = t383 * t78;
  t389 = t99 * t27 * t74;
  t392 = t61 * t172;
  t399 = t144 * t146;
  t400 = t399 * t36;
  t410 = 0.6e1 * t232 * t200 * t74 - 0.4e1 * t120 * t97 * t172 + 0.16e2 / 0.3e1 * t372 * t80 - 0.8e1 * t375 * t36 * t75 - 0.64e2 / 0.3e1 * t203 * t71 * t47 - 0.64e2 / 0.3e1 * t203 * t384 * t43 - 0.4e1 * t306 * t389 + 0.2e1 * t392 * t181 + 0.64e2 / 0.3e1 * t326 * t185 - 0.16e2 / 0.3e1 * t207 * t338 - 0.4e1 * t179 * t400 - 0.64e2 * t270 * t271 * t383 * sigma[0] + 0.64e2 / 0.3e1 * t145 * t183 * t70;
  t415 = my_piecewise3(t2, 0, -t18 * t55 * t213 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t20 * t410);
  tv3rhosigma20 = 0.2e1 * rho[0] * t415 + 0.2e1 * t217;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t418 = t199 * t96;
  t419 = t418 * t47;
  t422 = t120 * t96;
  t423 = t47 * params->D;
  t424 = t423 * t36;
  t427 = t120 * t199;
  t430 = 0.1e1 / t249;
  t431 = t430 * t78;
  t437 = t269 * t271;
  t438 = t437 * t430;
  t441 = 0.24e2 * t203 * t431 * params->E - 0.6e1 * t427 * t181 - 0.12e2 * t207 * t400 + 0.6e1 * t232 * t419 + 0.24e2 * t42 * t438 - 0.24e2 * t422 * t424;
  t445 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * t441);
  tv3sigma30 = 0.2e1 * rho[0] * t445;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t463 = t23 / t25 / t68;
  t468 = t22 / t19 / t382;
  t485 = t120 * t121 * t144;
  t493 = t61 * t136 * t144;
  t497 = t437 * t272 * t275;
  t500 = t249 * t32;
  t507 = t42 / t268 / t45;
  t508 = t146 * t146;
  t509 = t30 * t30;
  t518 = t120 * t139;
  t520 = t43 * t65 * t136;
  t536 = params->B / t230 / t39;
  t537 = t121 * t121;
  t544 = t136 * t136;
  t548 = t61 * (0.20944e5 / 0.81e2 * t21 * t463 + 0.3344e6 / 0.81e2 * t31 * t468) * t47 - 0.250624e6 / 0.81e2 * t145 * t147 * t468 + 0.20944e5 / 0.81e2 * t79 * t43 * t463 - 0.64e2 * t232 * t233 * t78 * t80 + 0.1024e4 / 0.3e1 * t485 * t148 - 0.32e2 / 0.3e1 * t61 * t255 * t78 * t80 - 0.512e3 / 0.3e1 * t493 * t148 - 0.16384e5 / 0.9e1 * t179 * t497 + 0.90112e5 / 0.9e1 * t270 * t273 / t500 - 0.131072e6 / 0.27e2 * t507 * t508 * t509 / t25 / t249 / t68 * t23 + 0.64e2 * t518 * t520 - 0.352e3 / 0.3e1 * t241 * t151 + 0.176e3 / 0.3e1 * t259 * t151 + 0.11264e5 / 0.9e1 * t263 * t279 - 0.4928e4 / 0.27e2 * t140 * t282 - 0.8e1 * t120 * t75 * t255 - 0.24e2 * t536 * t537 * t47 + 0.36e2 * t232 * t122 * t136 - 0.6e1 * t120 * t544 * t47;
  t553 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t18 * t64 * params->bx * t49 - 0.5e1 / 0.9e1 * t18 * t220 * t83 + t18 * t111 * t154 / 0.2e1 - t18 * t55 * t285 / 0.2e1 - 0.3e1 / 0.8e1 * t18 * t20 * t548);
  tv4rho40 = 0.2e1 * rho[0] * t553 + 0.8e1 * t290;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t590 = t180 * t127;
  t615 = t437 * t342 * t30;
  t620 = t61 * (-0.1232e4 / 0.27e2 * t91 * t245 - 0.26752e5 / 0.27e2 * t93 * t252) * t47 - 0.6e1 * t120 * t173 * t136 - 0.2e1 * t120 * t97 * t255 + 0.18e2 * t232 * t173 * t121 - 0.6e1 * t120 * t319 * t74 - 0.24e2 * t536 * t97 * t233 - 0.8e1 * t334 * t338 + 0.88e2 / 0.3e1 * t179 * t590 + 0.21824e5 / 0.27e2 * t145 * t183 * t251 * sigma[0] + 0.6e1 * t232 * t233 * t181 + 0.16e2 * t331 * t338 + 0.16384e5 / 0.9e1 * t507 * t508 / t25 / t249 / t33 * t272 * t23 - 0.4096e4 / 0.9e1 * t207 * t497 + t61 * t255 * t181 + 0.512e3 * t179 * t615 + 0.2816e4 / 0.9e1 * t326 * t279;
  t630 = t61 * t172 * t144;
  t634 = t99 * t27 * t136;
  t649 = t120 * t325;
  t654 = t232 * t175;
  t659 = t120 * t321;
  t662 = t232 * t96;
  t672 = -0.1232e4 / 0.27e2 * t176 * t282 + 0.32e2 * t493 * t185 - 0.8e1 * t61 * t318 * t78 * t80 - 0.256e3 / 0.3e1 * t630 * t148 - 0.6e1 * t518 * t634 - 0.64e2 * t485 * t185 - 0.288e3 * t263 * t348 + 0.88e2 / 0.3e1 * t322 * t151 - 0.176e3 / 0.3e1 * t306 * t43 * t127 * t74 + 0.16e2 * t306 * t520 + 0.512e3 / 0.3e1 * t649 * t147 * t133 * t74 - 0.48e2 * t654 * t43 * t65 * t121 + 0.32e2 * t659 * t308 + 0.18e2 * t662 * t237 - 0.9728e4 / 0.3e1 * t270 * t271 * t275 * t30 - 0.1232e4 / 0.27e2 * t79 * t99 * t245;
  t678 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t18 * t220 * t102 + t18 * t111 * t191 / 0.4e1 - 0.3e1 / 0.8e1 * t18 * t55 * t354 - 0.3e1 / 0.8e1 * t18 * t20 * (t620 + t672));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t678 + 0.6e1 * t359;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t700 = t172 * t172;
  t719 = t399 * t71;
  t732 = t437 * t383 * sigma[0];
  t736 = 0.1e1 / t25 / t500;
  t738 = t30 * t23;
  t742 = -0.176e3 / 0.9e1 * t372 * t151 + 0.12e2 * t654 * t99 * t27 * t121 + 0.64e2 / 0.3e1 * t306 * t99 * t64 * t74 - 0.192e3 * t326 * t348 - 0.4e1 * t120 * t700 * t47 + 0.6e1 * t232 * t200 * t136 - 0.4e1 * t120 * t97 * t318 - 0.24e2 * t536 * t200 * t121 - 0.32e2 / 0.3e1 * t392 * t338 + 0.176e3 / 0.9e1 * t207 * t590 + 0.8e1 * t331 * t400 + 0.128e3 / 0.3e1 * t179 * t719 + 0.24e2 * t232 * params->D * t36 * t122 + 0.256e3 / 0.3e1 * t375 * t71 * t75 - 0.4e1 * t334 * t400 - 0.128e3 * t179 * t732 - 0.2048e4 / 0.3e1 * t507 * t508 * t736 * t738;
  t762 = t120 * t199 * t144;
  t765 = params->D * t383;
  t776 = t232 * t371;
  t799 = -0.8e1 * t375 * t36 * t137 + 0.2752e4 / 0.9e1 * t203 * t342 * t78 * t43 + 0.2e1 * t61 * t318 * t181 + 0.1024e4 / 0.3e1 * t207 * t615 - 0.8e1 * t659 * t389 - 0.4e1 * t306 * t634 + 0.128e3 / 0.3e1 * t630 * t185 + 0.512e3 / 0.9e1 * t762 * t148 + 0.256e3 / 0.3e1 * t120 * t765 * t180 * sigma[0] * t74 - 0.1024e4 / 0.9e1 * t61 * params->D * t736 * t399 * t738 - 0.32e2 * t776 * t308 + 0.64e2 / 0.3e1 * t306 * t43 * t65 * t172 - 0.256e3 / 0.3e1 * t649 * t183 * t70 * t74 * sigma[0] + 0.24e2 * t662 * t303 + 0.2752e4 / 0.3e1 * t270 * t343 * sigma[0] - 0.1216e4 / 0.9e1 * t145 * t183 * t132 + 0.1216e4 / 0.9e1 * t203 * t133 * t47;
  t805 = my_piecewise3(t2, 0, t18 * t111 * t213 / 0.12e2 - t18 * t55 * t410 / 0.4e1 - 0.3e1 / 0.8e1 * t18 * t20 * (t742 + t799));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t805 + 0.4e1 * t415;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t823 = t35 * t74;
  t855 = 0.1e1 / t25 / t274;
  t858 = sigma[0] * t23;
  t880 = 0.128e3 * t61 * params->D * t855 * t399 * t858 - 0.48e2 * t375 * t431 * params->E * t74 + 0.256e3 * t507 * t508 * t855 * t858 + 0.24e2 * t649 * t183 * t823 - 0.192e3 * t203 * t384 * params->E - 0.192e3 * t42 * t437 * t383 + 0.24e2 * t179 * t438 + 0.64e2 * t207 * t719 - 0.192e3 * t207 * t732 + 0.16e2 * t427 * t338 - 0.12e2 * t392 * t400;
  t886 = my_piecewise3(t2, 0, -t18 * t55 * t441 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t20 * (0.72e2 * t232 * t97 * params->D * t22 * t823 - 0.12e2 * t306 * t99 * t27 * t172 - 0.16e2 * t232 * t418 * t78 * t80 - 0.24e2 * t120 * t172 * t424 + 0.18e2 * t232 * t200 * t172 + 0.128e3 * t306 * t43 * t765 - 0.24e2 * t536 * t419 * t74 + 0.128e3 * t422 * t423 * t71 - 0.64e2 * t762 * t185 + 0.18e2 * t776 * t389 + t880));
  tv4rhosigma30 = 0.2e1 * rho[0] * t886 + 0.2e1 * t445;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t889 = t199 * t199;
  t899 = params->D * params->D;
  t902 = 0.1e1 / t25 / t341;
  t928 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t20 * (-0.96e2 * t120 * t899 * t23 * t902 * t47 - 0.96e2 * t203 * t902 * t144 * t146 * t23 - 0.192e3 * t422 * t180 * t430 * params->D - 0.96e2 * t507 * t508 * t902 * t23 + 0.24e2 * t232 * t418 * t181 + 0.144e3 * t232 * t199 * t424 - 0.24e2 * t536 * t889 * t47 + 0.96e2 * t207 * t438 + 0.48e2 * t427 * t400));
  tv4sigma40 = 0.2e1 * rho[0] * t928;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t36, t37, t38, t39, t41;
  double t43, t46, t47, t49, t51, t53, t54, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66;
  double t67, t68, t69, t71, t73, t74, t75, t76;
  double t78, t80, t83, t84, t86, t88, t90, t91;
  double t94, tzk0;

  gga_x_s12_params *params;

  assert(p->params != NULL);
  params = (gga_x_s12_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t27 * params->bx;
  t29 = params->C * sigma[0];
  t30 = rho[0] * rho[0];
  t31 = POW_1_3(rho[0]);
  t32 = t31 * t31;
  t34 = 0.1e1 / t32 / t30;
  t36 = sigma[0] * sigma[0];
  t37 = params->D * t36;
  t38 = t30 * t30;
  t39 = t38 * rho[0];
  t41 = 0.1e1 / t31 / t39;
  t43 = t29 * t34 + t37 * t41 + 0.1e1;
  t46 = params->B * (0.1e1 - 0.1e1 / t43);
  t47 = params->E * sigma[0];
  t49 = t47 * t34 + 0.1e1;
  t51 = 0.1e1 - 0.1e1 / t49;
  t53 = t46 * t51 + params->A;
  t54 = t28 * t53;
  t57 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t54);
  t58 = rho[1] <= p->dens_threshold;
  t59 = my_piecewise5(t14, t11, t10, t15, -t17);
  t60 = 0.1e1 + t59;
  t61 = t60 <= p->zeta_threshold;
  t62 = POW_1_3(t60);
  t64 = my_piecewise3(t61, t22, t62 * t60);
  t65 = t5 * t64;
  t66 = params->C * sigma[2];
  t67 = rho[1] * rho[1];
  t68 = POW_1_3(rho[1]);
  t69 = t68 * t68;
  t71 = 0.1e1 / t69 / t67;
  t73 = sigma[2] * sigma[2];
  t74 = params->D * t73;
  t75 = t67 * t67;
  t76 = t75 * rho[1];
  t78 = 0.1e1 / t68 / t76;
  t80 = t66 * t71 + t74 * t78 + 0.1e1;
  t83 = params->B * (0.1e1 - 0.1e1 / t80);
  t84 = params->E * sigma[2];
  t86 = t84 * t71 + 0.1e1;
  t88 = 0.1e1 - 0.1e1 / t86;
  t90 = t83 * t88 + params->A;
  t91 = t28 * t90;
  t94 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t91);
  tzk0 = t57 + t94;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t36, t37, t38, t39, t41;
  double t43, t46, t47, t49, t51, t53, t54, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66;
  double t67, t68, t69, t71, t73, t74, t75, t76;
  double t78, t80, t83, t84, t86, t88, t90, t91;
  double t94, tzk0;

  double t95, t96, t97, t98, t99, t102, t103, t106;
  double t108, t109, t111, t112, t114, t115, t117, t120;
  double t122, t125, t126, t128, t129, t130, t134, t135;
  double t139, t141, t144, t145, t148, t150, t152, tvrho0;
  double t155, t156, t159, t160, t164, t166, t169, t170;
  double t173, t175, t176, t178, t181, t183, t186, t187;
  double t189, t190, t191, t195, t196, t200, tvrho1, t204;
  double t207, t208, t210, t211, t213, t214, t217, tvsigma0;
  double tvsigma1, t219, t222, t223, t225, t226, t228, t229;
  double t232, tvsigma2;

  gga_x_s12_params *params;

  assert(p->params != NULL);
  params = (gga_x_s12_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t27 * params->bx;
  t29 = params->C * sigma[0];
  t30 = rho[0] * rho[0];
  t31 = POW_1_3(rho[0]);
  t32 = t31 * t31;
  t34 = 0.1e1 / t32 / t30;
  t36 = sigma[0] * sigma[0];
  t37 = params->D * t36;
  t38 = t30 * t30;
  t39 = t38 * rho[0];
  t41 = 0.1e1 / t31 / t39;
  t43 = t29 * t34 + t37 * t41 + 0.1e1;
  t46 = params->B * (0.1e1 - 0.1e1 / t43);
  t47 = params->E * sigma[0];
  t49 = t47 * t34 + 0.1e1;
  t51 = 0.1e1 - 0.1e1 / t49;
  t53 = t46 * t51 + params->A;
  t54 = t28 * t53;
  t57 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t54);
  t58 = rho[1] <= p->dens_threshold;
  t59 = my_piecewise5(t14, t11, t10, t15, -t17);
  t60 = 0.1e1 + t59;
  t61 = t60 <= p->zeta_threshold;
  t62 = POW_1_3(t60);
  t64 = my_piecewise3(t61, t22, t62 * t60);
  t65 = t5 * t64;
  t66 = params->C * sigma[2];
  t67 = rho[1] * rho[1];
  t68 = POW_1_3(rho[1]);
  t69 = t68 * t68;
  t71 = 0.1e1 / t69 / t67;
  t73 = sigma[2] * sigma[2];
  t74 = params->D * t73;
  t75 = t67 * t67;
  t76 = t75 * rho[1];
  t78 = 0.1e1 / t68 / t76;
  t80 = t66 * t71 + t74 * t78 + 0.1e1;
  t83 = params->B * (0.1e1 - 0.1e1 / t80);
  t84 = params->E * sigma[2];
  t86 = t84 * t71 + 0.1e1;
  t88 = 0.1e1 - 0.1e1 / t86;
  t90 = t83 * t88 + params->A;
  t91 = t28 * t90;
  t94 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t91);
  tzk0 = t57 + t94;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t95 = t6 * t6;
  t96 = 0.1e1 / t95;
  t97 = t16 * t96;
  t98 = t7 - t97;
  t99 = my_piecewise5(t10, 0, t14, 0, t98);
  t102 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t99);
  t103 = t5 * t102;
  t106 = t27 * t27;
  t108 = 0.1e1 / t106 * params->bx;
  t109 = t108 * t53;
  t111 = t26 * t109 / 0.8e1;
  t112 = t43 * t43;
  t114 = params->B / t112;
  t115 = t30 * rho[0];
  t117 = 0.1e1 / t32 / t115;
  t120 = t38 * t30;
  t122 = 0.1e1 / t31 / t120;
  t125 = -0.8e1 / 0.3e1 * t29 * t117 - 0.16e2 / 0.3e1 * t37 * t122;
  t126 = t125 * t51;
  t128 = t49 * t49;
  t129 = 0.1e1 / t128;
  t130 = t46 * t129;
  t134 = t114 * t126 - 0.8e1 / 0.3e1 * t130 * t47 * t117;
  t135 = t28 * t134;
  t139 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t103 * t54 - t111 - 0.3e1 / 0.8e1 * t26 * t135);
  t141 = my_piecewise5(t14, 0, t10, 0, -t98);
  t144 = my_piecewise3(t61, 0, 0.4e1 / 0.3e1 * t62 * t141);
  t145 = t5 * t144;
  t148 = t108 * t90;
  t150 = t65 * t148 / 0.8e1;
  t152 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t145 * t91 - t150);
  tvrho0 = t57 + t94 + t6 * (t139 + t152);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t155 = -t7 - t97;
  t156 = my_piecewise5(t10, 0, t14, 0, t155);
  t159 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t156);
  t160 = t5 * t159;
  t164 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t160 * t54 - t111);
  t166 = my_piecewise5(t14, 0, t10, 0, -t155);
  t169 = my_piecewise3(t61, 0, 0.4e1 / 0.3e1 * t62 * t166);
  t170 = t5 * t169;
  t173 = t80 * t80;
  t175 = params->B / t173;
  t176 = t67 * rho[1];
  t178 = 0.1e1 / t69 / t176;
  t181 = t75 * t67;
  t183 = 0.1e1 / t68 / t181;
  t186 = -0.8e1 / 0.3e1 * t66 * t178 - 0.16e2 / 0.3e1 * t74 * t183;
  t187 = t186 * t88;
  t189 = t86 * t86;
  t190 = 0.1e1 / t189;
  t191 = t83 * t190;
  t195 = t175 * t187 - 0.8e1 / 0.3e1 * t191 * t84 * t178;
  t196 = t28 * t195;
  t200 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t170 * t91 - t150 - 0.3e1 / 0.8e1 * t65 * t196);
  tvrho1 = t57 + t94 + t6 * (t164 + t200);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t204 = params->D * sigma[0];
  t207 = 0.2e1 * t204 * t41 + params->C * t34;
  t208 = t207 * t51;
  t210 = t129 * params->E;
  t211 = t210 * t34;
  t213 = t114 * t208 + t46 * t211;
  t214 = t28 * t213;
  t217 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t214);
  tvsigma0 = t6 * t217;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t219 = params->D * sigma[2];
  t222 = 0.2e1 * t219 * t78 + params->C * t71;
  t223 = t222 * t88;
  t225 = t190 * params->E;
  t226 = t225 * t71;
  t228 = t175 * t223 + t83 * t226;
  t229 = t28 * t228;
  t232 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t229);
  tvsigma2 = t6 * t232;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t36, t37, t38, t39, t41;
  double t43, t46, t47, t49, t51, t53, t54, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66;
  double t67, t68, t69, t71, t73, t74, t75, t76;
  double t78, t80, t83, t84, t86, t88, t90, t91;
  double t94, tzk0;

  double t95, t96, t97, t98, t99, t102, t103, t106;
  double t108, t109, t111, t112, t114, t115, t117, t120;
  double t122, t125, t126, t128, t129, t130, t134, t135;
  double t139, t141, t144, t145, t148, t150, t152, tvrho0;
  double t155, t156, t159, t160, t164, t166, t169, t170;
  double t173, t175, t176, t178, t181, t183, t186, t187;
  double t189, t190, t191, t195, t196, t200, tvrho1, t204;
  double t207, t208, t210, t211, t213, t214, t217, tvsigma0;
  double tvsigma1, t219, t222, t223, t225, t226, t228, t229;
  double t232, tvsigma2;

  double t235, t236, t237, t240, t241, t242, t244, t245;
  double t249, t250, t253, t259, t260, t262, t263, t264;
  double t268, t269, t270, t274, t279, t282, t285, t287;
  double t291, t292, t293, t294, t301, t302, t306, t307;
  double t308, t309, t313, t317, t318, t321, t323, t325;
  double t327, tv2rho20, t330, t333, t334, t338, t339, t342;
  double t349, t350, t353, t357, t358, t361, t366, t367;
  double t370, tv2rho21, t375, t379, t380, t384, t385, t390;
  double t391, t395, t399, t400, t409, t410, t411, t415;
  double t420, t423, t426, t428, t432, t433, t434, t441;
  double t442, t446, tv2rho22, t451, t453, t461, t462, t464;
  double t468, t472, t475, t476, t480, tv2rhosigma0, tv2rhosigma1, t484;
  double t486, t488, tv2rhosigma2, t493, tv2rhosigma3, tv2rhosigma4, t504, t505;
  double t507, t511, t515, t518, t519, t523, tv2rhosigma5, t525;
  double t526, t529, t532, t533, t536, t537, t540, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t541, t542, t545, t548;
  double t549, t552, t553, t556, tv2sigma25;

  gga_x_s12_params *params;

  assert(p->params != NULL);
  params = (gga_x_s12_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t27 * params->bx;
  t29 = params->C * sigma[0];
  t30 = rho[0] * rho[0];
  t31 = POW_1_3(rho[0]);
  t32 = t31 * t31;
  t34 = 0.1e1 / t32 / t30;
  t36 = sigma[0] * sigma[0];
  t37 = params->D * t36;
  t38 = t30 * t30;
  t39 = t38 * rho[0];
  t41 = 0.1e1 / t31 / t39;
  t43 = t29 * t34 + t37 * t41 + 0.1e1;
  t46 = params->B * (0.1e1 - 0.1e1 / t43);
  t47 = params->E * sigma[0];
  t49 = t47 * t34 + 0.1e1;
  t51 = 0.1e1 - 0.1e1 / t49;
  t53 = t46 * t51 + params->A;
  t54 = t28 * t53;
  t57 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t54);
  t58 = rho[1] <= p->dens_threshold;
  t59 = my_piecewise5(t14, t11, t10, t15, -t17);
  t60 = 0.1e1 + t59;
  t61 = t60 <= p->zeta_threshold;
  t62 = POW_1_3(t60);
  t64 = my_piecewise3(t61, t22, t62 * t60);
  t65 = t5 * t64;
  t66 = params->C * sigma[2];
  t67 = rho[1] * rho[1];
  t68 = POW_1_3(rho[1]);
  t69 = t68 * t68;
  t71 = 0.1e1 / t69 / t67;
  t73 = sigma[2] * sigma[2];
  t74 = params->D * t73;
  t75 = t67 * t67;
  t76 = t75 * rho[1];
  t78 = 0.1e1 / t68 / t76;
  t80 = t66 * t71 + t74 * t78 + 0.1e1;
  t83 = params->B * (0.1e1 - 0.1e1 / t80);
  t84 = params->E * sigma[2];
  t86 = t84 * t71 + 0.1e1;
  t88 = 0.1e1 - 0.1e1 / t86;
  t90 = t83 * t88 + params->A;
  t91 = t28 * t90;
  t94 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t91);
  tzk0 = t57 + t94;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t95 = t6 * t6;
  t96 = 0.1e1 / t95;
  t97 = t16 * t96;
  t98 = t7 - t97;
  t99 = my_piecewise5(t10, 0, t14, 0, t98);
  t102 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t99);
  t103 = t5 * t102;
  t106 = t27 * t27;
  t108 = 0.1e1 / t106 * params->bx;
  t109 = t108 * t53;
  t111 = t26 * t109 / 0.8e1;
  t112 = t43 * t43;
  t114 = params->B / t112;
  t115 = t30 * rho[0];
  t117 = 0.1e1 / t32 / t115;
  t120 = t38 * t30;
  t122 = 0.1e1 / t31 / t120;
  t125 = -0.8e1 / 0.3e1 * t29 * t117 - 0.16e2 / 0.3e1 * t37 * t122;
  t126 = t125 * t51;
  t128 = t49 * t49;
  t129 = 0.1e1 / t128;
  t130 = t46 * t129;
  t134 = t114 * t126 - 0.8e1 / 0.3e1 * t130 * t47 * t117;
  t135 = t28 * t134;
  t139 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t103 * t54 - t111 - 0.3e1 / 0.8e1 * t26 * t135);
  t141 = my_piecewise5(t14, 0, t10, 0, -t98);
  t144 = my_piecewise3(t61, 0, 0.4e1 / 0.3e1 * t62 * t141);
  t145 = t5 * t144;
  t148 = t108 * t90;
  t150 = t65 * t148 / 0.8e1;
  t152 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t145 * t91 - t150);
  tvrho0 = t57 + t94 + t6 * (t139 + t152);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t155 = -t7 - t97;
  t156 = my_piecewise5(t10, 0, t14, 0, t155);
  t159 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t156);
  t160 = t5 * t159;
  t164 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t160 * t54 - t111);
  t166 = my_piecewise5(t14, 0, t10, 0, -t155);
  t169 = my_piecewise3(t61, 0, 0.4e1 / 0.3e1 * t62 * t166);
  t170 = t5 * t169;
  t173 = t80 * t80;
  t175 = params->B / t173;
  t176 = t67 * rho[1];
  t178 = 0.1e1 / t69 / t176;
  t181 = t75 * t67;
  t183 = 0.1e1 / t68 / t181;
  t186 = -0.8e1 / 0.3e1 * t66 * t178 - 0.16e2 / 0.3e1 * t74 * t183;
  t187 = t186 * t88;
  t189 = t86 * t86;
  t190 = 0.1e1 / t189;
  t191 = t83 * t190;
  t195 = t175 * t187 - 0.8e1 / 0.3e1 * t191 * t84 * t178;
  t196 = t28 * t195;
  t200 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t170 * t91 - t150 - 0.3e1 / 0.8e1 * t65 * t196);
  tvrho1 = t57 + t94 + t6 * (t164 + t200);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t204 = params->D * sigma[0];
  t207 = 0.2e1 * t204 * t41 + params->C * t34;
  t208 = t207 * t51;
  t210 = t129 * params->E;
  t211 = t210 * t34;
  t213 = t114 * t208 + t46 * t211;
  t214 = t28 * t213;
  t217 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t214);
  tvsigma0 = t6 * t217;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t219 = params->D * sigma[2];
  t222 = 0.2e1 * t219 * t78 + params->C * t71;
  t223 = t222 * t88;
  t225 = t190 * params->E;
  t226 = t225 * t71;
  t228 = t175 * t223 + t83 * t226;
  t229 = t28 * t228;
  t232 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t229);
  tvsigma2 = t6 * t232;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t235 = t23 * t23;
  t236 = 0.1e1 / t235;
  t237 = t99 * t99;
  t240 = t95 * t6;
  t241 = 0.1e1 / t240;
  t242 = t16 * t241;
  t244 = -0.2e1 * t96 + 0.2e1 * t242;
  t245 = my_piecewise5(t10, 0, t14, 0, t244);
  t249 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t236 * t237 + 0.4e1 / 0.3e1 * t23 * t245);
  t250 = t5 * t249;
  t253 = t103 * t109;
  t259 = 0.1e1 / t106 / t6 * params->bx;
  t260 = t259 * t53;
  t262 = t26 * t260 / 0.12e2;
  t263 = t108 * t134;
  t264 = t26 * t263;
  t268 = params->B / t112 / t43;
  t269 = t125 * t125;
  t270 = t269 * t51;
  t274 = 0.1e1 / t32 / t38;
  t279 = 0.1e1 / t31 / t38 / t115;
  t282 = 0.88e2 / 0.9e1 * t29 * t274 + 0.304e3 / 0.9e1 * t37 * t279;
  t285 = t114 * t125;
  t287 = t210 * sigma[0] * t117;
  t291 = 0.1e1 / t128 / t49;
  t292 = t46 * t291;
  t293 = params->E * params->E;
  t294 = t293 * t36;
  t301 = -0.2e1 * t268 * t270 + t114 * t282 * t51 - 0.16e2 / 0.3e1 * t285 * t287 - 0.128e3 / 0.9e1 * t292 * t294 * t279 + 0.88e2 / 0.9e1 * t130 * t47 * t274;
  t302 = t28 * t301;
  t306 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t250 * t54 - t253 / 0.4e1 - 0.3e1 / 0.4e1 * t103 * t135 + t262 - t264 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t302);
  t307 = t62 * t62;
  t308 = 0.1e1 / t307;
  t309 = t141 * t141;
  t313 = my_piecewise5(t14, 0, t10, 0, -t244);
  t317 = my_piecewise3(t61, 0, 0.4e1 / 0.9e1 * t308 * t309 + 0.4e1 / 0.3e1 * t62 * t313);
  t318 = t5 * t317;
  t321 = t145 * t148;
  t323 = t259 * t90;
  t325 = t65 * t323 / 0.12e2;
  t327 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t318 * t91 - t321 / 0.4e1 + t325);
  tv2rho20 = 0.2e1 * t139 + 0.2e1 * t152 + t6 * (t306 + t327);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t330 = t236 * t156;
  t333 = 0.2e1 * t242;
  t334 = my_piecewise5(t10, 0, t14, 0, t333);
  t338 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t330 * t99 + 0.4e1 / 0.3e1 * t23 * t334);
  t339 = t5 * t338;
  t342 = t160 * t109;
  t349 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t339 * t54 - t342 / 0.8e1 - 0.3e1 / 0.8e1 * t160 * t135 - t253 / 0.8e1 + t262 - t264 / 0.8e1);
  t350 = t308 * t166;
  t353 = my_piecewise5(t14, 0, t10, 0, -t333);
  t357 = my_piecewise3(t61, 0, 0.4e1 / 0.9e1 * t350 * t141 + 0.4e1 / 0.3e1 * t62 * t353);
  t358 = t5 * t357;
  t361 = t170 * t148;
  t366 = t108 * t195;
  t367 = t65 * t366;
  t370 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t358 * t91 - t361 / 0.8e1 - t321 / 0.8e1 + t325 - 0.3e1 / 0.8e1 * t145 * t196 - t367 / 0.8e1);
  tv2rho21 = t139 + t152 + t164 + t200 + t6 * (t349 + t370);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t375 = t156 * t156;
  t379 = 0.2e1 * t96 + 0.2e1 * t242;
  t380 = my_piecewise5(t10, 0, t14, 0, t379);
  t384 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t236 * t375 + 0.4e1 / 0.3e1 * t23 * t380);
  t385 = t5 * t384;
  t390 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t385 * t54 - t342 / 0.4e1 + t262);
  t391 = t166 * t166;
  t395 = my_piecewise5(t14, 0, t10, 0, -t379);
  t399 = my_piecewise3(t61, 0, 0.4e1 / 0.9e1 * t308 * t391 + 0.4e1 / 0.3e1 * t62 * t395);
  t400 = t5 * t399;
  t409 = params->B / t173 / t80;
  t410 = t186 * t186;
  t411 = t410 * t88;
  t415 = 0.1e1 / t69 / t75;
  t420 = 0.1e1 / t68 / t75 / t176;
  t423 = 0.88e2 / 0.9e1 * t66 * t415 + 0.304e3 / 0.9e1 * t74 * t420;
  t426 = t175 * t186;
  t428 = t225 * sigma[2] * t178;
  t432 = 0.1e1 / t189 / t86;
  t433 = t83 * t432;
  t434 = t293 * t73;
  t441 = -0.2e1 * t409 * t411 + t175 * t423 * t88 - 0.16e2 / 0.3e1 * t426 * t428 - 0.128e3 / 0.9e1 * t433 * t434 * t420 + 0.88e2 / 0.9e1 * t191 * t84 * t415;
  t442 = t28 * t441;
  t446 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t400 * t91 - t361 / 0.4e1 - 0.3e1 / 0.4e1 * t170 * t196 + t325 - t367 / 0.4e1 - 0.3e1 / 0.8e1 * t65 * t442);
  tv2rho22 = 0.2e1 * t164 + 0.2e1 * t200 + t6 * (t390 + t446);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t451 = t108 * t213;
  t453 = t26 * t451 / 0.8e1;
  t461 = -0.8e1 / 0.3e1 * params->C * t117 - 0.32e2 / 0.3e1 * t204 * t122;
  t462 = t461 * t51;
  t464 = t114 * t207;
  t468 = t293 * t122;
  t472 = t210 * t117;
  t475 = -0.2e1 * t268 * t208 * t125 + t114 * t462 - 0.8e1 / 0.3e1 * t464 * t287 + t285 * t211 + 0.16e2 / 0.3e1 * t292 * t468 * sigma[0] - 0.8e1 / 0.3e1 * t46 * t472;
  t476 = t28 * t475;
  t480 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t103 * t214 - t453 - 0.3e1 / 0.8e1 * t26 * t476);
  tv2rhosigma0 = t6 * t480 + t217;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t484 = t108 * t228;
  t486 = t65 * t484 / 0.8e1;
  t488 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t145 * t229 - t486);
  tv2rhosigma2 = t6 * t488 + t232;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t493 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t160 * t214 - t453);
  tv2rhosigma3 = t6 * t493 + t217;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t504 = -0.8e1 / 0.3e1 * params->C * t178 - 0.32e2 / 0.3e1 * t219 * t183;
  t505 = t504 * t88;
  t507 = t175 * t222;
  t511 = t293 * t183;
  t515 = t225 * t178;
  t518 = -0.2e1 * t409 * t223 * t186 + t175 * t505 - 0.8e1 / 0.3e1 * t507 * t428 + t426 * t226 + 0.16e2 / 0.3e1 * t433 * t511 * sigma[2] - 0.8e1 / 0.3e1 * t83 * t515;
  t519 = t28 * t518;
  t523 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t170 * t229 - t486 - 0.3e1 / 0.8e1 * t65 * t519);
  tv2rhosigma5 = t6 * t523 + t232;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t525 = t207 * t207;
  t526 = t525 * t51;
  t529 = params->D * t41 * t51;
  t532 = t291 * t293;
  t533 = t532 * t41;
  t536 = 0.2e1 * t114 * t529 + 0.2e1 * t464 * t211 - 0.2e1 * t268 * t526 - 0.2e1 * t46 * t533;
  t537 = t28 * t536;
  t540 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t537);
  tv2sigma20 = t6 * t540;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t541 = t222 * t222;
  t542 = t541 * t88;
  t545 = params->D * t78 * t88;
  t548 = t432 * t293;
  t549 = t548 * t78;
  t552 = 0.2e1 * t175 * t545 + 0.2e1 * t507 * t226 - 0.2e1 * t409 * t542 - 0.2e1 * t83 * t549;
  t553 = t28 * t552;
  t556 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t553);
  tv2sigma25 = t6 * t556;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t36, t37, t38, t39, t41;
  double t43, t46, t47, t49, t51, t53, t54, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66;
  double t67, t68, t69, t71, t73, t74, t75, t76;
  double t78, t80, t83, t84, t86, t88, t90, t91;
  double t94, tzk0;

  double t95, t96, t97, t98, t99, t102, t103, t106;
  double t108, t109, t111, t112, t114, t115, t117, t120;
  double t122, t125, t126, t128, t129, t130, t134, t135;
  double t139, t141, t144, t145, t148, t150, t152, tvrho0;
  double t155, t156, t159, t160, t164, t166, t169, t170;
  double t173, t175, t176, t178, t181, t183, t186, t187;
  double t189, t190, t191, t195, t196, t200, tvrho1, t204;
  double t207, t208, t210, t211, t213, t214, t217, tvsigma0;
  double tvsigma1, t219, t222, t223, t225, t226, t228, t229;
  double t232, tvsigma2;

  double t235, t236, t237, t240, t241, t242, t244, t245;
  double t249, t250, t253, t259, t260, t262, t263, t264;
  double t268, t269, t270, t274, t279, t282, t285, t287;
  double t291, t292, t293, t294, t301, t302, t306, t307;
  double t308, t309, t313, t317, t318, t321, t323, t325;
  double t327, tv2rho20, t330, t333, t334, t338, t339, t342;
  double t349, t350, t353, t357, t358, t361, t366, t367;
  double t370, tv2rho21, t375, t379, t380, t384, t385, t390;
  double t391, t395, t399, t400, t409, t410, t411, t415;
  double t420, t423, t426, t428, t432, t433, t434, t441;
  double t442, t446, tv2rho22, t451, t453, t461, t462, t464;
  double t468, t472, t475, t476, t480, tv2rhosigma0, tv2rhosigma1, t484;
  double t486, t488, tv2rhosigma2, t493, tv2rhosigma3, tv2rhosigma4, t504, t505;
  double t507, t511, t515, t518, t519, t523, tv2rhosigma5, t525;
  double t526, t529, t532, t533, t536, t537, t540, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t541, t542, t545, t548;
  double t549, t552, t553, t556, tv2sigma25;

  double t560, t561, t564, t567, t568, t569, t571, t572;
  double t576, t577, t580, t584, t586, t592, t593, t595;
  double t596, t597, t599, t600, t602, t604, t605, t609;
  double t612, t616, t619, t621, t624, t627, t631, t635;
  double t638, t639, t640, t641, t642, t643, t644, t645;
  double t655, t656, t660, t662, t663, t666, t670, t674;
  double t675, t678, t680, t682, t684, t686, tv3rho30, t689;
  double t690, t691, t694, t699, t700, t701, t702, t706;
  double t707, t711, t714, t717, t725, t726, t727, t730;
  double t736, t740, t741, t745, t746, t753, t754, t755;
  double t758, tv3rho31, t761, t766, t769, t770, t774, t775;
  double t778, t786, t787, t792, t796, t800, t801, t804;
  double t809, t815, t816, t818, t819, tv3rho32, t824, t830;
  double t831, t835, t836, t842, t843, t849, t853, t854;
  double t866, t868, t869, t873, t876, t880, t883, t885;
  double t888, t891, t895, t899, t902, t903, t904, t905;
  double t906, t907, t908, t918, t919, t923, tv3rho33, t929;
  double t933, t935, t936, t937, t942, t945, t946, t947;
  double t948, t958, t959, t961, t972, t977, t978, t979;
  double t987, t990, t991, t995, tv3rho2sigma0, tv3rho2sigma1, t1000, t1002;
  double t1004, t1006, tv3rho2sigma2, t1010, t1017, tv3rho2sigma3, tv3rho2sigma4, t1021;
  double t1026, t1027, t1030, tv3rho2sigma5, t1037, tv3rho2sigma6, tv3rho2sigma7, t1049;
  double t1052, t1053, t1054, t1055, t1065, t1066, t1068, t1079;
  double t1084, t1085, t1086, t1094, t1097, t1098, t1102, tv3rho2sigma8;
  double t1106, t1108, t1115, t1118, t1119, t1124, t1127, t1128;
  double t1129, t1130, t1134, t1136, t1151, t1154, t1155, t1159;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1163, t1165, t1167;
  double tv3rhosigma25, t1172, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1182;
  double t1185, t1186, t1191, t1194, t1195, t1196, t1197, t1201;
  double t1203, t1218, t1221, t1222, t1226, tv3rhosigma211, t1228, t1229;
  double t1236, t1237, t1243, t1244, t1247, t1248, t1251, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t1252, t1253, t1260, t1261, t1267, t1268, t1271, t1272;
  double t1275, tv3sigma39;

  gga_x_s12_params *params;

  assert(p->params != NULL);
  params = (gga_x_s12_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t27 * params->bx;
  t29 = params->C * sigma[0];
  t30 = rho[0] * rho[0];
  t31 = POW_1_3(rho[0]);
  t32 = t31 * t31;
  t34 = 0.1e1 / t32 / t30;
  t36 = sigma[0] * sigma[0];
  t37 = params->D * t36;
  t38 = t30 * t30;
  t39 = t38 * rho[0];
  t41 = 0.1e1 / t31 / t39;
  t43 = t29 * t34 + t37 * t41 + 0.1e1;
  t46 = params->B * (0.1e1 - 0.1e1 / t43);
  t47 = params->E * sigma[0];
  t49 = t47 * t34 + 0.1e1;
  t51 = 0.1e1 - 0.1e1 / t49;
  t53 = t46 * t51 + params->A;
  t54 = t28 * t53;
  t57 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t54);
  t58 = rho[1] <= p->dens_threshold;
  t59 = my_piecewise5(t14, t11, t10, t15, -t17);
  t60 = 0.1e1 + t59;
  t61 = t60 <= p->zeta_threshold;
  t62 = POW_1_3(t60);
  t64 = my_piecewise3(t61, t22, t62 * t60);
  t65 = t5 * t64;
  t66 = params->C * sigma[2];
  t67 = rho[1] * rho[1];
  t68 = POW_1_3(rho[1]);
  t69 = t68 * t68;
  t71 = 0.1e1 / t69 / t67;
  t73 = sigma[2] * sigma[2];
  t74 = params->D * t73;
  t75 = t67 * t67;
  t76 = t75 * rho[1];
  t78 = 0.1e1 / t68 / t76;
  t80 = t66 * t71 + t74 * t78 + 0.1e1;
  t83 = params->B * (0.1e1 - 0.1e1 / t80);
  t84 = params->E * sigma[2];
  t86 = t84 * t71 + 0.1e1;
  t88 = 0.1e1 - 0.1e1 / t86;
  t90 = t83 * t88 + params->A;
  t91 = t28 * t90;
  t94 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t91);
  tzk0 = t57 + t94;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t95 = t6 * t6;
  t96 = 0.1e1 / t95;
  t97 = t16 * t96;
  t98 = t7 - t97;
  t99 = my_piecewise5(t10, 0, t14, 0, t98);
  t102 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t99);
  t103 = t5 * t102;
  t106 = t27 * t27;
  t108 = 0.1e1 / t106 * params->bx;
  t109 = t108 * t53;
  t111 = t26 * t109 / 0.8e1;
  t112 = t43 * t43;
  t114 = params->B / t112;
  t115 = t30 * rho[0];
  t117 = 0.1e1 / t32 / t115;
  t120 = t38 * t30;
  t122 = 0.1e1 / t31 / t120;
  t125 = -0.8e1 / 0.3e1 * t29 * t117 - 0.16e2 / 0.3e1 * t37 * t122;
  t126 = t125 * t51;
  t128 = t49 * t49;
  t129 = 0.1e1 / t128;
  t130 = t46 * t129;
  t134 = t114 * t126 - 0.8e1 / 0.3e1 * t130 * t47 * t117;
  t135 = t28 * t134;
  t139 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t103 * t54 - t111 - 0.3e1 / 0.8e1 * t26 * t135);
  t141 = my_piecewise5(t14, 0, t10, 0, -t98);
  t144 = my_piecewise3(t61, 0, 0.4e1 / 0.3e1 * t62 * t141);
  t145 = t5 * t144;
  t148 = t108 * t90;
  t150 = t65 * t148 / 0.8e1;
  t152 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t145 * t91 - t150);
  tvrho0 = t57 + t94 + t6 * (t139 + t152);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t155 = -t7 - t97;
  t156 = my_piecewise5(t10, 0, t14, 0, t155);
  t159 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t156);
  t160 = t5 * t159;
  t164 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t160 * t54 - t111);
  t166 = my_piecewise5(t14, 0, t10, 0, -t155);
  t169 = my_piecewise3(t61, 0, 0.4e1 / 0.3e1 * t62 * t166);
  t170 = t5 * t169;
  t173 = t80 * t80;
  t175 = params->B / t173;
  t176 = t67 * rho[1];
  t178 = 0.1e1 / t69 / t176;
  t181 = t75 * t67;
  t183 = 0.1e1 / t68 / t181;
  t186 = -0.8e1 / 0.3e1 * t66 * t178 - 0.16e2 / 0.3e1 * t74 * t183;
  t187 = t186 * t88;
  t189 = t86 * t86;
  t190 = 0.1e1 / t189;
  t191 = t83 * t190;
  t195 = t175 * t187 - 0.8e1 / 0.3e1 * t191 * t84 * t178;
  t196 = t28 * t195;
  t200 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t170 * t91 - t150 - 0.3e1 / 0.8e1 * t65 * t196);
  tvrho1 = t57 + t94 + t6 * (t164 + t200);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t204 = params->D * sigma[0];
  t207 = 0.2e1 * t204 * t41 + params->C * t34;
  t208 = t207 * t51;
  t210 = t129 * params->E;
  t211 = t210 * t34;
  t213 = t114 * t208 + t46 * t211;
  t214 = t28 * t213;
  t217 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t214);
  tvsigma0 = t6 * t217;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t219 = params->D * sigma[2];
  t222 = 0.2e1 * t219 * t78 + params->C * t71;
  t223 = t222 * t88;
  t225 = t190 * params->E;
  t226 = t225 * t71;
  t228 = t175 * t223 + t83 * t226;
  t229 = t28 * t228;
  t232 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t229);
  tvsigma2 = t6 * t232;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t235 = t23 * t23;
  t236 = 0.1e1 / t235;
  t237 = t99 * t99;
  t240 = t95 * t6;
  t241 = 0.1e1 / t240;
  t242 = t16 * t241;
  t244 = -0.2e1 * t96 + 0.2e1 * t242;
  t245 = my_piecewise5(t10, 0, t14, 0, t244);
  t249 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t236 * t237 + 0.4e1 / 0.3e1 * t23 * t245);
  t250 = t5 * t249;
  t253 = t103 * t109;
  t259 = 0.1e1 / t106 / t6 * params->bx;
  t260 = t259 * t53;
  t262 = t26 * t260 / 0.12e2;
  t263 = t108 * t134;
  t264 = t26 * t263;
  t268 = params->B / t112 / t43;
  t269 = t125 * t125;
  t270 = t269 * t51;
  t274 = 0.1e1 / t32 / t38;
  t279 = 0.1e1 / t31 / t38 / t115;
  t282 = 0.88e2 / 0.9e1 * t29 * t274 + 0.304e3 / 0.9e1 * t37 * t279;
  t285 = t114 * t125;
  t287 = t210 * sigma[0] * t117;
  t291 = 0.1e1 / t128 / t49;
  t292 = t46 * t291;
  t293 = params->E * params->E;
  t294 = t293 * t36;
  t301 = -0.2e1 * t268 * t270 + t114 * t282 * t51 - 0.16e2 / 0.3e1 * t285 * t287 - 0.128e3 / 0.9e1 * t292 * t294 * t279 + 0.88e2 / 0.9e1 * t130 * t47 * t274;
  t302 = t28 * t301;
  t306 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t250 * t54 - t253 / 0.4e1 - 0.3e1 / 0.4e1 * t103 * t135 + t262 - t264 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t302);
  t307 = t62 * t62;
  t308 = 0.1e1 / t307;
  t309 = t141 * t141;
  t313 = my_piecewise5(t14, 0, t10, 0, -t244);
  t317 = my_piecewise3(t61, 0, 0.4e1 / 0.9e1 * t308 * t309 + 0.4e1 / 0.3e1 * t62 * t313);
  t318 = t5 * t317;
  t321 = t145 * t148;
  t323 = t259 * t90;
  t325 = t65 * t323 / 0.12e2;
  t327 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t318 * t91 - t321 / 0.4e1 + t325);
  tv2rho20 = 0.2e1 * t139 + 0.2e1 * t152 + t6 * (t306 + t327);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t330 = t236 * t156;
  t333 = 0.2e1 * t242;
  t334 = my_piecewise5(t10, 0, t14, 0, t333);
  t338 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t330 * t99 + 0.4e1 / 0.3e1 * t23 * t334);
  t339 = t5 * t338;
  t342 = t160 * t109;
  t349 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t339 * t54 - t342 / 0.8e1 - 0.3e1 / 0.8e1 * t160 * t135 - t253 / 0.8e1 + t262 - t264 / 0.8e1);
  t350 = t308 * t166;
  t353 = my_piecewise5(t14, 0, t10, 0, -t333);
  t357 = my_piecewise3(t61, 0, 0.4e1 / 0.9e1 * t350 * t141 + 0.4e1 / 0.3e1 * t62 * t353);
  t358 = t5 * t357;
  t361 = t170 * t148;
  t366 = t108 * t195;
  t367 = t65 * t366;
  t370 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t358 * t91 - t361 / 0.8e1 - t321 / 0.8e1 + t325 - 0.3e1 / 0.8e1 * t145 * t196 - t367 / 0.8e1);
  tv2rho21 = t139 + t152 + t164 + t200 + t6 * (t349 + t370);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t375 = t156 * t156;
  t379 = 0.2e1 * t96 + 0.2e1 * t242;
  t380 = my_piecewise5(t10, 0, t14, 0, t379);
  t384 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t236 * t375 + 0.4e1 / 0.3e1 * t23 * t380);
  t385 = t5 * t384;
  t390 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t385 * t54 - t342 / 0.4e1 + t262);
  t391 = t166 * t166;
  t395 = my_piecewise5(t14, 0, t10, 0, -t379);
  t399 = my_piecewise3(t61, 0, 0.4e1 / 0.9e1 * t308 * t391 + 0.4e1 / 0.3e1 * t62 * t395);
  t400 = t5 * t399;
  t409 = params->B / t173 / t80;
  t410 = t186 * t186;
  t411 = t410 * t88;
  t415 = 0.1e1 / t69 / t75;
  t420 = 0.1e1 / t68 / t75 / t176;
  t423 = 0.88e2 / 0.9e1 * t66 * t415 + 0.304e3 / 0.9e1 * t74 * t420;
  t426 = t175 * t186;
  t428 = t225 * sigma[2] * t178;
  t432 = 0.1e1 / t189 / t86;
  t433 = t83 * t432;
  t434 = t293 * t73;
  t441 = -0.2e1 * t409 * t411 + t175 * t423 * t88 - 0.16e2 / 0.3e1 * t426 * t428 - 0.128e3 / 0.9e1 * t433 * t434 * t420 + 0.88e2 / 0.9e1 * t191 * t84 * t415;
  t442 = t28 * t441;
  t446 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t400 * t91 - t361 / 0.4e1 - 0.3e1 / 0.4e1 * t170 * t196 + t325 - t367 / 0.4e1 - 0.3e1 / 0.8e1 * t65 * t442);
  tv2rho22 = 0.2e1 * t164 + 0.2e1 * t200 + t6 * (t390 + t446);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t451 = t108 * t213;
  t453 = t26 * t451 / 0.8e1;
  t461 = -0.8e1 / 0.3e1 * params->C * t117 - 0.32e2 / 0.3e1 * t204 * t122;
  t462 = t461 * t51;
  t464 = t114 * t207;
  t468 = t293 * t122;
  t472 = t210 * t117;
  t475 = -0.2e1 * t268 * t208 * t125 + t114 * t462 - 0.8e1 / 0.3e1 * t464 * t287 + t285 * t211 + 0.16e2 / 0.3e1 * t292 * t468 * sigma[0] - 0.8e1 / 0.3e1 * t46 * t472;
  t476 = t28 * t475;
  t480 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t103 * t214 - t453 - 0.3e1 / 0.8e1 * t26 * t476);
  tv2rhosigma0 = t6 * t480 + t217;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t484 = t108 * t228;
  t486 = t65 * t484 / 0.8e1;
  t488 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t145 * t229 - t486);
  tv2rhosigma2 = t6 * t488 + t232;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t493 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t160 * t214 - t453);
  tv2rhosigma3 = t6 * t493 + t217;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t504 = -0.8e1 / 0.3e1 * params->C * t178 - 0.32e2 / 0.3e1 * t219 * t183;
  t505 = t504 * t88;
  t507 = t175 * t222;
  t511 = t293 * t183;
  t515 = t225 * t178;
  t518 = -0.2e1 * t409 * t223 * t186 + t175 * t505 - 0.8e1 / 0.3e1 * t507 * t428 + t426 * t226 + 0.16e2 / 0.3e1 * t433 * t511 * sigma[2] - 0.8e1 / 0.3e1 * t83 * t515;
  t519 = t28 * t518;
  t523 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t170 * t229 - t486 - 0.3e1 / 0.8e1 * t65 * t519);
  tv2rhosigma5 = t6 * t523 + t232;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t525 = t207 * t207;
  t526 = t525 * t51;
  t529 = params->D * t41 * t51;
  t532 = t291 * t293;
  t533 = t532 * t41;
  t536 = 0.2e1 * t114 * t529 + 0.2e1 * t464 * t211 - 0.2e1 * t268 * t526 - 0.2e1 * t46 * t533;
  t537 = t28 * t536;
  t540 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t537);
  tv2sigma20 = t6 * t540;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t541 = t222 * t222;
  t542 = t541 * t88;
  t545 = params->D * t78 * t88;
  t548 = t432 * t293;
  t549 = t548 * t78;
  t552 = 0.2e1 * t175 * t545 + 0.2e1 * t507 * t226 - 0.2e1 * t409 * t542 - 0.2e1 * t83 * t549;
  t553 = t28 * t552;
  t556 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t553);
  tv2sigma25 = t6 * t556;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t560 = 0.1e1 / t235 / t19;
  t561 = t237 * t99;
  t564 = t236 * t99;
  t567 = t95 * t95;
  t568 = 0.1e1 / t567;
  t569 = t16 * t568;
  t571 = 0.6e1 * t241 - 0.6e1 * t569;
  t572 = my_piecewise5(t10, 0, t14, 0, t571);
  t576 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t560 * t561 + 0.4e1 / 0.3e1 * t564 * t245 + 0.4e1 / 0.3e1 * t23 * t572);
  t577 = t5 * t576;
  t580 = t250 * t109;
  t584 = t103 * t260;
  t586 = t103 * t263;
  t592 = 0.1e1 / t106 / t95 * params->bx;
  t593 = t592 * t53;
  t595 = 0.5e1 / 0.36e2 * t26 * t593;
  t596 = t259 * t134;
  t597 = t26 * t596;
  t599 = t108 * t301;
  t600 = t26 * t599;
  t602 = t112 * t112;
  t604 = params->B / t602;
  t605 = t269 * t125;
  t609 = t126 * t282;
  t612 = t268 * t269;
  t616 = 0.1e1 / t32 / t39;
  t619 = t38 * t38;
  t621 = 0.1e1 / t31 / t619;
  t624 = -0.1232e4 / 0.27e2 * t29 * t616 - 0.6688e4 / 0.27e2 * t37 * t621;
  t627 = t114 * t282;
  t631 = t532 * t36 * t279;
  t635 = t210 * sigma[0] * t274;
  t638 = t128 * t128;
  t639 = 0.1e1 / t638;
  t640 = t46 * t639;
  t641 = t293 * params->E;
  t642 = t36 * sigma[0];
  t643 = t641 * t642;
  t644 = t619 * t115;
  t645 = 0.1e1 / t644;
  t655 = 0.6e1 * t604 * t605 * t51 - 0.6e1 * t268 * t609 + 0.16e2 * t612 * t287 + t114 * t624 * t51 - 0.8e1 * t627 * t287 - 0.128e3 / 0.3e1 * t285 * t631 + 0.88e2 / 0.3e1 * t285 * t635 - 0.1024e4 / 0.9e1 * t640 * t643 * t645 + 0.1408e4 / 0.9e1 * t292 * t294 * t621 - 0.1232e4 / 0.27e2 * t130 * t47 * t616;
  t656 = t28 * t655;
  t660 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t577 * t54 - 0.3e1 / 0.8e1 * t580 - 0.9e1 / 0.8e1 * t250 * t135 + t584 / 0.4e1 - 0.3e1 / 0.4e1 * t586 - 0.9e1 / 0.8e1 * t103 * t302 - t595 + t597 / 0.4e1 - 0.3e1 / 0.8e1 * t600 - 0.3e1 / 0.8e1 * t26 * t656);
  t662 = 0.1e1 / t307 / t60;
  t663 = t309 * t141;
  t666 = t308 * t141;
  t670 = my_piecewise5(t14, 0, t10, 0, -t571);
  t674 = my_piecewise3(t61, 0, -0.8e1 / 0.27e2 * t662 * t663 + 0.4e1 / 0.3e1 * t666 * t313 + 0.4e1 / 0.3e1 * t62 * t670);
  t675 = t5 * t674;
  t678 = t318 * t148;
  t680 = t145 * t323;
  t682 = t592 * t90;
  t684 = 0.5e1 / 0.36e2 * t65 * t682;
  t686 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t675 * t91 - 0.3e1 / 0.8e1 * t678 + t680 / 0.4e1 - t684);
  tv3rho30 = 0.3e1 * t306 + 0.3e1 * t327 + t6 * (t660 + t686);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t689 = 0.2e1 * t349;
  t690 = 0.2e1 * t370;
  t691 = t560 * t156;
  t694 = t236 * t334;
  t699 = 0.2e1 * t241;
  t700 = 0.6e1 * t569;
  t701 = t699 - t700;
  t702 = my_piecewise5(t10, 0, t14, 0, t701);
  t706 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t691 * t237 + 0.8e1 / 0.9e1 * t694 * t99 + 0.4e1 / 0.9e1 * t330 * t245 + 0.4e1 / 0.3e1 * t23 * t702);
  t707 = t5 * t706;
  t711 = t339 * t109 / 0.4e1;
  t714 = t160 * t260;
  t717 = t160 * t263 / 0.4e1;
  t725 = -0.3e1 / 0.8e1 * t707 * t54 - t711 - 0.3e1 / 0.4e1 * t339 * t135 + t714 / 0.12e2 - t717 - 0.3e1 / 0.8e1 * t160 * t302 - t580 / 0.8e1 + t584 / 0.6e1 - t586 / 0.4e1 - t595 + t597 / 0.6e1 - t600 / 0.8e1;
  t726 = my_piecewise3(t1, 0, t725);
  t727 = t662 * t166;
  t730 = t308 * t353;
  t736 = my_piecewise5(t14, 0, t10, 0, -t701);
  t740 = my_piecewise3(t61, 0, -0.8e1 / 0.27e2 * t727 * t309 + 0.8e1 / 0.9e1 * t730 * t141 + 0.4e1 / 0.9e1 * t350 * t313 + 0.4e1 / 0.3e1 * t62 * t736);
  t741 = t5 * t740;
  t745 = t358 * t148 / 0.4e1;
  t746 = t170 * t323;
  t753 = t145 * t366 / 0.4e1;
  t754 = t259 * t195;
  t755 = t65 * t754;
  t758 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t741 * t91 - t745 + t746 / 0.12e2 - t678 / 0.8e1 + t680 / 0.6e1 - t684 - 0.3e1 / 0.8e1 * t318 * t196 - t753 + t755 / 0.12e2);
  tv3rho31 = t306 + t327 + t689 + t690 + t6 * (t726 + t758);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t761 = t560 * t375;
  t766 = t236 * t380;
  t769 = -t699 - t700;
  t770 = my_piecewise5(t10, 0, t14, 0, t769);
  t774 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t761 * t99 + 0.8e1 / 0.9e1 * t330 * t334 + 0.4e1 / 0.9e1 * t766 * t99 + 0.4e1 / 0.3e1 * t23 * t770);
  t775 = t5 * t774;
  t778 = t385 * t109;
  t786 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t775 * t54 - t778 / 0.8e1 - 0.3e1 / 0.8e1 * t385 * t135 - t711 + t714 / 0.6e1 - t717 + t584 / 0.12e2 - t595 + t597 / 0.12e2);
  t787 = t662 * t391;
  t792 = t308 * t395;
  t796 = my_piecewise5(t14, 0, t10, 0, -t769);
  t800 = my_piecewise3(t61, 0, -0.8e1 / 0.27e2 * t787 * t141 + 0.8e1 / 0.9e1 * t350 * t353 + 0.4e1 / 0.9e1 * t792 * t141 + 0.4e1 / 0.3e1 * t62 * t796);
  t801 = t5 * t800;
  t804 = t400 * t148;
  t809 = t170 * t366;
  t815 = t108 * t441;
  t816 = t65 * t815;
  t818 = -0.3e1 / 0.8e1 * t801 * t91 - t804 / 0.8e1 - t745 + t746 / 0.6e1 - 0.3e1 / 0.4e1 * t358 * t196 - t809 / 0.4e1 + t680 / 0.12e2 - t684 - t753 + t755 / 0.6e1 - 0.3e1 / 0.8e1 * t145 * t442 - t816 / 0.8e1;
  t819 = my_piecewise3(t58, 0, t818);
  tv3rho32 = t689 + t690 + t390 + t446 + t6 * (t786 + t819);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t824 = t375 * t156;
  t830 = -0.6e1 * t241 - 0.6e1 * t569;
  t831 = my_piecewise5(t10, 0, t14, 0, t830);
  t835 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t560 * t824 + 0.4e1 / 0.3e1 * t330 * t380 + 0.4e1 / 0.3e1 * t23 * t831);
  t836 = t5 * t835;
  t842 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t836 * t54 - 0.3e1 / 0.8e1 * t778 + t714 / 0.4e1 - t595);
  t843 = t391 * t166;
  t849 = my_piecewise5(t14, 0, t10, 0, -t830);
  t853 = my_piecewise3(t61, 0, -0.8e1 / 0.27e2 * t662 * t843 + 0.4e1 / 0.3e1 * t350 * t395 + 0.4e1 / 0.3e1 * t62 * t849);
  t854 = t5 * t853;
  t866 = t173 * t173;
  t868 = params->B / t866;
  t869 = t410 * t186;
  t873 = t187 * t423;
  t876 = t409 * t410;
  t880 = 0.1e1 / t69 / t76;
  t883 = t75 * t75;
  t885 = 0.1e1 / t68 / t883;
  t888 = -0.1232e4 / 0.27e2 * t66 * t880 - 0.6688e4 / 0.27e2 * t74 * t885;
  t891 = t175 * t423;
  t895 = t548 * t73 * t420;
  t899 = t225 * sigma[2] * t415;
  t902 = t189 * t189;
  t903 = 0.1e1 / t902;
  t904 = t83 * t903;
  t905 = t73 * sigma[2];
  t906 = t641 * t905;
  t907 = t883 * t176;
  t908 = 0.1e1 / t907;
  t918 = 0.6e1 * t868 * t869 * t88 - 0.6e1 * t409 * t873 + 0.16e2 * t876 * t428 + t175 * t888 * t88 - 0.8e1 * t891 * t428 - 0.128e3 / 0.3e1 * t426 * t895 + 0.88e2 / 0.3e1 * t426 * t899 - 0.1024e4 / 0.9e1 * t904 * t906 * t908 + 0.1408e4 / 0.9e1 * t433 * t434 * t885 - 0.1232e4 / 0.27e2 * t191 * t84 * t880;
  t919 = t28 * t918;
  t923 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t854 * t91 - 0.3e1 / 0.8e1 * t804 - 0.9e1 / 0.8e1 * t400 * t196 + t746 / 0.4e1 - 0.3e1 / 0.4e1 * t809 - 0.9e1 / 0.8e1 * t170 * t442 - t684 + t755 / 0.4e1 - 0.3e1 / 0.8e1 * t816 - 0.3e1 / 0.8e1 * t65 * t919);
  tv3rho33 = 0.3e1 * t390 + 0.3e1 * t446 + t6 * (t842 + t923);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t929 = t103 * t451;
  t933 = t259 * t213;
  t935 = t26 * t933 / 0.12e2;
  t936 = t108 * t475;
  t937 = t26 * t936;
  t942 = t462 * t125;
  t945 = t207 * t129;
  t946 = t268 * t945;
  t947 = t117 * t125;
  t948 = t47 * t947;
  t958 = 0.88e2 / 0.9e1 * params->C * t274 + 0.608e3 / 0.9e1 * t204 * t279;
  t959 = t958 * t51;
  t961 = t114 * t461;
  t972 = t532 * t122 * sigma[0];
  t977 = t619 * t30;
  t978 = 0.1e1 / t977;
  t979 = t641 * t978;
  t987 = t210 * t274;
  t990 = 0.6e1 * t604 * t208 * t269 - 0.4e1 * t268 * t942 + 0.32e2 / 0.3e1 * t946 * t948 - 0.2e1 * t268 * t208 * t282 + t114 * t959 - 0.16e2 / 0.3e1 * t961 * t287 - 0.128e3 / 0.9e1 * t464 * t631 + 0.88e2 / 0.9e1 * t464 * t635 - 0.2e1 * t612 * t211 + t627 * t211 + 0.32e2 / 0.3e1 * t285 * t972 - 0.16e2 / 0.3e1 * t285 * t472 + 0.128e3 / 0.3e1 * t640 * t979 * t36 - 0.48e2 * t292 * t293 * t279 * sigma[0] + 0.88e2 / 0.9e1 * t46 * t987;
  t991 = t28 * t990;
  t995 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t250 * t214 - t929 / 0.4e1 - 0.3e1 / 0.4e1 * t103 * t476 + t935 - t937 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t991);
  tv3rho2sigma0 = t6 * t995 + 0.2e1 * t480;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1000 = t145 * t484;
  t1002 = t259 * t228;
  t1004 = t65 * t1002 / 0.12e2;
  t1006 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t318 * t229 - t1000 / 0.4e1 + t1004);
  tv3rho2sigma2 = t6 * t1006 + 0.2e1 * t488;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1010 = t160 * t451;
  t1017 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t339 * t214 - t1010 / 0.8e1 - 0.3e1 / 0.8e1 * t160 * t476 - t929 / 0.8e1 + t935 - t937 / 0.8e1);
  tv3rho2sigma3 = t6 * t1017 + t480 + t493;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1021 = t170 * t484;
  t1026 = t108 * t518;
  t1027 = t65 * t1026;
  t1030 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t358 * t229 - t1021 / 0.8e1 - t1000 / 0.8e1 + t1004 - 0.3e1 / 0.8e1 * t145 * t519 - t1027 / 0.8e1);
  tv3rho2sigma5 = t6 * t1030 + t488 + t523;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1037 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t385 * t214 - t1010 / 0.4e1 + t935);
  tv3rho2sigma6 = t6 * t1037 + 0.2e1 * t493;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1049 = t505 * t186;
  t1052 = t222 * t190;
  t1053 = t409 * t1052;
  t1054 = t178 * t186;
  t1055 = t84 * t1054;
  t1065 = 0.88e2 / 0.9e1 * params->C * t415 + 0.608e3 / 0.9e1 * t219 * t420;
  t1066 = t1065 * t88;
  t1068 = t175 * t504;
  t1079 = t548 * t183 * sigma[2];
  t1084 = t883 * t67;
  t1085 = 0.1e1 / t1084;
  t1086 = t641 * t1085;
  t1094 = t225 * t415;
  t1097 = 0.6e1 * t868 * t223 * t410 - 0.4e1 * t409 * t1049 + 0.32e2 / 0.3e1 * t1053 * t1055 - 0.2e1 * t409 * t223 * t423 + t175 * t1066 - 0.16e2 / 0.3e1 * t1068 * t428 - 0.128e3 / 0.9e1 * t507 * t895 + 0.88e2 / 0.9e1 * t507 * t899 - 0.2e1 * t876 * t226 + t891 * t226 + 0.32e2 / 0.3e1 * t426 * t1079 - 0.16e2 / 0.3e1 * t426 * t515 + 0.128e3 / 0.3e1 * t904 * t1086 * t73 - 0.48e2 * t433 * t293 * t420 * sigma[2] + 0.88e2 / 0.9e1 * t83 * t1094;
  t1098 = t28 * t1097;
  t1102 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t400 * t229 - t1021 / 0.4e1 - 0.3e1 / 0.4e1 * t170 * t519 + t1004 - t1027 / 0.4e1 - 0.3e1 / 0.8e1 * t65 * t1098);
  tv3rho2sigma8 = t6 * t1102 + 0.2e1 * t523;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1106 = t108 * t536;
  t1108 = t26 * t1106 / 0.8e1;
  t1115 = t268 * t525;
  t1118 = t268 * params->D;
  t1119 = t41 * t51;
  t1124 = params->D * t122 * t51;
  t1127 = t114 * params->D;
  t1128 = t619 * rho[0];
  t1129 = 0.1e1 / t1128;
  t1130 = t1129 * t129;
  t1134 = t268 * t207;
  t1136 = t210 * t34 * t125;
  t1151 = t532 * t122;
  t1154 = 0.6e1 * t604 * t526 * t125 - 0.4e1 * t268 * t208 * t461 + 0.16e2 / 0.3e1 * t1115 * t287 - 0.4e1 * t1118 * t1119 * t125 - 0.32e2 / 0.3e1 * t114 * t1124 - 0.16e2 / 0.3e1 * t1127 * t1130 * t47 - 0.4e1 * t1134 * t1136 + 0.2e1 * t961 * t211 + 0.32e2 / 0.3e1 * t464 * t972 - 0.16e2 / 0.3e1 * t464 * t472 - 0.2e1 * t285 * t533 - 0.16e2 * t640 * t641 * t1129 * sigma[0] + 0.32e2 / 0.3e1 * t46 * t1151;
  t1155 = t28 * t1154;
  t1159 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t103 * t537 - t1108 - 0.3e1 / 0.8e1 * t26 * t1155);
  tv3rhosigma20 = t6 * t1159 + t540;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1163 = t108 * t552;
  t1165 = t65 * t1163 / 0.8e1;
  t1167 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t145 * t553 - t1165);
  tv3rhosigma25 = t6 * t1167 + t556;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1172 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t160 * t537 - t1108);
  tv3rhosigma26 = t6 * t1172 + t540;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1182 = t409 * t541;
  t1185 = t409 * params->D;
  t1186 = t78 * t88;
  t1191 = params->D * t183 * t88;
  t1194 = t175 * params->D;
  t1195 = t883 * rho[1];
  t1196 = 0.1e1 / t1195;
  t1197 = t1196 * t190;
  t1201 = t409 * t222;
  t1203 = t225 * t71 * t186;
  t1218 = t548 * t183;
  t1221 = 0.6e1 * t868 * t542 * t186 - 0.4e1 * t409 * t223 * t504 + 0.16e2 / 0.3e1 * t1182 * t428 - 0.4e1 * t1185 * t1186 * t186 - 0.32e2 / 0.3e1 * t175 * t1191 - 0.16e2 / 0.3e1 * t1194 * t1197 * t84 - 0.4e1 * t1201 * t1203 + 0.2e1 * t1068 * t226 + 0.32e2 / 0.3e1 * t507 * t1079 - 0.16e2 / 0.3e1 * t507 * t515 - 0.2e1 * t426 * t549 - 0.16e2 * t904 * t641 * t1196 * sigma[2] + 0.32e2 / 0.3e1 * t83 * t1218;
  t1222 = t28 * t1221;
  t1226 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t170 * t553 - t1165 - 0.3e1 / 0.8e1 * t65 * t1222);
  tv3rhosigma211 = t6 * t1226 + t556;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1228 = t525 * t207;
  t1229 = t1228 * t51;
  t1236 = 0.1e1 / t619;
  t1237 = t1236 * t129;
  t1243 = t639 * t641;
  t1244 = t1243 * t1236;
  t1247 = 0.6e1 * t1127 * t1237 * params->E - 0.6e1 * t1115 * t211 - 0.12e2 * t1134 * t529 + 0.6e1 * t604 * t1229 + 0.6e1 * t46 * t1244 - 0.6e1 * t464 * t533;
  t1248 = t28 * t1247;
  t1251 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t1248);
  tv3sigma30 = t6 * t1251;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1252 = t541 * t222;
  t1253 = t1252 * t88;
  t1260 = 0.1e1 / t883;
  t1261 = t1260 * t190;
  t1267 = t903 * t641;
  t1268 = t1267 * t1260;
  t1271 = 0.6e1 * t1194 * t1261 * params->E - 0.6e1 * t1182 * t226 - 0.12e2 * t1201 * t545 + 0.6e1 * t868 * t1253 + 0.6e1 * t83 * t1268 - 0.6e1 * t507 * t549;
  t1272 = t28 * t1271;
  t1275 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t1272);
  tv3sigma39 = t6 * t1275;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t34, t36, t37, t38, t39, t41;
  double t43, t46, t47, t49, t51, t53, t54, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66;
  double t67, t68, t69, t71, t73, t74, t75, t76;
  double t78, t80, t83, t84, t86, t88, t90, t91;
  double t94, tzk0;

  double t95, t96, t97, t98, t99, t102, t103, t106;
  double t108, t109, t111, t112, t114, t115, t117, t120;
  double t122, t125, t126, t128, t129, t130, t134, t135;
  double t139, t141, t144, t145, t148, t150, t152, tvrho0;
  double t155, t156, t159, t160, t164, t166, t169, t170;
  double t173, t175, t176, t178, t181, t183, t186, t187;
  double t189, t190, t191, t195, t196, t200, tvrho1, t204;
  double t207, t208, t210, t211, t213, t214, t217, tvsigma0;
  double tvsigma1, t219, t222, t223, t225, t226, t228, t229;
  double t232, tvsigma2;

  double t235, t236, t237, t240, t241, t242, t244, t245;
  double t249, t250, t253, t259, t260, t262, t263, t264;
  double t268, t269, t270, t274, t279, t282, t285, t287;
  double t291, t292, t293, t294, t301, t302, t306, t307;
  double t308, t309, t313, t317, t318, t321, t323, t325;
  double t327, tv2rho20, t330, t333, t334, t338, t339, t342;
  double t349, t350, t353, t357, t358, t361, t366, t367;
  double t370, tv2rho21, t375, t379, t380, t384, t385, t390;
  double t391, t395, t399, t400, t409, t410, t411, t415;
  double t420, t423, t426, t428, t432, t433, t434, t441;
  double t442, t446, tv2rho22, t451, t453, t461, t462, t464;
  double t468, t472, t475, t476, t480, tv2rhosigma0, tv2rhosigma1, t484;
  double t486, t488, tv2rhosigma2, t493, tv2rhosigma3, tv2rhosigma4, t504, t505;
  double t507, t511, t515, t518, t519, t523, tv2rhosigma5, t525;
  double t526, t529, t532, t533, t536, t537, t540, tv2sigma20;
  double tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t541, t542, t545, t548;
  double t549, t552, t553, t556, tv2sigma25;

  double t560, t561, t564, t567, t568, t569, t571, t572;
  double t576, t577, t580, t584, t586, t592, t593, t595;
  double t596, t597, t599, t600, t602, t604, t605, t609;
  double t612, t616, t619, t621, t624, t627, t631, t635;
  double t638, t639, t640, t641, t642, t643, t644, t645;
  double t655, t656, t660, t662, t663, t666, t670, t674;
  double t675, t678, t680, t682, t684, t686, tv3rho30, t689;
  double t690, t691, t694, t699, t700, t701, t702, t706;
  double t707, t711, t714, t717, t725, t726, t727, t730;
  double t736, t740, t741, t745, t746, t753, t754, t755;
  double t758, tv3rho31, t761, t766, t769, t770, t774, t775;
  double t778, t786, t787, t792, t796, t800, t801, t804;
  double t809, t815, t816, t818, t819, tv3rho32, t824, t830;
  double t831, t835, t836, t842, t843, t849, t853, t854;
  double t866, t868, t869, t873, t876, t880, t883, t885;
  double t888, t891, t895, t899, t902, t903, t904, t905;
  double t906, t907, t908, t918, t919, t923, tv3rho33, t929;
  double t933, t935, t936, t937, t942, t945, t946, t947;
  double t948, t958, t959, t961, t972, t977, t978, t979;
  double t987, t990, t991, t995, tv3rho2sigma0, tv3rho2sigma1, t1000, t1002;
  double t1004, t1006, tv3rho2sigma2, t1010, t1017, tv3rho2sigma3, tv3rho2sigma4, t1021;
  double t1026, t1027, t1030, tv3rho2sigma5, t1037, tv3rho2sigma6, tv3rho2sigma7, t1049;
  double t1052, t1053, t1054, t1055, t1065, t1066, t1068, t1079;
  double t1084, t1085, t1086, t1094, t1097, t1098, t1102, tv3rho2sigma8;
  double t1106, t1108, t1115, t1118, t1119, t1124, t1127, t1128;
  double t1129, t1130, t1134, t1136, t1151, t1154, t1155, t1159;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1163, t1165, t1167;
  double tv3rhosigma25, t1172, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1182;
  double t1185, t1186, t1191, t1194, t1195, t1196, t1197, t1201;
  double t1203, t1218, t1221, t1222, t1226, tv3rhosigma211, t1228, t1229;
  double t1236, t1237, t1243, t1244, t1247, t1248, t1251, tv3sigma30;
  double tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38;
  double t1252, t1253, t1260, t1261, t1267, t1268, t1271, t1272;
  double t1275, tv3sigma39;

  double t1278, t1282, t1283, t1288, t1291, t1294, t1297, t1298;
  double t1299, t1300, t1311, t1319, t1323, t1329, t1332, t1338;
  double t1343, t1347, t1352, t1357, t1358, t1365, t1379, t1383;
  double t1385, t1386, t1392, t1399, t1401, t1402, t1406, t1412;
  double t1414, t1418, t1421, t1422, t1424, t1425, t1426, t1428;
  double t1429, t1435, t1441, t1445, t1449, t1451, t1453, t1457;
  double t1459, tv4rho40, t1480, t1481, t1482, t1483, t1487, t1493;
  double t1497, t1498, t1499, t1509, t1511, t1512, t1513, t1518;
  double t1519, t1537, t1541, t1545, t1547, t1548, t1549, t1556;
  double t1558, t1559, t1561, t1563, t1564, tv4rho41, t1571, t1573;
  double t1583, t1596, t1600, t1606, t1621, t1622, t1631, t1644;
  double t1648, t1652, t1654, t1661, t1663, t1672, t1675, t1677;
  double t1678, tv4rho42, t1698, t1699, t1703, t1707, t1717, t1718;
  double t1735, t1739, t1743, t1749, t1756, t1765, t1767, t1768;
  double tv4rho43, t1773, t1778, t1784, t1785, t1789, t1797, t1806;
  double t1811, t1817, t1821, t1832, t1837, t1841, t1846, t1852;
  double t1855, t1861, t1862, t1863, t1874, t1878, t1884, t1889;
  double t1898, t1899, t1913, t1917, t1918, tv4rho44, t1924, t1928;
  double t1930, t1936, t1938, t1941, t1984, t1993, t2000, t2002;
  double t2005, t2017, t2020, t2047, t2053, tv4rho3sigma0, tv4rho3sigma1, t2058;
  double t2060, t2064, t2066, tv4rho3sigma2, t2068, t2072, t2075, t2078;
  double t2086, t2087, tv4rho3sigma3, tv4rho3sigma4, t2089, t2093, t2094, t2101;
  double t2103, t2106, tv4rho3sigma5, t2110, t2118, tv4rho3sigma6, tv4rho3sigma7, t2122;
  double t2127, t2134, t2136, t2137, tv4rho3sigma8, t2145, tv4rho3sigma9, tv4rho3sigma10;
  double t2159, t2211, t2224, t2237, t2245, t2248, t2254, t2263;
  double t2269, tv4rho3sigma11, t2274, t2280, t2282, t2287, t2318, t2335;
  double t2347, t2349, t2360, t2381, t2390, t2396, tv4rho2sigma20, tv4rho2sigma21;
  double tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24, t2401, t2405, t2407, tv4rho2sigma25, t2411;
  double t2418, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t2422, t2428;
  double t2431, tv4rho2sigma211, t2438, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216;
  double t2458, t2468, t2478, t2496, t2516, t2540, t2542, t2553;
  double t2559, tv4rho2sigma217, t2565, t2572, t2576, t2587, t2607, t2631;
  double t2637, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36;
  double tv4rhosigma37, tv4rhosigma38, t2643, t2645, tv4rhosigma39, t2650, tv4rhosigma310, tv4rhosigma311;
  double tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t2660;
  double t2664, t2675, t2695, t2719, t2725, tv4rhosigma319, t2727, t2735;
  double t2737, t2762, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45;
  double tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413;
  double t2763, t2772, t2797, tv4sigma414;

  gga_x_s12_params *params;

  assert(p->params != NULL);
  params = (gga_x_s12_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = t27 * params->bx;
  t29 = params->C * sigma[0];
  t30 = rho[0] * rho[0];
  t31 = POW_1_3(rho[0]);
  t32 = t31 * t31;
  t34 = 0.1e1 / t32 / t30;
  t36 = sigma[0] * sigma[0];
  t37 = params->D * t36;
  t38 = t30 * t30;
  t39 = t38 * rho[0];
  t41 = 0.1e1 / t31 / t39;
  t43 = t29 * t34 + t37 * t41 + 0.1e1;
  t46 = params->B * (0.1e1 - 0.1e1 / t43);
  t47 = params->E * sigma[0];
  t49 = t47 * t34 + 0.1e1;
  t51 = 0.1e1 - 0.1e1 / t49;
  t53 = t46 * t51 + params->A;
  t54 = t28 * t53;
  t57 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t54);
  t58 = rho[1] <= p->dens_threshold;
  t59 = my_piecewise5(t14, t11, t10, t15, -t17);
  t60 = 0.1e1 + t59;
  t61 = t60 <= p->zeta_threshold;
  t62 = POW_1_3(t60);
  t64 = my_piecewise3(t61, t22, t62 * t60);
  t65 = t5 * t64;
  t66 = params->C * sigma[2];
  t67 = rho[1] * rho[1];
  t68 = POW_1_3(rho[1]);
  t69 = t68 * t68;
  t71 = 0.1e1 / t69 / t67;
  t73 = sigma[2] * sigma[2];
  t74 = params->D * t73;
  t75 = t67 * t67;
  t76 = t75 * rho[1];
  t78 = 0.1e1 / t68 / t76;
  t80 = t66 * t71 + t74 * t78 + 0.1e1;
  t83 = params->B * (0.1e1 - 0.1e1 / t80);
  t84 = params->E * sigma[2];
  t86 = t84 * t71 + 0.1e1;
  t88 = 0.1e1 - 0.1e1 / t86;
  t90 = t83 * t88 + params->A;
  t91 = t28 * t90;
  t94 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t91);
  tzk0 = t57 + t94;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t95 = t6 * t6;
  t96 = 0.1e1 / t95;
  t97 = t16 * t96;
  t98 = t7 - t97;
  t99 = my_piecewise5(t10, 0, t14, 0, t98);
  t102 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t99);
  t103 = t5 * t102;
  t106 = t27 * t27;
  t108 = 0.1e1 / t106 * params->bx;
  t109 = t108 * t53;
  t111 = t26 * t109 / 0.8e1;
  t112 = t43 * t43;
  t114 = params->B / t112;
  t115 = t30 * rho[0];
  t117 = 0.1e1 / t32 / t115;
  t120 = t38 * t30;
  t122 = 0.1e1 / t31 / t120;
  t125 = -0.8e1 / 0.3e1 * t29 * t117 - 0.16e2 / 0.3e1 * t37 * t122;
  t126 = t125 * t51;
  t128 = t49 * t49;
  t129 = 0.1e1 / t128;
  t130 = t46 * t129;
  t134 = t114 * t126 - 0.8e1 / 0.3e1 * t130 * t47 * t117;
  t135 = t28 * t134;
  t139 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t103 * t54 - t111 - 0.3e1 / 0.8e1 * t26 * t135);
  t141 = my_piecewise5(t14, 0, t10, 0, -t98);
  t144 = my_piecewise3(t61, 0, 0.4e1 / 0.3e1 * t62 * t141);
  t145 = t5 * t144;
  t148 = t108 * t90;
  t150 = t65 * t148 / 0.8e1;
  t152 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t145 * t91 - t150);
  tvrho0 = t57 + t94 + t6 * (t139 + t152);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t155 = -t7 - t97;
  t156 = my_piecewise5(t10, 0, t14, 0, t155);
  t159 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t156);
  t160 = t5 * t159;
  t164 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t160 * t54 - t111);
  t166 = my_piecewise5(t14, 0, t10, 0, -t155);
  t169 = my_piecewise3(t61, 0, 0.4e1 / 0.3e1 * t62 * t166);
  t170 = t5 * t169;
  t173 = t80 * t80;
  t175 = params->B / t173;
  t176 = t67 * rho[1];
  t178 = 0.1e1 / t69 / t176;
  t181 = t75 * t67;
  t183 = 0.1e1 / t68 / t181;
  t186 = -0.8e1 / 0.3e1 * t66 * t178 - 0.16e2 / 0.3e1 * t74 * t183;
  t187 = t186 * t88;
  t189 = t86 * t86;
  t190 = 0.1e1 / t189;
  t191 = t83 * t190;
  t195 = t175 * t187 - 0.8e1 / 0.3e1 * t191 * t84 * t178;
  t196 = t28 * t195;
  t200 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t170 * t91 - t150 - 0.3e1 / 0.8e1 * t65 * t196);
  tvrho1 = t57 + t94 + t6 * (t164 + t200);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t204 = params->D * sigma[0];
  t207 = 0.2e1 * t204 * t41 + params->C * t34;
  t208 = t207 * t51;
  t210 = t129 * params->E;
  t211 = t210 * t34;
  t213 = t114 * t208 + t46 * t211;
  t214 = t28 * t213;
  t217 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t214);
  tvsigma0 = t6 * t217;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t219 = params->D * sigma[2];
  t222 = 0.2e1 * t219 * t78 + params->C * t71;
  t223 = t222 * t88;
  t225 = t190 * params->E;
  t226 = t225 * t71;
  t228 = t175 * t223 + t83 * t226;
  t229 = t28 * t228;
  t232 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t229);
  tvsigma2 = t6 * t232;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t235 = t23 * t23;
  t236 = 0.1e1 / t235;
  t237 = t99 * t99;
  t240 = t95 * t6;
  t241 = 0.1e1 / t240;
  t242 = t16 * t241;
  t244 = -0.2e1 * t96 + 0.2e1 * t242;
  t245 = my_piecewise5(t10, 0, t14, 0, t244);
  t249 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t236 * t237 + 0.4e1 / 0.3e1 * t23 * t245);
  t250 = t5 * t249;
  t253 = t103 * t109;
  t259 = 0.1e1 / t106 / t6 * params->bx;
  t260 = t259 * t53;
  t262 = t26 * t260 / 0.12e2;
  t263 = t108 * t134;
  t264 = t26 * t263;
  t268 = params->B / t112 / t43;
  t269 = t125 * t125;
  t270 = t269 * t51;
  t274 = 0.1e1 / t32 / t38;
  t279 = 0.1e1 / t31 / t38 / t115;
  t282 = 0.88e2 / 0.9e1 * t29 * t274 + 0.304e3 / 0.9e1 * t37 * t279;
  t285 = t114 * t125;
  t287 = t210 * sigma[0] * t117;
  t291 = 0.1e1 / t128 / t49;
  t292 = t46 * t291;
  t293 = params->E * params->E;
  t294 = t293 * t36;
  t301 = -0.2e1 * t268 * t270 + t114 * t282 * t51 - 0.16e2 / 0.3e1 * t285 * t287 - 0.128e3 / 0.9e1 * t292 * t294 * t279 + 0.88e2 / 0.9e1 * t130 * t47 * t274;
  t302 = t28 * t301;
  t306 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t250 * t54 - t253 / 0.4e1 - 0.3e1 / 0.4e1 * t103 * t135 + t262 - t264 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t302);
  t307 = t62 * t62;
  t308 = 0.1e1 / t307;
  t309 = t141 * t141;
  t313 = my_piecewise5(t14, 0, t10, 0, -t244);
  t317 = my_piecewise3(t61, 0, 0.4e1 / 0.9e1 * t308 * t309 + 0.4e1 / 0.3e1 * t62 * t313);
  t318 = t5 * t317;
  t321 = t145 * t148;
  t323 = t259 * t90;
  t325 = t65 * t323 / 0.12e2;
  t327 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t318 * t91 - t321 / 0.4e1 + t325);
  tv2rho20 = 0.2e1 * t139 + 0.2e1 * t152 + t6 * (t306 + t327);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t330 = t236 * t156;
  t333 = 0.2e1 * t242;
  t334 = my_piecewise5(t10, 0, t14, 0, t333);
  t338 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t330 * t99 + 0.4e1 / 0.3e1 * t23 * t334);
  t339 = t5 * t338;
  t342 = t160 * t109;
  t349 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t339 * t54 - t342 / 0.8e1 - 0.3e1 / 0.8e1 * t160 * t135 - t253 / 0.8e1 + t262 - t264 / 0.8e1);
  t350 = t308 * t166;
  t353 = my_piecewise5(t14, 0, t10, 0, -t333);
  t357 = my_piecewise3(t61, 0, 0.4e1 / 0.9e1 * t350 * t141 + 0.4e1 / 0.3e1 * t62 * t353);
  t358 = t5 * t357;
  t361 = t170 * t148;
  t366 = t108 * t195;
  t367 = t65 * t366;
  t370 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t358 * t91 - t361 / 0.8e1 - t321 / 0.8e1 + t325 - 0.3e1 / 0.8e1 * t145 * t196 - t367 / 0.8e1);
  tv2rho21 = t139 + t152 + t164 + t200 + t6 * (t349 + t370);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t375 = t156 * t156;
  t379 = 0.2e1 * t96 + 0.2e1 * t242;
  t380 = my_piecewise5(t10, 0, t14, 0, t379);
  t384 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t236 * t375 + 0.4e1 / 0.3e1 * t23 * t380);
  t385 = t5 * t384;
  t390 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t385 * t54 - t342 / 0.4e1 + t262);
  t391 = t166 * t166;
  t395 = my_piecewise5(t14, 0, t10, 0, -t379);
  t399 = my_piecewise3(t61, 0, 0.4e1 / 0.9e1 * t308 * t391 + 0.4e1 / 0.3e1 * t62 * t395);
  t400 = t5 * t399;
  t409 = params->B / t173 / t80;
  t410 = t186 * t186;
  t411 = t410 * t88;
  t415 = 0.1e1 / t69 / t75;
  t420 = 0.1e1 / t68 / t75 / t176;
  t423 = 0.88e2 / 0.9e1 * t66 * t415 + 0.304e3 / 0.9e1 * t74 * t420;
  t426 = t175 * t186;
  t428 = t225 * sigma[2] * t178;
  t432 = 0.1e1 / t189 / t86;
  t433 = t83 * t432;
  t434 = t293 * t73;
  t441 = -0.2e1 * t409 * t411 + t175 * t423 * t88 - 0.16e2 / 0.3e1 * t426 * t428 - 0.128e3 / 0.9e1 * t433 * t434 * t420 + 0.88e2 / 0.9e1 * t191 * t84 * t415;
  t442 = t28 * t441;
  t446 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t400 * t91 - t361 / 0.4e1 - 0.3e1 / 0.4e1 * t170 * t196 + t325 - t367 / 0.4e1 - 0.3e1 / 0.8e1 * t65 * t442);
  tv2rho22 = 0.2e1 * t164 + 0.2e1 * t200 + t6 * (t390 + t446);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t451 = t108 * t213;
  t453 = t26 * t451 / 0.8e1;
  t461 = -0.8e1 / 0.3e1 * params->C * t117 - 0.32e2 / 0.3e1 * t204 * t122;
  t462 = t461 * t51;
  t464 = t114 * t207;
  t468 = t293 * t122;
  t472 = t210 * t117;
  t475 = -0.2e1 * t268 * t208 * t125 + t114 * t462 - 0.8e1 / 0.3e1 * t464 * t287 + t285 * t211 + 0.16e2 / 0.3e1 * t292 * t468 * sigma[0] - 0.8e1 / 0.3e1 * t46 * t472;
  t476 = t28 * t475;
  t480 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t103 * t214 - t453 - 0.3e1 / 0.8e1 * t26 * t476);
  tv2rhosigma0 = t6 * t480 + t217;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t484 = t108 * t228;
  t486 = t65 * t484 / 0.8e1;
  t488 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t145 * t229 - t486);
  tv2rhosigma2 = t6 * t488 + t232;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t493 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t160 * t214 - t453);
  tv2rhosigma3 = t6 * t493 + t217;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t504 = -0.8e1 / 0.3e1 * params->C * t178 - 0.32e2 / 0.3e1 * t219 * t183;
  t505 = t504 * t88;
  t507 = t175 * t222;
  t511 = t293 * t183;
  t515 = t225 * t178;
  t518 = -0.2e1 * t409 * t223 * t186 + t175 * t505 - 0.8e1 / 0.3e1 * t507 * t428 + t426 * t226 + 0.16e2 / 0.3e1 * t433 * t511 * sigma[2] - 0.8e1 / 0.3e1 * t83 * t515;
  t519 = t28 * t518;
  t523 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t170 * t229 - t486 - 0.3e1 / 0.8e1 * t65 * t519);
  tv2rhosigma5 = t6 * t523 + t232;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t525 = t207 * t207;
  t526 = t525 * t51;
  t529 = params->D * t41 * t51;
  t532 = t291 * t293;
  t533 = t532 * t41;
  t536 = 0.2e1 * t114 * t529 + 0.2e1 * t464 * t211 - 0.2e1 * t268 * t526 - 0.2e1 * t46 * t533;
  t537 = t28 * t536;
  t540 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t537);
  tv2sigma20 = t6 * t540;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t541 = t222 * t222;
  t542 = t541 * t88;
  t545 = params->D * t78 * t88;
  t548 = t432 * t293;
  t549 = t548 * t78;
  t552 = 0.2e1 * t175 * t545 + 0.2e1 * t507 * t226 - 0.2e1 * t409 * t542 - 0.2e1 * t83 * t549;
  t553 = t28 * t552;
  t556 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t553);
  tv2sigma25 = t6 * t556;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t560 = 0.1e1 / t235 / t19;
  t561 = t237 * t99;
  t564 = t236 * t99;
  t567 = t95 * t95;
  t568 = 0.1e1 / t567;
  t569 = t16 * t568;
  t571 = 0.6e1 * t241 - 0.6e1 * t569;
  t572 = my_piecewise5(t10, 0, t14, 0, t571);
  t576 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t560 * t561 + 0.4e1 / 0.3e1 * t564 * t245 + 0.4e1 / 0.3e1 * t23 * t572);
  t577 = t5 * t576;
  t580 = t250 * t109;
  t584 = t103 * t260;
  t586 = t103 * t263;
  t592 = 0.1e1 / t106 / t95 * params->bx;
  t593 = t592 * t53;
  t595 = 0.5e1 / 0.36e2 * t26 * t593;
  t596 = t259 * t134;
  t597 = t26 * t596;
  t599 = t108 * t301;
  t600 = t26 * t599;
  t602 = t112 * t112;
  t604 = params->B / t602;
  t605 = t269 * t125;
  t609 = t126 * t282;
  t612 = t268 * t269;
  t616 = 0.1e1 / t32 / t39;
  t619 = t38 * t38;
  t621 = 0.1e1 / t31 / t619;
  t624 = -0.1232e4 / 0.27e2 * t29 * t616 - 0.6688e4 / 0.27e2 * t37 * t621;
  t627 = t114 * t282;
  t631 = t532 * t36 * t279;
  t635 = t210 * sigma[0] * t274;
  t638 = t128 * t128;
  t639 = 0.1e1 / t638;
  t640 = t46 * t639;
  t641 = t293 * params->E;
  t642 = t36 * sigma[0];
  t643 = t641 * t642;
  t644 = t619 * t115;
  t645 = 0.1e1 / t644;
  t655 = 0.6e1 * t604 * t605 * t51 - 0.6e1 * t268 * t609 + 0.16e2 * t612 * t287 + t114 * t624 * t51 - 0.8e1 * t627 * t287 - 0.128e3 / 0.3e1 * t285 * t631 + 0.88e2 / 0.3e1 * t285 * t635 - 0.1024e4 / 0.9e1 * t640 * t643 * t645 + 0.1408e4 / 0.9e1 * t292 * t294 * t621 - 0.1232e4 / 0.27e2 * t130 * t47 * t616;
  t656 = t28 * t655;
  t660 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t577 * t54 - 0.3e1 / 0.8e1 * t580 - 0.9e1 / 0.8e1 * t250 * t135 + t584 / 0.4e1 - 0.3e1 / 0.4e1 * t586 - 0.9e1 / 0.8e1 * t103 * t302 - t595 + t597 / 0.4e1 - 0.3e1 / 0.8e1 * t600 - 0.3e1 / 0.8e1 * t26 * t656);
  t662 = 0.1e1 / t307 / t60;
  t663 = t309 * t141;
  t666 = t308 * t141;
  t670 = my_piecewise5(t14, 0, t10, 0, -t571);
  t674 = my_piecewise3(t61, 0, -0.8e1 / 0.27e2 * t662 * t663 + 0.4e1 / 0.3e1 * t666 * t313 + 0.4e1 / 0.3e1 * t62 * t670);
  t675 = t5 * t674;
  t678 = t318 * t148;
  t680 = t145 * t323;
  t682 = t592 * t90;
  t684 = 0.5e1 / 0.36e2 * t65 * t682;
  t686 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t675 * t91 - 0.3e1 / 0.8e1 * t678 + t680 / 0.4e1 - t684);
  tv3rho30 = 0.3e1 * t306 + 0.3e1 * t327 + t6 * (t660 + t686);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t689 = 0.2e1 * t349;
  t690 = 0.2e1 * t370;
  t691 = t560 * t156;
  t694 = t236 * t334;
  t699 = 0.2e1 * t241;
  t700 = 0.6e1 * t569;
  t701 = t699 - t700;
  t702 = my_piecewise5(t10, 0, t14, 0, t701);
  t706 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t691 * t237 + 0.8e1 / 0.9e1 * t694 * t99 + 0.4e1 / 0.9e1 * t330 * t245 + 0.4e1 / 0.3e1 * t23 * t702);
  t707 = t5 * t706;
  t711 = t339 * t109 / 0.4e1;
  t714 = t160 * t260;
  t717 = t160 * t263 / 0.4e1;
  t725 = -0.3e1 / 0.8e1 * t707 * t54 - t711 - 0.3e1 / 0.4e1 * t339 * t135 + t714 / 0.12e2 - t717 - 0.3e1 / 0.8e1 * t160 * t302 - t580 / 0.8e1 + t584 / 0.6e1 - t586 / 0.4e1 - t595 + t597 / 0.6e1 - t600 / 0.8e1;
  t726 = my_piecewise3(t1, 0, t725);
  t727 = t662 * t166;
  t730 = t308 * t353;
  t736 = my_piecewise5(t14, 0, t10, 0, -t701);
  t740 = my_piecewise3(t61, 0, -0.8e1 / 0.27e2 * t727 * t309 + 0.8e1 / 0.9e1 * t730 * t141 + 0.4e1 / 0.9e1 * t350 * t313 + 0.4e1 / 0.3e1 * t62 * t736);
  t741 = t5 * t740;
  t745 = t358 * t148 / 0.4e1;
  t746 = t170 * t323;
  t753 = t145 * t366 / 0.4e1;
  t754 = t259 * t195;
  t755 = t65 * t754;
  t758 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t741 * t91 - t745 + t746 / 0.12e2 - t678 / 0.8e1 + t680 / 0.6e1 - t684 - 0.3e1 / 0.8e1 * t318 * t196 - t753 + t755 / 0.12e2);
  tv3rho31 = t306 + t327 + t689 + t690 + t6 * (t726 + t758);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t761 = t560 * t375;
  t766 = t236 * t380;
  t769 = -t699 - t700;
  t770 = my_piecewise5(t10, 0, t14, 0, t769);
  t774 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t761 * t99 + 0.8e1 / 0.9e1 * t330 * t334 + 0.4e1 / 0.9e1 * t766 * t99 + 0.4e1 / 0.3e1 * t23 * t770);
  t775 = t5 * t774;
  t778 = t385 * t109;
  t786 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t775 * t54 - t778 / 0.8e1 - 0.3e1 / 0.8e1 * t385 * t135 - t711 + t714 / 0.6e1 - t717 + t584 / 0.12e2 - t595 + t597 / 0.12e2);
  t787 = t662 * t391;
  t792 = t308 * t395;
  t796 = my_piecewise5(t14, 0, t10, 0, -t769);
  t800 = my_piecewise3(t61, 0, -0.8e1 / 0.27e2 * t787 * t141 + 0.8e1 / 0.9e1 * t350 * t353 + 0.4e1 / 0.9e1 * t792 * t141 + 0.4e1 / 0.3e1 * t62 * t796);
  t801 = t5 * t800;
  t804 = t400 * t148;
  t809 = t170 * t366;
  t815 = t108 * t441;
  t816 = t65 * t815;
  t818 = -0.3e1 / 0.8e1 * t801 * t91 - t804 / 0.8e1 - t745 + t746 / 0.6e1 - 0.3e1 / 0.4e1 * t358 * t196 - t809 / 0.4e1 + t680 / 0.12e2 - t684 - t753 + t755 / 0.6e1 - 0.3e1 / 0.8e1 * t145 * t442 - t816 / 0.8e1;
  t819 = my_piecewise3(t58, 0, t818);
  tv3rho32 = t689 + t690 + t390 + t446 + t6 * (t786 + t819);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t824 = t375 * t156;
  t830 = -0.6e1 * t241 - 0.6e1 * t569;
  t831 = my_piecewise5(t10, 0, t14, 0, t830);
  t835 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t560 * t824 + 0.4e1 / 0.3e1 * t330 * t380 + 0.4e1 / 0.3e1 * t23 * t831);
  t836 = t5 * t835;
  t842 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t836 * t54 - 0.3e1 / 0.8e1 * t778 + t714 / 0.4e1 - t595);
  t843 = t391 * t166;
  t849 = my_piecewise5(t14, 0, t10, 0, -t830);
  t853 = my_piecewise3(t61, 0, -0.8e1 / 0.27e2 * t662 * t843 + 0.4e1 / 0.3e1 * t350 * t395 + 0.4e1 / 0.3e1 * t62 * t849);
  t854 = t5 * t853;
  t866 = t173 * t173;
  t868 = params->B / t866;
  t869 = t410 * t186;
  t873 = t187 * t423;
  t876 = t409 * t410;
  t880 = 0.1e1 / t69 / t76;
  t883 = t75 * t75;
  t885 = 0.1e1 / t68 / t883;
  t888 = -0.1232e4 / 0.27e2 * t66 * t880 - 0.6688e4 / 0.27e2 * t74 * t885;
  t891 = t175 * t423;
  t895 = t548 * t73 * t420;
  t899 = t225 * sigma[2] * t415;
  t902 = t189 * t189;
  t903 = 0.1e1 / t902;
  t904 = t83 * t903;
  t905 = t73 * sigma[2];
  t906 = t641 * t905;
  t907 = t883 * t176;
  t908 = 0.1e1 / t907;
  t918 = 0.6e1 * t868 * t869 * t88 - 0.6e1 * t409 * t873 + 0.16e2 * t876 * t428 + t175 * t888 * t88 - 0.8e1 * t891 * t428 - 0.128e3 / 0.3e1 * t426 * t895 + 0.88e2 / 0.3e1 * t426 * t899 - 0.1024e4 / 0.9e1 * t904 * t906 * t908 + 0.1408e4 / 0.9e1 * t433 * t434 * t885 - 0.1232e4 / 0.27e2 * t191 * t84 * t880;
  t919 = t28 * t918;
  t923 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t854 * t91 - 0.3e1 / 0.8e1 * t804 - 0.9e1 / 0.8e1 * t400 * t196 + t746 / 0.4e1 - 0.3e1 / 0.4e1 * t809 - 0.9e1 / 0.8e1 * t170 * t442 - t684 + t755 / 0.4e1 - 0.3e1 / 0.8e1 * t816 - 0.3e1 / 0.8e1 * t65 * t919);
  tv3rho33 = 0.3e1 * t390 + 0.3e1 * t446 + t6 * (t842 + t923);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t929 = t103 * t451;
  t933 = t259 * t213;
  t935 = t26 * t933 / 0.12e2;
  t936 = t108 * t475;
  t937 = t26 * t936;
  t942 = t462 * t125;
  t945 = t207 * t129;
  t946 = t268 * t945;
  t947 = t117 * t125;
  t948 = t47 * t947;
  t958 = 0.88e2 / 0.9e1 * params->C * t274 + 0.608e3 / 0.9e1 * t204 * t279;
  t959 = t958 * t51;
  t961 = t114 * t461;
  t972 = t532 * t122 * sigma[0];
  t977 = t619 * t30;
  t978 = 0.1e1 / t977;
  t979 = t641 * t978;
  t987 = t210 * t274;
  t990 = 0.6e1 * t604 * t208 * t269 - 0.4e1 * t268 * t942 + 0.32e2 / 0.3e1 * t946 * t948 - 0.2e1 * t268 * t208 * t282 + t114 * t959 - 0.16e2 / 0.3e1 * t961 * t287 - 0.128e3 / 0.9e1 * t464 * t631 + 0.88e2 / 0.9e1 * t464 * t635 - 0.2e1 * t612 * t211 + t627 * t211 + 0.32e2 / 0.3e1 * t285 * t972 - 0.16e2 / 0.3e1 * t285 * t472 + 0.128e3 / 0.3e1 * t640 * t979 * t36 - 0.48e2 * t292 * t293 * t279 * sigma[0] + 0.88e2 / 0.9e1 * t46 * t987;
  t991 = t28 * t990;
  t995 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t250 * t214 - t929 / 0.4e1 - 0.3e1 / 0.4e1 * t103 * t476 + t935 - t937 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t991);
  tv3rho2sigma0 = t6 * t995 + 0.2e1 * t480;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1000 = t145 * t484;
  t1002 = t259 * t228;
  t1004 = t65 * t1002 / 0.12e2;
  t1006 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t318 * t229 - t1000 / 0.4e1 + t1004);
  tv3rho2sigma2 = t6 * t1006 + 0.2e1 * t488;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1010 = t160 * t451;
  t1017 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t339 * t214 - t1010 / 0.8e1 - 0.3e1 / 0.8e1 * t160 * t476 - t929 / 0.8e1 + t935 - t937 / 0.8e1);
  tv3rho2sigma3 = t6 * t1017 + t480 + t493;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1021 = t170 * t484;
  t1026 = t108 * t518;
  t1027 = t65 * t1026;
  t1030 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t358 * t229 - t1021 / 0.8e1 - t1000 / 0.8e1 + t1004 - 0.3e1 / 0.8e1 * t145 * t519 - t1027 / 0.8e1);
  tv3rho2sigma5 = t6 * t1030 + t488 + t523;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1037 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t385 * t214 - t1010 / 0.4e1 + t935);
  tv3rho2sigma6 = t6 * t1037 + 0.2e1 * t493;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1049 = t505 * t186;
  t1052 = t222 * t190;
  t1053 = t409 * t1052;
  t1054 = t178 * t186;
  t1055 = t84 * t1054;
  t1065 = 0.88e2 / 0.9e1 * params->C * t415 + 0.608e3 / 0.9e1 * t219 * t420;
  t1066 = t1065 * t88;
  t1068 = t175 * t504;
  t1079 = t548 * t183 * sigma[2];
  t1084 = t883 * t67;
  t1085 = 0.1e1 / t1084;
  t1086 = t641 * t1085;
  t1094 = t225 * t415;
  t1097 = 0.6e1 * t868 * t223 * t410 - 0.4e1 * t409 * t1049 + 0.32e2 / 0.3e1 * t1053 * t1055 - 0.2e1 * t409 * t223 * t423 + t175 * t1066 - 0.16e2 / 0.3e1 * t1068 * t428 - 0.128e3 / 0.9e1 * t507 * t895 + 0.88e2 / 0.9e1 * t507 * t899 - 0.2e1 * t876 * t226 + t891 * t226 + 0.32e2 / 0.3e1 * t426 * t1079 - 0.16e2 / 0.3e1 * t426 * t515 + 0.128e3 / 0.3e1 * t904 * t1086 * t73 - 0.48e2 * t433 * t293 * t420 * sigma[2] + 0.88e2 / 0.9e1 * t83 * t1094;
  t1098 = t28 * t1097;
  t1102 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t400 * t229 - t1021 / 0.4e1 - 0.3e1 / 0.4e1 * t170 * t519 + t1004 - t1027 / 0.4e1 - 0.3e1 / 0.8e1 * t65 * t1098);
  tv3rho2sigma8 = t6 * t1102 + 0.2e1 * t523;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1106 = t108 * t536;
  t1108 = t26 * t1106 / 0.8e1;
  t1115 = t268 * t525;
  t1118 = t268 * params->D;
  t1119 = t41 * t51;
  t1124 = params->D * t122 * t51;
  t1127 = t114 * params->D;
  t1128 = t619 * rho[0];
  t1129 = 0.1e1 / t1128;
  t1130 = t1129 * t129;
  t1134 = t268 * t207;
  t1136 = t210 * t34 * t125;
  t1151 = t532 * t122;
  t1154 = 0.6e1 * t604 * t526 * t125 - 0.4e1 * t268 * t208 * t461 + 0.16e2 / 0.3e1 * t1115 * t287 - 0.4e1 * t1118 * t1119 * t125 - 0.32e2 / 0.3e1 * t114 * t1124 - 0.16e2 / 0.3e1 * t1127 * t1130 * t47 - 0.4e1 * t1134 * t1136 + 0.2e1 * t961 * t211 + 0.32e2 / 0.3e1 * t464 * t972 - 0.16e2 / 0.3e1 * t464 * t472 - 0.2e1 * t285 * t533 - 0.16e2 * t640 * t641 * t1129 * sigma[0] + 0.32e2 / 0.3e1 * t46 * t1151;
  t1155 = t28 * t1154;
  t1159 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t103 * t537 - t1108 - 0.3e1 / 0.8e1 * t26 * t1155);
  tv3rhosigma20 = t6 * t1159 + t540;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1163 = t108 * t552;
  t1165 = t65 * t1163 / 0.8e1;
  t1167 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t145 * t553 - t1165);
  tv3rhosigma25 = t6 * t1167 + t556;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1172 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t160 * t537 - t1108);
  tv3rhosigma26 = t6 * t1172 + t540;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1182 = t409 * t541;
  t1185 = t409 * params->D;
  t1186 = t78 * t88;
  t1191 = params->D * t183 * t88;
  t1194 = t175 * params->D;
  t1195 = t883 * rho[1];
  t1196 = 0.1e1 / t1195;
  t1197 = t1196 * t190;
  t1201 = t409 * t222;
  t1203 = t225 * t71 * t186;
  t1218 = t548 * t183;
  t1221 = 0.6e1 * t868 * t542 * t186 - 0.4e1 * t409 * t223 * t504 + 0.16e2 / 0.3e1 * t1182 * t428 - 0.4e1 * t1185 * t1186 * t186 - 0.32e2 / 0.3e1 * t175 * t1191 - 0.16e2 / 0.3e1 * t1194 * t1197 * t84 - 0.4e1 * t1201 * t1203 + 0.2e1 * t1068 * t226 + 0.32e2 / 0.3e1 * t507 * t1079 - 0.16e2 / 0.3e1 * t507 * t515 - 0.2e1 * t426 * t549 - 0.16e2 * t904 * t641 * t1196 * sigma[2] + 0.32e2 / 0.3e1 * t83 * t1218;
  t1222 = t28 * t1221;
  t1226 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t170 * t553 - t1165 - 0.3e1 / 0.8e1 * t65 * t1222);
  tv3rhosigma211 = t6 * t1226 + t556;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1228 = t525 * t207;
  t1229 = t1228 * t51;
  t1236 = 0.1e1 / t619;
  t1237 = t1236 * t129;
  t1243 = t639 * t641;
  t1244 = t1243 * t1236;
  t1247 = 0.6e1 * t1127 * t1237 * params->E - 0.6e1 * t1115 * t211 - 0.12e2 * t1134 * t529 + 0.6e1 * t604 * t1229 + 0.6e1 * t46 * t1244 - 0.6e1 * t464 * t533;
  t1248 = t28 * t1247;
  t1251 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t1248);
  tv3sigma30 = t6 * t1251;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1252 = t541 * t222;
  t1253 = t1252 * t88;
  t1260 = 0.1e1 / t883;
  t1261 = t1260 * t190;
  t1267 = t903 * t641;
  t1268 = t1267 * t1260;
  t1271 = 0.6e1 * t1194 * t1261 * params->E - 0.6e1 * t1182 * t226 - 0.12e2 * t1201 * t545 + 0.6e1 * t868 * t1253 + 0.6e1 * t83 * t1268 - 0.6e1 * t507 * t549;
  t1272 = t28 * t1271;
  t1275 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t1272);
  tv3sigma39 = t6 * t1275;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1278 = t250 * t263;
  t1282 = t103 * t596;
  t1283 = t103 * t599;
  t1288 = t26 * t592 * t134;
  t1291 = t26 * t259 * t301;
  t1294 = t26 * t108 * t655;
  t1297 = 0.1e1 / t638 / t49;
  t1298 = t46 * t1297;
  t1299 = t293 * t293;
  t1300 = t36 * t36;
  t1311 = t47 * t117 * t282;
  t1319 = t532 * t36 * t621;
  t1323 = t210 * sigma[0] * t616;
  t1329 = t1243 * t642 * t645;
  t1332 = t619 * t38;
  t1338 = 0.1e1 / t31 / t1128;
  t1343 = 0.1e1 / t32 / t120;
  t1347 = t604 * t605;
  t1352 = t114 * t624;
  t1357 = params->B / t602 / t43;
  t1358 = t269 * t269;
  t1365 = t282 * t282;
  t1379 = -0.32768e5 / 0.27e2 * t1298 * t1299 * t1300 / t32 / t619 / t120 + 0.64e2 * t268 * t125 * t129 * t1311 - 0.352e3 / 0.3e1 * t612 * t635 + 0.176e3 / 0.3e1 * t627 * t635 + 0.5632e4 / 0.9e1 * t285 * t1319 - 0.4928e4 / 0.27e2 * t285 * t1323 - 0.256e3 / 0.3e1 * t627 * t631 - 0.4096e4 / 0.9e1 * t285 * t1329 + 0.22528e5 / 0.9e1 * t640 * t643 / t1332 - 0.125312e6 / 0.81e2 * t292 * t294 * t1338 + 0.20944e5 / 0.81e2 * t130 * t47 * t1343 - 0.64e2 * t1347 * t287 + 0.512e3 / 0.3e1 * t612 * t631 - 0.32e2 / 0.3e1 * t1352 * t287 - 0.24e2 * t1357 * t1358 * t51 + 0.36e2 * t604 * t270 * t282 - 0.6e1 * t268 * t1365 * t51 - 0.8e1 * t268 * t126 * t624 + t114 * (0.20944e5 / 0.81e2 * t29 * t1343 + 0.1672e6 / 0.81e2 * t37 * t1338) * t51;
  t1383 = t19 * t19;
  t1385 = 0.1e1 / t235 / t1383;
  t1386 = t237 * t237;
  t1392 = t245 * t245;
  t1399 = t16 / t567 / t6;
  t1401 = -0.24e2 * t568 + 0.24e2 * t1399;
  t1402 = my_piecewise5(t10, 0, t14, 0, t1401);
  t1406 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1385 * t1386 - 0.16e2 / 0.9e1 * t560 * t237 * t245 + 0.4e1 / 0.3e1 * t236 * t1392 + 0.16e2 / 0.9e1 * t564 * t572 + 0.4e1 / 0.3e1 * t23 * t1402);
  t1412 = t250 * t260;
  t1414 = t103 * t593;
  t1418 = 0.1e1 / t106 / t240 * params->bx;
  t1421 = 0.1e2 / 0.27e2 * t26 * t1418 * t53;
  t1422 = t577 * t109;
  t1424 = -0.3e1 / 0.2e1 * t1278 - 0.9e1 / 0.4e1 * t250 * t302 + t1282 - 0.3e1 / 0.2e1 * t1283 - 0.3e1 / 0.2e1 * t103 * t656 - 0.5e1 / 0.9e1 * t1288 + t1291 / 0.2e1 - t1294 / 0.2e1 - 0.3e1 / 0.8e1 * t26 * t28 * t1379 - 0.3e1 / 0.8e1 * t5 * t1406 * t54 - 0.3e1 / 0.2e1 * t577 * t135 + t1412 / 0.2e1 - 0.5e1 / 0.9e1 * t1414 + t1421 - t1422 / 0.2e1;
  t1425 = my_piecewise3(t1, 0, t1424);
  t1426 = t60 * t60;
  t1428 = 0.1e1 / t307 / t1426;
  t1429 = t309 * t309;
  t1435 = t313 * t313;
  t1441 = my_piecewise5(t14, 0, t10, 0, -t1401);
  t1445 = my_piecewise3(t61, 0, 0.4e2 / 0.81e2 * t1428 * t1429 - 0.16e2 / 0.9e1 * t662 * t309 * t313 + 0.4e1 / 0.3e1 * t308 * t1435 + 0.16e2 / 0.9e1 * t666 * t670 + 0.4e1 / 0.3e1 * t62 * t1441);
  t1449 = t675 * t148;
  t1451 = t318 * t323;
  t1453 = t145 * t682;
  t1457 = 0.1e2 / 0.27e2 * t65 * t1418 * t90;
  t1459 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t5 * t1445 * t91 - t1449 / 0.2e1 + t1451 / 0.2e1 - 0.5e1 / 0.9e1 * t1453 + t1457);
  tv4rho40 = 0.4e1 * t660 + 0.4e1 * t686 + t6 * (t1425 + t1459);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1480 = 0.12e2 * t568;
  t1481 = 0.24e2 * t1399;
  t1482 = -t1480 + t1481;
  t1483 = my_piecewise5(t10, 0, t14, 0, t1482);
  t1487 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1385 * t156 * t561 - 0.8e1 / 0.9e1 * t560 * t334 * t237 - 0.8e1 / 0.9e1 * t691 * t99 * t245 + 0.4e1 / 0.3e1 * t236 * t702 * t99 + 0.4e1 / 0.3e1 * t694 * t245 + 0.4e1 / 0.9e1 * t330 * t572 + 0.4e1 / 0.3e1 * t23 * t1483);
  t1493 = t339 * t263;
  t1497 = t160 * t596;
  t1498 = t1497 / 0.4e1;
  t1499 = t160 * t599;
  t1509 = t707 * t109;
  t1511 = t339 * t260;
  t1512 = t1511 / 0.4e1;
  t1513 = t160 * t593;
  t1518 = -0.3e1 / 0.8e1 * t5 * t1487 * t54 - 0.9e1 / 0.8e1 * t707 * t135 - 0.3e1 / 0.4e1 * t1493 - 0.9e1 / 0.8e1 * t339 * t302 + t1498 - 0.3e1 / 0.8e1 * t1499 - 0.3e1 / 0.8e1 * t160 * t656 - 0.3e1 / 0.8e1 * t1278 + t1282 / 0.2e1 - 0.3e1 / 0.8e1 * t1283 - 0.5e1 / 0.12e2 * t1288 + t1291 / 0.4e1 - t1294 / 0.8e1 - 0.3e1 / 0.8e1 * t1509 + t1512 - 0.5e1 / 0.36e2 * t1513 + t1412 / 0.4e1 - 0.5e1 / 0.12e2 * t1414 + t1421 - t1422 / 0.8e1;
  t1519 = my_piecewise3(t1, 0, t1518);
  t1537 = my_piecewise5(t14, 0, t10, 0, -t1482);
  t1541 = my_piecewise3(t61, 0, 0.4e2 / 0.81e2 * t1428 * t166 * t663 - 0.8e1 / 0.9e1 * t662 * t353 * t309 - 0.8e1 / 0.9e1 * t727 * t141 * t313 + 0.4e1 / 0.3e1 * t308 * t736 * t141 + 0.4e1 / 0.3e1 * t730 * t313 + 0.4e1 / 0.9e1 * t350 * t670 + 0.4e1 / 0.3e1 * t62 * t1537);
  t1545 = t741 * t148;
  t1547 = t358 * t323;
  t1548 = t1547 / 0.4e1;
  t1549 = t170 * t682;
  t1556 = t318 * t366;
  t1558 = t145 * t754;
  t1559 = t1558 / 0.4e1;
  t1561 = t65 * t592 * t195;
  t1563 = -0.3e1 / 0.8e1 * t5 * t1541 * t91 - 0.3e1 / 0.8e1 * t1545 + t1548 - 0.5e1 / 0.36e2 * t1549 - t1449 / 0.8e1 + t1451 / 0.4e1 - 0.5e1 / 0.12e2 * t1453 + t1457 - 0.3e1 / 0.8e1 * t675 * t196 - 0.3e1 / 0.8e1 * t1556 + t1559 - 0.5e1 / 0.36e2 * t1561;
  t1564 = my_piecewise3(t58, 0, t1563);
  tv4rho41 = t660 + t686 + 0.3e1 * t726 + 0.3e1 * t758 + t6 * (t1519 + t1564);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1571 = t775 * t109;
  t1573 = t385 * t260;
  t1583 = t334 * t334;
  t1596 = my_piecewise5(t10, 0, t14, 0, t1481);
  t1600 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1385 * t375 * t237 - 0.32e2 / 0.27e2 * t691 * t99 * t334 - 0.8e1 / 0.27e2 * t761 * t245 + 0.8e1 / 0.9e1 * t236 * t1583 + 0.8e1 / 0.9e1 * t330 * t702 - 0.8e1 / 0.27e2 * t560 * t380 * t237 + 0.8e1 / 0.9e1 * t236 * t770 * t99 + 0.4e1 / 0.9e1 * t766 * t245 + 0.4e1 / 0.3e1 * t23 * t1596);
  t1606 = t385 * t263;
  t1621 = -t1571 / 0.4e1 + t1573 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t1600 * t54 - 0.3e1 / 0.4e1 * t775 * t135 - t1606 / 0.4e1 - 0.3e1 / 0.8e1 * t385 * t302 - t1493 / 0.2e1 + t1497 / 0.3e1 - t1499 / 0.4e1 + t1282 / 0.6e1 - 0.5e1 / 0.18e2 * t1288 + t1291 / 0.12e2 - t1509 / 0.4e1 + t1511 / 0.3e1 - 0.5e1 / 0.18e2 * t1513 + t1412 / 0.12e2 - 0.5e1 / 0.18e2 * t1414 + t1421;
  t1622 = my_piecewise3(t1, 0, t1621);
  t1631 = t353 * t353;
  t1644 = my_piecewise5(t14, 0, t10, 0, -t1481);
  t1648 = my_piecewise3(t61, 0, 0.4e2 / 0.81e2 * t1428 * t391 * t309 - 0.32e2 / 0.27e2 * t727 * t141 * t353 - 0.8e1 / 0.27e2 * t787 * t313 + 0.8e1 / 0.9e1 * t308 * t1631 + 0.8e1 / 0.9e1 * t350 * t736 - 0.8e1 / 0.27e2 * t662 * t395 * t309 + 0.8e1 / 0.9e1 * t308 * t796 * t141 + 0.4e1 / 0.9e1 * t792 * t313 + 0.4e1 / 0.3e1 * t62 * t1644);
  t1652 = t801 * t148;
  t1654 = t400 * t323;
  t1661 = t358 * t366;
  t1663 = t170 * t754;
  t1672 = t145 * t815;
  t1675 = t65 * t259 * t441;
  t1677 = -0.3e1 / 0.8e1 * t5 * t1648 * t91 - t1652 / 0.4e1 + t1654 / 0.12e2 - t1545 / 0.4e1 + t1547 / 0.3e1 - 0.5e1 / 0.18e2 * t1549 - 0.3e1 / 0.4e1 * t741 * t196 - t1661 / 0.2e1 + t1663 / 0.6e1 + t1451 / 0.12e2 - 0.5e1 / 0.18e2 * t1453 + t1457 - t1556 / 0.4e1 + t1558 / 0.3e1 - 0.5e1 / 0.18e2 * t1561 - 0.3e1 / 0.8e1 * t318 * t442 - t1672 / 0.4e1 + t1675 / 0.12e2;
  t1678 = my_piecewise3(t58, 0, t1677);
  tv4rho42 = 0.2e1 * t726 + 0.2e1 * t758 + 0.2e1 * t786 + 0.2e1 * t819 + t6 * (t1622 + t1678);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1698 = t1480 + t1481;
  t1699 = my_piecewise5(t10, 0, t14, 0, t1698);
  t1703 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1385 * t824 * t99 - 0.8e1 / 0.9e1 * t761 * t334 - 0.8e1 / 0.9e1 * t691 * t380 * t99 + 0.4e1 / 0.3e1 * t694 * t380 + 0.4e1 / 0.3e1 * t330 * t770 + 0.4e1 / 0.9e1 * t236 * t831 * t99 + 0.4e1 / 0.3e1 * t23 * t1699);
  t1707 = t836 * t109;
  t1717 = -0.3e1 / 0.8e1 * t5 * t1703 * t54 - t1707 / 0.8e1 - 0.3e1 / 0.8e1 * t836 * t135 - 0.3e1 / 0.8e1 * t1571 + t1573 / 0.4e1 - 0.3e1 / 0.8e1 * t1606 + t1512 - 0.5e1 / 0.12e2 * t1513 + t1498 - 0.5e1 / 0.36e2 * t1414 + t1421 - 0.5e1 / 0.36e2 * t1288;
  t1718 = my_piecewise3(t1, 0, t1717);
  t1735 = my_piecewise5(t14, 0, t10, 0, -t1698);
  t1739 = my_piecewise3(t61, 0, 0.4e2 / 0.81e2 * t1428 * t843 * t141 - 0.8e1 / 0.9e1 * t787 * t353 - 0.8e1 / 0.9e1 * t727 * t395 * t141 + 0.4e1 / 0.3e1 * t730 * t395 + 0.4e1 / 0.3e1 * t350 * t796 + 0.4e1 / 0.9e1 * t308 * t849 * t141 + 0.4e1 / 0.3e1 * t62 * t1735);
  t1743 = t854 * t148;
  t1749 = t400 * t366;
  t1756 = t170 * t815;
  t1765 = t65 * t108 * t918;
  t1767 = -0.3e1 / 0.8e1 * t5 * t1739 * t91 - t1743 / 0.8e1 - 0.3e1 / 0.8e1 * t1652 + t1654 / 0.4e1 - 0.9e1 / 0.8e1 * t801 * t196 - 0.3e1 / 0.8e1 * t1749 + t1548 - 0.5e1 / 0.12e2 * t1549 - 0.3e1 / 0.4e1 * t1661 + t1663 / 0.2e1 - 0.9e1 / 0.8e1 * t358 * t442 - 0.3e1 / 0.8e1 * t1756 - 0.5e1 / 0.36e2 * t1453 + t1457 + t1559 - 0.5e1 / 0.12e2 * t1561 - 0.3e1 / 0.8e1 * t1672 + t1675 / 0.4e1 - 0.3e1 / 0.8e1 * t145 * t919 - t1765 / 0.8e1;
  t1768 = my_piecewise3(t58, 0, t1767);
  tv4rho43 = 0.3e1 * t786 + 0.3e1 * t819 + t842 + t923 + t6 * (t1718 + t1768);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1773 = t375 * t375;
  t1778 = t380 * t380;
  t1784 = 0.24e2 * t568 + 0.24e2 * t1399;
  t1785 = my_piecewise5(t10, 0, t14, 0, t1784);
  t1789 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1385 * t1773 - 0.16e2 / 0.9e1 * t761 * t380 + 0.4e1 / 0.3e1 * t236 * t1778 + 0.16e2 / 0.9e1 * t330 * t831 + 0.4e1 / 0.3e1 * t23 * t1785);
  t1797 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1789 * t54 - t1707 / 0.2e1 + t1573 / 0.2e1 - 0.5e1 / 0.9e1 * t1513 + t1421);
  t1806 = t391 * t391;
  t1811 = t395 * t395;
  t1817 = my_piecewise5(t14, 0, t10, 0, -t1784);
  t1821 = my_piecewise3(t61, 0, 0.4e2 / 0.81e2 * t1428 * t1806 - 0.16e2 / 0.9e1 * t787 * t395 + 0.4e1 / 0.3e1 * t308 * t1811 + 0.16e2 / 0.9e1 * t350 * t849 + 0.4e1 / 0.3e1 * t62 * t1817);
  t1832 = 0.1e1 / t68 / t1195;
  t1837 = 0.1e1 / t69 / t181;
  t1841 = t868 * t869;
  t1846 = t175 * t888;
  t1852 = t1267 * t905 * t908;
  t1855 = t883 * t75;
  t1861 = 0.1e1 / t902 / t86;
  t1862 = t83 * t1861;
  t1863 = t73 * t73;
  t1874 = t548 * t73 * t885;
  t1878 = t225 * sigma[2] * t880;
  t1884 = t84 * t178 * t423;
  t1889 = t423 * t423;
  t1898 = params->B / t866 / t80;
  t1899 = t410 * t410;
  t1913 = -0.125312e6 / 0.81e2 * t433 * t434 * t1832 + 0.20944e5 / 0.81e2 * t191 * t84 * t1837 - 0.64e2 * t1841 * t428 + 0.512e3 / 0.3e1 * t876 * t895 - 0.32e2 / 0.3e1 * t1846 * t428 - 0.256e3 / 0.3e1 * t891 * t895 - 0.4096e4 / 0.9e1 * t426 * t1852 + 0.22528e5 / 0.9e1 * t904 * t906 / t1855 - 0.32768e5 / 0.27e2 * t1862 * t1299 * t1863 / t69 / t883 / t181 + 0.176e3 / 0.3e1 * t891 * t899 + 0.5632e4 / 0.9e1 * t426 * t1874 - 0.4928e4 / 0.27e2 * t426 * t1878 + 0.64e2 * t409 * t186 * t190 * t1884 - 0.352e3 / 0.3e1 * t876 * t899 - 0.6e1 * t409 * t1889 * t88 - 0.8e1 * t409 * t187 * t888 - 0.24e2 * t1898 * t1899 * t88 + 0.36e2 * t868 * t411 * t423 + t175 * (0.20944e5 / 0.81e2 * t66 * t1837 + 0.1672e6 / 0.81e2 * t74 * t1832) * t88;
  t1917 = t1675 / 0.2e1 - t1743 / 0.2e1 - 0.3e1 / 0.2e1 * t1749 - 0.3e1 / 0.2e1 * t1756 - t1765 / 0.2e1 - 0.5e1 / 0.9e1 * t1549 - 0.5e1 / 0.9e1 * t1561 + t1654 / 0.2e1 + t1663 - 0.3e1 / 0.8e1 * t5 * t1821 * t91 - 0.3e1 / 0.2e1 * t854 * t196 - 0.9e1 / 0.4e1 * t400 * t442 - 0.3e1 / 0.2e1 * t170 * t919 - 0.3e1 / 0.8e1 * t65 * t28 * t1913 + t1457;
  t1918 = my_piecewise3(t58, 0, t1917);
  tv4rho44 = 0.4e1 * t842 + 0.4e1 * t923 + t6 * (t1797 + t1918);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1924 = t250 * t451;
  t1928 = t103 * t933;
  t1930 = t103 * t936;
  t1936 = 0.5e1 / 0.36e2 * t26 * t592 * t213;
  t1938 = t26 * t259 * t475;
  t1941 = t26 * t108 * t990;
  t1984 = t268 * t207 * t291;
  t1993 = t210 * t34 * t282;
  t2000 = t114 * (-0.1232e4 / 0.27e2 * params->C * t616 - 0.13376e5 / 0.27e2 * t204 * t621) * t51 - 0.1232e4 / 0.27e2 * t46 * t210 * t616 - 0.24e2 * t1357 * t208 * t605 + 0.18e2 * t604 * t462 * t269 - 0.6e1 * t268 * t959 * t125 - 0.6e1 * t268 * t462 * t282 - 0.2e1 * t268 * t208 * t624 - 0.48e2 * t604 * t945 * t47 * t117 * t269 + 0.32e2 * t268 * t461 * t129 * t948 - 0.176e3 / 0.3e1 * t946 * t47 * t274 * t125 + 0.16e2 * t946 * t1311 + 0.256e3 / 0.3e1 * t1984 * t294 * t279 * t125 - 0.1024e4 / 0.9e1 * t464 * t1329 - 0.6e1 * t268 * t125 * t1993 - 0.32e2 * t612 * t972 + 0.16e2 * t627 * t972;
  t2002 = t1243 * t978 * t36;
  t2005 = t114 * t958;
  t2017 = t532 * t279 * sigma[0];
  t2020 = t604 * t207;
  t2047 = 0.128e3 * t285 * t2002 - 0.8e1 * t2005 * t287 - 0.128e3 / 0.3e1 * t961 * t631 + 0.88e2 / 0.3e1 * t961 * t635 + 0.1408e4 / 0.9e1 * t464 * t1319 - 0.1232e4 / 0.27e2 * t464 * t1323 - 0.144e3 * t285 * t2017 + 0.18e2 * t2020 * t609 + t1352 * t211 + 0.4096e4 / 0.9e1 * t1298 * t1299 / t32 / t619 / t39 * t642 + 0.10912e5 / 0.27e2 * t292 * t293 * t621 * sigma[0] + 0.6e1 * t1347 * t211 + 0.16e2 * t612 * t472 - 0.8e1 * t627 * t472 + 0.88e2 / 0.3e1 * t285 * t987 - 0.2432e4 / 0.3e1 * t640 * t641 * t645 * t36;
  t2053 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t577 * t214 - 0.3e1 / 0.8e1 * t1924 - 0.9e1 / 0.8e1 * t250 * t476 + t1928 / 0.4e1 - 0.3e1 / 0.4e1 * t1930 - 0.9e1 / 0.8e1 * t103 * t991 - t1936 + t1938 / 0.4e1 - 0.3e1 / 0.8e1 * t1941 - 0.3e1 / 0.8e1 * t26 * t28 * (t2000 + t2047));
  tv4rho3sigma0 = t6 * t2053 + 0.3e1 * t995;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t2058 = t318 * t484;
  t2060 = t145 * t1002;
  t2064 = 0.5e1 / 0.36e2 * t65 * t592 * t228;
  t2066 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t675 * t229 - 0.3e1 / 0.8e1 * t2058 + t2060 / 0.4e1 - t2064);
  tv4rho3sigma2 = t6 * t2066 + 0.3e1 * t1006;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t2068 = 0.2e1 * t1017;
  t2072 = t339 * t451 / 0.4e1;
  t2075 = t160 * t933;
  t2078 = t160 * t936 / 0.4e1;
  t2086 = -0.3e1 / 0.8e1 * t707 * t214 - t2072 - 0.3e1 / 0.4e1 * t339 * t476 + t2075 / 0.12e2 - t2078 - 0.3e1 / 0.8e1 * t160 * t991 - t1924 / 0.8e1 + t1928 / 0.6e1 - t1930 / 0.4e1 - t1936 + t1938 / 0.6e1 - t1941 / 0.8e1;
  t2087 = my_piecewise3(t1, 0, t2086);
  tv4rho3sigma3 = t6 * t2087 + t2068 + t995;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t2089 = 0.2e1 * t1030;
  t2093 = t358 * t484 / 0.4e1;
  t2094 = t170 * t1002;
  t2101 = t145 * t1026 / 0.4e1;
  t2103 = t65 * t259 * t518;
  t2106 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t741 * t229 - t2093 + t2094 / 0.12e2 - t2058 / 0.8e1 + t2060 / 0.6e1 - t2064 - 0.3e1 / 0.8e1 * t318 * t519 - t2101 + t2103 / 0.12e2);
  tv4rho3sigma5 = t6 * t2106 + t1006 + t2089;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2110 = t385 * t451;
  t2118 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t775 * t214 - t2110 / 0.8e1 - 0.3e1 / 0.8e1 * t385 * t476 - t2072 + t2075 / 0.6e1 - t2078 + t1928 / 0.12e2 - t1936 + t1938 / 0.12e2);
  tv4rho3sigma6 = t6 * t2118 + t1037 + t2068;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2122 = t400 * t484;
  t2127 = t170 * t1026;
  t2134 = t65 * t108 * t1097;
  t2136 = -0.3e1 / 0.8e1 * t801 * t229 - t2122 / 0.8e1 - t2093 + t2094 / 0.6e1 - 0.3e1 / 0.4e1 * t358 * t519 - t2127 / 0.4e1 + t2060 / 0.12e2 - t2064 - t2101 + t2103 / 0.6e1 - 0.3e1 / 0.8e1 * t145 * t1098 - t2134 / 0.8e1;
  t2137 = my_piecewise3(t58, 0, t2136);
  tv4rho3sigma8 = t6 * t2137 + t1102 + t2089;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2145 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t836 * t214 - 0.3e1 / 0.8e1 * t2110 + t2075 / 0.4e1 - t1936);
  tv4rho3sigma9 = t6 * t2145 + 0.3e1 * t1037;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2159 = t868 * t222;
  t2211 = 0.18e2 * t2159 * t873 + t1846 * t226 + 0.4096e4 / 0.9e1 * t1862 * t1299 / t69 / t883 / t76 * t905 + 0.10912e5 / 0.27e2 * t433 * t293 * t885 * sigma[2] + 0.6e1 * t1841 * t226 + 0.16e2 * t876 * t515 - 0.8e1 * t891 * t515 + 0.88e2 / 0.3e1 * t426 * t1094 - 0.2432e4 / 0.3e1 * t904 * t641 * t908 * t73 + t175 * (-0.1232e4 / 0.27e2 * params->C * t880 - 0.13376e5 / 0.27e2 * t219 * t885) * t88 - 0.24e2 * t1898 * t223 * t869 - 0.1232e4 / 0.27e2 * t83 * t225 * t880 - 0.6e1 * t409 * t1066 * t186 - 0.6e1 * t409 * t505 * t423 - 0.2e1 * t409 * t223 * t888 + 0.18e2 * t868 * t505 * t410;
  t2224 = t409 * t222 * t432;
  t2237 = t225 * t71 * t423;
  t2245 = t1267 * t1085 * t73;
  t2248 = t175 * t1065;
  t2254 = t548 * t420 * sigma[2];
  t2263 = -0.48e2 * t868 * t1052 * t84 * t178 * t410 + 0.32e2 * t409 * t504 * t190 * t1055 + 0.16e2 * t1053 * t1884 + 0.256e3 / 0.3e1 * t2224 * t434 * t420 * t186 - 0.176e3 / 0.3e1 * t1053 * t84 * t415 * t186 - 0.1024e4 / 0.9e1 * t507 * t1852 - 0.6e1 * t409 * t186 * t2237 - 0.32e2 * t876 * t1079 + 0.16e2 * t891 * t1079 + 0.128e3 * t426 * t2245 - 0.8e1 * t2248 * t428 - 0.128e3 / 0.3e1 * t1068 * t895 - 0.144e3 * t426 * t2254 + 0.88e2 / 0.3e1 * t1068 * t899 + 0.1408e4 / 0.9e1 * t507 * t1874 - 0.1232e4 / 0.27e2 * t507 * t1878;
  t2269 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t854 * t229 - 0.3e1 / 0.8e1 * t2122 - 0.9e1 / 0.8e1 * t400 * t519 + t2094 / 0.4e1 - 0.3e1 / 0.4e1 * t2127 - 0.9e1 / 0.8e1 * t170 * t1098 - t2064 + t2103 / 0.4e1 - 0.3e1 / 0.8e1 * t2134 - 0.3e1 / 0.8e1 * t65 * t28 * (t2211 + t2263));
  tv4rho3sigma11 = t6 * t2269 + 0.3e1 * t1102;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2274 = t103 * t1106;
  t2280 = t26 * t259 * t536 / 0.12e2;
  t2282 = t26 * t108 * t1154;
  t2287 = 0.1e1 / t32 / t1332;
  t2318 = t461 * t461;
  t2335 = -0.2e1 * t627 * t533 - 0.512e3 / 0.3e1 * t1298 * t1299 * t2287 * t36 + 0.24e2 * t2020 * t942 - 0.4e1 * t1118 * t1119 * t282 + 0.2e1 * t2005 * t211 - 0.32e2 / 0.3e1 * t961 * t472 + 0.176e3 / 0.9e1 * t464 * t987 + 0.4e1 * t612 * t533 + 0.64e2 / 0.3e1 * t285 * t1151 + 0.688e3 / 0.3e1 * t640 * t979 * sigma[0] + 0.12e2 * t604 * params->D * t1119 * t269 + 0.128e3 / 0.3e1 * t1118 * t122 * t51 * t125 - 0.4e1 * t268 * t2318 * t51 - 0.608e3 / 0.9e1 * t46 * t532 * t279 - 0.24e2 * t1357 * t526 * t269 + 0.608e3 / 0.9e1 * t114 * params->D * t279 * t51 + 0.6e1 * t604 * t526 * t282;
  t2347 = params->D * t1129;
  t2349 = sigma[0] * t125;
  t2360 = t268 * t461;
  t2381 = t1243 * t1129 * sigma[0];
  t2390 = -0.4e1 * t268 * t208 * t958 - 0.32e2 * t604 * t525 * t129 * t948 + 0.64e2 / 0.3e1 * t946 * t47 * t117 * t461 + 0.64e2 / 0.3e1 * t268 * t2347 * t210 * t2349 - 0.128e3 / 0.3e1 * t1984 * t468 * t2349 - 0.256e3 / 0.9e1 * t1127 * t2287 * t291 * t294 - 0.8e1 * t2360 * t1136 - 0.4e1 * t1134 * t1993 - 0.96e2 * t464 * t2017 - 0.176e3 / 0.9e1 * t1115 * t635 + 0.12e2 * t2020 * t210 * t34 * t269 + 0.64e2 / 0.3e1 * t1134 * t210 * t947 + 0.64e2 / 0.3e1 * t961 * t972 + 0.256e3 / 0.3e1 * t464 * t2002 - 0.32e2 * t285 * t2381 + 0.256e3 / 0.9e1 * t1115 * t631 + 0.688e3 / 0.9e1 * t1127 * t978 * t129 * t47;
  t2396 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t250 * t537 - t2274 / 0.4e1 - 0.3e1 / 0.4e1 * t103 * t1155 + t2280 - t2282 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t28 * (t2335 + t2390));
  tv4rho2sigma20 = t6 * t2396 + 0.2e1 * t1159;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2401 = t145 * t1163;
  t2405 = t65 * t259 * t552 / 0.12e2;
  t2407 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t318 * t553 - t2401 / 0.4e1 + t2405);
  tv4rho2sigma25 = t6 * t2407 + 0.2e1 * t1167;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2411 = t160 * t1106;
  t2418 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t339 * t537 - t2411 / 0.8e1 - 0.3e1 / 0.8e1 * t160 * t1155 - t2274 / 0.8e1 + t2280 - t2282 / 0.8e1);
  tv4rho2sigma26 = t6 * t2418 + t1159 + t1172;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2422 = t170 * t1163;
  t2428 = t65 * t108 * t1221;
  t2431 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t358 * t553 - t2422 / 0.8e1 - t2401 / 0.8e1 + t2405 - 0.3e1 / 0.8e1 * t145 * t1222 - t2428 / 0.8e1);
  tv4rho2sigma211 = t6 * t2431 + t1167 + t1226;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2438 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t385 * t537 - t2411 / 0.4e1 + t2280);
  tv4rho2sigma212 = t6 * t2438 + 0.2e1 * t1172;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2458 = t409 * t504;
  t2468 = t1267 * t1196 * sigma[2];
  t2478 = 0.1e1 / t69 / t1855;
  t2496 = -0.176e3 / 0.9e1 * t1182 * t899 + 0.12e2 * t2159 * t225 * t71 * t410 + 0.64e2 / 0.3e1 * t1201 * t225 * t1054 - 0.96e2 * t507 * t2254 - 0.8e1 * t2458 * t1203 - 0.4e1 * t1201 * t2237 + 0.64e2 / 0.3e1 * t1068 * t1079 + 0.256e3 / 0.3e1 * t507 * t2245 - 0.32e2 * t426 * t2468 + 0.256e3 / 0.9e1 * t1182 * t895 + 0.688e3 / 0.9e1 * t1194 * t1085 * t190 * t84 - 0.256e3 / 0.9e1 * t1194 * t2478 * t432 * t434 + 0.2e1 * t2248 * t226 - 0.2e1 * t891 * t549 - 0.512e3 / 0.3e1 * t1862 * t1299 * t2478 * t73 + 0.24e2 * t2159 * t1049 - 0.4e1 * t1185 * t1186 * t423;
  t2516 = t504 * t504;
  t2540 = params->D * t1196;
  t2542 = sigma[2] * t186;
  t2553 = -0.32e2 / 0.3e1 * t1068 * t515 + 0.176e3 / 0.9e1 * t507 * t1094 + 0.4e1 * t876 * t549 + 0.64e2 / 0.3e1 * t426 * t1218 + 0.688e3 / 0.3e1 * t904 * t1086 * sigma[2] + 0.12e2 * t868 * params->D * t1186 * t410 + 0.128e3 / 0.3e1 * t1185 * t183 * t88 * t186 - 0.4e1 * t409 * t2516 * t88 + 0.608e3 / 0.9e1 * t175 * params->D * t420 * t88 - 0.608e3 / 0.9e1 * t83 * t548 * t420 - 0.24e2 * t1898 * t542 * t410 + 0.6e1 * t868 * t542 * t423 - 0.4e1 * t409 * t223 * t1065 + 0.64e2 / 0.3e1 * t1053 * t84 * t178 * t504 + 0.64e2 / 0.3e1 * t409 * t2540 * t225 * t2542 - 0.128e3 / 0.3e1 * t2224 * t511 * t2542 - 0.32e2 * t868 * t541 * t190 * t1055;
  t2559 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t400 * t553 - t2422 / 0.4e1 - 0.3e1 / 0.4e1 * t170 * t1222 + t2405 - t2428 / 0.4e1 - 0.3e1 / 0.8e1 * t65 * t28 * (t2496 + t2553));
  tv4rho2sigma217 = t6 * t2559 + 0.2e1 * t1226;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2565 = t26 * t108 * t1247 / 0.8e1;
  t2572 = t604 * t1228;
  t2576 = t41 * t125;
  t2587 = t604 * t525;
  t2607 = 0.1e1 / t32 / t644;
  t2631 = 0.32e2 * t1127 * t2607 * t291 * t293 * sigma[0] - 0.12e2 * t1118 * t1237 * params->E * t125 + 0.64e2 * t1298 * t1299 * t2607 * sigma[0] - 0.48e2 * t1127 * t1130 * params->E - 0.48e2 * t46 * t1243 * t1129 + 0.12e2 * t1134 * t532 * t2576 + 0.16e2 * t1115 * t472 + 0.32e2 * t464 * t1151 + 0.6e1 * t285 * t1244 - 0.48e2 * t464 * t2381 - 0.6e1 * t961 * t533;
  t2637 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t103 * t1248 - t2565 - 0.3e1 / 0.8e1 * t26 * t28 * (-0.12e2 * t1134 * t210 * t34 * t461 + 0.36e2 * t2020 * t51 * params->D * t2576 - 0.24e2 * t1357 * t1229 * t125 + 0.32e2 * t946 * t47 * t2347 + 0.18e2 * t604 * t526 * t461 - 0.32e2 * t1115 * t972 + 0.64e2 * t1134 * t1124 + 0.18e2 * t2587 * t1136 - 0.12e2 * t2360 * t529 - 0.16e2 * t2572 * t287 + t2631));
  tv4rhosigma30 = t6 * t2637 + t1251;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2643 = t65 * t108 * t1271 / 0.8e1;
  t2645 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t145 * t1272 - t2643);
  tv4rhosigma39 = t6 * t2645 + t1275;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2650 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t160 * t1248 - t2565);
  tv4rhosigma310 = t6 * t2650 + t1251;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2660 = t868 * t1252;
  t2664 = t78 * t186;
  t2675 = t868 * t541;
  t2695 = 0.1e1 / t69 / t907;
  t2719 = 0.32e2 * t1194 * t2695 * t432 * t293 * sigma[2] - 0.12e2 * t1185 * t1261 * params->E * t186 + 0.64e2 * t1862 * t1299 * t2695 * sigma[2] - 0.48e2 * t1194 * t1197 * params->E - 0.48e2 * t83 * t1267 * t1196 + 0.12e2 * t1201 * t548 * t2664 - 0.6e1 * t1068 * t549 + 0.16e2 * t1182 * t515 + 0.32e2 * t507 * t1218 + 0.6e1 * t426 * t1268 - 0.48e2 * t507 * t2468;
  t2725 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t170 * t1272 - t2643 - 0.3e1 / 0.8e1 * t65 * t28 * (-0.12e2 * t1201 * t225 * t71 * t504 + 0.36e2 * t2159 * t88 * params->D * t2664 + 0.32e2 * t1053 * t84 * t2540 - 0.24e2 * t1898 * t1253 * t186 + 0.18e2 * t868 * t542 * t504 - 0.32e2 * t1182 * t1079 + 0.64e2 * t1201 * t1191 + 0.18e2 * t2675 * t1203 - 0.12e2 * t2458 * t545 - 0.16e2 * t2660 * t428 + t2719));
  tv4rhosigma319 = t6 * t2725 + t1275;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2727 = t525 * t525;
  t2735 = params->D * params->D;
  t2737 = 0.1e1 / t32 / t977;
  t2762 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t28 * (-0.24e2 * t1127 * t2737 * t291 * t293 - 0.48e2 * t1134 * t210 * t1236 * params->D - 0.24e2 * t46 * t1297 * t1299 * t2737 - 0.24e2 * t268 * t2735 * t2737 * t51 - 0.24e2 * t1357 * t2727 * t51 + 0.24e2 * t1115 * t533 + 0.24e2 * t464 * t1244 + 0.24e2 * t2572 * t211 + 0.72e2 * t2587 * t529));
  tv4sigma40 = t6 * t2762;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2763 = t541 * t541;
  t2772 = 0.1e1 / t69 / t1084;
  t2797 = my_piecewise3(t58, 0, -0.3e1 / 0.8e1 * t65 * t28 * (-0.24e2 * t1194 * t2772 * t432 * t293 - 0.48e2 * t1201 * t225 * t1260 * params->D - 0.24e2 * t83 * t1861 * t1299 * t2772 - 0.24e2 * t409 * t2735 * t2772 * t88 - 0.24e2 * t1898 * t2763 * t88 + 0.24e2 * t1182 * t549 + 0.24e2 * t507 * t1268 + 0.24e2 * t2660 * t226 + 0.72e2 * t2675 * t545));
  tv4sigma414 = t6 * t2797;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

