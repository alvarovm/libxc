/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_ol2.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t26, t27, t30, t31, t33, t38;
  double t39, t40, t42, t46, tzk0;

  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = params->bb * sigma[0];
  t21 = M_CBRT2;
  t22 = t21 * t21;
  t23 = rho[0] * rho[0];
  t24 = t18 * t18;
  t26 = 0.1e1 / t24 / t23;
  t27 = t22 * t26;
  t30 = sqrt(sigma[0]);
  t31 = params->cc * t30;
  t33 = 0.1e1 / t18 / rho[0];
  t38 = 0.4e1 * t30 * t21 * t33 + t21;
  t39 = 0.1e1 / t38;
  t40 = t21 * t33 * t39;
  t42 = params->aa + 0.13888888888888888889e-1 * t20 * t27 + t31 * t40;
  t46 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t42);
  tzk0 = 0.2e1 * t46;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t26, t27, t30, t31, t33, t38;
  double t39, t40, t42, t46, tzk0;

  double t48, t52, t54, t55, t61, t64, t65, t66;
  double t67, t70, t75, tvrho0, t78, t81, t82, t85;
  double t89, t93, tvsigma0;

  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = params->bb * sigma[0];
  t21 = M_CBRT2;
  t22 = t21 * t21;
  t23 = rho[0] * rho[0];
  t24 = t18 * t18;
  t26 = 0.1e1 / t24 / t23;
  t27 = t22 * t26;
  t30 = sqrt(sigma[0]);
  t31 = params->cc * t30;
  t33 = 0.1e1 / t18 / rho[0];
  t38 = 0.4e1 * t30 * t21 * t33 + t21;
  t39 = 0.1e1 / t38;
  t40 = t21 * t33 * t39;
  t42 = params->aa + 0.13888888888888888889e-1 * t20 * t27 + t31 * t40;
  t46 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t42);
  tzk0 = 0.2e1 * t46;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t48 = t17 / t24;
  t52 = t23 * rho[0];
  t54 = 0.1e1 / t24 / t52;
  t55 = t22 * t54;
  t61 = t21 / t18 / t23 * t39;
  t64 = params->cc * sigma[0];
  t65 = t38 * t38;
  t66 = 0.1e1 / t65;
  t67 = t55 * t66;
  t70 = -0.37037037037037037037e-1 * t20 * t55 - 0.4e1 / 0.3e1 * t31 * t61 + 0.16e2 / 0.3e1 * t64 * t67;
  t75 = my_piecewise3(t2, 0, -t6 * t48 * t42 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t70);
  tvrho0 = 0.2e1 * rho[0] * t75 + 0.2e1 * t46;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t78 = params->bb * t22;
  t81 = 0.1e1 / t30;
  t82 = params->cc * t81;
  t85 = params->cc * t22;
  t89 = 0.13888888888888888889e-1 * t78 * t26 + t82 * t40 / 0.2e1 - 0.2e1 * t85 * t26 * t66;
  t93 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t89);
  tvsigma0 = 0.2e1 * rho[0] * t93;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t26, t27, t30, t31, t33, t38;
  double t39, t40, t42, t46, tzk0;

  double t48, t52, t54, t55, t61, t64, t65, t66;
  double t67, t70, t75, tvrho0, t78, t81, t82, t85;
  double t89, t93, tvsigma0;

  double t98, t105, t107, t108, t114, t117, t120, t121;
  double t122, t123, t125, t126, t129, t134, tv2rho20, t147;
  double t148, t150, t153, t158, tv2rhosigma0, t161, t162, t165;
  double t166, t167, t169, t174, t178, tv2sigma20;

  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = params->bb * sigma[0];
  t21 = M_CBRT2;
  t22 = t21 * t21;
  t23 = rho[0] * rho[0];
  t24 = t18 * t18;
  t26 = 0.1e1 / t24 / t23;
  t27 = t22 * t26;
  t30 = sqrt(sigma[0]);
  t31 = params->cc * t30;
  t33 = 0.1e1 / t18 / rho[0];
  t38 = 0.4e1 * t30 * t21 * t33 + t21;
  t39 = 0.1e1 / t38;
  t40 = t21 * t33 * t39;
  t42 = params->aa + 0.13888888888888888889e-1 * t20 * t27 + t31 * t40;
  t46 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t42);
  tzk0 = 0.2e1 * t46;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t48 = t17 / t24;
  t52 = t23 * rho[0];
  t54 = 0.1e1 / t24 / t52;
  t55 = t22 * t54;
  t61 = t21 / t18 / t23 * t39;
  t64 = params->cc * sigma[0];
  t65 = t38 * t38;
  t66 = 0.1e1 / t65;
  t67 = t55 * t66;
  t70 = -0.37037037037037037037e-1 * t20 * t55 - 0.4e1 / 0.3e1 * t31 * t61 + 0.16e2 / 0.3e1 * t64 * t67;
  t75 = my_piecewise3(t2, 0, -t6 * t48 * t42 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t70);
  tvrho0 = 0.2e1 * rho[0] * t75 + 0.2e1 * t46;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t78 = params->bb * t22;
  t81 = 0.1e1 / t30;
  t82 = params->cc * t81;
  t85 = params->cc * t22;
  t89 = 0.13888888888888888889e-1 * t78 * t26 + t82 * t40 / 0.2e1 - 0.2e1 * t85 * t26 * t66;
  t93 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t89);
  tvsigma0 = 0.2e1 * rho[0] * t93;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t98 = t17 / t24 / rho[0];
  t105 = t23 * t23;
  t107 = 0.1e1 / t24 / t105;
  t108 = t22 * t107;
  t114 = t21 / t18 / t52 * t39;
  t117 = t108 * t66;
  t120 = t30 * sigma[0];
  t121 = params->cc * t120;
  t122 = t105 * t23;
  t123 = 0.1e1 / t122;
  t125 = 0.1e1 / t65 / t38;
  t126 = t123 * t125;
  t129 = 0.13580246913580246914e0 * t20 * t108 + 0.28e2 / 0.9e1 * t31 * t114 - 0.8e2 / 0.3e1 * t64 * t117 + 0.1024e4 / 0.9e1 * t121 * t126;
  t134 = my_piecewise3(t2, 0, t6 * t98 * t42 / 0.12e2 - t6 * t48 * t70 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t129);
  tv2rho20 = 0.2e1 * rho[0] * t134 + 0.4e1 * t75;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t147 = t105 * rho[0];
  t148 = 0.1e1 / t147;
  t150 = t125 * t30;
  t153 = -0.37037037037037037037e-1 * t78 * t54 - 0.2e1 / 0.3e1 * t82 * t61 + 0.8e1 * t85 * t54 * t66 - 0.128e3 / 0.3e1 * params->cc * t148 * t150;
  t158 = my_piecewise3(t2, 0, -t6 * t48 * t89 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t153);
  tv2rhosigma0 = 0.2e1 * rho[0] * t158 + 0.2e1 * t93;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t161 = 0.1e1 / t120;
  t162 = params->cc * t161;
  t165 = 0.1e1 / sigma[0];
  t166 = params->cc * t165;
  t167 = t27 * t66;
  t169 = 0.1e1 / t105;
  t174 = -t162 * t40 / 0.4e1 - t166 * t167 + 0.16e2 * params->cc * t169 * t125 * t81;
  t178 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t174);
  tv2sigma20 = 0.2e1 * rho[0] * t178;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t26, t27, t30, t31, t33, t38;
  double t39, t40, t42, t46, tzk0;

  double t48, t52, t54, t55, t61, t64, t65, t66;
  double t67, t70, t75, tvrho0, t78, t81, t82, t85;
  double t89, t93, tvsigma0;

  double t98, t105, t107, t108, t114, t117, t120, t121;
  double t122, t123, t125, t126, t129, t134, tv2rho20, t147;
  double t148, t150, t153, t158, tv2rhosigma0, t161, t162, t165;
  double t166, t167, t169, t174, t178, tv2sigma20;

  double t181, t192, t193, t199, t205, t206, t210, t211;
  double t212, t214, t215, t216, t221, t226, tv3rho30, t248;
  double t250, t253, t258, tv3rho2sigma0, t268, t273, t274, t277;
  double t282, tv3rhosigma20, t285, t287, t290, t291, t295, t296;
  double t298, t301, t305, tv3sigma30;

  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = params->bb * sigma[0];
  t21 = M_CBRT2;
  t22 = t21 * t21;
  t23 = rho[0] * rho[0];
  t24 = t18 * t18;
  t26 = 0.1e1 / t24 / t23;
  t27 = t22 * t26;
  t30 = sqrt(sigma[0]);
  t31 = params->cc * t30;
  t33 = 0.1e1 / t18 / rho[0];
  t38 = 0.4e1 * t30 * t21 * t33 + t21;
  t39 = 0.1e1 / t38;
  t40 = t21 * t33 * t39;
  t42 = params->aa + 0.13888888888888888889e-1 * t20 * t27 + t31 * t40;
  t46 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t42);
  tzk0 = 0.2e1 * t46;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t48 = t17 / t24;
  t52 = t23 * rho[0];
  t54 = 0.1e1 / t24 / t52;
  t55 = t22 * t54;
  t61 = t21 / t18 / t23 * t39;
  t64 = params->cc * sigma[0];
  t65 = t38 * t38;
  t66 = 0.1e1 / t65;
  t67 = t55 * t66;
  t70 = -0.37037037037037037037e-1 * t20 * t55 - 0.4e1 / 0.3e1 * t31 * t61 + 0.16e2 / 0.3e1 * t64 * t67;
  t75 = my_piecewise3(t2, 0, -t6 * t48 * t42 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t70);
  tvrho0 = 0.2e1 * rho[0] * t75 + 0.2e1 * t46;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t78 = params->bb * t22;
  t81 = 0.1e1 / t30;
  t82 = params->cc * t81;
  t85 = params->cc * t22;
  t89 = 0.13888888888888888889e-1 * t78 * t26 + t82 * t40 / 0.2e1 - 0.2e1 * t85 * t26 * t66;
  t93 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t89);
  tvsigma0 = 0.2e1 * rho[0] * t93;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t98 = t17 / t24 / rho[0];
  t105 = t23 * t23;
  t107 = 0.1e1 / t24 / t105;
  t108 = t22 * t107;
  t114 = t21 / t18 / t52 * t39;
  t117 = t108 * t66;
  t120 = t30 * sigma[0];
  t121 = params->cc * t120;
  t122 = t105 * t23;
  t123 = 0.1e1 / t122;
  t125 = 0.1e1 / t65 / t38;
  t126 = t123 * t125;
  t129 = 0.13580246913580246914e0 * t20 * t108 + 0.28e2 / 0.9e1 * t31 * t114 - 0.8e2 / 0.3e1 * t64 * t117 + 0.1024e4 / 0.9e1 * t121 * t126;
  t134 = my_piecewise3(t2, 0, t6 * t98 * t42 / 0.12e2 - t6 * t48 * t70 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t129);
  tv2rho20 = 0.2e1 * rho[0] * t134 + 0.4e1 * t75;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t147 = t105 * rho[0];
  t148 = 0.1e1 / t147;
  t150 = t125 * t30;
  t153 = -0.37037037037037037037e-1 * t78 * t54 - 0.2e1 / 0.3e1 * t82 * t61 + 0.8e1 * t85 * t54 * t66 - 0.128e3 / 0.3e1 * params->cc * t148 * t150;
  t158 = my_piecewise3(t2, 0, -t6 * t48 * t89 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t153);
  tv2rhosigma0 = 0.2e1 * rho[0] * t158 + 0.2e1 * t93;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t161 = 0.1e1 / t120;
  t162 = params->cc * t161;
  t165 = 0.1e1 / sigma[0];
  t166 = params->cc * t165;
  t167 = t27 * t66;
  t169 = 0.1e1 / t105;
  t174 = -t162 * t40 / 0.4e1 - t166 * t167 + 0.16e2 * params->cc * t169 * t125 * t81;
  t178 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t174);
  tv2sigma20 = 0.2e1 * rho[0] * t178;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t181 = t17 * t26;
  t192 = 0.1e1 / t24 / t147;
  t193 = t22 * t192;
  t199 = t21 / t18 / t105 * t39;
  t205 = t105 * t52;
  t206 = 0.1e1 / t205;
  t210 = sigma[0] * sigma[0];
  t211 = params->cc * t210;
  t212 = t105 * t105;
  t214 = 0.1e1 / t18 / t212;
  t215 = t65 * t65;
  t216 = 0.1e1 / t215;
  t221 = -0.63374485596707818932e0 * t20 * t193 - 0.28e3 / 0.27e2 * t31 * t199 + 0.3808e4 / 0.27e2 * t64 * t193 * t66 - 0.11264e5 / 0.9e1 * t121 * t206 * t125 + 0.16384e5 / 0.9e1 * t211 * t214 * t216 * t21;
  t226 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t181 * t42 + t6 * t98 * t70 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t48 * t129 - 0.3e1 / 0.8e1 * t6 * t19 * t221);
  tv3rho30 = 0.2e1 * rho[0] * t226 + 0.6e1 * t134;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t248 = params->cc / t18 / t205;
  t250 = t216 * sigma[0] * t21;
  t253 = 0.13580246913580246914e0 * t78 * t107 + 0.14e2 / 0.9e1 * t82 * t114 - 0.296e3 / 0.9e1 * t85 * t107 * t66 + 0.384e3 * params->cc * t123 * t150 - 0.2048e4 / 0.3e1 * t248 * t250;
  t258 = my_piecewise3(t2, 0, t6 * t98 * t89 / 0.12e2 - t6 * t48 * t153 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t253);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t258 + 0.4e1 * t158;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t268 = t148 * t125;
  t273 = params->cc / t18 / t122;
  t274 = t216 * t21;
  t277 = t162 * t61 / 0.3e1 + 0.4e1 / 0.3e1 * t166 * t67 - 0.256e3 / 0.3e1 * t82 * t268 + 0.256e3 * t273 * t274;
  t282 = my_piecewise3(t2, 0, -t6 * t48 * t174 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t277);
  tv3rhosigma20 = 0.2e1 * rho[0] * t282 + 0.2e1 * t178;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t285 = t30 * t210;
  t287 = params->cc / t285;
  t290 = 0.1e1 / t210;
  t291 = params->cc * t290;
  t295 = 0.1e1 / t18 / t147;
  t296 = params->cc * t295;
  t298 = t216 * t165 * t21;
  t301 = 0.3e1 / 0.8e1 * t287 * t40 + 0.3e1 / 0.2e1 * t291 * t167 - 0.96e2 * t296 * t298;
  t305 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t301);
  tv3sigma30 = 0.2e1 * rho[0] * t305;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t26, t27, t30, t31, t33, t38;
  double t39, t40, t42, t46, tzk0;

  double t48, t52, t54, t55, t61, t64, t65, t66;
  double t67, t70, t75, tvrho0, t78, t81, t82, t85;
  double t89, t93, tvsigma0;

  double t98, t105, t107, t108, t114, t117, t120, t121;
  double t122, t123, t125, t126, t129, t134, tv2rho20, t147;
  double t148, t150, t153, t158, tv2rhosigma0, t161, t162, t165;
  double t166, t167, t169, t174, t178, tv2sigma20;

  double t181, t192, t193, t199, t205, t206, t210, t211;
  double t212, t214, t215, t216, t221, t226, tv3rho30, t248;
  double t250, t253, t258, tv3rho2sigma0, t268, t273, t274, t277;
  double t282, tv3rhosigma20, t285, t287, t290, t291, t295, t296;
  double t298, t301, t305, tv3sigma30;

  double t322, t323, t337, t349, t359, tv4rho40, t397, tv4rho3sigma0;
  double t427, tv4rho2sigma20, t453, tv4rhosigma30, t456, t482, tv4sigma40;

  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = params->bb * sigma[0];
  t21 = M_CBRT2;
  t22 = t21 * t21;
  t23 = rho[0] * rho[0];
  t24 = t18 * t18;
  t26 = 0.1e1 / t24 / t23;
  t27 = t22 * t26;
  t30 = sqrt(sigma[0]);
  t31 = params->cc * t30;
  t33 = 0.1e1 / t18 / rho[0];
  t38 = 0.4e1 * t30 * t21 * t33 + t21;
  t39 = 0.1e1 / t38;
  t40 = t21 * t33 * t39;
  t42 = params->aa + 0.13888888888888888889e-1 * t20 * t27 + t31 * t40;
  t46 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t42);
  tzk0 = 0.2e1 * t46;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t48 = t17 / t24;
  t52 = t23 * rho[0];
  t54 = 0.1e1 / t24 / t52;
  t55 = t22 * t54;
  t61 = t21 / t18 / t23 * t39;
  t64 = params->cc * sigma[0];
  t65 = t38 * t38;
  t66 = 0.1e1 / t65;
  t67 = t55 * t66;
  t70 = -0.37037037037037037037e-1 * t20 * t55 - 0.4e1 / 0.3e1 * t31 * t61 + 0.16e2 / 0.3e1 * t64 * t67;
  t75 = my_piecewise3(t2, 0, -t6 * t48 * t42 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t70);
  tvrho0 = 0.2e1 * rho[0] * t75 + 0.2e1 * t46;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t78 = params->bb * t22;
  t81 = 0.1e1 / t30;
  t82 = params->cc * t81;
  t85 = params->cc * t22;
  t89 = 0.13888888888888888889e-1 * t78 * t26 + t82 * t40 / 0.2e1 - 0.2e1 * t85 * t26 * t66;
  t93 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t89);
  tvsigma0 = 0.2e1 * rho[0] * t93;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t98 = t17 / t24 / rho[0];
  t105 = t23 * t23;
  t107 = 0.1e1 / t24 / t105;
  t108 = t22 * t107;
  t114 = t21 / t18 / t52 * t39;
  t117 = t108 * t66;
  t120 = t30 * sigma[0];
  t121 = params->cc * t120;
  t122 = t105 * t23;
  t123 = 0.1e1 / t122;
  t125 = 0.1e1 / t65 / t38;
  t126 = t123 * t125;
  t129 = 0.13580246913580246914e0 * t20 * t108 + 0.28e2 / 0.9e1 * t31 * t114 - 0.8e2 / 0.3e1 * t64 * t117 + 0.1024e4 / 0.9e1 * t121 * t126;
  t134 = my_piecewise3(t2, 0, t6 * t98 * t42 / 0.12e2 - t6 * t48 * t70 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t129);
  tv2rho20 = 0.2e1 * rho[0] * t134 + 0.4e1 * t75;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t147 = t105 * rho[0];
  t148 = 0.1e1 / t147;
  t150 = t125 * t30;
  t153 = -0.37037037037037037037e-1 * t78 * t54 - 0.2e1 / 0.3e1 * t82 * t61 + 0.8e1 * t85 * t54 * t66 - 0.128e3 / 0.3e1 * params->cc * t148 * t150;
  t158 = my_piecewise3(t2, 0, -t6 * t48 * t89 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t153);
  tv2rhosigma0 = 0.2e1 * rho[0] * t158 + 0.2e1 * t93;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t161 = 0.1e1 / t120;
  t162 = params->cc * t161;
  t165 = 0.1e1 / sigma[0];
  t166 = params->cc * t165;
  t167 = t27 * t66;
  t169 = 0.1e1 / t105;
  t174 = -t162 * t40 / 0.4e1 - t166 * t167 + 0.16e2 * params->cc * t169 * t125 * t81;
  t178 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t174);
  tv2sigma20 = 0.2e1 * rho[0] * t178;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t181 = t17 * t26;
  t192 = 0.1e1 / t24 / t147;
  t193 = t22 * t192;
  t199 = t21 / t18 / t105 * t39;
  t205 = t105 * t52;
  t206 = 0.1e1 / t205;
  t210 = sigma[0] * sigma[0];
  t211 = params->cc * t210;
  t212 = t105 * t105;
  t214 = 0.1e1 / t18 / t212;
  t215 = t65 * t65;
  t216 = 0.1e1 / t215;
  t221 = -0.63374485596707818932e0 * t20 * t193 - 0.28e3 / 0.27e2 * t31 * t199 + 0.3808e4 / 0.27e2 * t64 * t193 * t66 - 0.11264e5 / 0.9e1 * t121 * t206 * t125 + 0.16384e5 / 0.9e1 * t211 * t214 * t216 * t21;
  t226 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t181 * t42 + t6 * t98 * t70 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t48 * t129 - 0.3e1 / 0.8e1 * t6 * t19 * t221);
  tv3rho30 = 0.2e1 * rho[0] * t226 + 0.6e1 * t134;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t248 = params->cc / t18 / t205;
  t250 = t216 * sigma[0] * t21;
  t253 = 0.13580246913580246914e0 * t78 * t107 + 0.14e2 / 0.9e1 * t82 * t114 - 0.296e3 / 0.9e1 * t85 * t107 * t66 + 0.384e3 * params->cc * t123 * t150 - 0.2048e4 / 0.3e1 * t248 * t250;
  t258 = my_piecewise3(t2, 0, t6 * t98 * t89 / 0.12e2 - t6 * t48 * t153 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t253);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t258 + 0.4e1 * t158;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t268 = t148 * t125;
  t273 = params->cc / t18 / t122;
  t274 = t216 * t21;
  t277 = t162 * t61 / 0.3e1 + 0.4e1 / 0.3e1 * t166 * t67 - 0.256e3 / 0.3e1 * t82 * t268 + 0.256e3 * t273 * t274;
  t282 = my_piecewise3(t2, 0, -t6 * t48 * t174 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t277);
  tv3rhosigma20 = 0.2e1 * rho[0] * t282 + 0.2e1 * t178;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t285 = t30 * t210;
  t287 = params->cc / t285;
  t290 = 0.1e1 / t210;
  t291 = params->cc * t290;
  t295 = 0.1e1 / t18 / t147;
  t296 = params->cc * t295;
  t298 = t216 * t165 * t21;
  t301 = 0.3e1 / 0.8e1 * t287 * t40 + 0.3e1 / 0.2e1 * t291 * t167 - 0.96e2 * t296 * t298;
  t305 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t301);
  tv3sigma30 = 0.2e1 * rho[0] * t305;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t322 = 0.1e1 / t24 / t122;
  t323 = t22 * t322;
  t337 = t212 * rho[0];
  t349 = 0.1e1 / t215 / t38;
  t359 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t54 * t42 - 0.5e1 / 0.9e1 * t6 * t181 * t70 + t6 * t98 * t129 / 0.2e1 - t6 * t48 * t221 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (0.35912208504801097395e1 * t20 * t323 + 0.364e4 / 0.81e2 * t31 * t21 * t295 * t39 - 0.23072e5 / 0.27e2 * t64 * t323 * t66 + 0.953344e6 / 0.81e2 * t121 / t212 * t125 - 0.950272e6 / 0.27e2 * t211 / t18 / t337 * t216 * t21 + 0.1048576e7 / 0.27e2 * params->cc * t285 / t24 / t212 / t23 * t349 * t22));
  tv4rho40 = 0.2e1 * rho[0] * t359 + 0.8e1 * t226;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t397 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t181 * t89 + t6 * t98 * t153 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t48 * t253 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.63374485596707818932e0 * t78 * t192 - 0.14e3 / 0.27e2 * t82 * t199 + 0.1456e4 / 0.9e1 * t85 * t192 * t66 - 0.81152e5 / 0.27e2 * params->cc * t206 * t150 + 0.100352e6 / 0.9e1 * params->cc * t214 * t250 - 0.131072e6 / 0.9e1 * params->cc / t24 / t337 * t349 * t120 * t22));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t397 + 0.6e1 * t258;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t427 = my_piecewise3(t2, 0, t6 * t98 * t174 / 0.12e2 - t6 * t48 * t277 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-0.7e1 / 0.9e1 * t162 * t114 - 0.28e2 / 0.9e1 * t166 * t117 + 0.4096e4 / 0.9e1 * t82 * t126 - 0.896e4 / 0.3e1 * t248 * t274 + 0.16384e5 / 0.3e1 * params->cc / t24 / t212 * t349 * t22 * t30));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t427 + 0.4e1 * t282;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t453 = my_piecewise3(t2, 0, -t6 * t48 * t301 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (-t287 * t61 / 0.2e1 - 0.2e1 * t291 * t67 + 0.32e2 * t162 * t268 + 0.512e3 * t273 * t298 - 0.2048e4 * params->cc / t24 / t205 * t349 * t81 * t22));
  tv4rhosigma30 = 0.2e1 * rho[0] * t453 + 0.2e1 * t305;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t456 = t210 * sigma[0];
  t482 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (-0.15e2 / 0.16e2 * params->cc / t30 / t456 * t40 - 0.15e2 / 0.4e1 * params->cc / t456 * t167 - 0.12e2 * t287 * t169 * t125 + 0.768e3 * params->cc * t322 * t349 * t161 * t22 + 0.96e2 * t296 * t216 * t290 * t21));
  tv4sigma40 = 0.2e1 * rho[0] * t482;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t33, t36, t37, t39, t40, t43, t44;
  double t45, t47, t51, t52, t53, t54, t55, t56;
  double t58, t59, t60, t61, t62, t63, t65, t68;
  double t69, t71, t74, t75, t76, t78, t82, tzk0;

  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->bb * sigma[0];
  t29 = rho[0] * rho[0];
  t30 = POW_1_3(rho[0]);
  t31 = t30 * t30;
  t33 = 0.1e1 / t31 / t29;
  t36 = sqrt(sigma[0]);
  t37 = params->cc * t36;
  t39 = 0.1e1 / t30 / rho[0];
  t40 = M_CBRT2;
  t43 = 0.4e1 * t36 * t39 + t40;
  t44 = 0.1e1 / t43;
  t45 = t39 * t44;
  t47 = params->aa + 0.13888888888888888889e-1 * t28 * t33 + t37 * t45;
  t51 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t47);
  t52 = rho[1] <= p->dens_threshold;
  t53 = my_piecewise5(t14, t11, t10, t15, -t17);
  t54 = 0.1e1 + t53;
  t55 = t54 <= p->zeta_threshold;
  t56 = POW_1_3(t54);
  t58 = my_piecewise3(t55, t22, t56 * t54);
  t59 = t58 * t26;
  t60 = params->bb * sigma[2];
  t61 = rho[1] * rho[1];
  t62 = POW_1_3(rho[1]);
  t63 = t62 * t62;
  t65 = 0.1e1 / t63 / t61;
  t68 = sqrt(sigma[2]);
  t69 = params->cc * t68;
  t71 = 0.1e1 / t62 / rho[1];
  t74 = 0.4e1 * t68 * t71 + t40;
  t75 = 0.1e1 / t74;
  t76 = t71 * t75;
  t78 = params->aa + 0.13888888888888888889e-1 * t60 * t65 + t69 * t76;
  t82 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t78);
  tzk0 = t51 + t82;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t33, t36, t37, t39, t40, t43, t44;
  double t45, t47, t51, t52, t53, t54, t55, t56;
  double t58, t59, t60, t61, t62, t63, t65, t68;
  double t69, t71, t74, t75, t76, t78, t82, tzk0;

  double t83, t84, t85, t86, t87, t90, t91, t95;
  double t96, t97, t100, t101, t103, t108, t111, t112;
  double t113, t114, t117, t122, t124, t127, t128, t132;
  double t135, t137, tvrho0, t140, t141, t144, t145, t150;
  double t152, t155, t156, t160, t162, t167, t170, t171;
  double t172, t173, t176, t181, tvrho1, t186, t187, t193;
  double t197, tvsigma0, tvsigma1, t200, t201, t207, t211, tvsigma2;

  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->bb * sigma[0];
  t29 = rho[0] * rho[0];
  t30 = POW_1_3(rho[0]);
  t31 = t30 * t30;
  t33 = 0.1e1 / t31 / t29;
  t36 = sqrt(sigma[0]);
  t37 = params->cc * t36;
  t39 = 0.1e1 / t30 / rho[0];
  t40 = M_CBRT2;
  t43 = 0.4e1 * t36 * t39 + t40;
  t44 = 0.1e1 / t43;
  t45 = t39 * t44;
  t47 = params->aa + 0.13888888888888888889e-1 * t28 * t33 + t37 * t45;
  t51 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t47);
  t52 = rho[1] <= p->dens_threshold;
  t53 = my_piecewise5(t14, t11, t10, t15, -t17);
  t54 = 0.1e1 + t53;
  t55 = t54 <= p->zeta_threshold;
  t56 = POW_1_3(t54);
  t58 = my_piecewise3(t55, t22, t56 * t54);
  t59 = t58 * t26;
  t60 = params->bb * sigma[2];
  t61 = rho[1] * rho[1];
  t62 = POW_1_3(rho[1]);
  t63 = t62 * t62;
  t65 = 0.1e1 / t63 / t61;
  t68 = sqrt(sigma[2]);
  t69 = params->cc * t68;
  t71 = 0.1e1 / t62 / rho[1];
  t74 = 0.4e1 * t68 * t71 + t40;
  t75 = 0.1e1 / t74;
  t76 = t71 * t75;
  t78 = params->aa + 0.13888888888888888889e-1 * t60 * t65 + t69 * t76;
  t82 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t78);
  tzk0 = t51 + t82;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t83 = t6 * t6;
  t84 = 0.1e1 / t83;
  t85 = t16 * t84;
  t86 = t7 - t85;
  t87 = my_piecewise5(t10, 0, t14, 0, t86);
  t90 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t87);
  t91 = t90 * t26;
  t95 = t26 * t26;
  t96 = 0.1e1 / t95;
  t97 = t25 * t96;
  t100 = t5 * t97 * t47 / 0.8e1;
  t101 = t29 * rho[0];
  t103 = 0.1e1 / t31 / t101;
  t108 = 0.1e1 / t30 / t29 * t44;
  t111 = params->cc * sigma[0];
  t112 = t43 * t43;
  t113 = 0.1e1 / t112;
  t114 = t103 * t113;
  t117 = -0.37037037037037037037e-1 * t28 * t103 - 0.4e1 / 0.3e1 * t37 * t108 + 0.16e2 / 0.3e1 * t111 * t114;
  t122 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t91 * t47 - t100 - 0.3e1 / 0.8e1 * t5 * t27 * t117);
  t124 = my_piecewise5(t14, 0, t10, 0, -t86);
  t127 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t124);
  t128 = t127 * t26;
  t132 = t58 * t96;
  t135 = t5 * t132 * t78 / 0.8e1;
  t137 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t128 * t78 - t135);
  tvrho0 = t51 + t82 + t6 * (t122 + t137);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t140 = -t7 - t85;
  t141 = my_piecewise5(t10, 0, t14, 0, t140);
  t144 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t141);
  t145 = t144 * t26;
  t150 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t145 * t47 - t100);
  t152 = my_piecewise5(t14, 0, t10, 0, -t140);
  t155 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t152);
  t156 = t155 * t26;
  t160 = t61 * rho[1];
  t162 = 0.1e1 / t63 / t160;
  t167 = 0.1e1 / t62 / t61 * t75;
  t170 = params->cc * sigma[2];
  t171 = t74 * t74;
  t172 = 0.1e1 / t171;
  t173 = t162 * t172;
  t176 = -0.37037037037037037037e-1 * t60 * t162 - 0.4e1 / 0.3e1 * t69 * t167 + 0.16e2 / 0.3e1 * t170 * t173;
  t181 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t156 * t78 - t135 - 0.3e1 / 0.8e1 * t5 * t59 * t176);
  tvrho1 = t51 + t82 + t6 * (t150 + t181);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t186 = 0.1e1 / t36;
  t187 = params->cc * t186;
  t193 = 0.13888888888888888889e-1 * params->bb * t33 + t187 * t45 / 0.2e1 - 0.2e1 * params->cc * t33 * t113;
  t197 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t193);
  tvsigma0 = t6 * t197;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t200 = 0.1e1 / t68;
  t201 = params->cc * t200;
  t207 = 0.13888888888888888889e-1 * params->bb * t65 + t201 * t76 / 0.2e1 - 0.2e1 * params->cc * t65 * t172;
  t211 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t207);
  tvsigma2 = t6 * t211;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t33, t36, t37, t39, t40, t43, t44;
  double t45, t47, t51, t52, t53, t54, t55, t56;
  double t58, t59, t60, t61, t62, t63, t65, t68;
  double t69, t71, t74, t75, t76, t78, t82, tzk0;

  double t83, t84, t85, t86, t87, t90, t91, t95;
  double t96, t97, t100, t101, t103, t108, t111, t112;
  double t113, t114, t117, t122, t124, t127, t128, t132;
  double t135, t137, tvrho0, t140, t141, t144, t145, t150;
  double t152, t155, t156, t160, t162, t167, t170, t171;
  double t172, t173, t176, t181, tvrho1, t186, t187, t193;
  double t197, tvsigma0, tvsigma1, t200, t201, t207, t211, tvsigma2;

  double t214, t215, t216, t219, t220, t221, t223, t224;
  double t228, t229, t233, t235, t241, t242, t245, t247;
  double t249, t251, t256, t259, t262, t263, t264, t265;
  double t267, t268, t271, t276, t277, t278, t279, t283;
  double t287, t288, t292, t294, t296, t299, t301, tv2rho20;
  double t304, t307, t308, t312, t313, t317, t319, t327;
  double t328, t331, t335, t336, t340, t342, t349, t352;
  double tv2rho21, t357, t361, t362, t366, t367, t373, t374;
  double t378, t382, t383, t392, t394, t399, t402, t405;
  double t406, t407, t408, t410, t411, t414, t419, tv2rho22;
  double t427, t435, t436, t438, t441, t446, tv2rhosigma0, tv2rhosigma1;
  double t453, t455, tv2rhosigma2, t461, tv2rhosigma3, tv2rhosigma4, t473, t474;
  double t476, t479, t484, tv2rhosigma5, t486, t487, t490, t491;
  double t492, t494, t499, t503, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t504, t505, t508, t509, t510, t512, t517;
  double t521, tv2sigma25;

  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->bb * sigma[0];
  t29 = rho[0] * rho[0];
  t30 = POW_1_3(rho[0]);
  t31 = t30 * t30;
  t33 = 0.1e1 / t31 / t29;
  t36 = sqrt(sigma[0]);
  t37 = params->cc * t36;
  t39 = 0.1e1 / t30 / rho[0];
  t40 = M_CBRT2;
  t43 = 0.4e1 * t36 * t39 + t40;
  t44 = 0.1e1 / t43;
  t45 = t39 * t44;
  t47 = params->aa + 0.13888888888888888889e-1 * t28 * t33 + t37 * t45;
  t51 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t47);
  t52 = rho[1] <= p->dens_threshold;
  t53 = my_piecewise5(t14, t11, t10, t15, -t17);
  t54 = 0.1e1 + t53;
  t55 = t54 <= p->zeta_threshold;
  t56 = POW_1_3(t54);
  t58 = my_piecewise3(t55, t22, t56 * t54);
  t59 = t58 * t26;
  t60 = params->bb * sigma[2];
  t61 = rho[1] * rho[1];
  t62 = POW_1_3(rho[1]);
  t63 = t62 * t62;
  t65 = 0.1e1 / t63 / t61;
  t68 = sqrt(sigma[2]);
  t69 = params->cc * t68;
  t71 = 0.1e1 / t62 / rho[1];
  t74 = 0.4e1 * t68 * t71 + t40;
  t75 = 0.1e1 / t74;
  t76 = t71 * t75;
  t78 = params->aa + 0.13888888888888888889e-1 * t60 * t65 + t69 * t76;
  t82 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t78);
  tzk0 = t51 + t82;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t83 = t6 * t6;
  t84 = 0.1e1 / t83;
  t85 = t16 * t84;
  t86 = t7 - t85;
  t87 = my_piecewise5(t10, 0, t14, 0, t86);
  t90 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t87);
  t91 = t90 * t26;
  t95 = t26 * t26;
  t96 = 0.1e1 / t95;
  t97 = t25 * t96;
  t100 = t5 * t97 * t47 / 0.8e1;
  t101 = t29 * rho[0];
  t103 = 0.1e1 / t31 / t101;
  t108 = 0.1e1 / t30 / t29 * t44;
  t111 = params->cc * sigma[0];
  t112 = t43 * t43;
  t113 = 0.1e1 / t112;
  t114 = t103 * t113;
  t117 = -0.37037037037037037037e-1 * t28 * t103 - 0.4e1 / 0.3e1 * t37 * t108 + 0.16e2 / 0.3e1 * t111 * t114;
  t122 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t91 * t47 - t100 - 0.3e1 / 0.8e1 * t5 * t27 * t117);
  t124 = my_piecewise5(t14, 0, t10, 0, -t86);
  t127 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t124);
  t128 = t127 * t26;
  t132 = t58 * t96;
  t135 = t5 * t132 * t78 / 0.8e1;
  t137 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t128 * t78 - t135);
  tvrho0 = t51 + t82 + t6 * (t122 + t137);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t140 = -t7 - t85;
  t141 = my_piecewise5(t10, 0, t14, 0, t140);
  t144 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t141);
  t145 = t144 * t26;
  t150 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t145 * t47 - t100);
  t152 = my_piecewise5(t14, 0, t10, 0, -t140);
  t155 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t152);
  t156 = t155 * t26;
  t160 = t61 * rho[1];
  t162 = 0.1e1 / t63 / t160;
  t167 = 0.1e1 / t62 / t61 * t75;
  t170 = params->cc * sigma[2];
  t171 = t74 * t74;
  t172 = 0.1e1 / t171;
  t173 = t162 * t172;
  t176 = -0.37037037037037037037e-1 * t60 * t162 - 0.4e1 / 0.3e1 * t69 * t167 + 0.16e2 / 0.3e1 * t170 * t173;
  t181 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t156 * t78 - t135 - 0.3e1 / 0.8e1 * t5 * t59 * t176);
  tvrho1 = t51 + t82 + t6 * (t150 + t181);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t186 = 0.1e1 / t36;
  t187 = params->cc * t186;
  t193 = 0.13888888888888888889e-1 * params->bb * t33 + t187 * t45 / 0.2e1 - 0.2e1 * params->cc * t33 * t113;
  t197 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t193);
  tvsigma0 = t6 * t197;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t200 = 0.1e1 / t68;
  t201 = params->cc * t200;
  t207 = 0.13888888888888888889e-1 * params->bb * t65 + t201 * t76 / 0.2e1 - 0.2e1 * params->cc * t65 * t172;
  t211 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t207);
  tvsigma2 = t6 * t211;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t214 = t23 * t23;
  t215 = 0.1e1 / t214;
  t216 = t87 * t87;
  t219 = t83 * t6;
  t220 = 0.1e1 / t219;
  t221 = t16 * t220;
  t223 = -0.2e1 * t84 + 0.2e1 * t221;
  t224 = my_piecewise5(t10, 0, t14, 0, t223);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t215 * t216 + 0.4e1 / 0.3e1 * t23 * t224);
  t229 = t228 * t26;
  t233 = t90 * t96;
  t235 = t5 * t233 * t47;
  t241 = 0.1e1 / t95 / t6;
  t242 = t25 * t241;
  t245 = t5 * t242 * t47 / 0.12e2;
  t247 = t5 * t97 * t117;
  t249 = t29 * t29;
  t251 = 0.1e1 / t31 / t249;
  t256 = 0.1e1 / t30 / t101 * t44;
  t259 = t251 * t113;
  t262 = t36 * sigma[0];
  t263 = params->cc * t262;
  t264 = t249 * t29;
  t265 = 0.1e1 / t264;
  t267 = 0.1e1 / t112 / t43;
  t268 = t265 * t267;
  t271 = 0.13580246913580246914e0 * t28 * t251 + 0.28e2 / 0.9e1 * t37 * t256 - 0.8e2 / 0.3e1 * t111 * t259 + 0.512e3 / 0.9e1 * t263 * t268;
  t276 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t47 - t235 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t91 * t117 + t245 - t247 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t271);
  t277 = t56 * t56;
  t278 = 0.1e1 / t277;
  t279 = t124 * t124;
  t283 = my_piecewise5(t14, 0, t10, 0, -t223);
  t287 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t278 * t279 + 0.4e1 / 0.3e1 * t56 * t283);
  t288 = t287 * t26;
  t292 = t127 * t96;
  t294 = t5 * t292 * t78;
  t296 = t58 * t241;
  t299 = t5 * t296 * t78 / 0.12e2;
  t301 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t288 * t78 - t294 / 0.4e1 + t299);
  tv2rho20 = 0.2e1 * t122 + 0.2e1 * t137 + t6 * (t276 + t301);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t304 = t215 * t141;
  t307 = 0.2e1 * t221;
  t308 = my_piecewise5(t10, 0, t14, 0, t307);
  t312 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t304 * t87 + 0.4e1 / 0.3e1 * t23 * t308);
  t313 = t312 * t26;
  t317 = t144 * t96;
  t319 = t5 * t317 * t47;
  t327 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t313 * t47 - t319 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t145 * t117 - t235 / 0.8e1 + t245 - t247 / 0.8e1);
  t328 = t278 * t152;
  t331 = my_piecewise5(t14, 0, t10, 0, -t307);
  t335 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t328 * t124 + 0.4e1 / 0.3e1 * t56 * t331);
  t336 = t335 * t26;
  t340 = t155 * t96;
  t342 = t5 * t340 * t78;
  t349 = t5 * t132 * t176;
  t352 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t336 * t78 - t342 / 0.8e1 - t294 / 0.8e1 + t299 - 0.3e1 / 0.8e1 * t5 * t128 * t176 - t349 / 0.8e1);
  tv2rho21 = t122 + t137 + t150 + t181 + t6 * (t327 + t352);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t357 = t141 * t141;
  t361 = 0.2e1 * t84 + 0.2e1 * t221;
  t362 = my_piecewise5(t10, 0, t14, 0, t361);
  t366 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t215 * t357 + 0.4e1 / 0.3e1 * t23 * t362);
  t367 = t366 * t26;
  t373 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t367 * t47 - t319 / 0.4e1 + t245);
  t374 = t152 * t152;
  t378 = my_piecewise5(t14, 0, t10, 0, -t361);
  t382 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t278 * t374 + 0.4e1 / 0.3e1 * t56 * t378);
  t383 = t382 * t26;
  t392 = t61 * t61;
  t394 = 0.1e1 / t63 / t392;
  t399 = 0.1e1 / t62 / t160 * t75;
  t402 = t394 * t172;
  t405 = t68 * sigma[2];
  t406 = params->cc * t405;
  t407 = t392 * t61;
  t408 = 0.1e1 / t407;
  t410 = 0.1e1 / t171 / t74;
  t411 = t408 * t410;
  t414 = 0.13580246913580246914e0 * t60 * t394 + 0.28e2 / 0.9e1 * t69 * t399 - 0.8e2 / 0.3e1 * t170 * t402 + 0.512e3 / 0.9e1 * t406 * t411;
  t419 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t383 * t78 - t342 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t156 * t176 + t299 - t349 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t59 * t414);
  tv2rho22 = 0.2e1 * t150 + 0.2e1 * t181 + t6 * (t373 + t419);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t427 = t5 * t97 * t193 / 0.8e1;
  t435 = t249 * rho[0];
  t436 = 0.1e1 / t435;
  t438 = t267 * t36;
  t441 = -0.37037037037037037037e-1 * params->bb * t103 - 0.2e1 / 0.3e1 * t187 * t108 + 0.8e1 * params->cc * t103 * t113 - 0.64e2 / 0.3e1 * params->cc * t436 * t438;
  t446 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t91 * t193 - t427 - 0.3e1 / 0.8e1 * t5 * t27 * t441);
  tv2rhosigma0 = t6 * t446 + t197;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t453 = t5 * t132 * t207 / 0.8e1;
  t455 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t128 * t207 - t453);
  tv2rhosigma2 = t6 * t455 + t211;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t461 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t145 * t193 - t427);
  tv2rhosigma3 = t6 * t461 + t197;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t473 = t392 * rho[1];
  t474 = 0.1e1 / t473;
  t476 = t410 * t68;
  t479 = -0.37037037037037037037e-1 * params->bb * t162 - 0.2e1 / 0.3e1 * t201 * t167 + 0.8e1 * params->cc * t162 * t172 - 0.64e2 / 0.3e1 * params->cc * t474 * t476;
  t484 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t156 * t207 - t453 - 0.3e1 / 0.8e1 * t5 * t59 * t479);
  tv2rhosigma5 = t6 * t484 + t211;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t486 = 0.1e1 / t262;
  t487 = params->cc * t486;
  t490 = 0.1e1 / sigma[0];
  t491 = params->cc * t490;
  t492 = t33 * t113;
  t494 = 0.1e1 / t249;
  t499 = -t487 * t45 / 0.4e1 - t491 * t492 + 0.8e1 * params->cc * t494 * t267 * t186;
  t503 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t499);
  tv2sigma20 = t6 * t503;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t504 = 0.1e1 / t405;
  t505 = params->cc * t504;
  t508 = 0.1e1 / sigma[2];
  t509 = params->cc * t508;
  t510 = t65 * t172;
  t512 = 0.1e1 / t392;
  t517 = -t505 * t76 / 0.4e1 - t509 * t510 + 0.8e1 * params->cc * t512 * t410 * t200;
  t521 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t517);
  tv2sigma25 = t6 * t521;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t33, t36, t37, t39, t40, t43, t44;
  double t45, t47, t51, t52, t53, t54, t55, t56;
  double t58, t59, t60, t61, t62, t63, t65, t68;
  double t69, t71, t74, t75, t76, t78, t82, tzk0;

  double t83, t84, t85, t86, t87, t90, t91, t95;
  double t96, t97, t100, t101, t103, t108, t111, t112;
  double t113, t114, t117, t122, t124, t127, t128, t132;
  double t135, t137, tvrho0, t140, t141, t144, t145, t150;
  double t152, t155, t156, t160, t162, t167, t170, t171;
  double t172, t173, t176, t181, tvrho1, t186, t187, t193;
  double t197, tvsigma0, tvsigma1, t200, t201, t207, t211, tvsigma2;

  double t214, t215, t216, t219, t220, t221, t223, t224;
  double t228, t229, t233, t235, t241, t242, t245, t247;
  double t249, t251, t256, t259, t262, t263, t264, t265;
  double t267, t268, t271, t276, t277, t278, t279, t283;
  double t287, t288, t292, t294, t296, t299, t301, tv2rho20;
  double t304, t307, t308, t312, t313, t317, t319, t327;
  double t328, t331, t335, t336, t340, t342, t349, t352;
  double tv2rho21, t357, t361, t362, t366, t367, t373, t374;
  double t378, t382, t383, t392, t394, t399, t402, t405;
  double t406, t407, t408, t410, t411, t414, t419, tv2rho22;
  double t427, t435, t436, t438, t441, t446, tv2rhosigma0, tv2rhosigma1;
  double t453, t455, tv2rhosigma2, t461, tv2rhosigma3, tv2rhosigma4, t473, t474;
  double t476, t479, t484, tv2rhosigma5, t486, t487, t490, t491;
  double t492, t494, t499, t503, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t504, t505, t508, t509, t510, t512, t517;
  double t521, tv2sigma25;

  double t525, t526, t529, t532, t533, t534, t536, t537;
  double t541, t542, t546, t548, t553, t555, t558, t564;
  double t565, t568, t570, t573, t576, t581, t587, t588;
  double t592, t593, t594, t596, t597, t598, t602, t607;
  double t609, t610, t613, t617, t621, t622, t626, t628;
  double t630, t632, t634, t637, t639, tv3rho30, t642, t643;
  double t644, t647, t652, t653, t654, t655, t659, t660;
  double t664, t667, t671, t673, t677, t686, t687, t688;
  double t691, t697, t701, t702, t706, t709, t710, t712;
  double t721, t723, t726, tv3rho31, t729, t734, t737, t738;
  double t742, t743, t747, t749, t758, t759, t764, t768;
  double t772, t773, t777, t779, t786, t794, t796, t797;
  double tv3rho32, t802, t808, t809, t813, t814, t821, t822;
  double t828, t832, t833, t849, t854, t860, t861, t865;
  double t866, t867, t869, t870, t871, t875, t880, tv3rho33;
  double t888, t895, t897, t911, t912, t915, t920, tv3rho2sigma0;
  double tv3rho2sigma1, t927, t931, t933, tv3rho2sigma2, t939, t947, tv3rho2sigma3;
  double tv3rho2sigma4, t953, t960, t963, tv3rho2sigma5, t971, tv3rho2sigma6, tv3rho2sigma7;
  double t994, t995, t998, t1003, tv3rho2sigma8, t1010, t1015, t1020;
  double t1023, t1028, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1035;
  double t1037, tv3rhosigma25, t1043, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t1052, t1057, t1060, t1065, tv3rhosigma211, t1067, t1069, t1072;
  double t1073, t1077, t1078, t1079, t1082, t1086, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1087;
  double t1089, t1092, t1093, t1097, t1098, t1099, t1102, t1106;
  double tv3sigma39;

  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->bb * sigma[0];
  t29 = rho[0] * rho[0];
  t30 = POW_1_3(rho[0]);
  t31 = t30 * t30;
  t33 = 0.1e1 / t31 / t29;
  t36 = sqrt(sigma[0]);
  t37 = params->cc * t36;
  t39 = 0.1e1 / t30 / rho[0];
  t40 = M_CBRT2;
  t43 = 0.4e1 * t36 * t39 + t40;
  t44 = 0.1e1 / t43;
  t45 = t39 * t44;
  t47 = params->aa + 0.13888888888888888889e-1 * t28 * t33 + t37 * t45;
  t51 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t47);
  t52 = rho[1] <= p->dens_threshold;
  t53 = my_piecewise5(t14, t11, t10, t15, -t17);
  t54 = 0.1e1 + t53;
  t55 = t54 <= p->zeta_threshold;
  t56 = POW_1_3(t54);
  t58 = my_piecewise3(t55, t22, t56 * t54);
  t59 = t58 * t26;
  t60 = params->bb * sigma[2];
  t61 = rho[1] * rho[1];
  t62 = POW_1_3(rho[1]);
  t63 = t62 * t62;
  t65 = 0.1e1 / t63 / t61;
  t68 = sqrt(sigma[2]);
  t69 = params->cc * t68;
  t71 = 0.1e1 / t62 / rho[1];
  t74 = 0.4e1 * t68 * t71 + t40;
  t75 = 0.1e1 / t74;
  t76 = t71 * t75;
  t78 = params->aa + 0.13888888888888888889e-1 * t60 * t65 + t69 * t76;
  t82 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t78);
  tzk0 = t51 + t82;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t83 = t6 * t6;
  t84 = 0.1e1 / t83;
  t85 = t16 * t84;
  t86 = t7 - t85;
  t87 = my_piecewise5(t10, 0, t14, 0, t86);
  t90 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t87);
  t91 = t90 * t26;
  t95 = t26 * t26;
  t96 = 0.1e1 / t95;
  t97 = t25 * t96;
  t100 = t5 * t97 * t47 / 0.8e1;
  t101 = t29 * rho[0];
  t103 = 0.1e1 / t31 / t101;
  t108 = 0.1e1 / t30 / t29 * t44;
  t111 = params->cc * sigma[0];
  t112 = t43 * t43;
  t113 = 0.1e1 / t112;
  t114 = t103 * t113;
  t117 = -0.37037037037037037037e-1 * t28 * t103 - 0.4e1 / 0.3e1 * t37 * t108 + 0.16e2 / 0.3e1 * t111 * t114;
  t122 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t91 * t47 - t100 - 0.3e1 / 0.8e1 * t5 * t27 * t117);
  t124 = my_piecewise5(t14, 0, t10, 0, -t86);
  t127 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t124);
  t128 = t127 * t26;
  t132 = t58 * t96;
  t135 = t5 * t132 * t78 / 0.8e1;
  t137 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t128 * t78 - t135);
  tvrho0 = t51 + t82 + t6 * (t122 + t137);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t140 = -t7 - t85;
  t141 = my_piecewise5(t10, 0, t14, 0, t140);
  t144 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t141);
  t145 = t144 * t26;
  t150 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t145 * t47 - t100);
  t152 = my_piecewise5(t14, 0, t10, 0, -t140);
  t155 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t152);
  t156 = t155 * t26;
  t160 = t61 * rho[1];
  t162 = 0.1e1 / t63 / t160;
  t167 = 0.1e1 / t62 / t61 * t75;
  t170 = params->cc * sigma[2];
  t171 = t74 * t74;
  t172 = 0.1e1 / t171;
  t173 = t162 * t172;
  t176 = -0.37037037037037037037e-1 * t60 * t162 - 0.4e1 / 0.3e1 * t69 * t167 + 0.16e2 / 0.3e1 * t170 * t173;
  t181 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t156 * t78 - t135 - 0.3e1 / 0.8e1 * t5 * t59 * t176);
  tvrho1 = t51 + t82 + t6 * (t150 + t181);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t186 = 0.1e1 / t36;
  t187 = params->cc * t186;
  t193 = 0.13888888888888888889e-1 * params->bb * t33 + t187 * t45 / 0.2e1 - 0.2e1 * params->cc * t33 * t113;
  t197 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t193);
  tvsigma0 = t6 * t197;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t200 = 0.1e1 / t68;
  t201 = params->cc * t200;
  t207 = 0.13888888888888888889e-1 * params->bb * t65 + t201 * t76 / 0.2e1 - 0.2e1 * params->cc * t65 * t172;
  t211 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t207);
  tvsigma2 = t6 * t211;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t214 = t23 * t23;
  t215 = 0.1e1 / t214;
  t216 = t87 * t87;
  t219 = t83 * t6;
  t220 = 0.1e1 / t219;
  t221 = t16 * t220;
  t223 = -0.2e1 * t84 + 0.2e1 * t221;
  t224 = my_piecewise5(t10, 0, t14, 0, t223);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t215 * t216 + 0.4e1 / 0.3e1 * t23 * t224);
  t229 = t228 * t26;
  t233 = t90 * t96;
  t235 = t5 * t233 * t47;
  t241 = 0.1e1 / t95 / t6;
  t242 = t25 * t241;
  t245 = t5 * t242 * t47 / 0.12e2;
  t247 = t5 * t97 * t117;
  t249 = t29 * t29;
  t251 = 0.1e1 / t31 / t249;
  t256 = 0.1e1 / t30 / t101 * t44;
  t259 = t251 * t113;
  t262 = t36 * sigma[0];
  t263 = params->cc * t262;
  t264 = t249 * t29;
  t265 = 0.1e1 / t264;
  t267 = 0.1e1 / t112 / t43;
  t268 = t265 * t267;
  t271 = 0.13580246913580246914e0 * t28 * t251 + 0.28e2 / 0.9e1 * t37 * t256 - 0.8e2 / 0.3e1 * t111 * t259 + 0.512e3 / 0.9e1 * t263 * t268;
  t276 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t47 - t235 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t91 * t117 + t245 - t247 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t271);
  t277 = t56 * t56;
  t278 = 0.1e1 / t277;
  t279 = t124 * t124;
  t283 = my_piecewise5(t14, 0, t10, 0, -t223);
  t287 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t278 * t279 + 0.4e1 / 0.3e1 * t56 * t283);
  t288 = t287 * t26;
  t292 = t127 * t96;
  t294 = t5 * t292 * t78;
  t296 = t58 * t241;
  t299 = t5 * t296 * t78 / 0.12e2;
  t301 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t288 * t78 - t294 / 0.4e1 + t299);
  tv2rho20 = 0.2e1 * t122 + 0.2e1 * t137 + t6 * (t276 + t301);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t304 = t215 * t141;
  t307 = 0.2e1 * t221;
  t308 = my_piecewise5(t10, 0, t14, 0, t307);
  t312 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t304 * t87 + 0.4e1 / 0.3e1 * t23 * t308);
  t313 = t312 * t26;
  t317 = t144 * t96;
  t319 = t5 * t317 * t47;
  t327 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t313 * t47 - t319 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t145 * t117 - t235 / 0.8e1 + t245 - t247 / 0.8e1);
  t328 = t278 * t152;
  t331 = my_piecewise5(t14, 0, t10, 0, -t307);
  t335 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t328 * t124 + 0.4e1 / 0.3e1 * t56 * t331);
  t336 = t335 * t26;
  t340 = t155 * t96;
  t342 = t5 * t340 * t78;
  t349 = t5 * t132 * t176;
  t352 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t336 * t78 - t342 / 0.8e1 - t294 / 0.8e1 + t299 - 0.3e1 / 0.8e1 * t5 * t128 * t176 - t349 / 0.8e1);
  tv2rho21 = t122 + t137 + t150 + t181 + t6 * (t327 + t352);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t357 = t141 * t141;
  t361 = 0.2e1 * t84 + 0.2e1 * t221;
  t362 = my_piecewise5(t10, 0, t14, 0, t361);
  t366 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t215 * t357 + 0.4e1 / 0.3e1 * t23 * t362);
  t367 = t366 * t26;
  t373 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t367 * t47 - t319 / 0.4e1 + t245);
  t374 = t152 * t152;
  t378 = my_piecewise5(t14, 0, t10, 0, -t361);
  t382 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t278 * t374 + 0.4e1 / 0.3e1 * t56 * t378);
  t383 = t382 * t26;
  t392 = t61 * t61;
  t394 = 0.1e1 / t63 / t392;
  t399 = 0.1e1 / t62 / t160 * t75;
  t402 = t394 * t172;
  t405 = t68 * sigma[2];
  t406 = params->cc * t405;
  t407 = t392 * t61;
  t408 = 0.1e1 / t407;
  t410 = 0.1e1 / t171 / t74;
  t411 = t408 * t410;
  t414 = 0.13580246913580246914e0 * t60 * t394 + 0.28e2 / 0.9e1 * t69 * t399 - 0.8e2 / 0.3e1 * t170 * t402 + 0.512e3 / 0.9e1 * t406 * t411;
  t419 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t383 * t78 - t342 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t156 * t176 + t299 - t349 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t59 * t414);
  tv2rho22 = 0.2e1 * t150 + 0.2e1 * t181 + t6 * (t373 + t419);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t427 = t5 * t97 * t193 / 0.8e1;
  t435 = t249 * rho[0];
  t436 = 0.1e1 / t435;
  t438 = t267 * t36;
  t441 = -0.37037037037037037037e-1 * params->bb * t103 - 0.2e1 / 0.3e1 * t187 * t108 + 0.8e1 * params->cc * t103 * t113 - 0.64e2 / 0.3e1 * params->cc * t436 * t438;
  t446 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t91 * t193 - t427 - 0.3e1 / 0.8e1 * t5 * t27 * t441);
  tv2rhosigma0 = t6 * t446 + t197;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t453 = t5 * t132 * t207 / 0.8e1;
  t455 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t128 * t207 - t453);
  tv2rhosigma2 = t6 * t455 + t211;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t461 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t145 * t193 - t427);
  tv2rhosigma3 = t6 * t461 + t197;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t473 = t392 * rho[1];
  t474 = 0.1e1 / t473;
  t476 = t410 * t68;
  t479 = -0.37037037037037037037e-1 * params->bb * t162 - 0.2e1 / 0.3e1 * t201 * t167 + 0.8e1 * params->cc * t162 * t172 - 0.64e2 / 0.3e1 * params->cc * t474 * t476;
  t484 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t156 * t207 - t453 - 0.3e1 / 0.8e1 * t5 * t59 * t479);
  tv2rhosigma5 = t6 * t484 + t211;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t486 = 0.1e1 / t262;
  t487 = params->cc * t486;
  t490 = 0.1e1 / sigma[0];
  t491 = params->cc * t490;
  t492 = t33 * t113;
  t494 = 0.1e1 / t249;
  t499 = -t487 * t45 / 0.4e1 - t491 * t492 + 0.8e1 * params->cc * t494 * t267 * t186;
  t503 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t499);
  tv2sigma20 = t6 * t503;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t504 = 0.1e1 / t405;
  t505 = params->cc * t504;
  t508 = 0.1e1 / sigma[2];
  t509 = params->cc * t508;
  t510 = t65 * t172;
  t512 = 0.1e1 / t392;
  t517 = -t505 * t76 / 0.4e1 - t509 * t510 + 0.8e1 * params->cc * t512 * t410 * t200;
  t521 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t517);
  tv2sigma25 = t6 * t521;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t525 = 0.1e1 / t214 / t19;
  t526 = t216 * t87;
  t529 = t215 * t87;
  t532 = t83 * t83;
  t533 = 0.1e1 / t532;
  t534 = t16 * t533;
  t536 = 0.6e1 * t220 - 0.6e1 * t534;
  t537 = my_piecewise5(t10, 0, t14, 0, t536);
  t541 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t525 * t526 + 0.4e1 / 0.3e1 * t529 * t224 + 0.4e1 / 0.3e1 * t23 * t537);
  t542 = t541 * t26;
  t546 = t228 * t96;
  t548 = t5 * t546 * t47;
  t553 = t90 * t241;
  t555 = t5 * t553 * t47;
  t558 = t5 * t233 * t117;
  t564 = 0.1e1 / t95 / t83;
  t565 = t25 * t564;
  t568 = 0.5e1 / 0.36e2 * t5 * t565 * t47;
  t570 = t5 * t242 * t117;
  t573 = t5 * t97 * t271;
  t576 = 0.1e1 / t31 / t435;
  t581 = 0.1e1 / t30 / t249 * t44;
  t587 = t249 * t101;
  t588 = 0.1e1 / t587;
  t592 = sigma[0] * sigma[0];
  t593 = params->cc * t592;
  t594 = t249 * t249;
  t596 = 0.1e1 / t30 / t594;
  t597 = t112 * t112;
  t598 = 0.1e1 / t597;
  t602 = -0.63374485596707818932e0 * t28 * t576 - 0.28e3 / 0.27e2 * t37 * t581 + 0.3808e4 / 0.27e2 * t111 * t576 * t113 - 0.5632e4 / 0.9e1 * t263 * t588 * t267 + 0.8192e4 / 0.9e1 * t593 * t596 * t598;
  t607 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t542 * t47 - 0.3e1 / 0.8e1 * t548 - 0.9e1 / 0.8e1 * t5 * t229 * t117 + t555 / 0.4e1 - 0.3e1 / 0.4e1 * t558 - 0.9e1 / 0.8e1 * t5 * t91 * t271 - t568 + t570 / 0.4e1 - 0.3e1 / 0.8e1 * t573 - 0.3e1 / 0.8e1 * t5 * t27 * t602);
  t609 = 0.1e1 / t277 / t54;
  t610 = t279 * t124;
  t613 = t278 * t124;
  t617 = my_piecewise5(t14, 0, t10, 0, -t536);
  t621 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t609 * t610 + 0.4e1 / 0.3e1 * t613 * t283 + 0.4e1 / 0.3e1 * t56 * t617);
  t622 = t621 * t26;
  t626 = t287 * t96;
  t628 = t5 * t626 * t78;
  t630 = t127 * t241;
  t632 = t5 * t630 * t78;
  t634 = t58 * t564;
  t637 = 0.5e1 / 0.36e2 * t5 * t634 * t78;
  t639 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t622 * t78 - 0.3e1 / 0.8e1 * t628 + t632 / 0.4e1 - t637);
  tv3rho30 = 0.3e1 * t276 + 0.3e1 * t301 + t6 * (t607 + t639);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t642 = 0.2e1 * t327;
  t643 = 0.2e1 * t352;
  t644 = t525 * t141;
  t647 = t215 * t308;
  t652 = 0.2e1 * t220;
  t653 = 0.6e1 * t534;
  t654 = t652 - t653;
  t655 = my_piecewise5(t10, 0, t14, 0, t654);
  t659 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t644 * t216 + 0.8e1 / 0.9e1 * t647 * t87 + 0.4e1 / 0.9e1 * t304 * t224 + 0.4e1 / 0.3e1 * t23 * t655);
  t660 = t659 * t26;
  t664 = t312 * t96;
  t667 = t5 * t664 * t47 / 0.4e1;
  t671 = t144 * t241;
  t673 = t5 * t671 * t47;
  t677 = t5 * t317 * t117 / 0.4e1;
  t686 = -0.3e1 / 0.8e1 * t5 * t660 * t47 - t667 - 0.3e1 / 0.4e1 * t5 * t313 * t117 + t673 / 0.12e2 - t677 - 0.3e1 / 0.8e1 * t5 * t145 * t271 - t548 / 0.8e1 + t555 / 0.6e1 - t558 / 0.4e1 - t568 + t570 / 0.6e1 - t573 / 0.8e1;
  t687 = my_piecewise3(t1, 0, t686);
  t688 = t609 * t152;
  t691 = t278 * t331;
  t697 = my_piecewise5(t14, 0, t10, 0, -t654);
  t701 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t688 * t279 + 0.8e1 / 0.9e1 * t691 * t124 + 0.4e1 / 0.9e1 * t328 * t283 + 0.4e1 / 0.3e1 * t56 * t697);
  t702 = t701 * t26;
  t706 = t335 * t96;
  t709 = t5 * t706 * t78 / 0.4e1;
  t710 = t155 * t241;
  t712 = t5 * t710 * t78;
  t721 = t5 * t292 * t176 / 0.4e1;
  t723 = t5 * t296 * t176;
  t726 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t702 * t78 - t709 + t712 / 0.12e2 - t628 / 0.8e1 + t632 / 0.6e1 - t637 - 0.3e1 / 0.8e1 * t5 * t288 * t176 - t721 + t723 / 0.12e2);
  tv3rho31 = t276 + t301 + t642 + t643 + t6 * (t687 + t726);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t729 = t525 * t357;
  t734 = t215 * t362;
  t737 = -t652 - t653;
  t738 = my_piecewise5(t10, 0, t14, 0, t737);
  t742 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t729 * t87 + 0.8e1 / 0.9e1 * t304 * t308 + 0.4e1 / 0.9e1 * t734 * t87 + 0.4e1 / 0.3e1 * t23 * t738);
  t743 = t742 * t26;
  t747 = t366 * t96;
  t749 = t5 * t747 * t47;
  t758 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t743 * t47 - t749 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t367 * t117 - t667 + t673 / 0.6e1 - t677 + t555 / 0.12e2 - t568 + t570 / 0.12e2);
  t759 = t609 * t374;
  t764 = t278 * t378;
  t768 = my_piecewise5(t14, 0, t10, 0, -t737);
  t772 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t759 * t124 + 0.8e1 / 0.9e1 * t328 * t331 + 0.4e1 / 0.9e1 * t764 * t124 + 0.4e1 / 0.3e1 * t56 * t768);
  t773 = t772 * t26;
  t777 = t382 * t96;
  t779 = t5 * t777 * t78;
  t786 = t5 * t340 * t176;
  t794 = t5 * t132 * t414;
  t796 = -0.3e1 / 0.8e1 * t5 * t773 * t78 - t779 / 0.8e1 - t709 + t712 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t336 * t176 - t786 / 0.4e1 + t632 / 0.12e2 - t637 - t721 + t723 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t128 * t414 - t794 / 0.8e1;
  t797 = my_piecewise3(t52, 0, t796);
  tv3rho32 = t642 + t643 + t373 + t419 + t6 * (t758 + t797);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t802 = t357 * t141;
  t808 = -0.6e1 * t220 - 0.6e1 * t534;
  t809 = my_piecewise5(t10, 0, t14, 0, t808);
  t813 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t525 * t802 + 0.4e1 / 0.3e1 * t304 * t362 + 0.4e1 / 0.3e1 * t23 * t809);
  t814 = t813 * t26;
  t821 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t814 * t47 - 0.3e1 / 0.8e1 * t749 + t673 / 0.4e1 - t568);
  t822 = t374 * t152;
  t828 = my_piecewise5(t14, 0, t10, 0, -t808);
  t832 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t609 * t822 + 0.4e1 / 0.3e1 * t328 * t378 + 0.4e1 / 0.3e1 * t56 * t828);
  t833 = t832 * t26;
  t849 = 0.1e1 / t63 / t473;
  t854 = 0.1e1 / t62 / t392 * t75;
  t860 = t392 * t160;
  t861 = 0.1e1 / t860;
  t865 = sigma[2] * sigma[2];
  t866 = params->cc * t865;
  t867 = t392 * t392;
  t869 = 0.1e1 / t62 / t867;
  t870 = t171 * t171;
  t871 = 0.1e1 / t870;
  t875 = -0.63374485596707818932e0 * t60 * t849 - 0.28e3 / 0.27e2 * t69 * t854 + 0.3808e4 / 0.27e2 * t170 * t849 * t172 - 0.5632e4 / 0.9e1 * t406 * t861 * t410 + 0.8192e4 / 0.9e1 * t866 * t869 * t871;
  t880 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t833 * t78 - 0.3e1 / 0.8e1 * t779 - 0.9e1 / 0.8e1 * t5 * t383 * t176 + t712 / 0.4e1 - 0.3e1 / 0.4e1 * t786 - 0.9e1 / 0.8e1 * t5 * t156 * t414 - t637 + t723 / 0.4e1 - 0.3e1 / 0.8e1 * t794 - 0.3e1 / 0.8e1 * t5 * t59 * t875);
  tv3rho33 = 0.3e1 * t373 + 0.3e1 * t419 + t6 * (t821 + t880);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t888 = t5 * t233 * t193;
  t895 = t5 * t242 * t193 / 0.12e2;
  t897 = t5 * t97 * t441;
  t911 = params->cc / t30 / t587;
  t912 = t598 * sigma[0];
  t915 = 0.13580246913580246914e0 * params->bb * t251 + 0.14e2 / 0.9e1 * t187 * t256 - 0.296e3 / 0.9e1 * params->cc * t251 * t113 + 0.192e3 * params->cc * t265 * t438 - 0.1024e4 / 0.3e1 * t911 * t912;
  t920 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t193 - t888 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t91 * t441 + t895 - t897 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t915);
  tv3rho2sigma0 = t6 * t920 + 0.2e1 * t446;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t927 = t5 * t292 * t207;
  t931 = t5 * t296 * t207 / 0.12e2;
  t933 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t288 * t207 - t927 / 0.4e1 + t931);
  tv3rho2sigma2 = t6 * t933 + 0.2e1 * t455;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t939 = t5 * t317 * t193;
  t947 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t313 * t193 - t939 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t145 * t441 - t888 / 0.8e1 + t895 - t897 / 0.8e1);
  tv3rho2sigma3 = t6 * t947 + t446 + t461;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t953 = t5 * t340 * t207;
  t960 = t5 * t132 * t479;
  t963 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t336 * t207 - t953 / 0.8e1 - t927 / 0.8e1 + t931 - 0.3e1 / 0.8e1 * t5 * t128 * t479 - t960 / 0.8e1);
  tv3rho2sigma5 = t6 * t963 + t455 + t484;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t971 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t367 * t193 - t939 / 0.4e1 + t895);
  tv3rho2sigma6 = t6 * t971 + 0.2e1 * t461;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t994 = params->cc / t62 / t860;
  t995 = t871 * sigma[2];
  t998 = 0.13580246913580246914e0 * params->bb * t394 + 0.14e2 / 0.9e1 * t201 * t399 - 0.296e3 / 0.9e1 * params->cc * t394 * t172 + 0.192e3 * params->cc * t408 * t476 - 0.1024e4 / 0.3e1 * t994 * t995;
  t1003 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t383 * t207 - t953 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t156 * t479 + t931 - t960 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t59 * t998);
  tv3rho2sigma8 = t6 * t1003 + 0.2e1 * t484;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1010 = t5 * t97 * t499 / 0.8e1;
  t1015 = t436 * t267;
  t1020 = params->cc / t30 / t264;
  t1023 = t487 * t108 / 0.3e1 + 0.4e1 / 0.3e1 * t491 * t114 - 0.128e3 / 0.3e1 * t187 * t1015 + 0.128e3 * t1020 * t598;
  t1028 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t91 * t499 - t1010 - 0.3e1 / 0.8e1 * t5 * t27 * t1023);
  tv3rhosigma20 = t6 * t1028 + t503;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1035 = t5 * t132 * t517 / 0.8e1;
  t1037 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t128 * t517 - t1035);
  tv3rhosigma25 = t6 * t1037 + t521;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1043 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t145 * t499 - t1010);
  tv3rhosigma26 = t6 * t1043 + t503;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1052 = t474 * t410;
  t1057 = params->cc / t62 / t407;
  t1060 = t505 * t167 / 0.3e1 + 0.4e1 / 0.3e1 * t509 * t173 - 0.128e3 / 0.3e1 * t201 * t1052 + 0.128e3 * t1057 * t871;
  t1065 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t156 * t517 - t1035 - 0.3e1 / 0.8e1 * t5 * t59 * t1060);
  tv3rhosigma211 = t6 * t1065 + t521;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1067 = t36 * t592;
  t1069 = params->cc / t1067;
  t1072 = 0.1e1 / t592;
  t1073 = params->cc * t1072;
  t1077 = 0.1e1 / t30 / t435;
  t1078 = params->cc * t1077;
  t1079 = t598 * t490;
  t1082 = 0.3e1 / 0.8e1 * t1069 * t45 + 0.3e1 / 0.2e1 * t1073 * t492 - 0.48e2 * t1078 * t1079;
  t1086 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1082);
  tv3sigma30 = t6 * t1086;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1087 = t68 * t865;
  t1089 = params->cc / t1087;
  t1092 = 0.1e1 / t865;
  t1093 = params->cc * t1092;
  t1097 = 0.1e1 / t62 / t473;
  t1098 = params->cc * t1097;
  t1099 = t871 * t508;
  t1102 = 0.3e1 / 0.8e1 * t1089 * t76 + 0.3e1 / 0.2e1 * t1093 * t510 - 0.48e2 * t1098 * t1099;
  t1106 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t1102);
  tv3sigma39 = t6 * t1106;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t33, t36, t37, t39, t40, t43, t44;
  double t45, t47, t51, t52, t53, t54, t55, t56;
  double t58, t59, t60, t61, t62, t63, t65, t68;
  double t69, t71, t74, t75, t76, t78, t82, tzk0;

  double t83, t84, t85, t86, t87, t90, t91, t95;
  double t96, t97, t100, t101, t103, t108, t111, t112;
  double t113, t114, t117, t122, t124, t127, t128, t132;
  double t135, t137, tvrho0, t140, t141, t144, t145, t150;
  double t152, t155, t156, t160, t162, t167, t170, t171;
  double t172, t173, t176, t181, tvrho1, t186, t187, t193;
  double t197, tvsigma0, tvsigma1, t200, t201, t207, t211, tvsigma2;

  double t214, t215, t216, t219, t220, t221, t223, t224;
  double t228, t229, t233, t235, t241, t242, t245, t247;
  double t249, t251, t256, t259, t262, t263, t264, t265;
  double t267, t268, t271, t276, t277, t278, t279, t283;
  double t287, t288, t292, t294, t296, t299, t301, tv2rho20;
  double t304, t307, t308, t312, t313, t317, t319, t327;
  double t328, t331, t335, t336, t340, t342, t349, t352;
  double tv2rho21, t357, t361, t362, t366, t367, t373, t374;
  double t378, t382, t383, t392, t394, t399, t402, t405;
  double t406, t407, t408, t410, t411, t414, t419, tv2rho22;
  double t427, t435, t436, t438, t441, t446, tv2rhosigma0, tv2rhosigma1;
  double t453, t455, tv2rhosigma2, t461, tv2rhosigma3, tv2rhosigma4, t473, t474;
  double t476, t479, t484, tv2rhosigma5, t486, t487, t490, t491;
  double t492, t494, t499, t503, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, t504, t505, t508, t509, t510, t512, t517;
  double t521, tv2sigma25;

  double t525, t526, t529, t532, t533, t534, t536, t537;
  double t541, t542, t546, t548, t553, t555, t558, t564;
  double t565, t568, t570, t573, t576, t581, t587, t588;
  double t592, t593, t594, t596, t597, t598, t602, t607;
  double t609, t610, t613, t617, t621, t622, t626, t628;
  double t630, t632, t634, t637, t639, tv3rho30, t642, t643;
  double t644, t647, t652, t653, t654, t655, t659, t660;
  double t664, t667, t671, t673, t677, t686, t687, t688;
  double t691, t697, t701, t702, t706, t709, t710, t712;
  double t721, t723, t726, tv3rho31, t729, t734, t737, t738;
  double t742, t743, t747, t749, t758, t759, t764, t768;
  double t772, t773, t777, t779, t786, t794, t796, t797;
  double tv3rho32, t802, t808, t809, t813, t814, t821, t822;
  double t828, t832, t833, t849, t854, t860, t861, t865;
  double t866, t867, t869, t870, t871, t875, t880, tv3rho33;
  double t888, t895, t897, t911, t912, t915, t920, tv3rho2sigma0;
  double tv3rho2sigma1, t927, t931, t933, tv3rho2sigma2, t939, t947, tv3rho2sigma3;
  double tv3rho2sigma4, t953, t960, t963, tv3rho2sigma5, t971, tv3rho2sigma6, tv3rho2sigma7;
  double t994, t995, t998, t1003, tv3rho2sigma8, t1010, t1015, t1020;
  double t1023, t1028, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1035;
  double t1037, tv3rhosigma25, t1043, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t1052, t1057, t1060, t1065, tv3rhosigma211, t1067, t1069, t1072;
  double t1073, t1077, t1078, t1079, t1082, t1086, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1087;
  double t1089, t1092, t1093, t1097, t1098, t1099, t1102, t1106;
  double tv3sigma39;

  double t1111, t1114, t1118, t1121, t1125, t1128, t1131, t1134;
  double t1137, t1150, t1161, t1173, t1179, t1181, t1186, t1188;
  double t1189, t1195, t1202, t1204, t1205, t1209, t1214, t1215;
  double t1216, t1218, t1219, t1225, t1231, t1235, t1242, t1246;
  double t1250, t1255, t1257, tv4rho40, t1278, t1279, t1280, t1281;
  double t1285, t1294, t1300, t1301, t1303, t1310, t1314, t1318;
  double t1319, t1329, t1330, t1348, t1352, t1359, t1363, t1364;
  double t1367, t1376, t1379, t1380, t1382, t1384, t1385, tv4rho41;
  double t1394, t1398, t1408, t1421, t1425, t1434, t1450, t1451;
  double t1460, t1473, t1477, t1484, t1488, t1497, t1500, t1511;
  double t1514, t1516, t1517, tv4rho42, t1537, t1538, t1542, t1549;
  double t1560, t1561, t1578, t1582, t1589, t1597, t1606, t1616;
  double t1618, t1619, tv4rho43, t1624, t1629, t1635, t1636, t1640;
  double t1649, t1651, t1664, t1675, t1683, t1688, t1694, t1698;
  double t1720, t1721, tv4rho44, t1729, t1735, t1738, t1745, t1747;
  double t1750, t1776, tv4rho3sigma0, tv4rho3sigma1, t1783, t1786, t1790, t1792;
  double tv4rho3sigma2, t1794, t1800, t1805, t1809, t1818, t1819, tv4rho3sigma3;
  double tv4rho3sigma4, t1821, t1827, t1829, t1838, t1840, t1843, tv4rho3sigma5;
  double t1849, t1858, tv4rho3sigma6, tv4rho3sigma7, t1864, t1871, t1879, t1881;
  double t1882, tv4rho3sigma8, t1891, tv4rho3sigma9, tv4rho3sigma10, t1932, tv4rho3sigma11, t1939;
  double t1946, t1948, t1969, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23, tv4rho2sigma24;
  double t1976, t1980, t1982, tv4rho2sigma25, t1988, t1996, tv4rho2sigma26, tv4rho2sigma27;
  double tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t2002, t2009, t2012, tv4rho2sigma211, t2020;
  double tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t2050, tv4rho2sigma217, t2057;
  double t2077, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36;
  double tv4rhosigma37, tv4rhosigma38, t2084, t2086, tv4rhosigma39, t2092, tv4rhosigma310, tv4rhosigma311;
  double tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t2116;
  double tv4rhosigma319, t2118, t2142, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44;
  double tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412;
  double tv4sigma413, t2143, t2167, tv4sigma414;

  gga_x_ol2_params *params;

  assert(p->params != NULL);
  params = (gga_x_ol2_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = params->bb * sigma[0];
  t29 = rho[0] * rho[0];
  t30 = POW_1_3(rho[0]);
  t31 = t30 * t30;
  t33 = 0.1e1 / t31 / t29;
  t36 = sqrt(sigma[0]);
  t37 = params->cc * t36;
  t39 = 0.1e1 / t30 / rho[0];
  t40 = M_CBRT2;
  t43 = 0.4e1 * t36 * t39 + t40;
  t44 = 0.1e1 / t43;
  t45 = t39 * t44;
  t47 = params->aa + 0.13888888888888888889e-1 * t28 * t33 + t37 * t45;
  t51 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t47);
  t52 = rho[1] <= p->dens_threshold;
  t53 = my_piecewise5(t14, t11, t10, t15, -t17);
  t54 = 0.1e1 + t53;
  t55 = t54 <= p->zeta_threshold;
  t56 = POW_1_3(t54);
  t58 = my_piecewise3(t55, t22, t56 * t54);
  t59 = t58 * t26;
  t60 = params->bb * sigma[2];
  t61 = rho[1] * rho[1];
  t62 = POW_1_3(rho[1]);
  t63 = t62 * t62;
  t65 = 0.1e1 / t63 / t61;
  t68 = sqrt(sigma[2]);
  t69 = params->cc * t68;
  t71 = 0.1e1 / t62 / rho[1];
  t74 = 0.4e1 * t68 * t71 + t40;
  t75 = 0.1e1 / t74;
  t76 = t71 * t75;
  t78 = params->aa + 0.13888888888888888889e-1 * t60 * t65 + t69 * t76;
  t82 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t78);
  tzk0 = t51 + t82;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t83 = t6 * t6;
  t84 = 0.1e1 / t83;
  t85 = t16 * t84;
  t86 = t7 - t85;
  t87 = my_piecewise5(t10, 0, t14, 0, t86);
  t90 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t87);
  t91 = t90 * t26;
  t95 = t26 * t26;
  t96 = 0.1e1 / t95;
  t97 = t25 * t96;
  t100 = t5 * t97 * t47 / 0.8e1;
  t101 = t29 * rho[0];
  t103 = 0.1e1 / t31 / t101;
  t108 = 0.1e1 / t30 / t29 * t44;
  t111 = params->cc * sigma[0];
  t112 = t43 * t43;
  t113 = 0.1e1 / t112;
  t114 = t103 * t113;
  t117 = -0.37037037037037037037e-1 * t28 * t103 - 0.4e1 / 0.3e1 * t37 * t108 + 0.16e2 / 0.3e1 * t111 * t114;
  t122 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t91 * t47 - t100 - 0.3e1 / 0.8e1 * t5 * t27 * t117);
  t124 = my_piecewise5(t14, 0, t10, 0, -t86);
  t127 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t124);
  t128 = t127 * t26;
  t132 = t58 * t96;
  t135 = t5 * t132 * t78 / 0.8e1;
  t137 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t128 * t78 - t135);
  tvrho0 = t51 + t82 + t6 * (t122 + t137);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t140 = -t7 - t85;
  t141 = my_piecewise5(t10, 0, t14, 0, t140);
  t144 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t141);
  t145 = t144 * t26;
  t150 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t145 * t47 - t100);
  t152 = my_piecewise5(t14, 0, t10, 0, -t140);
  t155 = my_piecewise3(t55, 0, 0.4e1 / 0.3e1 * t56 * t152);
  t156 = t155 * t26;
  t160 = t61 * rho[1];
  t162 = 0.1e1 / t63 / t160;
  t167 = 0.1e1 / t62 / t61 * t75;
  t170 = params->cc * sigma[2];
  t171 = t74 * t74;
  t172 = 0.1e1 / t171;
  t173 = t162 * t172;
  t176 = -0.37037037037037037037e-1 * t60 * t162 - 0.4e1 / 0.3e1 * t69 * t167 + 0.16e2 / 0.3e1 * t170 * t173;
  t181 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t156 * t78 - t135 - 0.3e1 / 0.8e1 * t5 * t59 * t176);
  tvrho1 = t51 + t82 + t6 * (t150 + t181);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t186 = 0.1e1 / t36;
  t187 = params->cc * t186;
  t193 = 0.13888888888888888889e-1 * params->bb * t33 + t187 * t45 / 0.2e1 - 0.2e1 * params->cc * t33 * t113;
  t197 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t193);
  tvsigma0 = t6 * t197;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t200 = 0.1e1 / t68;
  t201 = params->cc * t200;
  t207 = 0.13888888888888888889e-1 * params->bb * t65 + t201 * t76 / 0.2e1 - 0.2e1 * params->cc * t65 * t172;
  t211 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t207);
  tvsigma2 = t6 * t211;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t214 = t23 * t23;
  t215 = 0.1e1 / t214;
  t216 = t87 * t87;
  t219 = t83 * t6;
  t220 = 0.1e1 / t219;
  t221 = t16 * t220;
  t223 = -0.2e1 * t84 + 0.2e1 * t221;
  t224 = my_piecewise5(t10, 0, t14, 0, t223);
  t228 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t215 * t216 + 0.4e1 / 0.3e1 * t23 * t224);
  t229 = t228 * t26;
  t233 = t90 * t96;
  t235 = t5 * t233 * t47;
  t241 = 0.1e1 / t95 / t6;
  t242 = t25 * t241;
  t245 = t5 * t242 * t47 / 0.12e2;
  t247 = t5 * t97 * t117;
  t249 = t29 * t29;
  t251 = 0.1e1 / t31 / t249;
  t256 = 0.1e1 / t30 / t101 * t44;
  t259 = t251 * t113;
  t262 = t36 * sigma[0];
  t263 = params->cc * t262;
  t264 = t249 * t29;
  t265 = 0.1e1 / t264;
  t267 = 0.1e1 / t112 / t43;
  t268 = t265 * t267;
  t271 = 0.13580246913580246914e0 * t28 * t251 + 0.28e2 / 0.9e1 * t37 * t256 - 0.8e2 / 0.3e1 * t111 * t259 + 0.512e3 / 0.9e1 * t263 * t268;
  t276 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t47 - t235 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t91 * t117 + t245 - t247 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t271);
  t277 = t56 * t56;
  t278 = 0.1e1 / t277;
  t279 = t124 * t124;
  t283 = my_piecewise5(t14, 0, t10, 0, -t223);
  t287 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t278 * t279 + 0.4e1 / 0.3e1 * t56 * t283);
  t288 = t287 * t26;
  t292 = t127 * t96;
  t294 = t5 * t292 * t78;
  t296 = t58 * t241;
  t299 = t5 * t296 * t78 / 0.12e2;
  t301 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t288 * t78 - t294 / 0.4e1 + t299);
  tv2rho20 = 0.2e1 * t122 + 0.2e1 * t137 + t6 * (t276 + t301);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t304 = t215 * t141;
  t307 = 0.2e1 * t221;
  t308 = my_piecewise5(t10, 0, t14, 0, t307);
  t312 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t304 * t87 + 0.4e1 / 0.3e1 * t23 * t308);
  t313 = t312 * t26;
  t317 = t144 * t96;
  t319 = t5 * t317 * t47;
  t327 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t313 * t47 - t319 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t145 * t117 - t235 / 0.8e1 + t245 - t247 / 0.8e1);
  t328 = t278 * t152;
  t331 = my_piecewise5(t14, 0, t10, 0, -t307);
  t335 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t328 * t124 + 0.4e1 / 0.3e1 * t56 * t331);
  t336 = t335 * t26;
  t340 = t155 * t96;
  t342 = t5 * t340 * t78;
  t349 = t5 * t132 * t176;
  t352 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t336 * t78 - t342 / 0.8e1 - t294 / 0.8e1 + t299 - 0.3e1 / 0.8e1 * t5 * t128 * t176 - t349 / 0.8e1);
  tv2rho21 = t122 + t137 + t150 + t181 + t6 * (t327 + t352);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t357 = t141 * t141;
  t361 = 0.2e1 * t84 + 0.2e1 * t221;
  t362 = my_piecewise5(t10, 0, t14, 0, t361);
  t366 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t215 * t357 + 0.4e1 / 0.3e1 * t23 * t362);
  t367 = t366 * t26;
  t373 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t367 * t47 - t319 / 0.4e1 + t245);
  t374 = t152 * t152;
  t378 = my_piecewise5(t14, 0, t10, 0, -t361);
  t382 = my_piecewise3(t55, 0, 0.4e1 / 0.9e1 * t278 * t374 + 0.4e1 / 0.3e1 * t56 * t378);
  t383 = t382 * t26;
  t392 = t61 * t61;
  t394 = 0.1e1 / t63 / t392;
  t399 = 0.1e1 / t62 / t160 * t75;
  t402 = t394 * t172;
  t405 = t68 * sigma[2];
  t406 = params->cc * t405;
  t407 = t392 * t61;
  t408 = 0.1e1 / t407;
  t410 = 0.1e1 / t171 / t74;
  t411 = t408 * t410;
  t414 = 0.13580246913580246914e0 * t60 * t394 + 0.28e2 / 0.9e1 * t69 * t399 - 0.8e2 / 0.3e1 * t170 * t402 + 0.512e3 / 0.9e1 * t406 * t411;
  t419 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t383 * t78 - t342 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t156 * t176 + t299 - t349 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t59 * t414);
  tv2rho22 = 0.2e1 * t150 + 0.2e1 * t181 + t6 * (t373 + t419);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t427 = t5 * t97 * t193 / 0.8e1;
  t435 = t249 * rho[0];
  t436 = 0.1e1 / t435;
  t438 = t267 * t36;
  t441 = -0.37037037037037037037e-1 * params->bb * t103 - 0.2e1 / 0.3e1 * t187 * t108 + 0.8e1 * params->cc * t103 * t113 - 0.64e2 / 0.3e1 * params->cc * t436 * t438;
  t446 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t91 * t193 - t427 - 0.3e1 / 0.8e1 * t5 * t27 * t441);
  tv2rhosigma0 = t6 * t446 + t197;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t453 = t5 * t132 * t207 / 0.8e1;
  t455 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t128 * t207 - t453);
  tv2rhosigma2 = t6 * t455 + t211;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t461 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t145 * t193 - t427);
  tv2rhosigma3 = t6 * t461 + t197;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t473 = t392 * rho[1];
  t474 = 0.1e1 / t473;
  t476 = t410 * t68;
  t479 = -0.37037037037037037037e-1 * params->bb * t162 - 0.2e1 / 0.3e1 * t201 * t167 + 0.8e1 * params->cc * t162 * t172 - 0.64e2 / 0.3e1 * params->cc * t474 * t476;
  t484 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t156 * t207 - t453 - 0.3e1 / 0.8e1 * t5 * t59 * t479);
  tv2rhosigma5 = t6 * t484 + t211;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t486 = 0.1e1 / t262;
  t487 = params->cc * t486;
  t490 = 0.1e1 / sigma[0];
  t491 = params->cc * t490;
  t492 = t33 * t113;
  t494 = 0.1e1 / t249;
  t499 = -t487 * t45 / 0.4e1 - t491 * t492 + 0.8e1 * params->cc * t494 * t267 * t186;
  t503 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t499);
  tv2sigma20 = t6 * t503;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t504 = 0.1e1 / t405;
  t505 = params->cc * t504;
  t508 = 0.1e1 / sigma[2];
  t509 = params->cc * t508;
  t510 = t65 * t172;
  t512 = 0.1e1 / t392;
  t517 = -t505 * t76 / 0.4e1 - t509 * t510 + 0.8e1 * params->cc * t512 * t410 * t200;
  t521 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t517);
  tv2sigma25 = t6 * t521;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t525 = 0.1e1 / t214 / t19;
  t526 = t216 * t87;
  t529 = t215 * t87;
  t532 = t83 * t83;
  t533 = 0.1e1 / t532;
  t534 = t16 * t533;
  t536 = 0.6e1 * t220 - 0.6e1 * t534;
  t537 = my_piecewise5(t10, 0, t14, 0, t536);
  t541 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t525 * t526 + 0.4e1 / 0.3e1 * t529 * t224 + 0.4e1 / 0.3e1 * t23 * t537);
  t542 = t541 * t26;
  t546 = t228 * t96;
  t548 = t5 * t546 * t47;
  t553 = t90 * t241;
  t555 = t5 * t553 * t47;
  t558 = t5 * t233 * t117;
  t564 = 0.1e1 / t95 / t83;
  t565 = t25 * t564;
  t568 = 0.5e1 / 0.36e2 * t5 * t565 * t47;
  t570 = t5 * t242 * t117;
  t573 = t5 * t97 * t271;
  t576 = 0.1e1 / t31 / t435;
  t581 = 0.1e1 / t30 / t249 * t44;
  t587 = t249 * t101;
  t588 = 0.1e1 / t587;
  t592 = sigma[0] * sigma[0];
  t593 = params->cc * t592;
  t594 = t249 * t249;
  t596 = 0.1e1 / t30 / t594;
  t597 = t112 * t112;
  t598 = 0.1e1 / t597;
  t602 = -0.63374485596707818932e0 * t28 * t576 - 0.28e3 / 0.27e2 * t37 * t581 + 0.3808e4 / 0.27e2 * t111 * t576 * t113 - 0.5632e4 / 0.9e1 * t263 * t588 * t267 + 0.8192e4 / 0.9e1 * t593 * t596 * t598;
  t607 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t542 * t47 - 0.3e1 / 0.8e1 * t548 - 0.9e1 / 0.8e1 * t5 * t229 * t117 + t555 / 0.4e1 - 0.3e1 / 0.4e1 * t558 - 0.9e1 / 0.8e1 * t5 * t91 * t271 - t568 + t570 / 0.4e1 - 0.3e1 / 0.8e1 * t573 - 0.3e1 / 0.8e1 * t5 * t27 * t602);
  t609 = 0.1e1 / t277 / t54;
  t610 = t279 * t124;
  t613 = t278 * t124;
  t617 = my_piecewise5(t14, 0, t10, 0, -t536);
  t621 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t609 * t610 + 0.4e1 / 0.3e1 * t613 * t283 + 0.4e1 / 0.3e1 * t56 * t617);
  t622 = t621 * t26;
  t626 = t287 * t96;
  t628 = t5 * t626 * t78;
  t630 = t127 * t241;
  t632 = t5 * t630 * t78;
  t634 = t58 * t564;
  t637 = 0.5e1 / 0.36e2 * t5 * t634 * t78;
  t639 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t622 * t78 - 0.3e1 / 0.8e1 * t628 + t632 / 0.4e1 - t637);
  tv3rho30 = 0.3e1 * t276 + 0.3e1 * t301 + t6 * (t607 + t639);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t642 = 0.2e1 * t327;
  t643 = 0.2e1 * t352;
  t644 = t525 * t141;
  t647 = t215 * t308;
  t652 = 0.2e1 * t220;
  t653 = 0.6e1 * t534;
  t654 = t652 - t653;
  t655 = my_piecewise5(t10, 0, t14, 0, t654);
  t659 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t644 * t216 + 0.8e1 / 0.9e1 * t647 * t87 + 0.4e1 / 0.9e1 * t304 * t224 + 0.4e1 / 0.3e1 * t23 * t655);
  t660 = t659 * t26;
  t664 = t312 * t96;
  t667 = t5 * t664 * t47 / 0.4e1;
  t671 = t144 * t241;
  t673 = t5 * t671 * t47;
  t677 = t5 * t317 * t117 / 0.4e1;
  t686 = -0.3e1 / 0.8e1 * t5 * t660 * t47 - t667 - 0.3e1 / 0.4e1 * t5 * t313 * t117 + t673 / 0.12e2 - t677 - 0.3e1 / 0.8e1 * t5 * t145 * t271 - t548 / 0.8e1 + t555 / 0.6e1 - t558 / 0.4e1 - t568 + t570 / 0.6e1 - t573 / 0.8e1;
  t687 = my_piecewise3(t1, 0, t686);
  t688 = t609 * t152;
  t691 = t278 * t331;
  t697 = my_piecewise5(t14, 0, t10, 0, -t654);
  t701 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t688 * t279 + 0.8e1 / 0.9e1 * t691 * t124 + 0.4e1 / 0.9e1 * t328 * t283 + 0.4e1 / 0.3e1 * t56 * t697);
  t702 = t701 * t26;
  t706 = t335 * t96;
  t709 = t5 * t706 * t78 / 0.4e1;
  t710 = t155 * t241;
  t712 = t5 * t710 * t78;
  t721 = t5 * t292 * t176 / 0.4e1;
  t723 = t5 * t296 * t176;
  t726 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t702 * t78 - t709 + t712 / 0.12e2 - t628 / 0.8e1 + t632 / 0.6e1 - t637 - 0.3e1 / 0.8e1 * t5 * t288 * t176 - t721 + t723 / 0.12e2);
  tv3rho31 = t276 + t301 + t642 + t643 + t6 * (t687 + t726);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t729 = t525 * t357;
  t734 = t215 * t362;
  t737 = -t652 - t653;
  t738 = my_piecewise5(t10, 0, t14, 0, t737);
  t742 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t729 * t87 + 0.8e1 / 0.9e1 * t304 * t308 + 0.4e1 / 0.9e1 * t734 * t87 + 0.4e1 / 0.3e1 * t23 * t738);
  t743 = t742 * t26;
  t747 = t366 * t96;
  t749 = t5 * t747 * t47;
  t758 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t743 * t47 - t749 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t367 * t117 - t667 + t673 / 0.6e1 - t677 + t555 / 0.12e2 - t568 + t570 / 0.12e2);
  t759 = t609 * t374;
  t764 = t278 * t378;
  t768 = my_piecewise5(t14, 0, t10, 0, -t737);
  t772 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t759 * t124 + 0.8e1 / 0.9e1 * t328 * t331 + 0.4e1 / 0.9e1 * t764 * t124 + 0.4e1 / 0.3e1 * t56 * t768);
  t773 = t772 * t26;
  t777 = t382 * t96;
  t779 = t5 * t777 * t78;
  t786 = t5 * t340 * t176;
  t794 = t5 * t132 * t414;
  t796 = -0.3e1 / 0.8e1 * t5 * t773 * t78 - t779 / 0.8e1 - t709 + t712 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t336 * t176 - t786 / 0.4e1 + t632 / 0.12e2 - t637 - t721 + t723 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t128 * t414 - t794 / 0.8e1;
  t797 = my_piecewise3(t52, 0, t796);
  tv3rho32 = t642 + t643 + t373 + t419 + t6 * (t758 + t797);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t802 = t357 * t141;
  t808 = -0.6e1 * t220 - 0.6e1 * t534;
  t809 = my_piecewise5(t10, 0, t14, 0, t808);
  t813 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t525 * t802 + 0.4e1 / 0.3e1 * t304 * t362 + 0.4e1 / 0.3e1 * t23 * t809);
  t814 = t813 * t26;
  t821 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t814 * t47 - 0.3e1 / 0.8e1 * t749 + t673 / 0.4e1 - t568);
  t822 = t374 * t152;
  t828 = my_piecewise5(t14, 0, t10, 0, -t808);
  t832 = my_piecewise3(t55, 0, -0.8e1 / 0.27e2 * t609 * t822 + 0.4e1 / 0.3e1 * t328 * t378 + 0.4e1 / 0.3e1 * t56 * t828);
  t833 = t832 * t26;
  t849 = 0.1e1 / t63 / t473;
  t854 = 0.1e1 / t62 / t392 * t75;
  t860 = t392 * t160;
  t861 = 0.1e1 / t860;
  t865 = sigma[2] * sigma[2];
  t866 = params->cc * t865;
  t867 = t392 * t392;
  t869 = 0.1e1 / t62 / t867;
  t870 = t171 * t171;
  t871 = 0.1e1 / t870;
  t875 = -0.63374485596707818932e0 * t60 * t849 - 0.28e3 / 0.27e2 * t69 * t854 + 0.3808e4 / 0.27e2 * t170 * t849 * t172 - 0.5632e4 / 0.9e1 * t406 * t861 * t410 + 0.8192e4 / 0.9e1 * t866 * t869 * t871;
  t880 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t833 * t78 - 0.3e1 / 0.8e1 * t779 - 0.9e1 / 0.8e1 * t5 * t383 * t176 + t712 / 0.4e1 - 0.3e1 / 0.4e1 * t786 - 0.9e1 / 0.8e1 * t5 * t156 * t414 - t637 + t723 / 0.4e1 - 0.3e1 / 0.8e1 * t794 - 0.3e1 / 0.8e1 * t5 * t59 * t875);
  tv3rho33 = 0.3e1 * t373 + 0.3e1 * t419 + t6 * (t821 + t880);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t888 = t5 * t233 * t193;
  t895 = t5 * t242 * t193 / 0.12e2;
  t897 = t5 * t97 * t441;
  t911 = params->cc / t30 / t587;
  t912 = t598 * sigma[0];
  t915 = 0.13580246913580246914e0 * params->bb * t251 + 0.14e2 / 0.9e1 * t187 * t256 - 0.296e3 / 0.9e1 * params->cc * t251 * t113 + 0.192e3 * params->cc * t265 * t438 - 0.1024e4 / 0.3e1 * t911 * t912;
  t920 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t193 - t888 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t91 * t441 + t895 - t897 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t915);
  tv3rho2sigma0 = t6 * t920 + 0.2e1 * t446;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t927 = t5 * t292 * t207;
  t931 = t5 * t296 * t207 / 0.12e2;
  t933 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t288 * t207 - t927 / 0.4e1 + t931);
  tv3rho2sigma2 = t6 * t933 + 0.2e1 * t455;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t939 = t5 * t317 * t193;
  t947 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t313 * t193 - t939 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t145 * t441 - t888 / 0.8e1 + t895 - t897 / 0.8e1);
  tv3rho2sigma3 = t6 * t947 + t446 + t461;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t953 = t5 * t340 * t207;
  t960 = t5 * t132 * t479;
  t963 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t336 * t207 - t953 / 0.8e1 - t927 / 0.8e1 + t931 - 0.3e1 / 0.8e1 * t5 * t128 * t479 - t960 / 0.8e1);
  tv3rho2sigma5 = t6 * t963 + t455 + t484;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t971 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t367 * t193 - t939 / 0.4e1 + t895);
  tv3rho2sigma6 = t6 * t971 + 0.2e1 * t461;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t994 = params->cc / t62 / t860;
  t995 = t871 * sigma[2];
  t998 = 0.13580246913580246914e0 * params->bb * t394 + 0.14e2 / 0.9e1 * t201 * t399 - 0.296e3 / 0.9e1 * params->cc * t394 * t172 + 0.192e3 * params->cc * t408 * t476 - 0.1024e4 / 0.3e1 * t994 * t995;
  t1003 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t383 * t207 - t953 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t156 * t479 + t931 - t960 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t59 * t998);
  tv3rho2sigma8 = t6 * t1003 + 0.2e1 * t484;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1010 = t5 * t97 * t499 / 0.8e1;
  t1015 = t436 * t267;
  t1020 = params->cc / t30 / t264;
  t1023 = t487 * t108 / 0.3e1 + 0.4e1 / 0.3e1 * t491 * t114 - 0.128e3 / 0.3e1 * t187 * t1015 + 0.128e3 * t1020 * t598;
  t1028 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t91 * t499 - t1010 - 0.3e1 / 0.8e1 * t5 * t27 * t1023);
  tv3rhosigma20 = t6 * t1028 + t503;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1035 = t5 * t132 * t517 / 0.8e1;
  t1037 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t128 * t517 - t1035);
  tv3rhosigma25 = t6 * t1037 + t521;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1043 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t145 * t499 - t1010);
  tv3rhosigma26 = t6 * t1043 + t503;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1052 = t474 * t410;
  t1057 = params->cc / t62 / t407;
  t1060 = t505 * t167 / 0.3e1 + 0.4e1 / 0.3e1 * t509 * t173 - 0.128e3 / 0.3e1 * t201 * t1052 + 0.128e3 * t1057 * t871;
  t1065 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t156 * t517 - t1035 - 0.3e1 / 0.8e1 * t5 * t59 * t1060);
  tv3rhosigma211 = t6 * t1065 + t521;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1067 = t36 * t592;
  t1069 = params->cc / t1067;
  t1072 = 0.1e1 / t592;
  t1073 = params->cc * t1072;
  t1077 = 0.1e1 / t30 / t435;
  t1078 = params->cc * t1077;
  t1079 = t598 * t490;
  t1082 = 0.3e1 / 0.8e1 * t1069 * t45 + 0.3e1 / 0.2e1 * t1073 * t492 - 0.48e2 * t1078 * t1079;
  t1086 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1082);
  tv3sigma30 = t6 * t1086;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1087 = t68 * t865;
  t1089 = params->cc / t1087;
  t1092 = 0.1e1 / t865;
  t1093 = params->cc * t1092;
  t1097 = 0.1e1 / t62 / t473;
  t1098 = params->cc * t1097;
  t1099 = t871 * t508;
  t1102 = 0.3e1 / 0.8e1 * t1089 * t76 + 0.3e1 / 0.2e1 * t1093 * t510 - 0.48e2 * t1098 * t1099;
  t1106 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * t1102);
  tv3sigma39 = t6 * t1106;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1111 = t5 * t90 * t564 * t47;
  t1114 = 0.1e1 / t95 / t219;
  t1118 = 0.1e2 / 0.27e2 * t5 * t25 * t1114 * t47;
  t1121 = t5 * t541 * t96 * t47;
  t1125 = t5 * t228 * t241 * t47;
  t1128 = t5 * t565 * t117;
  t1131 = t5 * t242 * t271;
  t1134 = t5 * t97 * t602;
  t1137 = 0.1e1 / t31 / t264;
  t1150 = t594 * rho[0];
  t1161 = 0.1e1 / t597 / t43;
  t1173 = t5 * t546 * t117;
  t1179 = t5 * t553 * t117;
  t1181 = t5 * t233 * t271;
  t1186 = t19 * t19;
  t1188 = 0.1e1 / t214 / t1186;
  t1189 = t216 * t216;
  t1195 = t224 * t224;
  t1202 = t16 / t532 / t6;
  t1204 = -0.24e2 * t533 + 0.24e2 * t1202;
  t1205 = my_piecewise5(t10, 0, t14, 0, t1204);
  t1209 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1188 * t1189 - 0.16e2 / 0.9e1 * t525 * t216 * t224 + 0.4e1 / 0.3e1 * t215 * t1195 + 0.16e2 / 0.9e1 * t529 * t537 + 0.4e1 / 0.3e1 * t23 * t1205);
  t1214 = -0.5e1 / 0.9e1 * t1111 + t1118 - t1121 / 0.2e1 + t1125 / 0.2e1 - 0.5e1 / 0.9e1 * t1128 + t1131 / 0.2e1 - t1134 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * (0.35912208504801097395e1 * t28 * t1137 + 0.364e4 / 0.81e2 * t37 * t1077 * t44 - 0.23072e5 / 0.27e2 * t111 * t1137 * t113 + 0.476672e6 / 0.81e2 * t263 / t594 * t267 - 0.475136e6 / 0.27e2 * t593 / t30 / t1150 * t598 + 0.524288e6 / 0.27e2 * params->cc * t1067 / t31 / t594 / t29 * t1161) - 0.3e1 / 0.2e1 * t5 * t542 * t117 - 0.3e1 / 0.2e1 * t1173 - 0.9e1 / 0.4e1 * t5 * t229 * t271 + t1179 - 0.3e1 / 0.2e1 * t1181 - 0.3e1 / 0.2e1 * t5 * t91 * t602 - 0.3e1 / 0.8e1 * t5 * t1209 * t26 * t47;
  t1215 = my_piecewise3(t1, 0, t1214);
  t1216 = t54 * t54;
  t1218 = 0.1e1 / t277 / t1216;
  t1219 = t279 * t279;
  t1225 = t283 * t283;
  t1231 = my_piecewise5(t14, 0, t10, 0, -t1204);
  t1235 = my_piecewise3(t55, 0, 0.4e2 / 0.81e2 * t1218 * t1219 - 0.16e2 / 0.9e1 * t609 * t279 * t283 + 0.4e1 / 0.3e1 * t278 * t1225 + 0.16e2 / 0.9e1 * t613 * t617 + 0.4e1 / 0.3e1 * t56 * t1231);
  t1242 = t5 * t621 * t96 * t78;
  t1246 = t5 * t287 * t241 * t78;
  t1250 = t5 * t127 * t564 * t78;
  t1255 = 0.1e2 / 0.27e2 * t5 * t58 * t1114 * t78;
  t1257 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t1235 * t26 * t78 - t1242 / 0.2e1 + t1246 / 0.2e1 - 0.5e1 / 0.9e1 * t1250 + t1255);
  tv4rho40 = 0.4e1 * t607 + 0.4e1 * t639 + t6 * (t1215 + t1257);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1278 = 0.12e2 * t533;
  t1279 = 0.24e2 * t1202;
  t1280 = -t1278 + t1279;
  t1281 = my_piecewise5(t10, 0, t14, 0, t1280);
  t1285 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1188 * t141 * t526 - 0.8e1 / 0.9e1 * t525 * t308 * t216 - 0.8e1 / 0.9e1 * t644 * t87 * t224 + 0.4e1 / 0.3e1 * t215 * t655 * t87 + 0.4e1 / 0.3e1 * t647 * t224 + 0.4e1 / 0.9e1 * t304 * t537 + 0.4e1 / 0.3e1 * t23 * t1281);
  t1294 = t5 * t664 * t117;
  t1300 = t5 * t671 * t117;
  t1301 = t1300 / 0.4e1;
  t1303 = t5 * t317 * t271;
  t1310 = t5 * t144 * t564 * t47;
  t1314 = t5 * t659 * t96 * t47;
  t1318 = t5 * t312 * t241 * t47;
  t1319 = t1318 / 0.4e1;
  t1329 = -0.3e1 / 0.8e1 * t5 * t1285 * t26 * t47 - 0.9e1 / 0.8e1 * t5 * t660 * t117 - 0.3e1 / 0.4e1 * t1294 - 0.9e1 / 0.8e1 * t5 * t313 * t271 + t1301 - 0.3e1 / 0.8e1 * t1303 - 0.3e1 / 0.8e1 * t5 * t145 * t602 - 0.5e1 / 0.36e2 * t1310 - 0.3e1 / 0.8e1 * t1314 + t1319 - 0.5e1 / 0.12e2 * t1111 + t1118 - t1121 / 0.8e1 + t1125 / 0.4e1 - 0.5e1 / 0.12e2 * t1128 + t1131 / 0.4e1 - t1134 / 0.8e1 - 0.3e1 / 0.8e1 * t1173 + t1179 / 0.2e1 - 0.3e1 / 0.8e1 * t1181;
  t1330 = my_piecewise3(t1, 0, t1329);
  t1348 = my_piecewise5(t14, 0, t10, 0, -t1280);
  t1352 = my_piecewise3(t55, 0, 0.4e2 / 0.81e2 * t1218 * t152 * t610 - 0.8e1 / 0.9e1 * t609 * t331 * t279 - 0.8e1 / 0.9e1 * t688 * t124 * t283 + 0.4e1 / 0.3e1 * t278 * t697 * t124 + 0.4e1 / 0.3e1 * t691 * t283 + 0.4e1 / 0.9e1 * t328 * t617 + 0.4e1 / 0.3e1 * t56 * t1348);
  t1359 = t5 * t701 * t96 * t78;
  t1363 = t5 * t335 * t241 * t78;
  t1364 = t1363 / 0.4e1;
  t1367 = t5 * t155 * t564 * t78;
  t1376 = t5 * t626 * t176;
  t1379 = t5 * t630 * t176;
  t1380 = t1379 / 0.4e1;
  t1382 = t5 * t634 * t176;
  t1384 = -0.3e1 / 0.8e1 * t5 * t1352 * t26 * t78 - 0.3e1 / 0.8e1 * t1359 + t1364 - 0.5e1 / 0.36e2 * t1367 - t1242 / 0.8e1 + t1246 / 0.4e1 - 0.5e1 / 0.12e2 * t1250 + t1255 - 0.3e1 / 0.8e1 * t5 * t622 * t176 - 0.3e1 / 0.8e1 * t1376 + t1380 - 0.5e1 / 0.36e2 * t1382;
  t1385 = my_piecewise3(t52, 0, t1384);
  tv4rho41 = t607 + t639 + 0.3e1 * t687 + 0.3e1 * t726 + t6 * (t1330 + t1385);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1394 = t5 * t742 * t96 * t47;
  t1398 = t5 * t366 * t241 * t47;
  t1408 = t308 * t308;
  t1421 = my_piecewise5(t10, 0, t14, 0, t1279);
  t1425 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1188 * t357 * t216 - 0.32e2 / 0.27e2 * t644 * t87 * t308 - 0.8e1 / 0.27e2 * t729 * t224 + 0.8e1 / 0.9e1 * t215 * t1408 + 0.8e1 / 0.9e1 * t304 * t655 - 0.8e1 / 0.27e2 * t525 * t362 * t216 + 0.8e1 / 0.9e1 * t215 * t738 * t87 + 0.4e1 / 0.9e1 * t734 * t224 + 0.4e1 / 0.3e1 * t23 * t1421);
  t1434 = t5 * t747 * t117;
  t1450 = -t1394 / 0.4e1 + t1398 / 0.12e2 - 0.3e1 / 0.8e1 * t5 * t1425 * t26 * t47 - 0.3e1 / 0.4e1 * t5 * t743 * t117 - t1434 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t367 * t271 - t1294 / 0.2e1 + t1300 / 0.3e1 - t1303 / 0.4e1 - 0.5e1 / 0.18e2 * t1310 - t1314 / 0.4e1 + t1318 / 0.3e1 - 0.5e1 / 0.18e2 * t1111 + t1118 + t1125 / 0.12e2 - 0.5e1 / 0.18e2 * t1128 + t1131 / 0.12e2 + t1179 / 0.6e1;
  t1451 = my_piecewise3(t1, 0, t1450);
  t1460 = t331 * t331;
  t1473 = my_piecewise5(t14, 0, t10, 0, -t1279);
  t1477 = my_piecewise3(t55, 0, 0.4e2 / 0.81e2 * t1218 * t374 * t279 - 0.32e2 / 0.27e2 * t688 * t124 * t331 - 0.8e1 / 0.27e2 * t759 * t283 + 0.8e1 / 0.9e1 * t278 * t1460 + 0.8e1 / 0.9e1 * t328 * t697 - 0.8e1 / 0.27e2 * t609 * t378 * t279 + 0.8e1 / 0.9e1 * t278 * t768 * t124 + 0.4e1 / 0.9e1 * t764 * t283 + 0.4e1 / 0.3e1 * t56 * t1473);
  t1484 = t5 * t772 * t96 * t78;
  t1488 = t5 * t382 * t241 * t78;
  t1497 = t5 * t706 * t176;
  t1500 = t5 * t710 * t176;
  t1511 = t5 * t292 * t414;
  t1514 = t5 * t296 * t414;
  t1516 = -0.3e1 / 0.8e1 * t5 * t1477 * t26 * t78 - t1484 / 0.4e1 + t1488 / 0.12e2 - t1359 / 0.4e1 + t1363 / 0.3e1 - 0.5e1 / 0.18e2 * t1367 - 0.3e1 / 0.4e1 * t5 * t702 * t176 - t1497 / 0.2e1 + t1500 / 0.6e1 + t1246 / 0.12e2 - 0.5e1 / 0.18e2 * t1250 + t1255 - t1376 / 0.4e1 + t1379 / 0.3e1 - 0.5e1 / 0.18e2 * t1382 - 0.3e1 / 0.8e1 * t5 * t288 * t414 - t1511 / 0.4e1 + t1514 / 0.12e2;
  t1517 = my_piecewise3(t52, 0, t1516);
  tv4rho42 = 0.2e1 * t687 + 0.2e1 * t726 + 0.2e1 * t758 + 0.2e1 * t797 + t6 * (t1451 + t1517);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1537 = t1278 + t1279;
  t1538 = my_piecewise5(t10, 0, t14, 0, t1537);
  t1542 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1188 * t802 * t87 - 0.8e1 / 0.9e1 * t729 * t308 - 0.8e1 / 0.9e1 * t644 * t362 * t87 + 0.4e1 / 0.3e1 * t647 * t362 + 0.4e1 / 0.3e1 * t304 * t738 + 0.4e1 / 0.9e1 * t215 * t809 * t87 + 0.4e1 / 0.3e1 * t23 * t1538);
  t1549 = t5 * t813 * t96 * t47;
  t1560 = -0.3e1 / 0.8e1 * t5 * t1542 * t26 * t47 - t1549 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t814 * t117 - 0.3e1 / 0.8e1 * t1394 + t1398 / 0.4e1 - 0.3e1 / 0.8e1 * t1434 + t1319 - 0.5e1 / 0.12e2 * t1310 + t1301 - 0.5e1 / 0.36e2 * t1111 + t1118 - 0.5e1 / 0.36e2 * t1128;
  t1561 = my_piecewise3(t1, 0, t1560);
  t1578 = my_piecewise5(t14, 0, t10, 0, -t1537);
  t1582 = my_piecewise3(t55, 0, 0.4e2 / 0.81e2 * t1218 * t822 * t124 - 0.8e1 / 0.9e1 * t759 * t331 - 0.8e1 / 0.9e1 * t688 * t378 * t124 + 0.4e1 / 0.3e1 * t691 * t378 + 0.4e1 / 0.3e1 * t328 * t768 + 0.4e1 / 0.9e1 * t278 * t828 * t124 + 0.4e1 / 0.3e1 * t56 * t1578);
  t1589 = t5 * t832 * t96 * t78;
  t1597 = t5 * t777 * t176;
  t1606 = t5 * t340 * t414;
  t1616 = t5 * t132 * t875;
  t1618 = -0.3e1 / 0.8e1 * t5 * t1582 * t26 * t78 - t1589 / 0.8e1 - 0.3e1 / 0.8e1 * t1484 + t1488 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t773 * t176 - 0.3e1 / 0.8e1 * t1597 + t1364 - 0.5e1 / 0.12e2 * t1367 - 0.3e1 / 0.4e1 * t1497 + t1500 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t336 * t414 - 0.3e1 / 0.8e1 * t1606 - 0.5e1 / 0.36e2 * t1250 + t1255 + t1380 - 0.5e1 / 0.12e2 * t1382 - 0.3e1 / 0.8e1 * t1511 + t1514 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t128 * t875 - t1616 / 0.8e1;
  t1619 = my_piecewise3(t52, 0, t1618);
  tv4rho43 = 0.3e1 * t758 + 0.3e1 * t797 + t821 + t880 + t6 * (t1561 + t1619);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t1624 = t357 * t357;
  t1629 = t362 * t362;
  t1635 = 0.24e2 * t533 + 0.24e2 * t1202;
  t1636 = my_piecewise5(t10, 0, t14, 0, t1635);
  t1640 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1188 * t1624 - 0.16e2 / 0.9e1 * t729 * t362 + 0.4e1 / 0.3e1 * t215 * t1629 + 0.16e2 / 0.9e1 * t304 * t809 + 0.4e1 / 0.3e1 * t23 * t1636);
  t1649 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1640 * t26 * t47 - t1549 / 0.2e1 + t1398 / 0.2e1 - 0.5e1 / 0.9e1 * t1310 + t1118);
  t1651 = 0.1e1 / t63 / t407;
  t1664 = t867 * rho[1];
  t1675 = 0.1e1 / t870 / t74;
  t1683 = t374 * t374;
  t1688 = t378 * t378;
  t1694 = my_piecewise5(t14, 0, t10, 0, -t1635);
  t1698 = my_piecewise3(t55, 0, 0.4e2 / 0.81e2 * t1218 * t1683 - 0.16e2 / 0.9e1 * t759 * t378 + 0.4e1 / 0.3e1 * t278 * t1688 + 0.16e2 / 0.9e1 * t328 * t828 + 0.4e1 / 0.3e1 * t56 * t1694);
  t1720 = -0.3e1 / 0.8e1 * t5 * t59 * (0.35912208504801097395e1 * t60 * t1651 + 0.364e4 / 0.81e2 * t69 * t1097 * t75 - 0.23072e5 / 0.27e2 * t170 * t1651 * t172 + 0.476672e6 / 0.81e2 * t406 / t867 * t410 - 0.475136e6 / 0.27e2 * t866 / t62 / t1664 * t871 + 0.524288e6 / 0.27e2 * params->cc * t1087 / t63 / t867 / t61 * t1675) - 0.3e1 / 0.8e1 * t5 * t1698 * t26 * t78 - 0.3e1 / 0.2e1 * t5 * t833 * t176 - 0.9e1 / 0.4e1 * t5 * t383 * t414 - 0.3e1 / 0.2e1 * t5 * t156 * t875 - t1589 / 0.2e1 - 0.3e1 / 0.2e1 * t1597 - 0.3e1 / 0.2e1 * t1606 - t1616 / 0.2e1 + t1514 / 0.2e1 + t1488 / 0.2e1 + t1500 - 0.5e1 / 0.9e1 * t1367 - 0.5e1 / 0.9e1 * t1382 + t1255;
  t1721 = my_piecewise3(t52, 0, t1720);
  tv4rho44 = 0.4e1 * t821 + 0.4e1 * t880 + t6 * (t1649 + t1721);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t1729 = t5 * t546 * t193;
  t1735 = t5 * t553 * t193;
  t1738 = t5 * t233 * t441;
  t1745 = 0.5e1 / 0.36e2 * t5 * t565 * t193;
  t1747 = t5 * t242 * t441;
  t1750 = t5 * t97 * t915;
  t1776 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t542 * t193 - 0.3e1 / 0.8e1 * t1729 - 0.9e1 / 0.8e1 * t5 * t229 * t441 + t1735 / 0.4e1 - 0.3e1 / 0.4e1 * t1738 - 0.9e1 / 0.8e1 * t5 * t91 * t915 - t1745 + t1747 / 0.4e1 - 0.3e1 / 0.8e1 * t1750 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.63374485596707818932e0 * params->bb * t576 - 0.14e3 / 0.27e2 * t187 * t581 + 0.1456e4 / 0.9e1 * params->cc * t576 * t113 - 0.40576e5 / 0.27e2 * params->cc * t588 * t438 + 0.50176e5 / 0.9e1 * params->cc * t596 * t912 - 0.65536e5 / 0.9e1 * params->cc / t31 / t1150 * t1161 * t262));
  tv4rho3sigma0 = t6 * t1776 + 0.3e1 * t920;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t1783 = t5 * t626 * t207;
  t1786 = t5 * t630 * t207;
  t1790 = 0.5e1 / 0.36e2 * t5 * t634 * t207;
  t1792 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t622 * t207 - 0.3e1 / 0.8e1 * t1783 + t1786 / 0.4e1 - t1790);
  tv4rho3sigma2 = t6 * t1792 + 0.3e1 * t933;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t1794 = 0.2e1 * t947;
  t1800 = t5 * t664 * t193 / 0.4e1;
  t1805 = t5 * t671 * t193;
  t1809 = t5 * t317 * t441 / 0.4e1;
  t1818 = -0.3e1 / 0.8e1 * t5 * t660 * t193 - t1800 - 0.3e1 / 0.4e1 * t5 * t313 * t441 + t1805 / 0.12e2 - t1809 - 0.3e1 / 0.8e1 * t5 * t145 * t915 - t1729 / 0.8e1 + t1735 / 0.6e1 - t1738 / 0.4e1 - t1745 + t1747 / 0.6e1 - t1750 / 0.8e1;
  t1819 = my_piecewise3(t1, 0, t1818);
  tv4rho3sigma3 = t6 * t1819 + t1794 + t920;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t1821 = 0.2e1 * t963;
  t1827 = t5 * t706 * t207 / 0.4e1;
  t1829 = t5 * t710 * t207;
  t1838 = t5 * t292 * t479 / 0.4e1;
  t1840 = t5 * t296 * t479;
  t1843 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t702 * t207 - t1827 + t1829 / 0.12e2 - t1783 / 0.8e1 + t1786 / 0.6e1 - t1790 - 0.3e1 / 0.8e1 * t5 * t288 * t479 - t1838 + t1840 / 0.12e2);
  tv4rho3sigma5 = t6 * t1843 + t1821 + t933;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t1849 = t5 * t747 * t193;
  t1858 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t743 * t193 - t1849 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t367 * t441 - t1800 + t1805 / 0.6e1 - t1809 + t1735 / 0.12e2 - t1745 + t1747 / 0.12e2);
  tv4rho3sigma6 = t6 * t1858 + t1794 + t971;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t1864 = t5 * t777 * t207;
  t1871 = t5 * t340 * t479;
  t1879 = t5 * t132 * t998;
  t1881 = -0.3e1 / 0.8e1 * t5 * t773 * t207 - t1864 / 0.8e1 - t1827 + t1829 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t336 * t479 - t1871 / 0.4e1 + t1786 / 0.12e2 - t1790 - t1838 + t1840 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t128 * t998 - t1879 / 0.8e1;
  t1882 = my_piecewise3(t52, 0, t1881);
  tv4rho3sigma8 = t6 * t1882 + t1003 + t1821;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t1891 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t814 * t193 - 0.3e1 / 0.8e1 * t1849 + t1805 / 0.4e1 - t1745);
  tv4rho3sigma9 = t6 * t1891 + 0.3e1 * t971;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t1932 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t833 * t207 - 0.3e1 / 0.8e1 * t1864 - 0.9e1 / 0.8e1 * t5 * t383 * t479 + t1829 / 0.4e1 - 0.3e1 / 0.4e1 * t1871 - 0.9e1 / 0.8e1 * t5 * t156 * t998 - t1790 + t1840 / 0.4e1 - 0.3e1 / 0.8e1 * t1879 - 0.3e1 / 0.8e1 * t5 * t59 * (-0.63374485596707818932e0 * params->bb * t849 - 0.14e3 / 0.27e2 * t201 * t854 + 0.1456e4 / 0.9e1 * params->cc * t849 * t172 - 0.40576e5 / 0.27e2 * params->cc * t861 * t476 + 0.50176e5 / 0.9e1 * params->cc * t869 * t995 - 0.65536e5 / 0.9e1 * params->cc / t63 / t1664 * t1675 * t405));
  tv4rho3sigma11 = t6 * t1932 + 0.3e1 * t1003;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t1939 = t5 * t233 * t499;
  t1946 = t5 * t242 * t499 / 0.12e2;
  t1948 = t5 * t97 * t1023;
  t1969 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t229 * t499 - t1939 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t91 * t1023 + t1946 - t1948 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (-0.7e1 / 0.9e1 * t487 * t256 - 0.28e2 / 0.9e1 * t491 * t259 + 0.2048e4 / 0.9e1 * t187 * t268 - 0.448e4 / 0.3e1 * t911 * t598 + 0.8192e4 / 0.3e1 * params->cc / t31 / t594 * t1161 * t36));
  tv4rho2sigma20 = t6 * t1969 + 0.2e1 * t1028;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t1976 = t5 * t292 * t517;
  t1980 = t5 * t296 * t517 / 0.12e2;
  t1982 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t288 * t517 - t1976 / 0.4e1 + t1980);
  tv4rho2sigma25 = t6 * t1982 + 0.2e1 * t1037;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t1988 = t5 * t317 * t499;
  t1996 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t313 * t499 - t1988 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t145 * t1023 - t1939 / 0.8e1 + t1946 - t1948 / 0.8e1);
  tv4rho2sigma26 = t6 * t1996 + t1028 + t1043;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2002 = t5 * t340 * t517;
  t2009 = t5 * t132 * t1060;
  t2012 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t336 * t517 - t2002 / 0.8e1 - t1976 / 0.8e1 + t1980 - 0.3e1 / 0.8e1 * t5 * t128 * t1060 - t2009 / 0.8e1);
  tv4rho2sigma211 = t6 * t2012 + t1037 + t1065;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2020 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t367 * t499 - t1988 / 0.4e1 + t1946);
  tv4rho2sigma212 = t6 * t2020 + 0.2e1 * t1043;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2050 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t383 * t517 - t2002 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t156 * t1060 + t1980 - t2009 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t59 * (-0.7e1 / 0.9e1 * t505 * t399 - 0.28e2 / 0.9e1 * t509 * t402 + 0.2048e4 / 0.9e1 * t201 * t411 - 0.448e4 / 0.3e1 * t994 * t871 + 0.8192e4 / 0.3e1 * params->cc / t63 / t867 * t1675 * t68));
  tv4rho2sigma217 = t6 * t2050 + 0.2e1 * t1065;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2057 = t5 * t97 * t1082 / 0.8e1;
  t2077 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t91 * t1082 - t2057 - 0.3e1 / 0.8e1 * t5 * t27 * (-t1069 * t108 / 0.2e1 - 0.2e1 * t1073 * t114 + 0.16e2 * t487 * t1015 + 0.256e3 * t1020 * t1079 - 0.1024e4 * params->cc / t31 / t587 * t1161 * t186));
  tv4rhosigma30 = t6 * t2077 + t1086;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2084 = t5 * t132 * t1102 / 0.8e1;
  t2086 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t128 * t1102 - t2084);
  tv4rhosigma39 = t6 * t2086 + t1106;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2092 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t145 * t1082 - t2057);
  tv4rhosigma310 = t6 * t2092 + t1086;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2116 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t156 * t1102 - t2084 - 0.3e1 / 0.8e1 * t5 * t59 * (-t1089 * t167 / 0.2e1 - 0.2e1 * t1093 * t173 + 0.16e2 * t505 * t1052 + 0.256e3 * t1057 * t1099 - 0.1024e4 * params->cc / t63 / t860 * t1675 * t200));
  tv4rhosigma319 = t6 * t2116 + t1106;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2118 = t592 * sigma[0];
  t2142 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (-0.15e2 / 0.16e2 * params->cc / t36 / t2118 * t45 - 0.15e2 / 0.4e1 * params->cc / t2118 * t492 - 0.6e1 * t1069 * t494 * t267 + 0.384e3 * params->cc * t1137 * t1161 * t486 + 0.48e2 * t1078 * t598 * t1072));
  tv4sigma40 = t6 * t2142;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2143 = t865 * sigma[2];
  t2167 = my_piecewise3(t52, 0, -0.3e1 / 0.8e1 * t5 * t59 * (-0.15e2 / 0.16e2 * params->cc / t68 / t2143 * t76 - 0.15e2 / 0.4e1 * params->cc / t2143 * t510 - 0.6e1 * t1089 * t512 * t410 + 0.384e3 * params->cc * t1651 * t1675 * t504 + 0.48e2 * t1098 * t871 * t1092));
  tv4sigma414 = t6 * t2167;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

