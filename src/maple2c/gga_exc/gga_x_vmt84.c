/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_vmt84.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t37, t38, t41;
  double t42, t45, t46, t47, t48, t51, t54, t55;
  double t56, t57, t58, t59, t61, t65, t68, t69;
  double t70, t74, t78, tzk0;

  gga_x_vmt84_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt84_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->mu * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t25 * sigma[0];
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t32 = t31 * t30;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t36 = params->alpha * t20 * t25;
  t37 = sigma[0] * t29;
  t38 = t37 * t33;
  t41 = exp(-t36 * t38 / 0.24e2);
  t42 = t21 * t25;
  t45 = 0.1e1 + t42 * t38 / 0.24e2;
  t46 = 0.1e1 / t45;
  t47 = t41 * t46;
  t48 = t34 * t47;
  t51 = t20 * t20;
  t54 = 0.1e1 / t23 / t22;
  t55 = params->alpha * t51 * t54;
  t56 = sigma[0] * sigma[0];
  t57 = t56 * t28;
  t58 = t30 * t30;
  t59 = t58 * rho[0];
  t61 = 0.1e1 / t18 / t59;
  t65 = exp(-t55 * t57 * t61 / 0.288e3);
  t68 = (0.1e1 - t65) * t51 * t24;
  t69 = 0.1e1 / sigma[0];
  t70 = t69 * t28;
  t74 = t27 * t48 / 0.24e2 + 0.2e1 * t68 * t70 * t32 + t65;
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t37, t38, t41;
  double t42, t45, t46, t47, t48, t51, t54, t55;
  double t56, t57, t58, t59, t61, t65, t68, t69;
  double t70, t74, t78, tzk0;

  double t80, t84, t86, t88, t91, t92, t93, t94;
  double t96, t97, t98, t99, t103, t104, t105, t106;
  double t107, t108, t109, t112, t116, t120, t124, t129;
  double tvrho0, t134, t136, t141, t147, t148, t152, t157;
  double t161, tvsigma0;

  gga_x_vmt84_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt84_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->mu * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t25 * sigma[0];
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t32 = t31 * t30;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t36 = params->alpha * t20 * t25;
  t37 = sigma[0] * t29;
  t38 = t37 * t33;
  t41 = exp(-t36 * t38 / 0.24e2);
  t42 = t21 * t25;
  t45 = 0.1e1 + t42 * t38 / 0.24e2;
  t46 = 0.1e1 / t45;
  t47 = t41 * t46;
  t48 = t34 * t47;
  t51 = t20 * t20;
  t54 = 0.1e1 / t23 / t22;
  t55 = params->alpha * t51 * t54;
  t56 = sigma[0] * sigma[0];
  t57 = t56 * t28;
  t58 = t30 * t30;
  t59 = t58 * rho[0];
  t61 = 0.1e1 / t18 / t59;
  t65 = exp(-t55 * t57 * t61 / 0.288e3);
  t68 = (0.1e1 - t65) * t51 * t24;
  t69 = 0.1e1 / sigma[0];
  t70 = t69 * t28;
  t74 = t27 * t48 / 0.24e2 + 0.2e1 * t68 * t70 * t32 + t65;
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t31;
  t84 = t30 * rho[0];
  t86 = 0.1e1 / t31 / t84;
  t88 = t29 * t86 * t47;
  t91 = params->mu * t51;
  t92 = t54 * t56;
  t93 = t91 * t92;
  t94 = t58 * t30;
  t96 = 0.1e1 / t18 / t94;
  t97 = t28 * t96;
  t98 = params->alpha * t41;
  t99 = t98 * t46;
  t103 = params->mu * params->mu;
  t104 = t103 * t51;
  t105 = t104 * t92;
  t106 = t45 * t45;
  t107 = 0.1e1 / t106;
  t108 = t41 * t107;
  t109 = t97 * t108;
  t112 = t86 * t65;
  t116 = t31 * rho[0];
  t120 = t96 * t65;
  t124 = -t27 * t88 / 0.9e1 + t93 * t97 * t99 / 0.108e3 + t105 * t109 / 0.108e3 - 0.2e1 / 0.9e1 * t36 * t37 * t112 + 0.16e2 / 0.3e1 * t68 * t70 * t116 + t55 * t57 * t120 / 0.54e2;
  t129 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t124);
  tvrho0 = 0.2e1 * rho[0] * t129 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t134 = t54 * sigma[0];
  t136 = t28 * t61;
  t141 = t136 * t108;
  t147 = 0.1e1 / t56;
  t148 = t147 * t28;
  t152 = sigma[0] * t28;
  t157 = t42 * t48 / 0.24e2 - t91 * t134 * t136 * t99 / 0.288e3 - t104 * t134 * t141 / 0.288e3 + t36 * t34 * t65 / 0.12e2 - 0.2e1 * t68 * t148 * t32 - t55 * t152 * t61 * t65 / 0.144e3;
  t161 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t157);
  tvsigma0 = 0.2e1 * rho[0] * t161;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t37, t38, t41;
  double t42, t45, t46, t47, t48, t51, t54, t55;
  double t56, t57, t58, t59, t61, t65, t68, t69;
  double t70, t74, t78, tzk0;

  double t80, t84, t86, t88, t91, t92, t93, t94;
  double t96, t97, t98, t99, t103, t104, t105, t106;
  double t107, t108, t109, t112, t116, t120, t124, t129;
  double tvrho0, t134, t136, t141, t147, t148, t152, t157;
  double t161, tvsigma0;

  double t165, t173, t174, t175, t178, t180, t181, t185;
  double t188, t189, t190, t191, t192, t193, t194, t195;
  double t196, t201, t202, t208, t209, t212, t216, t220;
  double t228, t234, t235, t236, t237, t238, t240, t241;
  double t245, t250, tv2rho20, t258, t259, t260, t262, t266;
  double t268, t273, t274, t286, t299, t300, t302, t307;
  double t312, tv2rhosigma0, t319, t323, t335, t342, t343, t347;
  double t348, t357, t362, t366, tv2sigma20;

  gga_x_vmt84_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt84_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->mu * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t25 * sigma[0];
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t32 = t31 * t30;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t36 = params->alpha * t20 * t25;
  t37 = sigma[0] * t29;
  t38 = t37 * t33;
  t41 = exp(-t36 * t38 / 0.24e2);
  t42 = t21 * t25;
  t45 = 0.1e1 + t42 * t38 / 0.24e2;
  t46 = 0.1e1 / t45;
  t47 = t41 * t46;
  t48 = t34 * t47;
  t51 = t20 * t20;
  t54 = 0.1e1 / t23 / t22;
  t55 = params->alpha * t51 * t54;
  t56 = sigma[0] * sigma[0];
  t57 = t56 * t28;
  t58 = t30 * t30;
  t59 = t58 * rho[0];
  t61 = 0.1e1 / t18 / t59;
  t65 = exp(-t55 * t57 * t61 / 0.288e3);
  t68 = (0.1e1 - t65) * t51 * t24;
  t69 = 0.1e1 / sigma[0];
  t70 = t69 * t28;
  t74 = t27 * t48 / 0.24e2 + 0.2e1 * t68 * t70 * t32 + t65;
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t31;
  t84 = t30 * rho[0];
  t86 = 0.1e1 / t31 / t84;
  t88 = t29 * t86 * t47;
  t91 = params->mu * t51;
  t92 = t54 * t56;
  t93 = t91 * t92;
  t94 = t58 * t30;
  t96 = 0.1e1 / t18 / t94;
  t97 = t28 * t96;
  t98 = params->alpha * t41;
  t99 = t98 * t46;
  t103 = params->mu * params->mu;
  t104 = t103 * t51;
  t105 = t104 * t92;
  t106 = t45 * t45;
  t107 = 0.1e1 / t106;
  t108 = t41 * t107;
  t109 = t97 * t108;
  t112 = t86 * t65;
  t116 = t31 * rho[0];
  t120 = t96 * t65;
  t124 = -t27 * t88 / 0.9e1 + t93 * t97 * t99 / 0.108e3 + t105 * t109 / 0.108e3 - 0.2e1 / 0.9e1 * t36 * t37 * t112 + 0.16e2 / 0.3e1 * t68 * t70 * t116 + t55 * t57 * t120 / 0.54e2;
  t129 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t124);
  tvrho0 = 0.2e1 * rho[0] * t129 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t134 = t54 * sigma[0];
  t136 = t28 * t61;
  t141 = t136 * t108;
  t147 = 0.1e1 / t56;
  t148 = t147 * t28;
  t152 = sigma[0] * t28;
  t157 = t42 * t48 / 0.24e2 - t91 * t134 * t136 * t99 / 0.288e3 - t104 * t134 * t141 / 0.288e3 + t36 * t34 * t65 / 0.12e2 - 0.2e1 * t68 * t148 * t32 - t55 * t152 * t61 * t65 / 0.144e3;
  t161 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t157);
  tvsigma0 = 0.2e1 * rho[0] * t161;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t165 = t17 / t116;
  t173 = 0.1e1 / t31 / t58;
  t174 = t29 * t173;
  t175 = t174 * t47;
  t178 = t58 * t84;
  t180 = 0.1e1 / t18 / t178;
  t181 = t28 * t180;
  t185 = t181 * t108;
  t188 = t22 * t22;
  t189 = 0.1e1 / t188;
  t190 = params->mu * t189;
  t191 = t56 * sigma[0];
  t192 = t190 * t191;
  t193 = t58 * t58;
  t194 = t193 * t30;
  t195 = 0.1e1 / t194;
  t196 = params->alpha * params->alpha;
  t201 = t103 * t189;
  t202 = t201 * t191;
  t208 = t103 * params->mu * t189;
  t209 = t208 * t191;
  t212 = 0.1e1 / t106 / t45;
  t216 = t173 * t65;
  t220 = t196 * t189;
  t228 = t180 * t65;
  t234 = 0.1e1 / t24 / t188;
  t235 = t196 * t20 * t234;
  t236 = t56 * t56;
  t237 = t236 * t29;
  t238 = t193 * t58;
  t240 = 0.1e1 / t31 / t238;
  t241 = t240 * t65;
  t245 = 0.11e2 / 0.27e2 * t27 * t175 - t93 * t181 * t99 / 0.12e2 - t105 * t185 / 0.12e2 + t192 * t195 * t196 * t47 / 0.81e2 + 0.2e1 / 0.81e2 * t202 * t195 * params->alpha * t108 + 0.2e1 / 0.81e2 * t209 * t195 * t41 * t212 + 0.2e1 / 0.9e1 * t36 * t37 * t216 - 0.4e1 / 0.81e2 * t220 * t191 * t195 * t65 + 0.8e2 / 0.9e1 * t68 * t70 * t31 - 0.19e2 / 0.162e3 * t55 * t57 * t228 + t235 * t237 * t241 / 0.486e3;
  t250 = my_piecewise3(t2, 0, t6 * t165 * t74 / 0.12e2 - t6 * t80 * t124 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t245);
  tv2rho20 = 0.2e1 * rho[0] * t250 + 0.4e1 * t129;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t258 = t54 * t28;
  t259 = t91 * t258;
  t260 = t96 * params->alpha;
  t262 = sigma[0] * t41 * t46;
  t266 = t104 * t258;
  t268 = t107 * sigma[0];
  t273 = t193 * rho[0];
  t274 = 0.1e1 / t273;
  t286 = t274 * t41 * t212;
  t299 = t191 * t29;
  t300 = t193 * t84;
  t302 = 0.1e1 / t31 / t300;
  t307 = -t42 * t88 / 0.9e1 + t259 * t260 * t262 / 0.36e2 + t266 * t96 * t41 * t268 / 0.36e2 - t190 * t56 * t274 * t196 * t47 / 0.216e3 - t201 * t56 * t274 * params->alpha * t108 / 0.108e3 - t208 * t56 * t286 / 0.108e3 + t220 * t274 * t56 * t65 / 0.54e2 - 0.16e2 / 0.3e1 * t68 * t148 * t116 + t55 * t152 * t120 / 0.27e2 - t235 * t299 * t302 * t65 / 0.1296e4;
  t312 = my_piecewise3(t2, 0, -t6 * t80 * t157 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t307);
  tv2rhosigma0 = 0.2e1 * rho[0] * t312 + 0.2e1 * t161;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t319 = t104 * t54;
  t323 = 0.1e1 / t193;
  t335 = t323 * t41 * t212;
  t342 = t69 * t29;
  t343 = t33 * t65;
  t347 = 0.1e1 / t191;
  t348 = t347 * t28;
  t357 = 0.1e1 / t31 / t194;
  t362 = -t259 * t61 * params->alpha * t47 / 0.144e3 - t319 * t141 / 0.144e3 + t190 * sigma[0] * t323 * t196 * t47 / 0.576e3 + t201 * sigma[0] * t323 * params->alpha * t108 / 0.288e3 + t208 * sigma[0] * t335 / 0.288e3 - t220 * t323 * sigma[0] * t65 / 0.144e3 - t36 * t342 * t343 / 0.12e2 + 0.4e1 * t68 * t348 * t32 - t55 * t136 * t65 / 0.144e3 + t235 * t56 * t29 * t357 * t65 / 0.3456e4;
  t366 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t362);
  tv2sigma20 = 0.2e1 * rho[0] * t366;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t37, t38, t41;
  double t42, t45, t46, t47, t48, t51, t54, t55;
  double t56, t57, t58, t59, t61, t65, t68, t69;
  double t70, t74, t78, tzk0;

  double t80, t84, t86, t88, t91, t92, t93, t94;
  double t96, t97, t98, t99, t103, t104, t105, t106;
  double t107, t108, t109, t112, t116, t120, t124, t129;
  double tvrho0, t134, t136, t141, t147, t148, t152, t157;
  double t161, tvsigma0;

  double t165, t173, t174, t175, t178, t180, t181, t185;
  double t188, t189, t190, t191, t192, t193, t194, t195;
  double t196, t201, t202, t208, t209, t212, t216, t220;
  double t228, t234, t235, t236, t237, t238, t240, t241;
  double t245, t250, tv2rho20, t258, t259, t260, t262, t266;
  double t268, t273, t274, t286, t299, t300, t302, t307;
  double t312, tv2rhosigma0, t319, t323, t335, t342, t343, t347;
  double t348, t357, t362, t366, tv2sigma20;

  double t369, t379, t385, t390, t391, t392, t393, t395;
  double t398, t400, t404, t405, t409, t413, t415, t416;
  double t419, t420, t421, t422, t427, t428, t433, t434;
  double t437, t441, t453, t454, t460, t461, t463, t464;
  double t465, t466, t473, t474, t475, t476, t477, t478;
  double t483, t488, tv3rho30, t498, t499, t520, t525, t538;
  double t540, t543, t545, t554, t561, t562, t567, t572;
  double tv3rho2sigma0, t579, t591, t593, t598, t617, t618, t622;
  double t624, t627, t628, t637, t638, t643, t648, tv3rhosigma20;
  double t653, t657, t662, t679, t684, t689, t693, t694;
  double t698, t703, t707, tv3sigma30;

  gga_x_vmt84_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt84_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->mu * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t25 * sigma[0];
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t32 = t31 * t30;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t36 = params->alpha * t20 * t25;
  t37 = sigma[0] * t29;
  t38 = t37 * t33;
  t41 = exp(-t36 * t38 / 0.24e2);
  t42 = t21 * t25;
  t45 = 0.1e1 + t42 * t38 / 0.24e2;
  t46 = 0.1e1 / t45;
  t47 = t41 * t46;
  t48 = t34 * t47;
  t51 = t20 * t20;
  t54 = 0.1e1 / t23 / t22;
  t55 = params->alpha * t51 * t54;
  t56 = sigma[0] * sigma[0];
  t57 = t56 * t28;
  t58 = t30 * t30;
  t59 = t58 * rho[0];
  t61 = 0.1e1 / t18 / t59;
  t65 = exp(-t55 * t57 * t61 / 0.288e3);
  t68 = (0.1e1 - t65) * t51 * t24;
  t69 = 0.1e1 / sigma[0];
  t70 = t69 * t28;
  t74 = t27 * t48 / 0.24e2 + 0.2e1 * t68 * t70 * t32 + t65;
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t31;
  t84 = t30 * rho[0];
  t86 = 0.1e1 / t31 / t84;
  t88 = t29 * t86 * t47;
  t91 = params->mu * t51;
  t92 = t54 * t56;
  t93 = t91 * t92;
  t94 = t58 * t30;
  t96 = 0.1e1 / t18 / t94;
  t97 = t28 * t96;
  t98 = params->alpha * t41;
  t99 = t98 * t46;
  t103 = params->mu * params->mu;
  t104 = t103 * t51;
  t105 = t104 * t92;
  t106 = t45 * t45;
  t107 = 0.1e1 / t106;
  t108 = t41 * t107;
  t109 = t97 * t108;
  t112 = t86 * t65;
  t116 = t31 * rho[0];
  t120 = t96 * t65;
  t124 = -t27 * t88 / 0.9e1 + t93 * t97 * t99 / 0.108e3 + t105 * t109 / 0.108e3 - 0.2e1 / 0.9e1 * t36 * t37 * t112 + 0.16e2 / 0.3e1 * t68 * t70 * t116 + t55 * t57 * t120 / 0.54e2;
  t129 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t124);
  tvrho0 = 0.2e1 * rho[0] * t129 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t134 = t54 * sigma[0];
  t136 = t28 * t61;
  t141 = t136 * t108;
  t147 = 0.1e1 / t56;
  t148 = t147 * t28;
  t152 = sigma[0] * t28;
  t157 = t42 * t48 / 0.24e2 - t91 * t134 * t136 * t99 / 0.288e3 - t104 * t134 * t141 / 0.288e3 + t36 * t34 * t65 / 0.12e2 - 0.2e1 * t68 * t148 * t32 - t55 * t152 * t61 * t65 / 0.144e3;
  t161 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t157);
  tvsigma0 = 0.2e1 * rho[0] * t161;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t165 = t17 / t116;
  t173 = 0.1e1 / t31 / t58;
  t174 = t29 * t173;
  t175 = t174 * t47;
  t178 = t58 * t84;
  t180 = 0.1e1 / t18 / t178;
  t181 = t28 * t180;
  t185 = t181 * t108;
  t188 = t22 * t22;
  t189 = 0.1e1 / t188;
  t190 = params->mu * t189;
  t191 = t56 * sigma[0];
  t192 = t190 * t191;
  t193 = t58 * t58;
  t194 = t193 * t30;
  t195 = 0.1e1 / t194;
  t196 = params->alpha * params->alpha;
  t201 = t103 * t189;
  t202 = t201 * t191;
  t208 = t103 * params->mu * t189;
  t209 = t208 * t191;
  t212 = 0.1e1 / t106 / t45;
  t216 = t173 * t65;
  t220 = t196 * t189;
  t228 = t180 * t65;
  t234 = 0.1e1 / t24 / t188;
  t235 = t196 * t20 * t234;
  t236 = t56 * t56;
  t237 = t236 * t29;
  t238 = t193 * t58;
  t240 = 0.1e1 / t31 / t238;
  t241 = t240 * t65;
  t245 = 0.11e2 / 0.27e2 * t27 * t175 - t93 * t181 * t99 / 0.12e2 - t105 * t185 / 0.12e2 + t192 * t195 * t196 * t47 / 0.81e2 + 0.2e1 / 0.81e2 * t202 * t195 * params->alpha * t108 + 0.2e1 / 0.81e2 * t209 * t195 * t41 * t212 + 0.2e1 / 0.9e1 * t36 * t37 * t216 - 0.4e1 / 0.81e2 * t220 * t191 * t195 * t65 + 0.8e2 / 0.9e1 * t68 * t70 * t31 - 0.19e2 / 0.162e3 * t55 * t57 * t228 + t235 * t237 * t241 / 0.486e3;
  t250 = my_piecewise3(t2, 0, t6 * t165 * t74 / 0.12e2 - t6 * t80 * t124 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t245);
  tv2rho20 = 0.2e1 * rho[0] * t250 + 0.4e1 * t129;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t258 = t54 * t28;
  t259 = t91 * t258;
  t260 = t96 * params->alpha;
  t262 = sigma[0] * t41 * t46;
  t266 = t104 * t258;
  t268 = t107 * sigma[0];
  t273 = t193 * rho[0];
  t274 = 0.1e1 / t273;
  t286 = t274 * t41 * t212;
  t299 = t191 * t29;
  t300 = t193 * t84;
  t302 = 0.1e1 / t31 / t300;
  t307 = -t42 * t88 / 0.9e1 + t259 * t260 * t262 / 0.36e2 + t266 * t96 * t41 * t268 / 0.36e2 - t190 * t56 * t274 * t196 * t47 / 0.216e3 - t201 * t56 * t274 * params->alpha * t108 / 0.108e3 - t208 * t56 * t286 / 0.108e3 + t220 * t274 * t56 * t65 / 0.54e2 - 0.16e2 / 0.3e1 * t68 * t148 * t116 + t55 * t152 * t120 / 0.27e2 - t235 * t299 * t302 * t65 / 0.1296e4;
  t312 = my_piecewise3(t2, 0, -t6 * t80 * t157 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t307);
  tv2rhosigma0 = 0.2e1 * rho[0] * t312 + 0.2e1 * t161;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t319 = t104 * t54;
  t323 = 0.1e1 / t193;
  t335 = t323 * t41 * t212;
  t342 = t69 * t29;
  t343 = t33 * t65;
  t347 = 0.1e1 / t191;
  t348 = t347 * t28;
  t357 = 0.1e1 / t31 / t194;
  t362 = -t259 * t61 * params->alpha * t47 / 0.144e3 - t319 * t141 / 0.144e3 + t190 * sigma[0] * t323 * t196 * t47 / 0.576e3 + t201 * sigma[0] * t323 * params->alpha * t108 / 0.288e3 + t208 * sigma[0] * t335 / 0.288e3 - t220 * t323 * sigma[0] * t65 / 0.144e3 - t36 * t342 * t343 / 0.12e2 + 0.4e1 * t68 * t348 * t32 - t55 * t136 * t65 / 0.144e3 + t235 * t56 * t29 * t357 * t65 / 0.3456e4;
  t366 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t362);
  tv2sigma20 = 0.2e1 * rho[0] * t366;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t369 = t17 * t33;
  t379 = 0.1e1 / t300;
  t385 = 0.1e1 / t31 / t59;
  t390 = t196 * params->alpha;
  t391 = t390 * t189;
  t392 = t236 * sigma[0];
  t393 = t193 * t193;
  t395 = 0.1e1 / t18 / t393;
  t398 = t51 * t54;
  t400 = t398 * t28 * t65;
  t404 = 0.1e1 / t18 / t193;
  t405 = t404 * t65;
  t409 = t28 * t404;
  t413 = t193 * t59;
  t415 = 0.1e1 / t31 / t413;
  t416 = t236 * t415;
  t419 = t20 * t25;
  t420 = t29 * t41;
  t421 = t420 * t46;
  t422 = t419 * t421;
  t427 = t419 * t29;
  t428 = t108 * t427;
  t433 = t41 * t212;
  t434 = t433 * t427;
  t437 = 0.1e1 / t18;
  t441 = t415 * t65;
  t453 = t29 * t385;
  t454 = t453 * t47;
  t460 = t103 * t103;
  t461 = t460 * t189;
  t463 = t106 * t106;
  t464 = 0.1e1 / t463;
  t465 = t41 * t464;
  t466 = t465 * t427;
  t473 = t188 * t188;
  t474 = 0.1e1 / t473;
  t475 = t390 * t474;
  t476 = t236 * t56;
  t477 = t393 * t84;
  t478 = 0.1e1 / t477;
  t483 = -0.38e2 / 0.81e2 * t209 * t379 * t41 * t212 - 0.164e3 / 0.81e2 * t36 * t37 * t385 * t65 - 0.2e1 / 0.2187e4 * t391 * t392 * t395 * t400 + 0.209e3 / 0.243e3 * t55 * t57 * t405 + 0.341e3 / 0.486e3 * t105 * t409 * t108 + t190 * t416 * t390 * t422 / 0.729e3 + t201 * t416 * t196 * t428 / 0.243e3 + 0.2e1 / 0.243e3 * t208 * t416 * params->alpha * t434 + 0.16e3 / 0.27e2 * t68 * t70 * t437 - 0.19e2 / 0.486e3 * t235 * t237 * t441 - 0.19e2 / 0.81e2 * t192 * t379 * t196 * t47 - 0.38e2 / 0.81e2 * t202 * t379 * params->alpha * t108 - 0.154e3 / 0.81e2 * t27 * t454 + 0.341e3 / 0.486e3 * t93 * t409 * t99 + 0.2e1 / 0.243e3 * t461 * t416 * t466 + 0.44e2 / 0.81e2 * t220 * t191 * t379 * t65 + t475 * t476 * t478 * t65 / 0.2187e4;
  t488 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t369 * t74 + t6 * t165 * t124 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t80 * t245 - 0.3e1 / 0.8e1 * t6 * t19 * t483);
  tv3rho30 = 0.2e1 * rho[0] * t488 + 0.6e1 * t250;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t498 = t208 * t195;
  t499 = t433 * t56;
  t520 = 0.1e1 / t18 / t193 / t178;
  t525 = t191 * t240;
  t538 = t190 * t195;
  t540 = t196 * t56 * t47;
  t543 = t201 * t195;
  t545 = params->alpha * t56 * t108;
  t554 = t180 * params->alpha;
  t561 = t393 * t30;
  t562 = 0.1e1 / t561;
  t567 = 0.17e2 / 0.108e3 * t498 * t499 - t220 * t195 * t56 * t65 / 0.6e1 + 0.16e2 / 0.27e2 * t36 * t174 * t65 - 0.19e2 / 0.81e2 * t55 * t152 * t228 + 0.11e2 / 0.27e2 * t42 * t175 - 0.65e2 / 0.324e3 * t266 * t180 * t41 * t268 + t391 * t520 * t236 * t400 / 0.2916e4 - t190 * t525 * t390 * t422 / 0.1944e4 - t201 * t525 * t196 * t428 / 0.648e3 - t208 * t525 * params->alpha * t434 / 0.324e3 + 0.17e2 / 0.216e3 * t538 * t540 + 0.17e2 / 0.108e3 * t543 * t545 - 0.8e2 / 0.9e1 * t68 * t148 * t31 + 0.17e2 / 0.1296e4 * t235 * t299 * t241 - 0.65e2 / 0.324e3 * t259 * t554 * t262 - t461 * t525 * t466 / 0.324e3 - t475 * t392 * t562 * t65 / 0.5832e4;
  t572 = my_piecewise3(t2, 0, t6 * t165 * t157 / 0.12e2 - t6 * t80 * t307 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t567);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t572 + 0.4e1 * t312;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t579 = t433 * sigma[0];
  t591 = t193 * t94;
  t593 = 0.1e1 / t18 / t591;
  t598 = t56 * t302;
  t617 = t29 * t302;
  t618 = t56 * t65;
  t622 = t190 * t274;
  t624 = t196 * sigma[0] * t47;
  t627 = t201 * t274;
  t628 = t98 * t268;
  t637 = t393 * rho[0];
  t638 = 0.1e1 / t637;
  t643 = -0.5e1 / 0.108e3 * t208 * t274 * t579 + t220 * t274 * sigma[0] * t65 / 0.27e2 - 0.2e1 / 0.9e1 * t36 * t342 * t112 + t319 * t109 / 0.27e2 - t391 * t593 * t191 * t400 / 0.7776e4 + t190 * t598 * t390 * t422 / 0.5184e4 + t201 * t598 * t196 * t428 / 0.1728e4 + t208 * t598 * params->alpha * t434 / 0.864e3 + 0.32e2 / 0.3e1 * t68 * t348 * t116 + t55 * t97 * t65 / 0.27e2 - 0.5e1 / 0.1296e4 * t235 * t617 * t618 - 0.5e1 / 0.216e3 * t622 * t624 - 0.5e1 / 0.108e3 * t627 * t628 + t259 * t260 * t47 / 0.27e2 + t461 * t598 * t466 / 0.864e3 + t475 * t236 * t638 * t65 / 0.15552e5;
  t648 = my_piecewise3(t2, 0, -t6 * t80 * t362 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t643);
  tv3rhosigma20 = 0.2e1 * rho[0] * t648 + 0.2e1 * t366;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t653 = t196 * t41 * t46;
  t657 = t98 * t107;
  t662 = sigma[0] * t357;
  t679 = 0.1e1 / t18 / t413;
  t684 = t147 * t29;
  t689 = 0.1e1 / t236 * t28;
  t693 = t29 * t357;
  t694 = sigma[0] * t65;
  t698 = 0.1e1 / t393;
  t703 = t190 * t323 * t653 / 0.192e3 + t201 * t323 * t657 / 0.96e2 + t208 * t335 / 0.96e2 - t190 * t662 * t390 * t422 / 0.13824e5 - t201 * t662 * t196 * t428 / 0.4608e4 - t208 * t662 * params->alpha * t434 / 0.2304e4 - t461 * t662 * t466 / 0.2304e4 + t391 * t679 * t56 * t400 / 0.20736e5 + t36 * t684 * t343 / 0.4e1 - 0.12e2 * t68 * t689 * t32 + t235 * t693 * t694 / 0.1152e4 - t475 * t191 * t698 * t65 / 0.41472e5;
  t707 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t703);
  tv3sigma30 = 0.2e1 * rho[0] * t707;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t36, t37, t38, t41;
  double t42, t45, t46, t47, t48, t51, t54, t55;
  double t56, t57, t58, t59, t61, t65, t68, t69;
  double t70, t74, t78, tzk0;

  double t80, t84, t86, t88, t91, t92, t93, t94;
  double t96, t97, t98, t99, t103, t104, t105, t106;
  double t107, t108, t109, t112, t116, t120, t124, t129;
  double tvrho0, t134, t136, t141, t147, t148, t152, t157;
  double t161, tvsigma0;

  double t165, t173, t174, t175, t178, t180, t181, t185;
  double t188, t189, t190, t191, t192, t193, t194, t195;
  double t196, t201, t202, t208, t209, t212, t216, t220;
  double t228, t234, t235, t236, t237, t238, t240, t241;
  double t245, t250, tv2rho20, t258, t259, t260, t262, t266;
  double t268, t273, t274, t286, t299, t300, t302, t307;
  double t312, tv2rhosigma0, t319, t323, t335, t342, t343, t347;
  double t348, t357, t362, t366, tv2sigma20;

  double t369, t379, t385, t390, t391, t392, t393, t395;
  double t398, t400, t404, t405, t409, t413, t415, t416;
  double t419, t420, t421, t422, t427, t428, t433, t434;
  double t437, t441, t453, t454, t460, t461, t463, t464;
  double t465, t466, t473, t474, t475, t476, t477, t478;
  double t483, t488, tv3rho30, t498, t499, t520, t525, t538;
  double t540, t543, t545, t554, t561, t562, t567, t572;
  double tv3rho2sigma0, t579, t591, t593, t598, t617, t618, t622;
  double t624, t627, t628, t637, t638, t643, t648, tv3rhosigma20;
  double t653, t657, t662, t679, t684, t689, t693, t694;
  double t698, t703, t707, tv3sigma30;

  double t723, t728, t729, t730, t739, t740, t745, t754;
  double t757, t762, t763, t767, t768, t779, t793, t807;
  double t808, t809, t816, t825, t834, t836, t842, t847;
  double t858, t864, tv4rho40, t884, t897, t928, t960, t968;
  double t977, t983, tv4rho3sigma0, t1006, t1037, t1075, t1084, t1090;
  double tv4rho2sigma20, t1129, t1130, t1134, t1180, t1185, tv4rhosigma30, t1225;
  double t1260, t1264, tv4sigma40;

  gga_x_vmt84_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt84_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->mu * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t25 * sigma[0];
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t32 = t31 * t30;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t36 = params->alpha * t20 * t25;
  t37 = sigma[0] * t29;
  t38 = t37 * t33;
  t41 = exp(-t36 * t38 / 0.24e2);
  t42 = t21 * t25;
  t45 = 0.1e1 + t42 * t38 / 0.24e2;
  t46 = 0.1e1 / t45;
  t47 = t41 * t46;
  t48 = t34 * t47;
  t51 = t20 * t20;
  t54 = 0.1e1 / t23 / t22;
  t55 = params->alpha * t51 * t54;
  t56 = sigma[0] * sigma[0];
  t57 = t56 * t28;
  t58 = t30 * t30;
  t59 = t58 * rho[0];
  t61 = 0.1e1 / t18 / t59;
  t65 = exp(-t55 * t57 * t61 / 0.288e3);
  t68 = (0.1e1 - t65) * t51 * t24;
  t69 = 0.1e1 / sigma[0];
  t70 = t69 * t28;
  t74 = t27 * t48 / 0.24e2 + 0.2e1 * t68 * t70 * t32 + t65;
  t78 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t74);
  tzk0 = 0.2e1 * t78;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t80 = t17 / t31;
  t84 = t30 * rho[0];
  t86 = 0.1e1 / t31 / t84;
  t88 = t29 * t86 * t47;
  t91 = params->mu * t51;
  t92 = t54 * t56;
  t93 = t91 * t92;
  t94 = t58 * t30;
  t96 = 0.1e1 / t18 / t94;
  t97 = t28 * t96;
  t98 = params->alpha * t41;
  t99 = t98 * t46;
  t103 = params->mu * params->mu;
  t104 = t103 * t51;
  t105 = t104 * t92;
  t106 = t45 * t45;
  t107 = 0.1e1 / t106;
  t108 = t41 * t107;
  t109 = t97 * t108;
  t112 = t86 * t65;
  t116 = t31 * rho[0];
  t120 = t96 * t65;
  t124 = -t27 * t88 / 0.9e1 + t93 * t97 * t99 / 0.108e3 + t105 * t109 / 0.108e3 - 0.2e1 / 0.9e1 * t36 * t37 * t112 + 0.16e2 / 0.3e1 * t68 * t70 * t116 + t55 * t57 * t120 / 0.54e2;
  t129 = my_piecewise3(t2, 0, -t6 * t80 * t74 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t124);
  tvrho0 = 0.2e1 * rho[0] * t129 + 0.2e1 * t78;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t134 = t54 * sigma[0];
  t136 = t28 * t61;
  t141 = t136 * t108;
  t147 = 0.1e1 / t56;
  t148 = t147 * t28;
  t152 = sigma[0] * t28;
  t157 = t42 * t48 / 0.24e2 - t91 * t134 * t136 * t99 / 0.288e3 - t104 * t134 * t141 / 0.288e3 + t36 * t34 * t65 / 0.12e2 - 0.2e1 * t68 * t148 * t32 - t55 * t152 * t61 * t65 / 0.144e3;
  t161 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t157);
  tvsigma0 = 0.2e1 * rho[0] * t161;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t165 = t17 / t116;
  t173 = 0.1e1 / t31 / t58;
  t174 = t29 * t173;
  t175 = t174 * t47;
  t178 = t58 * t84;
  t180 = 0.1e1 / t18 / t178;
  t181 = t28 * t180;
  t185 = t181 * t108;
  t188 = t22 * t22;
  t189 = 0.1e1 / t188;
  t190 = params->mu * t189;
  t191 = t56 * sigma[0];
  t192 = t190 * t191;
  t193 = t58 * t58;
  t194 = t193 * t30;
  t195 = 0.1e1 / t194;
  t196 = params->alpha * params->alpha;
  t201 = t103 * t189;
  t202 = t201 * t191;
  t208 = t103 * params->mu * t189;
  t209 = t208 * t191;
  t212 = 0.1e1 / t106 / t45;
  t216 = t173 * t65;
  t220 = t196 * t189;
  t228 = t180 * t65;
  t234 = 0.1e1 / t24 / t188;
  t235 = t196 * t20 * t234;
  t236 = t56 * t56;
  t237 = t236 * t29;
  t238 = t193 * t58;
  t240 = 0.1e1 / t31 / t238;
  t241 = t240 * t65;
  t245 = 0.11e2 / 0.27e2 * t27 * t175 - t93 * t181 * t99 / 0.12e2 - t105 * t185 / 0.12e2 + t192 * t195 * t196 * t47 / 0.81e2 + 0.2e1 / 0.81e2 * t202 * t195 * params->alpha * t108 + 0.2e1 / 0.81e2 * t209 * t195 * t41 * t212 + 0.2e1 / 0.9e1 * t36 * t37 * t216 - 0.4e1 / 0.81e2 * t220 * t191 * t195 * t65 + 0.8e2 / 0.9e1 * t68 * t70 * t31 - 0.19e2 / 0.162e3 * t55 * t57 * t228 + t235 * t237 * t241 / 0.486e3;
  t250 = my_piecewise3(t2, 0, t6 * t165 * t74 / 0.12e2 - t6 * t80 * t124 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t245);
  tv2rho20 = 0.2e1 * rho[0] * t250 + 0.4e1 * t129;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t258 = t54 * t28;
  t259 = t91 * t258;
  t260 = t96 * params->alpha;
  t262 = sigma[0] * t41 * t46;
  t266 = t104 * t258;
  t268 = t107 * sigma[0];
  t273 = t193 * rho[0];
  t274 = 0.1e1 / t273;
  t286 = t274 * t41 * t212;
  t299 = t191 * t29;
  t300 = t193 * t84;
  t302 = 0.1e1 / t31 / t300;
  t307 = -t42 * t88 / 0.9e1 + t259 * t260 * t262 / 0.36e2 + t266 * t96 * t41 * t268 / 0.36e2 - t190 * t56 * t274 * t196 * t47 / 0.216e3 - t201 * t56 * t274 * params->alpha * t108 / 0.108e3 - t208 * t56 * t286 / 0.108e3 + t220 * t274 * t56 * t65 / 0.54e2 - 0.16e2 / 0.3e1 * t68 * t148 * t116 + t55 * t152 * t120 / 0.27e2 - t235 * t299 * t302 * t65 / 0.1296e4;
  t312 = my_piecewise3(t2, 0, -t6 * t80 * t157 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t307);
  tv2rhosigma0 = 0.2e1 * rho[0] * t312 + 0.2e1 * t161;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t319 = t104 * t54;
  t323 = 0.1e1 / t193;
  t335 = t323 * t41 * t212;
  t342 = t69 * t29;
  t343 = t33 * t65;
  t347 = 0.1e1 / t191;
  t348 = t347 * t28;
  t357 = 0.1e1 / t31 / t194;
  t362 = -t259 * t61 * params->alpha * t47 / 0.144e3 - t319 * t141 / 0.144e3 + t190 * sigma[0] * t323 * t196 * t47 / 0.576e3 + t201 * sigma[0] * t323 * params->alpha * t108 / 0.288e3 + t208 * sigma[0] * t335 / 0.288e3 - t220 * t323 * sigma[0] * t65 / 0.144e3 - t36 * t342 * t343 / 0.12e2 + 0.4e1 * t68 * t348 * t32 - t55 * t136 * t65 / 0.144e3 + t235 * t56 * t29 * t357 * t65 / 0.3456e4;
  t366 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t362);
  tv2sigma20 = 0.2e1 * rho[0] * t366;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t369 = t17 * t33;
  t379 = 0.1e1 / t300;
  t385 = 0.1e1 / t31 / t59;
  t390 = t196 * params->alpha;
  t391 = t390 * t189;
  t392 = t236 * sigma[0];
  t393 = t193 * t193;
  t395 = 0.1e1 / t18 / t393;
  t398 = t51 * t54;
  t400 = t398 * t28 * t65;
  t404 = 0.1e1 / t18 / t193;
  t405 = t404 * t65;
  t409 = t28 * t404;
  t413 = t193 * t59;
  t415 = 0.1e1 / t31 / t413;
  t416 = t236 * t415;
  t419 = t20 * t25;
  t420 = t29 * t41;
  t421 = t420 * t46;
  t422 = t419 * t421;
  t427 = t419 * t29;
  t428 = t108 * t427;
  t433 = t41 * t212;
  t434 = t433 * t427;
  t437 = 0.1e1 / t18;
  t441 = t415 * t65;
  t453 = t29 * t385;
  t454 = t453 * t47;
  t460 = t103 * t103;
  t461 = t460 * t189;
  t463 = t106 * t106;
  t464 = 0.1e1 / t463;
  t465 = t41 * t464;
  t466 = t465 * t427;
  t473 = t188 * t188;
  t474 = 0.1e1 / t473;
  t475 = t390 * t474;
  t476 = t236 * t56;
  t477 = t393 * t84;
  t478 = 0.1e1 / t477;
  t483 = -0.38e2 / 0.81e2 * t209 * t379 * t41 * t212 - 0.164e3 / 0.81e2 * t36 * t37 * t385 * t65 - 0.2e1 / 0.2187e4 * t391 * t392 * t395 * t400 + 0.209e3 / 0.243e3 * t55 * t57 * t405 + 0.341e3 / 0.486e3 * t105 * t409 * t108 + t190 * t416 * t390 * t422 / 0.729e3 + t201 * t416 * t196 * t428 / 0.243e3 + 0.2e1 / 0.243e3 * t208 * t416 * params->alpha * t434 + 0.16e3 / 0.27e2 * t68 * t70 * t437 - 0.19e2 / 0.486e3 * t235 * t237 * t441 - 0.19e2 / 0.81e2 * t192 * t379 * t196 * t47 - 0.38e2 / 0.81e2 * t202 * t379 * params->alpha * t108 - 0.154e3 / 0.81e2 * t27 * t454 + 0.341e3 / 0.486e3 * t93 * t409 * t99 + 0.2e1 / 0.243e3 * t461 * t416 * t466 + 0.44e2 / 0.81e2 * t220 * t191 * t379 * t65 + t475 * t476 * t478 * t65 / 0.2187e4;
  t488 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t369 * t74 + t6 * t165 * t124 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t80 * t245 - 0.3e1 / 0.8e1 * t6 * t19 * t483);
  tv3rho30 = 0.2e1 * rho[0] * t488 + 0.6e1 * t250;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t498 = t208 * t195;
  t499 = t433 * t56;
  t520 = 0.1e1 / t18 / t193 / t178;
  t525 = t191 * t240;
  t538 = t190 * t195;
  t540 = t196 * t56 * t47;
  t543 = t201 * t195;
  t545 = params->alpha * t56 * t108;
  t554 = t180 * params->alpha;
  t561 = t393 * t30;
  t562 = 0.1e1 / t561;
  t567 = 0.17e2 / 0.108e3 * t498 * t499 - t220 * t195 * t56 * t65 / 0.6e1 + 0.16e2 / 0.27e2 * t36 * t174 * t65 - 0.19e2 / 0.81e2 * t55 * t152 * t228 + 0.11e2 / 0.27e2 * t42 * t175 - 0.65e2 / 0.324e3 * t266 * t180 * t41 * t268 + t391 * t520 * t236 * t400 / 0.2916e4 - t190 * t525 * t390 * t422 / 0.1944e4 - t201 * t525 * t196 * t428 / 0.648e3 - t208 * t525 * params->alpha * t434 / 0.324e3 + 0.17e2 / 0.216e3 * t538 * t540 + 0.17e2 / 0.108e3 * t543 * t545 - 0.8e2 / 0.9e1 * t68 * t148 * t31 + 0.17e2 / 0.1296e4 * t235 * t299 * t241 - 0.65e2 / 0.324e3 * t259 * t554 * t262 - t461 * t525 * t466 / 0.324e3 - t475 * t392 * t562 * t65 / 0.5832e4;
  t572 = my_piecewise3(t2, 0, t6 * t165 * t157 / 0.12e2 - t6 * t80 * t307 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t567);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t572 + 0.4e1 * t312;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t579 = t433 * sigma[0];
  t591 = t193 * t94;
  t593 = 0.1e1 / t18 / t591;
  t598 = t56 * t302;
  t617 = t29 * t302;
  t618 = t56 * t65;
  t622 = t190 * t274;
  t624 = t196 * sigma[0] * t47;
  t627 = t201 * t274;
  t628 = t98 * t268;
  t637 = t393 * rho[0];
  t638 = 0.1e1 / t637;
  t643 = -0.5e1 / 0.108e3 * t208 * t274 * t579 + t220 * t274 * sigma[0] * t65 / 0.27e2 - 0.2e1 / 0.9e1 * t36 * t342 * t112 + t319 * t109 / 0.27e2 - t391 * t593 * t191 * t400 / 0.7776e4 + t190 * t598 * t390 * t422 / 0.5184e4 + t201 * t598 * t196 * t428 / 0.1728e4 + t208 * t598 * params->alpha * t434 / 0.864e3 + 0.32e2 / 0.3e1 * t68 * t348 * t116 + t55 * t97 * t65 / 0.27e2 - 0.5e1 / 0.1296e4 * t235 * t617 * t618 - 0.5e1 / 0.216e3 * t622 * t624 - 0.5e1 / 0.108e3 * t627 * t628 + t259 * t260 * t47 / 0.27e2 + t461 * t598 * t466 / 0.864e3 + t475 * t236 * t638 * t65 / 0.15552e5;
  t648 = my_piecewise3(t2, 0, -t6 * t80 * t362 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t643);
  tv3rhosigma20 = 0.2e1 * rho[0] * t648 + 0.2e1 * t366;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t653 = t196 * t41 * t46;
  t657 = t98 * t107;
  t662 = sigma[0] * t357;
  t679 = 0.1e1 / t18 / t413;
  t684 = t147 * t29;
  t689 = 0.1e1 / t236 * t28;
  t693 = t29 * t357;
  t694 = sigma[0] * t65;
  t698 = 0.1e1 / t393;
  t703 = t190 * t323 * t653 / 0.192e3 + t201 * t323 * t657 / 0.96e2 + t208 * t335 / 0.96e2 - t190 * t662 * t390 * t422 / 0.13824e5 - t201 * t662 * t196 * t428 / 0.4608e4 - t208 * t662 * params->alpha * t434 / 0.2304e4 - t461 * t662 * t466 / 0.2304e4 + t391 * t679 * t56 * t400 / 0.20736e5 + t36 * t684 * t343 / 0.4e1 - 0.12e2 * t68 * t689 * t32 + t235 * t693 * t694 / 0.1152e4 - t475 * t191 * t698 * t65 / 0.41472e5;
  t707 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t703);
  tv3sigma30 = 0.2e1 * rho[0] * t707;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t723 = 0.1e1 / t238;
  t728 = t196 * t196;
  t729 = t728 * t474;
  t730 = t236 * t236;
  t739 = 0.1e1 / t18 / t273;
  t740 = t28 * t739;
  t745 = 0.1e1 / t31 / t94;
  t754 = t460 * params->mu * t189;
  t757 = t392 / t18 / t637;
  t762 = t398 * t28;
  t763 = t41 / t463 / t45 * t762;
  t767 = 0.1e1 / t31 / t591;
  t768 = t236 * t767;
  t779 = t393 * t58;
  t793 = 0.2563e4 / 0.729e3 * t192 * t723 * t196 * t47 + t729 * t730 / t18 / t393 / t273 * t400 / 0.118098e6 - 0.3047e4 / 0.486e3 * t105 * t740 * t108 + 0.2618e4 / 0.243e3 * t27 * t29 * t745 * t47 - 0.3047e4 / 0.486e3 * t93 * t740 * t99 + 0.16e2 / 0.2187e4 * t754 * t757 * t763 - 0.196e3 / 0.729e3 * t461 * t768 * t466 + 0.164e3 / 0.6561e4 * t391 * t757 * t400 - 0.4684e4 / 0.729e3 * t220 * t191 * t723 * t65 - 0.38e2 / 0.2187e4 * t475 * t476 / t779 * t65 + 0.5126e4 / 0.729e3 * t209 * t723 * t41 * t212 + 0.2755e4 / 0.4374e4 * t235 * t237 * t767 * t65;
  t807 = t728 * t189;
  t808 = t236 * t191;
  t809 = t393 * t94;
  t816 = t20 * t234 * t29 * t65;
  t825 = t465 * t762;
  t834 = t28 * t41;
  t836 = t398 * t834 * t46;
  t842 = t398 * t834 * t107;
  t847 = t433 * t762;
  t858 = 0.5126e4 / 0.729e3 * t202 * t723 * params->alpha * t108 - 0.16e3 / 0.81e2 * t68 * t70 / t18 / rho[0] + 0.292e3 / 0.27e2 * t36 * t37 * t745 * t65 - 0.2e1 / 0.19683e5 * t807 * t808 / t31 / t809 * t816 - 0.5225e4 / 0.729e3 * t55 * t57 * t739 * t65 + 0.16e2 / 0.2187e4 * t461 * t757 * params->alpha * t825 - 0.196e3 / 0.729e3 * t208 * t768 * params->alpha * t434 + 0.2e1 / 0.6561e4 * t190 * t757 * t728 * t836 + 0.8e1 / 0.6561e4 * t201 * t757 * t390 * t842 + 0.8e1 / 0.2187e4 * t208 * t757 * t196 * t847 - 0.98e2 / 0.729e3 * t201 * t768 * t196 * t428 - 0.98e2 / 0.2187e4 * t190 * t768 * t390 * t422;
  t864 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t86 * t74 - 0.5e1 / 0.9e1 * t6 * t369 * t124 + t6 * t165 * t245 / 0.2e1 - t6 * t80 * t483 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t793 + t858));
  tv4rho40 = 0.2e1 * rho[0] * t864 + 0.8e1 * t488;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t884 = t395 * t236;
  t897 = t393 * t59;
  t928 = -t729 * t808 / t18 / t393 / t193 * t400 / 0.314928e6 - 0.73e2 / 0.8748e4 * t391 * t884 * t400 + 0.418e3 / 0.243e3 * t55 * t152 * t405 - 0.154e3 / 0.81e2 * t42 * t454 + 0.253e3 / 0.162e3 * t266 * t404 * t41 * t268 + t807 / t31 / t897 * t476 * t816 / 0.26244e5 - 0.1025e4 / 0.972e3 * t190 * t379 * t540 - 0.2e1 / 0.729e3 * t754 * t884 * t763 + 0.89e2 / 0.972e3 * t461 * t415 * t41 * t464 * t191 * t427 + 0.253e3 / 0.162e3 * t259 * t404 * params->alpha * t262 + 0.437e3 / 0.243e3 * t220 * t379 * t56 * t65 + 0.35e2 / 0.5832e4 * t475 * t392 * t478 * t65;
  t960 = t420 * t212;
  t968 = t191 * t415;
  t977 = -0.16e2 / 0.9e1 * t36 * t453 * t65 - 0.1121e4 / 0.5832e4 * t235 * t299 * t441 - 0.1025e4 / 0.486e3 * t201 * t379 * t545 - 0.16e3 / 0.27e2 * t68 * t148 * t437 - 0.1025e4 / 0.486e3 * t208 * t379 * t499 - t201 * t884 * t390 * t842 / 0.2187e4 - t208 * t884 * t196 * t847 / 0.729e3 - 0.2e1 / 0.729e3 * t461 * t884 * params->alpha * t825 + 0.89e2 / 0.972e3 * t208 * t415 * params->alpha * t20 * t25 * t191 * t960 - t190 * t884 * t728 * t836 / 0.8748e4 + 0.89e2 / 0.1944e4 * t201 * t968 * t196 * t428 + 0.89e2 / 0.5832e4 * t190 * t968 * t390 * t422;
  t983 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t369 * t157 + t6 * t165 * t307 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t80 * t567 - 0.3e1 / 0.8e1 * t6 * t19 * (t928 + t977));
  tv4rho3sigma0 = 0.2e1 * rho[0] * t983 + 0.6e1 * t572;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1006 = t520 * t191;
  t1037 = -0.31e2 / 0.81e2 * t220 * t195 * sigma[0] * t65 + 0.167e3 / 0.648e3 * t538 * t624 + t729 * t476 / t18 / t393 / t178 * t400 / 0.839808e6 + 0.59e2 / 0.23328e5 * t391 * t1006 * t400 - 0.1e2 / 0.27e2 * t36 * t342 * t216 - 0.19e2 / 0.81e2 * t319 * t185 - t807 / t31 / t779 * t392 * t816 / 0.69984e5 - 0.19e2 / 0.81e2 * t259 * t554 * t47 + t754 * t1006 * t763 / 0.972e3 - 0.25e2 / 0.864e3 * t461 * t240 * t41 * t464 * t56 * t427 - 0.91e2 / 0.46656e5 * t475 * t562 * t236 * t65;
  t1075 = t56 * t240;
  t1084 = -0.19e2 / 0.81e2 * t55 * t181 * t65 + 0.191e3 / 0.3888e4 * t235 * t29 * t240 * t618 + 0.167e3 / 0.324e3 * t498 * t579 + 0.167e3 / 0.324e3 * t543 * t628 + 0.16e3 / 0.9e1 * t68 * t348 * t31 - 0.25e2 / 0.864e3 * t208 * t240 * params->alpha * t20 * t25 * t56 * t960 + t190 * t1006 * t728 * t836 / 0.23328e5 + t201 * t1006 * t390 * t842 / 0.5832e4 + t208 * t1006 * t196 * t847 / 0.1944e4 + t461 * t1006 * params->alpha * t825 / 0.972e3 - 0.25e2 / 0.5184e4 * t190 * t1075 * t390 * t422 - 0.25e2 / 0.1728e4 * t201 * t1075 * t196 * t428;
  t1090 = my_piecewise3(t2, 0, t6 * t165 * t362 / 0.12e2 - t6 * t80 * t643 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t1037 + t1084));
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1090 + 0.4e1 * t648;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1129 = t464 * t20;
  t1130 = t26 * t29;
  t1134 = t56 * t593;
  t1180 = t475 * t638 * t191 * t65 / 0.1728e4 - t208 * t286 / 0.12e2 - t627 * t657 / 0.12e2 - 0.32e2 * t68 * t689 * t116 - t622 * t653 / 0.24e2 - t235 * t617 * t694 / 0.108e3 - t729 * t392 / t18 / t809 * t400 / 0.2239488e7 + t807 / t31 / t477 * t236 * t816 / 0.186624e6 + 0.2e1 / 0.3e1 * t36 * t684 * t112 + 0.7e1 / 0.864e3 * t461 * t302 * t41 * t1129 * t1130 - t754 * t1134 * t763 / 0.2592e4 - 0.5e1 / 0.7776e4 * t391 * t1134 * t400 - t461 * t1134 * params->alpha * t825 / 0.2592e4 + 0.7e1 / 0.5184e4 * t190 * t302 * t390 * t20 * t26 * t421 + 0.7e1 / 0.1728e4 * t201 * t302 * t196 * t41 * t107 * t20 * t1130 + 0.7e1 / 0.864e3 * t208 * t302 * params->alpha * t41 * t212 * t20 * t1130 - t190 * t1134 * t728 * t836 / 0.62208e5 - t201 * t1134 * t390 * t842 / 0.15552e5 - t208 * t1134 * t196 * t847 / 0.5184e4 + t220 * t274 * t65 / 0.18e2;
  t1185 = my_piecewise3(t2, 0, -t6 * t80 * t703 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t1180);
  tv4rhosigma30 = 0.2e1 * rho[0] * t1185 + 0.2e1 * t707;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1225 = t679 * sigma[0];
  t1260 = t729 * t236 / t18 / t897 * t400 / 0.5971968e7 - t220 * t69 * t323 * t65 / 0.48e2 - t475 * t698 * t56 * t65 / 0.6912e4 + t235 * t693 * t65 / 0.1152e4 + 0.48e2 * t68 / t392 * t28 * t32 - t461 * t357 * t41 * t1129 * t25 * t29 / 0.576e3 - t807 / t31 / t561 * t191 * t816 / 0.497664e6 - t36 * t347 * t29 * t343 + t391 * t1225 * t400 / 0.10368e5 - t190 * t357 * t390 * t422 / 0.3456e4 - t201 * t357 * t196 * t428 / 0.1152e4 - t208 * t357 * params->alpha * t434 / 0.576e3 + t754 * t1225 * t763 / 0.6912e4 + t190 * t1225 * t728 * t836 / 0.165888e6 + t201 * t1225 * t390 * t842 / 0.41472e5 + t208 * t1225 * t196 * t847 / 0.13824e5 + t461 * t1225 * params->alpha * t825 / 0.6912e4;
  t1264 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t1260);
  tv4sigma40 = 0.2e1 * rho[0] * t1264;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t41, t42, t43, t46, t49, t50, t51;
  double t55, t56, t58, t59, t60, t61, t62, t64;
  double t68, t70, t71, t72, t76, t80, t81, t82;
  double t83, t84, t85, t87, t88, t89, t90, t91;
  double t92, t93, t95, t96, t99, t102, t103, t104;
  double t108, t109, t110, t111, t113, t117, t119, t120;
  double t121, t125, t129, tzk0;

  gga_x_vmt84_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt84_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->mu * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t38 = t37 * t35;
  t39 = 0.1e1 / t38;
  t41 = params->alpha * t28;
  t42 = t33 * sigma[0];
  t43 = t42 * t39;
  t46 = exp(-t41 * t43 / 0.24e2);
  t49 = 0.1e1 + t29 * t43 / 0.24e2;
  t50 = 0.1e1 / t49;
  t51 = t46 * t50;
  t55 = t28 * t28;
  t56 = params->alpha * t55;
  t58 = 0.1e1 / t31 / t30;
  t59 = sigma[0] * sigma[0];
  t60 = t58 * t59;
  t61 = t35 * t35;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t36 / t62;
  t68 = exp(-t56 * t60 * t64 / 0.576e3);
  t70 = (0.1e1 - t68) * t55;
  t71 = 0.1e1 / sigma[0];
  t72 = t32 * t71;
  t76 = t34 * sigma[0] * t39 * t51 / 0.24e2 + 0.4e1 * t70 * t72 * t38 + t68;
  t80 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t76);
  t81 = rho[1] <= p->dens_threshold;
  t82 = my_piecewise5(t14, t11, t10, t15, -t17);
  t83 = 0.1e1 + t82;
  t84 = t83 <= p->zeta_threshold;
  t85 = POW_1_3(t83);
  t87 = my_piecewise3(t84, t22, t85 * t83);
  t88 = t87 * t26;
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t92 = t91 * t89;
  t93 = 0.1e1 / t92;
  t95 = t33 * sigma[2];
  t96 = t95 * t93;
  t99 = exp(-t41 * t96 / 0.24e2);
  t102 = 0.1e1 + t29 * t96 / 0.24e2;
  t103 = 0.1e1 / t102;
  t104 = t99 * t103;
  t108 = sigma[2] * sigma[2];
  t109 = t58 * t108;
  t110 = t89 * t89;
  t111 = t110 * rho[1];
  t113 = 0.1e1 / t90 / t111;
  t117 = exp(-t56 * t109 * t113 / 0.576e3);
  t119 = (0.1e1 - t117) * t55;
  t120 = 0.1e1 / sigma[2];
  t121 = t32 * t120;
  t125 = t34 * sigma[2] * t93 * t104 / 0.24e2 + 0.4e1 * t119 * t121 * t92 + t117;
  t129 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t125);
  tzk0 = t80 + t129;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t41, t42, t43, t46, t49, t50, t51;
  double t55, t56, t58, t59, t60, t61, t62, t64;
  double t68, t70, t71, t72, t76, t80, t81, t82;
  double t83, t84, t85, t87, t88, t89, t90, t91;
  double t92, t93, t95, t96, t99, t102, t103, t104;
  double t108, t109, t110, t111, t113, t117, t119, t120;
  double t121, t125, t129, tzk0;

  double t130, t131, t132, t133, t134, t137, t138, t142;
  double t143, t144, t147, t148, t150, t151, t155, t156;
  double t157, t159, t161, t164, t166, t167, t168, t169;
  double t170, t174, t178, t182, t186, t191, t193, t196;
  double t197, t201, t204, t206, tvrho0, t209, t210, t213;
  double t214, t219, t221, t224, t225, t229, t231, t232;
  double t236, t237, t239, t241, t244, t245, t246, t247;
  double t254, t261, t266, tvrho1, t276, t279, t287, t288;
  double t295, t299, tvsigma0, tvsigma1, t307, t310, t318, t319;
  double t326, t330, tvsigma2;

  gga_x_vmt84_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt84_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->mu * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t38 = t37 * t35;
  t39 = 0.1e1 / t38;
  t41 = params->alpha * t28;
  t42 = t33 * sigma[0];
  t43 = t42 * t39;
  t46 = exp(-t41 * t43 / 0.24e2);
  t49 = 0.1e1 + t29 * t43 / 0.24e2;
  t50 = 0.1e1 / t49;
  t51 = t46 * t50;
  t55 = t28 * t28;
  t56 = params->alpha * t55;
  t58 = 0.1e1 / t31 / t30;
  t59 = sigma[0] * sigma[0];
  t60 = t58 * t59;
  t61 = t35 * t35;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t36 / t62;
  t68 = exp(-t56 * t60 * t64 / 0.576e3);
  t70 = (0.1e1 - t68) * t55;
  t71 = 0.1e1 / sigma[0];
  t72 = t32 * t71;
  t76 = t34 * sigma[0] * t39 * t51 / 0.24e2 + 0.4e1 * t70 * t72 * t38 + t68;
  t80 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t76);
  t81 = rho[1] <= p->dens_threshold;
  t82 = my_piecewise5(t14, t11, t10, t15, -t17);
  t83 = 0.1e1 + t82;
  t84 = t83 <= p->zeta_threshold;
  t85 = POW_1_3(t83);
  t87 = my_piecewise3(t84, t22, t85 * t83);
  t88 = t87 * t26;
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t92 = t91 * t89;
  t93 = 0.1e1 / t92;
  t95 = t33 * sigma[2];
  t96 = t95 * t93;
  t99 = exp(-t41 * t96 / 0.24e2);
  t102 = 0.1e1 + t29 * t96 / 0.24e2;
  t103 = 0.1e1 / t102;
  t104 = t99 * t103;
  t108 = sigma[2] * sigma[2];
  t109 = t58 * t108;
  t110 = t89 * t89;
  t111 = t110 * rho[1];
  t113 = 0.1e1 / t90 / t111;
  t117 = exp(-t56 * t109 * t113 / 0.576e3);
  t119 = (0.1e1 - t117) * t55;
  t120 = 0.1e1 / sigma[2];
  t121 = t32 * t120;
  t125 = t34 * sigma[2] * t93 * t104 / 0.24e2 + 0.4e1 * t119 * t121 * t92 + t117;
  t129 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t125);
  tzk0 = t80 + t129;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t130 = t6 * t6;
  t131 = 0.1e1 / t130;
  t132 = t16 * t131;
  t133 = t7 - t132;
  t134 = my_piecewise5(t10, 0, t14, 0, t133);
  t137 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t134);
  t138 = t137 * t26;
  t142 = t26 * t26;
  t143 = 0.1e1 / t142;
  t144 = t25 * t143;
  t147 = t5 * t144 * t76 / 0.8e1;
  t148 = t35 * rho[0];
  t150 = 0.1e1 / t37 / t148;
  t151 = sigma[0] * t150;
  t155 = params->mu * t55;
  t156 = t155 * t60;
  t157 = t61 * t35;
  t159 = 0.1e1 / t36 / t157;
  t161 = t159 * params->alpha * t51;
  t164 = params->mu * params->mu;
  t166 = t164 * t55 * t58;
  t167 = t59 * t159;
  t168 = t49 * t49;
  t169 = 0.1e1 / t168;
  t170 = t46 * t169;
  t174 = t41 * t33;
  t178 = t37 * rho[0];
  t182 = t56 * t58;
  t186 = -t34 * t151 * t51 / 0.9e1 + t156 * t161 / 0.216e3 + t166 * t167 * t170 / 0.216e3 - 0.2e1 / 0.9e1 * t174 * t151 * t68 + 0.32e2 / 0.3e1 * t70 * t72 * t178 + t182 * t167 * t68 / 0.108e3;
  t191 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t76 - t147 - 0.3e1 / 0.8e1 * t5 * t27 * t186);
  t193 = my_piecewise5(t14, 0, t10, 0, -t133);
  t196 = my_piecewise3(t84, 0, 0.4e1 / 0.3e1 * t85 * t193);
  t197 = t196 * t26;
  t201 = t87 * t143;
  t204 = t5 * t201 * t125 / 0.8e1;
  t206 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t197 * t125 - t204);
  tvrho0 = t80 + t129 + t6 * (t191 + t206);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t209 = -t7 - t132;
  t210 = my_piecewise5(t10, 0, t14, 0, t209);
  t213 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t210);
  t214 = t213 * t26;
  t219 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t214 * t76 - t147);
  t221 = my_piecewise5(t14, 0, t10, 0, -t209);
  t224 = my_piecewise3(t84, 0, 0.4e1 / 0.3e1 * t85 * t221);
  t225 = t224 * t26;
  t229 = t89 * rho[1];
  t231 = 0.1e1 / t91 / t229;
  t232 = sigma[2] * t231;
  t236 = t155 * t109;
  t237 = t110 * t89;
  t239 = 0.1e1 / t90 / t237;
  t241 = t239 * params->alpha * t104;
  t244 = t108 * t239;
  t245 = t102 * t102;
  t246 = 0.1e1 / t245;
  t247 = t99 * t246;
  t254 = t91 * rho[1];
  t261 = -t34 * t232 * t104 / 0.9e1 + t236 * t241 / 0.216e3 + t166 * t244 * t247 / 0.216e3 - 0.2e1 / 0.9e1 * t174 * t232 * t117 + 0.32e2 / 0.3e1 * t119 * t121 * t254 + t182 * t244 * t117 / 0.108e3;
  t266 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t225 * t125 - t204 - 0.3e1 / 0.8e1 * t5 * t88 * t261);
  tvrho1 = t80 + t129 + t6 * (t219 + t266);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t276 = t64 * params->alpha * t51;
  t279 = sigma[0] * t64;
  t287 = 0.1e1 / t59;
  t288 = t32 * t287;
  t295 = t34 * t39 * t46 * t50 / 0.24e2 - t155 * t58 * sigma[0] * t276 / 0.576e3 - t166 * t279 * t170 / 0.576e3 + t41 * t33 * t39 * t68 / 0.12e2 - 0.4e1 * t70 * t288 * t38 - t182 * t279 * t68 / 0.288e3;
  t299 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t295);
  tvsigma0 = t6 * t299;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t307 = t113 * params->alpha * t104;
  t310 = sigma[2] * t113;
  t318 = 0.1e1 / t108;
  t319 = t32 * t318;
  t326 = t34 * t93 * t99 * t103 / 0.24e2 - t155 * t58 * sigma[2] * t307 / 0.576e3 - t166 * t310 * t247 / 0.576e3 + t41 * t33 * t93 * t117 / 0.12e2 - 0.4e1 * t119 * t319 * t92 - t182 * t310 * t117 / 0.288e3;
  t330 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t326);
  tvsigma2 = t6 * t330;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t41, t42, t43, t46, t49, t50, t51;
  double t55, t56, t58, t59, t60, t61, t62, t64;
  double t68, t70, t71, t72, t76, t80, t81, t82;
  double t83, t84, t85, t87, t88, t89, t90, t91;
  double t92, t93, t95, t96, t99, t102, t103, t104;
  double t108, t109, t110, t111, t113, t117, t119, t120;
  double t121, t125, t129, tzk0;

  double t130, t131, t132, t133, t134, t137, t138, t142;
  double t143, t144, t147, t148, t150, t151, t155, t156;
  double t157, t159, t161, t164, t166, t167, t168, t169;
  double t170, t174, t178, t182, t186, t191, t193, t196;
  double t197, t201, t204, t206, tvrho0, t209, t210, t213;
  double t214, t219, t221, t224, t225, t229, t231, t232;
  double t236, t237, t239, t241, t244, t245, t246, t247;
  double t254, t261, t266, tvrho1, t276, t279, t287, t288;
  double t295, t299, tvsigma0, tvsigma1, t307, t310, t318, t319;
  double t326, t330, tvsigma2;

  double t333, t334, t335, t338, t339, t340, t342, t343;
  double t347, t348, t352, t354, t360, t361, t364, t366;
  double t369, t370, t374, t376, t378, t381, t385, t386;
  double t387, t388, t389, t390, t391, t392, t393, t398;
  double t399, t405, t406, t409, t416, t427, t429, t430;
  double t431, t432, t434, t439, t444, t445, t446, t447;
  double t451, t455, t456, t460, t462, t464, t467, t469;
  double tv2rho20, t472, t475, t476, t480, t481, t485, t487;
  double t495, t496, t499, t503, t504, t508, t510, t517;
  double t520, tv2rho21, t525, t529, t530, t534, t535, t541;
  double t542, t546, t550, t551, t561, t562, t566, t568;
  double t570, t573, t577, t578, t579, t580, t581, t586;
  double t591, t594, t611, t612, t614, t619, t624, tv2rho22;
  double t632, t637, t640, t643, t644, t649, t650, t662;
  double t676, t678, t683, t688, tv2rhosigma0, tv2rhosigma1, t695, t697;
  double tv2rhosigma2, t703, tv2rhosigma3, tv2rhosigma4, t712, t715, t718, t719;
  double t724, t725, t737, t751, t753, t758, t763, tv2rhosigma5;
  double t765, t773, t785, t796, t797, t806, t811, t815;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t823, t835, t846;
  double t847, t856, t861, t865, tv2sigma25;

  gga_x_vmt84_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt84_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->mu * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t38 = t37 * t35;
  t39 = 0.1e1 / t38;
  t41 = params->alpha * t28;
  t42 = t33 * sigma[0];
  t43 = t42 * t39;
  t46 = exp(-t41 * t43 / 0.24e2);
  t49 = 0.1e1 + t29 * t43 / 0.24e2;
  t50 = 0.1e1 / t49;
  t51 = t46 * t50;
  t55 = t28 * t28;
  t56 = params->alpha * t55;
  t58 = 0.1e1 / t31 / t30;
  t59 = sigma[0] * sigma[0];
  t60 = t58 * t59;
  t61 = t35 * t35;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t36 / t62;
  t68 = exp(-t56 * t60 * t64 / 0.576e3);
  t70 = (0.1e1 - t68) * t55;
  t71 = 0.1e1 / sigma[0];
  t72 = t32 * t71;
  t76 = t34 * sigma[0] * t39 * t51 / 0.24e2 + 0.4e1 * t70 * t72 * t38 + t68;
  t80 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t76);
  t81 = rho[1] <= p->dens_threshold;
  t82 = my_piecewise5(t14, t11, t10, t15, -t17);
  t83 = 0.1e1 + t82;
  t84 = t83 <= p->zeta_threshold;
  t85 = POW_1_3(t83);
  t87 = my_piecewise3(t84, t22, t85 * t83);
  t88 = t87 * t26;
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t92 = t91 * t89;
  t93 = 0.1e1 / t92;
  t95 = t33 * sigma[2];
  t96 = t95 * t93;
  t99 = exp(-t41 * t96 / 0.24e2);
  t102 = 0.1e1 + t29 * t96 / 0.24e2;
  t103 = 0.1e1 / t102;
  t104 = t99 * t103;
  t108 = sigma[2] * sigma[2];
  t109 = t58 * t108;
  t110 = t89 * t89;
  t111 = t110 * rho[1];
  t113 = 0.1e1 / t90 / t111;
  t117 = exp(-t56 * t109 * t113 / 0.576e3);
  t119 = (0.1e1 - t117) * t55;
  t120 = 0.1e1 / sigma[2];
  t121 = t32 * t120;
  t125 = t34 * sigma[2] * t93 * t104 / 0.24e2 + 0.4e1 * t119 * t121 * t92 + t117;
  t129 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t125);
  tzk0 = t80 + t129;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t130 = t6 * t6;
  t131 = 0.1e1 / t130;
  t132 = t16 * t131;
  t133 = t7 - t132;
  t134 = my_piecewise5(t10, 0, t14, 0, t133);
  t137 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t134);
  t138 = t137 * t26;
  t142 = t26 * t26;
  t143 = 0.1e1 / t142;
  t144 = t25 * t143;
  t147 = t5 * t144 * t76 / 0.8e1;
  t148 = t35 * rho[0];
  t150 = 0.1e1 / t37 / t148;
  t151 = sigma[0] * t150;
  t155 = params->mu * t55;
  t156 = t155 * t60;
  t157 = t61 * t35;
  t159 = 0.1e1 / t36 / t157;
  t161 = t159 * params->alpha * t51;
  t164 = params->mu * params->mu;
  t166 = t164 * t55 * t58;
  t167 = t59 * t159;
  t168 = t49 * t49;
  t169 = 0.1e1 / t168;
  t170 = t46 * t169;
  t174 = t41 * t33;
  t178 = t37 * rho[0];
  t182 = t56 * t58;
  t186 = -t34 * t151 * t51 / 0.9e1 + t156 * t161 / 0.216e3 + t166 * t167 * t170 / 0.216e3 - 0.2e1 / 0.9e1 * t174 * t151 * t68 + 0.32e2 / 0.3e1 * t70 * t72 * t178 + t182 * t167 * t68 / 0.108e3;
  t191 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t76 - t147 - 0.3e1 / 0.8e1 * t5 * t27 * t186);
  t193 = my_piecewise5(t14, 0, t10, 0, -t133);
  t196 = my_piecewise3(t84, 0, 0.4e1 / 0.3e1 * t85 * t193);
  t197 = t196 * t26;
  t201 = t87 * t143;
  t204 = t5 * t201 * t125 / 0.8e1;
  t206 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t197 * t125 - t204);
  tvrho0 = t80 + t129 + t6 * (t191 + t206);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t209 = -t7 - t132;
  t210 = my_piecewise5(t10, 0, t14, 0, t209);
  t213 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t210);
  t214 = t213 * t26;
  t219 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t214 * t76 - t147);
  t221 = my_piecewise5(t14, 0, t10, 0, -t209);
  t224 = my_piecewise3(t84, 0, 0.4e1 / 0.3e1 * t85 * t221);
  t225 = t224 * t26;
  t229 = t89 * rho[1];
  t231 = 0.1e1 / t91 / t229;
  t232 = sigma[2] * t231;
  t236 = t155 * t109;
  t237 = t110 * t89;
  t239 = 0.1e1 / t90 / t237;
  t241 = t239 * params->alpha * t104;
  t244 = t108 * t239;
  t245 = t102 * t102;
  t246 = 0.1e1 / t245;
  t247 = t99 * t246;
  t254 = t91 * rho[1];
  t261 = -t34 * t232 * t104 / 0.9e1 + t236 * t241 / 0.216e3 + t166 * t244 * t247 / 0.216e3 - 0.2e1 / 0.9e1 * t174 * t232 * t117 + 0.32e2 / 0.3e1 * t119 * t121 * t254 + t182 * t244 * t117 / 0.108e3;
  t266 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t225 * t125 - t204 - 0.3e1 / 0.8e1 * t5 * t88 * t261);
  tvrho1 = t80 + t129 + t6 * (t219 + t266);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t276 = t64 * params->alpha * t51;
  t279 = sigma[0] * t64;
  t287 = 0.1e1 / t59;
  t288 = t32 * t287;
  t295 = t34 * t39 * t46 * t50 / 0.24e2 - t155 * t58 * sigma[0] * t276 / 0.576e3 - t166 * t279 * t170 / 0.576e3 + t41 * t33 * t39 * t68 / 0.12e2 - 0.4e1 * t70 * t288 * t38 - t182 * t279 * t68 / 0.288e3;
  t299 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t295);
  tvsigma0 = t6 * t299;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t307 = t113 * params->alpha * t104;
  t310 = sigma[2] * t113;
  t318 = 0.1e1 / t108;
  t319 = t32 * t318;
  t326 = t34 * t93 * t99 * t103 / 0.24e2 - t155 * t58 * sigma[2] * t307 / 0.576e3 - t166 * t310 * t247 / 0.576e3 + t41 * t33 * t93 * t117 / 0.12e2 - 0.4e1 * t119 * t319 * t92 - t182 * t310 * t117 / 0.288e3;
  t330 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t326);
  tvsigma2 = t6 * t330;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t333 = t23 * t23;
  t334 = 0.1e1 / t333;
  t335 = t134 * t134;
  t338 = t130 * t6;
  t339 = 0.1e1 / t338;
  t340 = t16 * t339;
  t342 = -0.2e1 * t131 + 0.2e1 * t340;
  t343 = my_piecewise5(t10, 0, t14, 0, t342);
  t347 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t334 * t335 + 0.4e1 / 0.3e1 * t23 * t343);
  t348 = t347 * t26;
  t352 = t137 * t143;
  t354 = t5 * t352 * t76;
  t360 = 0.1e1 / t142 / t6;
  t361 = t25 * t360;
  t364 = t5 * t361 * t76 / 0.12e2;
  t366 = t5 * t144 * t186;
  t369 = 0.1e1 / t37 / t61;
  t370 = sigma[0] * t369;
  t374 = t61 * t148;
  t376 = 0.1e1 / t36 / t374;
  t378 = t376 * params->alpha * t51;
  t381 = t59 * t376;
  t385 = t30 * t30;
  t386 = 0.1e1 / t385;
  t387 = params->mu * t386;
  t388 = t59 * sigma[0];
  t389 = t387 * t388;
  t390 = t61 * t61;
  t391 = t390 * t35;
  t392 = 0.1e1 / t391;
  t393 = params->alpha * params->alpha;
  t398 = t164 * t386;
  t399 = t398 * t388;
  t405 = t164 * params->mu * t386;
  t406 = t405 * t388;
  t409 = 0.1e1 / t168 / t49;
  t416 = t393 * t386;
  t427 = t393 * t28;
  t429 = 0.1e1 / t32 / t385;
  t430 = t427 * t429;
  t431 = t59 * t59;
  t432 = t390 * t61;
  t434 = 0.1e1 / t37 / t432;
  t439 = 0.11e2 / 0.27e2 * t34 * t370 * t51 - t156 * t378 / 0.24e2 - t166 * t381 * t170 / 0.24e2 + t389 * t392 * t393 * t51 / 0.324e3 + t399 * t392 * params->alpha * t170 / 0.162e3 + t406 * t392 * t46 * t409 / 0.162e3 + 0.2e1 / 0.9e1 * t174 * t370 * t68 - t416 * t388 * t392 * t68 / 0.81e2 + 0.16e3 / 0.9e1 * t70 * t72 * t37 - 0.19e2 / 0.324e3 * t182 * t381 * t68 + t430 * t431 * t434 * t68 / 0.1944e4;
  t444 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t348 * t76 - t354 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t186 + t364 - t366 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t439);
  t445 = t85 * t85;
  t446 = 0.1e1 / t445;
  t447 = t193 * t193;
  t451 = my_piecewise5(t14, 0, t10, 0, -t342);
  t455 = my_piecewise3(t84, 0, 0.4e1 / 0.9e1 * t446 * t447 + 0.4e1 / 0.3e1 * t85 * t451);
  t456 = t455 * t26;
  t460 = t196 * t143;
  t462 = t5 * t460 * t125;
  t464 = t87 * t360;
  t467 = t5 * t464 * t125 / 0.12e2;
  t469 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t456 * t125 - t462 / 0.4e1 + t467);
  tv2rho20 = 0.2e1 * t191 + 0.2e1 * t206 + t6 * (t444 + t469);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t472 = t334 * t210;
  t475 = 0.2e1 * t340;
  t476 = my_piecewise5(t10, 0, t14, 0, t475);
  t480 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t472 * t134 + 0.4e1 / 0.3e1 * t23 * t476);
  t481 = t480 * t26;
  t485 = t213 * t143;
  t487 = t5 * t485 * t76;
  t495 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t481 * t76 - t487 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t214 * t186 - t354 / 0.8e1 + t364 - t366 / 0.8e1);
  t496 = t446 * t221;
  t499 = my_piecewise5(t14, 0, t10, 0, -t475);
  t503 = my_piecewise3(t84, 0, 0.4e1 / 0.9e1 * t496 * t193 + 0.4e1 / 0.3e1 * t85 * t499);
  t504 = t503 * t26;
  t508 = t224 * t143;
  t510 = t5 * t508 * t125;
  t517 = t5 * t201 * t261;
  t520 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t504 * t125 - t510 / 0.8e1 - t462 / 0.8e1 + t467 - 0.3e1 / 0.8e1 * t5 * t197 * t261 - t517 / 0.8e1);
  tv2rho21 = t191 + t206 + t219 + t266 + t6 * (t495 + t520);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t525 = t210 * t210;
  t529 = 0.2e1 * t131 + 0.2e1 * t340;
  t530 = my_piecewise5(t10, 0, t14, 0, t529);
  t534 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t334 * t525 + 0.4e1 / 0.3e1 * t23 * t530);
  t535 = t534 * t26;
  t541 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t535 * t76 - t487 / 0.4e1 + t364);
  t542 = t221 * t221;
  t546 = my_piecewise5(t14, 0, t10, 0, -t529);
  t550 = my_piecewise3(t84, 0, 0.4e1 / 0.9e1 * t446 * t542 + 0.4e1 / 0.3e1 * t85 * t546);
  t551 = t550 * t26;
  t561 = 0.1e1 / t91 / t110;
  t562 = sigma[2] * t561;
  t566 = t110 * t229;
  t568 = 0.1e1 / t90 / t566;
  t570 = t568 * params->alpha * t104;
  t573 = t108 * t568;
  t577 = t108 * sigma[2];
  t578 = t387 * t577;
  t579 = t110 * t110;
  t580 = t579 * t89;
  t581 = 0.1e1 / t580;
  t586 = t398 * t577;
  t591 = t405 * t577;
  t594 = 0.1e1 / t245 / t102;
  t611 = t108 * t108;
  t612 = t579 * t110;
  t614 = 0.1e1 / t91 / t612;
  t619 = 0.11e2 / 0.27e2 * t34 * t562 * t104 - t236 * t570 / 0.24e2 - t166 * t573 * t247 / 0.24e2 + t578 * t581 * t393 * t104 / 0.324e3 + t586 * t581 * params->alpha * t247 / 0.162e3 + t591 * t581 * t99 * t594 / 0.162e3 + 0.2e1 / 0.9e1 * t174 * t562 * t117 - t416 * t577 * t581 * t117 / 0.81e2 + 0.16e3 / 0.9e1 * t119 * t121 * t91 - 0.19e2 / 0.324e3 * t182 * t573 * t117 + t430 * t611 * t614 * t117 / 0.1944e4;
  t624 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t551 * t125 - t510 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t225 * t261 + t467 - t517 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t88 * t619);
  tv2rho22 = 0.2e1 * t219 + 0.2e1 * t266 + t6 * (t541 + t624);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t632 = t5 * t144 * t295 / 0.8e1;
  t637 = t58 * t159;
  t640 = params->alpha * sigma[0] * t51;
  t643 = t159 * t46;
  t644 = t169 * sigma[0];
  t649 = t390 * rho[0];
  t650 = 0.1e1 / t649;
  t662 = t650 * t46 * t409;
  t676 = t390 * t148;
  t678 = 0.1e1 / t37 / t676;
  t683 = -t34 * t150 * t46 * t50 / 0.9e1 + t155 * t637 * t640 / 0.72e2 + t166 * t643 * t644 / 0.72e2 - t387 * t59 * t650 * t393 * t51 / 0.864e3 - t398 * t59 * t650 * params->alpha * t170 / 0.432e3 - t405 * t59 * t662 / 0.432e3 + t416 * t650 * t59 * t68 / 0.216e3 - 0.32e2 / 0.3e1 * t70 * t288 * t178 + t182 * sigma[0] * t159 * t68 / 0.54e2 - t430 * t388 * t678 * t68 / 0.5184e4;
  t688 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t295 - t632 - 0.3e1 / 0.8e1 * t5 * t27 * t683);
  tv2rhosigma0 = t6 * t688 + t299;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t695 = t5 * t201 * t326 / 0.8e1;
  t697 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t197 * t326 - t695);
  tv2rhosigma2 = t6 * t697 + t330;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t703 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t214 * t295 - t632);
  tv2rhosigma3 = t6 * t703 + t299;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t712 = t58 * t239;
  t715 = params->alpha * sigma[2] * t104;
  t718 = t239 * t99;
  t719 = t246 * sigma[2];
  t724 = t579 * rho[1];
  t725 = 0.1e1 / t724;
  t737 = t725 * t99 * t594;
  t751 = t579 * t229;
  t753 = 0.1e1 / t91 / t751;
  t758 = -t34 * t231 * t99 * t103 / 0.9e1 + t155 * t712 * t715 / 0.72e2 + t166 * t718 * t719 / 0.72e2 - t387 * t108 * t725 * t393 * t104 / 0.864e3 - t398 * t108 * t725 * params->alpha * t247 / 0.432e3 - t405 * t108 * t737 / 0.432e3 + t416 * t725 * t108 * t117 / 0.216e3 - 0.32e2 / 0.3e1 * t119 * t319 * t254 + t182 * sigma[2] * t239 * t117 / 0.54e2 - t430 * t577 * t753 * t117 / 0.5184e4;
  t763 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t225 * t326 - t695 - 0.3e1 / 0.8e1 * t5 * t88 * t758);
  tv2rhosigma5 = t6 * t763 + t330;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t765 = t155 * t58;
  t773 = 0.1e1 / t390;
  t785 = t773 * t46 * t409;
  t796 = 0.1e1 / t388;
  t797 = t32 * t796;
  t806 = 0.1e1 / t37 / t391;
  t811 = -t765 * t276 / 0.288e3 - t166 * t64 * t46 * t169 / 0.288e3 + t387 * sigma[0] * t773 * t393 * t51 / 0.2304e4 + t398 * sigma[0] * t773 * params->alpha * t170 / 0.1152e4 + t405 * sigma[0] * t785 / 0.1152e4 - t416 * t773 * sigma[0] * t68 / 0.576e3 - t174 * t71 * t39 * t68 / 0.12e2 + 0.8e1 * t70 * t797 * t38 - t56 * t58 * t64 * t68 / 0.288e3 + t430 * t59 * t806 * t68 / 0.13824e5;
  t815 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t811);
  tv2sigma20 = t6 * t815;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t823 = 0.1e1 / t579;
  t835 = t823 * t99 * t594;
  t846 = 0.1e1 / t577;
  t847 = t32 * t846;
  t856 = 0.1e1 / t91 / t580;
  t861 = -t765 * t307 / 0.288e3 - t166 * t113 * t99 * t246 / 0.288e3 + t387 * sigma[2] * t823 * t393 * t104 / 0.2304e4 + t398 * sigma[2] * t823 * params->alpha * t247 / 0.1152e4 + t405 * sigma[2] * t835 / 0.1152e4 - t416 * t823 * sigma[2] * t117 / 0.576e3 - t174 * t120 * t93 * t117 / 0.12e2 + 0.8e1 * t119 * t847 * t92 - t56 * t58 * t113 * t117 / 0.288e3 + t430 * t108 * t856 * t117 / 0.13824e5;
  t865 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t861);
  tv2sigma25 = t6 * t865;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t41, t42, t43, t46, t49, t50, t51;
  double t55, t56, t58, t59, t60, t61, t62, t64;
  double t68, t70, t71, t72, t76, t80, t81, t82;
  double t83, t84, t85, t87, t88, t89, t90, t91;
  double t92, t93, t95, t96, t99, t102, t103, t104;
  double t108, t109, t110, t111, t113, t117, t119, t120;
  double t121, t125, t129, tzk0;

  double t130, t131, t132, t133, t134, t137, t138, t142;
  double t143, t144, t147, t148, t150, t151, t155, t156;
  double t157, t159, t161, t164, t166, t167, t168, t169;
  double t170, t174, t178, t182, t186, t191, t193, t196;
  double t197, t201, t204, t206, tvrho0, t209, t210, t213;
  double t214, t219, t221, t224, t225, t229, t231, t232;
  double t236, t237, t239, t241, t244, t245, t246, t247;
  double t254, t261, t266, tvrho1, t276, t279, t287, t288;
  double t295, t299, tvsigma0, tvsigma1, t307, t310, t318, t319;
  double t326, t330, tvsigma2;

  double t333, t334, t335, t338, t339, t340, t342, t343;
  double t347, t348, t352, t354, t360, t361, t364, t366;
  double t369, t370, t374, t376, t378, t381, t385, t386;
  double t387, t388, t389, t390, t391, t392, t393, t398;
  double t399, t405, t406, t409, t416, t427, t429, t430;
  double t431, t432, t434, t439, t444, t445, t446, t447;
  double t451, t455, t456, t460, t462, t464, t467, t469;
  double tv2rho20, t472, t475, t476, t480, t481, t485, t487;
  double t495, t496, t499, t503, t504, t508, t510, t517;
  double t520, tv2rho21, t525, t529, t530, t534, t535, t541;
  double t542, t546, t550, t551, t561, t562, t566, t568;
  double t570, t573, t577, t578, t579, t580, t581, t586;
  double t591, t594, t611, t612, t614, t619, t624, tv2rho22;
  double t632, t637, t640, t643, t644, t649, t650, t662;
  double t676, t678, t683, t688, tv2rhosigma0, tv2rhosigma1, t695, t697;
  double tv2rhosigma2, t703, tv2rhosigma3, tv2rhosigma4, t712, t715, t718, t719;
  double t724, t725, t737, t751, t753, t758, t763, tv2rhosigma5;
  double t765, t773, t785, t796, t797, t806, t811, t815;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t823, t835, t846;
  double t847, t856, t861, t865, tv2sigma25;

  double t869, t870, t873, t876, t877, t878, t880, t881;
  double t885, t886, t890, t892, t897, t899, t902, t908;
  double t909, t912, t914, t917, t919, t924, t925, t926;
  double t927, t928, t929, t930, t931, t940, t944, t946;
  double t947, t951, t952, t954, t955, t957, t958, t962;
  double t963, t968, t980, t981, t982, t984, t986, t990;
  double t1002, t1004, t1005, t1009, t1011, t1012, t1016, t1019;
  double t1022, t1027, t1029, t1030, t1033, t1037, t1041, t1042;
  double t1046, t1048, t1050, t1052, t1054, t1057, t1059, tv3rho30;
  double t1062, t1063, t1064, t1067, t1072, t1073, t1074, t1075;
  double t1079, t1080, t1084, t1087, t1091, t1093, t1097, t1106;
  double t1107, t1108, t1111, t1117, t1121, t1122, t1126, t1129;
  double t1130, t1132, t1141, t1143, t1146, tv3rho31, t1149, t1154;
  double t1157, t1158, t1162, t1163, t1167, t1169, t1178, t1179;
  double t1184, t1188, t1192, t1193, t1197, t1199, t1206, t1214;
  double t1216, t1217, tv3rho32, t1222, t1228, t1229, t1233, t1234;
  double t1241, t1242, t1248, t1252, t1253, t1268, t1273, t1277;
  double t1279, t1280, t1288, t1289, t1290, t1291, t1297, t1298;
  double t1300, t1304, t1305, t1310, t1326, t1327, t1329, t1331;
  double t1335, t1344, t1345, t1349, t1351, t1352, t1356, t1359;
  double t1362, t1367, tv3rho33, t1375, t1382, t1384, t1389, t1393;
  double t1394, t1395, t1406, t1407, t1415, t1423, t1427, t1429;
  double t1432, t1434, t1439, t1440, t1442, t1458, t1463, tv3rho2sigma0;
  double tv3rho2sigma1, t1470, t1474, t1476, tv3rho2sigma2, t1482, t1490, tv3rho2sigma3;
  double tv3rho2sigma4, t1496, t1503, t1506, tv3rho2sigma5, t1514, tv3rho2sigma6, tv3rho2sigma7;
  double t1525, t1532, t1533, t1534, t1548, t1549, t1554, t1562;
  double t1566, t1568, t1571, t1573, t1578, t1579, t1581, t1597;
  double t1602, tv3rho2sigma8, t1609, t1612, t1630, t1633, t1634, t1643;
  double t1645, t1648, t1649, t1655, t1657, t1658, t1660, t1672;
  double t1677, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1684, t1686;
  double tv3rhosigma25, t1692, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1697;
  double t1698, t1704, t1717, t1726, t1728, t1731, t1732, t1738;
  double t1740, t1741, t1743, t1759, t1764, tv3rhosigma211, t1767, t1771;
  double t1776, t1790, t1791, t1793, t1801, t1808, t1813, t1817;
  double tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37;
  double tv3sigma38, t1819, t1823, t1828, t1842, t1843, t1845, t1853;
  double t1860, t1865, t1869, tv3sigma39;

  gga_x_vmt84_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt84_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->mu * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t38 = t37 * t35;
  t39 = 0.1e1 / t38;
  t41 = params->alpha * t28;
  t42 = t33 * sigma[0];
  t43 = t42 * t39;
  t46 = exp(-t41 * t43 / 0.24e2);
  t49 = 0.1e1 + t29 * t43 / 0.24e2;
  t50 = 0.1e1 / t49;
  t51 = t46 * t50;
  t55 = t28 * t28;
  t56 = params->alpha * t55;
  t58 = 0.1e1 / t31 / t30;
  t59 = sigma[0] * sigma[0];
  t60 = t58 * t59;
  t61 = t35 * t35;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t36 / t62;
  t68 = exp(-t56 * t60 * t64 / 0.576e3);
  t70 = (0.1e1 - t68) * t55;
  t71 = 0.1e1 / sigma[0];
  t72 = t32 * t71;
  t76 = t34 * sigma[0] * t39 * t51 / 0.24e2 + 0.4e1 * t70 * t72 * t38 + t68;
  t80 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t76);
  t81 = rho[1] <= p->dens_threshold;
  t82 = my_piecewise5(t14, t11, t10, t15, -t17);
  t83 = 0.1e1 + t82;
  t84 = t83 <= p->zeta_threshold;
  t85 = POW_1_3(t83);
  t87 = my_piecewise3(t84, t22, t85 * t83);
  t88 = t87 * t26;
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t92 = t91 * t89;
  t93 = 0.1e1 / t92;
  t95 = t33 * sigma[2];
  t96 = t95 * t93;
  t99 = exp(-t41 * t96 / 0.24e2);
  t102 = 0.1e1 + t29 * t96 / 0.24e2;
  t103 = 0.1e1 / t102;
  t104 = t99 * t103;
  t108 = sigma[2] * sigma[2];
  t109 = t58 * t108;
  t110 = t89 * t89;
  t111 = t110 * rho[1];
  t113 = 0.1e1 / t90 / t111;
  t117 = exp(-t56 * t109 * t113 / 0.576e3);
  t119 = (0.1e1 - t117) * t55;
  t120 = 0.1e1 / sigma[2];
  t121 = t32 * t120;
  t125 = t34 * sigma[2] * t93 * t104 / 0.24e2 + 0.4e1 * t119 * t121 * t92 + t117;
  t129 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t125);
  tzk0 = t80 + t129;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t130 = t6 * t6;
  t131 = 0.1e1 / t130;
  t132 = t16 * t131;
  t133 = t7 - t132;
  t134 = my_piecewise5(t10, 0, t14, 0, t133);
  t137 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t134);
  t138 = t137 * t26;
  t142 = t26 * t26;
  t143 = 0.1e1 / t142;
  t144 = t25 * t143;
  t147 = t5 * t144 * t76 / 0.8e1;
  t148 = t35 * rho[0];
  t150 = 0.1e1 / t37 / t148;
  t151 = sigma[0] * t150;
  t155 = params->mu * t55;
  t156 = t155 * t60;
  t157 = t61 * t35;
  t159 = 0.1e1 / t36 / t157;
  t161 = t159 * params->alpha * t51;
  t164 = params->mu * params->mu;
  t166 = t164 * t55 * t58;
  t167 = t59 * t159;
  t168 = t49 * t49;
  t169 = 0.1e1 / t168;
  t170 = t46 * t169;
  t174 = t41 * t33;
  t178 = t37 * rho[0];
  t182 = t56 * t58;
  t186 = -t34 * t151 * t51 / 0.9e1 + t156 * t161 / 0.216e3 + t166 * t167 * t170 / 0.216e3 - 0.2e1 / 0.9e1 * t174 * t151 * t68 + 0.32e2 / 0.3e1 * t70 * t72 * t178 + t182 * t167 * t68 / 0.108e3;
  t191 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t76 - t147 - 0.3e1 / 0.8e1 * t5 * t27 * t186);
  t193 = my_piecewise5(t14, 0, t10, 0, -t133);
  t196 = my_piecewise3(t84, 0, 0.4e1 / 0.3e1 * t85 * t193);
  t197 = t196 * t26;
  t201 = t87 * t143;
  t204 = t5 * t201 * t125 / 0.8e1;
  t206 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t197 * t125 - t204);
  tvrho0 = t80 + t129 + t6 * (t191 + t206);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t209 = -t7 - t132;
  t210 = my_piecewise5(t10, 0, t14, 0, t209);
  t213 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t210);
  t214 = t213 * t26;
  t219 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t214 * t76 - t147);
  t221 = my_piecewise5(t14, 0, t10, 0, -t209);
  t224 = my_piecewise3(t84, 0, 0.4e1 / 0.3e1 * t85 * t221);
  t225 = t224 * t26;
  t229 = t89 * rho[1];
  t231 = 0.1e1 / t91 / t229;
  t232 = sigma[2] * t231;
  t236 = t155 * t109;
  t237 = t110 * t89;
  t239 = 0.1e1 / t90 / t237;
  t241 = t239 * params->alpha * t104;
  t244 = t108 * t239;
  t245 = t102 * t102;
  t246 = 0.1e1 / t245;
  t247 = t99 * t246;
  t254 = t91 * rho[1];
  t261 = -t34 * t232 * t104 / 0.9e1 + t236 * t241 / 0.216e3 + t166 * t244 * t247 / 0.216e3 - 0.2e1 / 0.9e1 * t174 * t232 * t117 + 0.32e2 / 0.3e1 * t119 * t121 * t254 + t182 * t244 * t117 / 0.108e3;
  t266 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t225 * t125 - t204 - 0.3e1 / 0.8e1 * t5 * t88 * t261);
  tvrho1 = t80 + t129 + t6 * (t219 + t266);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t276 = t64 * params->alpha * t51;
  t279 = sigma[0] * t64;
  t287 = 0.1e1 / t59;
  t288 = t32 * t287;
  t295 = t34 * t39 * t46 * t50 / 0.24e2 - t155 * t58 * sigma[0] * t276 / 0.576e3 - t166 * t279 * t170 / 0.576e3 + t41 * t33 * t39 * t68 / 0.12e2 - 0.4e1 * t70 * t288 * t38 - t182 * t279 * t68 / 0.288e3;
  t299 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t295);
  tvsigma0 = t6 * t299;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t307 = t113 * params->alpha * t104;
  t310 = sigma[2] * t113;
  t318 = 0.1e1 / t108;
  t319 = t32 * t318;
  t326 = t34 * t93 * t99 * t103 / 0.24e2 - t155 * t58 * sigma[2] * t307 / 0.576e3 - t166 * t310 * t247 / 0.576e3 + t41 * t33 * t93 * t117 / 0.12e2 - 0.4e1 * t119 * t319 * t92 - t182 * t310 * t117 / 0.288e3;
  t330 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t326);
  tvsigma2 = t6 * t330;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t333 = t23 * t23;
  t334 = 0.1e1 / t333;
  t335 = t134 * t134;
  t338 = t130 * t6;
  t339 = 0.1e1 / t338;
  t340 = t16 * t339;
  t342 = -0.2e1 * t131 + 0.2e1 * t340;
  t343 = my_piecewise5(t10, 0, t14, 0, t342);
  t347 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t334 * t335 + 0.4e1 / 0.3e1 * t23 * t343);
  t348 = t347 * t26;
  t352 = t137 * t143;
  t354 = t5 * t352 * t76;
  t360 = 0.1e1 / t142 / t6;
  t361 = t25 * t360;
  t364 = t5 * t361 * t76 / 0.12e2;
  t366 = t5 * t144 * t186;
  t369 = 0.1e1 / t37 / t61;
  t370 = sigma[0] * t369;
  t374 = t61 * t148;
  t376 = 0.1e1 / t36 / t374;
  t378 = t376 * params->alpha * t51;
  t381 = t59 * t376;
  t385 = t30 * t30;
  t386 = 0.1e1 / t385;
  t387 = params->mu * t386;
  t388 = t59 * sigma[0];
  t389 = t387 * t388;
  t390 = t61 * t61;
  t391 = t390 * t35;
  t392 = 0.1e1 / t391;
  t393 = params->alpha * params->alpha;
  t398 = t164 * t386;
  t399 = t398 * t388;
  t405 = t164 * params->mu * t386;
  t406 = t405 * t388;
  t409 = 0.1e1 / t168 / t49;
  t416 = t393 * t386;
  t427 = t393 * t28;
  t429 = 0.1e1 / t32 / t385;
  t430 = t427 * t429;
  t431 = t59 * t59;
  t432 = t390 * t61;
  t434 = 0.1e1 / t37 / t432;
  t439 = 0.11e2 / 0.27e2 * t34 * t370 * t51 - t156 * t378 / 0.24e2 - t166 * t381 * t170 / 0.24e2 + t389 * t392 * t393 * t51 / 0.324e3 + t399 * t392 * params->alpha * t170 / 0.162e3 + t406 * t392 * t46 * t409 / 0.162e3 + 0.2e1 / 0.9e1 * t174 * t370 * t68 - t416 * t388 * t392 * t68 / 0.81e2 + 0.16e3 / 0.9e1 * t70 * t72 * t37 - 0.19e2 / 0.324e3 * t182 * t381 * t68 + t430 * t431 * t434 * t68 / 0.1944e4;
  t444 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t348 * t76 - t354 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t186 + t364 - t366 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t439);
  t445 = t85 * t85;
  t446 = 0.1e1 / t445;
  t447 = t193 * t193;
  t451 = my_piecewise5(t14, 0, t10, 0, -t342);
  t455 = my_piecewise3(t84, 0, 0.4e1 / 0.9e1 * t446 * t447 + 0.4e1 / 0.3e1 * t85 * t451);
  t456 = t455 * t26;
  t460 = t196 * t143;
  t462 = t5 * t460 * t125;
  t464 = t87 * t360;
  t467 = t5 * t464 * t125 / 0.12e2;
  t469 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t456 * t125 - t462 / 0.4e1 + t467);
  tv2rho20 = 0.2e1 * t191 + 0.2e1 * t206 + t6 * (t444 + t469);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t472 = t334 * t210;
  t475 = 0.2e1 * t340;
  t476 = my_piecewise5(t10, 0, t14, 0, t475);
  t480 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t472 * t134 + 0.4e1 / 0.3e1 * t23 * t476);
  t481 = t480 * t26;
  t485 = t213 * t143;
  t487 = t5 * t485 * t76;
  t495 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t481 * t76 - t487 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t214 * t186 - t354 / 0.8e1 + t364 - t366 / 0.8e1);
  t496 = t446 * t221;
  t499 = my_piecewise5(t14, 0, t10, 0, -t475);
  t503 = my_piecewise3(t84, 0, 0.4e1 / 0.9e1 * t496 * t193 + 0.4e1 / 0.3e1 * t85 * t499);
  t504 = t503 * t26;
  t508 = t224 * t143;
  t510 = t5 * t508 * t125;
  t517 = t5 * t201 * t261;
  t520 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t504 * t125 - t510 / 0.8e1 - t462 / 0.8e1 + t467 - 0.3e1 / 0.8e1 * t5 * t197 * t261 - t517 / 0.8e1);
  tv2rho21 = t191 + t206 + t219 + t266 + t6 * (t495 + t520);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t525 = t210 * t210;
  t529 = 0.2e1 * t131 + 0.2e1 * t340;
  t530 = my_piecewise5(t10, 0, t14, 0, t529);
  t534 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t334 * t525 + 0.4e1 / 0.3e1 * t23 * t530);
  t535 = t534 * t26;
  t541 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t535 * t76 - t487 / 0.4e1 + t364);
  t542 = t221 * t221;
  t546 = my_piecewise5(t14, 0, t10, 0, -t529);
  t550 = my_piecewise3(t84, 0, 0.4e1 / 0.9e1 * t446 * t542 + 0.4e1 / 0.3e1 * t85 * t546);
  t551 = t550 * t26;
  t561 = 0.1e1 / t91 / t110;
  t562 = sigma[2] * t561;
  t566 = t110 * t229;
  t568 = 0.1e1 / t90 / t566;
  t570 = t568 * params->alpha * t104;
  t573 = t108 * t568;
  t577 = t108 * sigma[2];
  t578 = t387 * t577;
  t579 = t110 * t110;
  t580 = t579 * t89;
  t581 = 0.1e1 / t580;
  t586 = t398 * t577;
  t591 = t405 * t577;
  t594 = 0.1e1 / t245 / t102;
  t611 = t108 * t108;
  t612 = t579 * t110;
  t614 = 0.1e1 / t91 / t612;
  t619 = 0.11e2 / 0.27e2 * t34 * t562 * t104 - t236 * t570 / 0.24e2 - t166 * t573 * t247 / 0.24e2 + t578 * t581 * t393 * t104 / 0.324e3 + t586 * t581 * params->alpha * t247 / 0.162e3 + t591 * t581 * t99 * t594 / 0.162e3 + 0.2e1 / 0.9e1 * t174 * t562 * t117 - t416 * t577 * t581 * t117 / 0.81e2 + 0.16e3 / 0.9e1 * t119 * t121 * t91 - 0.19e2 / 0.324e3 * t182 * t573 * t117 + t430 * t611 * t614 * t117 / 0.1944e4;
  t624 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t551 * t125 - t510 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t225 * t261 + t467 - t517 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t88 * t619);
  tv2rho22 = 0.2e1 * t219 + 0.2e1 * t266 + t6 * (t541 + t624);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t632 = t5 * t144 * t295 / 0.8e1;
  t637 = t58 * t159;
  t640 = params->alpha * sigma[0] * t51;
  t643 = t159 * t46;
  t644 = t169 * sigma[0];
  t649 = t390 * rho[0];
  t650 = 0.1e1 / t649;
  t662 = t650 * t46 * t409;
  t676 = t390 * t148;
  t678 = 0.1e1 / t37 / t676;
  t683 = -t34 * t150 * t46 * t50 / 0.9e1 + t155 * t637 * t640 / 0.72e2 + t166 * t643 * t644 / 0.72e2 - t387 * t59 * t650 * t393 * t51 / 0.864e3 - t398 * t59 * t650 * params->alpha * t170 / 0.432e3 - t405 * t59 * t662 / 0.432e3 + t416 * t650 * t59 * t68 / 0.216e3 - 0.32e2 / 0.3e1 * t70 * t288 * t178 + t182 * sigma[0] * t159 * t68 / 0.54e2 - t430 * t388 * t678 * t68 / 0.5184e4;
  t688 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t295 - t632 - 0.3e1 / 0.8e1 * t5 * t27 * t683);
  tv2rhosigma0 = t6 * t688 + t299;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t695 = t5 * t201 * t326 / 0.8e1;
  t697 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t197 * t326 - t695);
  tv2rhosigma2 = t6 * t697 + t330;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t703 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t214 * t295 - t632);
  tv2rhosigma3 = t6 * t703 + t299;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t712 = t58 * t239;
  t715 = params->alpha * sigma[2] * t104;
  t718 = t239 * t99;
  t719 = t246 * sigma[2];
  t724 = t579 * rho[1];
  t725 = 0.1e1 / t724;
  t737 = t725 * t99 * t594;
  t751 = t579 * t229;
  t753 = 0.1e1 / t91 / t751;
  t758 = -t34 * t231 * t99 * t103 / 0.9e1 + t155 * t712 * t715 / 0.72e2 + t166 * t718 * t719 / 0.72e2 - t387 * t108 * t725 * t393 * t104 / 0.864e3 - t398 * t108 * t725 * params->alpha * t247 / 0.432e3 - t405 * t108 * t737 / 0.432e3 + t416 * t725 * t108 * t117 / 0.216e3 - 0.32e2 / 0.3e1 * t119 * t319 * t254 + t182 * sigma[2] * t239 * t117 / 0.54e2 - t430 * t577 * t753 * t117 / 0.5184e4;
  t763 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t225 * t326 - t695 - 0.3e1 / 0.8e1 * t5 * t88 * t758);
  tv2rhosigma5 = t6 * t763 + t330;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t765 = t155 * t58;
  t773 = 0.1e1 / t390;
  t785 = t773 * t46 * t409;
  t796 = 0.1e1 / t388;
  t797 = t32 * t796;
  t806 = 0.1e1 / t37 / t391;
  t811 = -t765 * t276 / 0.288e3 - t166 * t64 * t46 * t169 / 0.288e3 + t387 * sigma[0] * t773 * t393 * t51 / 0.2304e4 + t398 * sigma[0] * t773 * params->alpha * t170 / 0.1152e4 + t405 * sigma[0] * t785 / 0.1152e4 - t416 * t773 * sigma[0] * t68 / 0.576e3 - t174 * t71 * t39 * t68 / 0.12e2 + 0.8e1 * t70 * t797 * t38 - t56 * t58 * t64 * t68 / 0.288e3 + t430 * t59 * t806 * t68 / 0.13824e5;
  t815 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t811);
  tv2sigma20 = t6 * t815;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t823 = 0.1e1 / t579;
  t835 = t823 * t99 * t594;
  t846 = 0.1e1 / t577;
  t847 = t32 * t846;
  t856 = 0.1e1 / t91 / t580;
  t861 = -t765 * t307 / 0.288e3 - t166 * t113 * t99 * t246 / 0.288e3 + t387 * sigma[2] * t823 * t393 * t104 / 0.2304e4 + t398 * sigma[2] * t823 * params->alpha * t247 / 0.1152e4 + t405 * sigma[2] * t835 / 0.1152e4 - t416 * t823 * sigma[2] * t117 / 0.576e3 - t174 * t120 * t93 * t117 / 0.12e2 + 0.8e1 * t119 * t847 * t92 - t56 * t58 * t113 * t117 / 0.288e3 + t430 * t108 * t856 * t117 / 0.13824e5;
  t865 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t861);
  tv2sigma25 = t6 * t865;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t869 = 0.1e1 / t333 / t19;
  t870 = t335 * t134;
  t873 = t334 * t134;
  t876 = t130 * t130;
  t877 = 0.1e1 / t876;
  t878 = t16 * t877;
  t880 = 0.6e1 * t339 - 0.6e1 * t878;
  t881 = my_piecewise5(t10, 0, t14, 0, t880);
  t885 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t869 * t870 + 0.4e1 / 0.3e1 * t873 * t343 + 0.4e1 / 0.3e1 * t23 * t881);
  t886 = t885 * t26;
  t890 = t347 * t143;
  t892 = t5 * t890 * t76;
  t897 = t137 * t360;
  t899 = t5 * t897 * t76;
  t902 = t5 * t352 * t186;
  t908 = 0.1e1 / t142 / t130;
  t909 = t25 * t908;
  t912 = 0.5e1 / 0.36e2 * t5 * t909 * t76;
  t914 = t5 * t361 * t186;
  t917 = t5 * t144 * t439;
  t919 = 0.1e1 / t676;
  t924 = t393 * params->alpha;
  t925 = t385 * t385;
  t926 = 0.1e1 / t925;
  t927 = t924 * t926;
  t928 = t431 * t59;
  t929 = t390 * t390;
  t930 = t929 * t148;
  t931 = 0.1e1 / t930;
  t940 = 0.1e1 / t36;
  t944 = t390 * t62;
  t946 = 0.1e1 / t37 / t944;
  t947 = t431 * t946;
  t951 = t164 * t164;
  t952 = t951 * t386;
  t954 = t168 * t168;
  t955 = 0.1e1 / t954;
  t957 = t28 * t33;
  t958 = t46 * t955 * t957;
  t962 = 0.1e1 / t37 / t62;
  t963 = sigma[0] * t962;
  t968 = 0.1e1 / t36 / t390;
  t980 = t924 * t386;
  t981 = t431 * sigma[0];
  t982 = t980 * t981;
  t984 = 0.1e1 / t36 / t929;
  t986 = t58 * t68;
  t990 = t59 * t968;
  t1002 = t924 * t28;
  t1004 = t33 * t46 * t50;
  t1005 = t1002 * t1004;
  t1009 = t393 * t46;
  t1011 = t169 * t28 * t33;
  t1012 = t1009 * t1011;
  t1016 = params->alpha * t46;
  t1019 = t1016 * t409 * t28 * t33;
  t1022 = 0.11e2 / 0.81e2 * t416 * t388 * t919 * t68 + t927 * t928 * t931 * t68 / 0.34992e5 - 0.19e2 / 0.162e3 * t406 * t919 * t46 * t409 + 0.32e3 / 0.27e2 * t70 * t72 * t940 - 0.19e2 / 0.1944e4 * t430 * t947 * t68 + t952 * t947 * t958 / 0.486e3 - 0.154e3 / 0.81e2 * t34 * t963 * t51 + 0.341e3 / 0.972e3 * t156 * t968 * params->alpha * t51 - 0.19e2 / 0.162e3 * t399 * t919 * params->alpha * t170 - 0.164e3 / 0.81e2 * t174 * t963 * t68 - t982 * t984 * t55 * t986 / 0.8748e4 + 0.209e3 / 0.486e3 * t182 * t990 * t68 + 0.341e3 / 0.972e3 * t166 * t990 * t170 - 0.19e2 / 0.324e3 * t389 * t919 * t393 * t51 + t387 * t947 * t1005 / 0.2916e4 + t398 * t947 * t1012 / 0.972e3 + t405 * t947 * t1019 / 0.486e3;
  t1027 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t886 * t76 - 0.3e1 / 0.8e1 * t892 - 0.9e1 / 0.8e1 * t5 * t348 * t186 + t899 / 0.4e1 - 0.3e1 / 0.4e1 * t902 - 0.9e1 / 0.8e1 * t5 * t138 * t439 - t912 + t914 / 0.4e1 - 0.3e1 / 0.8e1 * t917 - 0.3e1 / 0.8e1 * t5 * t27 * t1022);
  t1029 = 0.1e1 / t445 / t83;
  t1030 = t447 * t193;
  t1033 = t446 * t193;
  t1037 = my_piecewise5(t14, 0, t10, 0, -t880);
  t1041 = my_piecewise3(t84, 0, -0.8e1 / 0.27e2 * t1029 * t1030 + 0.4e1 / 0.3e1 * t1033 * t451 + 0.4e1 / 0.3e1 * t85 * t1037);
  t1042 = t1041 * t26;
  t1046 = t455 * t143;
  t1048 = t5 * t1046 * t125;
  t1050 = t196 * t360;
  t1052 = t5 * t1050 * t125;
  t1054 = t87 * t908;
  t1057 = 0.5e1 / 0.36e2 * t5 * t1054 * t125;
  t1059 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t1042 * t125 - 0.3e1 / 0.8e1 * t1048 + t1052 / 0.4e1 - t1057);
  tv3rho30 = 0.3e1 * t444 + 0.3e1 * t469 + t6 * (t1027 + t1059);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1062 = 0.2e1 * t495;
  t1063 = 0.2e1 * t520;
  t1064 = t869 * t210;
  t1067 = t334 * t476;
  t1072 = 0.2e1 * t339;
  t1073 = 0.6e1 * t878;
  t1074 = t1072 - t1073;
  t1075 = my_piecewise5(t10, 0, t14, 0, t1074);
  t1079 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1064 * t335 + 0.8e1 / 0.9e1 * t1067 * t134 + 0.4e1 / 0.9e1 * t472 * t343 + 0.4e1 / 0.3e1 * t23 * t1075);
  t1080 = t1079 * t26;
  t1084 = t480 * t143;
  t1087 = t5 * t1084 * t76 / 0.4e1;
  t1091 = t213 * t360;
  t1093 = t5 * t1091 * t76;
  t1097 = t5 * t485 * t186 / 0.4e1;
  t1106 = -0.3e1 / 0.8e1 * t5 * t1080 * t76 - t1087 - 0.3e1 / 0.4e1 * t5 * t481 * t186 + t1093 / 0.12e2 - t1097 - 0.3e1 / 0.8e1 * t5 * t214 * t439 - t892 / 0.8e1 + t899 / 0.6e1 - t902 / 0.4e1 - t912 + t914 / 0.6e1 - t917 / 0.8e1;
  t1107 = my_piecewise3(t1, 0, t1106);
  t1108 = t1029 * t221;
  t1111 = t446 * t499;
  t1117 = my_piecewise5(t14, 0, t10, 0, -t1074);
  t1121 = my_piecewise3(t84, 0, -0.8e1 / 0.27e2 * t1108 * t447 + 0.8e1 / 0.9e1 * t1111 * t193 + 0.4e1 / 0.9e1 * t496 * t451 + 0.4e1 / 0.3e1 * t85 * t1117);
  t1122 = t1121 * t26;
  t1126 = t503 * t143;
  t1129 = t5 * t1126 * t125 / 0.4e1;
  t1130 = t224 * t360;
  t1132 = t5 * t1130 * t125;
  t1141 = t5 * t460 * t261 / 0.4e1;
  t1143 = t5 * t464 * t261;
  t1146 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t1122 * t125 - t1129 + t1132 / 0.12e2 - t1048 / 0.8e1 + t1052 / 0.6e1 - t1057 - 0.3e1 / 0.8e1 * t5 * t456 * t261 - t1141 + t1143 / 0.12e2);
  tv3rho31 = t444 + t469 + t1062 + t1063 + t6 * (t1107 + t1146);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1149 = t869 * t525;
  t1154 = t334 * t530;
  t1157 = -t1072 - t1073;
  t1158 = my_piecewise5(t10, 0, t14, 0, t1157);
  t1162 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1149 * t134 + 0.8e1 / 0.9e1 * t472 * t476 + 0.4e1 / 0.9e1 * t1154 * t134 + 0.4e1 / 0.3e1 * t23 * t1158);
  t1163 = t1162 * t26;
  t1167 = t534 * t143;
  t1169 = t5 * t1167 * t76;
  t1178 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1163 * t76 - t1169 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t535 * t186 - t1087 + t1093 / 0.6e1 - t1097 + t899 / 0.12e2 - t912 + t914 / 0.12e2);
  t1179 = t1029 * t542;
  t1184 = t446 * t546;
  t1188 = my_piecewise5(t14, 0, t10, 0, -t1157);
  t1192 = my_piecewise3(t84, 0, -0.8e1 / 0.27e2 * t1179 * t193 + 0.8e1 / 0.9e1 * t496 * t499 + 0.4e1 / 0.9e1 * t1184 * t193 + 0.4e1 / 0.3e1 * t85 * t1188);
  t1193 = t1192 * t26;
  t1197 = t550 * t143;
  t1199 = t5 * t1197 * t125;
  t1206 = t5 * t508 * t261;
  t1214 = t5 * t201 * t619;
  t1216 = -0.3e1 / 0.8e1 * t5 * t1193 * t125 - t1199 / 0.8e1 - t1129 + t1132 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t504 * t261 - t1206 / 0.4e1 + t1052 / 0.12e2 - t1057 - t1141 + t1143 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t197 * t619 - t1214 / 0.8e1;
  t1217 = my_piecewise3(t81, 0, t1216);
  tv3rho32 = t1062 + t1063 + t541 + t624 + t6 * (t1178 + t1217);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1222 = t525 * t210;
  t1228 = -0.6e1 * t339 - 0.6e1 * t878;
  t1229 = my_piecewise5(t10, 0, t14, 0, t1228);
  t1233 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t869 * t1222 + 0.4e1 / 0.3e1 * t472 * t530 + 0.4e1 / 0.3e1 * t23 * t1229);
  t1234 = t1233 * t26;
  t1241 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1234 * t76 - 0.3e1 / 0.8e1 * t1169 + t1093 / 0.4e1 - t912);
  t1242 = t542 * t221;
  t1248 = my_piecewise5(t14, 0, t10, 0, -t1228);
  t1252 = my_piecewise3(t84, 0, -0.8e1 / 0.27e2 * t1029 * t1242 + 0.4e1 / 0.3e1 * t496 * t546 + 0.4e1 / 0.3e1 * t85 * t1248);
  t1253 = t1252 * t26;
  t1268 = 0.1e1 / t751;
  t1273 = 0.1e1 / t90;
  t1277 = t579 * t111;
  t1279 = 0.1e1 / t91 / t1277;
  t1280 = t611 * t1279;
  t1288 = t611 * t108;
  t1289 = t579 * t579;
  t1290 = t1289 * t229;
  t1291 = 0.1e1 / t1290;
  t1297 = t245 * t245;
  t1298 = 0.1e1 / t1297;
  t1300 = t99 * t1298 * t957;
  t1304 = 0.1e1 / t91 / t111;
  t1305 = sigma[2] * t1304;
  t1310 = 0.1e1 / t90 / t579;
  t1326 = t611 * sigma[2];
  t1327 = t980 * t1326;
  t1329 = 0.1e1 / t90 / t1289;
  t1331 = t58 * t117;
  t1335 = t108 * t1310;
  t1344 = t33 * t99 * t103;
  t1345 = t1002 * t1344;
  t1349 = t393 * t99;
  t1351 = t246 * t28 * t33;
  t1352 = t1349 * t1351;
  t1356 = params->alpha * t99;
  t1359 = t1356 * t594 * t28 * t33;
  t1362 = -0.19e2 / 0.162e3 * t591 * t1268 * t99 * t594 + 0.32e3 / 0.27e2 * t119 * t121 * t1273 - 0.19e2 / 0.1944e4 * t430 * t1280 * t117 + 0.11e2 / 0.81e2 * t416 * t577 * t1268 * t117 + t927 * t1288 * t1291 * t117 / 0.34992e5 + t952 * t1280 * t1300 / 0.486e3 - 0.154e3 / 0.81e2 * t34 * t1305 * t104 + 0.341e3 / 0.972e3 * t236 * t1310 * params->alpha * t104 - 0.19e2 / 0.324e3 * t578 * t1268 * t393 * t104 - 0.19e2 / 0.162e3 * t586 * t1268 * params->alpha * t247 - 0.164e3 / 0.81e2 * t174 * t1305 * t117 - t1327 * t1329 * t55 * t1331 / 0.8748e4 + 0.209e3 / 0.486e3 * t182 * t1335 * t117 + 0.341e3 / 0.972e3 * t166 * t1335 * t247 + t387 * t1280 * t1345 / 0.2916e4 + t398 * t1280 * t1352 / 0.972e3 + t405 * t1280 * t1359 / 0.486e3;
  t1367 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t1253 * t125 - 0.3e1 / 0.8e1 * t1199 - 0.9e1 / 0.8e1 * t5 * t551 * t261 + t1132 / 0.4e1 - 0.3e1 / 0.4e1 * t1206 - 0.9e1 / 0.8e1 * t5 * t225 * t619 - t1057 + t1143 / 0.4e1 - 0.3e1 / 0.8e1 * t1214 - 0.3e1 / 0.8e1 * t5 * t88 * t1362);
  tv3rho33 = 0.3e1 * t541 + 0.3e1 * t624 + t6 * (t1241 + t1367);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1375 = t5 * t352 * t295;
  t1382 = t5 * t361 * t295 / 0.12e2;
  t1384 = t5 * t144 * t683;
  t1389 = t388 * t434;
  t1393 = t405 * t392;
  t1394 = t46 * t409;
  t1395 = t1394 * t59;
  t1406 = t929 * t35;
  t1407 = 0.1e1 / t1406;
  t1415 = t58 * t376;
  t1423 = t376 * t46;
  t1427 = t387 * t392;
  t1429 = t393 * t59 * t51;
  t1432 = t398 * t392;
  t1434 = params->alpha * t59 * t170;
  t1439 = 0.1e1 / t36 / t390 / t374;
  t1440 = t980 * t1439;
  t1442 = t431 * t55 * t986;
  t1458 = -0.16e3 / 0.9e1 * t70 * t288 * t37 + 0.17e2 / 0.5184e4 * t430 * t1389 * t68 + 0.17e2 / 0.432e3 * t1393 * t1395 - t416 * t392 * t59 * t68 / 0.24e2 + 0.16e2 / 0.27e2 * t41 * t33 * t369 * t68 - t927 * t981 * t1407 * t68 / 0.93312e5 - t952 * t1389 * t958 / 0.1296e4 - 0.65e2 / 0.648e3 * t155 * t1415 * t640 + 0.11e2 / 0.27e2 * t34 * t369 * t46 * t50 - 0.65e2 / 0.648e3 * t166 * t1423 * t644 + 0.17e2 / 0.864e3 * t1427 * t1429 + 0.17e2 / 0.432e3 * t1432 * t1434 + t1440 * t1442 / 0.23328e5 - 0.19e2 / 0.162e3 * t182 * sigma[0] * t376 * t68 - t387 * t1389 * t1005 / 0.7776e4 - t398 * t1389 * t1012 / 0.2592e4 - t405 * t1389 * t1019 / 0.1296e4;
  t1463 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t348 * t295 - t1375 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t683 + t1382 - t1384 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1458);
  tv3rho2sigma0 = t6 * t1463 + 0.2e1 * t688;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1470 = t5 * t460 * t326;
  t1474 = t5 * t464 * t326 / 0.12e2;
  t1476 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t456 * t326 - t1470 / 0.4e1 + t1474);
  tv3rho2sigma2 = t6 * t1476 + 0.2e1 * t697;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1482 = t5 * t485 * t295;
  t1490 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t481 * t295 - t1482 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t214 * t683 - t1375 / 0.8e1 + t1382 - t1384 / 0.8e1);
  tv3rho2sigma3 = t6 * t1490 + t688 + t703;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1496 = t5 * t508 * t326;
  t1503 = t5 * t201 * t758;
  t1506 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t504 * t326 - t1496 / 0.8e1 - t1470 / 0.8e1 + t1474 - 0.3e1 / 0.8e1 * t5 * t197 * t758 - t1503 / 0.8e1);
  tv3rho2sigma5 = t6 * t1506 + t697 + t763;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1514 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t535 * t295 - t1482 / 0.4e1 + t1382);
  tv3rho2sigma6 = t6 * t1514 + 0.2e1 * t703;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1525 = t577 * t614;
  t1532 = t405 * t581;
  t1533 = t99 * t594;
  t1534 = t1533 * t108;
  t1548 = t1289 * t89;
  t1549 = 0.1e1 / t1548;
  t1554 = t58 * t568;
  t1562 = t568 * t99;
  t1566 = t387 * t581;
  t1568 = t393 * t108 * t104;
  t1571 = t398 * t581;
  t1573 = params->alpha * t108 * t247;
  t1578 = 0.1e1 / t90 / t579 / t566;
  t1579 = t980 * t1578;
  t1581 = t611 * t55 * t1331;
  t1597 = -t952 * t1525 * t1300 / 0.1296e4 + 0.17e2 / 0.5184e4 * t430 * t1525 * t117 + 0.17e2 / 0.432e3 * t1532 * t1534 - t416 * t581 * t108 * t117 / 0.24e2 - 0.16e3 / 0.9e1 * t119 * t319 * t91 + 0.16e2 / 0.27e2 * t41 * t33 * t561 * t117 - t927 * t1326 * t1549 * t117 / 0.93312e5 - 0.65e2 / 0.648e3 * t155 * t1554 * t715 + 0.11e2 / 0.27e2 * t34 * t561 * t99 * t103 - 0.65e2 / 0.648e3 * t166 * t1562 * t719 + 0.17e2 / 0.864e3 * t1566 * t1568 + 0.17e2 / 0.432e3 * t1571 * t1573 + t1579 * t1581 / 0.23328e5 - 0.19e2 / 0.162e3 * t182 * sigma[2] * t568 * t117 - t405 * t1525 * t1359 / 0.1296e4 - t387 * t1525 * t1345 / 0.7776e4 - t398 * t1525 * t1352 / 0.2592e4;
  t1602 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t551 * t326 - t1496 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t225 * t758 + t1474 - t1503 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t88 * t1597);
  tv3rho2sigma8 = t6 * t1602 + 0.2e1 * t763;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1609 = t5 * t144 * t811 / 0.8e1;
  t1612 = t59 * t678;
  t1630 = t1394 * sigma[0];
  t1633 = t929 * rho[0];
  t1634 = 0.1e1 / t1633;
  t1643 = t387 * t650;
  t1645 = t393 * sigma[0] * t51;
  t1648 = t398 * t650;
  t1649 = t1016 * t644;
  t1655 = t390 * t157;
  t1657 = 0.1e1 / t36 / t1655;
  t1658 = t980 * t1657;
  t1660 = t388 * t55 * t986;
  t1672 = t765 * t161 / 0.54e2 + t952 * t1612 * t958 / 0.3456e4 + t416 * t650 * sigma[0] * t68 / 0.108e3 + 0.64e2 / 0.3e1 * t70 * t797 * t178 + t56 * t637 * t68 / 0.54e2 - 0.5e1 / 0.5184e4 * t430 * t1612 * t68 - 0.5e1 / 0.432e3 * t405 * t650 * t1630 + t927 * t431 * t1634 * t68 / 0.248832e6 - 0.2e1 / 0.9e1 * t174 * t71 * t150 * t68 - 0.5e1 / 0.864e3 * t1643 * t1645 - 0.5e1 / 0.432e3 * t1648 * t1649 + t166 * t643 * t169 / 0.54e2 - t1658 * t1660 / 0.62208e5 + t387 * t1612 * t1005 / 0.20736e5 + t398 * t1612 * t1012 / 0.6912e4 + t405 * t1612 * t1019 / 0.3456e4;
  t1677 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t811 - t1609 - 0.3e1 / 0.8e1 * t5 * t27 * t1672);
  tv3rhosigma20 = t6 * t1677 + t815;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1684 = t5 * t201 * t861 / 0.8e1;
  t1686 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t197 * t861 - t1684);
  tv3rhosigma25 = t6 * t1686 + t865;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1692 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t214 * t811 - t1609);
  tv3rhosigma26 = t6 * t1692 + t815;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1697 = t1289 * rho[1];
  t1698 = 0.1e1 / t1697;
  t1704 = t1533 * sigma[2];
  t1717 = t753 * t108;
  t1726 = t387 * t725;
  t1728 = t393 * sigma[2] * t104;
  t1731 = t398 * t725;
  t1732 = t1356 * t719;
  t1738 = t579 * t237;
  t1740 = 0.1e1 / t90 / t1738;
  t1741 = t980 * t1740;
  t1743 = t577 * t55 * t1331;
  t1759 = t927 * t611 * t1698 * t117 / 0.248832e6 - 0.5e1 / 0.432e3 * t405 * t725 * t1704 + t416 * t725 * sigma[2] * t117 / 0.108e3 + 0.64e2 / 0.3e1 * t119 * t847 * t254 + t56 * t712 * t117 / 0.54e2 - 0.5e1 / 0.5184e4 * t430 * t1717 * t117 + t765 * t241 / 0.54e2 + t952 * t1717 * t1300 / 0.3456e4 - 0.5e1 / 0.864e3 * t1726 * t1728 - 0.5e1 / 0.432e3 * t1731 * t1732 + t166 * t718 * t246 / 0.54e2 - t1741 * t1743 / 0.62208e5 - 0.2e1 / 0.9e1 * t174 * t120 * t231 * t117 + t387 * t1717 * t1345 / 0.20736e5 + t398 * t1717 * t1352 / 0.6912e4 + t405 * t1717 * t1359 / 0.3456e4;
  t1764 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t225 * t861 - t1684 - 0.3e1 / 0.8e1 * t5 * t88 * t1759);
  tv3rhosigma211 = t6 * t1764 + t865;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1767 = t1009 * t50;
  t1771 = t1016 * t169;
  t1776 = sigma[0] * t806;
  t1790 = 0.1e1 / t36 / t944;
  t1791 = t980 * t1790;
  t1793 = t59 * t55 * t986;
  t1801 = t32 / t431;
  t1808 = 0.1e1 / t929;
  t1813 = t387 * t773 * t1767 / 0.768e3 + t398 * t773 * t1771 / 0.384e3 + t405 * t785 / 0.384e3 - t387 * t1776 * t1005 / 0.55296e5 - t398 * t1776 * t1012 / 0.18432e5 - t405 * t1776 * t1019 / 0.9216e4 - t952 * t1776 * t958 / 0.9216e4 + t1791 * t1793 / 0.165888e6 + t174 * t287 * t39 * t68 / 0.4e1 - 0.24e2 * t70 * t1801 * t38 + t430 * t1776 * t68 / 0.4608e4 - t927 * t388 * t1808 * t68 / 0.663552e6;
  t1817 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1813);
  tv3sigma30 = t6 * t1817;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1819 = t1349 * t103;
  t1823 = t1356 * t246;
  t1828 = sigma[2] * t856;
  t1842 = 0.1e1 / t90 / t1277;
  t1843 = t980 * t1842;
  t1845 = t108 * t55 * t1331;
  t1853 = t32 / t611;
  t1860 = 0.1e1 / t1289;
  t1865 = t387 * t823 * t1819 / 0.768e3 + t398 * t823 * t1823 / 0.384e3 + t405 * t835 / 0.384e3 - t387 * t1828 * t1345 / 0.55296e5 - t398 * t1828 * t1352 / 0.18432e5 - t405 * t1828 * t1359 / 0.9216e4 - t952 * t1828 * t1300 / 0.9216e4 + t1843 * t1845 / 0.165888e6 + t174 * t318 * t93 * t117 / 0.4e1 - 0.24e2 * t119 * t1853 * t92 + t430 * t1828 * t117 / 0.4608e4 - t927 * t577 * t1860 * t117 / 0.663552e6;
  t1869 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t1865);
  tv3sigma39 = t6 * t1869;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38;
  double t39, t41, t42, t43, t46, t49, t50, t51;
  double t55, t56, t58, t59, t60, t61, t62, t64;
  double t68, t70, t71, t72, t76, t80, t81, t82;
  double t83, t84, t85, t87, t88, t89, t90, t91;
  double t92, t93, t95, t96, t99, t102, t103, t104;
  double t108, t109, t110, t111, t113, t117, t119, t120;
  double t121, t125, t129, tzk0;

  double t130, t131, t132, t133, t134, t137, t138, t142;
  double t143, t144, t147, t148, t150, t151, t155, t156;
  double t157, t159, t161, t164, t166, t167, t168, t169;
  double t170, t174, t178, t182, t186, t191, t193, t196;
  double t197, t201, t204, t206, tvrho0, t209, t210, t213;
  double t214, t219, t221, t224, t225, t229, t231, t232;
  double t236, t237, t239, t241, t244, t245, t246, t247;
  double t254, t261, t266, tvrho1, t276, t279, t287, t288;
  double t295, t299, tvsigma0, tvsigma1, t307, t310, t318, t319;
  double t326, t330, tvsigma2;

  double t333, t334, t335, t338, t339, t340, t342, t343;
  double t347, t348, t352, t354, t360, t361, t364, t366;
  double t369, t370, t374, t376, t378, t381, t385, t386;
  double t387, t388, t389, t390, t391, t392, t393, t398;
  double t399, t405, t406, t409, t416, t427, t429, t430;
  double t431, t432, t434, t439, t444, t445, t446, t447;
  double t451, t455, t456, t460, t462, t464, t467, t469;
  double tv2rho20, t472, t475, t476, t480, t481, t485, t487;
  double t495, t496, t499, t503, t504, t508, t510, t517;
  double t520, tv2rho21, t525, t529, t530, t534, t535, t541;
  double t542, t546, t550, t551, t561, t562, t566, t568;
  double t570, t573, t577, t578, t579, t580, t581, t586;
  double t591, t594, t611, t612, t614, t619, t624, tv2rho22;
  double t632, t637, t640, t643, t644, t649, t650, t662;
  double t676, t678, t683, t688, tv2rhosigma0, tv2rhosigma1, t695, t697;
  double tv2rhosigma2, t703, tv2rhosigma3, tv2rhosigma4, t712, t715, t718, t719;
  double t724, t725, t737, t751, t753, t758, t763, tv2rhosigma5;
  double t765, t773, t785, t796, t797, t806, t811, t815;
  double tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t823, t835, t846;
  double t847, t856, t861, t865, tv2sigma25;

  double t869, t870, t873, t876, t877, t878, t880, t881;
  double t885, t886, t890, t892, t897, t899, t902, t908;
  double t909, t912, t914, t917, t919, t924, t925, t926;
  double t927, t928, t929, t930, t931, t940, t944, t946;
  double t947, t951, t952, t954, t955, t957, t958, t962;
  double t963, t968, t980, t981, t982, t984, t986, t990;
  double t1002, t1004, t1005, t1009, t1011, t1012, t1016, t1019;
  double t1022, t1027, t1029, t1030, t1033, t1037, t1041, t1042;
  double t1046, t1048, t1050, t1052, t1054, t1057, t1059, tv3rho30;
  double t1062, t1063, t1064, t1067, t1072, t1073, t1074, t1075;
  double t1079, t1080, t1084, t1087, t1091, t1093, t1097, t1106;
  double t1107, t1108, t1111, t1117, t1121, t1122, t1126, t1129;
  double t1130, t1132, t1141, t1143, t1146, tv3rho31, t1149, t1154;
  double t1157, t1158, t1162, t1163, t1167, t1169, t1178, t1179;
  double t1184, t1188, t1192, t1193, t1197, t1199, t1206, t1214;
  double t1216, t1217, tv3rho32, t1222, t1228, t1229, t1233, t1234;
  double t1241, t1242, t1248, t1252, t1253, t1268, t1273, t1277;
  double t1279, t1280, t1288, t1289, t1290, t1291, t1297, t1298;
  double t1300, t1304, t1305, t1310, t1326, t1327, t1329, t1331;
  double t1335, t1344, t1345, t1349, t1351, t1352, t1356, t1359;
  double t1362, t1367, tv3rho33, t1375, t1382, t1384, t1389, t1393;
  double t1394, t1395, t1406, t1407, t1415, t1423, t1427, t1429;
  double t1432, t1434, t1439, t1440, t1442, t1458, t1463, tv3rho2sigma0;
  double tv3rho2sigma1, t1470, t1474, t1476, tv3rho2sigma2, t1482, t1490, tv3rho2sigma3;
  double tv3rho2sigma4, t1496, t1503, t1506, tv3rho2sigma5, t1514, tv3rho2sigma6, tv3rho2sigma7;
  double t1525, t1532, t1533, t1534, t1548, t1549, t1554, t1562;
  double t1566, t1568, t1571, t1573, t1578, t1579, t1581, t1597;
  double t1602, tv3rho2sigma8, t1609, t1612, t1630, t1633, t1634, t1643;
  double t1645, t1648, t1649, t1655, t1657, t1658, t1660, t1672;
  double t1677, tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1684, t1686;
  double tv3rhosigma25, t1692, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1697;
  double t1698, t1704, t1717, t1726, t1728, t1731, t1732, t1738;
  double t1740, t1741, t1743, t1759, t1764, tv3rhosigma211, t1767, t1771;
  double t1776, t1790, t1791, t1793, t1801, t1808, t1813, t1817;
  double tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37;
  double tv3sigma38, t1819, t1823, t1828, t1842, t1843, t1845, t1853;
  double t1860, t1865, t1869, tv3sigma39;

  double t1876, t1879, t1882, t1884, t1893, t1894, t1895, t1897;
  double t1901, t1906, t1907, t1912, t1917, t1918, t1933, t1944;
  double t1955, t1958, t1966, t1967, t1972, t1973, t1987, t1988;
  double t1990, t1994, t1996, t2002, t2010, t2016, t2021, t2023;
  double t2024, t2030, t2037, t2039, t2040, t2044, t2053, t2059;
  double t2061, t2065, t2069, t2073, t2076, t2080, t2081, t2082;
  double t2083, t2085, t2086, t2092, t2098, t2102, t2109, t2113;
  double t2117, t2122, t2124, tv4rho40, t2145, t2146, t2147, t2148;
  double t2152, t2161, t2167, t2168, t2170, t2183, t2187, t2191;
  double t2192, t2196, t2197, t2215, t2219, t2226, t2230, t2231;
  double t2234, t2243, t2246, t2247, t2249, t2251, t2252, tv4rho41;
  double t2267, t2280, t2284, t2293, t2306, t2310, t2317, t2318;
  double t2327, t2340, t2344, t2351, t2355, t2364, t2367, t2378;
  double t2381, t2383, t2384, tv4rho42, t2404, t2405, t2409, t2416;
  double t2427, t2428, t2445, t2449, t2456, t2464, t2473, t2483;
  double t2485, t2486, tv4rho43, t2491, t2496, t2502, t2503, t2507;
  double t2516, t2521, t2526, t2532, t2536, t2557, t2561, t2574;
  double t2576, t2580, t2585, t2586, t2596, t2601, t2606, t2618;
  double t2619, t2625, t2630, t2650, t2652, t2657, t2663, t2671;
  double t2674, t2683, t2684, tv4rho44, t2692, t2698, t2701, t2708;
  double t2710, t2713, t2715, t2727, t2741, t2765, t2794, t2819;
  double t2825, tv4rho3sigma0, tv4rho3sigma1, t2832, t2835, t2839, t2841, tv4rho3sigma2;
  double t2843, t2849, t2854, t2858, t2867, t2868, tv4rho3sigma3, tv4rho3sigma4;
  double t2870, t2876, t2878, t2887, t2889, t2892, tv4rho3sigma5, t2898;
  double t2907, tv4rho3sigma6, tv4rho3sigma7, t2913, t2920, t2928, t2930, t2931;
  double tv4rho3sigma8, t2940, tv4rho3sigma9, tv4rho3sigma10, t2957, t2971, t2977, t2990;
  double t3007, t3023, t3058, t3064, tv4rho3sigma11, t3071, t3078, t3080;
  double t3084, t3095, t3125, t3169, t3175, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22;
  double tv4rho2sigma23, tv4rho2sigma24, t3182, t3186, t3188, tv4rho2sigma25, t3194, t3202;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t3208, t3215, t3218;
  double tv4rho2sigma211, t3226, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t3259;
  double t3279, t3327, t3333, tv4rho2sigma217, t3340, t3381, t3402, t3421;
  double t3426, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36;
  double tv4rhosigma37, tv4rhosigma38, t3433, t3435, tv4rhosigma39, t3441, tv4rhosigma310, tv4rhosigma311;
  double tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t3490;
  double t3517, t3526, t3531, tv4rhosigma319, t3584, t3604, t3608, tv4sigma40;
  double tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48;
  double tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t3609, t3680, t3684;
  double tv4sigma414;

  gga_x_vmt84_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt84_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->mu * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t38 = t37 * t35;
  t39 = 0.1e1 / t38;
  t41 = params->alpha * t28;
  t42 = t33 * sigma[0];
  t43 = t42 * t39;
  t46 = exp(-t41 * t43 / 0.24e2);
  t49 = 0.1e1 + t29 * t43 / 0.24e2;
  t50 = 0.1e1 / t49;
  t51 = t46 * t50;
  t55 = t28 * t28;
  t56 = params->alpha * t55;
  t58 = 0.1e1 / t31 / t30;
  t59 = sigma[0] * sigma[0];
  t60 = t58 * t59;
  t61 = t35 * t35;
  t62 = t61 * rho[0];
  t64 = 0.1e1 / t36 / t62;
  t68 = exp(-t56 * t60 * t64 / 0.576e3);
  t70 = (0.1e1 - t68) * t55;
  t71 = 0.1e1 / sigma[0];
  t72 = t32 * t71;
  t76 = t34 * sigma[0] * t39 * t51 / 0.24e2 + 0.4e1 * t70 * t72 * t38 + t68;
  t80 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t76);
  t81 = rho[1] <= p->dens_threshold;
  t82 = my_piecewise5(t14, t11, t10, t15, -t17);
  t83 = 0.1e1 + t82;
  t84 = t83 <= p->zeta_threshold;
  t85 = POW_1_3(t83);
  t87 = my_piecewise3(t84, t22, t85 * t83);
  t88 = t87 * t26;
  t89 = rho[1] * rho[1];
  t90 = POW_1_3(rho[1]);
  t91 = t90 * t90;
  t92 = t91 * t89;
  t93 = 0.1e1 / t92;
  t95 = t33 * sigma[2];
  t96 = t95 * t93;
  t99 = exp(-t41 * t96 / 0.24e2);
  t102 = 0.1e1 + t29 * t96 / 0.24e2;
  t103 = 0.1e1 / t102;
  t104 = t99 * t103;
  t108 = sigma[2] * sigma[2];
  t109 = t58 * t108;
  t110 = t89 * t89;
  t111 = t110 * rho[1];
  t113 = 0.1e1 / t90 / t111;
  t117 = exp(-t56 * t109 * t113 / 0.576e3);
  t119 = (0.1e1 - t117) * t55;
  t120 = 0.1e1 / sigma[2];
  t121 = t32 * t120;
  t125 = t34 * sigma[2] * t93 * t104 / 0.24e2 + 0.4e1 * t119 * t121 * t92 + t117;
  t129 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t125);
  tzk0 = t80 + t129;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t130 = t6 * t6;
  t131 = 0.1e1 / t130;
  t132 = t16 * t131;
  t133 = t7 - t132;
  t134 = my_piecewise5(t10, 0, t14, 0, t133);
  t137 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t134);
  t138 = t137 * t26;
  t142 = t26 * t26;
  t143 = 0.1e1 / t142;
  t144 = t25 * t143;
  t147 = t5 * t144 * t76 / 0.8e1;
  t148 = t35 * rho[0];
  t150 = 0.1e1 / t37 / t148;
  t151 = sigma[0] * t150;
  t155 = params->mu * t55;
  t156 = t155 * t60;
  t157 = t61 * t35;
  t159 = 0.1e1 / t36 / t157;
  t161 = t159 * params->alpha * t51;
  t164 = params->mu * params->mu;
  t166 = t164 * t55 * t58;
  t167 = t59 * t159;
  t168 = t49 * t49;
  t169 = 0.1e1 / t168;
  t170 = t46 * t169;
  t174 = t41 * t33;
  t178 = t37 * rho[0];
  t182 = t56 * t58;
  t186 = -t34 * t151 * t51 / 0.9e1 + t156 * t161 / 0.216e3 + t166 * t167 * t170 / 0.216e3 - 0.2e1 / 0.9e1 * t174 * t151 * t68 + 0.32e2 / 0.3e1 * t70 * t72 * t178 + t182 * t167 * t68 / 0.108e3;
  t191 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t76 - t147 - 0.3e1 / 0.8e1 * t5 * t27 * t186);
  t193 = my_piecewise5(t14, 0, t10, 0, -t133);
  t196 = my_piecewise3(t84, 0, 0.4e1 / 0.3e1 * t85 * t193);
  t197 = t196 * t26;
  t201 = t87 * t143;
  t204 = t5 * t201 * t125 / 0.8e1;
  t206 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t197 * t125 - t204);
  tvrho0 = t80 + t129 + t6 * (t191 + t206);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t209 = -t7 - t132;
  t210 = my_piecewise5(t10, 0, t14, 0, t209);
  t213 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t210);
  t214 = t213 * t26;
  t219 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t214 * t76 - t147);
  t221 = my_piecewise5(t14, 0, t10, 0, -t209);
  t224 = my_piecewise3(t84, 0, 0.4e1 / 0.3e1 * t85 * t221);
  t225 = t224 * t26;
  t229 = t89 * rho[1];
  t231 = 0.1e1 / t91 / t229;
  t232 = sigma[2] * t231;
  t236 = t155 * t109;
  t237 = t110 * t89;
  t239 = 0.1e1 / t90 / t237;
  t241 = t239 * params->alpha * t104;
  t244 = t108 * t239;
  t245 = t102 * t102;
  t246 = 0.1e1 / t245;
  t247 = t99 * t246;
  t254 = t91 * rho[1];
  t261 = -t34 * t232 * t104 / 0.9e1 + t236 * t241 / 0.216e3 + t166 * t244 * t247 / 0.216e3 - 0.2e1 / 0.9e1 * t174 * t232 * t117 + 0.32e2 / 0.3e1 * t119 * t121 * t254 + t182 * t244 * t117 / 0.108e3;
  t266 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t225 * t125 - t204 - 0.3e1 / 0.8e1 * t5 * t88 * t261);
  tvrho1 = t80 + t129 + t6 * (t219 + t266);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t276 = t64 * params->alpha * t51;
  t279 = sigma[0] * t64;
  t287 = 0.1e1 / t59;
  t288 = t32 * t287;
  t295 = t34 * t39 * t46 * t50 / 0.24e2 - t155 * t58 * sigma[0] * t276 / 0.576e3 - t166 * t279 * t170 / 0.576e3 + t41 * t33 * t39 * t68 / 0.12e2 - 0.4e1 * t70 * t288 * t38 - t182 * t279 * t68 / 0.288e3;
  t299 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t295);
  tvsigma0 = t6 * t299;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t307 = t113 * params->alpha * t104;
  t310 = sigma[2] * t113;
  t318 = 0.1e1 / t108;
  t319 = t32 * t318;
  t326 = t34 * t93 * t99 * t103 / 0.24e2 - t155 * t58 * sigma[2] * t307 / 0.576e3 - t166 * t310 * t247 / 0.576e3 + t41 * t33 * t93 * t117 / 0.12e2 - 0.4e1 * t119 * t319 * t92 - t182 * t310 * t117 / 0.288e3;
  t330 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t326);
  tvsigma2 = t6 * t330;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t333 = t23 * t23;
  t334 = 0.1e1 / t333;
  t335 = t134 * t134;
  t338 = t130 * t6;
  t339 = 0.1e1 / t338;
  t340 = t16 * t339;
  t342 = -0.2e1 * t131 + 0.2e1 * t340;
  t343 = my_piecewise5(t10, 0, t14, 0, t342);
  t347 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t334 * t335 + 0.4e1 / 0.3e1 * t23 * t343);
  t348 = t347 * t26;
  t352 = t137 * t143;
  t354 = t5 * t352 * t76;
  t360 = 0.1e1 / t142 / t6;
  t361 = t25 * t360;
  t364 = t5 * t361 * t76 / 0.12e2;
  t366 = t5 * t144 * t186;
  t369 = 0.1e1 / t37 / t61;
  t370 = sigma[0] * t369;
  t374 = t61 * t148;
  t376 = 0.1e1 / t36 / t374;
  t378 = t376 * params->alpha * t51;
  t381 = t59 * t376;
  t385 = t30 * t30;
  t386 = 0.1e1 / t385;
  t387 = params->mu * t386;
  t388 = t59 * sigma[0];
  t389 = t387 * t388;
  t390 = t61 * t61;
  t391 = t390 * t35;
  t392 = 0.1e1 / t391;
  t393 = params->alpha * params->alpha;
  t398 = t164 * t386;
  t399 = t398 * t388;
  t405 = t164 * params->mu * t386;
  t406 = t405 * t388;
  t409 = 0.1e1 / t168 / t49;
  t416 = t393 * t386;
  t427 = t393 * t28;
  t429 = 0.1e1 / t32 / t385;
  t430 = t427 * t429;
  t431 = t59 * t59;
  t432 = t390 * t61;
  t434 = 0.1e1 / t37 / t432;
  t439 = 0.11e2 / 0.27e2 * t34 * t370 * t51 - t156 * t378 / 0.24e2 - t166 * t381 * t170 / 0.24e2 + t389 * t392 * t393 * t51 / 0.324e3 + t399 * t392 * params->alpha * t170 / 0.162e3 + t406 * t392 * t46 * t409 / 0.162e3 + 0.2e1 / 0.9e1 * t174 * t370 * t68 - t416 * t388 * t392 * t68 / 0.81e2 + 0.16e3 / 0.9e1 * t70 * t72 * t37 - 0.19e2 / 0.324e3 * t182 * t381 * t68 + t430 * t431 * t434 * t68 / 0.1944e4;
  t444 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t348 * t76 - t354 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t186 + t364 - t366 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t439);
  t445 = t85 * t85;
  t446 = 0.1e1 / t445;
  t447 = t193 * t193;
  t451 = my_piecewise5(t14, 0, t10, 0, -t342);
  t455 = my_piecewise3(t84, 0, 0.4e1 / 0.9e1 * t446 * t447 + 0.4e1 / 0.3e1 * t85 * t451);
  t456 = t455 * t26;
  t460 = t196 * t143;
  t462 = t5 * t460 * t125;
  t464 = t87 * t360;
  t467 = t5 * t464 * t125 / 0.12e2;
  t469 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t456 * t125 - t462 / 0.4e1 + t467);
  tv2rho20 = 0.2e1 * t191 + 0.2e1 * t206 + t6 * (t444 + t469);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t472 = t334 * t210;
  t475 = 0.2e1 * t340;
  t476 = my_piecewise5(t10, 0, t14, 0, t475);
  t480 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t472 * t134 + 0.4e1 / 0.3e1 * t23 * t476);
  t481 = t480 * t26;
  t485 = t213 * t143;
  t487 = t5 * t485 * t76;
  t495 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t481 * t76 - t487 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t214 * t186 - t354 / 0.8e1 + t364 - t366 / 0.8e1);
  t496 = t446 * t221;
  t499 = my_piecewise5(t14, 0, t10, 0, -t475);
  t503 = my_piecewise3(t84, 0, 0.4e1 / 0.9e1 * t496 * t193 + 0.4e1 / 0.3e1 * t85 * t499);
  t504 = t503 * t26;
  t508 = t224 * t143;
  t510 = t5 * t508 * t125;
  t517 = t5 * t201 * t261;
  t520 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t504 * t125 - t510 / 0.8e1 - t462 / 0.8e1 + t467 - 0.3e1 / 0.8e1 * t5 * t197 * t261 - t517 / 0.8e1);
  tv2rho21 = t191 + t206 + t219 + t266 + t6 * (t495 + t520);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t525 = t210 * t210;
  t529 = 0.2e1 * t131 + 0.2e1 * t340;
  t530 = my_piecewise5(t10, 0, t14, 0, t529);
  t534 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t334 * t525 + 0.4e1 / 0.3e1 * t23 * t530);
  t535 = t534 * t26;
  t541 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t535 * t76 - t487 / 0.4e1 + t364);
  t542 = t221 * t221;
  t546 = my_piecewise5(t14, 0, t10, 0, -t529);
  t550 = my_piecewise3(t84, 0, 0.4e1 / 0.9e1 * t446 * t542 + 0.4e1 / 0.3e1 * t85 * t546);
  t551 = t550 * t26;
  t561 = 0.1e1 / t91 / t110;
  t562 = sigma[2] * t561;
  t566 = t110 * t229;
  t568 = 0.1e1 / t90 / t566;
  t570 = t568 * params->alpha * t104;
  t573 = t108 * t568;
  t577 = t108 * sigma[2];
  t578 = t387 * t577;
  t579 = t110 * t110;
  t580 = t579 * t89;
  t581 = 0.1e1 / t580;
  t586 = t398 * t577;
  t591 = t405 * t577;
  t594 = 0.1e1 / t245 / t102;
  t611 = t108 * t108;
  t612 = t579 * t110;
  t614 = 0.1e1 / t91 / t612;
  t619 = 0.11e2 / 0.27e2 * t34 * t562 * t104 - t236 * t570 / 0.24e2 - t166 * t573 * t247 / 0.24e2 + t578 * t581 * t393 * t104 / 0.324e3 + t586 * t581 * params->alpha * t247 / 0.162e3 + t591 * t581 * t99 * t594 / 0.162e3 + 0.2e1 / 0.9e1 * t174 * t562 * t117 - t416 * t577 * t581 * t117 / 0.81e2 + 0.16e3 / 0.9e1 * t119 * t121 * t91 - 0.19e2 / 0.324e3 * t182 * t573 * t117 + t430 * t611 * t614 * t117 / 0.1944e4;
  t624 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t551 * t125 - t510 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t225 * t261 + t467 - t517 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t88 * t619);
  tv2rho22 = 0.2e1 * t219 + 0.2e1 * t266 + t6 * (t541 + t624);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t632 = t5 * t144 * t295 / 0.8e1;
  t637 = t58 * t159;
  t640 = params->alpha * sigma[0] * t51;
  t643 = t159 * t46;
  t644 = t169 * sigma[0];
  t649 = t390 * rho[0];
  t650 = 0.1e1 / t649;
  t662 = t650 * t46 * t409;
  t676 = t390 * t148;
  t678 = 0.1e1 / t37 / t676;
  t683 = -t34 * t150 * t46 * t50 / 0.9e1 + t155 * t637 * t640 / 0.72e2 + t166 * t643 * t644 / 0.72e2 - t387 * t59 * t650 * t393 * t51 / 0.864e3 - t398 * t59 * t650 * params->alpha * t170 / 0.432e3 - t405 * t59 * t662 / 0.432e3 + t416 * t650 * t59 * t68 / 0.216e3 - 0.32e2 / 0.3e1 * t70 * t288 * t178 + t182 * sigma[0] * t159 * t68 / 0.54e2 - t430 * t388 * t678 * t68 / 0.5184e4;
  t688 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t295 - t632 - 0.3e1 / 0.8e1 * t5 * t27 * t683);
  tv2rhosigma0 = t6 * t688 + t299;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t695 = t5 * t201 * t326 / 0.8e1;
  t697 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t197 * t326 - t695);
  tv2rhosigma2 = t6 * t697 + t330;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t703 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t214 * t295 - t632);
  tv2rhosigma3 = t6 * t703 + t299;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t712 = t58 * t239;
  t715 = params->alpha * sigma[2] * t104;
  t718 = t239 * t99;
  t719 = t246 * sigma[2];
  t724 = t579 * rho[1];
  t725 = 0.1e1 / t724;
  t737 = t725 * t99 * t594;
  t751 = t579 * t229;
  t753 = 0.1e1 / t91 / t751;
  t758 = -t34 * t231 * t99 * t103 / 0.9e1 + t155 * t712 * t715 / 0.72e2 + t166 * t718 * t719 / 0.72e2 - t387 * t108 * t725 * t393 * t104 / 0.864e3 - t398 * t108 * t725 * params->alpha * t247 / 0.432e3 - t405 * t108 * t737 / 0.432e3 + t416 * t725 * t108 * t117 / 0.216e3 - 0.32e2 / 0.3e1 * t119 * t319 * t254 + t182 * sigma[2] * t239 * t117 / 0.54e2 - t430 * t577 * t753 * t117 / 0.5184e4;
  t763 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t225 * t326 - t695 - 0.3e1 / 0.8e1 * t5 * t88 * t758);
  tv2rhosigma5 = t6 * t763 + t330;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t765 = t155 * t58;
  t773 = 0.1e1 / t390;
  t785 = t773 * t46 * t409;
  t796 = 0.1e1 / t388;
  t797 = t32 * t796;
  t806 = 0.1e1 / t37 / t391;
  t811 = -t765 * t276 / 0.288e3 - t166 * t64 * t46 * t169 / 0.288e3 + t387 * sigma[0] * t773 * t393 * t51 / 0.2304e4 + t398 * sigma[0] * t773 * params->alpha * t170 / 0.1152e4 + t405 * sigma[0] * t785 / 0.1152e4 - t416 * t773 * sigma[0] * t68 / 0.576e3 - t174 * t71 * t39 * t68 / 0.12e2 + 0.8e1 * t70 * t797 * t38 - t56 * t58 * t64 * t68 / 0.288e3 + t430 * t59 * t806 * t68 / 0.13824e5;
  t815 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t811);
  tv2sigma20 = t6 * t815;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t823 = 0.1e1 / t579;
  t835 = t823 * t99 * t594;
  t846 = 0.1e1 / t577;
  t847 = t32 * t846;
  t856 = 0.1e1 / t91 / t580;
  t861 = -t765 * t307 / 0.288e3 - t166 * t113 * t99 * t246 / 0.288e3 + t387 * sigma[2] * t823 * t393 * t104 / 0.2304e4 + t398 * sigma[2] * t823 * params->alpha * t247 / 0.1152e4 + t405 * sigma[2] * t835 / 0.1152e4 - t416 * t823 * sigma[2] * t117 / 0.576e3 - t174 * t120 * t93 * t117 / 0.12e2 + 0.8e1 * t119 * t847 * t92 - t56 * t58 * t113 * t117 / 0.288e3 + t430 * t108 * t856 * t117 / 0.13824e5;
  t865 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t861);
  tv2sigma25 = t6 * t865;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t869 = 0.1e1 / t333 / t19;
  t870 = t335 * t134;
  t873 = t334 * t134;
  t876 = t130 * t130;
  t877 = 0.1e1 / t876;
  t878 = t16 * t877;
  t880 = 0.6e1 * t339 - 0.6e1 * t878;
  t881 = my_piecewise5(t10, 0, t14, 0, t880);
  t885 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t869 * t870 + 0.4e1 / 0.3e1 * t873 * t343 + 0.4e1 / 0.3e1 * t23 * t881);
  t886 = t885 * t26;
  t890 = t347 * t143;
  t892 = t5 * t890 * t76;
  t897 = t137 * t360;
  t899 = t5 * t897 * t76;
  t902 = t5 * t352 * t186;
  t908 = 0.1e1 / t142 / t130;
  t909 = t25 * t908;
  t912 = 0.5e1 / 0.36e2 * t5 * t909 * t76;
  t914 = t5 * t361 * t186;
  t917 = t5 * t144 * t439;
  t919 = 0.1e1 / t676;
  t924 = t393 * params->alpha;
  t925 = t385 * t385;
  t926 = 0.1e1 / t925;
  t927 = t924 * t926;
  t928 = t431 * t59;
  t929 = t390 * t390;
  t930 = t929 * t148;
  t931 = 0.1e1 / t930;
  t940 = 0.1e1 / t36;
  t944 = t390 * t62;
  t946 = 0.1e1 / t37 / t944;
  t947 = t431 * t946;
  t951 = t164 * t164;
  t952 = t951 * t386;
  t954 = t168 * t168;
  t955 = 0.1e1 / t954;
  t957 = t28 * t33;
  t958 = t46 * t955 * t957;
  t962 = 0.1e1 / t37 / t62;
  t963 = sigma[0] * t962;
  t968 = 0.1e1 / t36 / t390;
  t980 = t924 * t386;
  t981 = t431 * sigma[0];
  t982 = t980 * t981;
  t984 = 0.1e1 / t36 / t929;
  t986 = t58 * t68;
  t990 = t59 * t968;
  t1002 = t924 * t28;
  t1004 = t33 * t46 * t50;
  t1005 = t1002 * t1004;
  t1009 = t393 * t46;
  t1011 = t169 * t28 * t33;
  t1012 = t1009 * t1011;
  t1016 = params->alpha * t46;
  t1019 = t1016 * t409 * t28 * t33;
  t1022 = 0.11e2 / 0.81e2 * t416 * t388 * t919 * t68 + t927 * t928 * t931 * t68 / 0.34992e5 - 0.19e2 / 0.162e3 * t406 * t919 * t46 * t409 + 0.32e3 / 0.27e2 * t70 * t72 * t940 - 0.19e2 / 0.1944e4 * t430 * t947 * t68 + t952 * t947 * t958 / 0.486e3 - 0.154e3 / 0.81e2 * t34 * t963 * t51 + 0.341e3 / 0.972e3 * t156 * t968 * params->alpha * t51 - 0.19e2 / 0.162e3 * t399 * t919 * params->alpha * t170 - 0.164e3 / 0.81e2 * t174 * t963 * t68 - t982 * t984 * t55 * t986 / 0.8748e4 + 0.209e3 / 0.486e3 * t182 * t990 * t68 + 0.341e3 / 0.972e3 * t166 * t990 * t170 - 0.19e2 / 0.324e3 * t389 * t919 * t393 * t51 + t387 * t947 * t1005 / 0.2916e4 + t398 * t947 * t1012 / 0.972e3 + t405 * t947 * t1019 / 0.486e3;
  t1027 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t886 * t76 - 0.3e1 / 0.8e1 * t892 - 0.9e1 / 0.8e1 * t5 * t348 * t186 + t899 / 0.4e1 - 0.3e1 / 0.4e1 * t902 - 0.9e1 / 0.8e1 * t5 * t138 * t439 - t912 + t914 / 0.4e1 - 0.3e1 / 0.8e1 * t917 - 0.3e1 / 0.8e1 * t5 * t27 * t1022);
  t1029 = 0.1e1 / t445 / t83;
  t1030 = t447 * t193;
  t1033 = t446 * t193;
  t1037 = my_piecewise5(t14, 0, t10, 0, -t880);
  t1041 = my_piecewise3(t84, 0, -0.8e1 / 0.27e2 * t1029 * t1030 + 0.4e1 / 0.3e1 * t1033 * t451 + 0.4e1 / 0.3e1 * t85 * t1037);
  t1042 = t1041 * t26;
  t1046 = t455 * t143;
  t1048 = t5 * t1046 * t125;
  t1050 = t196 * t360;
  t1052 = t5 * t1050 * t125;
  t1054 = t87 * t908;
  t1057 = 0.5e1 / 0.36e2 * t5 * t1054 * t125;
  t1059 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t1042 * t125 - 0.3e1 / 0.8e1 * t1048 + t1052 / 0.4e1 - t1057);
  tv3rho30 = 0.3e1 * t444 + 0.3e1 * t469 + t6 * (t1027 + t1059);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1062 = 0.2e1 * t495;
  t1063 = 0.2e1 * t520;
  t1064 = t869 * t210;
  t1067 = t334 * t476;
  t1072 = 0.2e1 * t339;
  t1073 = 0.6e1 * t878;
  t1074 = t1072 - t1073;
  t1075 = my_piecewise5(t10, 0, t14, 0, t1074);
  t1079 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1064 * t335 + 0.8e1 / 0.9e1 * t1067 * t134 + 0.4e1 / 0.9e1 * t472 * t343 + 0.4e1 / 0.3e1 * t23 * t1075);
  t1080 = t1079 * t26;
  t1084 = t480 * t143;
  t1087 = t5 * t1084 * t76 / 0.4e1;
  t1091 = t213 * t360;
  t1093 = t5 * t1091 * t76;
  t1097 = t5 * t485 * t186 / 0.4e1;
  t1106 = -0.3e1 / 0.8e1 * t5 * t1080 * t76 - t1087 - 0.3e1 / 0.4e1 * t5 * t481 * t186 + t1093 / 0.12e2 - t1097 - 0.3e1 / 0.8e1 * t5 * t214 * t439 - t892 / 0.8e1 + t899 / 0.6e1 - t902 / 0.4e1 - t912 + t914 / 0.6e1 - t917 / 0.8e1;
  t1107 = my_piecewise3(t1, 0, t1106);
  t1108 = t1029 * t221;
  t1111 = t446 * t499;
  t1117 = my_piecewise5(t14, 0, t10, 0, -t1074);
  t1121 = my_piecewise3(t84, 0, -0.8e1 / 0.27e2 * t1108 * t447 + 0.8e1 / 0.9e1 * t1111 * t193 + 0.4e1 / 0.9e1 * t496 * t451 + 0.4e1 / 0.3e1 * t85 * t1117);
  t1122 = t1121 * t26;
  t1126 = t503 * t143;
  t1129 = t5 * t1126 * t125 / 0.4e1;
  t1130 = t224 * t360;
  t1132 = t5 * t1130 * t125;
  t1141 = t5 * t460 * t261 / 0.4e1;
  t1143 = t5 * t464 * t261;
  t1146 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t1122 * t125 - t1129 + t1132 / 0.12e2 - t1048 / 0.8e1 + t1052 / 0.6e1 - t1057 - 0.3e1 / 0.8e1 * t5 * t456 * t261 - t1141 + t1143 / 0.12e2);
  tv3rho31 = t444 + t469 + t1062 + t1063 + t6 * (t1107 + t1146);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1149 = t869 * t525;
  t1154 = t334 * t530;
  t1157 = -t1072 - t1073;
  t1158 = my_piecewise5(t10, 0, t14, 0, t1157);
  t1162 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1149 * t134 + 0.8e1 / 0.9e1 * t472 * t476 + 0.4e1 / 0.9e1 * t1154 * t134 + 0.4e1 / 0.3e1 * t23 * t1158);
  t1163 = t1162 * t26;
  t1167 = t534 * t143;
  t1169 = t5 * t1167 * t76;
  t1178 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1163 * t76 - t1169 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t535 * t186 - t1087 + t1093 / 0.6e1 - t1097 + t899 / 0.12e2 - t912 + t914 / 0.12e2);
  t1179 = t1029 * t542;
  t1184 = t446 * t546;
  t1188 = my_piecewise5(t14, 0, t10, 0, -t1157);
  t1192 = my_piecewise3(t84, 0, -0.8e1 / 0.27e2 * t1179 * t193 + 0.8e1 / 0.9e1 * t496 * t499 + 0.4e1 / 0.9e1 * t1184 * t193 + 0.4e1 / 0.3e1 * t85 * t1188);
  t1193 = t1192 * t26;
  t1197 = t550 * t143;
  t1199 = t5 * t1197 * t125;
  t1206 = t5 * t508 * t261;
  t1214 = t5 * t201 * t619;
  t1216 = -0.3e1 / 0.8e1 * t5 * t1193 * t125 - t1199 / 0.8e1 - t1129 + t1132 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t504 * t261 - t1206 / 0.4e1 + t1052 / 0.12e2 - t1057 - t1141 + t1143 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t197 * t619 - t1214 / 0.8e1;
  t1217 = my_piecewise3(t81, 0, t1216);
  tv3rho32 = t1062 + t1063 + t541 + t624 + t6 * (t1178 + t1217);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1222 = t525 * t210;
  t1228 = -0.6e1 * t339 - 0.6e1 * t878;
  t1229 = my_piecewise5(t10, 0, t14, 0, t1228);
  t1233 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t869 * t1222 + 0.4e1 / 0.3e1 * t472 * t530 + 0.4e1 / 0.3e1 * t23 * t1229);
  t1234 = t1233 * t26;
  t1241 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1234 * t76 - 0.3e1 / 0.8e1 * t1169 + t1093 / 0.4e1 - t912);
  t1242 = t542 * t221;
  t1248 = my_piecewise5(t14, 0, t10, 0, -t1228);
  t1252 = my_piecewise3(t84, 0, -0.8e1 / 0.27e2 * t1029 * t1242 + 0.4e1 / 0.3e1 * t496 * t546 + 0.4e1 / 0.3e1 * t85 * t1248);
  t1253 = t1252 * t26;
  t1268 = 0.1e1 / t751;
  t1273 = 0.1e1 / t90;
  t1277 = t579 * t111;
  t1279 = 0.1e1 / t91 / t1277;
  t1280 = t611 * t1279;
  t1288 = t611 * t108;
  t1289 = t579 * t579;
  t1290 = t1289 * t229;
  t1291 = 0.1e1 / t1290;
  t1297 = t245 * t245;
  t1298 = 0.1e1 / t1297;
  t1300 = t99 * t1298 * t957;
  t1304 = 0.1e1 / t91 / t111;
  t1305 = sigma[2] * t1304;
  t1310 = 0.1e1 / t90 / t579;
  t1326 = t611 * sigma[2];
  t1327 = t980 * t1326;
  t1329 = 0.1e1 / t90 / t1289;
  t1331 = t58 * t117;
  t1335 = t108 * t1310;
  t1344 = t33 * t99 * t103;
  t1345 = t1002 * t1344;
  t1349 = t393 * t99;
  t1351 = t246 * t28 * t33;
  t1352 = t1349 * t1351;
  t1356 = params->alpha * t99;
  t1359 = t1356 * t594 * t28 * t33;
  t1362 = -0.19e2 / 0.162e3 * t591 * t1268 * t99 * t594 + 0.32e3 / 0.27e2 * t119 * t121 * t1273 - 0.19e2 / 0.1944e4 * t430 * t1280 * t117 + 0.11e2 / 0.81e2 * t416 * t577 * t1268 * t117 + t927 * t1288 * t1291 * t117 / 0.34992e5 + t952 * t1280 * t1300 / 0.486e3 - 0.154e3 / 0.81e2 * t34 * t1305 * t104 + 0.341e3 / 0.972e3 * t236 * t1310 * params->alpha * t104 - 0.19e2 / 0.324e3 * t578 * t1268 * t393 * t104 - 0.19e2 / 0.162e3 * t586 * t1268 * params->alpha * t247 - 0.164e3 / 0.81e2 * t174 * t1305 * t117 - t1327 * t1329 * t55 * t1331 / 0.8748e4 + 0.209e3 / 0.486e3 * t182 * t1335 * t117 + 0.341e3 / 0.972e3 * t166 * t1335 * t247 + t387 * t1280 * t1345 / 0.2916e4 + t398 * t1280 * t1352 / 0.972e3 + t405 * t1280 * t1359 / 0.486e3;
  t1367 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t1253 * t125 - 0.3e1 / 0.8e1 * t1199 - 0.9e1 / 0.8e1 * t5 * t551 * t261 + t1132 / 0.4e1 - 0.3e1 / 0.4e1 * t1206 - 0.9e1 / 0.8e1 * t5 * t225 * t619 - t1057 + t1143 / 0.4e1 - 0.3e1 / 0.8e1 * t1214 - 0.3e1 / 0.8e1 * t5 * t88 * t1362);
  tv3rho33 = 0.3e1 * t541 + 0.3e1 * t624 + t6 * (t1241 + t1367);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1375 = t5 * t352 * t295;
  t1382 = t5 * t361 * t295 / 0.12e2;
  t1384 = t5 * t144 * t683;
  t1389 = t388 * t434;
  t1393 = t405 * t392;
  t1394 = t46 * t409;
  t1395 = t1394 * t59;
  t1406 = t929 * t35;
  t1407 = 0.1e1 / t1406;
  t1415 = t58 * t376;
  t1423 = t376 * t46;
  t1427 = t387 * t392;
  t1429 = t393 * t59 * t51;
  t1432 = t398 * t392;
  t1434 = params->alpha * t59 * t170;
  t1439 = 0.1e1 / t36 / t390 / t374;
  t1440 = t980 * t1439;
  t1442 = t431 * t55 * t986;
  t1458 = -0.16e3 / 0.9e1 * t70 * t288 * t37 + 0.17e2 / 0.5184e4 * t430 * t1389 * t68 + 0.17e2 / 0.432e3 * t1393 * t1395 - t416 * t392 * t59 * t68 / 0.24e2 + 0.16e2 / 0.27e2 * t41 * t33 * t369 * t68 - t927 * t981 * t1407 * t68 / 0.93312e5 - t952 * t1389 * t958 / 0.1296e4 - 0.65e2 / 0.648e3 * t155 * t1415 * t640 + 0.11e2 / 0.27e2 * t34 * t369 * t46 * t50 - 0.65e2 / 0.648e3 * t166 * t1423 * t644 + 0.17e2 / 0.864e3 * t1427 * t1429 + 0.17e2 / 0.432e3 * t1432 * t1434 + t1440 * t1442 / 0.23328e5 - 0.19e2 / 0.162e3 * t182 * sigma[0] * t376 * t68 - t387 * t1389 * t1005 / 0.7776e4 - t398 * t1389 * t1012 / 0.2592e4 - t405 * t1389 * t1019 / 0.1296e4;
  t1463 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t348 * t295 - t1375 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t683 + t1382 - t1384 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1458);
  tv3rho2sigma0 = t6 * t1463 + 0.2e1 * t688;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1470 = t5 * t460 * t326;
  t1474 = t5 * t464 * t326 / 0.12e2;
  t1476 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t456 * t326 - t1470 / 0.4e1 + t1474);
  tv3rho2sigma2 = t6 * t1476 + 0.2e1 * t697;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1482 = t5 * t485 * t295;
  t1490 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t481 * t295 - t1482 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t214 * t683 - t1375 / 0.8e1 + t1382 - t1384 / 0.8e1);
  tv3rho2sigma3 = t6 * t1490 + t688 + t703;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1496 = t5 * t508 * t326;
  t1503 = t5 * t201 * t758;
  t1506 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t504 * t326 - t1496 / 0.8e1 - t1470 / 0.8e1 + t1474 - 0.3e1 / 0.8e1 * t5 * t197 * t758 - t1503 / 0.8e1);
  tv3rho2sigma5 = t6 * t1506 + t697 + t763;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1514 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t535 * t295 - t1482 / 0.4e1 + t1382);
  tv3rho2sigma6 = t6 * t1514 + 0.2e1 * t703;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1525 = t577 * t614;
  t1532 = t405 * t581;
  t1533 = t99 * t594;
  t1534 = t1533 * t108;
  t1548 = t1289 * t89;
  t1549 = 0.1e1 / t1548;
  t1554 = t58 * t568;
  t1562 = t568 * t99;
  t1566 = t387 * t581;
  t1568 = t393 * t108 * t104;
  t1571 = t398 * t581;
  t1573 = params->alpha * t108 * t247;
  t1578 = 0.1e1 / t90 / t579 / t566;
  t1579 = t980 * t1578;
  t1581 = t611 * t55 * t1331;
  t1597 = -t952 * t1525 * t1300 / 0.1296e4 + 0.17e2 / 0.5184e4 * t430 * t1525 * t117 + 0.17e2 / 0.432e3 * t1532 * t1534 - t416 * t581 * t108 * t117 / 0.24e2 - 0.16e3 / 0.9e1 * t119 * t319 * t91 + 0.16e2 / 0.27e2 * t41 * t33 * t561 * t117 - t927 * t1326 * t1549 * t117 / 0.93312e5 - 0.65e2 / 0.648e3 * t155 * t1554 * t715 + 0.11e2 / 0.27e2 * t34 * t561 * t99 * t103 - 0.65e2 / 0.648e3 * t166 * t1562 * t719 + 0.17e2 / 0.864e3 * t1566 * t1568 + 0.17e2 / 0.432e3 * t1571 * t1573 + t1579 * t1581 / 0.23328e5 - 0.19e2 / 0.162e3 * t182 * sigma[2] * t568 * t117 - t405 * t1525 * t1359 / 0.1296e4 - t387 * t1525 * t1345 / 0.7776e4 - t398 * t1525 * t1352 / 0.2592e4;
  t1602 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t551 * t326 - t1496 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t225 * t758 + t1474 - t1503 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t88 * t1597);
  tv3rho2sigma8 = t6 * t1602 + 0.2e1 * t763;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1609 = t5 * t144 * t811 / 0.8e1;
  t1612 = t59 * t678;
  t1630 = t1394 * sigma[0];
  t1633 = t929 * rho[0];
  t1634 = 0.1e1 / t1633;
  t1643 = t387 * t650;
  t1645 = t393 * sigma[0] * t51;
  t1648 = t398 * t650;
  t1649 = t1016 * t644;
  t1655 = t390 * t157;
  t1657 = 0.1e1 / t36 / t1655;
  t1658 = t980 * t1657;
  t1660 = t388 * t55 * t986;
  t1672 = t765 * t161 / 0.54e2 + t952 * t1612 * t958 / 0.3456e4 + t416 * t650 * sigma[0] * t68 / 0.108e3 + 0.64e2 / 0.3e1 * t70 * t797 * t178 + t56 * t637 * t68 / 0.54e2 - 0.5e1 / 0.5184e4 * t430 * t1612 * t68 - 0.5e1 / 0.432e3 * t405 * t650 * t1630 + t927 * t431 * t1634 * t68 / 0.248832e6 - 0.2e1 / 0.9e1 * t174 * t71 * t150 * t68 - 0.5e1 / 0.864e3 * t1643 * t1645 - 0.5e1 / 0.432e3 * t1648 * t1649 + t166 * t643 * t169 / 0.54e2 - t1658 * t1660 / 0.62208e5 + t387 * t1612 * t1005 / 0.20736e5 + t398 * t1612 * t1012 / 0.6912e4 + t405 * t1612 * t1019 / 0.3456e4;
  t1677 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t811 - t1609 - 0.3e1 / 0.8e1 * t5 * t27 * t1672);
  tv3rhosigma20 = t6 * t1677 + t815;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1684 = t5 * t201 * t861 / 0.8e1;
  t1686 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t197 * t861 - t1684);
  tv3rhosigma25 = t6 * t1686 + t865;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1692 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t214 * t811 - t1609);
  tv3rhosigma26 = t6 * t1692 + t815;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1697 = t1289 * rho[1];
  t1698 = 0.1e1 / t1697;
  t1704 = t1533 * sigma[2];
  t1717 = t753 * t108;
  t1726 = t387 * t725;
  t1728 = t393 * sigma[2] * t104;
  t1731 = t398 * t725;
  t1732 = t1356 * t719;
  t1738 = t579 * t237;
  t1740 = 0.1e1 / t90 / t1738;
  t1741 = t980 * t1740;
  t1743 = t577 * t55 * t1331;
  t1759 = t927 * t611 * t1698 * t117 / 0.248832e6 - 0.5e1 / 0.432e3 * t405 * t725 * t1704 + t416 * t725 * sigma[2] * t117 / 0.108e3 + 0.64e2 / 0.3e1 * t119 * t847 * t254 + t56 * t712 * t117 / 0.54e2 - 0.5e1 / 0.5184e4 * t430 * t1717 * t117 + t765 * t241 / 0.54e2 + t952 * t1717 * t1300 / 0.3456e4 - 0.5e1 / 0.864e3 * t1726 * t1728 - 0.5e1 / 0.432e3 * t1731 * t1732 + t166 * t718 * t246 / 0.54e2 - t1741 * t1743 / 0.62208e5 - 0.2e1 / 0.9e1 * t174 * t120 * t231 * t117 + t387 * t1717 * t1345 / 0.20736e5 + t398 * t1717 * t1352 / 0.6912e4 + t405 * t1717 * t1359 / 0.3456e4;
  t1764 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t225 * t861 - t1684 - 0.3e1 / 0.8e1 * t5 * t88 * t1759);
  tv3rhosigma211 = t6 * t1764 + t865;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1767 = t1009 * t50;
  t1771 = t1016 * t169;
  t1776 = sigma[0] * t806;
  t1790 = 0.1e1 / t36 / t944;
  t1791 = t980 * t1790;
  t1793 = t59 * t55 * t986;
  t1801 = t32 / t431;
  t1808 = 0.1e1 / t929;
  t1813 = t387 * t773 * t1767 / 0.768e3 + t398 * t773 * t1771 / 0.384e3 + t405 * t785 / 0.384e3 - t387 * t1776 * t1005 / 0.55296e5 - t398 * t1776 * t1012 / 0.18432e5 - t405 * t1776 * t1019 / 0.9216e4 - t952 * t1776 * t958 / 0.9216e4 + t1791 * t1793 / 0.165888e6 + t174 * t287 * t39 * t68 / 0.4e1 - 0.24e2 * t70 * t1801 * t38 + t430 * t1776 * t68 / 0.4608e4 - t927 * t388 * t1808 * t68 / 0.663552e6;
  t1817 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1813);
  tv3sigma30 = t6 * t1817;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1819 = t1349 * t103;
  t1823 = t1356 * t246;
  t1828 = sigma[2] * t856;
  t1842 = 0.1e1 / t90 / t1277;
  t1843 = t980 * t1842;
  t1845 = t108 * t55 * t1331;
  t1853 = t32 / t611;
  t1860 = 0.1e1 / t1289;
  t1865 = t387 * t823 * t1819 / 0.768e3 + t398 * t823 * t1823 / 0.384e3 + t405 * t835 / 0.384e3 - t387 * t1828 * t1345 / 0.55296e5 - t398 * t1828 * t1352 / 0.18432e5 - t405 * t1828 * t1359 / 0.9216e4 - t952 * t1828 * t1300 / 0.9216e4 + t1843 * t1845 / 0.165888e6 + t174 * t318 * t93 * t117 / 0.4e1 - 0.24e2 * t119 * t1853 * t92 + t430 * t1828 * t117 / 0.4608e4 - t927 * t577 * t1860 * t117 / 0.663552e6;
  t1869 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t1865);
  tv3sigma39 = t6 * t1869;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1876 = t5 * t909 * t186;
  t1879 = t5 * t361 * t439;
  t1882 = t5 * t144 * t1022;
  t1884 = 0.1e1 / t432;
  t1893 = t393 * t393;
  t1894 = t1893 * t386;
  t1895 = t431 * t388;
  t1897 = t929 * t157;
  t1901 = t429 * t68;
  t1906 = 0.1e1 / t36 / t649;
  t1907 = t59 * t1906;
  t1912 = 0.1e1 / t36 / t1633;
  t1917 = t1893 * t926;
  t1918 = t431 * t431;
  t1933 = t431 / t37 / t1655;
  t1944 = t929 * t61;
  t1955 = 0.2563e4 / 0.2916e4 * t389 * t1884 * t393 * t51 + 0.2563e4 / 0.1458e4 * t399 * t1884 * params->alpha * t170 - t1894 * t1895 / t37 / t1897 * t28 * t1901 / 0.157464e6 - 0.5225e4 / 0.1458e4 * t182 * t1907 * t68 + 0.41e2 / 0.13122e5 * t982 * t1912 * t55 * t986 + t1917 * t1918 / t36 / t929 / t649 * t55 * t986 / 0.3779136e7 + 0.2563e4 / 0.1458e4 * t406 * t1884 * t46 * t409 + 0.2755e4 / 0.17496e5 * t430 * t1933 * t68 - 0.3047e4 / 0.972e3 * t166 * t1907 * t170 - 0.1171e4 / 0.729e3 * t416 * t388 * t1884 * t68 - 0.19e2 / 0.17496e5 * t927 * t928 / t1944 * t68 - 0.32e3 / 0.81e2 * t70 * t72 / t36 / rho[0];
  t1958 = sigma[0] / t37 / t157;
  t1966 = t951 * params->mu * t386;
  t1967 = t981 * t1912;
  t1972 = t55 * t58;
  t1973 = t46 / t954 / t49 * t1972;
  t1987 = t1893 * t55;
  t1988 = t58 * t46;
  t1990 = t1987 * t1988 * t50;
  t1994 = t924 * t55;
  t1996 = t1994 * t1988 * t169;
  t2002 = t1009 * t409 * t55 * t58;
  t2010 = t56 * t1988 * t955;
  t2016 = 0.292e3 / 0.27e2 * t174 * t1958 * t68 - 0.49e2 / 0.729e3 * t952 * t1933 * t958 + 0.2e1 / 0.2187e4 * t1966 * t1967 * t1973 + 0.2618e4 / 0.243e3 * t34 * t1958 * t51 - 0.3047e4 / 0.972e3 * t156 * t1906 * params->alpha * t51 - 0.49e2 / 0.4374e4 * t387 * t1933 * t1005 + t387 * t1967 * t1990 / 0.26244e5 + t398 * t1967 * t1996 / 0.6561e4 + t405 * t1967 * t2002 / 0.2187e4 - 0.49e2 / 0.729e3 * t405 * t1933 * t1019 + 0.2e1 / 0.2187e4 * t952 * t1967 * t2010 - 0.49e2 / 0.1458e4 * t398 * t1933 * t1012;
  t2021 = t19 * t19;
  t2023 = 0.1e1 / t333 / t2021;
  t2024 = t335 * t335;
  t2030 = t343 * t343;
  t2037 = t16 / t876 / t6;
  t2039 = -0.24e2 * t877 + 0.24e2 * t2037;
  t2040 = my_piecewise5(t10, 0, t14, 0, t2039);
  t2044 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2023 * t2024 - 0.16e2 / 0.9e1 * t869 * t335 * t343 + 0.4e1 / 0.3e1 * t334 * t2030 + 0.16e2 / 0.9e1 * t873 * t881 + 0.4e1 / 0.3e1 * t23 * t2040);
  t2053 = t5 * t890 * t186;
  t2059 = t5 * t897 * t186;
  t2061 = t5 * t352 * t439;
  t2065 = t5 * t885 * t143 * t76;
  t2069 = t5 * t347 * t360 * t76;
  t2073 = t5 * t137 * t908 * t76;
  t2076 = 0.1e1 / t142 / t338;
  t2080 = 0.1e2 / 0.27e2 * t5 * t25 * t2076 * t76;
  t2081 = -0.3e1 / 0.2e1 * t5 * t138 * t1022 - 0.5e1 / 0.9e1 * t1876 + t1879 / 0.2e1 - t1882 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t1955 + t2016) - 0.3e1 / 0.8e1 * t5 * t2044 * t26 * t76 - 0.3e1 / 0.2e1 * t5 * t886 * t186 - 0.3e1 / 0.2e1 * t2053 - 0.9e1 / 0.4e1 * t5 * t348 * t439 + t2059 - 0.3e1 / 0.2e1 * t2061 - t2065 / 0.2e1 + t2069 / 0.2e1 - 0.5e1 / 0.9e1 * t2073 + t2080;
  t2082 = my_piecewise3(t1, 0, t2081);
  t2083 = t83 * t83;
  t2085 = 0.1e1 / t445 / t2083;
  t2086 = t447 * t447;
  t2092 = t451 * t451;
  t2098 = my_piecewise5(t14, 0, t10, 0, -t2039);
  t2102 = my_piecewise3(t84, 0, 0.4e2 / 0.81e2 * t2085 * t2086 - 0.16e2 / 0.9e1 * t1029 * t447 * t451 + 0.4e1 / 0.3e1 * t446 * t2092 + 0.16e2 / 0.9e1 * t1033 * t1037 + 0.4e1 / 0.3e1 * t85 * t2098);
  t2109 = t5 * t1041 * t143 * t125;
  t2113 = t5 * t455 * t360 * t125;
  t2117 = t5 * t196 * t908 * t125;
  t2122 = 0.1e2 / 0.27e2 * t5 * t87 * t2076 * t125;
  t2124 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t2102 * t26 * t125 - t2109 / 0.2e1 + t2113 / 0.2e1 - 0.5e1 / 0.9e1 * t2117 + t2122);
  tv4rho40 = 0.4e1 * t1027 + 0.4e1 * t1059 + t6 * (t2082 + t2124);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2145 = 0.12e2 * t877;
  t2146 = 0.24e2 * t2037;
  t2147 = -t2145 + t2146;
  t2148 = my_piecewise5(t10, 0, t14, 0, t2147);
  t2152 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2023 * t210 * t870 - 0.8e1 / 0.9e1 * t869 * t476 * t335 - 0.8e1 / 0.9e1 * t1064 * t134 * t343 + 0.4e1 / 0.3e1 * t334 * t1075 * t134 + 0.4e1 / 0.3e1 * t1067 * t343 + 0.4e1 / 0.9e1 * t472 * t881 + 0.4e1 / 0.3e1 * t23 * t2148);
  t2161 = t5 * t1084 * t186;
  t2167 = t5 * t1091 * t186;
  t2168 = t2167 / 0.4e1;
  t2170 = t5 * t485 * t439;
  t2183 = t5 * t213 * t908 * t76;
  t2187 = t5 * t1079 * t143 * t76;
  t2191 = t5 * t480 * t360 * t76;
  t2192 = t2191 / 0.4e1;
  t2196 = -0.3e1 / 0.8e1 * t5 * t2152 * t26 * t76 - 0.9e1 / 0.8e1 * t5 * t1080 * t186 - 0.3e1 / 0.4e1 * t2161 - 0.9e1 / 0.8e1 * t5 * t481 * t439 + t2168 - 0.3e1 / 0.8e1 * t2170 - 0.3e1 / 0.8e1 * t5 * t214 * t1022 - 0.5e1 / 0.12e2 * t1876 + t1879 / 0.4e1 - t1882 / 0.8e1 - 0.3e1 / 0.8e1 * t2053 + t2059 / 0.2e1 - 0.3e1 / 0.8e1 * t2061 - 0.5e1 / 0.36e2 * t2183 - 0.3e1 / 0.8e1 * t2187 + t2192 - t2065 / 0.8e1 + t2069 / 0.4e1 - 0.5e1 / 0.12e2 * t2073 + t2080;
  t2197 = my_piecewise3(t1, 0, t2196);
  t2215 = my_piecewise5(t14, 0, t10, 0, -t2147);
  t2219 = my_piecewise3(t84, 0, 0.4e2 / 0.81e2 * t2085 * t221 * t1030 - 0.8e1 / 0.9e1 * t1029 * t499 * t447 - 0.8e1 / 0.9e1 * t1108 * t193 * t451 + 0.4e1 / 0.3e1 * t446 * t1117 * t193 + 0.4e1 / 0.3e1 * t1111 * t451 + 0.4e1 / 0.9e1 * t496 * t1037 + 0.4e1 / 0.3e1 * t85 * t2215);
  t2226 = t5 * t1121 * t143 * t125;
  t2230 = t5 * t503 * t360 * t125;
  t2231 = t2230 / 0.4e1;
  t2234 = t5 * t224 * t908 * t125;
  t2243 = t5 * t1046 * t261;
  t2246 = t5 * t1050 * t261;
  t2247 = t2246 / 0.4e1;
  t2249 = t5 * t1054 * t261;
  t2251 = -0.3e1 / 0.8e1 * t5 * t2219 * t26 * t125 - 0.3e1 / 0.8e1 * t2226 + t2231 - 0.5e1 / 0.36e2 * t2234 - t2109 / 0.8e1 + t2113 / 0.4e1 - 0.5e1 / 0.12e2 * t2117 + t2122 - 0.3e1 / 0.8e1 * t5 * t1042 * t261 - 0.3e1 / 0.8e1 * t2243 + t2247 - 0.5e1 / 0.36e2 * t2249;
  t2252 = my_piecewise3(t81, 0, t2251);
  tv4rho41 = t1027 + t1059 + 0.3e1 * t1107 + 0.3e1 * t1146 + t6 * (t2197 + t2252);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2267 = t476 * t476;
  t2280 = my_piecewise5(t10, 0, t14, 0, t2146);
  t2284 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2023 * t525 * t335 - 0.32e2 / 0.27e2 * t1064 * t134 * t476 - 0.8e1 / 0.27e2 * t1149 * t343 + 0.8e1 / 0.9e1 * t334 * t2267 + 0.8e1 / 0.9e1 * t472 * t1075 - 0.8e1 / 0.27e2 * t869 * t530 * t335 + 0.8e1 / 0.9e1 * t334 * t1158 * t134 + 0.4e1 / 0.9e1 * t1154 * t343 + 0.4e1 / 0.3e1 * t23 * t2280);
  t2293 = t5 * t1167 * t186;
  t2306 = t5 * t1162 * t143 * t76;
  t2310 = t5 * t534 * t360 * t76;
  t2317 = -0.3e1 / 0.8e1 * t5 * t2284 * t26 * t76 - 0.3e1 / 0.4e1 * t5 * t1163 * t186 - t2293 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t535 * t439 - t2161 / 0.2e1 + t2167 / 0.3e1 - t2170 / 0.4e1 - 0.5e1 / 0.18e2 * t1876 + t1879 / 0.12e2 + t2059 / 0.6e1 - t2306 / 0.4e1 + t2310 / 0.12e2 - 0.5e1 / 0.18e2 * t2183 - t2187 / 0.4e1 + t2191 / 0.3e1 + t2069 / 0.12e2 - 0.5e1 / 0.18e2 * t2073 + t2080;
  t2318 = my_piecewise3(t1, 0, t2317);
  t2327 = t499 * t499;
  t2340 = my_piecewise5(t14, 0, t10, 0, -t2146);
  t2344 = my_piecewise3(t84, 0, 0.4e2 / 0.81e2 * t2085 * t542 * t447 - 0.32e2 / 0.27e2 * t1108 * t193 * t499 - 0.8e1 / 0.27e2 * t1179 * t451 + 0.8e1 / 0.9e1 * t446 * t2327 + 0.8e1 / 0.9e1 * t496 * t1117 - 0.8e1 / 0.27e2 * t1029 * t546 * t447 + 0.8e1 / 0.9e1 * t446 * t1188 * t193 + 0.4e1 / 0.9e1 * t1184 * t451 + 0.4e1 / 0.3e1 * t85 * t2340);
  t2351 = t5 * t1192 * t143 * t125;
  t2355 = t5 * t550 * t360 * t125;
  t2364 = t5 * t1126 * t261;
  t2367 = t5 * t1130 * t261;
  t2378 = t5 * t460 * t619;
  t2381 = t5 * t464 * t619;
  t2383 = -0.3e1 / 0.8e1 * t5 * t2344 * t26 * t125 - t2351 / 0.4e1 + t2355 / 0.12e2 - t2226 / 0.4e1 + t2230 / 0.3e1 - 0.5e1 / 0.18e2 * t2234 - 0.3e1 / 0.4e1 * t5 * t1122 * t261 - t2364 / 0.2e1 + t2367 / 0.6e1 + t2113 / 0.12e2 - 0.5e1 / 0.18e2 * t2117 + t2122 - t2243 / 0.4e1 + t2246 / 0.3e1 - 0.5e1 / 0.18e2 * t2249 - 0.3e1 / 0.8e1 * t5 * t456 * t619 - t2378 / 0.4e1 + t2381 / 0.12e2;
  t2384 = my_piecewise3(t81, 0, t2383);
  tv4rho42 = 0.2e1 * t1107 + 0.2e1 * t1146 + 0.2e1 * t1178 + 0.2e1 * t1217 + t6 * (t2318 + t2384);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2404 = t2145 + t2146;
  t2405 = my_piecewise5(t10, 0, t14, 0, t2404);
  t2409 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2023 * t1222 * t134 - 0.8e1 / 0.9e1 * t1149 * t476 - 0.8e1 / 0.9e1 * t1064 * t530 * t134 + 0.4e1 / 0.3e1 * t1067 * t530 + 0.4e1 / 0.3e1 * t472 * t1158 + 0.4e1 / 0.9e1 * t334 * t1229 * t134 + 0.4e1 / 0.3e1 * t23 * t2405);
  t2416 = t5 * t1233 * t143 * t76;
  t2427 = -0.3e1 / 0.8e1 * t5 * t2409 * t26 * t76 - t2416 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1234 * t186 - 0.3e1 / 0.8e1 * t2306 + t2310 / 0.4e1 - 0.3e1 / 0.8e1 * t2293 + t2192 - 0.5e1 / 0.12e2 * t2183 + t2168 - 0.5e1 / 0.36e2 * t2073 + t2080 - 0.5e1 / 0.36e2 * t1876;
  t2428 = my_piecewise3(t1, 0, t2427);
  t2445 = my_piecewise5(t14, 0, t10, 0, -t2404);
  t2449 = my_piecewise3(t84, 0, 0.4e2 / 0.81e2 * t2085 * t1242 * t193 - 0.8e1 / 0.9e1 * t1179 * t499 - 0.8e1 / 0.9e1 * t1108 * t546 * t193 + 0.4e1 / 0.3e1 * t1111 * t546 + 0.4e1 / 0.3e1 * t496 * t1188 + 0.4e1 / 0.9e1 * t446 * t1248 * t193 + 0.4e1 / 0.3e1 * t85 * t2445);
  t2456 = t5 * t1252 * t143 * t125;
  t2464 = t5 * t1197 * t261;
  t2473 = t5 * t508 * t619;
  t2483 = t5 * t201 * t1362;
  t2485 = -0.3e1 / 0.8e1 * t5 * t2449 * t26 * t125 - t2456 / 0.8e1 - 0.3e1 / 0.8e1 * t2351 + t2355 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t1193 * t261 - 0.3e1 / 0.8e1 * t2464 + t2231 - 0.5e1 / 0.12e2 * t2234 - 0.3e1 / 0.4e1 * t2364 + t2367 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t504 * t619 - 0.3e1 / 0.8e1 * t2473 - 0.5e1 / 0.36e2 * t2117 + t2122 + t2247 - 0.5e1 / 0.12e2 * t2249 - 0.3e1 / 0.8e1 * t2378 + t2381 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t197 * t1362 - t2483 / 0.8e1;
  t2486 = my_piecewise3(t81, 0, t2485);
  tv4rho43 = 0.3e1 * t1178 + 0.3e1 * t1217 + t1241 + t1367 + t6 * (t2428 + t2486);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2491 = t525 * t525;
  t2496 = t530 * t530;
  t2502 = 0.24e2 * t877 + 0.24e2 * t2037;
  t2503 = my_piecewise5(t10, 0, t14, 0, t2502);
  t2507 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2023 * t2491 - 0.16e2 / 0.9e1 * t1149 * t530 + 0.4e1 / 0.3e1 * t334 * t2496 + 0.16e2 / 0.9e1 * t472 * t1229 + 0.4e1 / 0.3e1 * t23 * t2503);
  t2516 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2507 * t26 * t76 - t2416 / 0.2e1 + t2310 / 0.2e1 - 0.5e1 / 0.9e1 * t2183 + t2080);
  t2521 = t542 * t542;
  t2526 = t546 * t546;
  t2532 = my_piecewise5(t14, 0, t10, 0, -t2502);
  t2536 = my_piecewise3(t84, 0, 0.4e2 / 0.81e2 * t2085 * t2521 - 0.16e2 / 0.9e1 * t1179 * t546 + 0.4e1 / 0.3e1 * t446 * t2526 + 0.16e2 / 0.9e1 * t496 * t1248 + 0.4e1 / 0.3e1 * t85 * t2532);
  t2557 = sigma[2] / t91 / t237;
  t2561 = 0.1e1 / t612;
  t2574 = t611 * t577;
  t2576 = t1289 * t237;
  t2580 = t429 * t117;
  t2585 = 0.1e1 / t90 / t724;
  t2586 = t108 * t2585;
  t2596 = t611 / t91 / t1738;
  t2601 = 0.1e1 / t90 / t1697;
  t2606 = t611 * t611;
  t2618 = -0.32e3 / 0.81e2 * t119 * t121 / t90 / rho[1] + 0.292e3 / 0.27e2 * t174 * t2557 * t117 - 0.1171e4 / 0.729e3 * t416 * t577 * t2561 * t117 + 0.2563e4 / 0.2916e4 * t578 * t2561 * t393 * t104 + 0.2563e4 / 0.1458e4 * t586 * t2561 * params->alpha * t247 - t1894 * t2574 / t91 / t2576 * t28 * t2580 / 0.157464e6 - 0.5225e4 / 0.1458e4 * t182 * t2586 * t117 + 0.2563e4 / 0.1458e4 * t591 * t2561 * t99 * t594 + 0.2755e4 / 0.17496e5 * t430 * t2596 * t117 + 0.41e2 / 0.13122e5 * t1327 * t2601 * t55 * t1331 + t1917 * t2606 / t90 / t1289 / t724 * t55 * t1331 / 0.3779136e7 - 0.3047e4 / 0.972e3 * t166 * t2586 * t247;
  t2619 = t1289 * t110;
  t2625 = t1326 * t2601;
  t2630 = t99 / t1297 / t102 * t1972;
  t2650 = t58 * t99;
  t2652 = t1987 * t2650 * t103;
  t2657 = t1994 * t2650 * t246;
  t2663 = t1349 * t594 * t55 * t58;
  t2671 = t56 * t2650 * t1298;
  t2674 = -0.19e2 / 0.17496e5 * t927 * t1288 / t2619 * t117 + 0.2e1 / 0.2187e4 * t1966 * t2625 * t2630 + 0.2618e4 / 0.243e3 * t34 * t2557 * t104 - 0.3047e4 / 0.972e3 * t236 * t2585 * params->alpha * t104 - 0.49e2 / 0.729e3 * t952 * t2596 * t1300 - 0.49e2 / 0.4374e4 * t387 * t2596 * t1345 - 0.49e2 / 0.1458e4 * t398 * t2596 * t1352 + t387 * t2625 * t2652 / 0.26244e5 + t398 * t2625 * t2657 / 0.6561e4 + t405 * t2625 * t2663 / 0.2187e4 - 0.49e2 / 0.729e3 * t405 * t2596 * t1359 + 0.2e1 / 0.2187e4 * t952 * t2625 * t2671;
  t2683 = -t2456 / 0.2e1 - 0.3e1 / 0.2e1 * t2464 - 0.3e1 / 0.2e1 * t2473 - t2483 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t2536 * t26 * t125 - 0.3e1 / 0.2e1 * t5 * t1253 * t261 - 0.9e1 / 0.4e1 * t5 * t551 * t619 - 0.3e1 / 0.2e1 * t5 * t225 * t1362 - 0.3e1 / 0.8e1 * t5 * t88 * (t2618 + t2674) + t2355 / 0.2e1 + t2367 + t2381 / 0.2e1 - 0.5e1 / 0.9e1 * t2234 - 0.5e1 / 0.9e1 * t2249 + t2122;
  t2684 = my_piecewise3(t81, 0, t2683);
  tv4rho44 = 0.4e1 * t1241 + 0.4e1 * t1367 + t6 * (t2516 + t2684);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t2692 = t5 * t890 * t295;
  t2698 = t5 * t897 * t295;
  t2701 = t5 * t352 * t683;
  t2708 = 0.5e1 / 0.36e2 * t5 * t909 * t295;
  t2710 = t5 * t361 * t683;
  t2713 = t5 * t144 * t1458;
  t2715 = t431 * t984;
  t2727 = t388 * t46;
  t2741 = t388 * t28;
  t2765 = -t387 * t2715 * t1990 / 0.69984e5 - t398 * t2715 * t1996 / 0.17496e5 - t405 * t2715 * t2002 / 0.5832e4 + 0.89e2 / 0.3888e4 * t405 * t946 * params->alpha * t957 * t2727 * t409 - t952 * t2715 * t2010 / 0.2916e4 + 0.253e3 / 0.324e3 * t155 * t58 * t968 * t640 + 0.89e2 / 0.23328e5 * t387 * t946 * t924 * t2741 * t1004 + 0.89e2 / 0.7776e4 * t398 * t946 * t393 * t2727 * t1011 - 0.32e3 / 0.27e2 * t70 * t288 * t940 + 0.437e3 / 0.972e3 * t416 * t919 * t59 * t68 + 0.209e3 / 0.243e3 * t182 * sigma[0] * t968 * t68 - 0.1121e4 / 0.23328e5 * t430 * t388 * t946 * t68;
  t2794 = t929 * t62;
  t2819 = -0.1025e4 / 0.1944e4 * t405 * t919 * t1395 - 0.73e2 / 0.69984e5 * t980 * t984 * t1442 - t1917 * t1895 / t36 / t929 / t390 * t55 * t986 / 0.10077696e8 - 0.1025e4 / 0.3888e4 * t387 * t919 * t1429 - 0.1025e4 / 0.1944e4 * t398 * t919 * t1434 - 0.154e3 / 0.81e2 * t34 * t962 * t46 * t50 + 0.253e3 / 0.324e3 * t166 * t968 * t46 * t644 + t1894 / t37 / t2794 * t928 * t28 * t1901 / 0.419904e6 - 0.16e2 / 0.9e1 * t41 * t33 * t962 * t68 + 0.35e2 / 0.93312e5 * t927 * t981 * t931 * t68 + 0.89e2 / 0.3888e4 * t952 * t946 * t46 * t955 * t388 * t957 - t1966 * t2715 * t1973 / 0.2916e4;
  t2825 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t886 * t295 - 0.3e1 / 0.8e1 * t2692 - 0.9e1 / 0.8e1 * t5 * t348 * t683 + t2698 / 0.4e1 - 0.3e1 / 0.4e1 * t2701 - 0.9e1 / 0.8e1 * t5 * t138 * t1458 - t2708 + t2710 / 0.4e1 - 0.3e1 / 0.8e1 * t2713 - 0.3e1 / 0.8e1 * t5 * t27 * (t2765 + t2819));
  tv4rho3sigma0 = t6 * t2825 + 0.3e1 * t1463;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t2832 = t5 * t1046 * t326;
  t2835 = t5 * t1050 * t326;
  t2839 = 0.5e1 / 0.36e2 * t5 * t1054 * t326;
  t2841 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t1042 * t326 - 0.3e1 / 0.8e1 * t2832 + t2835 / 0.4e1 - t2839);
  tv4rho3sigma2 = t6 * t2841 + 0.3e1 * t1476;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t2843 = 0.2e1 * t1490;
  t2849 = t5 * t1084 * t295 / 0.4e1;
  t2854 = t5 * t1091 * t295;
  t2858 = t5 * t485 * t683 / 0.4e1;
  t2867 = -0.3e1 / 0.8e1 * t5 * t1080 * t295 - t2849 - 0.3e1 / 0.4e1 * t5 * t481 * t683 + t2854 / 0.12e2 - t2858 - 0.3e1 / 0.8e1 * t5 * t214 * t1458 - t2692 / 0.8e1 + t2698 / 0.6e1 - t2701 / 0.4e1 - t2708 + t2710 / 0.6e1 - t2713 / 0.8e1;
  t2868 = my_piecewise3(t1, 0, t2867);
  tv4rho3sigma3 = t6 * t2868 + t1463 + t2843;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t2870 = 0.2e1 * t1506;
  t2876 = t5 * t1126 * t326 / 0.4e1;
  t2878 = t5 * t1130 * t326;
  t2887 = t5 * t460 * t758 / 0.4e1;
  t2889 = t5 * t464 * t758;
  t2892 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t1122 * t326 - t2876 + t2878 / 0.12e2 - t2832 / 0.8e1 + t2835 / 0.6e1 - t2839 - 0.3e1 / 0.8e1 * t5 * t456 * t758 - t2887 + t2889 / 0.12e2);
  tv4rho3sigma5 = t6 * t2892 + t1476 + t2870;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2898 = t5 * t1167 * t295;
  t2907 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1163 * t295 - t2898 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t535 * t683 - t2849 + t2854 / 0.6e1 - t2858 + t2698 / 0.12e2 - t2708 + t2710 / 0.12e2);
  tv4rho3sigma6 = t6 * t2907 + t1514 + t2843;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2913 = t5 * t1197 * t326;
  t2920 = t5 * t508 * t758;
  t2928 = t5 * t201 * t1597;
  t2930 = -0.3e1 / 0.8e1 * t5 * t1193 * t326 - t2913 / 0.8e1 - t2876 + t2878 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t504 * t758 - t2920 / 0.4e1 + t2835 / 0.12e2 - t2839 - t2887 + t2889 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t197 * t1597 - t2928 / 0.8e1;
  t2931 = my_piecewise3(t81, 0, t2930);
  tv4rho3sigma8 = t6 * t2931 + t1602 + t2870;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2940 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1234 * t295 - 0.3e1 / 0.8e1 * t2898 + t2854 / 0.4e1 - t2708);
  tv4rho3sigma9 = t6 * t2940 + 0.3e1 * t1514;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2957 = t611 * t1329;
  t2971 = t577 * t28;
  t2977 = t577 * t99;
  t2990 = t577 * t1279;
  t3007 = -t1966 * t2957 * t2630 / 0.2916e4 + 0.35e2 / 0.93312e5 * t927 * t1326 * t1291 * t117 - 0.16e2 / 0.9e1 * t41 * t33 * t1304 * t117 + 0.89e2 / 0.23328e5 * t387 * t1279 * t924 * t2971 * t1344 + 0.89e2 / 0.7776e4 * t398 * t1279 * t393 * t2977 * t1351 - t405 * t2957 * t2663 / 0.5832e4 - t387 * t2957 * t2652 / 0.69984e5 - t398 * t2957 * t2657 / 0.17496e5 + 0.89e2 / 0.3888e4 * t952 * t2990 * t1300 - t952 * t2957 * t2671 / 0.2916e4 + 0.89e2 / 0.3888e4 * t405 * t1279 * params->alpha * t957 * t2977 * t594 + 0.253e3 / 0.324e3 * t155 * t58 * t1310 * t715;
  t3023 = t1289 * t111;
  t3058 = 0.437e3 / 0.972e3 * t416 * t1268 * t108 * t117 - 0.32e3 / 0.27e2 * t119 * t319 * t1273 - 0.154e3 / 0.81e2 * t34 * t1304 * t99 * t103 + 0.253e3 / 0.324e3 * t166 * t1310 * t99 * t719 + t1894 / t91 / t3023 * t1288 * t28 * t2580 / 0.419904e6 + 0.209e3 / 0.243e3 * t182 * sigma[2] * t1310 * t117 - 0.1121e4 / 0.23328e5 * t430 * t2990 * t117 - 0.1025e4 / 0.1944e4 * t405 * t1268 * t1534 - 0.73e2 / 0.69984e5 * t980 * t1329 * t1581 - t1917 * t2574 / t90 / t1289 / t579 * t55 * t1331 / 0.10077696e8 - 0.1025e4 / 0.3888e4 * t387 * t1268 * t1568 - 0.1025e4 / 0.1944e4 * t398 * t1268 * t1573;
  t3064 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t1253 * t326 - 0.3e1 / 0.8e1 * t2913 - 0.9e1 / 0.8e1 * t5 * t551 * t758 + t2878 / 0.4e1 - 0.3e1 / 0.4e1 * t2920 - 0.9e1 / 0.8e1 * t5 * t225 * t1597 - t2839 + t2889 / 0.4e1 - 0.3e1 / 0.8e1 * t2928 - 0.3e1 / 0.8e1 * t5 * t88 * (t3007 + t3058));
  tv4rho3sigma11 = t6 * t3064 + 0.3e1 * t1602;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t3071 = t5 * t352 * t811;
  t3078 = t5 * t361 * t811 / 0.12e2;
  t3080 = t5 * t144 * t1672;
  t3084 = t388 * t1439;
  t3095 = t59 * t434;
  t3125 = -0.19e2 / 0.162e3 * t765 * t378 + t1966 * t3084 * t1973 / 0.7776e4 - 0.91e2 / 0.746496e6 * t927 * t1407 * t431 * t68 + t405 * t3084 * t2002 / 0.15552e5 - 0.25e2 / 0.3456e4 * t952 * t3095 * t958 + t952 * t3084 * t2010 / 0.7776e4 - 0.25e2 / 0.3456e4 * t405 * t434 * params->alpha * t957 * t1395 - 0.25e2 / 0.20736e5 * t387 * t434 * t924 * t59 * t28 * t1004 - 0.25e2 / 0.6912e4 * t398 * t434 * t393 * t59 * t46 * t1011 + t387 * t3084 * t1990 / 0.186624e6 + t398 * t3084 * t1996 / 0.46656e5;
  t3169 = 0.32e3 / 0.9e1 * t70 * t797 * t37 - 0.1e2 / 0.27e2 * t174 * t71 * t369 * t68 - 0.19e2 / 0.162e3 * t56 * t1415 * t68 + 0.191e3 / 0.15552e5 * t430 * t3095 * t68 - 0.31e2 / 0.324e3 * t416 * t392 * sigma[0] * t68 - t1894 / t37 / t1944 * t981 * t28 * t1901 / 0.1119744e7 + 0.167e3 / 0.1296e4 * t1393 * t1630 + t1917 * t928 / t36 / t929 / t374 * t55 * t986 / 0.26873856e8 - 0.19e2 / 0.162e3 * t166 * t1423 * t169 + 0.167e3 / 0.2592e4 * t1427 * t1645 + 0.167e3 / 0.1296e4 * t1432 * t1649 + 0.59e2 / 0.186624e6 * t1440 * t1660;
  t3175 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t348 * t811 - t3071 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t138 * t1672 + t3078 - t3080 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * (t3125 + t3169));
  tv4rho2sigma20 = t6 * t3175 + 0.2e1 * t1677;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t3182 = t5 * t460 * t861;
  t3186 = t5 * t464 * t861 / 0.12e2;
  t3188 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t456 * t861 - t3182 / 0.4e1 + t3186);
  tv4rho2sigma25 = t6 * t3188 + 0.2e1 * t1686;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t3194 = t5 * t485 * t811;
  t3202 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t481 * t811 - t3194 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t214 * t1672 - t3071 / 0.8e1 + t3078 - t3080 / 0.8e1);
  tv4rho2sigma26 = t6 * t3202 + t1677 + t1692;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t3208 = t5 * t508 * t861;
  t3215 = t5 * t201 * t1759;
  t3218 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t504 * t861 - t3208 / 0.8e1 - t3182 / 0.8e1 + t3186 - 0.3e1 / 0.8e1 * t5 * t197 * t1759 - t3215 / 0.8e1);
  tv4rho2sigma211 = t6 * t3218 + t1686 + t1764;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t3226 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t535 * t811 - t3194 / 0.4e1 + t3078);
  tv4rho2sigma212 = t6 * t3226 + 0.2e1 * t1692;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t3259 = t577 * t1578;
  t3279 = -0.91e2 / 0.746496e6 * t927 * t611 * t1549 * t117 - 0.31e2 / 0.324e3 * t416 * t581 * sigma[2] * t117 + 0.32e3 / 0.9e1 * t119 * t847 * t91 - 0.1e2 / 0.27e2 * t174 * t120 * t561 * t117 - 0.19e2 / 0.162e3 * t56 * t1554 * t117 + 0.191e3 / 0.15552e5 * t430 * t614 * t108 * t117 + t1966 * t3259 * t2630 / 0.7776e4 - 0.25e2 / 0.3456e4 * t952 * t614 * t99 * t1298 * t108 * t957 - 0.19e2 / 0.162e3 * t765 * t570 + t405 * t3259 * t2663 / 0.15552e5 - 0.25e2 / 0.3456e4 * t405 * t614 * params->alpha * t957 * t1534;
  t3327 = t952 * t3259 * t2671 / 0.7776e4 - 0.25e2 / 0.20736e5 * t387 * t614 * t924 * t108 * t28 * t1344 - 0.25e2 / 0.6912e4 * t398 * t614 * t393 * t108 * t99 * t1351 + t387 * t3259 * t2652 / 0.186624e6 + t398 * t3259 * t2657 / 0.46656e5 - 0.19e2 / 0.162e3 * t166 * t1562 * t246 - t1894 / t91 / t2619 * t1326 * t28 * t2580 / 0.1119744e7 + t1917 * t1288 / t90 / t1289 / t566 * t55 * t1331 / 0.26873856e8 + 0.167e3 / 0.1296e4 * t1532 * t1704 + 0.59e2 / 0.186624e6 * t1579 * t1743 + 0.167e3 / 0.2592e4 * t1566 * t1728 + 0.167e3 / 0.1296e4 * t1571 * t1732;
  t3333 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t551 * t861 - t3208 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t225 * t1759 + t3186 - t3215 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t88 * (t3279 + t3327));
  tv4rho2sigma217 = t6 * t3333 + 0.2e1 * t1764;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t3340 = t5 * t144 * t1813 / 0.8e1;
  t3381 = t59 * t1657;
  t3402 = t957 * sigma[0];
  t3421 = t1894 / t37 / t930 * t431 * t28 * t1901 / 0.2985984e7 + 0.2e1 / 0.3e1 * t174 * t287 * t150 * t68 - t430 * t678 * sigma[0] * t68 / 0.432e3 - t1917 * t981 / t36 / t1897 * t55 * t986 / 0.71663616e8 + t927 * t1634 * t388 * t68 / 0.27648e5 + t416 * t650 * t68 / 0.72e2 - 0.64e2 * t70 * t1801 * t178 - t405 * t662 / 0.48e2 + 0.7e1 / 0.3456e4 * t952 * t678 * t46 * t955 * t28 * t42 - t1966 * t3381 * t1973 / 0.20736e5 - 0.5e1 / 0.62208e5 * t1658 * t1793 - t405 * t3381 * t2002 / 0.41472e5 - t952 * t3381 * t2010 / 0.20736e5 + 0.7e1 / 0.20736e5 * t387 * t678 * t924 * t957 * sigma[0] * t46 * t50 + 0.7e1 / 0.6912e4 * t398 * t678 * t393 * t170 * t3402 + 0.7e1 / 0.3456e4 * t405 * t678 * params->alpha * t1394 * t3402 - t387 * t3381 * t1990 / 0.497664e6 - t398 * t3381 * t1996 / 0.124416e6 - t1643 * t1767 / 0.96e2 - t1648 * t1771 / 0.48e2;
  t3426 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t138 * t1813 - t3340 - 0.3e1 / 0.8e1 * t5 * t27 * t3421);
  tv4rhosigma30 = t6 * t3426 + t1817;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t3433 = t5 * t201 * t1865 / 0.8e1;
  t3435 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t197 * t1865 - t3433);
  tv4rhosigma39 = t6 * t3435 + t1869;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t3441 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t214 * t1813 - t3340);
  tv4rhosigma310 = t6 * t3441 + t1817;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t3490 = t108 * t1740;
  t3517 = t957 * sigma[2];
  t3526 = -t405 * t737 / 0.48e2 - 0.64e2 * t119 * t1853 * t254 + t1894 / t91 / t1290 * t611 * t28 * t2580 / 0.2985984e7 + 0.2e1 / 0.3e1 * t174 * t318 * t231 * t117 - t430 * t753 * sigma[2] * t117 / 0.432e3 - t1917 * t1326 / t90 / t2576 * t55 * t1331 / 0.71663616e8 - t1726 * t1819 / 0.96e2 - t1731 * t1823 / 0.48e2 + t927 * t1698 * t577 * t117 / 0.27648e5 + t416 * t725 * t117 / 0.72e2 + 0.7e1 / 0.3456e4 * t952 * t753 * t99 * t1298 * t28 * t95 - t1966 * t3490 * t2630 / 0.20736e5 - 0.5e1 / 0.62208e5 * t1741 * t1845 - t387 * t3490 * t2652 / 0.497664e6 - t398 * t3490 * t2657 / 0.124416e6 - t405 * t3490 * t2663 / 0.41472e5 - t952 * t3490 * t2671 / 0.20736e5 + 0.7e1 / 0.20736e5 * t387 * t753 * t924 * t957 * sigma[2] * t99 * t103 + 0.7e1 / 0.6912e4 * t398 * t753 * t393 * t247 * t3517 + 0.7e1 / 0.3456e4 * t405 * t753 * params->alpha * t1533 * t3517;
  t3531 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t225 * t1865 - t3433 - 0.3e1 / 0.8e1 * t5 * t88 * t3526);
  tv4rhosigma319 = t6 * t3531 + t1869;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t3584 = sigma[0] * t1790;
  t3604 = 0.96e2 * t70 * t32 / t981 * t38 + t427 * t429 * t806 * t68 / 0.4608e4 - t1894 / t37 / t1406 * t2741 * t1901 / 0.7962624e7 - t174 * t796 * t39 * t68 + t1917 * t431 / t36 / t2794 * t55 * t986 / 0.191102976e9 - t952 * t806 * t958 / 0.2304e4 - t416 * t71 * t773 * t68 / 0.192e3 - t927 * t1808 * t59 * t68 / 0.110592e6 - t387 * t806 * t924 * t957 * t51 / 0.13824e5 - t398 * t806 * t393 * t170 * t957 / 0.4608e4 - t405 * t806 * params->alpha * t1394 * t957 / 0.2304e4 + t1966 * t3584 * t1973 / 0.55296e5 + t1791 * sigma[0] * t55 * t986 / 0.82944e5 + t387 * t3584 * t1990 / 0.1327104e7 + t398 * t3584 * t1996 / 0.331776e6 + t405 * t3584 * t2002 / 0.110592e6 + t952 * t3584 * t2010 / 0.55296e5;
  t3608 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t3604);
  tv4sigma40 = t6 * t3608;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t3609 = sigma[2] * t1842;
  t3680 = t387 * t3609 * t2652 / 0.1327104e7 + t398 * t3609 * t2657 / 0.331776e6 + t405 * t3609 * t2663 / 0.110592e6 + t952 * t3609 * t2671 / 0.55296e5 + 0.96e2 * t119 * t32 / t1326 * t92 + t427 * t429 * t856 * t117 / 0.4608e4 - t416 * t120 * t823 * t117 / 0.192e3 - t927 * t1860 * t108 * t117 / 0.110592e6 + t1917 * t611 / t90 / t3023 * t55 * t1331 / 0.191102976e9 - t952 * t856 * t1300 / 0.2304e4 - t1894 / t91 / t1548 * t2971 * t2580 / 0.7962624e7 - t174 * t846 * t93 * t117 - t387 * t856 * t924 * t957 * t104 / 0.13824e5 - t398 * t856 * t393 * t247 * t957 / 0.4608e4 - t405 * t856 * params->alpha * t1533 * t957 / 0.2304e4 + t1966 * t3609 * t2630 / 0.55296e5 + t1843 * sigma[2] * t55 * t1331 / 0.82944e5;
  t3684 = my_piecewise3(t81, 0, -0.3e1 / 0.8e1 * t5 * t88 * t3680);
  tv4sigma414 = t6 * t3684;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

