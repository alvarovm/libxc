/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_q2d.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t39, t40, t42, t43, t44, t45;
  double t46, t47, t49, t53, t55, t56, t57, t60;
  double t62, t63, t65, t68, t70, t71, t72, t74;
  double t75, t78, t79, t83, tzk0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t19 * t19;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t39 = 0.1804e1 - 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t19 / t47;
  t53 = 0.1e3 - t43 * t45 * t49 / 0.288e3;
  t55 = 0.1e1 / t22;
  t56 = t40 * t55;
  t57 = sqrt(sigma[0]);
  t60 = 0.1e1 / t19 / rho[0];
  t62 = t56 * t57 * t26 * t60;
  t63 = pow(t62, 0.35e1);
  t65 = 0.1e1 + t34 / 0.24e2;
  t68 = t39 * t53 + 0.87153829697982569831e-4 * t63 * t65;
  t70 = t21 * t21;
  t71 = 0.1e1 / t70;
  t72 = t44 * sigma[0];
  t74 = t46 * t46;
  t75 = 0.1e1 / t74;
  t78 = 0.1e3 + t71 * t72 * t75 / 0.576e3;
  t79 = 0.1e1 / t78;
  t83 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t68 * t79);
  tzk0 = 0.2e1 * t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t39, t40, t42, t43, t44, t45;
  double t46, t47, t49, t53, t55, t56, t57, t60;
  double t62, t63, t65, t68, t70, t71, t72, t74;
  double t75, t78, t79, t83, tzk0;

  double t84, t89, t90, t92, t93, t95, t100, t101;
  double t102, t104, t108, t110, t111, t114, t118, t119;
  double t123, t131, t133, t134, t135, t136, t137, t142;
  double tvrho0, t145, t149, t153, t154, t155, t159, t163;
  double t168, t170, t171, t172, t177, tvsigma0;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t19 * t19;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t39 = 0.1804e1 - 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t19 / t47;
  t53 = 0.1e3 - t43 * t45 * t49 / 0.288e3;
  t55 = 0.1e1 / t22;
  t56 = t40 * t55;
  t57 = sqrt(sigma[0]);
  t60 = 0.1e1 / t19 / rho[0];
  t62 = t56 * t57 * t26 * t60;
  t63 = pow(t62, 0.35e1);
  t65 = 0.1e1 + t34 / 0.24e2;
  t68 = t39 * t53 + 0.87153829697982569831e-4 * t63 * t65;
  t70 = t21 * t21;
  t71 = 0.1e1 / t70;
  t72 = t44 * sigma[0];
  t74 = t46 * t46;
  t75 = 0.1e1 / t74;
  t78 = 0.1e3 + t71 * t72 * t75 / 0.576e3;
  t79 = 0.1e1 / t78;
  t83 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t68 * t79);
  tzk0 = 0.2e1 * t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = 0.1e1 / t30;
  t89 = t36 * t36;
  t90 = 0.1e1 / t89;
  t92 = t90 * t20 * t24;
  t93 = t29 * rho[0];
  t95 = 0.1e1 / t30 / t93;
  t100 = t39 * t40;
  t101 = t100 * t42;
  t102 = t46 * t29;
  t104 = 0.1e1 / t19 / t102;
  t108 = pow(t62, 0.25e1);
  t110 = t108 * t65 * t40;
  t111 = t55 * t57;
  t114 = t26 / t19 / t29;
  t118 = t63 * t20;
  t119 = t118 * t24;
  t123 = -0.88671604938271604938e-2 * t92 * t28 * t95 * t53 + t101 * t45 * t104 / 0.54e2 - 0.40671787192391865921e-3 * t110 * t111 * t114 - 0.96837588553313966479e-5 * t119 * t28 * t95;
  t131 = t3 / t4 / t70 * t17;
  t133 = 0.1e1 / t30 / t74;
  t134 = t133 * t68;
  t135 = t78 * t78;
  t136 = 0.1e1 / t135;
  t137 = t136 * t72;
  t142 = my_piecewise3(t2, 0, -t18 * t84 * t68 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t123 * t79 - t131 * t134 * t137 / 0.192e3);
  tvrho0 = 0.2e1 * rho[0] * t142 + 0.2e1 * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t145 = t27 * t32;
  t149 = sigma[0] * t26;
  t153 = 0.1e1 / t57;
  t154 = t55 * t153;
  t155 = t26 * t60;
  t159 = t24 * t27;
  t163 = 0.33251851851851851852e-2 * t92 * t145 * t53 - t101 * t149 * t49 / 0.144e3 + 0.1525192019714694972e-3 * t110 * t154 * t155 + 0.3631409570749273743e-5 * t118 * t159 * t32;
  t168 = t46 * t93;
  t170 = 0.1e1 / t30 / t168;
  t171 = t170 * t68;
  t172 = t136 * t44;
  t177 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t163 * t79 + t131 * t171 * t172 / 0.512e3);
  tvsigma0 = 0.2e1 * rho[0] * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t39, t40, t42, t43, t44, t45;
  double t46, t47, t49, t53, t55, t56, t57, t60;
  double t62, t63, t65, t68, t70, t71, t72, t74;
  double t75, t78, t79, t83, tzk0;

  double t84, t89, t90, t92, t93, t95, t100, t101;
  double t102, t104, t108, t110, t111, t114, t118, t119;
  double t123, t131, t133, t134, t135, t136, t137, t142;
  double tvrho0, t145, t149, t153, t154, t155, t159, t163;
  double t168, t170, t171, t172, t177, tvsigma0;

  double t181, t190, t192, t193, t198, t200, t202, t208;
  double t213, t214, t215, t219, t225, t227, t228, t229;
  double t233, t234, t235, t236, t242, t249, t254, t258;
  double t262, t263, t264, t266, t267, t269, t270, t271;
  double t272, t277, tv2rho20, t284, t285, t289, t293, t297;
  double t303, t306, t315, t320, t327, t332, t333, t334;
  double t335, t340, tv2rhosigma0, t343, t350, t353, t357, t358;
  double t362, t366, t367, t371, t376, t380, t382, t383;
  double t384, t388, t393, tv2sigma20;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t19 * t19;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t39 = 0.1804e1 - 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t19 / t47;
  t53 = 0.1e3 - t43 * t45 * t49 / 0.288e3;
  t55 = 0.1e1 / t22;
  t56 = t40 * t55;
  t57 = sqrt(sigma[0]);
  t60 = 0.1e1 / t19 / rho[0];
  t62 = t56 * t57 * t26 * t60;
  t63 = pow(t62, 0.35e1);
  t65 = 0.1e1 + t34 / 0.24e2;
  t68 = t39 * t53 + 0.87153829697982569831e-4 * t63 * t65;
  t70 = t21 * t21;
  t71 = 0.1e1 / t70;
  t72 = t44 * sigma[0];
  t74 = t46 * t46;
  t75 = 0.1e1 / t74;
  t78 = 0.1e3 + t71 * t72 * t75 / 0.576e3;
  t79 = 0.1e1 / t78;
  t83 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t68 * t79);
  tzk0 = 0.2e1 * t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = 0.1e1 / t30;
  t89 = t36 * t36;
  t90 = 0.1e1 / t89;
  t92 = t90 * t20 * t24;
  t93 = t29 * rho[0];
  t95 = 0.1e1 / t30 / t93;
  t100 = t39 * t40;
  t101 = t100 * t42;
  t102 = t46 * t29;
  t104 = 0.1e1 / t19 / t102;
  t108 = pow(t62, 0.25e1);
  t110 = t108 * t65 * t40;
  t111 = t55 * t57;
  t114 = t26 / t19 / t29;
  t118 = t63 * t20;
  t119 = t118 * t24;
  t123 = -0.88671604938271604938e-2 * t92 * t28 * t95 * t53 + t101 * t45 * t104 / 0.54e2 - 0.40671787192391865921e-3 * t110 * t111 * t114 - 0.96837588553313966479e-5 * t119 * t28 * t95;
  t131 = t3 / t4 / t70 * t17;
  t133 = 0.1e1 / t30 / t74;
  t134 = t133 * t68;
  t135 = t78 * t78;
  t136 = 0.1e1 / t135;
  t137 = t136 * t72;
  t142 = my_piecewise3(t2, 0, -t18 * t84 * t68 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t123 * t79 - t131 * t134 * t137 / 0.192e3);
  tvrho0 = 0.2e1 * rho[0] * t142 + 0.2e1 * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t145 = t27 * t32;
  t149 = sigma[0] * t26;
  t153 = 0.1e1 / t57;
  t154 = t55 * t153;
  t155 = t26 * t60;
  t159 = t24 * t27;
  t163 = 0.33251851851851851852e-2 * t92 * t145 * t53 - t101 * t149 * t49 / 0.144e3 + 0.1525192019714694972e-3 * t110 * t154 * t155 + 0.3631409570749273743e-5 * t118 * t159 * t32;
  t168 = t46 * t93;
  t170 = 0.1e1 / t30 / t168;
  t171 = t170 * t68;
  t172 = t136 * t44;
  t177 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t163 * t79 + t131 * t171 * t172 / 0.512e3);
  tvsigma0 = 0.2e1 * rho[0] * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t181 = 0.1e1 / t30 / rho[0];
  t190 = t74 * rho[0];
  t192 = 0.1e1 / t30 / t190;
  t193 = t192 * t68;
  t198 = 0.1e1 / t89 / t36;
  t200 = t198 * t40 * t42;
  t202 = 0.1e1 / t19 / t168;
  t208 = 0.1e1 / t30 / t46;
  t213 = t90 * t71;
  t214 = t74 * t29;
  t215 = 0.1e1 / t214;
  t219 = t90 * t72;
  t225 = POW_3_2(t62);
  t227 = t225 * t65 * t20;
  t228 = t24 * sigma[0];
  t229 = t27 * t208;
  t233 = 0.1e1 / t21;
  t234 = t108 * t233;
  t235 = t57 * sigma[0];
  t236 = 0.1e1 / t102;
  t242 = t26 / t19 / t93;
  t249 = -0.48653829870107876509e-3 * t200 * t45 * t202 * t53 + 0.32512921810699588477e-1 * t92 * t28 * t208 * t53 - 0.19704801097393689986e-2 * t213 * t72 * t215 - 0.20228913839792803583e-4 * t219 * t215 - 0.19e2 / 0.162e3 * t101 * t45 * t202 + 0.81343574384783731842e-2 * t227 * t228 * t229 + 0.10845809917971164246e-2 * t234 * t235 * t236 + 0.94900836782247687149e-3 * t110 * t111 * t242 + 0.35507115802881787709e-4 * t119 * t28 * t208;
  t254 = t133 * t123;
  t258 = t70 * t70;
  t262 = t3 / t4 / t258 * t17;
  t263 = t74 * t74;
  t264 = t263 * rho[0];
  t266 = 0.1e1 / t30 / t264;
  t267 = t266 * t68;
  t269 = 0.1e1 / t135 / t78;
  t270 = t44 * t44;
  t271 = t270 * t44;
  t272 = t269 * t271;
  t277 = my_piecewise3(t2, 0, t18 * t181 * t68 * t79 / 0.12e2 - t18 * t84 * t123 * t79 / 0.4e1 + 0.25e2 / 0.576e3 * t131 * t193 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * t249 * t79 - t131 * t254 * t137 / 0.96e2 - t262 * t267 * t272 / 0.6912e4);
  tv2rho20 = 0.2e1 * rho[0] * t277 + 0.4e1 * t142;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t284 = t26 * t104;
  t285 = t53 * sigma[0];
  t289 = t27 * t95;
  t293 = 0.1e1 / t190;
  t297 = t90 * t44;
  t303 = t159 * t95;
  t306 = 0.1e1 / t47;
  t315 = 0.18245186201290453691e-3 * t200 * t284 * t285 - 0.88671604938271604939e-2 * t92 * t289 * t53 + 0.73893004115226337449e-3 * t213 * t293 * t44 + 0.75858426899223013437e-5 * t297 * t293 + t101 * t149 * t104 / 0.27e2 - 0.3050384039429389944e-2 * t227 * t303 - 0.40671787192391865921e-3 * t234 * t57 * t306 - 0.2033589359619593296e-3 * t110 * t154 * t114 - 0.9683758855331396648e-5 * t118 * t303;
  t320 = t133 * t163;
  t327 = t170 * t123;
  t332 = 0.1e1 / t30 / t263;
  t333 = t332 * t68;
  t334 = t270 * sigma[0];
  t335 = t269 * t334;
  t340 = my_piecewise3(t2, 0, -t18 * t84 * t163 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t315 * t79 - t131 * t320 * t137 / 0.192e3 - 0.23e2 / 0.1536e4 * t131 * t134 * t172 + t131 * t327 * t172 / 0.512e3 + t262 * t333 * t335 / 0.18432e5);
  tv2rhosigma0 = 0.2e1 * rho[0] * t340 + 0.2e1 * t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t343 = t26 * t49;
  t350 = t90 * t75;
  t353 = t42 * t26;
  t357 = 0.1e1 / sigma[0];
  t358 = t24 * t357;
  t362 = 0.1e1 / t46;
  t366 = 0.1e1 / t235;
  t367 = t55 * t366;
  t371 = -0.68419448254839201342e-4 * t200 * t343 * t53 - 0.27709876543209876543e-3 * t213 * t75 * sigma[0] - 0.28446910087208630037e-5 * t350 * sigma[0] - t100 * t353 * t49 / 0.144e3 + 0.1143894014786021229e-2 * t227 * t358 * t145 + 0.1525192019714694972e-3 * t234 * t362 * t153 - 0.762596009857347486e-4 * t110 * t367 * t155;
  t376 = t170 * t163;
  t380 = t74 * t168;
  t382 = 0.1e1 / t30 / t380;
  t383 = t382 * t68;
  t384 = t269 * t270;
  t388 = t136 * sigma[0];
  t393 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t371 * t79 + t131 * t376 * t172 / 0.256e3 - t262 * t383 * t384 / 0.49152e5 + t131 * t171 * t388 / 0.256e3);
  tv2sigma20 = 0.2e1 * rho[0] * t393;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t39, t40, t42, t43, t44, t45;
  double t46, t47, t49, t53, t55, t56, t57, t60;
  double t62, t63, t65, t68, t70, t71, t72, t74;
  double t75, t78, t79, t83, tzk0;

  double t84, t89, t90, t92, t93, t95, t100, t101;
  double t102, t104, t108, t110, t111, t114, t118, t119;
  double t123, t131, t133, t134, t135, t136, t137, t142;
  double tvrho0, t145, t149, t153, t154, t155, t159, t163;
  double t168, t170, t171, t172, t177, tvsigma0;

  double t181, t190, t192, t193, t198, t200, t202, t208;
  double t213, t214, t215, t219, t225, t227, t228, t229;
  double t233, t234, t235, t236, t242, t249, t254, t258;
  double t262, t263, t264, t266, t267, t269, t270, t271;
  double t272, t277, tv2rho20, t284, t285, t289, t293, t297;
  double t303, t306, t315, t320, t327, t332, t333, t334;
  double t335, t340, tv2rhosigma0, t343, t350, t353, t357, t358;
  double t362, t366, t367, t371, t376, t380, t382, t383;
  double t384, t388, t393, tv2sigma20;

  double t405, t406, t414, t420, t421, t425, t426, t427;
  double t428, t429, t430, t435, t440, t442, t443, t444;
  double t445, t447, t452, t459, t460, t465, t467, t472;
  double t475, t476, t477, t478, t482, t483, t486, t490;
  double t491, t493, t494, t502, t509, t514, t518, t526;
  double t529, t530, t531, t532, t533, t534, t535, t540;
  double tv3rho30, t552, t556, t560, t564, t566, t567, t577;
  double t579, t582, t588, t597, t600, t602, t613, t618;
  double t622, t635, t639, t645, t646, t647, t651, t652;
  double tv3rho2sigma0, t659, t667, t668, t672, t674, t680, t684;
  double t687, t690, t699, t700, t709, t714, t721, t725;
  double t732, t738, t739, t741, t751, t752, tv3rhosigma20, t762;
  double t764, t769, t774, t781, t782, t786, t788, t794;
  double t795, t796, t800, t805, t809, t818, t819, t820;
  double t824, t832, tv3sigma30;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t19 * t19;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t39 = 0.1804e1 - 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t19 / t47;
  t53 = 0.1e3 - t43 * t45 * t49 / 0.288e3;
  t55 = 0.1e1 / t22;
  t56 = t40 * t55;
  t57 = sqrt(sigma[0]);
  t60 = 0.1e1 / t19 / rho[0];
  t62 = t56 * t57 * t26 * t60;
  t63 = pow(t62, 0.35e1);
  t65 = 0.1e1 + t34 / 0.24e2;
  t68 = t39 * t53 + 0.87153829697982569831e-4 * t63 * t65;
  t70 = t21 * t21;
  t71 = 0.1e1 / t70;
  t72 = t44 * sigma[0];
  t74 = t46 * t46;
  t75 = 0.1e1 / t74;
  t78 = 0.1e3 + t71 * t72 * t75 / 0.576e3;
  t79 = 0.1e1 / t78;
  t83 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t68 * t79);
  tzk0 = 0.2e1 * t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = 0.1e1 / t30;
  t89 = t36 * t36;
  t90 = 0.1e1 / t89;
  t92 = t90 * t20 * t24;
  t93 = t29 * rho[0];
  t95 = 0.1e1 / t30 / t93;
  t100 = t39 * t40;
  t101 = t100 * t42;
  t102 = t46 * t29;
  t104 = 0.1e1 / t19 / t102;
  t108 = pow(t62, 0.25e1);
  t110 = t108 * t65 * t40;
  t111 = t55 * t57;
  t114 = t26 / t19 / t29;
  t118 = t63 * t20;
  t119 = t118 * t24;
  t123 = -0.88671604938271604938e-2 * t92 * t28 * t95 * t53 + t101 * t45 * t104 / 0.54e2 - 0.40671787192391865921e-3 * t110 * t111 * t114 - 0.96837588553313966479e-5 * t119 * t28 * t95;
  t131 = t3 / t4 / t70 * t17;
  t133 = 0.1e1 / t30 / t74;
  t134 = t133 * t68;
  t135 = t78 * t78;
  t136 = 0.1e1 / t135;
  t137 = t136 * t72;
  t142 = my_piecewise3(t2, 0, -t18 * t84 * t68 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t123 * t79 - t131 * t134 * t137 / 0.192e3);
  tvrho0 = 0.2e1 * rho[0] * t142 + 0.2e1 * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t145 = t27 * t32;
  t149 = sigma[0] * t26;
  t153 = 0.1e1 / t57;
  t154 = t55 * t153;
  t155 = t26 * t60;
  t159 = t24 * t27;
  t163 = 0.33251851851851851852e-2 * t92 * t145 * t53 - t101 * t149 * t49 / 0.144e3 + 0.1525192019714694972e-3 * t110 * t154 * t155 + 0.3631409570749273743e-5 * t118 * t159 * t32;
  t168 = t46 * t93;
  t170 = 0.1e1 / t30 / t168;
  t171 = t170 * t68;
  t172 = t136 * t44;
  t177 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t163 * t79 + t131 * t171 * t172 / 0.512e3);
  tvsigma0 = 0.2e1 * rho[0] * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t181 = 0.1e1 / t30 / rho[0];
  t190 = t74 * rho[0];
  t192 = 0.1e1 / t30 / t190;
  t193 = t192 * t68;
  t198 = 0.1e1 / t89 / t36;
  t200 = t198 * t40 * t42;
  t202 = 0.1e1 / t19 / t168;
  t208 = 0.1e1 / t30 / t46;
  t213 = t90 * t71;
  t214 = t74 * t29;
  t215 = 0.1e1 / t214;
  t219 = t90 * t72;
  t225 = POW_3_2(t62);
  t227 = t225 * t65 * t20;
  t228 = t24 * sigma[0];
  t229 = t27 * t208;
  t233 = 0.1e1 / t21;
  t234 = t108 * t233;
  t235 = t57 * sigma[0];
  t236 = 0.1e1 / t102;
  t242 = t26 / t19 / t93;
  t249 = -0.48653829870107876509e-3 * t200 * t45 * t202 * t53 + 0.32512921810699588477e-1 * t92 * t28 * t208 * t53 - 0.19704801097393689986e-2 * t213 * t72 * t215 - 0.20228913839792803583e-4 * t219 * t215 - 0.19e2 / 0.162e3 * t101 * t45 * t202 + 0.81343574384783731842e-2 * t227 * t228 * t229 + 0.10845809917971164246e-2 * t234 * t235 * t236 + 0.94900836782247687149e-3 * t110 * t111 * t242 + 0.35507115802881787709e-4 * t119 * t28 * t208;
  t254 = t133 * t123;
  t258 = t70 * t70;
  t262 = t3 / t4 / t258 * t17;
  t263 = t74 * t74;
  t264 = t263 * rho[0];
  t266 = 0.1e1 / t30 / t264;
  t267 = t266 * t68;
  t269 = 0.1e1 / t135 / t78;
  t270 = t44 * t44;
  t271 = t270 * t44;
  t272 = t269 * t271;
  t277 = my_piecewise3(t2, 0, t18 * t181 * t68 * t79 / 0.12e2 - t18 * t84 * t123 * t79 / 0.4e1 + 0.25e2 / 0.576e3 * t131 * t193 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * t249 * t79 - t131 * t254 * t137 / 0.96e2 - t262 * t267 * t272 / 0.6912e4);
  tv2rho20 = 0.2e1 * rho[0] * t277 + 0.4e1 * t142;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t284 = t26 * t104;
  t285 = t53 * sigma[0];
  t289 = t27 * t95;
  t293 = 0.1e1 / t190;
  t297 = t90 * t44;
  t303 = t159 * t95;
  t306 = 0.1e1 / t47;
  t315 = 0.18245186201290453691e-3 * t200 * t284 * t285 - 0.88671604938271604939e-2 * t92 * t289 * t53 + 0.73893004115226337449e-3 * t213 * t293 * t44 + 0.75858426899223013437e-5 * t297 * t293 + t101 * t149 * t104 / 0.27e2 - 0.3050384039429389944e-2 * t227 * t303 - 0.40671787192391865921e-3 * t234 * t57 * t306 - 0.2033589359619593296e-3 * t110 * t154 * t114 - 0.9683758855331396648e-5 * t118 * t303;
  t320 = t133 * t163;
  t327 = t170 * t123;
  t332 = 0.1e1 / t30 / t263;
  t333 = t332 * t68;
  t334 = t270 * sigma[0];
  t335 = t269 * t334;
  t340 = my_piecewise3(t2, 0, -t18 * t84 * t163 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t315 * t79 - t131 * t320 * t137 / 0.192e3 - 0.23e2 / 0.1536e4 * t131 * t134 * t172 + t131 * t327 * t172 / 0.512e3 + t262 * t333 * t335 / 0.18432e5);
  tv2rhosigma0 = 0.2e1 * rho[0] * t340 + 0.2e1 * t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t343 = t26 * t49;
  t350 = t90 * t75;
  t353 = t42 * t26;
  t357 = 0.1e1 / sigma[0];
  t358 = t24 * t357;
  t362 = 0.1e1 / t46;
  t366 = 0.1e1 / t235;
  t367 = t55 * t366;
  t371 = -0.68419448254839201342e-4 * t200 * t343 * t53 - 0.27709876543209876543e-3 * t213 * t75 * sigma[0] - 0.28446910087208630037e-5 * t350 * sigma[0] - t100 * t353 * t49 / 0.144e3 + 0.1143894014786021229e-2 * t227 * t358 * t145 + 0.1525192019714694972e-3 * t234 * t362 * t153 - 0.762596009857347486e-4 * t110 * t367 * t155;
  t376 = t170 * t163;
  t380 = t74 * t168;
  t382 = 0.1e1 / t30 / t380;
  t383 = t382 * t68;
  t384 = t269 * t270;
  t388 = t136 * sigma[0];
  t393 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t371 * t79 + t131 * t376 * t172 / 0.256e3 - t262 * t383 * t384 / 0.49152e5 + t131 * t171 * t388 / 0.256e3);
  tv2sigma20 = 0.2e1 * rho[0] * t393;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t405 = 0.1e1 / t30 / t214;
  t406 = t405 * t68;
  t414 = t192 * t123;
  t420 = 0.1e1 / t30 / t263 / t29;
  t421 = t420 * t68;
  t425 = t89 * t89;
  t426 = 0.1e1 / t425;
  t427 = t426 * t71;
  t428 = t74 * t93;
  t429 = 0.1e1 / t428;
  t430 = t72 * t429;
  t435 = 0.1e1 / t19 / t74;
  t440 = t198 * t20;
  t442 = 0.1e1 / t23 / t70;
  t443 = t440 * t442;
  t444 = t270 * t27;
  t445 = t74 * t47;
  t447 = 0.1e1 / t30 / t445;
  t452 = 0.1e1 / t30 / t47;
  t459 = t198 * t71;
  t460 = t459 * t270;
  t465 = t198 * t270;
  t467 = t25 * t27;
  t472 = t45 * t435;
  t475 = sqrt(t62);
  t476 = t475 * t65;
  t477 = t233 * t235;
  t478 = 0.1e1 / t168;
  t482 = t225 * t40;
  t483 = t482 * t42;
  t486 = t27 * t452;
  t490 = t225 * t233;
  t491 = t490 * t44;
  t493 = t55 * t26;
  t494 = t435 * t40 * t493;
  t502 = t26 / t19 / t46;
  t509 = -0.24026582651905124202e-3 * t427 * t430 * t53 + 0.5351921285711866416e-2 * t200 * t45 * t435 * t53 - 0.54059810966786529454e-4 * t443 * t444 * t447 - 0.15172696844993141289e0 * t92 * t28 * t452 * t53 + 0.26929894833104709648e-1 * t213 * t430 - 0.54059810966786529454e-4 * t460 * t447 * t20 * t159 - 0.55497706007662012573e-6 * t465 * t447 * t467 + 0.33040559271661579186e-3 * t219 * t429 + 0.209e3 / 0.243e3 * t101 * t472 - 0.19522457852348095642e0 * t476 * t477 * t478 - 0.18076349863285273743e-2 * t483 * t472 - 0.5694050206934861229e-1 * t227 * t228 * t486 - 0.36152699726570547486e-2 * t491 * t494 - 0.97612289261740478213e-2 * t234 * t235 * t478 - 0.3163361226074922905e-2 * t110 * t111 * t502 - 0.16569987374678167598e-3 * t119 * t28 * t452;
  t514 = t133 * t249;
  t518 = t266 * t123;
  t526 = t3 / t4 / t258 / t70 * t17;
  t529 = 0.1e1 / t30 / t263 / t214;
  t530 = t529 * t68;
  t531 = t135 * t135;
  t532 = 0.1e1 / t531;
  t533 = t270 * t270;
  t534 = t533 * sigma[0];
  t535 = t532 * t534;
  t540 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t18 * t32 * t68 * t79 + t18 * t181 * t123 * t79 / 0.4e1 - 0.241e3 / 0.576e3 * t131 * t406 * t137 - 0.3e1 / 0.8e1 * t18 * t84 * t249 * t79 + 0.25e2 / 0.192e3 * t131 * t414 * t137 + 0.13e2 / 0.3456e4 * t262 * t421 * t272 - 0.3e1 / 0.8e1 * t18 * t19 * t509 * t79 - t131 * t514 * t137 / 0.64e2 - t262 * t518 * t272 / 0.2304e4 - t526 * t530 * t535 / 0.165888e6);
  tv3rho30 = 0.2e1 * rho[0] * t540 + 0.6e1 * t277;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t552 = t192 * t163;
  t556 = t215 * t53;
  t560 = t26 * t202;
  t564 = t74 * t46;
  t566 = 0.1e1 / t30 / t564;
  t567 = t27 * t566;
  t577 = t459 * t566;
  t579 = t72 * t20 * t159;
  t582 = t198 * t72;
  t588 = t149 * t202;
  t597 = t159 * t208;
  t600 = t490 * sigma[0];
  t602 = t202 * t40 * t493;
  t613 = 0.90099684944644215758e-4 * t427 * t556 * t44 - 0.16420667581161408322e-2 * t200 * t560 * t285 + 0.20272429112544948546e-4 * t443 * t567 * t72 + 0.32512921810699588478e-1 * t92 * t229 * t53 - 0.8620850480109739369e-2 * t213 * t215 * t44 + 0.20272429112544948546e-4 * t577 * t579 + 0.20811639752873254715e-6 * t582 * t566 * t467 - 0.10873041188888631926e-3 * t297 * t215 - 0.19e2 / 0.81e2 * t101 * t588 + 0.73209216946305358656e-1 * t476 * t233 * t236 * t57 + 0.67786311987319776533e-3 * t483 * t588 + 0.1525192019714694972e-1 * t227 * t597 + 0.13557262397463955307e-2 * t600 * t602 + 0.28470251034674306144e-2 * t234 * t57 * t236 + 0.47450418391123843573e-3 * t110 * t154 * t242 + 0.35507115802881787709e-4 * t118 * t597;
  t618 = t133 * t315;
  t622 = t266 * t163;
  t635 = t170 * t249;
  t639 = t332 * t123;
  t645 = 0.1e1 / t30 / t263 / t190;
  t646 = t645 * t68;
  t647 = t532 * t533;
  t651 = t18 * t181 * t163 * t79 / 0.12e2 - t18 * t84 * t315 * t79 / 0.4e1 + 0.25e2 / 0.576e3 * t131 * t552 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * t613 * t79 - t131 * t618 * t137 / 0.96e2 - t262 * t622 * t272 / 0.6912e4 + 0.299e3 / 0.2304e4 * t131 * t193 * t172 - 0.23e2 / 0.768e3 * t131 * t254 * t172 - 0.73e2 / 0.55296e5 * t262 * t267 * t335 + t131 * t635 * t172 / 0.512e3 + t262 * t639 * t335 / 0.9216e4 + t526 * t646 * t647 / 0.442368e6;
  t652 = my_piecewise3(t2, 0, t651);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t652 + 0.4e1 * t340;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t659 = t293 * t53;
  t667 = 0.1e1 / t30 / t428;
  t668 = t27 * t667;
  t672 = t459 * t667;
  t674 = t44 * t20 * t159;
  t680 = t198 * t667;
  t684 = t90 * t293;
  t687 = t353 * t104;
  t690 = t233 * t153;
  t699 = t490 * t104;
  t700 = t56 * t26;
  t709 = -0.3378738185424158091e-4 * t427 * t659 * sigma[0] + 0.36490372402580907382e-3 * t200 * t284 * t53 - 0.76021609172043557047e-5 * t443 * t668 * t44 - 0.76021609172043557045e-5 * t672 * t674 + 0.22167901234567901234e-2 * t213 * t293 * sigma[0] - 0.78043649073274705177e-7 * t680 * t44 * t467 + 0.30343370759689205374e-4 * t684 * sigma[0] + t100 * t687 / 0.27e2 - 0.27453456354864509496e-1 * t476 * t690 * t306 - 0.254198669952449162e-3 * t482 * t687 - 0.1525192019714694972e-2 * t227 * t358 * t289 - 0.50839733990489832399e-3 * t699 * t700 - 0.508397339904898324e-3 * t234 * t306 * t153 + 0.1016794679809796648e-3 * t110 * t367 * t114;
  t714 = t133 * t371;
  t721 = t170 * t315;
  t725 = t332 * t163;
  t732 = t382 * t123;
  t738 = 0.1e1 / t30 / t263 / t74;
  t739 = t738 * t68;
  t741 = t532 * t270 * t72;
  t751 = -t18 * t84 * t371 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t709 * t79 - t131 * t714 * t137 / 0.192e3 - 0.23e2 / 0.768e3 * t131 * t320 * t172 + t131 * t721 * t172 / 0.256e3 + t262 * t725 * t335 / 0.9216e4 + 0.7e1 / 0.16384e5 * t262 * t333 * t384 - t262 * t732 * t384 / 0.49152e5 - t526 * t739 * t741 / 0.1179648e7 - 0.23e2 / 0.768e3 * t131 * t134 * t388 + t131 * t327 * t388 / 0.256e3;
  t752 = my_piecewise3(t2, 0, t751);
  tv3rhosigma20 = 0.2e1 * rho[0] * t752 + 0.2e1 * t393;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t762 = t459 * t405;
  t764 = sigma[0] * t20 * t159;
  t769 = t198 * t405;
  t774 = t233 * t366;
  t781 = 0.1e1 / t44;
  t782 = t24 * t781;
  t786 = t490 * t49;
  t788 = t357 * t40 * t493;
  t794 = t57 * t44;
  t795 = 0.1e1 / t794;
  t796 = t55 * t795;
  t800 = 0.12670268195340592841e-4 * t427 * t75 * t53 + 0.28508103439516333893e-5 * t443 * t27 * t405 * sigma[0] + 0.28508103439516333892e-5 * t762 * t764 - 0.27709876543209876543e-3 * t213 * t75 + 0.29266368402478014441e-7 * t769 * sigma[0] * t467 - 0.56893820174417260074e-5 * t350 + 0.10295046133074191061e-1 * t476 * t774 * t362 + 0.9532450123216843575e-4 * t483 * t343 * t357 - 0.17158410221790318435e-2 * t227 * t782 * t145 + 0.1906490024643368715e-3 * t786 * t788 - 0.1143894014786021229e-3 * t234 * t362 * t366 + 0.1143894014786021229e-3 * t110 * t796 * t155;
  t805 = t170 * t371;
  t809 = t382 * t163;
  t818 = 0.1e1 / t30 / t263 / t168;
  t819 = t818 * t68;
  t820 = t532 * t271;
  t824 = t269 * t72;
  t832 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t800 * t79 + 0.3e1 / 0.512e3 * t131 * t805 * t172 - t262 * t809 * t384 / 0.16384e5 + 0.3e1 / 0.256e3 * t131 * t376 * t388 + t526 * t819 * t820 / 0.3145728e7 - t262 * t383 * t824 / 0.8192e4 + t131 * t171 * t136 / 0.256e3);
  tv3sigma30 = 0.2e1 * rho[0] * t832;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t7, t8, t10, t11, t13;
  double t15, t17, t18, t19, t20, t21, t22, t23;
  double t24, t25, t26, t27, t28, t29, t30, t32;
  double t34, t36, t39, t40, t42, t43, t44, t45;
  double t46, t47, t49, t53, t55, t56, t57, t60;
  double t62, t63, t65, t68, t70, t71, t72, t74;
  double t75, t78, t79, t83, tzk0;

  double t84, t89, t90, t92, t93, t95, t100, t101;
  double t102, t104, t108, t110, t111, t114, t118, t119;
  double t123, t131, t133, t134, t135, t136, t137, t142;
  double tvrho0, t145, t149, t153, t154, t155, t159, t163;
  double t168, t170, t171, t172, t177, tvsigma0;

  double t181, t190, t192, t193, t198, t200, t202, t208;
  double t213, t214, t215, t219, t225, t227, t228, t229;
  double t233, t234, t235, t236, t242, t249, t254, t258;
  double t262, t263, t264, t266, t267, t269, t270, t271;
  double t272, t277, tv2rho20, t284, t285, t289, t293, t297;
  double t303, t306, t315, t320, t327, t332, t333, t334;
  double t335, t340, tv2rhosigma0, t343, t350, t353, t357, t358;
  double t362, t366, t367, t371, t376, t380, t382, t383;
  double t384, t388, t393, tv2sigma20;

  double t405, t406, t414, t420, t421, t425, t426, t427;
  double t428, t429, t430, t435, t440, t442, t443, t444;
  double t445, t447, t452, t459, t460, t465, t467, t472;
  double t475, t476, t477, t478, t482, t483, t486, t490;
  double t491, t493, t494, t502, t509, t514, t518, t526;
  double t529, t530, t531, t532, t533, t534, t535, t540;
  double tv3rho30, t552, t556, t560, t564, t566, t567, t577;
  double t579, t582, t588, t597, t600, t602, t613, t618;
  double t622, t635, t639, t645, t646, t647, t651, t652;
  double tv3rho2sigma0, t659, t667, t668, t672, t674, t680, t684;
  double t687, t690, t699, t700, t709, t714, t721, t725;
  double t732, t738, t739, t741, t751, t752, tv3rhosigma20, t762;
  double t764, t769, t774, t781, t782, t786, t788, t794;
  double t795, t796, t800, t805, t809, t818, t819, t820;
  double t824, t832, tv3sigma30;

  double t839, t843, t844, t850, t865, t870, t871, t874;
  double t875, t876, t886, t887, t891, t894, t902, t903;
  double t905, t909, t920, t923, t927, t928, t939, t942;
  double t948, t973, t1025, t1026, tv4rho40, t1094, t1106, t1109;
  double t1117, t1125, t1171, t1193, t1194, tv4rho3sigma0, t1281, t1299;
  double t1338, t1354, t1356, tv4rho2sigma20, t1375, t1423, t1486, t1487;
  double tv4rhosigma30, t1493, t1552, t1595, tv4sigma40;


  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = t3 / t4 * t17;
  t19 = POW_1_3(rho[0]);
  t20 = M_CBRT6;
  t21 = M_PI * M_PI;
  t22 = POW_1_3(t21);
  t23 = t22 * t22;
  t24 = 0.1e1 / t23;
  t25 = t20 * t24;
  t26 = M_CBRT2;
  t27 = t26 * t26;
  t28 = sigma[0] * t27;
  t29 = rho[0] * rho[0];
  t30 = t19 * t19;
  t32 = 0.1e1 / t30 / t29;
  t34 = t25 * t28 * t32;
  t36 = 0.804e0 + 0.5e1 / 0.972e3 * t34;
  t39 = 0.1804e1 - 0.646416e0 / t36;
  t40 = t20 * t20;
  t42 = 0.1e1 / t22 / t21;
  t43 = t40 * t42;
  t44 = sigma[0] * sigma[0];
  t45 = t44 * t26;
  t46 = t29 * t29;
  t47 = t46 * rho[0];
  t49 = 0.1e1 / t19 / t47;
  t53 = 0.1e3 - t43 * t45 * t49 / 0.288e3;
  t55 = 0.1e1 / t22;
  t56 = t40 * t55;
  t57 = sqrt(sigma[0]);
  t60 = 0.1e1 / t19 / rho[0];
  t62 = t56 * t57 * t26 * t60;
  t63 = pow(t62, 0.35e1);
  t65 = 0.1e1 + t34 / 0.24e2;
  t68 = t39 * t53 + 0.87153829697982569831e-4 * t63 * t65;
  t70 = t21 * t21;
  t71 = 0.1e1 / t70;
  t72 = t44 * sigma[0];
  t74 = t46 * t46;
  t75 = 0.1e1 / t74;
  t78 = 0.1e3 + t71 * t72 * t75 / 0.576e3;
  t79 = 0.1e1 / t78;
  t83 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t68 * t79);
  tzk0 = 0.2e1 * t83;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t84 = 0.1e1 / t30;
  t89 = t36 * t36;
  t90 = 0.1e1 / t89;
  t92 = t90 * t20 * t24;
  t93 = t29 * rho[0];
  t95 = 0.1e1 / t30 / t93;
  t100 = t39 * t40;
  t101 = t100 * t42;
  t102 = t46 * t29;
  t104 = 0.1e1 / t19 / t102;
  t108 = pow(t62, 0.25e1);
  t110 = t108 * t65 * t40;
  t111 = t55 * t57;
  t114 = t26 / t19 / t29;
  t118 = t63 * t20;
  t119 = t118 * t24;
  t123 = -0.88671604938271604938e-2 * t92 * t28 * t95 * t53 + t101 * t45 * t104 / 0.54e2 - 0.40671787192391865921e-3 * t110 * t111 * t114 - 0.96837588553313966479e-5 * t119 * t28 * t95;
  t131 = t3 / t4 / t70 * t17;
  t133 = 0.1e1 / t30 / t74;
  t134 = t133 * t68;
  t135 = t78 * t78;
  t136 = 0.1e1 / t135;
  t137 = t136 * t72;
  t142 = my_piecewise3(t2, 0, -t18 * t84 * t68 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t123 * t79 - t131 * t134 * t137 / 0.192e3);
  tvrho0 = 0.2e1 * rho[0] * t142 + 0.2e1 * t83;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t145 = t27 * t32;
  t149 = sigma[0] * t26;
  t153 = 0.1e1 / t57;
  t154 = t55 * t153;
  t155 = t26 * t60;
  t159 = t24 * t27;
  t163 = 0.33251851851851851852e-2 * t92 * t145 * t53 - t101 * t149 * t49 / 0.144e3 + 0.1525192019714694972e-3 * t110 * t154 * t155 + 0.3631409570749273743e-5 * t118 * t159 * t32;
  t168 = t46 * t93;
  t170 = 0.1e1 / t30 / t168;
  t171 = t170 * t68;
  t172 = t136 * t44;
  t177 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t163 * t79 + t131 * t171 * t172 / 0.512e3);
  tvsigma0 = 0.2e1 * rho[0] * t177;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t181 = 0.1e1 / t30 / rho[0];
  t190 = t74 * rho[0];
  t192 = 0.1e1 / t30 / t190;
  t193 = t192 * t68;
  t198 = 0.1e1 / t89 / t36;
  t200 = t198 * t40 * t42;
  t202 = 0.1e1 / t19 / t168;
  t208 = 0.1e1 / t30 / t46;
  t213 = t90 * t71;
  t214 = t74 * t29;
  t215 = 0.1e1 / t214;
  t219 = t90 * t72;
  t225 = POW_3_2(t62);
  t227 = t225 * t65 * t20;
  t228 = t24 * sigma[0];
  t229 = t27 * t208;
  t233 = 0.1e1 / t21;
  t234 = t108 * t233;
  t235 = t57 * sigma[0];
  t236 = 0.1e1 / t102;
  t242 = t26 / t19 / t93;
  t249 = -0.48653829870107876509e-3 * t200 * t45 * t202 * t53 + 0.32512921810699588477e-1 * t92 * t28 * t208 * t53 - 0.19704801097393689986e-2 * t213 * t72 * t215 - 0.20228913839792803583e-4 * t219 * t215 - 0.19e2 / 0.162e3 * t101 * t45 * t202 + 0.81343574384783731842e-2 * t227 * t228 * t229 + 0.10845809917971164246e-2 * t234 * t235 * t236 + 0.94900836782247687149e-3 * t110 * t111 * t242 + 0.35507115802881787709e-4 * t119 * t28 * t208;
  t254 = t133 * t123;
  t258 = t70 * t70;
  t262 = t3 / t4 / t258 * t17;
  t263 = t74 * t74;
  t264 = t263 * rho[0];
  t266 = 0.1e1 / t30 / t264;
  t267 = t266 * t68;
  t269 = 0.1e1 / t135 / t78;
  t270 = t44 * t44;
  t271 = t270 * t44;
  t272 = t269 * t271;
  t277 = my_piecewise3(t2, 0, t18 * t181 * t68 * t79 / 0.12e2 - t18 * t84 * t123 * t79 / 0.4e1 + 0.25e2 / 0.576e3 * t131 * t193 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * t249 * t79 - t131 * t254 * t137 / 0.96e2 - t262 * t267 * t272 / 0.6912e4);
  tv2rho20 = 0.2e1 * rho[0] * t277 + 0.4e1 * t142;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t284 = t26 * t104;
  t285 = t53 * sigma[0];
  t289 = t27 * t95;
  t293 = 0.1e1 / t190;
  t297 = t90 * t44;
  t303 = t159 * t95;
  t306 = 0.1e1 / t47;
  t315 = 0.18245186201290453691e-3 * t200 * t284 * t285 - 0.88671604938271604939e-2 * t92 * t289 * t53 + 0.73893004115226337449e-3 * t213 * t293 * t44 + 0.75858426899223013437e-5 * t297 * t293 + t101 * t149 * t104 / 0.27e2 - 0.3050384039429389944e-2 * t227 * t303 - 0.40671787192391865921e-3 * t234 * t57 * t306 - 0.2033589359619593296e-3 * t110 * t154 * t114 - 0.9683758855331396648e-5 * t118 * t303;
  t320 = t133 * t163;
  t327 = t170 * t123;
  t332 = 0.1e1 / t30 / t263;
  t333 = t332 * t68;
  t334 = t270 * sigma[0];
  t335 = t269 * t334;
  t340 = my_piecewise3(t2, 0, -t18 * t84 * t163 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t315 * t79 - t131 * t320 * t137 / 0.192e3 - 0.23e2 / 0.1536e4 * t131 * t134 * t172 + t131 * t327 * t172 / 0.512e3 + t262 * t333 * t335 / 0.18432e5);
  tv2rhosigma0 = 0.2e1 * rho[0] * t340 + 0.2e1 * t177;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t343 = t26 * t49;
  t350 = t90 * t75;
  t353 = t42 * t26;
  t357 = 0.1e1 / sigma[0];
  t358 = t24 * t357;
  t362 = 0.1e1 / t46;
  t366 = 0.1e1 / t235;
  t367 = t55 * t366;
  t371 = -0.68419448254839201342e-4 * t200 * t343 * t53 - 0.27709876543209876543e-3 * t213 * t75 * sigma[0] - 0.28446910087208630037e-5 * t350 * sigma[0] - t100 * t353 * t49 / 0.144e3 + 0.1143894014786021229e-2 * t227 * t358 * t145 + 0.1525192019714694972e-3 * t234 * t362 * t153 - 0.762596009857347486e-4 * t110 * t367 * t155;
  t376 = t170 * t163;
  t380 = t74 * t168;
  t382 = 0.1e1 / t30 / t380;
  t383 = t382 * t68;
  t384 = t269 * t270;
  t388 = t136 * sigma[0];
  t393 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t371 * t79 + t131 * t376 * t172 / 0.256e3 - t262 * t383 * t384 / 0.49152e5 + t131 * t171 * t388 / 0.256e3);
  tv2sigma20 = 0.2e1 * rho[0] * t393;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t405 = 0.1e1 / t30 / t214;
  t406 = t405 * t68;
  t414 = t192 * t123;
  t420 = 0.1e1 / t30 / t263 / t29;
  t421 = t420 * t68;
  t425 = t89 * t89;
  t426 = 0.1e1 / t425;
  t427 = t426 * t71;
  t428 = t74 * t93;
  t429 = 0.1e1 / t428;
  t430 = t72 * t429;
  t435 = 0.1e1 / t19 / t74;
  t440 = t198 * t20;
  t442 = 0.1e1 / t23 / t70;
  t443 = t440 * t442;
  t444 = t270 * t27;
  t445 = t74 * t47;
  t447 = 0.1e1 / t30 / t445;
  t452 = 0.1e1 / t30 / t47;
  t459 = t198 * t71;
  t460 = t459 * t270;
  t465 = t198 * t270;
  t467 = t25 * t27;
  t472 = t45 * t435;
  t475 = sqrt(t62);
  t476 = t475 * t65;
  t477 = t233 * t235;
  t478 = 0.1e1 / t168;
  t482 = t225 * t40;
  t483 = t482 * t42;
  t486 = t27 * t452;
  t490 = t225 * t233;
  t491 = t490 * t44;
  t493 = t55 * t26;
  t494 = t435 * t40 * t493;
  t502 = t26 / t19 / t46;
  t509 = -0.24026582651905124202e-3 * t427 * t430 * t53 + 0.5351921285711866416e-2 * t200 * t45 * t435 * t53 - 0.54059810966786529454e-4 * t443 * t444 * t447 - 0.15172696844993141289e0 * t92 * t28 * t452 * t53 + 0.26929894833104709648e-1 * t213 * t430 - 0.54059810966786529454e-4 * t460 * t447 * t20 * t159 - 0.55497706007662012573e-6 * t465 * t447 * t467 + 0.33040559271661579186e-3 * t219 * t429 + 0.209e3 / 0.243e3 * t101 * t472 - 0.19522457852348095642e0 * t476 * t477 * t478 - 0.18076349863285273743e-2 * t483 * t472 - 0.5694050206934861229e-1 * t227 * t228 * t486 - 0.36152699726570547486e-2 * t491 * t494 - 0.97612289261740478213e-2 * t234 * t235 * t478 - 0.3163361226074922905e-2 * t110 * t111 * t502 - 0.16569987374678167598e-3 * t119 * t28 * t452;
  t514 = t133 * t249;
  t518 = t266 * t123;
  t526 = t3 / t4 / t258 / t70 * t17;
  t529 = 0.1e1 / t30 / t263 / t214;
  t530 = t529 * t68;
  t531 = t135 * t135;
  t532 = 0.1e1 / t531;
  t533 = t270 * t270;
  t534 = t533 * sigma[0];
  t535 = t532 * t534;
  t540 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t18 * t32 * t68 * t79 + t18 * t181 * t123 * t79 / 0.4e1 - 0.241e3 / 0.576e3 * t131 * t406 * t137 - 0.3e1 / 0.8e1 * t18 * t84 * t249 * t79 + 0.25e2 / 0.192e3 * t131 * t414 * t137 + 0.13e2 / 0.3456e4 * t262 * t421 * t272 - 0.3e1 / 0.8e1 * t18 * t19 * t509 * t79 - t131 * t514 * t137 / 0.64e2 - t262 * t518 * t272 / 0.2304e4 - t526 * t530 * t535 / 0.165888e6);
  tv3rho30 = 0.2e1 * rho[0] * t540 + 0.6e1 * t277;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t552 = t192 * t163;
  t556 = t215 * t53;
  t560 = t26 * t202;
  t564 = t74 * t46;
  t566 = 0.1e1 / t30 / t564;
  t567 = t27 * t566;
  t577 = t459 * t566;
  t579 = t72 * t20 * t159;
  t582 = t198 * t72;
  t588 = t149 * t202;
  t597 = t159 * t208;
  t600 = t490 * sigma[0];
  t602 = t202 * t40 * t493;
  t613 = 0.90099684944644215758e-4 * t427 * t556 * t44 - 0.16420667581161408322e-2 * t200 * t560 * t285 + 0.20272429112544948546e-4 * t443 * t567 * t72 + 0.32512921810699588478e-1 * t92 * t229 * t53 - 0.8620850480109739369e-2 * t213 * t215 * t44 + 0.20272429112544948546e-4 * t577 * t579 + 0.20811639752873254715e-6 * t582 * t566 * t467 - 0.10873041188888631926e-3 * t297 * t215 - 0.19e2 / 0.81e2 * t101 * t588 + 0.73209216946305358656e-1 * t476 * t233 * t236 * t57 + 0.67786311987319776533e-3 * t483 * t588 + 0.1525192019714694972e-1 * t227 * t597 + 0.13557262397463955307e-2 * t600 * t602 + 0.28470251034674306144e-2 * t234 * t57 * t236 + 0.47450418391123843573e-3 * t110 * t154 * t242 + 0.35507115802881787709e-4 * t118 * t597;
  t618 = t133 * t315;
  t622 = t266 * t163;
  t635 = t170 * t249;
  t639 = t332 * t123;
  t645 = 0.1e1 / t30 / t263 / t190;
  t646 = t645 * t68;
  t647 = t532 * t533;
  t651 = t18 * t181 * t163 * t79 / 0.12e2 - t18 * t84 * t315 * t79 / 0.4e1 + 0.25e2 / 0.576e3 * t131 * t552 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * t613 * t79 - t131 * t618 * t137 / 0.96e2 - t262 * t622 * t272 / 0.6912e4 + 0.299e3 / 0.2304e4 * t131 * t193 * t172 - 0.23e2 / 0.768e3 * t131 * t254 * t172 - 0.73e2 / 0.55296e5 * t262 * t267 * t335 + t131 * t635 * t172 / 0.512e3 + t262 * t639 * t335 / 0.9216e4 + t526 * t646 * t647 / 0.442368e6;
  t652 = my_piecewise3(t2, 0, t651);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t652 + 0.4e1 * t340;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t659 = t293 * t53;
  t667 = 0.1e1 / t30 / t428;
  t668 = t27 * t667;
  t672 = t459 * t667;
  t674 = t44 * t20 * t159;
  t680 = t198 * t667;
  t684 = t90 * t293;
  t687 = t353 * t104;
  t690 = t233 * t153;
  t699 = t490 * t104;
  t700 = t56 * t26;
  t709 = -0.3378738185424158091e-4 * t427 * t659 * sigma[0] + 0.36490372402580907382e-3 * t200 * t284 * t53 - 0.76021609172043557047e-5 * t443 * t668 * t44 - 0.76021609172043557045e-5 * t672 * t674 + 0.22167901234567901234e-2 * t213 * t293 * sigma[0] - 0.78043649073274705177e-7 * t680 * t44 * t467 + 0.30343370759689205374e-4 * t684 * sigma[0] + t100 * t687 / 0.27e2 - 0.27453456354864509496e-1 * t476 * t690 * t306 - 0.254198669952449162e-3 * t482 * t687 - 0.1525192019714694972e-2 * t227 * t358 * t289 - 0.50839733990489832399e-3 * t699 * t700 - 0.508397339904898324e-3 * t234 * t306 * t153 + 0.1016794679809796648e-3 * t110 * t367 * t114;
  t714 = t133 * t371;
  t721 = t170 * t315;
  t725 = t332 * t163;
  t732 = t382 * t123;
  t738 = 0.1e1 / t30 / t263 / t74;
  t739 = t738 * t68;
  t741 = t532 * t270 * t72;
  t751 = -t18 * t84 * t371 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t709 * t79 - t131 * t714 * t137 / 0.192e3 - 0.23e2 / 0.768e3 * t131 * t320 * t172 + t131 * t721 * t172 / 0.256e3 + t262 * t725 * t335 / 0.9216e4 + 0.7e1 / 0.16384e5 * t262 * t333 * t384 - t262 * t732 * t384 / 0.49152e5 - t526 * t739 * t741 / 0.1179648e7 - 0.23e2 / 0.768e3 * t131 * t134 * t388 + t131 * t327 * t388 / 0.256e3;
  t752 = my_piecewise3(t2, 0, t751);
  tv3rhosigma20 = 0.2e1 * rho[0] * t752 + 0.2e1 * t393;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t762 = t459 * t405;
  t764 = sigma[0] * t20 * t159;
  t769 = t198 * t405;
  t774 = t233 * t366;
  t781 = 0.1e1 / t44;
  t782 = t24 * t781;
  t786 = t490 * t49;
  t788 = t357 * t40 * t493;
  t794 = t57 * t44;
  t795 = 0.1e1 / t794;
  t796 = t55 * t795;
  t800 = 0.12670268195340592841e-4 * t427 * t75 * t53 + 0.28508103439516333893e-5 * t443 * t27 * t405 * sigma[0] + 0.28508103439516333892e-5 * t762 * t764 - 0.27709876543209876543e-3 * t213 * t75 + 0.29266368402478014441e-7 * t769 * sigma[0] * t467 - 0.56893820174417260074e-5 * t350 + 0.10295046133074191061e-1 * t476 * t774 * t362 + 0.9532450123216843575e-4 * t483 * t343 * t357 - 0.17158410221790318435e-2 * t227 * t782 * t145 + 0.1906490024643368715e-3 * t786 * t788 - 0.1143894014786021229e-3 * t234 * t362 * t366 + 0.1143894014786021229e-3 * t110 * t796 * t155;
  t805 = t170 * t371;
  t809 = t382 * t163;
  t818 = 0.1e1 / t30 / t263 / t168;
  t819 = t818 * t68;
  t820 = t532 * t271;
  t824 = t269 * t72;
  t832 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t800 * t79 + 0.3e1 / 0.512e3 * t131 * t805 * t172 - t262 * t809 * t384 / 0.16384e5 + 0.3e1 / 0.256e3 * t131 * t376 * t388 + t526 * t819 * t820 / 0.3145728e7 - t262 * t383 * t824 / 0.8192e4 + t131 * t171 * t136 / 0.256e3);
  tv3sigma30 = 0.2e1 * rho[0] * t832;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t839 = t258 * t258;
  t843 = t3 / t4 / t839 * t17;
  t844 = t263 * t263;
  t850 = 0.1e1 / t531 / t78;
  t865 = 0.1e1 / t30 / t102;
  t870 = 0.1e1 / t19 / t190;
  t871 = t45 * t870;
  t874 = t475 * t20;
  t875 = t874 * t24;
  t876 = t794 * t27;
  t886 = 0.1e1/sqrt(t62);
  t887 = t886 * t65;
  t891 = t870 * t40 * t493;
  t894 = t27 * t865;
  t902 = 0.1e1 / t425 / t36 * t71;
  t903 = t74 * t102;
  t905 = 0.1e1 / t30 / t903;
  t909 = t53 * t20 * t159;
  t920 = 0.93896595123176283055e-3 * t119 * t28 * t865 - 0.5225e4 / 0.729e3 * t101 * t871 + 0.65074859507826985474e-1 * t875 * t876 * t405 * t233 + 0.27717069790370753072e-1 * t483 * t871 + 0.13707898646324665922e-1 * t110 * t111 * t343 + 0.13014971901565397095e0 * t887 * t233 * t44 * t891 + 0.38593006958114059441e0 * t227 * t228 * t894 + 0.62664679526055615642e-1 * t491 * t891 - 0.13183310097067283513e-4 * t902 * t270 * t905 * t909 - 0.52924554936484012336e-1 * t200 * t45 * t870 * t53 + 0.85978615454961133971e0 * t92 * t28 * t865 * t53;
  t923 = t874 / t23 / t21;
  t927 = 0.1e1 / t564;
  t928 = t72 * t927;
  t939 = t426 * t40 / t22 / t70 / t21;
  t942 = 0.1e1 / t19 / t264;
  t948 = t43 * t26;
  t973 = 0.21691619835942328492e-1 * t923 * t876 * t405 + 0.52858481834191273244e-2 * t427 * t928 * t53 + 0.13334753371807343932e-2 * t443 * t444 * t905 - 0.44493671577602081855e-5 * t939 * t334 * t26 * t942 - 0.45677124286141574134e-7 * t426 * t334 * t942 * t948 + 0.27331440993287333899e1 * t476 * t477 * t75 + 0.81825610381138005811e-1 * t234 * t235 * t75 - 0.88987343155204163711e-5 * t427 * t334 * t942 * t40 * t353 + 0.14776348330921651384e-2 * t460 * t905 * t20 * t159 + 0.16649311802298603772e-4 * t465 * t905 * t467 - 0.32994594726413656455e0 * t213 * t928 - 0.45739821848864839214e-2 * t219 * t927;
  t1025 = -t526 * t529 * t123 * t535 / 0.41472e5 - t843 / t30 / t844 / t93 * t68 * t850 * t533 * t270 / 0.2985984e7 - t262 * t266 * t249 * t272 / 0.1152e4 - t131 * t133 * t509 * t137 / 0.48e2 - 0.3e1 / 0.8e1 * t18 * t19 * (t920 + t973) * t79 + t18 * t181 * t249 * t79 / 0.2e1 - t18 * t84 * t509 * t79 / 0.2e1 - 0.5e1 / 0.9e1 * t18 * t32 * t123 * t79 + 0.79e2 / 0.248832e6 * t526 / t30 / t263 / t428 * t68 * t535 + 0.13e2 / 0.864e3 * t262 * t420 * t123 * t272 + 0.25e2 / 0.96e2 * t131 * t192 * t249 * t137 - 0.241e3 / 0.144e3 * t131 * t405 * t123 * t137 - 0.1697e4 / 0.20736e5 * t262 / t30 / t263 / t93 * t68 * t272 + 0.1e2 / 0.27e2 * t18 * t95 * t68 * t79 + 0.11563e5 / 0.2592e4 * t131 * t667 * t68 * t137;
  t1026 = my_piecewise3(t2, 0, t1025);
  tv4rho40 = 0.2e1 * rho[0] * t1026 + 0.8e1 * t540;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1094 = t159 * t452;
  t1106 = t149 * t435;
  t1109 = t235 * t27;
  t1117 = 0.1e1 / t19 / t263;
  t1125 = -0.19432076103031669273e-1 * t600 * t494 - 0.15816806130374614524e-2 * t110 * t154 * t502 - 0.80665711264910534075e-1 * t227 * t1094 - 0.1517269684499314129e0 * t92 * t486 * t53 - 0.49329577507192708129e-3 * t459 * t447 * t579 - 0.56191427332757787731e-5 * t582 * t447 * t467 + 0.418e3 / 0.243e3 * t101 * t1106 - 0.24403072315435119552e-1 * t875 * t1109 * t192 * t233 - 0.83603118117694391058e-2 * t483 * t1106 + 0.33370253683201561392e-5 * t427 * t1117 * t43 * t270 * t26 - 0.16569987374678167598e-3 * t118 * t1094;
  t1171 = -0.43923596410514055183e-3 * t443 * t27 * t447 * t72 + 0.16685126841600780696e-5 * t939 * t26 * t1117 * t270 + 0.171289216073030903e-7 * t426 * t270 * t1117 * t948 - 0.80530138640935894522e0 * t476 * t233 * t478 * t57 - 0.8134357438478373184e-2 * t923 * t1109 * t192 - 0.17118940139482400994e-2 * t427 * t429 * t53 * t44 + 0.93433598536808413352e-1 * t213 * t429 * t44 + 0.13435370275262387047e-2 * t297 * t429 + 0.13825796654755654908e-1 * t200 * t26 * t435 * t285 - 0.48806144630870239104e-1 * t887 * t233 * t435 * sigma[0] * t40 * t493 + 0.49437412864002313173e-5 * t902 * t447 * t53 * t579 - 0.19703221350980948379e-1 * t234 * t57 * t478;
  t1193 = -0.8671e4 / 0.6912e4 * t131 * t406 * t172 + t526 * t645 * t123 * t647 / 0.147456e6 + t843 / t30 / t844 / t29 * t68 * t850 * t533 * t72 / 0.7962624e7 + t262 * t332 * t249 * t335 / 0.6144e4 - 0.25e2 / 0.221184e6 * t526 * t530 * t647 + t131 * t170 * t509 * t172 / 0.512e3 - 0.23e2 / 0.512e3 * t131 * t514 * t172 - 0.73e2 / 0.18432e5 * t262 * t518 * t335 - t526 * t529 * t163 * t535 / 0.165888e6 + 0.299e3 / 0.768e3 * t131 * t414 * t172 + 0.1489e4 / 0.55296e5 * t262 * t421 * t335 - t262 * t266 * t315 * t272 / 0.2304e4 - t131 * t133 * t613 * t137 / 0.64e2 + 0.13e2 / 0.3456e4 * t262 * t420 * t163 * t272 + 0.25e2 / 0.192e3 * t131 * t192 * t315 * t137 - 0.3e1 / 0.8e1 * t18 * t19 * (t1125 + t1171) * t79 - 0.3e1 / 0.8e1 * t18 * t84 * t613 * t79 + t18 * t181 * t315 * t79 / 0.4e1 - 0.241e3 / 0.576e3 * t131 * t405 * t163 * t137 - 0.5e1 / 0.36e2 * t18 * t32 * t163 * t79;
  t1194 = my_piecewise3(t2, 0, t1193);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t1194 + 0.6e1 * t652;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t1281 = 0.1e1 / t19 / t380;
  t1299 = t353 * t202;
  t1338 = 0.3050384039429389944e-2 * t923 * t27 * t133 * t57 + 0.48428580657746265971e-3 * t427 * t556 * sigma[0] + 0.12923673559247404698e-3 * t443 * t567 * t44 - 0.62569225656002927611e-6 * t939 * t26 * t1281 * t72 - 0.64233456027386588623e-8 * t426 * t1281 * t72 * t948 - 0.19e2 / 0.81e2 * t100 * t1299 + 0.3558781379334288268e-2 * t227 * t358 * t229 - 0.23725209195561921787e-3 * t110 * t367 * t242 - 0.1853902982400086744e-5 * t902 * t566 * t53 * t674 + 0.14950916470501899552e-3 * t577 * t674 - 0.31354816451678845554e-3 * t90 * t215 * sigma[0];
  t1354 = -t262 * t266 * t371 * t272 / 0.6912e4 - 0.23e2 / 0.384e3 * t131 * t618 * t172 - 0.73e2 / 0.27648e5 * t262 * t622 * t335 + t131 * t170 * t613 * t172 / 0.256e3 - t131 * t133 * t709 * t137 / 0.96e2 + 0.25e2 / 0.576e3 * t131 * t192 * t371 * t137 + t18 * t181 * t371 * t79 / 0.12e2 - 0.3e1 / 0.8e1 * t18 * t19 * (0.17429748293031350823e-5 * t198 * t566 * t44 * t467 + 0.18302304236576339664e-1 * t887 * t233 * t602 + 0.91511521182881698319e-2 * t875 * t57 * t27 * t133 * t233 + 0.49145076190806837986e-2 * t490 * t202 * t700 - 0.12513845131200585522e-5 * t427 * t1281 * t43 * t72 * t26 - 0.23110569188301241342e-2 * t200 * t560 * t53 - 0.19951111111111111111e-1 * t213 * t215 * sigma[0] + 0.24064140755498520669e-2 * t234 * t236 * t153 + 0.17387189024747522681e0 * t476 * t690 * t236 + 0.19488564696354435754e-2 * t482 * t1299 + t1338) * t79 - t18 * t84 * t709 * t79 / 0.4e1 - 0.1759e4 / 0.221184e6 * t262 * t267 * t384 + 0.299e3 / 0.1152e4 * t131 * t552 * t172;
  t1356 = my_piecewise3(t2, 0, 0.299e3 / 0.1152e4 * t131 * t193 * t388 - t843 / t30 / t844 / rho[0] * t68 * t850 * t533 * t44 / 0.21233664e8 - 0.23e2 / 0.384e3 * t131 * t254 * t388 + t131 * t635 * t388 / 0.256e3 + 0.137e3 / 0.3538944e7 * t526 * t646 * t741 - t262 * t382 * t249 * t384 / 0.49152e5 - t526 * t738 * t123 * t741 / 0.589824e6 + t262 * t332 * t315 * t335 / 0.4608e4 + t526 * t645 * t163 * t647 / 0.221184e6 + 0.7e1 / 0.8192e4 * t262 * t639 * t384 + t1354);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t1356 + 0.4e1 * t752;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t1375 = 0.1e1 / t19 / t903;
  t1423 = -0.46826189443964823105e-6 * t680 * sigma[0] * t467 - 0.3431682044358063687e-2 * t875 * t153 * t27 * t170 * t233 - 0.127099334976224581e-3 * t483 * t284 * t357 + 0.46926919242002195707e-6 * t427 * t1375 * t43 * t45 - 0.30408643668817422819e-4 * t443 * t668 * sigma[0] + 0.45515056139533808059e-4 * t684 - 0.1143894014786021229e-2 * t923 * t27 * t170 * t153 + 0.23463459621001097854e-6 * t939 * t26 * t1375 * t44 + 0.24087546010269970733e-8 * t426 * t1375 * t44 * t948 - 0.635496674881122905e-3 * t699 * t788 - 0.1525192019714694972e-3 * t110 * t796 * t114 + 0.695213618400032529e-6 * t902 * t667 * t53 * t764 - 0.38010804586021778522e-4 * t672 * t764 - 0.68633640887161273739e-2 * t887 * t233 * t357 * t104 * t40 * t493 + 0.2287788029572042458e-2 * t227 * t782 * t289 + 0.3050384039429389944e-3 * t234 * t306 * t366 - 0.10136214556272474273e-3 * t427 * t659 + 0.22167901234567901234e-2 * t213 * t293;
  t1486 = -t18 * t84 * t800 * t79 / 0.8e1 - 0.3e1 / 0.8e1 * t18 * t19 * t1423 * t79 - t131 * t133 * t800 * t137 / 0.192e3 - 0.23e2 / 0.512e3 * t131 * t714 * t172 + 0.3e1 / 0.512e3 * t131 * t170 * t709 * t172 + t262 * t332 * t371 * t335 / 0.6144e4 + 0.21e2 / 0.16384e5 * t262 * t725 * t384 - t262 * t382 * t315 * t384 / 0.16384e5 - t526 * t738 * t163 * t741 / 0.393216e6 - 0.23e2 / 0.256e3 * t131 * t320 * t388 + 0.3e1 / 0.256e3 * t131 * t721 * t388 - 0.119e3 / 0.9437184e7 * t526 * t739 * t820 + t526 * t818 * t123 * t820 / 0.3145728e7 + t843 / t30 / t844 * t68 * t850 * t534 / 0.56623104e8 + 0.149e3 / 0.73728e5 * t262 * t333 * t824 - t262 * t732 * t824 / 0.8192e4 - 0.23e2 / 0.768e3 * t131 * t134 * t136 + t131 * t327 * t136 / 0.256e3;
  t1487 = my_piecewise3(t2, 0, t1486);
  tv4rhosigma30 = 0.2e1 * rho[0] * t1487 + 0.2e1 * t832;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t1493 = 0.1e1 / t19 / t445;
  t1552 = 0.87799105207434043324e-7 * t769 * t467 - 0.9032829753851239025e-9 * t426 * t1493 * sigma[0] * t948 - 0.30885138399222573184e-1 * t476 * t233 * t795 * t362 + 0.42896025554475796088e-3 * t923 * t894 * t366 + 0.28508103439516333893e-5 * t440 * t442 * t27 * t405 - 0.87987973578754116954e-7 * t939 * t26 * t1493 * sigma[0] - 0.28597350369650530725e-3 * t110 * t55 / t57 / t72 * t155 + 0.25737615332685477652e-2 * t887 * t233 * t781 * t49 * t40 * t493 + 0.42896025554475796088e-2 * t227 * t24 / t72 * t145 - 0.33363575431258952512e-3 * t786 * t781 * t40 * t493 + 0.2287788029572042458e-3 * t234 * t362 * t795 + 0.12868807666342738826e-2 * t875 * t894 * t774 - 0.23831125308042108937e-3 * t483 * t343 * t781 - 0.26070510690001219837e-6 * t902 * t405 * t909 - 0.1759759471575082339e-6 * t427 * t1493 * t43 * t149 + 0.57016206879032667784e-5 * t762 * t467;
  t1595 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t18 * t19 * t1552 * t79 + t131 * t170 * t800 * t172 / 0.128e3 - t262 * t382 * t371 * t384 / 0.8192e4 + 0.3e1 / 0.128e3 * t131 * t805 * t388 + t526 * t818 * t163 * t820 / 0.786432e6 - t262 * t809 * t824 / 0.2048e4 + t131 * t376 * t136 / 0.64e2 - t843 / t30 / t263 / t380 * t68 * t850 * t533 / 0.150994944e9 + t526 * t819 * t532 * t334 / 0.262144e6 - 0.5e1 / 0.12288e5 * t262 * t383 * t269 * t44);
  tv4sigma40 = 0.2e1 * rho[0] * t1595;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t40;
  double t42, t45, t46, t48, t49, t50, t51, t52;
  double t54, t58, t60, t61, t62, t64, t66, t67;
  double t69, t72, t73, t74, t75, t76, t78, t79;
  double t82, t83, t84, t87, t88, t89, t90, t91;
  double t92, t94, t95, t96, t97, t98, t100, t102;
  double t104, t107, t108, t109, t110, t112, t116, t118;
  double t120, t122, t123, t125, t128, t129, t130, t132;
  double t133, t136, t137, t138, t141, tzk0;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t45 = 0.1804e1 - 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t58 = 0.1e3 - t49 * t50 * t54 / 0.576e3;
  t60 = 0.1e1 / t30;
  t61 = t46 * t60;
  t62 = sqrt(sigma[0]);
  t64 = 0.1e1 / t35 / rho[0];
  t66 = t61 * t62 * t64;
  t67 = pow(t66, 0.35e1);
  t69 = 0.1e1 + t40 / 0.24e2;
  t72 = t45 * t58 + 0.87153829697982569831e-4 * t67 * t69;
  t73 = t27 * t72;
  t74 = t29 * t29;
  t75 = 0.1e1 / t74;
  t76 = t50 * sigma[0];
  t78 = t51 * t51;
  t79 = 0.1e1 / t78;
  t82 = 0.1e3 + t75 * t76 * t79 / 0.2304e4;
  t83 = 0.1e1 / t82;
  t84 = t73 * t83;
  t87 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t84);
  t88 = rho[1] <= p->dens_threshold;
  t89 = my_piecewise5(t14, t11, t10, t15, -t17);
  t90 = 0.1e1 + t89;
  t91 = t90 <= p->zeta_threshold;
  t92 = POW_1_3(t90);
  t94 = my_piecewise3(t91, t22, t92 * t90);
  t95 = t5 * t94;
  t96 = rho[1] * rho[1];
  t97 = POW_1_3(rho[1]);
  t98 = t97 * t97;
  t100 = 0.1e1 / t98 / t96;
  t102 = t33 * sigma[2] * t100;
  t104 = 0.804e0 + 0.5e1 / 0.972e3 * t102;
  t107 = 0.1804e1 - 0.646416e0 / t104;
  t108 = sigma[2] * sigma[2];
  t109 = t96 * t96;
  t110 = t109 * rho[1];
  t112 = 0.1e1 / t97 / t110;
  t116 = 0.1e3 - t49 * t108 * t112 / 0.576e3;
  t118 = sqrt(sigma[2]);
  t120 = 0.1e1 / t97 / rho[1];
  t122 = t61 * t118 * t120;
  t123 = pow(t122, 0.35e1);
  t125 = 0.1e1 + t102 / 0.24e2;
  t128 = t107 * t116 + 0.87153829697982569831e-4 * t123 * t125;
  t129 = t27 * t128;
  t130 = t108 * sigma[2];
  t132 = t109 * t109;
  t133 = 0.1e1 / t132;
  t136 = 0.1e3 + t75 * t130 * t133 / 0.2304e4;
  t137 = 0.1e1 / t136;
  t138 = t129 * t137;
  t141 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t138);
  tzk0 = t87 + t141;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t40;
  double t42, t45, t46, t48, t49, t50, t51, t52;
  double t54, t58, t60, t61, t62, t64, t66, t67;
  double t69, t72, t73, t74, t75, t76, t78, t79;
  double t82, t83, t84, t87, t88, t89, t90, t91;
  double t92, t94, t95, t96, t97, t98, t100, t102;
  double t104, t107, t108, t109, t110, t112, t116, t118;
  double t120, t122, t123, t125, t128, t129, t130, t132;
  double t133, t136, t137, t138, t141, tzk0;

  double t142, t143, t144, t145, t146, t149, t150, t153;
  double t154, t155, t156, t158, t159, t160, t161, t162;
  double t163, t165, t170, t171, t172, t174, t178, t180;
  double t181, t183, t187, t188, t192, t193, t194, t199;
  double t200, t201, t202, t203, t204, t205, t206, t207;
  double t208, t212, t214, t217, t218, t221, t222, t224;
  double t226, tvrho0, t229, t230, t233, t234, t238, t240;
  double t243, t244, t247, t248, t249, t250, t251, t253;
  double t258, t259, t260, t262, t266, t268, t269, t271;
  double t275, t276, t280, t281, t282, t285, t286, t287;
  double t288, t289, t290, t291, t292, t293, t297, tvrho1;
  double t300, t304, t308, t309, t315, t316, t317, t320;
  double t321, t325, tvsigma0, tvsigma1, t326, t330, t334, t335;
  double t341, t342, t343, t346, t347, t351, tvsigma2;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t45 = 0.1804e1 - 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t58 = 0.1e3 - t49 * t50 * t54 / 0.576e3;
  t60 = 0.1e1 / t30;
  t61 = t46 * t60;
  t62 = sqrt(sigma[0]);
  t64 = 0.1e1 / t35 / rho[0];
  t66 = t61 * t62 * t64;
  t67 = pow(t66, 0.35e1);
  t69 = 0.1e1 + t40 / 0.24e2;
  t72 = t45 * t58 + 0.87153829697982569831e-4 * t67 * t69;
  t73 = t27 * t72;
  t74 = t29 * t29;
  t75 = 0.1e1 / t74;
  t76 = t50 * sigma[0];
  t78 = t51 * t51;
  t79 = 0.1e1 / t78;
  t82 = 0.1e3 + t75 * t76 * t79 / 0.2304e4;
  t83 = 0.1e1 / t82;
  t84 = t73 * t83;
  t87 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t84);
  t88 = rho[1] <= p->dens_threshold;
  t89 = my_piecewise5(t14, t11, t10, t15, -t17);
  t90 = 0.1e1 + t89;
  t91 = t90 <= p->zeta_threshold;
  t92 = POW_1_3(t90);
  t94 = my_piecewise3(t91, t22, t92 * t90);
  t95 = t5 * t94;
  t96 = rho[1] * rho[1];
  t97 = POW_1_3(rho[1]);
  t98 = t97 * t97;
  t100 = 0.1e1 / t98 / t96;
  t102 = t33 * sigma[2] * t100;
  t104 = 0.804e0 + 0.5e1 / 0.972e3 * t102;
  t107 = 0.1804e1 - 0.646416e0 / t104;
  t108 = sigma[2] * sigma[2];
  t109 = t96 * t96;
  t110 = t109 * rho[1];
  t112 = 0.1e1 / t97 / t110;
  t116 = 0.1e3 - t49 * t108 * t112 / 0.576e3;
  t118 = sqrt(sigma[2]);
  t120 = 0.1e1 / t97 / rho[1];
  t122 = t61 * t118 * t120;
  t123 = pow(t122, 0.35e1);
  t125 = 0.1e1 + t102 / 0.24e2;
  t128 = t107 * t116 + 0.87153829697982569831e-4 * t123 * t125;
  t129 = t27 * t128;
  t130 = t108 * sigma[2];
  t132 = t109 * t109;
  t133 = 0.1e1 / t132;
  t136 = 0.1e3 + t75 * t130 * t133 / 0.2304e4;
  t137 = 0.1e1 / t136;
  t138 = t129 * t137;
  t141 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t138);
  tzk0 = t87 + t141;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t142 = t6 * t6;
  t143 = 0.1e1 / t142;
  t144 = t16 * t143;
  t145 = t7 - t144;
  t146 = my_piecewise5(t10, 0, t14, 0, t145);
  t149 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t146);
  t150 = t5 * t149;
  t153 = t27 * t27;
  t154 = 0.1e1 / t153;
  t155 = t154 * t72;
  t156 = t155 * t83;
  t158 = t26 * t156 / 0.8e1;
  t159 = t42 * t42;
  t160 = 0.1e1 / t159;
  t161 = t160 * t28;
  t162 = t161 * t32;
  t163 = t34 * rho[0];
  t165 = 0.1e1 / t36 / t163;
  t170 = t45 * t46;
  t171 = t48 * t50;
  t172 = t51 * t34;
  t174 = 0.1e1 / t35 / t172;
  t178 = pow(t66, 0.25e1);
  t180 = t178 * t69 * t46;
  t181 = t60 * t62;
  t183 = 0.1e1 / t35 / t34;
  t187 = t67 * t28;
  t188 = t32 * sigma[0];
  t192 = -0.88671604938271604938e-2 * t162 * sigma[0] * t165 * t58 + t170 * t171 * t174 / 0.108e3 - 0.40671787192391865921e-3 * t180 * t181 * t183 - 0.96837588553313966479e-5 * t187 * t188 * t165;
  t193 = t27 * t192;
  t194 = t193 * t83;
  t199 = t2 / t3 / t74;
  t200 = t25 * t27;
  t201 = t199 * t200;
  t202 = t82 * t82;
  t203 = 0.1e1 / t202;
  t204 = t72 * t203;
  t205 = t78 * rho[0];
  t206 = 0.1e1 / t205;
  t207 = t76 * t206;
  t208 = t204 * t207;
  t212 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t150 * t84 - t158 - 0.3e1 / 0.8e1 * t26 * t194 - t201 * t208 / 0.768e3);
  t214 = my_piecewise5(t14, 0, t10, 0, -t145);
  t217 = my_piecewise3(t91, 0, 0.4e1 / 0.3e1 * t92 * t214);
  t218 = t5 * t217;
  t221 = t154 * t128;
  t222 = t221 * t137;
  t224 = t95 * t222 / 0.8e1;
  t226 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t218 * t138 - t224);
  tvrho0 = t87 + t141 + t6 * (t212 + t226);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t229 = -t7 - t144;
  t230 = my_piecewise5(t10, 0, t14, 0, t229);
  t233 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t230);
  t234 = t5 * t233;
  t238 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t234 * t84 - t158);
  t240 = my_piecewise5(t14, 0, t10, 0, -t229);
  t243 = my_piecewise3(t91, 0, 0.4e1 / 0.3e1 * t92 * t240);
  t244 = t5 * t243;
  t247 = t104 * t104;
  t248 = 0.1e1 / t247;
  t249 = t248 * t28;
  t250 = t249 * t32;
  t251 = t96 * rho[1];
  t253 = 0.1e1 / t98 / t251;
  t258 = t107 * t46;
  t259 = t48 * t108;
  t260 = t109 * t96;
  t262 = 0.1e1 / t97 / t260;
  t266 = pow(t122, 0.25e1);
  t268 = t266 * t125 * t46;
  t269 = t60 * t118;
  t271 = 0.1e1 / t97 / t96;
  t275 = t123 * t28;
  t276 = t32 * sigma[2];
  t280 = -0.88671604938271604938e-2 * t250 * sigma[2] * t253 * t116 + t258 * t259 * t262 / 0.108e3 - 0.40671787192391865921e-3 * t268 * t269 * t271 - 0.96837588553313966479e-5 * t275 * t276 * t253;
  t281 = t27 * t280;
  t282 = t281 * t137;
  t285 = t94 * t27;
  t286 = t199 * t285;
  t287 = t136 * t136;
  t288 = 0.1e1 / t287;
  t289 = t128 * t288;
  t290 = t132 * rho[1];
  t291 = 0.1e1 / t290;
  t292 = t130 * t291;
  t293 = t289 * t292;
  t297 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t244 * t138 - t224 - 0.3e1 / 0.8e1 * t95 * t282 - t286 * t293 / 0.768e3);
  tvrho1 = t87 + t141 + t6 * (t238 + t297);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t300 = t32 * t38;
  t304 = t48 * sigma[0];
  t308 = 0.1e1 / t62;
  t309 = t60 * t308;
  t315 = 0.33251851851851851852e-2 * t161 * t300 * t58 - t170 * t304 * t54 / 0.288e3 + 0.1525192019714694972e-3 * t180 * t309 * t64 + 0.3631409570749273743e-5 * t187 * t300;
  t316 = t27 * t315;
  t317 = t316 * t83;
  t320 = t50 * t79;
  t321 = t204 * t320;
  t325 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t317 + t201 * t321 / 0.2048e4);
  tvsigma0 = t6 * t325;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t326 = t32 * t100;
  t330 = t48 * sigma[2];
  t334 = 0.1e1 / t118;
  t335 = t60 * t334;
  t341 = 0.33251851851851851852e-2 * t249 * t326 * t116 - t258 * t330 * t112 / 0.288e3 + 0.1525192019714694972e-3 * t268 * t335 * t120 + 0.3631409570749273743e-5 * t275 * t326;
  t342 = t27 * t341;
  t343 = t342 * t137;
  t346 = t108 * t133;
  t347 = t289 * t346;
  t351 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t343 + t286 * t347 / 0.2048e4);
  tvsigma2 = t6 * t351;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t40;
  double t42, t45, t46, t48, t49, t50, t51, t52;
  double t54, t58, t60, t61, t62, t64, t66, t67;
  double t69, t72, t73, t74, t75, t76, t78, t79;
  double t82, t83, t84, t87, t88, t89, t90, t91;
  double t92, t94, t95, t96, t97, t98, t100, t102;
  double t104, t107, t108, t109, t110, t112, t116, t118;
  double t120, t122, t123, t125, t128, t129, t130, t132;
  double t133, t136, t137, t138, t141, tzk0;

  double t142, t143, t144, t145, t146, t149, t150, t153;
  double t154, t155, t156, t158, t159, t160, t161, t162;
  double t163, t165, t170, t171, t172, t174, t178, t180;
  double t181, t183, t187, t188, t192, t193, t194, t199;
  double t200, t201, t202, t203, t204, t205, t206, t207;
  double t208, t212, t214, t217, t218, t221, t222, t224;
  double t226, tvrho0, t229, t230, t233, t234, t238, t240;
  double t243, t244, t247, t248, t249, t250, t251, t253;
  double t258, t259, t260, t262, t266, t268, t269, t271;
  double t275, t276, t280, t281, t282, t285, t286, t287;
  double t288, t289, t290, t291, t292, t293, t297, tvrho1;
  double t300, t304, t308, t309, t315, t316, t317, t320;
  double t321, t325, tvsigma0, tvsigma1, t326, t330, t334, t335;
  double t341, t342, t343, t346, t347, t351, tvsigma2;

  double t354, t355, t356, t359, t360, t361, t363, t364;
  double t368, t369, t372, t376, t377, t381, t383, t385;
  double t387, t388, t390, t391, t392, t395, t396, t397;
  double t398, t400, t406, t411, t412, t413, t414, t417;
  double t423, t424, t425, t426, t429, t430, t431, t432;
  double t437, t443, t445, t448, t449, t452, t455, t456;
  double t458, t459, t460, t461, t462, t464, t465, t466;
  double t469, t472, t473, t474, t475, t476, t480, t484;
  double t485, t488, t491, t493, t495, tv2rho20, t498, t501;
  double t502, t506, t507, t510, t514, t515, t522, t523;
  double t526, t530, t531, t534, t540, t541, t543, t544;
  double t547, t548, t549, t552, tv2rho21, t557, t561, t562;
  double t566, t567, t572, t573, t577, t581, t582, t588;
  double t589, t595, t596, t597, t598, t600, t606, t611;
  double t612, t613, t614, t617, t623, t624, t625, t626;
  double t629, t630, t631, t636, t642, t644, t647, t648;
  double t651, t653, t654, t655, t656, t657, t659, t660;
  double t661, t664, t667, t668, tv2rho22, t674, t676, t681;
  double t685, t688, t697, t706, t708, t711, t712, t718;
  double t719, t722, t723, t724, t725, t726, t729, t733;
  double tv2rhosigma0, tv2rhosigma1, t738, t740, t744, t746, tv2rhosigma2, t753;
  double tv2rhosigma3, tv2rhosigma4, t761, t765, t768, t777, t786, t788;
  double t791, t792, t797, t800, t801, t802, t803, t804;
  double t807, t811, tv2rhosigma5, t813, t817, t820, t825, t826;
  double t830, t834, t835, t839, t841, t844, t847, t848;
  double t849, t852, t856, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t857, t861, t864, t869, t870, t874, t878, t879;
  double t883, t885, t888, t891, t892, t893, t896, t900;
  double tv2sigma25;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t45 = 0.1804e1 - 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t58 = 0.1e3 - t49 * t50 * t54 / 0.576e3;
  t60 = 0.1e1 / t30;
  t61 = t46 * t60;
  t62 = sqrt(sigma[0]);
  t64 = 0.1e1 / t35 / rho[0];
  t66 = t61 * t62 * t64;
  t67 = pow(t66, 0.35e1);
  t69 = 0.1e1 + t40 / 0.24e2;
  t72 = t45 * t58 + 0.87153829697982569831e-4 * t67 * t69;
  t73 = t27 * t72;
  t74 = t29 * t29;
  t75 = 0.1e1 / t74;
  t76 = t50 * sigma[0];
  t78 = t51 * t51;
  t79 = 0.1e1 / t78;
  t82 = 0.1e3 + t75 * t76 * t79 / 0.2304e4;
  t83 = 0.1e1 / t82;
  t84 = t73 * t83;
  t87 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t84);
  t88 = rho[1] <= p->dens_threshold;
  t89 = my_piecewise5(t14, t11, t10, t15, -t17);
  t90 = 0.1e1 + t89;
  t91 = t90 <= p->zeta_threshold;
  t92 = POW_1_3(t90);
  t94 = my_piecewise3(t91, t22, t92 * t90);
  t95 = t5 * t94;
  t96 = rho[1] * rho[1];
  t97 = POW_1_3(rho[1]);
  t98 = t97 * t97;
  t100 = 0.1e1 / t98 / t96;
  t102 = t33 * sigma[2] * t100;
  t104 = 0.804e0 + 0.5e1 / 0.972e3 * t102;
  t107 = 0.1804e1 - 0.646416e0 / t104;
  t108 = sigma[2] * sigma[2];
  t109 = t96 * t96;
  t110 = t109 * rho[1];
  t112 = 0.1e1 / t97 / t110;
  t116 = 0.1e3 - t49 * t108 * t112 / 0.576e3;
  t118 = sqrt(sigma[2]);
  t120 = 0.1e1 / t97 / rho[1];
  t122 = t61 * t118 * t120;
  t123 = pow(t122, 0.35e1);
  t125 = 0.1e1 + t102 / 0.24e2;
  t128 = t107 * t116 + 0.87153829697982569831e-4 * t123 * t125;
  t129 = t27 * t128;
  t130 = t108 * sigma[2];
  t132 = t109 * t109;
  t133 = 0.1e1 / t132;
  t136 = 0.1e3 + t75 * t130 * t133 / 0.2304e4;
  t137 = 0.1e1 / t136;
  t138 = t129 * t137;
  t141 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t138);
  tzk0 = t87 + t141;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t142 = t6 * t6;
  t143 = 0.1e1 / t142;
  t144 = t16 * t143;
  t145 = t7 - t144;
  t146 = my_piecewise5(t10, 0, t14, 0, t145);
  t149 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t146);
  t150 = t5 * t149;
  t153 = t27 * t27;
  t154 = 0.1e1 / t153;
  t155 = t154 * t72;
  t156 = t155 * t83;
  t158 = t26 * t156 / 0.8e1;
  t159 = t42 * t42;
  t160 = 0.1e1 / t159;
  t161 = t160 * t28;
  t162 = t161 * t32;
  t163 = t34 * rho[0];
  t165 = 0.1e1 / t36 / t163;
  t170 = t45 * t46;
  t171 = t48 * t50;
  t172 = t51 * t34;
  t174 = 0.1e1 / t35 / t172;
  t178 = pow(t66, 0.25e1);
  t180 = t178 * t69 * t46;
  t181 = t60 * t62;
  t183 = 0.1e1 / t35 / t34;
  t187 = t67 * t28;
  t188 = t32 * sigma[0];
  t192 = -0.88671604938271604938e-2 * t162 * sigma[0] * t165 * t58 + t170 * t171 * t174 / 0.108e3 - 0.40671787192391865921e-3 * t180 * t181 * t183 - 0.96837588553313966479e-5 * t187 * t188 * t165;
  t193 = t27 * t192;
  t194 = t193 * t83;
  t199 = t2 / t3 / t74;
  t200 = t25 * t27;
  t201 = t199 * t200;
  t202 = t82 * t82;
  t203 = 0.1e1 / t202;
  t204 = t72 * t203;
  t205 = t78 * rho[0];
  t206 = 0.1e1 / t205;
  t207 = t76 * t206;
  t208 = t204 * t207;
  t212 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t150 * t84 - t158 - 0.3e1 / 0.8e1 * t26 * t194 - t201 * t208 / 0.768e3);
  t214 = my_piecewise5(t14, 0, t10, 0, -t145);
  t217 = my_piecewise3(t91, 0, 0.4e1 / 0.3e1 * t92 * t214);
  t218 = t5 * t217;
  t221 = t154 * t128;
  t222 = t221 * t137;
  t224 = t95 * t222 / 0.8e1;
  t226 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t218 * t138 - t224);
  tvrho0 = t87 + t141 + t6 * (t212 + t226);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t229 = -t7 - t144;
  t230 = my_piecewise5(t10, 0, t14, 0, t229);
  t233 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t230);
  t234 = t5 * t233;
  t238 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t234 * t84 - t158);
  t240 = my_piecewise5(t14, 0, t10, 0, -t229);
  t243 = my_piecewise3(t91, 0, 0.4e1 / 0.3e1 * t92 * t240);
  t244 = t5 * t243;
  t247 = t104 * t104;
  t248 = 0.1e1 / t247;
  t249 = t248 * t28;
  t250 = t249 * t32;
  t251 = t96 * rho[1];
  t253 = 0.1e1 / t98 / t251;
  t258 = t107 * t46;
  t259 = t48 * t108;
  t260 = t109 * t96;
  t262 = 0.1e1 / t97 / t260;
  t266 = pow(t122, 0.25e1);
  t268 = t266 * t125 * t46;
  t269 = t60 * t118;
  t271 = 0.1e1 / t97 / t96;
  t275 = t123 * t28;
  t276 = t32 * sigma[2];
  t280 = -0.88671604938271604938e-2 * t250 * sigma[2] * t253 * t116 + t258 * t259 * t262 / 0.108e3 - 0.40671787192391865921e-3 * t268 * t269 * t271 - 0.96837588553313966479e-5 * t275 * t276 * t253;
  t281 = t27 * t280;
  t282 = t281 * t137;
  t285 = t94 * t27;
  t286 = t199 * t285;
  t287 = t136 * t136;
  t288 = 0.1e1 / t287;
  t289 = t128 * t288;
  t290 = t132 * rho[1];
  t291 = 0.1e1 / t290;
  t292 = t130 * t291;
  t293 = t289 * t292;
  t297 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t244 * t138 - t224 - 0.3e1 / 0.8e1 * t95 * t282 - t286 * t293 / 0.768e3);
  tvrho1 = t87 + t141 + t6 * (t238 + t297);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t300 = t32 * t38;
  t304 = t48 * sigma[0];
  t308 = 0.1e1 / t62;
  t309 = t60 * t308;
  t315 = 0.33251851851851851852e-2 * t161 * t300 * t58 - t170 * t304 * t54 / 0.288e3 + 0.1525192019714694972e-3 * t180 * t309 * t64 + 0.3631409570749273743e-5 * t187 * t300;
  t316 = t27 * t315;
  t317 = t316 * t83;
  t320 = t50 * t79;
  t321 = t204 * t320;
  t325 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t317 + t201 * t321 / 0.2048e4);
  tvsigma0 = t6 * t325;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t326 = t32 * t100;
  t330 = t48 * sigma[2];
  t334 = 0.1e1 / t118;
  t335 = t60 * t334;
  t341 = 0.33251851851851851852e-2 * t249 * t326 * t116 - t258 * t330 * t112 / 0.288e3 + 0.1525192019714694972e-3 * t268 * t335 * t120 + 0.3631409570749273743e-5 * t275 * t326;
  t342 = t27 * t341;
  t343 = t342 * t137;
  t346 = t108 * t133;
  t347 = t289 * t346;
  t351 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t343 + t286 * t347 / 0.2048e4);
  tvsigma2 = t6 * t351;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t354 = t23 * t23;
  t355 = 0.1e1 / t354;
  t356 = t146 * t146;
  t359 = t142 * t6;
  t360 = 0.1e1 / t359;
  t361 = t16 * t360;
  t363 = -0.2e1 * t143 + 0.2e1 * t361;
  t364 = my_piecewise5(t10, 0, t14, 0, t363);
  t368 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t355 * t356 + 0.4e1 / 0.3e1 * t23 * t364);
  t369 = t5 * t368;
  t372 = t150 * t156;
  t376 = t149 * t27;
  t377 = t199 * t376;
  t381 = 0.1e1 / t153 / t6;
  t383 = t381 * t72 * t83;
  t385 = t26 * t383 / 0.12e2;
  t387 = t154 * t192 * t83;
  t388 = t26 * t387;
  t390 = t25 * t154;
  t391 = t199 * t390;
  t392 = t391 * t208;
  t395 = 0.1e1 / t159 / t42;
  t396 = t395 * t46;
  t397 = t396 * t48;
  t398 = t51 * t163;
  t400 = 0.1e1 / t35 / t398;
  t406 = 0.1e1 / t36 / t51;
  t411 = t160 * t75;
  t412 = t78 * t34;
  t413 = 0.1e1 / t412;
  t414 = t76 * t413;
  t417 = t160 * t76;
  t423 = POW_3_2(t66);
  t424 = t423 * t69;
  t425 = t424 * t28;
  t426 = t188 * t406;
  t429 = 0.1e1 / t29;
  t430 = t178 * t429;
  t431 = t62 * sigma[0];
  t432 = 0.1e1 / t172;
  t437 = 0.1e1 / t35 / t163;
  t443 = -0.24326914935053938255e-3 * t397 * t50 * t400 * t58 + 0.32512921810699588477e-1 * t162 * sigma[0] * t406 * t58 - 0.49262002743484224966e-3 * t411 * t414 - 0.50572284599482008956e-5 * t417 * t413 - 0.19e2 / 0.324e3 * t170 * t171 * t400 + 0.81343574384783731842e-2 * t425 * t426 + 0.54229049589855821228e-3 * t430 * t431 * t432 + 0.94900836782247687149e-3 * t180 * t181 * t437 + 0.35507115802881787709e-4 * t187 * t426;
  t445 = t27 * t443 * t83;
  t448 = t192 * t203;
  t449 = t448 * t207;
  t452 = t74 * t74;
  t455 = t2 / t3 / t452;
  t456 = t455 * t200;
  t458 = 0.1e1 / t202 / t82;
  t459 = t72 * t458;
  t460 = t50 * t50;
  t461 = t460 * t50;
  t462 = t78 * t78;
  t464 = 0.1e1 / t462 / t34;
  t465 = t461 * t464;
  t466 = t459 * t465;
  t469 = t204 * t414;
  t472 = -0.3e1 / 0.8e1 * t369 * t84 - t372 / 0.4e1 - 0.3e1 / 0.4e1 * t150 * t194 - t377 * t208 / 0.384e3 + t385 - t388 / 0.4e1 - t392 / 0.1152e4 - 0.3e1 / 0.8e1 * t26 * t445 - t201 * t449 / 0.384e3 - t456 * t466 / 0.110592e6 + 0.3e1 / 0.256e3 * t201 * t469;
  t473 = my_piecewise3(t1, 0, t472);
  t474 = t92 * t92;
  t475 = 0.1e1 / t474;
  t476 = t214 * t214;
  t480 = my_piecewise5(t14, 0, t10, 0, -t363);
  t484 = my_piecewise3(t91, 0, 0.4e1 / 0.9e1 * t475 * t476 + 0.4e1 / 0.3e1 * t92 * t480);
  t485 = t5 * t484;
  t488 = t218 * t222;
  t491 = t381 * t128 * t137;
  t493 = t95 * t491 / 0.12e2;
  t495 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t485 * t138 - t488 / 0.4e1 + t493);
  tv2rho20 = 0.2e1 * t212 + 0.2e1 * t226 + t6 * (t473 + t495);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t498 = t355 * t230;
  t501 = 0.2e1 * t361;
  t502 = my_piecewise5(t10, 0, t14, 0, t501);
  t506 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t498 * t146 + 0.4e1 / 0.3e1 * t23 * t502);
  t507 = t5 * t506;
  t510 = t234 * t156;
  t514 = t233 * t27;
  t515 = t199 * t514;
  t522 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t507 * t84 - t510 / 0.8e1 - 0.3e1 / 0.8e1 * t234 * t194 - t515 * t208 / 0.768e3 - t372 / 0.8e1 + t385 - t388 / 0.8e1 - t392 / 0.2304e4);
  t523 = t475 * t240;
  t526 = my_piecewise5(t14, 0, t10, 0, -t501);
  t530 = my_piecewise3(t91, 0, 0.4e1 / 0.9e1 * t523 * t214 + 0.4e1 / 0.3e1 * t92 * t526);
  t531 = t5 * t530;
  t534 = t244 * t222;
  t540 = t154 * t280 * t137;
  t541 = t95 * t540;
  t543 = t217 * t27;
  t544 = t199 * t543;
  t547 = t94 * t154;
  t548 = t199 * t547;
  t549 = t548 * t293;
  t552 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t531 * t138 - t534 / 0.8e1 - t488 / 0.8e1 + t493 - 0.3e1 / 0.8e1 * t218 * t282 - t541 / 0.8e1 - t544 * t293 / 0.768e3 - t549 / 0.2304e4);
  tv2rho21 = t212 + t226 + t238 + t297 + t6 * (t522 + t552);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t557 = t230 * t230;
  t561 = 0.2e1 * t143 + 0.2e1 * t361;
  t562 = my_piecewise5(t10, 0, t14, 0, t561);
  t566 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t355 * t557 + 0.4e1 / 0.3e1 * t23 * t562);
  t567 = t5 * t566;
  t572 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t567 * t84 - t510 / 0.4e1 + t385);
  t573 = t240 * t240;
  t577 = my_piecewise5(t14, 0, t10, 0, -t561);
  t581 = my_piecewise3(t91, 0, 0.4e1 / 0.9e1 * t475 * t573 + 0.4e1 / 0.3e1 * t92 * t577);
  t582 = t5 * t581;
  t588 = t243 * t27;
  t589 = t199 * t588;
  t595 = 0.1e1 / t247 / t104;
  t596 = t595 * t46;
  t597 = t596 * t48;
  t598 = t109 * t251;
  t600 = 0.1e1 / t97 / t598;
  t606 = 0.1e1 / t98 / t109;
  t611 = t248 * t75;
  t612 = t132 * t96;
  t613 = 0.1e1 / t612;
  t614 = t130 * t613;
  t617 = t248 * t130;
  t623 = POW_3_2(t122);
  t624 = t623 * t125;
  t625 = t624 * t28;
  t626 = t276 * t606;
  t629 = t266 * t429;
  t630 = t118 * sigma[2];
  t631 = 0.1e1 / t260;
  t636 = 0.1e1 / t97 / t251;
  t642 = -0.24326914935053938255e-3 * t597 * t108 * t600 * t116 + 0.32512921810699588477e-1 * t250 * sigma[2] * t606 * t116 - 0.49262002743484224966e-3 * t611 * t614 - 0.50572284599482008956e-5 * t617 * t613 - 0.19e2 / 0.324e3 * t258 * t259 * t600 + 0.81343574384783731842e-2 * t625 * t626 + 0.54229049589855821228e-3 * t629 * t630 * t631 + 0.94900836782247687149e-3 * t268 * t269 * t636 + 0.35507115802881787709e-4 * t275 * t626;
  t644 = t27 * t642 * t137;
  t647 = t280 * t288;
  t648 = t647 * t292;
  t651 = t455 * t285;
  t653 = 0.1e1 / t287 / t136;
  t654 = t128 * t653;
  t655 = t108 * t108;
  t656 = t655 * t108;
  t657 = t132 * t132;
  t659 = 0.1e1 / t657 / t96;
  t660 = t656 * t659;
  t661 = t654 * t660;
  t664 = t289 * t614;
  t667 = -0.3e1 / 0.8e1 * t582 * t138 - t534 / 0.4e1 - 0.3e1 / 0.4e1 * t244 * t282 - t589 * t293 / 0.384e3 + t493 - t541 / 0.4e1 - t549 / 0.1152e4 - 0.3e1 / 0.8e1 * t95 * t644 - t286 * t648 / 0.384e3 - t651 * t661 / 0.110592e6 + 0.3e1 / 0.256e3 * t286 * t664;
  t668 = my_piecewise3(t88, 0, t667);
  tv2rho22 = 0.2e1 * t238 + 0.2e1 * t297 + t6 * (t572 + t668);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t674 = t154 * t315 * t83;
  t676 = t26 * t674 / 0.8e1;
  t681 = t32 * t165;
  t685 = t206 * t50;
  t688 = t160 * t50;
  t697 = 0.1e1 / t52;
  t706 = 0.91225931006452268455e-4 * t397 * t174 * t58 * sigma[0] - 0.88671604938271604939e-2 * t161 * t681 * t58 + 0.18473251028806584362e-3 * t411 * t685 + 0.18964606724805753359e-5 * t688 * t206 + t170 * t304 * t174 / 0.54e2 - 0.3050384039429389944e-2 * t424 * t33 * t165 - 0.2033589359619593296e-3 * t430 * t62 * t697 - 0.2033589359619593296e-3 * t180 * t309 * t183 - 0.9683758855331396648e-5 * t187 * t681;
  t708 = t27 * t706 * t83;
  t711 = t315 * t203;
  t712 = t711 * t207;
  t718 = t391 * t321 / 0.6144e4;
  t719 = t448 * t320;
  t722 = t460 * sigma[0];
  t723 = t462 * rho[0];
  t724 = 0.1e1 / t723;
  t725 = t722 * t724;
  t726 = t459 * t725;
  t729 = t204 * t685;
  t733 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t150 * t317 - t676 - 0.3e1 / 0.8e1 * t26 * t708 - t201 * t712 / 0.768e3 + t377 * t321 / 0.2048e4 + t718 + t201 * t719 / 0.2048e4 + t456 * t726 / 0.294912e6 - t201 * t729 / 0.256e3);
  tv2rhosigma0 = t6 * t733 + t325;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t738 = t154 * t341 * t137;
  t740 = t95 * t738 / 0.8e1;
  t744 = t548 * t347 / 0.6144e4;
  t746 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t218 * t343 - t740 + t544 * t347 / 0.2048e4 + t744);
  tv2rhosigma2 = t6 * t746 + t351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t753 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t234 * t317 - t676 + t515 * t321 / 0.2048e4 + t718);
  tv2rhosigma3 = t6 * t753 + t325;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t761 = t32 * t253;
  t765 = t291 * t108;
  t768 = t248 * t108;
  t777 = 0.1e1 / t110;
  t786 = 0.91225931006452268455e-4 * t597 * t262 * t116 * sigma[2] - 0.88671604938271604939e-2 * t249 * t761 * t116 + 0.18473251028806584362e-3 * t611 * t765 + 0.18964606724805753359e-5 * t768 * t291 + t258 * t330 * t262 / 0.54e2 - 0.3050384039429389944e-2 * t624 * t33 * t253 - 0.2033589359619593296e-3 * t629 * t118 * t777 - 0.2033589359619593296e-3 * t268 * t335 * t271 - 0.9683758855331396648e-5 * t275 * t761;
  t788 = t27 * t786 * t137;
  t791 = t341 * t288;
  t792 = t791 * t292;
  t797 = t647 * t346;
  t800 = t655 * sigma[2];
  t801 = t657 * rho[1];
  t802 = 0.1e1 / t801;
  t803 = t800 * t802;
  t804 = t654 * t803;
  t807 = t289 * t765;
  t811 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t244 * t343 - t740 - 0.3e1 / 0.8e1 * t95 * t788 - t286 * t792 / 0.768e3 + t589 * t347 / 0.2048e4 + t744 + t286 * t797 / 0.2048e4 + t651 * t804 / 0.294912e6 - t286 * t807 / 0.256e3);
  tv2rhosigma5 = t6 * t811 + t351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t813 = t48 * t54;
  t817 = t79 * sigma[0];
  t820 = t160 * t79;
  t825 = 0.1e1 / sigma[0];
  t826 = t32 * t825;
  t830 = 0.1e1 / t51;
  t834 = 0.1e1 / t431;
  t835 = t60 * t834;
  t839 = -0.34209724127419600671e-4 * t396 * t813 * t58 - 0.69274691358024691358e-4 * t411 * t817 - 0.71117275218021575094e-6 * t820 * sigma[0] - t170 * t813 / 0.288e3 + 0.1143894014786021229e-2 * t425 * t826 * t38 + 0.76259600985734748602e-4 * t430 * t830 * t308 - 0.762596009857347486e-4 * t180 * t835 * t64;
  t841 = t27 * t839 * t83;
  t844 = t711 * t320;
  t847 = 0.1e1 / t462;
  t848 = t460 * t847;
  t849 = t459 * t848;
  t852 = t204 * t817;
  t856 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t841 + t201 * t844 / 0.1024e4 - t456 * t849 / 0.786432e6 + t201 * t852 / 0.1024e4);
  tv2sigma20 = t6 * t856;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t857 = t48 * t112;
  t861 = t133 * sigma[2];
  t864 = t248 * t133;
  t869 = 0.1e1 / sigma[2];
  t870 = t32 * t869;
  t874 = 0.1e1 / t109;
  t878 = 0.1e1 / t630;
  t879 = t60 * t878;
  t883 = -0.34209724127419600671e-4 * t596 * t857 * t116 - 0.69274691358024691358e-4 * t611 * t861 - 0.71117275218021575094e-6 * t864 * sigma[2] - t258 * t857 / 0.288e3 + 0.1143894014786021229e-2 * t625 * t870 * t100 + 0.76259600985734748602e-4 * t629 * t874 * t334 - 0.762596009857347486e-4 * t268 * t879 * t120;
  t885 = t27 * t883 * t137;
  t888 = t791 * t346;
  t891 = 0.1e1 / t657;
  t892 = t655 * t891;
  t893 = t654 * t892;
  t896 = t289 * t861;
  t900 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t885 + t286 * t888 / 0.1024e4 - t651 * t893 / 0.786432e6 + t286 * t896 / 0.1024e4);
  tv2sigma25 = t6 * t900;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t40;
  double t42, t45, t46, t48, t49, t50, t51, t52;
  double t54, t58, t60, t61, t62, t64, t66, t67;
  double t69, t72, t73, t74, t75, t76, t78, t79;
  double t82, t83, t84, t87, t88, t89, t90, t91;
  double t92, t94, t95, t96, t97, t98, t100, t102;
  double t104, t107, t108, t109, t110, t112, t116, t118;
  double t120, t122, t123, t125, t128, t129, t130, t132;
  double t133, t136, t137, t138, t141, tzk0;

  double t142, t143, t144, t145, t146, t149, t150, t153;
  double t154, t155, t156, t158, t159, t160, t161, t162;
  double t163, t165, t170, t171, t172, t174, t178, t180;
  double t181, t183, t187, t188, t192, t193, t194, t199;
  double t200, t201, t202, t203, t204, t205, t206, t207;
  double t208, t212, t214, t217, t218, t221, t222, t224;
  double t226, tvrho0, t229, t230, t233, t234, t238, t240;
  double t243, t244, t247, t248, t249, t250, t251, t253;
  double t258, t259, t260, t262, t266, t268, t269, t271;
  double t275, t276, t280, t281, t282, t285, t286, t287;
  double t288, t289, t290, t291, t292, t293, t297, tvrho1;
  double t300, t304, t308, t309, t315, t316, t317, t320;
  double t321, t325, tvsigma0, tvsigma1, t326, t330, t334, t335;
  double t341, t342, t343, t346, t347, t351, tvsigma2;

  double t354, t355, t356, t359, t360, t361, t363, t364;
  double t368, t369, t372, t376, t377, t381, t383, t385;
  double t387, t388, t390, t391, t392, t395, t396, t397;
  double t398, t400, t406, t411, t412, t413, t414, t417;
  double t423, t424, t425, t426, t429, t430, t431, t432;
  double t437, t443, t445, t448, t449, t452, t455, t456;
  double t458, t459, t460, t461, t462, t464, t465, t466;
  double t469, t472, t473, t474, t475, t476, t480, t484;
  double t485, t488, t491, t493, t495, tv2rho20, t498, t501;
  double t502, t506, t507, t510, t514, t515, t522, t523;
  double t526, t530, t531, t534, t540, t541, t543, t544;
  double t547, t548, t549, t552, tv2rho21, t557, t561, t562;
  double t566, t567, t572, t573, t577, t581, t582, t588;
  double t589, t595, t596, t597, t598, t600, t606, t611;
  double t612, t613, t614, t617, t623, t624, t625, t626;
  double t629, t630, t631, t636, t642, t644, t647, t648;
  double t651, t653, t654, t655, t656, t657, t659, t660;
  double t661, t664, t667, t668, tv2rho22, t674, t676, t681;
  double t685, t688, t697, t706, t708, t711, t712, t718;
  double t719, t722, t723, t724, t725, t726, t729, t733;
  double tv2rhosigma0, tv2rhosigma1, t738, t740, t744, t746, tv2rhosigma2, t753;
  double tv2rhosigma3, tv2rhosigma4, t761, t765, t768, t777, t786, t788;
  double t791, t792, t797, t800, t801, t802, t803, t804;
  double t807, t811, tv2rhosigma5, t813, t817, t820, t825, t826;
  double t830, t834, t835, t839, t841, t844, t847, t848;
  double t849, t852, t856, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t857, t861, t864, t869, t870, t874, t878, t879;
  double t883, t885, t888, t891, t892, t893, t896, t900;
  double tv2sigma25;

  double t904, t905, t906, t909, t910, t913, t914, t915;
  double t917, t918, t921, t922, t928, t929, t930, t931;
  double t932, t933, t934, t935, t937, t938, t939, t944;
  double t947, t948, t949, t951, t953, t954, t956, t957;
  double t958, t961, t964, t966, t969, t972, t974, t976;
  double t977, t979, t980, t981, t986, t991, t993, t994;
  double t995, t997, t1002, t1009, t1010, t1012, t1015, t1020;
  double t1023, t1024, t1025, t1026, t1030, t1033, t1036, t1037;
  double t1039, t1046, t1052, t1054, t1058, t1059, t1062, t1063;
  double t1066, t1067, t1070, t1073, t1074, t1075, t1077, t1078;
  double t1082, t1083, t1088, t1092, t1094, t1096, t1097, t1100;
  double t1104, t1108, t1109, t1112, t1114, t1117, t1119, t1121;
  double tv3rho30, t1124, t1125, t1127, t1128, t1130, t1131, t1134;
  double t1135, t1137, t1140, t1147, t1150, t1151, t1154, t1159;
  double t1160, t1161, t1162, t1166, t1167, t1181, t1183, t1184;
  double t1187, t1193, t1197, t1198, t1202, t1203, t1210, t1212;
  double t1213, t1215, t1216, t1219, t1220, t1222, t1223, t1224;
  double t1225, t1227, t1228, tv3rho31, t1231, t1236, t1239, t1240;
  double t1244, t1245, t1248, t1252, t1253, t1260, t1261, t1262;
  double t1267, t1271, t1275, t1276, t1279, t1284, t1286, t1287;
  double t1290, t1291, t1292, t1295, t1301, t1302, t1306, t1308;
  double t1311, t1312, t1316, t1318, t1320, tv3rho32, t1325, t1331;
  double t1332, t1336, t1337, t1343, t1346, t1347, t1350, t1351;
  double t1352, t1353, t1354, t1355, t1356, t1358, t1359, t1360;
  double t1363, t1364, t1367, t1368, t1373, t1376, t1380, t1381;
  double t1382, t1385, t1386, t1387, t1392, t1396, t1397, t1398;
  double t1403, t1408, t1409, t1410, t1412, t1417, t1424, t1425;
  double t1427, t1430, t1435, t1438, t1439, t1440, t1441, t1445;
  double t1448, t1451, t1452, t1454, t1461, t1467, t1469, t1474;
  double t1480, t1484, t1485, t1495, t1497, tv3rho33, t1501, t1502;
  double t1505, t1506, t1509, t1512, t1517, t1518, t1520, t1523;
  double t1524, t1533, t1535, t1536, t1538, t1541, t1545, t1546;
  double t1547, t1552, t1554, t1555, t1558, t1566, t1568, t1569;
  double t1573, t1579, t1581, t1584, t1591, t1603, t1605, t1616;
  double t1618, t1626, t1627, t1629, t1632, t1634, t1635, t1637;
  double tv3rho2sigma0, tv3rho2sigma1, t1642, t1645, t1647, t1650, t1653, t1655;
  double tv3rho2sigma2, t1659, t1670, t1682, t1683, tv3rho2sigma3, tv3rho2sigma4, t1687;
  double t1693, t1694, t1698, t1702, t1707, t1711, t1715, t1717;
  double t1718, tv3rho2sigma5, t1728, tv3rho2sigma6, tv3rho2sigma7, t1731, t1739, t1741;
  double t1742, t1746, t1750, t1753, t1755, t1758, t1765, t1777;
  double t1779, t1790, t1792, t1804, t1809, t1812, t1813, t1816;
  double t1817, t1820, t1824, t1825, t1826, t1829, t1830, t1833;
  double t1834, t1843, t1850, t1852, tv3rho2sigma8, t1857, t1859, t1860;
  double t1864, t1869, t1870, t1874, t1876, t1879, t1882, t1885;
  double t1890, t1909, t1911, t1914, t1915, t1921, t1922, t1925;
  double t1928, t1934, t1935, t1938, t1940, t1941, t1942, t1945;
  double t1946, t1952, t1953, t1956, t1959, t1960, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1965, t1967, t1971, t1975, t1979;
  double t1981, tv3rhosigma25, t1992, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t1996, t2000, t2005, t2006, t2010, t2012, t2015, t2018;
  double t2021, t2026, t2045, t2047, t2050, t2051, t2056, t2059;
  double t2062, t2067, t2070, t2072, t2073, t2074, t2077, t2078;
  double t2083, t2086, t2089, t2090, tv3rhosigma211, t2096, t2097, t2103;
  double t2108, t2119, t2120, t2124, t2126, t2132, t2133, t2134;
  double t2138, t2140, t2143, t2146, t2149, t2153, t2154, t2155;
  double t2158, t2159, t2162, t2163, t2164, t2168, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2173;
  double t2174, t2180, t2185, t2196, t2197, t2201, t2203, t2209;
  double t2210, t2211, t2215, t2217, t2220, t2223, t2226, t2230;
  double t2231, t2232, t2235, t2236, t2239, t2240, t2241, t2245;
  double tv3sigma39;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t45 = 0.1804e1 - 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t58 = 0.1e3 - t49 * t50 * t54 / 0.576e3;
  t60 = 0.1e1 / t30;
  t61 = t46 * t60;
  t62 = sqrt(sigma[0]);
  t64 = 0.1e1 / t35 / rho[0];
  t66 = t61 * t62 * t64;
  t67 = pow(t66, 0.35e1);
  t69 = 0.1e1 + t40 / 0.24e2;
  t72 = t45 * t58 + 0.87153829697982569831e-4 * t67 * t69;
  t73 = t27 * t72;
  t74 = t29 * t29;
  t75 = 0.1e1 / t74;
  t76 = t50 * sigma[0];
  t78 = t51 * t51;
  t79 = 0.1e1 / t78;
  t82 = 0.1e3 + t75 * t76 * t79 / 0.2304e4;
  t83 = 0.1e1 / t82;
  t84 = t73 * t83;
  t87 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t84);
  t88 = rho[1] <= p->dens_threshold;
  t89 = my_piecewise5(t14, t11, t10, t15, -t17);
  t90 = 0.1e1 + t89;
  t91 = t90 <= p->zeta_threshold;
  t92 = POW_1_3(t90);
  t94 = my_piecewise3(t91, t22, t92 * t90);
  t95 = t5 * t94;
  t96 = rho[1] * rho[1];
  t97 = POW_1_3(rho[1]);
  t98 = t97 * t97;
  t100 = 0.1e1 / t98 / t96;
  t102 = t33 * sigma[2] * t100;
  t104 = 0.804e0 + 0.5e1 / 0.972e3 * t102;
  t107 = 0.1804e1 - 0.646416e0 / t104;
  t108 = sigma[2] * sigma[2];
  t109 = t96 * t96;
  t110 = t109 * rho[1];
  t112 = 0.1e1 / t97 / t110;
  t116 = 0.1e3 - t49 * t108 * t112 / 0.576e3;
  t118 = sqrt(sigma[2]);
  t120 = 0.1e1 / t97 / rho[1];
  t122 = t61 * t118 * t120;
  t123 = pow(t122, 0.35e1);
  t125 = 0.1e1 + t102 / 0.24e2;
  t128 = t107 * t116 + 0.87153829697982569831e-4 * t123 * t125;
  t129 = t27 * t128;
  t130 = t108 * sigma[2];
  t132 = t109 * t109;
  t133 = 0.1e1 / t132;
  t136 = 0.1e3 + t75 * t130 * t133 / 0.2304e4;
  t137 = 0.1e1 / t136;
  t138 = t129 * t137;
  t141 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t138);
  tzk0 = t87 + t141;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t142 = t6 * t6;
  t143 = 0.1e1 / t142;
  t144 = t16 * t143;
  t145 = t7 - t144;
  t146 = my_piecewise5(t10, 0, t14, 0, t145);
  t149 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t146);
  t150 = t5 * t149;
  t153 = t27 * t27;
  t154 = 0.1e1 / t153;
  t155 = t154 * t72;
  t156 = t155 * t83;
  t158 = t26 * t156 / 0.8e1;
  t159 = t42 * t42;
  t160 = 0.1e1 / t159;
  t161 = t160 * t28;
  t162 = t161 * t32;
  t163 = t34 * rho[0];
  t165 = 0.1e1 / t36 / t163;
  t170 = t45 * t46;
  t171 = t48 * t50;
  t172 = t51 * t34;
  t174 = 0.1e1 / t35 / t172;
  t178 = pow(t66, 0.25e1);
  t180 = t178 * t69 * t46;
  t181 = t60 * t62;
  t183 = 0.1e1 / t35 / t34;
  t187 = t67 * t28;
  t188 = t32 * sigma[0];
  t192 = -0.88671604938271604938e-2 * t162 * sigma[0] * t165 * t58 + t170 * t171 * t174 / 0.108e3 - 0.40671787192391865921e-3 * t180 * t181 * t183 - 0.96837588553313966479e-5 * t187 * t188 * t165;
  t193 = t27 * t192;
  t194 = t193 * t83;
  t199 = t2 / t3 / t74;
  t200 = t25 * t27;
  t201 = t199 * t200;
  t202 = t82 * t82;
  t203 = 0.1e1 / t202;
  t204 = t72 * t203;
  t205 = t78 * rho[0];
  t206 = 0.1e1 / t205;
  t207 = t76 * t206;
  t208 = t204 * t207;
  t212 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t150 * t84 - t158 - 0.3e1 / 0.8e1 * t26 * t194 - t201 * t208 / 0.768e3);
  t214 = my_piecewise5(t14, 0, t10, 0, -t145);
  t217 = my_piecewise3(t91, 0, 0.4e1 / 0.3e1 * t92 * t214);
  t218 = t5 * t217;
  t221 = t154 * t128;
  t222 = t221 * t137;
  t224 = t95 * t222 / 0.8e1;
  t226 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t218 * t138 - t224);
  tvrho0 = t87 + t141 + t6 * (t212 + t226);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t229 = -t7 - t144;
  t230 = my_piecewise5(t10, 0, t14, 0, t229);
  t233 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t230);
  t234 = t5 * t233;
  t238 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t234 * t84 - t158);
  t240 = my_piecewise5(t14, 0, t10, 0, -t229);
  t243 = my_piecewise3(t91, 0, 0.4e1 / 0.3e1 * t92 * t240);
  t244 = t5 * t243;
  t247 = t104 * t104;
  t248 = 0.1e1 / t247;
  t249 = t248 * t28;
  t250 = t249 * t32;
  t251 = t96 * rho[1];
  t253 = 0.1e1 / t98 / t251;
  t258 = t107 * t46;
  t259 = t48 * t108;
  t260 = t109 * t96;
  t262 = 0.1e1 / t97 / t260;
  t266 = pow(t122, 0.25e1);
  t268 = t266 * t125 * t46;
  t269 = t60 * t118;
  t271 = 0.1e1 / t97 / t96;
  t275 = t123 * t28;
  t276 = t32 * sigma[2];
  t280 = -0.88671604938271604938e-2 * t250 * sigma[2] * t253 * t116 + t258 * t259 * t262 / 0.108e3 - 0.40671787192391865921e-3 * t268 * t269 * t271 - 0.96837588553313966479e-5 * t275 * t276 * t253;
  t281 = t27 * t280;
  t282 = t281 * t137;
  t285 = t94 * t27;
  t286 = t199 * t285;
  t287 = t136 * t136;
  t288 = 0.1e1 / t287;
  t289 = t128 * t288;
  t290 = t132 * rho[1];
  t291 = 0.1e1 / t290;
  t292 = t130 * t291;
  t293 = t289 * t292;
  t297 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t244 * t138 - t224 - 0.3e1 / 0.8e1 * t95 * t282 - t286 * t293 / 0.768e3);
  tvrho1 = t87 + t141 + t6 * (t238 + t297);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t300 = t32 * t38;
  t304 = t48 * sigma[0];
  t308 = 0.1e1 / t62;
  t309 = t60 * t308;
  t315 = 0.33251851851851851852e-2 * t161 * t300 * t58 - t170 * t304 * t54 / 0.288e3 + 0.1525192019714694972e-3 * t180 * t309 * t64 + 0.3631409570749273743e-5 * t187 * t300;
  t316 = t27 * t315;
  t317 = t316 * t83;
  t320 = t50 * t79;
  t321 = t204 * t320;
  t325 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t317 + t201 * t321 / 0.2048e4);
  tvsigma0 = t6 * t325;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t326 = t32 * t100;
  t330 = t48 * sigma[2];
  t334 = 0.1e1 / t118;
  t335 = t60 * t334;
  t341 = 0.33251851851851851852e-2 * t249 * t326 * t116 - t258 * t330 * t112 / 0.288e3 + 0.1525192019714694972e-3 * t268 * t335 * t120 + 0.3631409570749273743e-5 * t275 * t326;
  t342 = t27 * t341;
  t343 = t342 * t137;
  t346 = t108 * t133;
  t347 = t289 * t346;
  t351 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t343 + t286 * t347 / 0.2048e4);
  tvsigma2 = t6 * t351;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t354 = t23 * t23;
  t355 = 0.1e1 / t354;
  t356 = t146 * t146;
  t359 = t142 * t6;
  t360 = 0.1e1 / t359;
  t361 = t16 * t360;
  t363 = -0.2e1 * t143 + 0.2e1 * t361;
  t364 = my_piecewise5(t10, 0, t14, 0, t363);
  t368 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t355 * t356 + 0.4e1 / 0.3e1 * t23 * t364);
  t369 = t5 * t368;
  t372 = t150 * t156;
  t376 = t149 * t27;
  t377 = t199 * t376;
  t381 = 0.1e1 / t153 / t6;
  t383 = t381 * t72 * t83;
  t385 = t26 * t383 / 0.12e2;
  t387 = t154 * t192 * t83;
  t388 = t26 * t387;
  t390 = t25 * t154;
  t391 = t199 * t390;
  t392 = t391 * t208;
  t395 = 0.1e1 / t159 / t42;
  t396 = t395 * t46;
  t397 = t396 * t48;
  t398 = t51 * t163;
  t400 = 0.1e1 / t35 / t398;
  t406 = 0.1e1 / t36 / t51;
  t411 = t160 * t75;
  t412 = t78 * t34;
  t413 = 0.1e1 / t412;
  t414 = t76 * t413;
  t417 = t160 * t76;
  t423 = POW_3_2(t66);
  t424 = t423 * t69;
  t425 = t424 * t28;
  t426 = t188 * t406;
  t429 = 0.1e1 / t29;
  t430 = t178 * t429;
  t431 = t62 * sigma[0];
  t432 = 0.1e1 / t172;
  t437 = 0.1e1 / t35 / t163;
  t443 = -0.24326914935053938255e-3 * t397 * t50 * t400 * t58 + 0.32512921810699588477e-1 * t162 * sigma[0] * t406 * t58 - 0.49262002743484224966e-3 * t411 * t414 - 0.50572284599482008956e-5 * t417 * t413 - 0.19e2 / 0.324e3 * t170 * t171 * t400 + 0.81343574384783731842e-2 * t425 * t426 + 0.54229049589855821228e-3 * t430 * t431 * t432 + 0.94900836782247687149e-3 * t180 * t181 * t437 + 0.35507115802881787709e-4 * t187 * t426;
  t445 = t27 * t443 * t83;
  t448 = t192 * t203;
  t449 = t448 * t207;
  t452 = t74 * t74;
  t455 = t2 / t3 / t452;
  t456 = t455 * t200;
  t458 = 0.1e1 / t202 / t82;
  t459 = t72 * t458;
  t460 = t50 * t50;
  t461 = t460 * t50;
  t462 = t78 * t78;
  t464 = 0.1e1 / t462 / t34;
  t465 = t461 * t464;
  t466 = t459 * t465;
  t469 = t204 * t414;
  t472 = -0.3e1 / 0.8e1 * t369 * t84 - t372 / 0.4e1 - 0.3e1 / 0.4e1 * t150 * t194 - t377 * t208 / 0.384e3 + t385 - t388 / 0.4e1 - t392 / 0.1152e4 - 0.3e1 / 0.8e1 * t26 * t445 - t201 * t449 / 0.384e3 - t456 * t466 / 0.110592e6 + 0.3e1 / 0.256e3 * t201 * t469;
  t473 = my_piecewise3(t1, 0, t472);
  t474 = t92 * t92;
  t475 = 0.1e1 / t474;
  t476 = t214 * t214;
  t480 = my_piecewise5(t14, 0, t10, 0, -t363);
  t484 = my_piecewise3(t91, 0, 0.4e1 / 0.9e1 * t475 * t476 + 0.4e1 / 0.3e1 * t92 * t480);
  t485 = t5 * t484;
  t488 = t218 * t222;
  t491 = t381 * t128 * t137;
  t493 = t95 * t491 / 0.12e2;
  t495 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t485 * t138 - t488 / 0.4e1 + t493);
  tv2rho20 = 0.2e1 * t212 + 0.2e1 * t226 + t6 * (t473 + t495);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t498 = t355 * t230;
  t501 = 0.2e1 * t361;
  t502 = my_piecewise5(t10, 0, t14, 0, t501);
  t506 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t498 * t146 + 0.4e1 / 0.3e1 * t23 * t502);
  t507 = t5 * t506;
  t510 = t234 * t156;
  t514 = t233 * t27;
  t515 = t199 * t514;
  t522 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t507 * t84 - t510 / 0.8e1 - 0.3e1 / 0.8e1 * t234 * t194 - t515 * t208 / 0.768e3 - t372 / 0.8e1 + t385 - t388 / 0.8e1 - t392 / 0.2304e4);
  t523 = t475 * t240;
  t526 = my_piecewise5(t14, 0, t10, 0, -t501);
  t530 = my_piecewise3(t91, 0, 0.4e1 / 0.9e1 * t523 * t214 + 0.4e1 / 0.3e1 * t92 * t526);
  t531 = t5 * t530;
  t534 = t244 * t222;
  t540 = t154 * t280 * t137;
  t541 = t95 * t540;
  t543 = t217 * t27;
  t544 = t199 * t543;
  t547 = t94 * t154;
  t548 = t199 * t547;
  t549 = t548 * t293;
  t552 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t531 * t138 - t534 / 0.8e1 - t488 / 0.8e1 + t493 - 0.3e1 / 0.8e1 * t218 * t282 - t541 / 0.8e1 - t544 * t293 / 0.768e3 - t549 / 0.2304e4);
  tv2rho21 = t212 + t226 + t238 + t297 + t6 * (t522 + t552);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t557 = t230 * t230;
  t561 = 0.2e1 * t143 + 0.2e1 * t361;
  t562 = my_piecewise5(t10, 0, t14, 0, t561);
  t566 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t355 * t557 + 0.4e1 / 0.3e1 * t23 * t562);
  t567 = t5 * t566;
  t572 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t567 * t84 - t510 / 0.4e1 + t385);
  t573 = t240 * t240;
  t577 = my_piecewise5(t14, 0, t10, 0, -t561);
  t581 = my_piecewise3(t91, 0, 0.4e1 / 0.9e1 * t475 * t573 + 0.4e1 / 0.3e1 * t92 * t577);
  t582 = t5 * t581;
  t588 = t243 * t27;
  t589 = t199 * t588;
  t595 = 0.1e1 / t247 / t104;
  t596 = t595 * t46;
  t597 = t596 * t48;
  t598 = t109 * t251;
  t600 = 0.1e1 / t97 / t598;
  t606 = 0.1e1 / t98 / t109;
  t611 = t248 * t75;
  t612 = t132 * t96;
  t613 = 0.1e1 / t612;
  t614 = t130 * t613;
  t617 = t248 * t130;
  t623 = POW_3_2(t122);
  t624 = t623 * t125;
  t625 = t624 * t28;
  t626 = t276 * t606;
  t629 = t266 * t429;
  t630 = t118 * sigma[2];
  t631 = 0.1e1 / t260;
  t636 = 0.1e1 / t97 / t251;
  t642 = -0.24326914935053938255e-3 * t597 * t108 * t600 * t116 + 0.32512921810699588477e-1 * t250 * sigma[2] * t606 * t116 - 0.49262002743484224966e-3 * t611 * t614 - 0.50572284599482008956e-5 * t617 * t613 - 0.19e2 / 0.324e3 * t258 * t259 * t600 + 0.81343574384783731842e-2 * t625 * t626 + 0.54229049589855821228e-3 * t629 * t630 * t631 + 0.94900836782247687149e-3 * t268 * t269 * t636 + 0.35507115802881787709e-4 * t275 * t626;
  t644 = t27 * t642 * t137;
  t647 = t280 * t288;
  t648 = t647 * t292;
  t651 = t455 * t285;
  t653 = 0.1e1 / t287 / t136;
  t654 = t128 * t653;
  t655 = t108 * t108;
  t656 = t655 * t108;
  t657 = t132 * t132;
  t659 = 0.1e1 / t657 / t96;
  t660 = t656 * t659;
  t661 = t654 * t660;
  t664 = t289 * t614;
  t667 = -0.3e1 / 0.8e1 * t582 * t138 - t534 / 0.4e1 - 0.3e1 / 0.4e1 * t244 * t282 - t589 * t293 / 0.384e3 + t493 - t541 / 0.4e1 - t549 / 0.1152e4 - 0.3e1 / 0.8e1 * t95 * t644 - t286 * t648 / 0.384e3 - t651 * t661 / 0.110592e6 + 0.3e1 / 0.256e3 * t286 * t664;
  t668 = my_piecewise3(t88, 0, t667);
  tv2rho22 = 0.2e1 * t238 + 0.2e1 * t297 + t6 * (t572 + t668);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t674 = t154 * t315 * t83;
  t676 = t26 * t674 / 0.8e1;
  t681 = t32 * t165;
  t685 = t206 * t50;
  t688 = t160 * t50;
  t697 = 0.1e1 / t52;
  t706 = 0.91225931006452268455e-4 * t397 * t174 * t58 * sigma[0] - 0.88671604938271604939e-2 * t161 * t681 * t58 + 0.18473251028806584362e-3 * t411 * t685 + 0.18964606724805753359e-5 * t688 * t206 + t170 * t304 * t174 / 0.54e2 - 0.3050384039429389944e-2 * t424 * t33 * t165 - 0.2033589359619593296e-3 * t430 * t62 * t697 - 0.2033589359619593296e-3 * t180 * t309 * t183 - 0.9683758855331396648e-5 * t187 * t681;
  t708 = t27 * t706 * t83;
  t711 = t315 * t203;
  t712 = t711 * t207;
  t718 = t391 * t321 / 0.6144e4;
  t719 = t448 * t320;
  t722 = t460 * sigma[0];
  t723 = t462 * rho[0];
  t724 = 0.1e1 / t723;
  t725 = t722 * t724;
  t726 = t459 * t725;
  t729 = t204 * t685;
  t733 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t150 * t317 - t676 - 0.3e1 / 0.8e1 * t26 * t708 - t201 * t712 / 0.768e3 + t377 * t321 / 0.2048e4 + t718 + t201 * t719 / 0.2048e4 + t456 * t726 / 0.294912e6 - t201 * t729 / 0.256e3);
  tv2rhosigma0 = t6 * t733 + t325;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t738 = t154 * t341 * t137;
  t740 = t95 * t738 / 0.8e1;
  t744 = t548 * t347 / 0.6144e4;
  t746 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t218 * t343 - t740 + t544 * t347 / 0.2048e4 + t744);
  tv2rhosigma2 = t6 * t746 + t351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t753 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t234 * t317 - t676 + t515 * t321 / 0.2048e4 + t718);
  tv2rhosigma3 = t6 * t753 + t325;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t761 = t32 * t253;
  t765 = t291 * t108;
  t768 = t248 * t108;
  t777 = 0.1e1 / t110;
  t786 = 0.91225931006452268455e-4 * t597 * t262 * t116 * sigma[2] - 0.88671604938271604939e-2 * t249 * t761 * t116 + 0.18473251028806584362e-3 * t611 * t765 + 0.18964606724805753359e-5 * t768 * t291 + t258 * t330 * t262 / 0.54e2 - 0.3050384039429389944e-2 * t624 * t33 * t253 - 0.2033589359619593296e-3 * t629 * t118 * t777 - 0.2033589359619593296e-3 * t268 * t335 * t271 - 0.9683758855331396648e-5 * t275 * t761;
  t788 = t27 * t786 * t137;
  t791 = t341 * t288;
  t792 = t791 * t292;
  t797 = t647 * t346;
  t800 = t655 * sigma[2];
  t801 = t657 * rho[1];
  t802 = 0.1e1 / t801;
  t803 = t800 * t802;
  t804 = t654 * t803;
  t807 = t289 * t765;
  t811 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t244 * t343 - t740 - 0.3e1 / 0.8e1 * t95 * t788 - t286 * t792 / 0.768e3 + t589 * t347 / 0.2048e4 + t744 + t286 * t797 / 0.2048e4 + t651 * t804 / 0.294912e6 - t286 * t807 / 0.256e3);
  tv2rhosigma5 = t6 * t811 + t351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t813 = t48 * t54;
  t817 = t79 * sigma[0];
  t820 = t160 * t79;
  t825 = 0.1e1 / sigma[0];
  t826 = t32 * t825;
  t830 = 0.1e1 / t51;
  t834 = 0.1e1 / t431;
  t835 = t60 * t834;
  t839 = -0.34209724127419600671e-4 * t396 * t813 * t58 - 0.69274691358024691358e-4 * t411 * t817 - 0.71117275218021575094e-6 * t820 * sigma[0] - t170 * t813 / 0.288e3 + 0.1143894014786021229e-2 * t425 * t826 * t38 + 0.76259600985734748602e-4 * t430 * t830 * t308 - 0.762596009857347486e-4 * t180 * t835 * t64;
  t841 = t27 * t839 * t83;
  t844 = t711 * t320;
  t847 = 0.1e1 / t462;
  t848 = t460 * t847;
  t849 = t459 * t848;
  t852 = t204 * t817;
  t856 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t841 + t201 * t844 / 0.1024e4 - t456 * t849 / 0.786432e6 + t201 * t852 / 0.1024e4);
  tv2sigma20 = t6 * t856;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t857 = t48 * t112;
  t861 = t133 * sigma[2];
  t864 = t248 * t133;
  t869 = 0.1e1 / sigma[2];
  t870 = t32 * t869;
  t874 = 0.1e1 / t109;
  t878 = 0.1e1 / t630;
  t879 = t60 * t878;
  t883 = -0.34209724127419600671e-4 * t596 * t857 * t116 - 0.69274691358024691358e-4 * t611 * t861 - 0.71117275218021575094e-6 * t864 * sigma[2] - t258 * t857 / 0.288e3 + 0.1143894014786021229e-2 * t625 * t870 * t100 + 0.76259600985734748602e-4 * t629 * t874 * t334 - 0.762596009857347486e-4 * t268 * t879 * t120;
  t885 = t27 * t883 * t137;
  t888 = t791 * t346;
  t891 = 0.1e1 / t657;
  t892 = t655 * t891;
  t893 = t654 * t892;
  t896 = t289 * t861;
  t900 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t885 + t286 * t888 / 0.1024e4 - t651 * t893 / 0.786432e6 + t286 * t896 / 0.1024e4);
  tv2sigma25 = t6 * t900;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t904 = 0.1e1 / t462 / t163;
  t905 = t461 * t904;
  t906 = t459 * t905;
  t909 = t368 * t27;
  t910 = t199 * t909;
  t913 = t149 * t154;
  t914 = t199 * t913;
  t915 = t914 * t208;
  t917 = t443 * t203;
  t918 = t917 * t207;
  t921 = t192 * t458;
  t922 = t921 * t465;
  t928 = t2 / t3 / t452 / t74;
  t929 = t928 * t200;
  t930 = t202 * t202;
  t931 = 0.1e1 / t930;
  t932 = t72 * t931;
  t933 = t460 * t460;
  t934 = t933 * sigma[0];
  t935 = t78 * t163;
  t937 = 0.1e1 / t462 / t935;
  t938 = t934 * t937;
  t939 = t932 * t938;
  t944 = t455 * t376;
  t947 = t25 * t381;
  t948 = t199 * t947;
  t949 = t948 * t208;
  t951 = t391 * t449;
  t953 = t455 * t390;
  t954 = t953 * t466;
  t956 = 0.1e1 / t935;
  t957 = t76 * t956;
  t958 = t204 * t957;
  t961 = t456 * t906 / 0.4096e4 - t910 * t208 / 0.256e3 - t915 / 0.384e3 - t201 * t918 / 0.256e3 - t456 * t922 / 0.36864e5 - t929 * t939 / 0.10616832e8 - t377 * t449 / 0.128e3 - t944 * t466 / 0.36864e5 + t949 / 0.1152e4 - t951 / 0.384e3 - t954 / 0.110592e6 - 0.15e2 / 0.128e3 * t201 * t958;
  t964 = t391 * t469;
  t966 = t448 * t414;
  t969 = t150 * t383;
  t972 = 0.1e1 / t153 / t142;
  t974 = t972 * t72 * t83;
  t976 = 0.5e1 / 0.36e2 * t26 * t974;
  t977 = t369 * t156;
  t979 = t159 * t159;
  t980 = 0.1e1 / t979;
  t981 = t980 * t75;
  t986 = 0.1e1 / t35 / t78;
  t991 = t395 * t28;
  t993 = 0.1e1 / t31 / t74;
  t994 = t993 * t460;
  t995 = t78 * t52;
  t997 = 0.1e1 / t36 / t995;
  t1002 = 0.1e1 / t36 / t52;
  t1009 = t395 * t75;
  t1010 = t1009 * t460;
  t1012 = t997 * t28 * t32;
  t1015 = t395 * t460;
  t1020 = t171 * t986;
  t1023 = sqrt(t66);
  t1024 = t1023 * t69;
  t1025 = t429 * t431;
  t1026 = 0.1e1 / t398;
  t1030 = t423 * t46;
  t1033 = t188 * t1002;
  t1036 = t423 * t429;
  t1037 = t1036 * t50;
  t1039 = t986 * t46 * t60;
  t1046 = 0.1e1 / t35 / t51;
  t1052 = -0.60066456629762810506e-4 * t981 * t957 * t58 + 0.2675960642855933208e-2 * t397 * t50 * t986 * t58 - 0.13514952741696632364e-4 * t991 * t994 * t997 - 0.15172696844993141289e0 * t162 * sigma[0] * t1002 * t58 + 0.6732473708276177412e-2 * t411 * t957 - 0.13514952741696632364e-4 * t1010 * t1012 - 0.13874426501915503143e-6 * t1015 * t1012 + 0.82601398179153947962e-4 * t417 * t956 + 0.209e3 / 0.486e3 * t170 * t1020 - 0.9761228926174047821e-1 * t1024 * t1025 * t1026 - 0.90381749316426368713e-3 * t1030 * t1020 - 0.5694050206934861229e-1 * t425 * t1033 - 0.18076349863285273742e-2 * t1037 * t1039 - 0.48806144630870239106e-2 * t430 * t431 * t1026 - 0.3163361226074922905e-2 * t180 * t181 * t1046 - 0.16569987374678167598e-3 * t187 * t1033;
  t1054 = t27 * t1052 * t83;
  t1058 = t381 * t192 * t83;
  t1059 = t26 * t1058;
  t1062 = t154 * t443 * t83;
  t1063 = t26 * t1062;
  t1066 = 0.1e1 / t354 / t19;
  t1067 = t356 * t146;
  t1070 = t355 * t146;
  t1073 = t142 * t142;
  t1074 = 0.1e1 / t1073;
  t1075 = t16 * t1074;
  t1077 = 0.6e1 * t360 - 0.6e1 * t1075;
  t1078 = my_piecewise5(t10, 0, t14, 0, t1077);
  t1082 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1066 * t1067 + 0.4e1 / 0.3e1 * t1070 * t364 + 0.4e1 / 0.3e1 * t23 * t1078);
  t1083 = t5 * t1082;
  t1088 = t150 * t387;
  t1092 = 0.9e1 / 0.256e3 * t377 * t469 + 0.3e1 / 0.256e3 * t964 + 0.9e1 / 0.256e3 * t201 * t966 + t969 / 0.4e1 - t976 - 0.3e1 / 0.8e1 * t977 - 0.3e1 / 0.8e1 * t26 * t1054 + t1059 / 0.4e1 - 0.3e1 / 0.8e1 * t1063 - 0.3e1 / 0.8e1 * t1083 * t84 - 0.9e1 / 0.8e1 * t369 * t194 - 0.3e1 / 0.4e1 * t1088 - 0.9e1 / 0.8e1 * t150 * t445;
  t1094 = my_piecewise3(t1, 0, t961 + t1092);
  t1096 = 0.1e1 / t474 / t90;
  t1097 = t476 * t214;
  t1100 = t475 * t214;
  t1104 = my_piecewise5(t14, 0, t10, 0, -t1077);
  t1108 = my_piecewise3(t91, 0, -0.8e1 / 0.27e2 * t1096 * t1097 + 0.4e1 / 0.3e1 * t1100 * t480 + 0.4e1 / 0.3e1 * t92 * t1104);
  t1109 = t5 * t1108;
  t1112 = t485 * t222;
  t1114 = t218 * t491;
  t1117 = t972 * t128 * t137;
  t1119 = 0.5e1 / 0.36e2 * t95 * t1117;
  t1121 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t1109 * t138 - 0.3e1 / 0.8e1 * t1112 + t1114 / 0.4e1 - t1119);
  tv3rho30 = 0.3e1 * t473 + 0.3e1 * t495 + t6 * (t1094 + t1121);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1124 = 0.2e1 * t522;
  t1125 = 0.2e1 * t552;
  t1127 = t507 * t156 / 0.4e1;
  t1128 = t234 * t383;
  t1130 = t506 * t27;
  t1131 = t199 * t1130;
  t1134 = t233 * t154;
  t1135 = t199 * t1134;
  t1137 = t1135 * t208 / 0.1152e4;
  t1140 = t455 * t514;
  t1147 = t234 * t387 / 0.4e1;
  t1150 = -t1127 + t1128 / 0.12e2 - t1131 * t208 / 0.384e3 - t1137 - t515 * t449 / 0.384e3 - t1140 * t466 / 0.110592e6 + t949 / 0.1728e4 - t951 / 0.1152e4 - t954 / 0.331776e6 - t1147 - 0.3e1 / 0.8e1 * t234 * t445;
  t1151 = t1066 * t230;
  t1154 = t355 * t502;
  t1159 = 0.2e1 * t360;
  t1160 = 0.6e1 * t1075;
  t1161 = t1159 - t1160;
  t1162 = my_piecewise5(t10, 0, t14, 0, t1161);
  t1166 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1151 * t356 + 0.8e1 / 0.9e1 * t1154 * t146 + 0.4e1 / 0.9e1 * t498 * t364 + 0.4e1 / 0.3e1 * t23 * t1162);
  t1167 = t5 * t1166;
  t1181 = -0.3e1 / 0.8e1 * t1167 * t84 - 0.3e1 / 0.4e1 * t507 * t194 + t1059 / 0.6e1 - t1063 / 0.8e1 - t1088 / 0.4e1 + 0.3e1 / 0.256e3 * t515 * t469 + t964 / 0.256e3 + t969 / 0.6e1 - t976 - t977 / 0.8e1 - t915 / 0.1152e4;
  t1183 = my_piecewise3(t1, 0, t1150 + t1181);
  t1184 = t1096 * t240;
  t1187 = t475 * t526;
  t1193 = my_piecewise5(t14, 0, t10, 0, -t1161);
  t1197 = my_piecewise3(t91, 0, -0.8e1 / 0.27e2 * t1184 * t476 + 0.8e1 / 0.9e1 * t1187 * t214 + 0.4e1 / 0.9e1 * t523 * t480 + 0.4e1 / 0.3e1 * t92 * t1193);
  t1198 = t5 * t1197;
  t1202 = t531 * t222 / 0.4e1;
  t1203 = t244 * t491;
  t1210 = t218 * t540 / 0.4e1;
  t1212 = t381 * t280 * t137;
  t1213 = t95 * t1212;
  t1215 = t484 * t27;
  t1216 = t199 * t1215;
  t1219 = t217 * t154;
  t1220 = t199 * t1219;
  t1222 = t1220 * t293 / 0.1152e4;
  t1223 = t94 * t381;
  t1224 = t199 * t1223;
  t1225 = t1224 * t293;
  t1227 = -0.3e1 / 0.8e1 * t1198 * t138 - t1202 + t1203 / 0.12e2 - t1112 / 0.8e1 + t1114 / 0.6e1 - t1119 - 0.3e1 / 0.8e1 * t485 * t282 - t1210 + t1213 / 0.12e2 - t1216 * t293 / 0.768e3 - t1222 + t1225 / 0.3456e4;
  t1228 = my_piecewise3(t88, 0, t1227);
  tv3rho31 = t473 + t495 + t1124 + t1125 + t6 * (t1183 + t1228);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1231 = t1066 * t557;
  t1236 = t355 * t562;
  t1239 = -t1159 - t1160;
  t1240 = my_piecewise5(t10, 0, t14, 0, t1239);
  t1244 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1231 * t146 + 0.8e1 / 0.9e1 * t498 * t502 + 0.4e1 / 0.9e1 * t1236 * t146 + 0.4e1 / 0.3e1 * t23 * t1240);
  t1245 = t5 * t1244;
  t1248 = t567 * t156;
  t1252 = t566 * t27;
  t1253 = t199 * t1252;
  t1260 = -0.3e1 / 0.8e1 * t1245 * t84 - t1248 / 0.8e1 - 0.3e1 / 0.8e1 * t567 * t194 - t1253 * t208 / 0.768e3 - t1127 + t1128 / 0.6e1 - t1147 - t1137 + t969 / 0.12e2 - t976 + t1059 / 0.12e2 + t949 / 0.3456e4;
  t1261 = my_piecewise3(t1, 0, t1260);
  t1262 = t1096 * t573;
  t1267 = t475 * t577;
  t1271 = my_piecewise5(t14, 0, t10, 0, -t1239);
  t1275 = my_piecewise3(t91, 0, -0.8e1 / 0.27e2 * t1262 * t214 + 0.8e1 / 0.9e1 * t523 * t526 + 0.4e1 / 0.9e1 * t1267 * t214 + 0.4e1 / 0.3e1 * t92 * t1271);
  t1276 = t5 * t1275;
  t1279 = t582 * t222;
  t1284 = t244 * t540;
  t1286 = t530 * t27;
  t1287 = t199 * t1286;
  t1290 = t243 * t154;
  t1291 = t199 * t1290;
  t1292 = t1291 * t293;
  t1295 = -0.3e1 / 0.8e1 * t1276 * t138 - t1279 / 0.8e1 - t1202 + t1203 / 0.6e1 - 0.3e1 / 0.4e1 * t531 * t282 - t1284 / 0.4e1 - t1287 * t293 / 0.384e3 - t1292 / 0.1152e4 + t1114 / 0.12e2 - t1119 - t1210;
  t1301 = t154 * t642 * t137;
  t1302 = t95 * t1301;
  t1306 = t548 * t648;
  t1308 = t455 * t543;
  t1311 = t455 * t547;
  t1312 = t1311 * t661;
  t1316 = t548 * t664;
  t1318 = t1213 / 0.6e1 - t1222 + t1225 / 0.1728e4 - 0.3e1 / 0.8e1 * t218 * t644 - t1302 / 0.8e1 - t544 * t648 / 0.384e3 - t1306 / 0.1152e4 - t1308 * t661 / 0.110592e6 - t1312 / 0.331776e6 + 0.3e1 / 0.256e3 * t544 * t664 + t1316 / 0.256e3;
  t1320 = my_piecewise3(t88, 0, t1295 + t1318);
  tv3rho32 = t1124 + t1125 + t572 + t668 + t6 * (t1261 + t1320);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1325 = t557 * t230;
  t1331 = -0.6e1 * t360 - 0.6e1 * t1075;
  t1332 = my_piecewise5(t10, 0, t14, 0, t1331);
  t1336 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1066 * t1325 + 0.4e1 / 0.3e1 * t498 * t562 + 0.4e1 / 0.3e1 * t23 * t1332);
  t1337 = t5 * t1336;
  t1343 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1337 * t84 - 0.3e1 / 0.8e1 * t1248 + t1128 / 0.4e1 - t976);
  t1346 = t280 * t653;
  t1347 = t1346 * t660;
  t1350 = t928 * t285;
  t1351 = t287 * t287;
  t1352 = 0.1e1 / t1351;
  t1353 = t128 * t1352;
  t1354 = t655 * t655;
  t1355 = t1354 * sigma[2];
  t1356 = t132 * t251;
  t1358 = 0.1e1 / t657 / t1356;
  t1359 = t1355 * t1358;
  t1360 = t1353 * t1359;
  t1363 = t642 * t288;
  t1364 = t1363 * t292;
  t1367 = t581 * t27;
  t1368 = t199 * t1367;
  t1373 = t455 * t588;
  t1376 = t647 * t614;
  t1380 = 0.1e1 / t657 / t251;
  t1381 = t656 * t1380;
  t1382 = t654 * t1381;
  t1385 = 0.1e1 / t1356;
  t1386 = t130 * t1385;
  t1387 = t289 * t1386;
  t1392 = -t1312 / 0.110592e6 + 0.3e1 / 0.256e3 * t1316 - t651 * t1347 / 0.36864e5 - t1350 * t1360 / 0.10616832e8 - t286 * t1364 / 0.256e3 - t1368 * t293 / 0.256e3 - t589 * t648 / 0.128e3 - t1373 * t661 / 0.36864e5 + 0.9e1 / 0.256e3 * t286 * t1376 + t651 * t1382 / 0.4096e4 - 0.15e2 / 0.128e3 * t286 * t1387 + 0.9e1 / 0.256e3 * t589 * t664;
  t1396 = t247 * t247;
  t1397 = 0.1e1 / t1396;
  t1398 = t1397 * t75;
  t1403 = 0.1e1 / t97 / t132;
  t1408 = t595 * t28;
  t1409 = t993 * t655;
  t1410 = t132 * t110;
  t1412 = 0.1e1 / t98 / t1410;
  t1417 = 0.1e1 / t98 / t110;
  t1424 = t595 * t75;
  t1425 = t1424 * t655;
  t1427 = t1412 * t28 * t32;
  t1430 = t595 * t655;
  t1435 = t259 * t1403;
  t1438 = sqrt(t122);
  t1439 = t1438 * t125;
  t1440 = t429 * t630;
  t1441 = 0.1e1 / t598;
  t1445 = t623 * t46;
  t1448 = t276 * t1417;
  t1451 = t623 * t429;
  t1452 = t1451 * t108;
  t1454 = t1403 * t46 * t60;
  t1461 = 0.1e1 / t97 / t109;
  t1467 = -0.60066456629762810506e-4 * t1398 * t1386 * t116 + 0.2675960642855933208e-2 * t597 * t108 * t1403 * t116 - 0.13514952741696632364e-4 * t1408 * t1409 * t1412 - 0.15172696844993141289e0 * t250 * sigma[2] * t1417 * t116 + 0.6732473708276177412e-2 * t611 * t1386 - 0.13514952741696632364e-4 * t1425 * t1427 - 0.13874426501915503143e-6 * t1430 * t1427 + 0.82601398179153947962e-4 * t617 * t1385 + 0.209e3 / 0.486e3 * t258 * t1435 - 0.9761228926174047821e-1 * t1439 * t1440 * t1441 - 0.90381749316426368713e-3 * t1445 * t1435 - 0.5694050206934861229e-1 * t625 * t1448 - 0.18076349863285273742e-2 * t1452 * t1454 - 0.48806144630870239106e-2 * t629 * t630 * t1441 - 0.3163361226074922905e-2 * t268 * t269 * t1461 - 0.16569987374678167598e-3 * t275 * t1448;
  t1469 = t27 * t1467 * t137;
  t1474 = t573 * t240;
  t1480 = my_piecewise5(t14, 0, t10, 0, -t1331);
  t1484 = my_piecewise3(t91, 0, -0.8e1 / 0.27e2 * t1096 * t1474 + 0.4e1 / 0.3e1 * t523 * t577 + 0.4e1 / 0.3e1 * t92 * t1480);
  t1485 = t5 * t1484;
  t1495 = t1225 / 0.1152e4 - t1292 / 0.384e3 - t1306 / 0.384e3 - 0.3e1 / 0.8e1 * t95 * t1469 - 0.9e1 / 0.8e1 * t244 * t644 - 0.3e1 / 0.8e1 * t1485 * t138 - 0.9e1 / 0.8e1 * t582 * t282 - 0.3e1 / 0.8e1 * t1302 - 0.3e1 / 0.8e1 * t1279 - 0.3e1 / 0.4e1 * t1284 + t1203 / 0.4e1 + t1213 / 0.4e1 - t1119;
  t1497 = my_piecewise3(t88, 0, t1392 + t1495);
  tv3rho33 = 0.3e1 * t572 + 0.3e1 * t668 + t6 * (t1343 + t1497);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1501 = t722 * t464;
  t1502 = t459 * t1501;
  t1505 = t50 * t413;
  t1506 = t204 * t1505;
  t1509 = t711 * t414;
  t1512 = t914 * t321;
  t1517 = t948 * t321 / 0.9216e4;
  t1518 = t391 * t729;
  t1520 = t448 * t685;
  t1523 = t315 * t458;
  t1524 = t1523 * t465;
  t1533 = t391 * t719;
  t1535 = -0.25e2 / 0.294912e6 * t456 * t1502 + 0.9e1 / 0.256e3 * t201 * t1506 + 0.3e1 / 0.256e3 * t201 * t1509 + t1512 / 0.3072e4 - t377 * t729 / 0.128e3 - t1517 - t1518 / 0.384e3 - t201 * t1520 / 0.128e3 - t456 * t1524 / 0.110592e6 + t910 * t321 / 0.2048e4 + t377 * t719 / 0.1024e4 + t944 * t726 / 0.147456e6 + t1533 / 0.3072e4;
  t1536 = t953 * t726;
  t1538 = t917 * t320;
  t1541 = t921 * t725;
  t1545 = 0.1e1 / t462 / t412;
  t1546 = t933 * t1545;
  t1547 = t932 * t1546;
  t1552 = t391 * t712;
  t1554 = t706 * t203;
  t1555 = t1554 * t207;
  t1558 = t413 * t58;
  t1566 = t78 * t51;
  t1568 = 0.1e1 / t36 / t1566;
  t1569 = t993 * t1568;
  t1573 = t32 * t406;
  t1579 = t1009 * t1568;
  t1581 = t76 * t28 * t32;
  t1584 = t395 * t76;
  t1591 = t304 * t400;
  t1603 = t1036 * sigma[0];
  t1605 = t400 * t46 * t60;
  t1616 = 0.2252492123616105394e-4 * t981 * t1558 * t50 - 0.8210333790580704161e-3 * t397 * t400 * t58 * sigma[0] + 0.50681072781362371364e-5 * t991 * t1569 * t76 + 0.32512921810699588478e-1 * t161 * t1573 * t58 - 0.21552126200274348423e-2 * t411 * t1505 + 0.50681072781362371364e-5 * t1579 * t1581 + 0.52029099382183136787e-7 * t1584 * t1568 * t28 * t32 - 0.27182602972221579814e-4 * t688 * t413 - 0.19e2 / 0.162e3 * t170 * t1591 + 0.36604608473152679328e-1 * t1024 * t429 * t432 * t62 + 0.33893155993659888267e-3 * t1030 * t1591 + 0.1525192019714694972e-1 * t424 * t33 * t406 + 0.67786311987319776533e-3 * t1603 * t1605 + 0.14235125517337153072e-2 * t430 * t62 * t432 + 0.47450418391123843573e-3 * t180 * t309 * t437 + 0.35507115802881787709e-4 * t187 * t1573;
  t1618 = t27 * t1616 * t83;
  t1626 = t154 * t706 * t83;
  t1627 = t26 * t1626;
  t1629 = t150 * t674;
  t1632 = t381 * t315 * t83;
  t1634 = t26 * t1632 / 0.12e2;
  t1635 = t1536 / 0.442368e6 + t201 * t1538 / 0.2048e4 + t456 * t1541 / 0.147456e6 + t929 * t1547 / 0.28311552e8 - t377 * t712 / 0.384e3 - t1552 / 0.1152e4 - t201 * t1555 / 0.384e3 - 0.3e1 / 0.8e1 * t26 * t1618 - 0.3e1 / 0.8e1 * t369 * t317 - 0.3e1 / 0.4e1 * t150 * t708 - t1627 / 0.4e1 - t1629 / 0.4e1 + t1634;
  t1637 = my_piecewise3(t1, 0, t1535 + t1635);
  tv3rho2sigma0 = t6 * t1637 + 0.2e1 * t733;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1642 = t218 * t738;
  t1645 = t381 * t341 * t137;
  t1647 = t95 * t1645 / 0.12e2;
  t1650 = t1220 * t347;
  t1653 = t1224 * t347 / 0.9216e4;
  t1655 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t485 * t343 - t1642 / 0.4e1 + t1647 + t1216 * t347 / 0.2048e4 + t1650 / 0.3072e4 - t1653);
  tv3rho2sigma2 = t6 * t1655 + 0.2e1 * t746;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1659 = t234 * t674;
  t1670 = t1135 * t321;
  t1682 = -0.3e1 / 0.8e1 * t507 * t317 - t1659 / 0.8e1 - 0.3e1 / 0.8e1 * t234 * t708 - t515 * t712 / 0.768e3 - t1629 / 0.8e1 + t1634 - t1627 / 0.8e1 - t1552 / 0.2304e4 + t1131 * t321 / 0.2048e4 + t1670 / 0.6144e4 + t515 * t719 / 0.2048e4 + t1140 * t726 / 0.294912e6 - t515 * t729 / 0.256e3 + t1512 / 0.6144e4 - t1517 + t1533 / 0.6144e4 + t1536 / 0.884736e6 - t1518 / 0.768e3;
  t1683 = my_piecewise3(t1, 0, t1682);
  tv3rho2sigma3 = t6 * t1683 + t733 + t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1687 = t244 * t738;
  t1693 = t154 * t786 * t137;
  t1694 = t95 * t1693;
  t1698 = t548 * t792;
  t1702 = t1291 * t347;
  t1707 = t548 * t797;
  t1711 = t1311 * t804;
  t1715 = t548 * t807;
  t1717 = -0.3e1 / 0.8e1 * t531 * t343 - t1687 / 0.8e1 - t1642 / 0.8e1 + t1647 - 0.3e1 / 0.8e1 * t218 * t788 - t1694 / 0.8e1 - t544 * t792 / 0.768e3 - t1698 / 0.2304e4 + t1287 * t347 / 0.2048e4 + t1702 / 0.6144e4 + t1650 / 0.6144e4 - t1653 + t544 * t797 / 0.2048e4 + t1707 / 0.6144e4 + t1308 * t804 / 0.294912e6 + t1711 / 0.884736e6 - t544 * t807 / 0.256e3 - t1715 / 0.768e3;
  t1718 = my_piecewise3(t88, 0, t1717);
  tv3rho2sigma5 = t6 * t1718 + t746 + t811;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1728 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t567 * t317 - t1659 / 0.4e1 + t1634 + t1253 * t321 / 0.2048e4 + t1670 / 0.3072e4 - t1517);
  tv3rho2sigma6 = t6 * t1728 + 0.2e1 * t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1731 = t613 * t116;
  t1739 = t132 * t109;
  t1741 = 0.1e1 / t98 / t1739;
  t1742 = t993 * t1741;
  t1746 = t32 * t606;
  t1750 = t613 * t108;
  t1753 = t1424 * t1741;
  t1755 = t130 * t28 * t32;
  t1758 = t595 * t130;
  t1765 = t330 * t600;
  t1777 = t1451 * sigma[2];
  t1779 = t600 * t46 * t60;
  t1790 = 0.2252492123616105394e-4 * t1398 * t1731 * t108 - 0.8210333790580704161e-3 * t597 * t600 * t116 * sigma[2] + 0.50681072781362371364e-5 * t1408 * t1742 * t130 + 0.32512921810699588478e-1 * t249 * t1746 * t116 - 0.21552126200274348423e-2 * t611 * t1750 + 0.50681072781362371364e-5 * t1753 * t1755 + 0.52029099382183136787e-7 * t1758 * t1741 * t28 * t32 - 0.27182602972221579814e-4 * t768 * t613 - 0.19e2 / 0.162e3 * t258 * t1765 + 0.36604608473152679328e-1 * t1439 * t429 * t631 * t118 + 0.33893155993659888267e-3 * t1445 * t1765 + 0.1525192019714694972e-1 * t624 * t33 * t606 + 0.67786311987319776533e-3 * t1777 * t1779 + 0.14235125517337153072e-2 * t629 * t118 * t631 + 0.47450418391123843573e-3 * t268 * t335 * t636 + 0.35507115802881787709e-4 * t275 * t1746;
  t1792 = t27 * t1790 * t137;
  t1804 = t289 * t1750;
  t1809 = t647 * t765;
  t1812 = t800 * t659;
  t1813 = t654 * t1812;
  t1816 = -0.3e1 / 0.8e1 * t95 * t1792 - 0.3e1 / 0.8e1 * t582 * t343 - 0.3e1 / 0.4e1 * t244 * t788 - t1687 / 0.4e1 - t1694 / 0.4e1 + t1647 + t1707 / 0.3072e4 + t1711 / 0.442368e6 - t1715 / 0.384e3 + 0.9e1 / 0.256e3 * t286 * t1804 - t589 * t807 / 0.128e3 - t286 * t1809 / 0.128e3 - 0.25e2 / 0.294912e6 * t651 * t1813;
  t1817 = t791 * t614;
  t1820 = t1346 * t803;
  t1824 = 0.1e1 / t657 / t612;
  t1825 = t1354 * t1824;
  t1826 = t1353 * t1825;
  t1829 = t786 * t288;
  t1830 = t1829 * t292;
  t1833 = t341 * t653;
  t1834 = t1833 * t660;
  t1843 = t1363 * t346;
  t1850 = 0.3e1 / 0.256e3 * t286 * t1817 + t651 * t1820 / 0.147456e6 + t1350 * t1826 / 0.28311552e8 - t286 * t1830 / 0.384e3 - t651 * t1834 / 0.110592e6 + t1368 * t347 / 0.2048e4 + t589 * t797 / 0.1024e4 + t1373 * t804 / 0.147456e6 + t286 * t1843 / 0.2048e4 - t589 * t792 / 0.384e3 - t1653 - t1698 / 0.1152e4 + t1702 / 0.3072e4;
  t1852 = my_piecewise3(t88, 0, t1816 + t1850);
  tv3rho2sigma8 = t6 * t1852 + 0.2e1 * t811;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1857 = t154 * t839 * t83;
  t1859 = t26 * t1857 / 0.8e1;
  t1860 = t206 * t58;
  t1864 = t48 * t174;
  t1869 = 0.1e1 / t36 / t935;
  t1870 = t993 * t1869;
  t1874 = t1009 * t1869;
  t1876 = t50 * t28 * t32;
  t1879 = t206 * sigma[0];
  t1882 = t395 * t1869;
  t1885 = t160 * t206;
  t1890 = t429 * t308;
  t1909 = -0.84468454635603952274e-5 * t981 * t1860 * sigma[0] + 0.18245186201290453691e-3 * t396 * t1864 * t58 - 0.19005402293010889262e-5 * t991 * t1870 * t50 - 0.19005402293010889261e-5 * t1874 * t1876 + 0.55419753086419753086e-3 * t411 * t1879 - 0.19510912268318676295e-7 * t1882 * t1876 + 0.75858426899223013434e-5 * t1885 * sigma[0] + t170 * t1864 / 0.54e2 - 0.13726728177432254748e-1 * t1024 * t1890 * t697 - 0.127099334976224581e-3 * t1030 * t1864 - 0.1525192019714694972e-2 * t425 * t826 * t165 - 0.254198669952449162e-3 * t1036 * t174 * t46 * t60 - 0.25419866995244916201e-3 * t430 * t697 * t308 + 0.1016794679809796648e-3 * t180 * t835 * t183;
  t1911 = t27 * t1909 * t83;
  t1914 = t839 * t203;
  t1915 = t1914 * t207;
  t1921 = t391 * t844 / 0.3072e4;
  t1922 = t1554 * t320;
  t1925 = t1523 * t725;
  t1928 = t711 * t685;
  t1934 = t953 * t849 / 0.2359296e7;
  t1935 = t921 * t848;
  t1938 = t460 * t76;
  t1940 = 0.1e1 / t462 / t205;
  t1941 = t1938 * t1940;
  t1942 = t932 * t1941;
  t1945 = t460 * t724;
  t1946 = t459 * t1945;
  t1952 = t391 * t852 / 0.3072e4;
  t1953 = t448 * t817;
  t1956 = t204 * t1879;
  t1959 = -0.3e1 / 0.8e1 * t150 * t841 - t1859 - 0.3e1 / 0.8e1 * t26 * t1911 - t201 * t1915 / 0.768e3 + t377 * t844 / 0.1024e4 + t1921 + t201 * t1922 / 0.1024e4 + t456 * t1925 / 0.147456e6 - t201 * t1928 / 0.128e3 - t944 * t849 / 0.786432e6 - t1934 - t456 * t1935 / 0.786432e6 - t929 * t1942 / 0.75497472e8 + t456 * t1946 / 0.36864e5 + t377 * t852 / 0.1024e4 + t1952 + t201 * t1953 / 0.1024e4 - t201 * t1956 / 0.128e3;
  t1960 = my_piecewise3(t1, 0, t1959);
  tv3rhosigma20 = t6 * t1960 + t856;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1965 = t154 * t883 * t137;
  t1967 = t95 * t1965 / 0.8e1;
  t1971 = t548 * t888 / 0.3072e4;
  t1975 = t1311 * t893 / 0.2359296e7;
  t1979 = t548 * t896 / 0.3072e4;
  t1981 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t218 * t885 - t1967 + t544 * t888 / 0.1024e4 + t1971 - t1308 * t893 / 0.786432e6 - t1975 + t544 * t896 / 0.1024e4 + t1979);
  tv3rhosigma25 = t6 * t1981 + t900;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1992 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t234 * t841 - t1859 + t515 * t844 / 0.1024e4 + t1921 - t1140 * t849 / 0.786432e6 - t1934 + t515 * t852 / 0.1024e4 + t1952);
  tv3rhosigma26 = t6 * t1992 + t856;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1996 = t291 * t116;
  t2000 = t48 * t262;
  t2005 = 0.1e1 / t98 / t1356;
  t2006 = t993 * t2005;
  t2010 = t1424 * t2005;
  t2012 = t108 * t28 * t32;
  t2015 = t291 * sigma[2];
  t2018 = t595 * t2005;
  t2021 = t248 * t291;
  t2026 = t429 * t334;
  t2045 = -0.84468454635603952274e-5 * t1398 * t1996 * sigma[2] + 0.18245186201290453691e-3 * t596 * t2000 * t116 - 0.19005402293010889262e-5 * t1408 * t2006 * t108 - 0.19005402293010889261e-5 * t2010 * t2012 + 0.55419753086419753086e-3 * t611 * t2015 - 0.19510912268318676295e-7 * t2018 * t2012 + 0.75858426899223013434e-5 * t2021 * sigma[2] + t258 * t2000 / 0.54e2 - 0.13726728177432254748e-1 * t1439 * t2026 * t777 - 0.127099334976224581e-3 * t1445 * t2000 - 0.1525192019714694972e-2 * t625 * t870 * t253 - 0.254198669952449162e-3 * t1451 * t262 * t46 * t60 - 0.25419866995244916201e-3 * t629 * t777 * t334 + 0.1016794679809796648e-3 * t268 * t879 * t271;
  t2047 = t27 * t2045 * t137;
  t2050 = t883 * t288;
  t2051 = t2050 * t292;
  t2056 = t1829 * t346;
  t2059 = t1833 * t803;
  t2062 = t791 * t765;
  t2067 = t1346 * t892;
  t2070 = t655 * t130;
  t2072 = 0.1e1 / t657 / t290;
  t2073 = t2070 * t2072;
  t2074 = t1353 * t2073;
  t2077 = t655 * t802;
  t2078 = t654 * t2077;
  t2083 = t647 * t861;
  t2086 = t289 * t2015;
  t2089 = -0.3e1 / 0.8e1 * t244 * t885 - t1967 - 0.3e1 / 0.8e1 * t95 * t2047 - t286 * t2051 / 0.768e3 + t589 * t888 / 0.1024e4 + t1971 + t286 * t2056 / 0.1024e4 + t651 * t2059 / 0.147456e6 - t286 * t2062 / 0.128e3 - t1373 * t893 / 0.786432e6 - t1975 - t651 * t2067 / 0.786432e6 - t1350 * t2074 / 0.75497472e8 + t651 * t2078 / 0.36864e5 + t589 * t896 / 0.1024e4 + t1979 + t286 * t2083 / 0.1024e4 - t286 * t2086 / 0.128e3;
  t2090 = my_piecewise3(t88, 0, t2089);
  tv3rhosigma211 = t6 * t2090 + t900;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2096 = 0.1e1 / t36 / t412;
  t2097 = t993 * t2096;
  t2103 = sigma[0] * t28 * t32;
  t2108 = t395 * t2096;
  t2119 = 0.1e1 / t50;
  t2120 = t32 * t2119;
  t2124 = t1036 * t54;
  t2126 = t825 * t46 * t60;
  t2132 = t62 * t50;
  t2133 = 0.1e1 / t2132;
  t2134 = t60 * t2133;
  t2138 = 0.31675670488351482103e-5 * t981 * t79 * t58 + 0.71270258598790834731e-6 * t991 * t2097 * sigma[0] + 0.71270258598790834731e-6 * t1009 * t2096 * t2103 - 0.69274691358024691358e-4 * t411 * t79 + 0.73165921006195036105e-8 * t2108 * t2103 - 0.14223455043604315019e-5 * t820 + 0.51475230665370955305e-2 * t1024 * t429 * t834 * t830 + 0.47662250616084217875e-4 * t1030 * t813 * t825 - 0.17158410221790318435e-2 * t425 * t2120 * t38 + 0.95324501232168435752e-4 * t2124 * t2126 - 0.57194700739301061451e-4 * t430 * t830 * t834 + 0.1143894014786021229e-3 * t180 * t2134 * t64;
  t2140 = t27 * t2138 * t83;
  t2143 = t1914 * t320;
  t2146 = t1523 * t848;
  t2149 = t711 * t817;
  t2153 = 0.1e1 / t462 / t78;
  t2154 = t461 * t2153;
  t2155 = t932 * t2154;
  t2158 = t76 * t847;
  t2159 = t459 * t2158;
  t2162 = t199 * t25;
  t2163 = t203 * t79;
  t2164 = t73 * t2163;
  t2168 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t2140 + 0.3e1 / 0.2048e4 * t201 * t2143 - t456 * t2146 / 0.262144e6 + 0.3e1 / 0.1024e4 * t201 * t2149 + t929 * t2155 / 0.201326592e9 - t456 * t2159 / 0.131072e6 + t2162 * t2164 / 0.1024e4);
  tv3sigma30 = t6 * t2168;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2173 = 0.1e1 / t98 / t612;
  t2174 = t993 * t2173;
  t2180 = sigma[2] * t28 * t32;
  t2185 = t595 * t2173;
  t2196 = 0.1e1 / t108;
  t2197 = t32 * t2196;
  t2201 = t1451 * t112;
  t2203 = t869 * t46 * t60;
  t2209 = t118 * t108;
  t2210 = 0.1e1 / t2209;
  t2211 = t60 * t2210;
  t2215 = 0.31675670488351482103e-5 * t1398 * t133 * t116 + 0.71270258598790834731e-6 * t1408 * t2174 * sigma[2] + 0.71270258598790834731e-6 * t1424 * t2173 * t2180 - 0.69274691358024691358e-4 * t611 * t133 + 0.73165921006195036105e-8 * t2185 * t2180 - 0.14223455043604315019e-5 * t864 + 0.51475230665370955305e-2 * t1439 * t429 * t878 * t874 + 0.47662250616084217875e-4 * t1445 * t857 * t869 - 0.17158410221790318435e-2 * t625 * t2197 * t100 + 0.95324501232168435752e-4 * t2201 * t2203 - 0.57194700739301061451e-4 * t629 * t874 * t878 + 0.1143894014786021229e-3 * t268 * t2211 * t120;
  t2217 = t27 * t2215 * t137;
  t2220 = t2050 * t346;
  t2223 = t1833 * t892;
  t2226 = t791 * t861;
  t2230 = 0.1e1 / t657 / t132;
  t2231 = t656 * t2230;
  t2232 = t1353 * t2231;
  t2235 = t130 * t891;
  t2236 = t654 * t2235;
  t2239 = t199 * t94;
  t2240 = t288 * t133;
  t2241 = t129 * t2240;
  t2245 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t2217 + 0.3e1 / 0.2048e4 * t286 * t2220 - t651 * t2223 / 0.262144e6 + 0.3e1 / 0.1024e4 * t286 * t2226 + t1350 * t2232 / 0.201326592e9 - t651 * t2236 / 0.131072e6 + t2239 * t2241 / 0.1024e4);
  tv3sigma39 = t6 * t2245;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t38, t40;
  double t42, t45, t46, t48, t49, t50, t51, t52;
  double t54, t58, t60, t61, t62, t64, t66, t67;
  double t69, t72, t73, t74, t75, t76, t78, t79;
  double t82, t83, t84, t87, t88, t89, t90, t91;
  double t92, t94, t95, t96, t97, t98, t100, t102;
  double t104, t107, t108, t109, t110, t112, t116, t118;
  double t120, t122, t123, t125, t128, t129, t130, t132;
  double t133, t136, t137, t138, t141, tzk0;

  double t142, t143, t144, t145, t146, t149, t150, t153;
  double t154, t155, t156, t158, t159, t160, t161, t162;
  double t163, t165, t170, t171, t172, t174, t178, t180;
  double t181, t183, t187, t188, t192, t193, t194, t199;
  double t200, t201, t202, t203, t204, t205, t206, t207;
  double t208, t212, t214, t217, t218, t221, t222, t224;
  double t226, tvrho0, t229, t230, t233, t234, t238, t240;
  double t243, t244, t247, t248, t249, t250, t251, t253;
  double t258, t259, t260, t262, t266, t268, t269, t271;
  double t275, t276, t280, t281, t282, t285, t286, t287;
  double t288, t289, t290, t291, t292, t293, t297, tvrho1;
  double t300, t304, t308, t309, t315, t316, t317, t320;
  double t321, t325, tvsigma0, tvsigma1, t326, t330, t334, t335;
  double t341, t342, t343, t346, t347, t351, tvsigma2;

  double t354, t355, t356, t359, t360, t361, t363, t364;
  double t368, t369, t372, t376, t377, t381, t383, t385;
  double t387, t388, t390, t391, t392, t395, t396, t397;
  double t398, t400, t406, t411, t412, t413, t414, t417;
  double t423, t424, t425, t426, t429, t430, t431, t432;
  double t437, t443, t445, t448, t449, t452, t455, t456;
  double t458, t459, t460, t461, t462, t464, t465, t466;
  double t469, t472, t473, t474, t475, t476, t480, t484;
  double t485, t488, t491, t493, t495, tv2rho20, t498, t501;
  double t502, t506, t507, t510, t514, t515, t522, t523;
  double t526, t530, t531, t534, t540, t541, t543, t544;
  double t547, t548, t549, t552, tv2rho21, t557, t561, t562;
  double t566, t567, t572, t573, t577, t581, t582, t588;
  double t589, t595, t596, t597, t598, t600, t606, t611;
  double t612, t613, t614, t617, t623, t624, t625, t626;
  double t629, t630, t631, t636, t642, t644, t647, t648;
  double t651, t653, t654, t655, t656, t657, t659, t660;
  double t661, t664, t667, t668, tv2rho22, t674, t676, t681;
  double t685, t688, t697, t706, t708, t711, t712, t718;
  double t719, t722, t723, t724, t725, t726, t729, t733;
  double tv2rhosigma0, tv2rhosigma1, t738, t740, t744, t746, tv2rhosigma2, t753;
  double tv2rhosigma3, tv2rhosigma4, t761, t765, t768, t777, t786, t788;
  double t791, t792, t797, t800, t801, t802, t803, t804;
  double t807, t811, tv2rhosigma5, t813, t817, t820, t825, t826;
  double t830, t834, t835, t839, t841, t844, t847, t848;
  double t849, t852, t856, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24;
  double t857, t861, t864, t869, t870, t874, t878, t879;
  double t883, t885, t888, t891, t892, t893, t896, t900;
  double tv2sigma25;

  double t904, t905, t906, t909, t910, t913, t914, t915;
  double t917, t918, t921, t922, t928, t929, t930, t931;
  double t932, t933, t934, t935, t937, t938, t939, t944;
  double t947, t948, t949, t951, t953, t954, t956, t957;
  double t958, t961, t964, t966, t969, t972, t974, t976;
  double t977, t979, t980, t981, t986, t991, t993, t994;
  double t995, t997, t1002, t1009, t1010, t1012, t1015, t1020;
  double t1023, t1024, t1025, t1026, t1030, t1033, t1036, t1037;
  double t1039, t1046, t1052, t1054, t1058, t1059, t1062, t1063;
  double t1066, t1067, t1070, t1073, t1074, t1075, t1077, t1078;
  double t1082, t1083, t1088, t1092, t1094, t1096, t1097, t1100;
  double t1104, t1108, t1109, t1112, t1114, t1117, t1119, t1121;
  double tv3rho30, t1124, t1125, t1127, t1128, t1130, t1131, t1134;
  double t1135, t1137, t1140, t1147, t1150, t1151, t1154, t1159;
  double t1160, t1161, t1162, t1166, t1167, t1181, t1183, t1184;
  double t1187, t1193, t1197, t1198, t1202, t1203, t1210, t1212;
  double t1213, t1215, t1216, t1219, t1220, t1222, t1223, t1224;
  double t1225, t1227, t1228, tv3rho31, t1231, t1236, t1239, t1240;
  double t1244, t1245, t1248, t1252, t1253, t1260, t1261, t1262;
  double t1267, t1271, t1275, t1276, t1279, t1284, t1286, t1287;
  double t1290, t1291, t1292, t1295, t1301, t1302, t1306, t1308;
  double t1311, t1312, t1316, t1318, t1320, tv3rho32, t1325, t1331;
  double t1332, t1336, t1337, t1343, t1346, t1347, t1350, t1351;
  double t1352, t1353, t1354, t1355, t1356, t1358, t1359, t1360;
  double t1363, t1364, t1367, t1368, t1373, t1376, t1380, t1381;
  double t1382, t1385, t1386, t1387, t1392, t1396, t1397, t1398;
  double t1403, t1408, t1409, t1410, t1412, t1417, t1424, t1425;
  double t1427, t1430, t1435, t1438, t1439, t1440, t1441, t1445;
  double t1448, t1451, t1452, t1454, t1461, t1467, t1469, t1474;
  double t1480, t1484, t1485, t1495, t1497, tv3rho33, t1501, t1502;
  double t1505, t1506, t1509, t1512, t1517, t1518, t1520, t1523;
  double t1524, t1533, t1535, t1536, t1538, t1541, t1545, t1546;
  double t1547, t1552, t1554, t1555, t1558, t1566, t1568, t1569;
  double t1573, t1579, t1581, t1584, t1591, t1603, t1605, t1616;
  double t1618, t1626, t1627, t1629, t1632, t1634, t1635, t1637;
  double tv3rho2sigma0, tv3rho2sigma1, t1642, t1645, t1647, t1650, t1653, t1655;
  double tv3rho2sigma2, t1659, t1670, t1682, t1683, tv3rho2sigma3, tv3rho2sigma4, t1687;
  double t1693, t1694, t1698, t1702, t1707, t1711, t1715, t1717;
  double t1718, tv3rho2sigma5, t1728, tv3rho2sigma6, tv3rho2sigma7, t1731, t1739, t1741;
  double t1742, t1746, t1750, t1753, t1755, t1758, t1765, t1777;
  double t1779, t1790, t1792, t1804, t1809, t1812, t1813, t1816;
  double t1817, t1820, t1824, t1825, t1826, t1829, t1830, t1833;
  double t1834, t1843, t1850, t1852, tv3rho2sigma8, t1857, t1859, t1860;
  double t1864, t1869, t1870, t1874, t1876, t1879, t1882, t1885;
  double t1890, t1909, t1911, t1914, t1915, t1921, t1922, t1925;
  double t1928, t1934, t1935, t1938, t1940, t1941, t1942, t1945;
  double t1946, t1952, t1953, t1956, t1959, t1960, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1965, t1967, t1971, t1975, t1979;
  double t1981, tv3rhosigma25, t1992, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210;
  double t1996, t2000, t2005, t2006, t2010, t2012, t2015, t2018;
  double t2021, t2026, t2045, t2047, t2050, t2051, t2056, t2059;
  double t2062, t2067, t2070, t2072, t2073, t2074, t2077, t2078;
  double t2083, t2086, t2089, t2090, tv3rhosigma211, t2096, t2097, t2103;
  double t2108, t2119, t2120, t2124, t2126, t2132, t2133, t2134;
  double t2138, t2140, t2143, t2146, t2149, t2153, t2154, t2155;
  double t2158, t2159, t2162, t2163, t2164, t2168, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t2173;
  double t2174, t2180, t2185, t2196, t2197, t2201, t2203, t2209;
  double t2210, t2211, t2215, t2217, t2220, t2223, t2226, t2230;
  double t2231, t2232, t2235, t2236, t2239, t2240, t2241, t2245;
  double tv3sigma39;

  double t2251, t2256, t2258, t2260, t2261, t2265, t2277, t2279;
  double t2281, t2289, t2292, t2295, t2301, t2302, t2303, t2317;
  double t2319, t2323, t2334, t2337, t2346, t2351, t2357, t2359;
  double t2362, t2366, t2370, t2372, t2374, t2376, t2377, t2383;
  double t2390, t2392, t2393, t2397, t2405, t2407, t2409, t2413;
  double t2414, t2416, t2418, t2421, t2422, t2425, t2427, t2436;
  double t2440, t2441, t2443, t2445, t2446, t2450, t2454, t2460;
  double t2462, t2466, t2468, t2473, t2481, t2485, t2486, t2491;
  double t2492, t2494, t2496, t2497, t2499, t2504, t2509, t2510;
  double t2513, t2514, t2530, t2533, t2536, t2539, t2540, t2542;
  double t2543, t2549, t2555, t2559, t2563, t2565, t2567, t2572;
  double t2574, tv4rho40, t2579, t2580, t2581, t2601, t2602, t2603;
  double t2604, t2608, t2614, t2616, t2618, t2620, t2621, t2626;
  double t2637, t2639, t2640, t2642, t2648, t2652, t2653, t2656;
  double t2657, t2658, t2660, t2665, t2674, t2676, t2691, t2694;
  double t2712, t2716, t2720, t2722, t2723, t2724, t2731, t2733;
  double t2734, t2737, t2740, t2744, t2745, t2748, t2749, t2750;
  double t2752, t2753, t2755, t2756, tv4rho41, t2776, t2780, t2784;
  double t2785, t2787, t2810, t2823, t2827, t2833, t2835, t2837;
  double t2839, t2841, t2844, t2848, t2854, t2857, t2859, t2860;
  double t2862, t2863, t2865, t2868, t2869, t2872, t2873, t2875;
  double t2878, t2881, t2883, t2893, t2906, t2910, t2918, t2922;
  double t2924, t2926, t2934, t2936, tv4rho42, t2956, t2957, t2961;
  double t2965, t2970, t2981, t2982, t2994, t2997, t2999, t3001;
  double t3003, t3025, t3029, t3037, t3042, t3059, t3060, t3066;
  double t3069, t3071, t3074, t3075, t3077, t3079, t3080, t3082;
  double t3084, t3086, t3088, t3089, t3091, t3093, t3096, tv4rho43;
  double t3101, t3106, t3112, t3113, t3117, t3125, t3133, t3135;
  double t3138, t3146, t3148, t3152, t3158, t3159, t3163, t3167;
  double t3168, t3174, t3181, t3182, t3183, t3199, t3201, t3202;
  double t3214, t3227, t3237, t3242, t3248, t3252, t3259, t3272;
  double t3281, t3286, t3290, t3294, t3297, t3300, t3302, t3309;
  double t3310, t3317, t3352, t3355, tv4rho44, t3362, t3365, t3367;
  double t3369, t3371, t3375, t3386, t3394, t3409, t3414, t3421;
  double t3441, t3464, t3473, t3474, t3476, t3484, t3485, t3487;
  double t3489, t3510, t3514, t3518, t3520, t3522, t3524, t3526;
  double t3528, t3533, t3554, t3556, t3558, t3563, t3567, t3571;
  double t3575, t3589, t3591, t3599, t3601, t3604, tv4rho3sigma0, tv4rho3sigma1;
  double t3609, t3611, t3616, t3619, t3621, t3624, t3626, tv4rho3sigma2;
  double t3628, t3636, t3638, t3639, t3646, t3660, t3669, t3671;
  double t3682, t3688, t3698, t3701, t3704, t3709, t3712, tv4rho3sigma3;
  double tv4rho3sigma4, t3714, t3720, t3721, t3724, t3727, t3734, t3735;
  double t3736, t3739, t3740, t3743, t3744, t3746, t3749, t3750;
  double t3753, t3764, t3766, tv4rho3sigma5, t3768, t3780, t3784, t3796;
  double t3798, tv4rho3sigma6, tv4rho3sigma7, t3804, t3806, t3808, t3818, t3824;
  double t3826, t3828, t3830, t3832, t3834, t3836, t3838, t3840;
  double t3842, t3844, t3846, t3848, t3850, t3852, t3856, t3883;
  double t3886, tv4rho3sigma8, t3898, tv4rho3sigma9, tv4rho3sigma10, t3901, t3927, t3935;
  double t3940, t3948, t3957, t3984, t4005, t4021, t4031, t4037;
  double t4062, t4072, t4109, t4112, tv4rho3sigma11, t4120, t4121, t4125;
  double t4127, t4131, t4162, t4164, t4190, t4198, t4223, t4225;
  double t4229, t4230, t4238, t4243, t4244, t4247, t4248, t4256;
  double t4258, t4276, t4293, t4294, t4296, t4301, t4311, t4313;
  double t4320, t4322, t4326, t4329, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, t4334, t4339, t4342, t4345, t4348, t4351, t4354;
  double t4357, t4358, t4359, tv4rho2sigma25, t4365, t4378, t4382, t4386;
  double t4390, t4412, t4414, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210;
  double t4416, t4420, t4430, t4432, t4434, t4436, t4438, t4440;
  double t4442, t4443, t4445, t4447, t4449, t4451, t4453, t4479;
  double t4481, tv4rho2sigma211, t4496, t4497, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215;
  double tv4rho2sigma216, t4513, t4518, t4523, t4526, t4532, t4574, t4588;
  double t4607, t4651, t4664, t4668, t4686, t4689, tv4rho2sigma217, t4695;
  double t4712, t4719, t4723, t4751, t4761, t4764, t4795, t4796;
  double t4801, t4807, t4813, t4818, t4835, t4844, t4846, tv4rhosigma30;
  double tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38;
  double t4853, t4857, t4861, t4865, t4869, t4873, t4879, t4880;
  double t4881, tv4rhosigma39, t4898, t4899, tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313;
  double tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t4904, t4911, t4915;
  double t4957, t4963, t5003, t5028, t5037, t5039, tv4rhosigma319, t5070;
  double t5079, t5104, t5141, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44;
  double tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412;
  double tv4sigma413, t5152, t5161, t5205, t5242, tv4sigma414;


  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = t5 * t25;
  t27 = POW_1_3(t6);
  t28 = M_CBRT6;
  t29 = M_PI * M_PI;
  t30 = POW_1_3(t29);
  t31 = t30 * t30;
  t32 = 0.1e1 / t31;
  t33 = t28 * t32;
  t34 = rho[0] * rho[0];
  t35 = POW_1_3(rho[0]);
  t36 = t35 * t35;
  t38 = 0.1e1 / t36 / t34;
  t40 = t33 * sigma[0] * t38;
  t42 = 0.804e0 + 0.5e1 / 0.972e3 * t40;
  t45 = 0.1804e1 - 0.646416e0 / t42;
  t46 = t28 * t28;
  t48 = 0.1e1 / t30 / t29;
  t49 = t46 * t48;
  t50 = sigma[0] * sigma[0];
  t51 = t34 * t34;
  t52 = t51 * rho[0];
  t54 = 0.1e1 / t35 / t52;
  t58 = 0.1e3 - t49 * t50 * t54 / 0.576e3;
  t60 = 0.1e1 / t30;
  t61 = t46 * t60;
  t62 = sqrt(sigma[0]);
  t64 = 0.1e1 / t35 / rho[0];
  t66 = t61 * t62 * t64;
  t67 = pow(t66, 0.35e1);
  t69 = 0.1e1 + t40 / 0.24e2;
  t72 = t45 * t58 + 0.87153829697982569831e-4 * t67 * t69;
  t73 = t27 * t72;
  t74 = t29 * t29;
  t75 = 0.1e1 / t74;
  t76 = t50 * sigma[0];
  t78 = t51 * t51;
  t79 = 0.1e1 / t78;
  t82 = 0.1e3 + t75 * t76 * t79 / 0.2304e4;
  t83 = 0.1e1 / t82;
  t84 = t73 * t83;
  t87 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t84);
  t88 = rho[1] <= p->dens_threshold;
  t89 = my_piecewise5(t14, t11, t10, t15, -t17);
  t90 = 0.1e1 + t89;
  t91 = t90 <= p->zeta_threshold;
  t92 = POW_1_3(t90);
  t94 = my_piecewise3(t91, t22, t92 * t90);
  t95 = t5 * t94;
  t96 = rho[1] * rho[1];
  t97 = POW_1_3(rho[1]);
  t98 = t97 * t97;
  t100 = 0.1e1 / t98 / t96;
  t102 = t33 * sigma[2] * t100;
  t104 = 0.804e0 + 0.5e1 / 0.972e3 * t102;
  t107 = 0.1804e1 - 0.646416e0 / t104;
  t108 = sigma[2] * sigma[2];
  t109 = t96 * t96;
  t110 = t109 * rho[1];
  t112 = 0.1e1 / t97 / t110;
  t116 = 0.1e3 - t49 * t108 * t112 / 0.576e3;
  t118 = sqrt(sigma[2]);
  t120 = 0.1e1 / t97 / rho[1];
  t122 = t61 * t118 * t120;
  t123 = pow(t122, 0.35e1);
  t125 = 0.1e1 + t102 / 0.24e2;
  t128 = t107 * t116 + 0.87153829697982569831e-4 * t123 * t125;
  t129 = t27 * t128;
  t130 = t108 * sigma[2];
  t132 = t109 * t109;
  t133 = 0.1e1 / t132;
  t136 = 0.1e3 + t75 * t130 * t133 / 0.2304e4;
  t137 = 0.1e1 / t136;
  t138 = t129 * t137;
  t141 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t138);
  tzk0 = t87 + t141;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t142 = t6 * t6;
  t143 = 0.1e1 / t142;
  t144 = t16 * t143;
  t145 = t7 - t144;
  t146 = my_piecewise5(t10, 0, t14, 0, t145);
  t149 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t146);
  t150 = t5 * t149;
  t153 = t27 * t27;
  t154 = 0.1e1 / t153;
  t155 = t154 * t72;
  t156 = t155 * t83;
  t158 = t26 * t156 / 0.8e1;
  t159 = t42 * t42;
  t160 = 0.1e1 / t159;
  t161 = t160 * t28;
  t162 = t161 * t32;
  t163 = t34 * rho[0];
  t165 = 0.1e1 / t36 / t163;
  t170 = t45 * t46;
  t171 = t48 * t50;
  t172 = t51 * t34;
  t174 = 0.1e1 / t35 / t172;
  t178 = pow(t66, 0.25e1);
  t180 = t178 * t69 * t46;
  t181 = t60 * t62;
  t183 = 0.1e1 / t35 / t34;
  t187 = t67 * t28;
  t188 = t32 * sigma[0];
  t192 = -0.88671604938271604938e-2 * t162 * sigma[0] * t165 * t58 + t170 * t171 * t174 / 0.108e3 - 0.40671787192391865921e-3 * t180 * t181 * t183 - 0.96837588553313966479e-5 * t187 * t188 * t165;
  t193 = t27 * t192;
  t194 = t193 * t83;
  t199 = t2 / t3 / t74;
  t200 = t25 * t27;
  t201 = t199 * t200;
  t202 = t82 * t82;
  t203 = 0.1e1 / t202;
  t204 = t72 * t203;
  t205 = t78 * rho[0];
  t206 = 0.1e1 / t205;
  t207 = t76 * t206;
  t208 = t204 * t207;
  t212 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t150 * t84 - t158 - 0.3e1 / 0.8e1 * t26 * t194 - t201 * t208 / 0.768e3);
  t214 = my_piecewise5(t14, 0, t10, 0, -t145);
  t217 = my_piecewise3(t91, 0, 0.4e1 / 0.3e1 * t92 * t214);
  t218 = t5 * t217;
  t221 = t154 * t128;
  t222 = t221 * t137;
  t224 = t95 * t222 / 0.8e1;
  t226 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t218 * t138 - t224);
  tvrho0 = t87 + t141 + t6 * (t212 + t226);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t229 = -t7 - t144;
  t230 = my_piecewise5(t10, 0, t14, 0, t229);
  t233 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t230);
  t234 = t5 * t233;
  t238 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t234 * t84 - t158);
  t240 = my_piecewise5(t14, 0, t10, 0, -t229);
  t243 = my_piecewise3(t91, 0, 0.4e1 / 0.3e1 * t92 * t240);
  t244 = t5 * t243;
  t247 = t104 * t104;
  t248 = 0.1e1 / t247;
  t249 = t248 * t28;
  t250 = t249 * t32;
  t251 = t96 * rho[1];
  t253 = 0.1e1 / t98 / t251;
  t258 = t107 * t46;
  t259 = t48 * t108;
  t260 = t109 * t96;
  t262 = 0.1e1 / t97 / t260;
  t266 = pow(t122, 0.25e1);
  t268 = t266 * t125 * t46;
  t269 = t60 * t118;
  t271 = 0.1e1 / t97 / t96;
  t275 = t123 * t28;
  t276 = t32 * sigma[2];
  t280 = -0.88671604938271604938e-2 * t250 * sigma[2] * t253 * t116 + t258 * t259 * t262 / 0.108e3 - 0.40671787192391865921e-3 * t268 * t269 * t271 - 0.96837588553313966479e-5 * t275 * t276 * t253;
  t281 = t27 * t280;
  t282 = t281 * t137;
  t285 = t94 * t27;
  t286 = t199 * t285;
  t287 = t136 * t136;
  t288 = 0.1e1 / t287;
  t289 = t128 * t288;
  t290 = t132 * rho[1];
  t291 = 0.1e1 / t290;
  t292 = t130 * t291;
  t293 = t289 * t292;
  t297 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t244 * t138 - t224 - 0.3e1 / 0.8e1 * t95 * t282 - t286 * t293 / 0.768e3);
  tvrho1 = t87 + t141 + t6 * (t238 + t297);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t300 = t32 * t38;
  t304 = t48 * sigma[0];
  t308 = 0.1e1 / t62;
  t309 = t60 * t308;
  t315 = 0.33251851851851851852e-2 * t161 * t300 * t58 - t170 * t304 * t54 / 0.288e3 + 0.1525192019714694972e-3 * t180 * t309 * t64 + 0.3631409570749273743e-5 * t187 * t300;
  t316 = t27 * t315;
  t317 = t316 * t83;
  t320 = t50 * t79;
  t321 = t204 * t320;
  t325 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t317 + t201 * t321 / 0.2048e4);
  tvsigma0 = t6 * t325;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t326 = t32 * t100;
  t330 = t48 * sigma[2];
  t334 = 0.1e1 / t118;
  t335 = t60 * t334;
  t341 = 0.33251851851851851852e-2 * t249 * t326 * t116 - t258 * t330 * t112 / 0.288e3 + 0.1525192019714694972e-3 * t268 * t335 * t120 + 0.3631409570749273743e-5 * t275 * t326;
  t342 = t27 * t341;
  t343 = t342 * t137;
  t346 = t108 * t133;
  t347 = t289 * t346;
  t351 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t343 + t286 * t347 / 0.2048e4);
  tvsigma2 = t6 * t351;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t354 = t23 * t23;
  t355 = 0.1e1 / t354;
  t356 = t146 * t146;
  t359 = t142 * t6;
  t360 = 0.1e1 / t359;
  t361 = t16 * t360;
  t363 = -0.2e1 * t143 + 0.2e1 * t361;
  t364 = my_piecewise5(t10, 0, t14, 0, t363);
  t368 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t355 * t356 + 0.4e1 / 0.3e1 * t23 * t364);
  t369 = t5 * t368;
  t372 = t150 * t156;
  t376 = t149 * t27;
  t377 = t199 * t376;
  t381 = 0.1e1 / t153 / t6;
  t383 = t381 * t72 * t83;
  t385 = t26 * t383 / 0.12e2;
  t387 = t154 * t192 * t83;
  t388 = t26 * t387;
  t390 = t25 * t154;
  t391 = t199 * t390;
  t392 = t391 * t208;
  t395 = 0.1e1 / t159 / t42;
  t396 = t395 * t46;
  t397 = t396 * t48;
  t398 = t51 * t163;
  t400 = 0.1e1 / t35 / t398;
  t406 = 0.1e1 / t36 / t51;
  t411 = t160 * t75;
  t412 = t78 * t34;
  t413 = 0.1e1 / t412;
  t414 = t76 * t413;
  t417 = t160 * t76;
  t423 = POW_3_2(t66);
  t424 = t423 * t69;
  t425 = t424 * t28;
  t426 = t188 * t406;
  t429 = 0.1e1 / t29;
  t430 = t178 * t429;
  t431 = t62 * sigma[0];
  t432 = 0.1e1 / t172;
  t437 = 0.1e1 / t35 / t163;
  t443 = -0.24326914935053938255e-3 * t397 * t50 * t400 * t58 + 0.32512921810699588477e-1 * t162 * sigma[0] * t406 * t58 - 0.49262002743484224966e-3 * t411 * t414 - 0.50572284599482008956e-5 * t417 * t413 - 0.19e2 / 0.324e3 * t170 * t171 * t400 + 0.81343574384783731842e-2 * t425 * t426 + 0.54229049589855821228e-3 * t430 * t431 * t432 + 0.94900836782247687149e-3 * t180 * t181 * t437 + 0.35507115802881787709e-4 * t187 * t426;
  t445 = t27 * t443 * t83;
  t448 = t192 * t203;
  t449 = t448 * t207;
  t452 = t74 * t74;
  t455 = t2 / t3 / t452;
  t456 = t455 * t200;
  t458 = 0.1e1 / t202 / t82;
  t459 = t72 * t458;
  t460 = t50 * t50;
  t461 = t460 * t50;
  t462 = t78 * t78;
  t464 = 0.1e1 / t462 / t34;
  t465 = t461 * t464;
  t466 = t459 * t465;
  t469 = t204 * t414;
  t472 = -0.3e1 / 0.8e1 * t369 * t84 - t372 / 0.4e1 - 0.3e1 / 0.4e1 * t150 * t194 - t377 * t208 / 0.384e3 + t385 - t388 / 0.4e1 - t392 / 0.1152e4 - 0.3e1 / 0.8e1 * t26 * t445 - t201 * t449 / 0.384e3 - t456 * t466 / 0.110592e6 + 0.3e1 / 0.256e3 * t201 * t469;
  t473 = my_piecewise3(t1, 0, t472);
  t474 = t92 * t92;
  t475 = 0.1e1 / t474;
  t476 = t214 * t214;
  t480 = my_piecewise5(t14, 0, t10, 0, -t363);
  t484 = my_piecewise3(t91, 0, 0.4e1 / 0.9e1 * t475 * t476 + 0.4e1 / 0.3e1 * t92 * t480);
  t485 = t5 * t484;
  t488 = t218 * t222;
  t491 = t381 * t128 * t137;
  t493 = t95 * t491 / 0.12e2;
  t495 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t485 * t138 - t488 / 0.4e1 + t493);
  tv2rho20 = 0.2e1 * t212 + 0.2e1 * t226 + t6 * (t473 + t495);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t498 = t355 * t230;
  t501 = 0.2e1 * t361;
  t502 = my_piecewise5(t10, 0, t14, 0, t501);
  t506 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t498 * t146 + 0.4e1 / 0.3e1 * t23 * t502);
  t507 = t5 * t506;
  t510 = t234 * t156;
  t514 = t233 * t27;
  t515 = t199 * t514;
  t522 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t507 * t84 - t510 / 0.8e1 - 0.3e1 / 0.8e1 * t234 * t194 - t515 * t208 / 0.768e3 - t372 / 0.8e1 + t385 - t388 / 0.8e1 - t392 / 0.2304e4);
  t523 = t475 * t240;
  t526 = my_piecewise5(t14, 0, t10, 0, -t501);
  t530 = my_piecewise3(t91, 0, 0.4e1 / 0.9e1 * t523 * t214 + 0.4e1 / 0.3e1 * t92 * t526);
  t531 = t5 * t530;
  t534 = t244 * t222;
  t540 = t154 * t280 * t137;
  t541 = t95 * t540;
  t543 = t217 * t27;
  t544 = t199 * t543;
  t547 = t94 * t154;
  t548 = t199 * t547;
  t549 = t548 * t293;
  t552 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t531 * t138 - t534 / 0.8e1 - t488 / 0.8e1 + t493 - 0.3e1 / 0.8e1 * t218 * t282 - t541 / 0.8e1 - t544 * t293 / 0.768e3 - t549 / 0.2304e4);
  tv2rho21 = t212 + t226 + t238 + t297 + t6 * (t522 + t552);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t557 = t230 * t230;
  t561 = 0.2e1 * t143 + 0.2e1 * t361;
  t562 = my_piecewise5(t10, 0, t14, 0, t561);
  t566 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t355 * t557 + 0.4e1 / 0.3e1 * t23 * t562);
  t567 = t5 * t566;
  t572 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t567 * t84 - t510 / 0.4e1 + t385);
  t573 = t240 * t240;
  t577 = my_piecewise5(t14, 0, t10, 0, -t561);
  t581 = my_piecewise3(t91, 0, 0.4e1 / 0.9e1 * t475 * t573 + 0.4e1 / 0.3e1 * t92 * t577);
  t582 = t5 * t581;
  t588 = t243 * t27;
  t589 = t199 * t588;
  t595 = 0.1e1 / t247 / t104;
  t596 = t595 * t46;
  t597 = t596 * t48;
  t598 = t109 * t251;
  t600 = 0.1e1 / t97 / t598;
  t606 = 0.1e1 / t98 / t109;
  t611 = t248 * t75;
  t612 = t132 * t96;
  t613 = 0.1e1 / t612;
  t614 = t130 * t613;
  t617 = t248 * t130;
  t623 = POW_3_2(t122);
  t624 = t623 * t125;
  t625 = t624 * t28;
  t626 = t276 * t606;
  t629 = t266 * t429;
  t630 = t118 * sigma[2];
  t631 = 0.1e1 / t260;
  t636 = 0.1e1 / t97 / t251;
  t642 = -0.24326914935053938255e-3 * t597 * t108 * t600 * t116 + 0.32512921810699588477e-1 * t250 * sigma[2] * t606 * t116 - 0.49262002743484224966e-3 * t611 * t614 - 0.50572284599482008956e-5 * t617 * t613 - 0.19e2 / 0.324e3 * t258 * t259 * t600 + 0.81343574384783731842e-2 * t625 * t626 + 0.54229049589855821228e-3 * t629 * t630 * t631 + 0.94900836782247687149e-3 * t268 * t269 * t636 + 0.35507115802881787709e-4 * t275 * t626;
  t644 = t27 * t642 * t137;
  t647 = t280 * t288;
  t648 = t647 * t292;
  t651 = t455 * t285;
  t653 = 0.1e1 / t287 / t136;
  t654 = t128 * t653;
  t655 = t108 * t108;
  t656 = t655 * t108;
  t657 = t132 * t132;
  t659 = 0.1e1 / t657 / t96;
  t660 = t656 * t659;
  t661 = t654 * t660;
  t664 = t289 * t614;
  t667 = -0.3e1 / 0.8e1 * t582 * t138 - t534 / 0.4e1 - 0.3e1 / 0.4e1 * t244 * t282 - t589 * t293 / 0.384e3 + t493 - t541 / 0.4e1 - t549 / 0.1152e4 - 0.3e1 / 0.8e1 * t95 * t644 - t286 * t648 / 0.384e3 - t651 * t661 / 0.110592e6 + 0.3e1 / 0.256e3 * t286 * t664;
  t668 = my_piecewise3(t88, 0, t667);
  tv2rho22 = 0.2e1 * t238 + 0.2e1 * t297 + t6 * (t572 + t668);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t674 = t154 * t315 * t83;
  t676 = t26 * t674 / 0.8e1;
  t681 = t32 * t165;
  t685 = t206 * t50;
  t688 = t160 * t50;
  t697 = 0.1e1 / t52;
  t706 = 0.91225931006452268455e-4 * t397 * t174 * t58 * sigma[0] - 0.88671604938271604939e-2 * t161 * t681 * t58 + 0.18473251028806584362e-3 * t411 * t685 + 0.18964606724805753359e-5 * t688 * t206 + t170 * t304 * t174 / 0.54e2 - 0.3050384039429389944e-2 * t424 * t33 * t165 - 0.2033589359619593296e-3 * t430 * t62 * t697 - 0.2033589359619593296e-3 * t180 * t309 * t183 - 0.9683758855331396648e-5 * t187 * t681;
  t708 = t27 * t706 * t83;
  t711 = t315 * t203;
  t712 = t711 * t207;
  t718 = t391 * t321 / 0.6144e4;
  t719 = t448 * t320;
  t722 = t460 * sigma[0];
  t723 = t462 * rho[0];
  t724 = 0.1e1 / t723;
  t725 = t722 * t724;
  t726 = t459 * t725;
  t729 = t204 * t685;
  t733 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t150 * t317 - t676 - 0.3e1 / 0.8e1 * t26 * t708 - t201 * t712 / 0.768e3 + t377 * t321 / 0.2048e4 + t718 + t201 * t719 / 0.2048e4 + t456 * t726 / 0.294912e6 - t201 * t729 / 0.256e3);
  tv2rhosigma0 = t6 * t733 + t325;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t738 = t154 * t341 * t137;
  t740 = t95 * t738 / 0.8e1;
  t744 = t548 * t347 / 0.6144e4;
  t746 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t218 * t343 - t740 + t544 * t347 / 0.2048e4 + t744);
  tv2rhosigma2 = t6 * t746 + t351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t753 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t234 * t317 - t676 + t515 * t321 / 0.2048e4 + t718);
  tv2rhosigma3 = t6 * t753 + t325;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t761 = t32 * t253;
  t765 = t291 * t108;
  t768 = t248 * t108;
  t777 = 0.1e1 / t110;
  t786 = 0.91225931006452268455e-4 * t597 * t262 * t116 * sigma[2] - 0.88671604938271604939e-2 * t249 * t761 * t116 + 0.18473251028806584362e-3 * t611 * t765 + 0.18964606724805753359e-5 * t768 * t291 + t258 * t330 * t262 / 0.54e2 - 0.3050384039429389944e-2 * t624 * t33 * t253 - 0.2033589359619593296e-3 * t629 * t118 * t777 - 0.2033589359619593296e-3 * t268 * t335 * t271 - 0.9683758855331396648e-5 * t275 * t761;
  t788 = t27 * t786 * t137;
  t791 = t341 * t288;
  t792 = t791 * t292;
  t797 = t647 * t346;
  t800 = t655 * sigma[2];
  t801 = t657 * rho[1];
  t802 = 0.1e1 / t801;
  t803 = t800 * t802;
  t804 = t654 * t803;
  t807 = t289 * t765;
  t811 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t244 * t343 - t740 - 0.3e1 / 0.8e1 * t95 * t788 - t286 * t792 / 0.768e3 + t589 * t347 / 0.2048e4 + t744 + t286 * t797 / 0.2048e4 + t651 * t804 / 0.294912e6 - t286 * t807 / 0.256e3);
  tv2rhosigma5 = t6 * t811 + t351;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t813 = t48 * t54;
  t817 = t79 * sigma[0];
  t820 = t160 * t79;
  t825 = 0.1e1 / sigma[0];
  t826 = t32 * t825;
  t830 = 0.1e1 / t51;
  t834 = 0.1e1 / t431;
  t835 = t60 * t834;
  t839 = -0.34209724127419600671e-4 * t396 * t813 * t58 - 0.69274691358024691358e-4 * t411 * t817 - 0.71117275218021575094e-6 * t820 * sigma[0] - t170 * t813 / 0.288e3 + 0.1143894014786021229e-2 * t425 * t826 * t38 + 0.76259600985734748602e-4 * t430 * t830 * t308 - 0.762596009857347486e-4 * t180 * t835 * t64;
  t841 = t27 * t839 * t83;
  t844 = t711 * t320;
  t847 = 0.1e1 / t462;
  t848 = t460 * t847;
  t849 = t459 * t848;
  t852 = t204 * t817;
  t856 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t841 + t201 * t844 / 0.1024e4 - t456 * t849 / 0.786432e6 + t201 * t852 / 0.1024e4);
  tv2sigma20 = t6 * t856;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t857 = t48 * t112;
  t861 = t133 * sigma[2];
  t864 = t248 * t133;
  t869 = 0.1e1 / sigma[2];
  t870 = t32 * t869;
  t874 = 0.1e1 / t109;
  t878 = 0.1e1 / t630;
  t879 = t60 * t878;
  t883 = -0.34209724127419600671e-4 * t596 * t857 * t116 - 0.69274691358024691358e-4 * t611 * t861 - 0.71117275218021575094e-6 * t864 * sigma[2] - t258 * t857 / 0.288e3 + 0.1143894014786021229e-2 * t625 * t870 * t100 + 0.76259600985734748602e-4 * t629 * t874 * t334 - 0.762596009857347486e-4 * t268 * t879 * t120;
  t885 = t27 * t883 * t137;
  t888 = t791 * t346;
  t891 = 0.1e1 / t657;
  t892 = t655 * t891;
  t893 = t654 * t892;
  t896 = t289 * t861;
  t900 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t885 + t286 * t888 / 0.1024e4 - t651 * t893 / 0.786432e6 + t286 * t896 / 0.1024e4);
  tv2sigma25 = t6 * t900;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t904 = 0.1e1 / t462 / t163;
  t905 = t461 * t904;
  t906 = t459 * t905;
  t909 = t368 * t27;
  t910 = t199 * t909;
  t913 = t149 * t154;
  t914 = t199 * t913;
  t915 = t914 * t208;
  t917 = t443 * t203;
  t918 = t917 * t207;
  t921 = t192 * t458;
  t922 = t921 * t465;
  t928 = t2 / t3 / t452 / t74;
  t929 = t928 * t200;
  t930 = t202 * t202;
  t931 = 0.1e1 / t930;
  t932 = t72 * t931;
  t933 = t460 * t460;
  t934 = t933 * sigma[0];
  t935 = t78 * t163;
  t937 = 0.1e1 / t462 / t935;
  t938 = t934 * t937;
  t939 = t932 * t938;
  t944 = t455 * t376;
  t947 = t25 * t381;
  t948 = t199 * t947;
  t949 = t948 * t208;
  t951 = t391 * t449;
  t953 = t455 * t390;
  t954 = t953 * t466;
  t956 = 0.1e1 / t935;
  t957 = t76 * t956;
  t958 = t204 * t957;
  t961 = t456 * t906 / 0.4096e4 - t910 * t208 / 0.256e3 - t915 / 0.384e3 - t201 * t918 / 0.256e3 - t456 * t922 / 0.36864e5 - t929 * t939 / 0.10616832e8 - t377 * t449 / 0.128e3 - t944 * t466 / 0.36864e5 + t949 / 0.1152e4 - t951 / 0.384e3 - t954 / 0.110592e6 - 0.15e2 / 0.128e3 * t201 * t958;
  t964 = t391 * t469;
  t966 = t448 * t414;
  t969 = t150 * t383;
  t972 = 0.1e1 / t153 / t142;
  t974 = t972 * t72 * t83;
  t976 = 0.5e1 / 0.36e2 * t26 * t974;
  t977 = t369 * t156;
  t979 = t159 * t159;
  t980 = 0.1e1 / t979;
  t981 = t980 * t75;
  t986 = 0.1e1 / t35 / t78;
  t991 = t395 * t28;
  t993 = 0.1e1 / t31 / t74;
  t994 = t993 * t460;
  t995 = t78 * t52;
  t997 = 0.1e1 / t36 / t995;
  t1002 = 0.1e1 / t36 / t52;
  t1009 = t395 * t75;
  t1010 = t1009 * t460;
  t1012 = t997 * t28 * t32;
  t1015 = t395 * t460;
  t1020 = t171 * t986;
  t1023 = sqrt(t66);
  t1024 = t1023 * t69;
  t1025 = t429 * t431;
  t1026 = 0.1e1 / t398;
  t1030 = t423 * t46;
  t1033 = t188 * t1002;
  t1036 = t423 * t429;
  t1037 = t1036 * t50;
  t1039 = t986 * t46 * t60;
  t1046 = 0.1e1 / t35 / t51;
  t1052 = -0.60066456629762810506e-4 * t981 * t957 * t58 + 0.2675960642855933208e-2 * t397 * t50 * t986 * t58 - 0.13514952741696632364e-4 * t991 * t994 * t997 - 0.15172696844993141289e0 * t162 * sigma[0] * t1002 * t58 + 0.6732473708276177412e-2 * t411 * t957 - 0.13514952741696632364e-4 * t1010 * t1012 - 0.13874426501915503143e-6 * t1015 * t1012 + 0.82601398179153947962e-4 * t417 * t956 + 0.209e3 / 0.486e3 * t170 * t1020 - 0.9761228926174047821e-1 * t1024 * t1025 * t1026 - 0.90381749316426368713e-3 * t1030 * t1020 - 0.5694050206934861229e-1 * t425 * t1033 - 0.18076349863285273742e-2 * t1037 * t1039 - 0.48806144630870239106e-2 * t430 * t431 * t1026 - 0.3163361226074922905e-2 * t180 * t181 * t1046 - 0.16569987374678167598e-3 * t187 * t1033;
  t1054 = t27 * t1052 * t83;
  t1058 = t381 * t192 * t83;
  t1059 = t26 * t1058;
  t1062 = t154 * t443 * t83;
  t1063 = t26 * t1062;
  t1066 = 0.1e1 / t354 / t19;
  t1067 = t356 * t146;
  t1070 = t355 * t146;
  t1073 = t142 * t142;
  t1074 = 0.1e1 / t1073;
  t1075 = t16 * t1074;
  t1077 = 0.6e1 * t360 - 0.6e1 * t1075;
  t1078 = my_piecewise5(t10, 0, t14, 0, t1077);
  t1082 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1066 * t1067 + 0.4e1 / 0.3e1 * t1070 * t364 + 0.4e1 / 0.3e1 * t23 * t1078);
  t1083 = t5 * t1082;
  t1088 = t150 * t387;
  t1092 = 0.9e1 / 0.256e3 * t377 * t469 + 0.3e1 / 0.256e3 * t964 + 0.9e1 / 0.256e3 * t201 * t966 + t969 / 0.4e1 - t976 - 0.3e1 / 0.8e1 * t977 - 0.3e1 / 0.8e1 * t26 * t1054 + t1059 / 0.4e1 - 0.3e1 / 0.8e1 * t1063 - 0.3e1 / 0.8e1 * t1083 * t84 - 0.9e1 / 0.8e1 * t369 * t194 - 0.3e1 / 0.4e1 * t1088 - 0.9e1 / 0.8e1 * t150 * t445;
  t1094 = my_piecewise3(t1, 0, t961 + t1092);
  t1096 = 0.1e1 / t474 / t90;
  t1097 = t476 * t214;
  t1100 = t475 * t214;
  t1104 = my_piecewise5(t14, 0, t10, 0, -t1077);
  t1108 = my_piecewise3(t91, 0, -0.8e1 / 0.27e2 * t1096 * t1097 + 0.4e1 / 0.3e1 * t1100 * t480 + 0.4e1 / 0.3e1 * t92 * t1104);
  t1109 = t5 * t1108;
  t1112 = t485 * t222;
  t1114 = t218 * t491;
  t1117 = t972 * t128 * t137;
  t1119 = 0.5e1 / 0.36e2 * t95 * t1117;
  t1121 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t1109 * t138 - 0.3e1 / 0.8e1 * t1112 + t1114 / 0.4e1 - t1119);
  tv3rho30 = 0.3e1 * t473 + 0.3e1 * t495 + t6 * (t1094 + t1121);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t1124 = 0.2e1 * t522;
  t1125 = 0.2e1 * t552;
  t1127 = t507 * t156 / 0.4e1;
  t1128 = t234 * t383;
  t1130 = t506 * t27;
  t1131 = t199 * t1130;
  t1134 = t233 * t154;
  t1135 = t199 * t1134;
  t1137 = t1135 * t208 / 0.1152e4;
  t1140 = t455 * t514;
  t1147 = t234 * t387 / 0.4e1;
  t1150 = -t1127 + t1128 / 0.12e2 - t1131 * t208 / 0.384e3 - t1137 - t515 * t449 / 0.384e3 - t1140 * t466 / 0.110592e6 + t949 / 0.1728e4 - t951 / 0.1152e4 - t954 / 0.331776e6 - t1147 - 0.3e1 / 0.8e1 * t234 * t445;
  t1151 = t1066 * t230;
  t1154 = t355 * t502;
  t1159 = 0.2e1 * t360;
  t1160 = 0.6e1 * t1075;
  t1161 = t1159 - t1160;
  t1162 = my_piecewise5(t10, 0, t14, 0, t1161);
  t1166 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1151 * t356 + 0.8e1 / 0.9e1 * t1154 * t146 + 0.4e1 / 0.9e1 * t498 * t364 + 0.4e1 / 0.3e1 * t23 * t1162);
  t1167 = t5 * t1166;
  t1181 = -0.3e1 / 0.8e1 * t1167 * t84 - 0.3e1 / 0.4e1 * t507 * t194 + t1059 / 0.6e1 - t1063 / 0.8e1 - t1088 / 0.4e1 + 0.3e1 / 0.256e3 * t515 * t469 + t964 / 0.256e3 + t969 / 0.6e1 - t976 - t977 / 0.8e1 - t915 / 0.1152e4;
  t1183 = my_piecewise3(t1, 0, t1150 + t1181);
  t1184 = t1096 * t240;
  t1187 = t475 * t526;
  t1193 = my_piecewise5(t14, 0, t10, 0, -t1161);
  t1197 = my_piecewise3(t91, 0, -0.8e1 / 0.27e2 * t1184 * t476 + 0.8e1 / 0.9e1 * t1187 * t214 + 0.4e1 / 0.9e1 * t523 * t480 + 0.4e1 / 0.3e1 * t92 * t1193);
  t1198 = t5 * t1197;
  t1202 = t531 * t222 / 0.4e1;
  t1203 = t244 * t491;
  t1210 = t218 * t540 / 0.4e1;
  t1212 = t381 * t280 * t137;
  t1213 = t95 * t1212;
  t1215 = t484 * t27;
  t1216 = t199 * t1215;
  t1219 = t217 * t154;
  t1220 = t199 * t1219;
  t1222 = t1220 * t293 / 0.1152e4;
  t1223 = t94 * t381;
  t1224 = t199 * t1223;
  t1225 = t1224 * t293;
  t1227 = -0.3e1 / 0.8e1 * t1198 * t138 - t1202 + t1203 / 0.12e2 - t1112 / 0.8e1 + t1114 / 0.6e1 - t1119 - 0.3e1 / 0.8e1 * t485 * t282 - t1210 + t1213 / 0.12e2 - t1216 * t293 / 0.768e3 - t1222 + t1225 / 0.3456e4;
  t1228 = my_piecewise3(t88, 0, t1227);
  tv3rho31 = t473 + t495 + t1124 + t1125 + t6 * (t1183 + t1228);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t1231 = t1066 * t557;
  t1236 = t355 * t562;
  t1239 = -t1159 - t1160;
  t1240 = my_piecewise5(t10, 0, t14, 0, t1239);
  t1244 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1231 * t146 + 0.8e1 / 0.9e1 * t498 * t502 + 0.4e1 / 0.9e1 * t1236 * t146 + 0.4e1 / 0.3e1 * t23 * t1240);
  t1245 = t5 * t1244;
  t1248 = t567 * t156;
  t1252 = t566 * t27;
  t1253 = t199 * t1252;
  t1260 = -0.3e1 / 0.8e1 * t1245 * t84 - t1248 / 0.8e1 - 0.3e1 / 0.8e1 * t567 * t194 - t1253 * t208 / 0.768e3 - t1127 + t1128 / 0.6e1 - t1147 - t1137 + t969 / 0.12e2 - t976 + t1059 / 0.12e2 + t949 / 0.3456e4;
  t1261 = my_piecewise3(t1, 0, t1260);
  t1262 = t1096 * t573;
  t1267 = t475 * t577;
  t1271 = my_piecewise5(t14, 0, t10, 0, -t1239);
  t1275 = my_piecewise3(t91, 0, -0.8e1 / 0.27e2 * t1262 * t214 + 0.8e1 / 0.9e1 * t523 * t526 + 0.4e1 / 0.9e1 * t1267 * t214 + 0.4e1 / 0.3e1 * t92 * t1271);
  t1276 = t5 * t1275;
  t1279 = t582 * t222;
  t1284 = t244 * t540;
  t1286 = t530 * t27;
  t1287 = t199 * t1286;
  t1290 = t243 * t154;
  t1291 = t199 * t1290;
  t1292 = t1291 * t293;
  t1295 = -0.3e1 / 0.8e1 * t1276 * t138 - t1279 / 0.8e1 - t1202 + t1203 / 0.6e1 - 0.3e1 / 0.4e1 * t531 * t282 - t1284 / 0.4e1 - t1287 * t293 / 0.384e3 - t1292 / 0.1152e4 + t1114 / 0.12e2 - t1119 - t1210;
  t1301 = t154 * t642 * t137;
  t1302 = t95 * t1301;
  t1306 = t548 * t648;
  t1308 = t455 * t543;
  t1311 = t455 * t547;
  t1312 = t1311 * t661;
  t1316 = t548 * t664;
  t1318 = t1213 / 0.6e1 - t1222 + t1225 / 0.1728e4 - 0.3e1 / 0.8e1 * t218 * t644 - t1302 / 0.8e1 - t544 * t648 / 0.384e3 - t1306 / 0.1152e4 - t1308 * t661 / 0.110592e6 - t1312 / 0.331776e6 + 0.3e1 / 0.256e3 * t544 * t664 + t1316 / 0.256e3;
  t1320 = my_piecewise3(t88, 0, t1295 + t1318);
  tv3rho32 = t1124 + t1125 + t572 + t668 + t6 * (t1261 + t1320);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t1325 = t557 * t230;
  t1331 = -0.6e1 * t360 - 0.6e1 * t1075;
  t1332 = my_piecewise5(t10, 0, t14, 0, t1331);
  t1336 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t1066 * t1325 + 0.4e1 / 0.3e1 * t498 * t562 + 0.4e1 / 0.3e1 * t23 * t1332);
  t1337 = t5 * t1336;
  t1343 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1337 * t84 - 0.3e1 / 0.8e1 * t1248 + t1128 / 0.4e1 - t976);
  t1346 = t280 * t653;
  t1347 = t1346 * t660;
  t1350 = t928 * t285;
  t1351 = t287 * t287;
  t1352 = 0.1e1 / t1351;
  t1353 = t128 * t1352;
  t1354 = t655 * t655;
  t1355 = t1354 * sigma[2];
  t1356 = t132 * t251;
  t1358 = 0.1e1 / t657 / t1356;
  t1359 = t1355 * t1358;
  t1360 = t1353 * t1359;
  t1363 = t642 * t288;
  t1364 = t1363 * t292;
  t1367 = t581 * t27;
  t1368 = t199 * t1367;
  t1373 = t455 * t588;
  t1376 = t647 * t614;
  t1380 = 0.1e1 / t657 / t251;
  t1381 = t656 * t1380;
  t1382 = t654 * t1381;
  t1385 = 0.1e1 / t1356;
  t1386 = t130 * t1385;
  t1387 = t289 * t1386;
  t1392 = -t1312 / 0.110592e6 + 0.3e1 / 0.256e3 * t1316 - t651 * t1347 / 0.36864e5 - t1350 * t1360 / 0.10616832e8 - t286 * t1364 / 0.256e3 - t1368 * t293 / 0.256e3 - t589 * t648 / 0.128e3 - t1373 * t661 / 0.36864e5 + 0.9e1 / 0.256e3 * t286 * t1376 + t651 * t1382 / 0.4096e4 - 0.15e2 / 0.128e3 * t286 * t1387 + 0.9e1 / 0.256e3 * t589 * t664;
  t1396 = t247 * t247;
  t1397 = 0.1e1 / t1396;
  t1398 = t1397 * t75;
  t1403 = 0.1e1 / t97 / t132;
  t1408 = t595 * t28;
  t1409 = t993 * t655;
  t1410 = t132 * t110;
  t1412 = 0.1e1 / t98 / t1410;
  t1417 = 0.1e1 / t98 / t110;
  t1424 = t595 * t75;
  t1425 = t1424 * t655;
  t1427 = t1412 * t28 * t32;
  t1430 = t595 * t655;
  t1435 = t259 * t1403;
  t1438 = sqrt(t122);
  t1439 = t1438 * t125;
  t1440 = t429 * t630;
  t1441 = 0.1e1 / t598;
  t1445 = t623 * t46;
  t1448 = t276 * t1417;
  t1451 = t623 * t429;
  t1452 = t1451 * t108;
  t1454 = t1403 * t46 * t60;
  t1461 = 0.1e1 / t97 / t109;
  t1467 = -0.60066456629762810506e-4 * t1398 * t1386 * t116 + 0.2675960642855933208e-2 * t597 * t108 * t1403 * t116 - 0.13514952741696632364e-4 * t1408 * t1409 * t1412 - 0.15172696844993141289e0 * t250 * sigma[2] * t1417 * t116 + 0.6732473708276177412e-2 * t611 * t1386 - 0.13514952741696632364e-4 * t1425 * t1427 - 0.13874426501915503143e-6 * t1430 * t1427 + 0.82601398179153947962e-4 * t617 * t1385 + 0.209e3 / 0.486e3 * t258 * t1435 - 0.9761228926174047821e-1 * t1439 * t1440 * t1441 - 0.90381749316426368713e-3 * t1445 * t1435 - 0.5694050206934861229e-1 * t625 * t1448 - 0.18076349863285273742e-2 * t1452 * t1454 - 0.48806144630870239106e-2 * t629 * t630 * t1441 - 0.3163361226074922905e-2 * t268 * t269 * t1461 - 0.16569987374678167598e-3 * t275 * t1448;
  t1469 = t27 * t1467 * t137;
  t1474 = t573 * t240;
  t1480 = my_piecewise5(t14, 0, t10, 0, -t1331);
  t1484 = my_piecewise3(t91, 0, -0.8e1 / 0.27e2 * t1096 * t1474 + 0.4e1 / 0.3e1 * t523 * t577 + 0.4e1 / 0.3e1 * t92 * t1480);
  t1485 = t5 * t1484;
  t1495 = t1225 / 0.1152e4 - t1292 / 0.384e3 - t1306 / 0.384e3 - 0.3e1 / 0.8e1 * t95 * t1469 - 0.9e1 / 0.8e1 * t244 * t644 - 0.3e1 / 0.8e1 * t1485 * t138 - 0.9e1 / 0.8e1 * t582 * t282 - 0.3e1 / 0.8e1 * t1302 - 0.3e1 / 0.8e1 * t1279 - 0.3e1 / 0.4e1 * t1284 + t1203 / 0.4e1 + t1213 / 0.4e1 - t1119;
  t1497 = my_piecewise3(t88, 0, t1392 + t1495);
  tv3rho33 = 0.3e1 * t572 + 0.3e1 * t668 + t6 * (t1343 + t1497);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1501 = t722 * t464;
  t1502 = t459 * t1501;
  t1505 = t50 * t413;
  t1506 = t204 * t1505;
  t1509 = t711 * t414;
  t1512 = t914 * t321;
  t1517 = t948 * t321 / 0.9216e4;
  t1518 = t391 * t729;
  t1520 = t448 * t685;
  t1523 = t315 * t458;
  t1524 = t1523 * t465;
  t1533 = t391 * t719;
  t1535 = -0.25e2 / 0.294912e6 * t456 * t1502 + 0.9e1 / 0.256e3 * t201 * t1506 + 0.3e1 / 0.256e3 * t201 * t1509 + t1512 / 0.3072e4 - t377 * t729 / 0.128e3 - t1517 - t1518 / 0.384e3 - t201 * t1520 / 0.128e3 - t456 * t1524 / 0.110592e6 + t910 * t321 / 0.2048e4 + t377 * t719 / 0.1024e4 + t944 * t726 / 0.147456e6 + t1533 / 0.3072e4;
  t1536 = t953 * t726;
  t1538 = t917 * t320;
  t1541 = t921 * t725;
  t1545 = 0.1e1 / t462 / t412;
  t1546 = t933 * t1545;
  t1547 = t932 * t1546;
  t1552 = t391 * t712;
  t1554 = t706 * t203;
  t1555 = t1554 * t207;
  t1558 = t413 * t58;
  t1566 = t78 * t51;
  t1568 = 0.1e1 / t36 / t1566;
  t1569 = t993 * t1568;
  t1573 = t32 * t406;
  t1579 = t1009 * t1568;
  t1581 = t76 * t28 * t32;
  t1584 = t395 * t76;
  t1591 = t304 * t400;
  t1603 = t1036 * sigma[0];
  t1605 = t400 * t46 * t60;
  t1616 = 0.2252492123616105394e-4 * t981 * t1558 * t50 - 0.8210333790580704161e-3 * t397 * t400 * t58 * sigma[0] + 0.50681072781362371364e-5 * t991 * t1569 * t76 + 0.32512921810699588478e-1 * t161 * t1573 * t58 - 0.21552126200274348423e-2 * t411 * t1505 + 0.50681072781362371364e-5 * t1579 * t1581 + 0.52029099382183136787e-7 * t1584 * t1568 * t28 * t32 - 0.27182602972221579814e-4 * t688 * t413 - 0.19e2 / 0.162e3 * t170 * t1591 + 0.36604608473152679328e-1 * t1024 * t429 * t432 * t62 + 0.33893155993659888267e-3 * t1030 * t1591 + 0.1525192019714694972e-1 * t424 * t33 * t406 + 0.67786311987319776533e-3 * t1603 * t1605 + 0.14235125517337153072e-2 * t430 * t62 * t432 + 0.47450418391123843573e-3 * t180 * t309 * t437 + 0.35507115802881787709e-4 * t187 * t1573;
  t1618 = t27 * t1616 * t83;
  t1626 = t154 * t706 * t83;
  t1627 = t26 * t1626;
  t1629 = t150 * t674;
  t1632 = t381 * t315 * t83;
  t1634 = t26 * t1632 / 0.12e2;
  t1635 = t1536 / 0.442368e6 + t201 * t1538 / 0.2048e4 + t456 * t1541 / 0.147456e6 + t929 * t1547 / 0.28311552e8 - t377 * t712 / 0.384e3 - t1552 / 0.1152e4 - t201 * t1555 / 0.384e3 - 0.3e1 / 0.8e1 * t26 * t1618 - 0.3e1 / 0.8e1 * t369 * t317 - 0.3e1 / 0.4e1 * t150 * t708 - t1627 / 0.4e1 - t1629 / 0.4e1 + t1634;
  t1637 = my_piecewise3(t1, 0, t1535 + t1635);
  tv3rho2sigma0 = t6 * t1637 + 0.2e1 * t733;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1642 = t218 * t738;
  t1645 = t381 * t341 * t137;
  t1647 = t95 * t1645 / 0.12e2;
  t1650 = t1220 * t347;
  t1653 = t1224 * t347 / 0.9216e4;
  t1655 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t485 * t343 - t1642 / 0.4e1 + t1647 + t1216 * t347 / 0.2048e4 + t1650 / 0.3072e4 - t1653);
  tv3rho2sigma2 = t6 * t1655 + 0.2e1 * t746;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1659 = t234 * t674;
  t1670 = t1135 * t321;
  t1682 = -0.3e1 / 0.8e1 * t507 * t317 - t1659 / 0.8e1 - 0.3e1 / 0.8e1 * t234 * t708 - t515 * t712 / 0.768e3 - t1629 / 0.8e1 + t1634 - t1627 / 0.8e1 - t1552 / 0.2304e4 + t1131 * t321 / 0.2048e4 + t1670 / 0.6144e4 + t515 * t719 / 0.2048e4 + t1140 * t726 / 0.294912e6 - t515 * t729 / 0.256e3 + t1512 / 0.6144e4 - t1517 + t1533 / 0.6144e4 + t1536 / 0.884736e6 - t1518 / 0.768e3;
  t1683 = my_piecewise3(t1, 0, t1682);
  tv3rho2sigma3 = t6 * t1683 + t733 + t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1687 = t244 * t738;
  t1693 = t154 * t786 * t137;
  t1694 = t95 * t1693;
  t1698 = t548 * t792;
  t1702 = t1291 * t347;
  t1707 = t548 * t797;
  t1711 = t1311 * t804;
  t1715 = t548 * t807;
  t1717 = -0.3e1 / 0.8e1 * t531 * t343 - t1687 / 0.8e1 - t1642 / 0.8e1 + t1647 - 0.3e1 / 0.8e1 * t218 * t788 - t1694 / 0.8e1 - t544 * t792 / 0.768e3 - t1698 / 0.2304e4 + t1287 * t347 / 0.2048e4 + t1702 / 0.6144e4 + t1650 / 0.6144e4 - t1653 + t544 * t797 / 0.2048e4 + t1707 / 0.6144e4 + t1308 * t804 / 0.294912e6 + t1711 / 0.884736e6 - t544 * t807 / 0.256e3 - t1715 / 0.768e3;
  t1718 = my_piecewise3(t88, 0, t1717);
  tv3rho2sigma5 = t6 * t1718 + t746 + t811;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1728 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t567 * t317 - t1659 / 0.4e1 + t1634 + t1253 * t321 / 0.2048e4 + t1670 / 0.3072e4 - t1517);
  tv3rho2sigma6 = t6 * t1728 + 0.2e1 * t753;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1731 = t613 * t116;
  t1739 = t132 * t109;
  t1741 = 0.1e1 / t98 / t1739;
  t1742 = t993 * t1741;
  t1746 = t32 * t606;
  t1750 = t613 * t108;
  t1753 = t1424 * t1741;
  t1755 = t130 * t28 * t32;
  t1758 = t595 * t130;
  t1765 = t330 * t600;
  t1777 = t1451 * sigma[2];
  t1779 = t600 * t46 * t60;
  t1790 = 0.2252492123616105394e-4 * t1398 * t1731 * t108 - 0.8210333790580704161e-3 * t597 * t600 * t116 * sigma[2] + 0.50681072781362371364e-5 * t1408 * t1742 * t130 + 0.32512921810699588478e-1 * t249 * t1746 * t116 - 0.21552126200274348423e-2 * t611 * t1750 + 0.50681072781362371364e-5 * t1753 * t1755 + 0.52029099382183136787e-7 * t1758 * t1741 * t28 * t32 - 0.27182602972221579814e-4 * t768 * t613 - 0.19e2 / 0.162e3 * t258 * t1765 + 0.36604608473152679328e-1 * t1439 * t429 * t631 * t118 + 0.33893155993659888267e-3 * t1445 * t1765 + 0.1525192019714694972e-1 * t624 * t33 * t606 + 0.67786311987319776533e-3 * t1777 * t1779 + 0.14235125517337153072e-2 * t629 * t118 * t631 + 0.47450418391123843573e-3 * t268 * t335 * t636 + 0.35507115802881787709e-4 * t275 * t1746;
  t1792 = t27 * t1790 * t137;
  t1804 = t289 * t1750;
  t1809 = t647 * t765;
  t1812 = t800 * t659;
  t1813 = t654 * t1812;
  t1816 = -0.3e1 / 0.8e1 * t95 * t1792 - 0.3e1 / 0.8e1 * t582 * t343 - 0.3e1 / 0.4e1 * t244 * t788 - t1687 / 0.4e1 - t1694 / 0.4e1 + t1647 + t1707 / 0.3072e4 + t1711 / 0.442368e6 - t1715 / 0.384e3 + 0.9e1 / 0.256e3 * t286 * t1804 - t589 * t807 / 0.128e3 - t286 * t1809 / 0.128e3 - 0.25e2 / 0.294912e6 * t651 * t1813;
  t1817 = t791 * t614;
  t1820 = t1346 * t803;
  t1824 = 0.1e1 / t657 / t612;
  t1825 = t1354 * t1824;
  t1826 = t1353 * t1825;
  t1829 = t786 * t288;
  t1830 = t1829 * t292;
  t1833 = t341 * t653;
  t1834 = t1833 * t660;
  t1843 = t1363 * t346;
  t1850 = 0.3e1 / 0.256e3 * t286 * t1817 + t651 * t1820 / 0.147456e6 + t1350 * t1826 / 0.28311552e8 - t286 * t1830 / 0.384e3 - t651 * t1834 / 0.110592e6 + t1368 * t347 / 0.2048e4 + t589 * t797 / 0.1024e4 + t1373 * t804 / 0.147456e6 + t286 * t1843 / 0.2048e4 - t589 * t792 / 0.384e3 - t1653 - t1698 / 0.1152e4 + t1702 / 0.3072e4;
  t1852 = my_piecewise3(t88, 0, t1816 + t1850);
  tv3rho2sigma8 = t6 * t1852 + 0.2e1 * t811;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1857 = t154 * t839 * t83;
  t1859 = t26 * t1857 / 0.8e1;
  t1860 = t206 * t58;
  t1864 = t48 * t174;
  t1869 = 0.1e1 / t36 / t935;
  t1870 = t993 * t1869;
  t1874 = t1009 * t1869;
  t1876 = t50 * t28 * t32;
  t1879 = t206 * sigma[0];
  t1882 = t395 * t1869;
  t1885 = t160 * t206;
  t1890 = t429 * t308;
  t1909 = -0.84468454635603952274e-5 * t981 * t1860 * sigma[0] + 0.18245186201290453691e-3 * t396 * t1864 * t58 - 0.19005402293010889262e-5 * t991 * t1870 * t50 - 0.19005402293010889261e-5 * t1874 * t1876 + 0.55419753086419753086e-3 * t411 * t1879 - 0.19510912268318676295e-7 * t1882 * t1876 + 0.75858426899223013434e-5 * t1885 * sigma[0] + t170 * t1864 / 0.54e2 - 0.13726728177432254748e-1 * t1024 * t1890 * t697 - 0.127099334976224581e-3 * t1030 * t1864 - 0.1525192019714694972e-2 * t425 * t826 * t165 - 0.254198669952449162e-3 * t1036 * t174 * t46 * t60 - 0.25419866995244916201e-3 * t430 * t697 * t308 + 0.1016794679809796648e-3 * t180 * t835 * t183;
  t1911 = t27 * t1909 * t83;
  t1914 = t839 * t203;
  t1915 = t1914 * t207;
  t1921 = t391 * t844 / 0.3072e4;
  t1922 = t1554 * t320;
  t1925 = t1523 * t725;
  t1928 = t711 * t685;
  t1934 = t953 * t849 / 0.2359296e7;
  t1935 = t921 * t848;
  t1938 = t460 * t76;
  t1940 = 0.1e1 / t462 / t205;
  t1941 = t1938 * t1940;
  t1942 = t932 * t1941;
  t1945 = t460 * t724;
  t1946 = t459 * t1945;
  t1952 = t391 * t852 / 0.3072e4;
  t1953 = t448 * t817;
  t1956 = t204 * t1879;
  t1959 = -0.3e1 / 0.8e1 * t150 * t841 - t1859 - 0.3e1 / 0.8e1 * t26 * t1911 - t201 * t1915 / 0.768e3 + t377 * t844 / 0.1024e4 + t1921 + t201 * t1922 / 0.1024e4 + t456 * t1925 / 0.147456e6 - t201 * t1928 / 0.128e3 - t944 * t849 / 0.786432e6 - t1934 - t456 * t1935 / 0.786432e6 - t929 * t1942 / 0.75497472e8 + t456 * t1946 / 0.36864e5 + t377 * t852 / 0.1024e4 + t1952 + t201 * t1953 / 0.1024e4 - t201 * t1956 / 0.128e3;
  t1960 = my_piecewise3(t1, 0, t1959);
  tv3rhosigma20 = t6 * t1960 + t856;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1965 = t154 * t883 * t137;
  t1967 = t95 * t1965 / 0.8e1;
  t1971 = t548 * t888 / 0.3072e4;
  t1975 = t1311 * t893 / 0.2359296e7;
  t1979 = t548 * t896 / 0.3072e4;
  t1981 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t218 * t885 - t1967 + t544 * t888 / 0.1024e4 + t1971 - t1308 * t893 / 0.786432e6 - t1975 + t544 * t896 / 0.1024e4 + t1979);
  tv3rhosigma25 = t6 * t1981 + t900;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1992 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t234 * t841 - t1859 + t515 * t844 / 0.1024e4 + t1921 - t1140 * t849 / 0.786432e6 - t1934 + t515 * t852 / 0.1024e4 + t1952);
  tv3rhosigma26 = t6 * t1992 + t856;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1996 = t291 * t116;
  t2000 = t48 * t262;
  t2005 = 0.1e1 / t98 / t1356;
  t2006 = t993 * t2005;
  t2010 = t1424 * t2005;
  t2012 = t108 * t28 * t32;
  t2015 = t291 * sigma[2];
  t2018 = t595 * t2005;
  t2021 = t248 * t291;
  t2026 = t429 * t334;
  t2045 = -0.84468454635603952274e-5 * t1398 * t1996 * sigma[2] + 0.18245186201290453691e-3 * t596 * t2000 * t116 - 0.19005402293010889262e-5 * t1408 * t2006 * t108 - 0.19005402293010889261e-5 * t2010 * t2012 + 0.55419753086419753086e-3 * t611 * t2015 - 0.19510912268318676295e-7 * t2018 * t2012 + 0.75858426899223013434e-5 * t2021 * sigma[2] + t258 * t2000 / 0.54e2 - 0.13726728177432254748e-1 * t1439 * t2026 * t777 - 0.127099334976224581e-3 * t1445 * t2000 - 0.1525192019714694972e-2 * t625 * t870 * t253 - 0.254198669952449162e-3 * t1451 * t262 * t46 * t60 - 0.25419866995244916201e-3 * t629 * t777 * t334 + 0.1016794679809796648e-3 * t268 * t879 * t271;
  t2047 = t27 * t2045 * t137;
  t2050 = t883 * t288;
  t2051 = t2050 * t292;
  t2056 = t1829 * t346;
  t2059 = t1833 * t803;
  t2062 = t791 * t765;
  t2067 = t1346 * t892;
  t2070 = t655 * t130;
  t2072 = 0.1e1 / t657 / t290;
  t2073 = t2070 * t2072;
  t2074 = t1353 * t2073;
  t2077 = t655 * t802;
  t2078 = t654 * t2077;
  t2083 = t647 * t861;
  t2086 = t289 * t2015;
  t2089 = -0.3e1 / 0.8e1 * t244 * t885 - t1967 - 0.3e1 / 0.8e1 * t95 * t2047 - t286 * t2051 / 0.768e3 + t589 * t888 / 0.1024e4 + t1971 + t286 * t2056 / 0.1024e4 + t651 * t2059 / 0.147456e6 - t286 * t2062 / 0.128e3 - t1373 * t893 / 0.786432e6 - t1975 - t651 * t2067 / 0.786432e6 - t1350 * t2074 / 0.75497472e8 + t651 * t2078 / 0.36864e5 + t589 * t896 / 0.1024e4 + t1979 + t286 * t2083 / 0.1024e4 - t286 * t2086 / 0.128e3;
  t2090 = my_piecewise3(t88, 0, t2089);
  tv3rhosigma211 = t6 * t2090 + t900;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t2096 = 0.1e1 / t36 / t412;
  t2097 = t993 * t2096;
  t2103 = sigma[0] * t28 * t32;
  t2108 = t395 * t2096;
  t2119 = 0.1e1 / t50;
  t2120 = t32 * t2119;
  t2124 = t1036 * t54;
  t2126 = t825 * t46 * t60;
  t2132 = t62 * t50;
  t2133 = 0.1e1 / t2132;
  t2134 = t60 * t2133;
  t2138 = 0.31675670488351482103e-5 * t981 * t79 * t58 + 0.71270258598790834731e-6 * t991 * t2097 * sigma[0] + 0.71270258598790834731e-6 * t1009 * t2096 * t2103 - 0.69274691358024691358e-4 * t411 * t79 + 0.73165921006195036105e-8 * t2108 * t2103 - 0.14223455043604315019e-5 * t820 + 0.51475230665370955305e-2 * t1024 * t429 * t834 * t830 + 0.47662250616084217875e-4 * t1030 * t813 * t825 - 0.17158410221790318435e-2 * t425 * t2120 * t38 + 0.95324501232168435752e-4 * t2124 * t2126 - 0.57194700739301061451e-4 * t430 * t830 * t834 + 0.1143894014786021229e-3 * t180 * t2134 * t64;
  t2140 = t27 * t2138 * t83;
  t2143 = t1914 * t320;
  t2146 = t1523 * t848;
  t2149 = t711 * t817;
  t2153 = 0.1e1 / t462 / t78;
  t2154 = t461 * t2153;
  t2155 = t932 * t2154;
  t2158 = t76 * t847;
  t2159 = t459 * t2158;
  t2162 = t199 * t25;
  t2163 = t203 * t79;
  t2164 = t73 * t2163;
  t2168 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t2140 + 0.3e1 / 0.2048e4 * t201 * t2143 - t456 * t2146 / 0.262144e6 + 0.3e1 / 0.1024e4 * t201 * t2149 + t929 * t2155 / 0.201326592e9 - t456 * t2159 / 0.131072e6 + t2162 * t2164 / 0.1024e4);
  tv3sigma30 = t6 * t2168;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t2173 = 0.1e1 / t98 / t612;
  t2174 = t993 * t2173;
  t2180 = sigma[2] * t28 * t32;
  t2185 = t595 * t2173;
  t2196 = 0.1e1 / t108;
  t2197 = t32 * t2196;
  t2201 = t1451 * t112;
  t2203 = t869 * t46 * t60;
  t2209 = t118 * t108;
  t2210 = 0.1e1 / t2209;
  t2211 = t60 * t2210;
  t2215 = 0.31675670488351482103e-5 * t1398 * t133 * t116 + 0.71270258598790834731e-6 * t1408 * t2174 * sigma[2] + 0.71270258598790834731e-6 * t1424 * t2173 * t2180 - 0.69274691358024691358e-4 * t611 * t133 + 0.73165921006195036105e-8 * t2185 * t2180 - 0.14223455043604315019e-5 * t864 + 0.51475230665370955305e-2 * t1439 * t429 * t878 * t874 + 0.47662250616084217875e-4 * t1445 * t857 * t869 - 0.17158410221790318435e-2 * t625 * t2197 * t100 + 0.95324501232168435752e-4 * t2201 * t2203 - 0.57194700739301061451e-4 * t629 * t874 * t878 + 0.1143894014786021229e-3 * t268 * t2211 * t120;
  t2217 = t27 * t2215 * t137;
  t2220 = t2050 * t346;
  t2223 = t1833 * t892;
  t2226 = t791 * t861;
  t2230 = 0.1e1 / t657 / t132;
  t2231 = t656 * t2230;
  t2232 = t1353 * t2231;
  t2235 = t130 * t891;
  t2236 = t654 * t2235;
  t2239 = t199 * t94;
  t2240 = t288 * t133;
  t2241 = t129 * t2240;
  t2245 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t2217 + 0.3e1 / 0.2048e4 * t286 * t2220 - t651 * t2223 / 0.262144e6 + 0.3e1 / 0.1024e4 * t286 * t2226 + t1350 * t2232 / 0.201326592e9 - t651 * t2236 / 0.131072e6 + t2239 * t2241 / 0.1024e4);
  tv3sigma39 = t6 * t2245;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t2251 = 0.1e1 / t36 / t172;
  t2256 = 0.1e1/sqrt(t66);
  t2258 = t2256 * t69 * t429;
  t2260 = 0.1e1 / t35 / t205;
  t2261 = t50 * t2260;
  t2265 = t188 * t2251;
  t2277 = 0.1e1 / t979 / t42 * t75;
  t2279 = t78 * t172;
  t2281 = 0.1e1 / t36 / t2279;
  t2289 = 0.1e1 / t1566;
  t2292 = t76 * t2289;
  t2295 = t171 * t2260;
  t2301 = 0.85978615454961133971e0 * t162 * sigma[0] * t2251 * t58 + 0.65074859507826985473e-1 * t2258 * t2261 * t61 + 0.38593006958114059441e0 * t425 * t2265 + 0.31332339763027807821e-1 * t1037 * t2260 * t46 * t60 + 0.13707898646324665922e-1 * t180 * t181 * t54 - 0.32958275242668208782e-5 * t2277 * t460 * t2281 * t58 * t33 - 0.26462277468242006168e-1 * t397 * t2261 * t58 - 0.11434955462216209803e-2 * t417 * t2289 - 0.82486486816034141137e-1 * t411 * t2292 - 0.5225e4 / 0.1458e4 * t170 * t2295 + 0.1366572049664366695e1 * t1024 * t1025 * t79;
  t2302 = t1023 * t28;
  t2303 = t2302 * t32;
  t2317 = 0.1e1 / t35 / t723;
  t2319 = t2317 * t46 * t48;
  t2323 = t2281 * t28 * t32;
  t2334 = t980 * t46;
  t2337 = 0.1e1 / t30 / t74 / t29;
  t2346 = 0.1e1 / t31 / t29;
  t2351 = 0.32537429753913492736e-1 * t2303 * t2132 * t2096 * t429 + 0.13858534895185376536e-1 * t1030 * t2295 + 0.93896595123176283055e-3 * t187 * t2265 + 0.13214620458547818311e-2 * t981 * t2292 * t58 - 0.11123417894400520464e-5 * t981 * t722 * t2319 + 0.36940870827304128461e-3 * t1010 * t2323 + 0.41623279505746509429e-5 * t1015 * t2323 + 0.40912805190569002904e-1 * t430 * t431 * t79 + 0.33336883429518359831e-3 * t991 * t994 * t2281 - 0.55617089472002602321e-6 * t2334 * t2337 * t722 * t2317 - 0.57096405357676967667e-8 * t980 * t722 * t2319 + 0.10845809917971164246e-1 * t2302 * t2346 * t2132 * t2096;
  t2357 = t150 * t1062;
  t2359 = t150 * t1058;
  t2362 = t26 * t381 * t443 * t83;
  t2366 = t26 * t972 * t192 * t83;
  t2370 = t26 * t154 * t1052 * t83;
  t2372 = t369 * t383;
  t2374 = t19 * t19;
  t2376 = 0.1e1 / t354 / t2374;
  t2377 = t356 * t356;
  t2383 = t364 * t364;
  t2390 = t16 / t1073 / t6;
  t2392 = -0.24e2 * t1074 + 0.24e2 * t2390;
  t2393 = my_piecewise5(t10, 0, t14, 0, t2392);
  t2397 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2376 * t2377 - 0.16e2 / 0.9e1 * t1066 * t356 * t364 + 0.4e1 / 0.3e1 * t355 * t2383 + 0.16e2 / 0.9e1 * t1070 * t1078 + 0.4e1 / 0.3e1 * t23 * t2393);
  t2405 = t150 * t974;
  t2407 = -0.3e1 / 0.2e1 * t150 * t1054 - 0.3e1 / 0.8e1 * t26 * t27 * (t2301 + t2351) * t83 - 0.3e1 / 0.2e1 * t2357 + t2359 + t2362 / 0.2e1 - 0.5e1 / 0.9e1 * t2366 - t2370 / 0.2e1 + t2372 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t2397 * t84 - 0.3e1 / 0.2e1 * t1083 * t194 - 0.9e1 / 0.4e1 * t369 * t445 - 0.5e1 / 0.9e1 * t2405;
  t2409 = 0.1e1 / t153 / t359;
  t2413 = 0.1e2 / 0.27e2 * t26 * t2409 * t72 * t83;
  t2414 = t1083 * t156;
  t2416 = t369 * t387;
  t2418 = t452 * t452;
  t2421 = t2 / t3 / t2418;
  t2422 = t2421 * t200;
  t2425 = t72 / t930 / t82;
  t2427 = t462 * t462;
  t2436 = t455 * t909;
  t2440 = t199 * t149 * t381;
  t2441 = t2440 * t208;
  t2443 = t948 * t449;
  t2445 = t455 * t947;
  t2446 = t2445 * t466;
  t2450 = t1052 * t203;
  t2454 = t443 * t458;
  t2460 = t2413 - t2414 / 0.2e1 - 0.3e1 / 0.2e1 * t2416 - t2422 * t2425 * t933 * t460 / t2427 / t51 / 0.764411904e9 - t910 * t449 / 0.64e2 - t2436 * t466 / 0.18432e5 + t2441 / 0.288e3 + t2443 / 0.288e3 + t2446 / 0.82944e5 - t377 * t918 / 0.64e2 - t201 * t2450 * t207 / 0.192e3 - t456 * t2454 * t465 / 0.18432e5 - t944 * t922 / 0.9216e4;
  t2462 = t192 * t931;
  t2466 = t953 * t906;
  t2468 = t391 * t958;
  t2473 = t914 * t469;
  t2481 = t914 * t449;
  t2485 = t455 * t913;
  t2486 = t2485 * t466;
  t2491 = t199 * t25 * t972;
  t2492 = t2491 * t208;
  t2494 = t948 * t469;
  t2496 = -t929 * t2462 * t938 / 0.2654208e7 + t2466 / 0.3072e4 - 0.5e1 / 0.32e2 * t2468 + 0.165e3 / 0.128e3 * t201 * t204 * t2292 + 0.3e1 / 0.64e2 * t2473 + t929 * t932 * t934 / t462 / t1566 / 0.196608e6 - t2481 / 0.96e2 + 0.9e1 / 0.64e2 * t377 * t966 - t2486 / 0.27648e5 + t944 * t906 / 0.1024e4 - 0.5e1 / 0.2592e4 * t2492 - t2494 / 0.64e2;
  t2497 = t391 * t966;
  t2499 = t391 * t918;
  t2504 = t953 * t922;
  t2509 = t928 * t390;
  t2510 = t2509 * t939;
  t2513 = t199 * t368 * t154;
  t2514 = t2513 * t208;
  t2530 = t199 * t1082 * t27;
  t2533 = t928 * t376;
  t2536 = 0.3e1 / 0.64e2 * t2497 - t2499 / 0.192e3 + 0.9e1 / 0.128e3 * t201 * t917 * t414 - t2504 / 0.27648e5 + t456 * t921 * t905 / 0.1024e4 - t2510 / 0.7962624e7 - t2514 / 0.192e3 - 0.15e2 / 0.32e2 * t377 * t958 - 0.15e2 / 0.32e2 * t201 * t448 * t957 - 0.67e2 / 0.12288e5 * t456 * t459 * t461 / t462 / t51 + 0.9e1 / 0.128e3 * t910 * t469 - t2530 * t208 / 0.192e3 - t2533 * t939 / 0.2654208e7;
  t2539 = my_piecewise3(t1, 0, t2407 + t2460 + t2496 + t2536);
  t2540 = t90 * t90;
  t2542 = 0.1e1 / t474 / t2540;
  t2543 = t476 * t476;
  t2549 = t480 * t480;
  t2555 = my_piecewise5(t14, 0, t10, 0, -t2392);
  t2559 = my_piecewise3(t91, 0, 0.4e2 / 0.81e2 * t2542 * t2543 - 0.16e2 / 0.9e1 * t1096 * t476 * t480 + 0.4e1 / 0.3e1 * t475 * t2549 + 0.16e2 / 0.9e1 * t1100 * t1104 + 0.4e1 / 0.3e1 * t92 * t2555);
  t2563 = t1109 * t222;
  t2565 = t485 * t491;
  t2567 = t218 * t1117;
  t2572 = 0.1e2 / 0.27e2 * t95 * t2409 * t128 * t137;
  t2574 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t5 * t2559 * t138 - t2563 / 0.2e1 + t2565 / 0.2e1 - 0.5e1 / 0.9e1 * t2567 + t2572);
  tv4rho40 = 0.4e1 * t1094 + 0.4e1 * t1121 + t6 * (t2539 + t2574);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t2579 = t507 * t383;
  t2580 = t2579 / 0.4e1;
  t2581 = t234 * t974;
  t2601 = 0.12e2 * t1074;
  t2602 = 0.24e2 * t2390;
  t2603 = -t2601 + t2602;
  t2604 = my_piecewise5(t10, 0, t14, 0, t2603);
  t2608 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2376 * t230 * t1067 - 0.8e1 / 0.9e1 * t1066 * t502 * t356 - 0.8e1 / 0.9e1 * t1151 * t146 * t364 + 0.4e1 / 0.3e1 * t355 * t1162 * t146 + 0.4e1 / 0.3e1 * t1154 * t364 + 0.4e1 / 0.9e1 * t498 * t1078 + 0.4e1 / 0.3e1 * t23 * t2604);
  t2614 = t234 * t1062;
  t2616 = t1167 * t156;
  t2618 = t507 * t387;
  t2620 = t234 * t1058;
  t2621 = t2620 / 0.4e1;
  t2626 = t2580 - 0.5e1 / 0.36e2 * t2581 - 0.3e1 / 0.8e1 * t234 * t1054 - 0.3e1 / 0.8e1 * t5 * t2608 * t84 - 0.9e1 / 0.8e1 * t1167 * t194 - 0.3e1 / 0.8e1 * t2614 - 0.3e1 / 0.8e1 * t2616 - 0.3e1 / 0.4e1 * t2618 + t2621 - 0.9e1 / 0.8e1 * t507 * t445 - 0.3e1 / 0.8e1 * t2357 + t2359 / 0.2e1;
  t2637 = t1135 * t449;
  t2639 = t455 * t1134;
  t2640 = t2639 * t466;
  t2642 = t2362 / 0.4e1 - 0.5e1 / 0.12e2 * t2366 - t2370 / 0.8e1 + t2372 / 0.4e1 - 0.5e1 / 0.12e2 * t2405 + t2413 - t2414 / 0.8e1 - 0.3e1 / 0.8e1 * t2416 + t2441 / 0.576e3 + t2443 / 0.576e3 + t2446 / 0.165888e6 - t2637 / 0.384e3 - t2640 / 0.110592e6;
  t2648 = t928 * t514;
  t2652 = t199 * t506 * t154;
  t2653 = t2652 * t208;
  t2656 = t199 * t233 * t381;
  t2657 = t2656 * t208;
  t2658 = t2657 / 0.1152e4;
  t2660 = t199 * t1166 * t27;
  t2665 = t455 * t1130;
  t2674 = t1135 * t469;
  t2676 = -t515 * t918 / 0.256e3 - t1140 * t922 / 0.36864e5 - t2648 * t939 / 0.10616832e8 - t2653 / 0.384e3 + t2658 - t2660 * t208 / 0.256e3 - t1131 * t449 / 0.128e3 - t2665 * t466 / 0.36864e5 - 0.15e2 / 0.128e3 * t515 * t958 + t1140 * t906 / 0.4096e4 + 0.9e1 / 0.256e3 * t1131 * t469 + 0.3e1 / 0.256e3 * t2674;
  t2691 = 0.9e1 / 0.256e3 * t515 * t966 + t2466 / 0.12288e5 - 0.5e1 / 0.128e3 * t2468 + 0.3e1 / 0.256e3 * t2473 - t2481 / 0.384e3 - t2486 / 0.110592e6 - 0.5e1 / 0.3456e4 * t2492 - t2494 / 0.128e3 + 0.3e1 / 0.256e3 * t2497 - t2499 / 0.768e3 - t2504 / 0.110592e6 - t2510 / 0.31850496e8 - t2514 / 0.768e3;
  t2694 = my_piecewise3(t1, 0, t2626 + t2642 + t2676 + t2691);
  t2712 = my_piecewise5(t14, 0, t10, 0, -t2603);
  t2716 = my_piecewise3(t91, 0, 0.4e2 / 0.81e2 * t2542 * t240 * t1097 - 0.8e1 / 0.9e1 * t1096 * t526 * t476 - 0.8e1 / 0.9e1 * t1184 * t214 * t480 + 0.4e1 / 0.3e1 * t475 * t1193 * t214 + 0.4e1 / 0.3e1 * t1187 * t480 + 0.4e1 / 0.9e1 * t523 * t1104 + 0.4e1 / 0.3e1 * t92 * t2712);
  t2720 = t1198 * t222;
  t2722 = t531 * t491;
  t2723 = t2722 / 0.4e1;
  t2724 = t244 * t1117;
  t2731 = t485 * t540;
  t2733 = t218 * t1212;
  t2734 = t2733 / 0.4e1;
  t2737 = t95 * t972 * t280 * t137;
  t2740 = t199 * t1108 * t27;
  t2744 = t199 * t484 * t154;
  t2745 = t2744 * t293;
  t2748 = t199 * t217 * t381;
  t2749 = t2748 * t293;
  t2750 = t2749 / 0.1152e4;
  t2752 = t199 * t94 * t972;
  t2753 = t2752 * t293;
  t2755 = -0.3e1 / 0.8e1 * t5 * t2716 * t138 - 0.3e1 / 0.8e1 * t2720 + t2723 - 0.5e1 / 0.36e2 * t2724 - t2563 / 0.8e1 + t2565 / 0.4e1 - 0.5e1 / 0.12e2 * t2567 + t2572 - 0.3e1 / 0.8e1 * t1109 * t282 - 0.3e1 / 0.8e1 * t2731 + t2734 - 0.5e1 / 0.36e2 * t2737 - t2740 * t293 / 0.768e3 - t2745 / 0.768e3 + t2750 - 0.5e1 / 0.10368e5 * t2753;
  t2756 = my_piecewise3(t88, 0, t2755);
  tv4rho41 = t1094 + t1121 + 0.3e1 * t1183 + 0.3e1 * t1228 + t6 * (t2694 + t2756);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t2776 = t455 * t1252;
  t2780 = t199 * t1244 * t27;
  t2784 = t199 * t566 * t154;
  t2785 = t2784 * t208;
  t2787 = t2579 / 0.3e1 - 0.5e1 / 0.18e2 * t2581 - t2614 / 0.4e1 - t2616 / 0.4e1 - t2618 / 0.2e1 + t2620 / 0.3e1 + t2359 / 0.6e1 + t2362 / 0.12e2 - 0.5e1 / 0.18e2 * t2366 + t2372 / 0.12e2 - 0.5e1 / 0.18e2 * t2405 + t2413 - t1253 * t449 / 0.384e3 - t2776 * t466 / 0.110592e6 - t2780 * t208 / 0.384e3 - t2785 / 0.1152e4;
  t2810 = t502 * t502;
  t2823 = my_piecewise5(t10, 0, t14, 0, t2602);
  t2827 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2376 * t557 * t356 - 0.32e2 / 0.27e2 * t1151 * t146 * t502 - 0.8e1 / 0.27e2 * t1231 * t364 + 0.8e1 / 0.9e1 * t355 * t2810 + 0.8e1 / 0.9e1 * t498 * t1162 - 0.8e1 / 0.27e2 * t1066 * t562 * t356 + 0.8e1 / 0.9e1 * t355 * t1240 * t146 + 0.4e1 / 0.9e1 * t1236 * t364 + 0.4e1 / 0.3e1 * t23 * t2823);
  t2833 = t567 * t387;
  t2835 = t1245 * t156;
  t2837 = t567 * t383;
  t2839 = 0.3e1 / 0.256e3 * t1253 * t469 + t2441 / 0.1728e4 + t2443 / 0.1728e4 + t2446 / 0.497664e6 - t2637 / 0.576e3 - t2640 / 0.165888e6 - t2653 / 0.576e3 + t2657 / 0.864e3 + t2674 / 0.128e3 - 0.5e1 / 0.5184e4 * t2492 - t2494 / 0.384e3 - 0.3e1 / 0.8e1 * t567 * t445 - 0.3e1 / 0.8e1 * t5 * t2827 * t84 - 0.3e1 / 0.4e1 * t1245 * t194 - t2833 / 0.4e1 - t2835 / 0.4e1 + t2837 / 0.12e2;
  t2841 = my_piecewise3(t1, 0, t2787 + t2839);
  t2844 = t1224 * t664;
  t2848 = t455 * t1215;
  t2854 = t199 * t1197 * t27;
  t2857 = t1224 * t648;
  t2859 = t455 * t1219;
  t2860 = t2859 * t661;
  t2862 = t455 * t1223;
  t2863 = t2862 * t661;
  t2865 = t1220 * t664;
  t2868 = t199 * t530 * t154;
  t2869 = t2868 * t293;
  t2872 = t199 * t243 * t381;
  t2873 = t2872 * t293;
  t2875 = t1220 * t648;
  t2878 = t2565 / 0.12e2 - 0.5e1 / 0.18e2 * t2567 + t2572 - t2844 / 0.384e3 - t1216 * t648 / 0.384e3 - t2848 * t661 / 0.110592e6 + 0.3e1 / 0.256e3 * t1216 * t664 - t2854 * t293 / 0.384e3 + t2857 / 0.1728e4 - t2860 / 0.165888e6 + t2863 / 0.497664e6 + t2865 / 0.128e3 - t2869 / 0.576e3 + t2873 / 0.1728e4 - t2875 / 0.576e3 - t2745 / 0.1152e4;
  t2881 = t531 * t540;
  t2883 = t244 * t1212;
  t2893 = t526 * t526;
  t2906 = my_piecewise5(t14, 0, t10, 0, -t2602);
  t2910 = my_piecewise3(t91, 0, 0.4e2 / 0.81e2 * t2542 * t573 * t476 - 0.32e2 / 0.27e2 * t1184 * t214 * t526 - 0.8e1 / 0.27e2 * t1262 * t480 + 0.8e1 / 0.9e1 * t475 * t2893 + 0.8e1 / 0.9e1 * t523 * t1193 - 0.8e1 / 0.27e2 * t1096 * t577 * t476 + 0.8e1 / 0.9e1 * t475 * t1271 * t214 + 0.4e1 / 0.9e1 * t1267 * t480 + 0.4e1 / 0.3e1 * t92 * t2906);
  t2918 = t218 * t1301;
  t2922 = t95 * t381 * t642 * t137;
  t2924 = t1276 * t222;
  t2926 = t582 * t491;
  t2934 = t2749 / 0.864e3 - 0.5e1 / 0.5184e4 * t2753 - t2881 / 0.2e1 + t2883 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t2910 * t138 - 0.3e1 / 0.4e1 * t1198 * t282 - 0.3e1 / 0.8e1 * t485 * t644 - t2918 / 0.4e1 + t2922 / 0.12e2 - t2924 / 0.4e1 + t2926 / 0.12e2 - 0.5e1 / 0.18e2 * t2737 - t2720 / 0.4e1 + t2722 / 0.3e1 - 0.5e1 / 0.18e2 * t2724 - t2731 / 0.4e1 + t2733 / 0.3e1;
  t2936 = my_piecewise3(t88, 0, t2878 + t2934);
  tv4rho42 = 0.2e1 * t1183 + 0.2e1 * t1228 + 0.2e1 * t1261 + 0.2e1 * t1320 + t6 * (t2841 + t2936);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t2956 = t2601 + t2602;
  t2957 = my_piecewise5(t10, 0, t14, 0, t2956);
  t2961 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2376 * t1325 * t146 - 0.8e1 / 0.9e1 * t1231 * t502 - 0.8e1 / 0.9e1 * t1151 * t562 * t146 + 0.4e1 / 0.3e1 * t1154 * t562 + 0.4e1 / 0.3e1 * t498 * t1240 + 0.4e1 / 0.9e1 * t355 * t1332 * t146 + 0.4e1 / 0.3e1 * t23 * t2957);
  t2965 = t1337 * t156;
  t2970 = t199 * t1336 * t27;
  t2981 = -0.3e1 / 0.8e1 * t5 * t2961 * t84 - t2965 / 0.8e1 - 0.3e1 / 0.8e1 * t1337 * t194 - t2970 * t208 / 0.768e3 - 0.3e1 / 0.8e1 * t2835 + t2837 / 0.4e1 - 0.3e1 / 0.8e1 * t2833 - t2785 / 0.768e3 + t2580 - 0.5e1 / 0.12e2 * t2581 + t2621 + t2658 - 0.5e1 / 0.36e2 * t2405 + t2413 - 0.5e1 / 0.36e2 * t2366 - 0.5e1 / 0.10368e5 * t2492;
  t2982 = my_piecewise3(t1, 0, t2981);
  t2994 = t455 * t1286;
  t2997 = -0.5e1 / 0.36e2 * t2567 + t2572 - t2844 / 0.128e3 + t2857 / 0.576e3 - t2860 / 0.110592e6 + t2863 / 0.165888e6 + 0.3e1 / 0.256e3 * t2865 - t2869 / 0.384e3 + t2873 / 0.576e3 - t2875 / 0.384e3 - t1287 * t648 / 0.128e3 - t2994 * t661 / 0.36864e5;
  t2999 = t244 * t1301;
  t3001 = t1485 * t222;
  t3003 = t582 * t540;
  t3025 = my_piecewise5(t14, 0, t10, 0, -t2956);
  t3029 = my_piecewise3(t91, 0, 0.4e2 / 0.81e2 * t2542 * t1474 * t214 - 0.8e1 / 0.9e1 * t1262 * t526 - 0.8e1 / 0.9e1 * t1184 * t577 * t214 + 0.4e1 / 0.3e1 * t1187 * t577 + 0.4e1 / 0.3e1 * t523 * t1271 + 0.4e1 / 0.9e1 * t475 * t1480 * t214 + 0.4e1 / 0.3e1 * t92 * t3025);
  t3037 = t95 * t154 * t1467 * t137;
  t3042 = t2750 - 0.5e1 / 0.3456e4 * t2753 - 0.3e1 / 0.8e1 * t2999 - t3001 / 0.8e1 - 0.3e1 / 0.8e1 * t3003 - 0.3e1 / 0.8e1 * t218 * t1469 - 0.9e1 / 0.8e1 * t531 * t644 - 0.3e1 / 0.8e1 * t5 * t3029 * t138 - 0.9e1 / 0.8e1 * t1276 * t282 - t3037 / 0.8e1 - 0.3e1 / 0.4e1 * t2881 + t2883 / 0.2e1 - 0.3e1 / 0.8e1 * t2918;
  t3059 = t2922 / 0.4e1 - 0.3e1 / 0.8e1 * t2924 + t2926 / 0.4e1 - 0.5e1 / 0.12e2 * t2737 + t2723 - 0.5e1 / 0.12e2 * t2724 + t2734 + 0.9e1 / 0.256e3 * t544 * t1376 + t1308 * t1382 / 0.4096e4 - 0.15e2 / 0.128e3 * t544 * t1387 + 0.9e1 / 0.256e3 * t1287 * t664 - t1308 * t1347 / 0.36864e5;
  t3060 = t928 * t543;
  t3066 = t199 * t1275 * t27;
  t3069 = t548 * t1387;
  t3071 = t1291 * t664;
  t3074 = t199 * t581 * t154;
  t3075 = t3074 * t293;
  t3077 = t1291 * t648;
  t3079 = t455 * t1290;
  t3080 = t3079 * t661;
  t3082 = t548 * t1376;
  t3084 = t1311 * t1382;
  t3086 = t1311 * t1347;
  t3088 = t928 * t547;
  t3089 = t3088 * t1360;
  t3091 = t548 * t1364;
  t3093 = -t3060 * t1360 / 0.10616832e8 - t544 * t1364 / 0.256e3 - t3066 * t293 / 0.256e3 - 0.5e1 / 0.128e3 * t3069 + 0.3e1 / 0.256e3 * t3071 - t3075 / 0.768e3 - t3077 / 0.384e3 - t3080 / 0.110592e6 + 0.3e1 / 0.256e3 * t3082 + t3084 / 0.12288e5 - t3086 / 0.110592e6 - t3089 / 0.31850496e8 - t3091 / 0.768e3;
  t3096 = my_piecewise3(t88, 0, t2997 + t3042 + t3059 + t3093);
  tv4rho43 = 0.3e1 * t1261 + 0.3e1 * t1320 + t1343 + t1497 + t6 * (t2982 + t3096);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t3101 = t557 * t557;
  t3106 = t562 * t562;
  t3112 = 0.24e2 * t1074 + 0.24e2 * t2390;
  t3113 = my_piecewise5(t10, 0, t14, 0, t3112);
  t3117 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t2376 * t3101 - 0.16e2 / 0.9e1 * t1231 * t562 + 0.4e1 / 0.3e1 * t355 * t3106 + 0.16e2 / 0.9e1 * t498 * t1332 + 0.4e1 / 0.3e1 * t23 * t3113);
  t3125 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t3117 * t84 - t2965 / 0.2e1 + t2837 / 0.2e1 - 0.5e1 / 0.9e1 * t2581 + t2413);
  t3133 = 0.1e1 / t97 / t801;
  t3135 = t3133 * t46 * t48;
  t3138 = t1438 * t28;
  t3146 = t132 * t260;
  t3148 = 0.1e1 / t98 / t3146;
  t3152 = t1397 * t46;
  t3158 = 0.1e1 / t98 / t260;
  t3159 = t276 * t3158;
  t3163 = t3148 * t28 * t32;
  t3167 = 0.1e1 / t97 / t290;
  t3168 = t259 * t3167;
  t3174 = t3138 * t32;
  t3181 = -0.57096405357676967667e-8 * t1397 * t800 * t3135 + 0.10845809917971164246e-1 * t3138 * t2346 * t2209 * t2173 + 0.40912805190569002904e-1 * t629 * t630 * t133 + 0.33336883429518359831e-3 * t1408 * t1409 * t3148 - 0.55617089472002602321e-6 * t3152 * t2337 * t800 * t3133 + 0.93896595123176283055e-3 * t275 * t3159 + 0.41623279505746509429e-5 * t1430 * t3163 - 0.5225e4 / 0.1458e4 * t258 * t3168 + 0.1366572049664366695e1 * t1439 * t1440 * t133 + 0.32537429753913492736e-1 * t3174 * t2209 * t2173 * t429 + 0.13858534895185376536e-1 * t1445 * t3168;
  t3182 = 0.1e1 / t1739;
  t3183 = t130 * t3182;
  t3199 = 0.1e1/sqrt(t122);
  t3201 = t3199 * t125 * t429;
  t3202 = t108 * t3167;
  t3214 = 0.1e1 / t1396 / t104 * t75;
  t3227 = 0.13214620458547818311e-2 * t1398 * t3183 * t116 - 0.11123417894400520464e-5 * t1398 * t800 * t3135 + 0.36940870827304128461e-3 * t1425 * t3163 + 0.13707898646324665922e-1 * t268 * t269 * t112 + 0.85978615454961133971e0 * t250 * sigma[2] * t3158 * t116 + 0.65074859507826985473e-1 * t3201 * t3202 * t61 + 0.38593006958114059441e0 * t625 * t3159 + 0.31332339763027807821e-1 * t1452 * t3167 * t46 * t60 - 0.32958275242668208782e-5 * t3214 * t655 * t3148 * t116 * t33 - 0.26462277468242006168e-1 * t597 * t3202 * t116 - 0.82486486816034141137e-1 * t611 * t3183 - 0.11434955462216209803e-2 * t617 * t3182;
  t3237 = t573 * t573;
  t3242 = t577 * t577;
  t3248 = my_piecewise5(t14, 0, t10, 0, -t3112);
  t3252 = my_piecewise3(t91, 0, 0.4e2 / 0.81e2 * t2542 * t3237 - 0.16e2 / 0.9e1 * t1262 * t577 + 0.4e1 / 0.3e1 * t475 * t3242 + 0.16e2 / 0.9e1 * t523 * t1480 + 0.4e1 / 0.3e1 * t92 * t3248);
  t3259 = t2572 - t2844 / 0.64e2 + t2857 / 0.288e3 + t2863 / 0.82944e5 + t2873 / 0.288e3 - 0.5e1 / 0.2592e4 * t2753 - 0.3e1 / 0.8e1 * t95 * t27 * (t3181 + t3227) * t137 - 0.9e1 / 0.4e1 * t582 * t644 - 0.3e1 / 0.2e1 * t244 * t1469 - 0.3e1 / 0.8e1 * t5 * t3252 * t138 - 0.3e1 / 0.2e1 * t1485 * t282 - 0.3e1 / 0.2e1 * t2999;
  t3272 = -t3001 / 0.2e1 - 0.3e1 / 0.2e1 * t3003 - t3037 / 0.2e1 + t2883 + t2922 / 0.2e1 + t2926 / 0.2e1 - 0.5e1 / 0.9e1 * t2737 - 0.5e1 / 0.9e1 * t2724 - 0.5e1 / 0.32e2 * t3069 + 0.3e1 / 0.64e2 * t3071 - t3075 / 0.192e3 - t3077 / 0.96e2 - t3080 / 0.27648e5;
  t3281 = t455 * t1367;
  t3286 = t642 * t653;
  t3290 = t280 * t1352;
  t3294 = t928 * t588;
  t3297 = t2421 * t285;
  t3300 = t128 / t1351 / t136;
  t3302 = t657 * t657;
  t3309 = 0.3e1 / 0.64e2 * t3082 + t3084 / 0.3072e4 - t3086 / 0.27648e5 - t3089 / 0.7962624e7 - t3091 / 0.192e3 - 0.15e2 / 0.32e2 * t589 * t1387 - t3281 * t661 / 0.18432e5 - t1373 * t1347 / 0.9216e4 - t651 * t3286 * t660 / 0.18432e5 - t1350 * t3290 * t1359 / 0.2654208e7 - t3294 * t1360 / 0.2654208e7 - t3297 * t3300 * t1354 * t655 / t3302 / t109 / 0.764411904e9;
  t3310 = t1467 * t288;
  t3317 = t199 * t1484 * t27;
  t3352 = -t286 * t3310 * t292 / 0.192e3 - t589 * t1364 / 0.64e2 - t3317 * t293 / 0.192e3 - t1368 * t648 / 0.64e2 - 0.67e2 / 0.12288e5 * t651 * t654 * t656 / t657 / t109 + 0.165e3 / 0.128e3 * t286 * t289 * t3183 + 0.9e1 / 0.128e3 * t286 * t1363 * t614 + 0.9e1 / 0.128e3 * t1368 * t664 + 0.9e1 / 0.64e2 * t589 * t1376 + t1373 * t1382 / 0.1024e4 - 0.15e2 / 0.32e2 * t286 * t647 * t1386 + t651 * t1346 * t1381 / 0.1024e4 + t1350 * t1353 * t1355 / t657 / t1739 / 0.196608e6;
  t3355 = my_piecewise3(t88, 0, t3259 + t3272 + t3309 + t3352);
  tv4rho44 = 0.4e1 * t1343 + 0.4e1 * t1497 + t6 * (t3125 + t3355);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t3362 = 0.5e1 / 0.36e2 * t26 * t972 * t315 * t83;
  t3365 = t26 * t154 * t1616 * t83;
  t3367 = t150 * t1632;
  t3369 = t369 * t674;
  t3371 = t150 * t1626;
  t3375 = t26 * t381 * t706 * t83;
  t3386 = t304 * t986;
  t3394 = 0.1e1 / t36 / t205;
  t3409 = 0.1e1 / t35 / t462;
  t3414 = t32 * t1002;
  t3421 = -0.12332394376798177032e-3 * t1009 * t997 * t1581 - 0.14047856833189446932e-5 * t1584 * t1012 + 0.209e3 / 0.243e3 * t170 * t3386 - 0.40265069320467947261e0 * t1024 * t429 * t1026 * t62 - 0.12201536157717559776e-1 * t2303 * t431 * t3394 * t429 - 0.41801559058847195529e-2 * t1030 * t3386 - 0.80665711264910534075e-1 * t424 * t33 * t1002 - 0.42797350348706002486e-3 * t981 * t956 * t58 * t50 + 0.4171281710400195174e-6 * t981 * t3409 * t49 * t460 - 0.1517269684499314129e0 * t161 * t3414 * t58 - 0.98516106754904741896e-2 * t430 * t62 * t1026;
  t3441 = t956 * t50;
  t3464 = -0.16569987374678167598e-3 * t187 * t3414 - 0.10980899102628513796e-3 * t991 * t993 * t997 * t76 + 0.2085640855200097587e-6 * t2334 * t2337 * t3409 * t460 + 0.21411152009128862875e-8 * t980 * t460 * t3409 * t46 * t48 - 0.4067178719239186592e-2 * t2302 * t2346 * t431 * t3394 + 0.23358399634202103338e-1 * t411 * t3441 + 0.33588425688155967615e-3 * t688 * t956 - 0.24403072315435119552e-1 * t2258 * t986 * sigma[0] * t61 - 0.97160380515158346364e-2 * t1603 * t1039 - 0.15816806130374614524e-2 * t180 * t309 * t1046 + 0.12359353216000578294e-5 * t2277 * t997 * t58 * t76 * t33 + 0.69128983273778274541e-2 * t397 * t986 * t58 * sigma[0];
  t3473 = 0.5e1 / 0.27648e5 * t2491 * t321;
  t3474 = t948 * t729;
  t3476 = t391 * t1506;
  t3484 = -t3362 - 0.3e1 / 0.8e1 * t3365 + t3367 / 0.4e1 - 0.3e1 / 0.8e1 * t3369 - 0.3e1 / 0.4e1 * t3371 + t3375 / 0.4e1 - 0.9e1 / 0.8e1 * t369 * t708 - 0.9e1 / 0.8e1 * t150 * t1618 - 0.3e1 / 0.8e1 * t26 * t27 * (t3421 + t3464) * t83 - 0.3e1 / 0.8e1 * t1083 * t317 + t3473 + t3474 / 0.384e3 + 0.9e1 / 0.256e3 * t3476 - 0.45e2 / 0.128e3 * t201 * t204 * t3441 - 0.15e2 / 0.128e3 * t201 * t711 * t957;
  t3485 = t2440 * t321;
  t3487 = t914 * t729;
  t3489 = t391 * t1509;
  t3510 = t914 * t719;
  t3514 = t2485 * t726;
  t3518 = t948 * t719;
  t3520 = t391 * t1520;
  t3522 = -t3485 / 0.3072e4 - t3487 / 0.128e3 + 0.3e1 / 0.256e3 * t3489 + 0.9e1 / 0.256e3 * t201 * t1554 * t414 + 0.29e2 / 0.16384e5 * t456 * t459 * t722 * t904 - 0.3e1 / 0.256e3 * t201 * t917 * t685 - 0.25e2 / 0.98304e5 * t456 * t921 * t1501 - 0.17e2 / 0.9437184e7 * t929 * t932 * t933 * t937 + 0.9e1 / 0.256e3 * t377 * t1509 + t3510 / 0.1024e4 - 0.3e1 / 0.128e3 * t377 * t1520 + t3514 / 0.147456e6 - 0.25e2 / 0.98304e5 * t944 * t1502 - t3518 / 0.3072e4 - t3520 / 0.128e3;
  t3524 = t2445 * t726;
  t3526 = t953 * t1502;
  t3528 = t953 * t1524;
  t3533 = t2513 * t321;
  t3554 = t391 * t1538;
  t3556 = t953 * t1541;
  t3558 = t2509 * t1547;
  t3563 = -t3524 / 0.442368e6 - 0.25e2 / 0.294912e6 * t3526 - t3528 / 0.110592e6 + t456 * t1523 * t905 / 0.4096e4 + t3533 / 0.2048e4 - 0.3e1 / 0.256e3 * t910 * t729 + 0.27e2 / 0.256e3 * t377 * t1506 + 0.27e2 / 0.256e3 * t201 * t448 * t1505 + t929 * t2462 * t1546 / 0.9437184e7 + t2422 * t2425 * t933 * t76 / t2427 / t163 / 0.2038431744e10 + t2533 * t1547 / 0.9437184e7 + t3554 / 0.2048e4 + t3556 / 0.147456e6 + t3558 / 0.28311552e8 + t201 * t2450 * t320 / 0.2048e4;
  t3567 = t391 * t1555;
  t3571 = t706 * t458;
  t3575 = t315 * t931;
  t3589 = t948 * t712;
  t3591 = t1616 * t203;
  t3599 = t914 * t712;
  t3601 = t456 * t2454 * t725 / 0.98304e5 - t3567 / 0.384e3 - t944 * t1524 / 0.36864e5 - t456 * t3571 * t465 / 0.36864e5 - t929 * t3575 * t938 / 0.10616832e8 + t2530 * t321 / 0.2048e4 + 0.3e1 / 0.2048e4 * t910 * t719 + t2436 * t726 / 0.98304e5 + 0.3e1 / 0.2048e4 * t377 * t1538 + t944 * t1541 / 0.49152e5 + t3589 / 0.1152e4 - t201 * t3591 * t207 / 0.256e3 - t910 * t712 / 0.256e3 - t377 * t1555 / 0.128e3 - t3599 / 0.384e3;
  t3604 = my_piecewise3(t1, 0, t3484 + t3522 + t3563 + t3601);
  tv4rho3sigma0 = t6 * t3604 + 0.3e1 * t1637;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t3609 = t485 * t738;
  t3611 = t218 * t1645;
  t3616 = 0.5e1 / 0.36e2 * t95 * t972 * t341 * t137;
  t3619 = t2744 * t347;
  t3621 = t2748 * t347;
  t3624 = 0.5e1 / 0.27648e5 * t2752 * t347;
  t3626 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t1109 * t343 - 0.3e1 / 0.8e1 * t3609 + t3611 / 0.4e1 - t3616 + t2740 * t347 / 0.2048e4 + t3619 / 0.2048e4 - t3621 / 0.3072e4 + t3624);
  tv4rho3sigma2 = t6 * t3626 + 0.3e1 * t1655;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t3628 = 0.2e1 * t1683;
  t3636 = t234 * t1626 / 0.4e1;
  t3638 = t507 * t674 / 0.4e1;
  t3639 = t234 * t1632;
  t3646 = -0.3e1 / 0.8e1 * t234 * t1618 - 0.3e1 / 0.8e1 * t1167 * t317 - 0.3e1 / 0.4e1 * t507 * t708 - t3636 - t3638 + t3639 / 0.12e2 - t3362 - t3365 / 0.8e1 + t3367 / 0.6e1 - t3369 / 0.8e1 - t3371 / 0.4e1 + t3375 / 0.6e1 + t3473;
  t3660 = t3474 / 0.576e3 + 0.3e1 / 0.256e3 * t3476 - t3485 / 0.4608e4 - t3487 / 0.384e3 + t3489 / 0.256e3 + t3510 / 0.3072e4 + t3514 / 0.442368e6 - t3518 / 0.4608e4 - t3520 / 0.384e3 - t3524 / 0.663552e6 - 0.25e2 / 0.884736e6 * t3526 - t3528 / 0.331776e6 + t3533 / 0.6144e4;
  t3669 = t1135 * t719 / 0.3072e4;
  t3671 = t2639 * t726 / 0.442368e6;
  t3682 = t3554 / 0.6144e4 + t3556 / 0.442368e6 + t3558 / 0.84934656e8 - t3567 / 0.1152e4 + t3589 / 0.1728e4 - t3599 / 0.1152e4 + t3669 + t3671 + t515 * t1538 / 0.2048e4 + t1140 * t1541 / 0.147456e6 + t2648 * t1547 / 0.28311552e8 + t2660 * t321 / 0.2048e4 + t1131 * t719 / 0.1024e4;
  t3688 = t1135 * t712 / 0.1152e4;
  t3698 = t2652 * t321 / 0.3072e4;
  t3701 = t2656 * t321;
  t3704 = t1135 * t729 / 0.384e3;
  t3709 = t2665 * t726 / 0.147456e6 - t1131 * t712 / 0.384e3 - t3688 - t515 * t1555 / 0.384e3 - t1140 * t1524 / 0.110592e6 - 0.25e2 / 0.294912e6 * t1140 * t1502 + 0.9e1 / 0.256e3 * t515 * t1506 + t3698 - t1131 * t729 / 0.128e3 - t3701 / 0.9216e4 - t3704 - t515 * t1520 / 0.128e3 + 0.3e1 / 0.256e3 * t515 * t1509;
  t3712 = my_piecewise3(t1, 0, t3646 + t3660 + t3682 + t3709);
  tv4rho3sigma3 = t6 * t3712 + t1637 + t3628;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t3714 = 0.2e1 * t1718;
  t3720 = t531 * t738 / 0.4e1;
  t3721 = t244 * t1645;
  t3724 = t218 * t1693 / 0.4e1;
  t3727 = t95 * t381 * t786 * t137;
  t3734 = t1220 * t807 / 0.384e3;
  t3735 = -0.3e1 / 0.8e1 * t1198 * t343 - 0.3e1 / 0.8e1 * t485 * t788 - t3720 + t3721 / 0.12e2 - t3724 + t3727 / 0.12e2 - t3609 / 0.8e1 + t3611 / 0.6e1 - t3616 + t3619 / 0.6144e4 - t3621 / 0.4608e4 + t3624 - t3734;
  t3736 = t1224 * t807;
  t3739 = t1220 * t797 / 0.3072e4;
  t3740 = t1224 * t797;
  t3743 = t2859 * t804 / 0.442368e6;
  t3744 = t2862 * t804;
  t3746 = t1224 * t792;
  t3749 = t2868 * t347 / 0.3072e4;
  t3750 = t2872 * t347;
  t3753 = t1220 * t792 / 0.1152e4;
  t3764 = t3736 / 0.1152e4 + t3739 - t3740 / 0.9216e4 + t3743 - t3744 / 0.1327104e7 + t3746 / 0.3456e4 + t3749 - t3750 / 0.9216e4 - t3753 + t2848 * t804 / 0.294912e6 - t1216 * t807 / 0.256e3 - t1216 * t792 / 0.768e3 + t2854 * t347 / 0.2048e4 + t1216 * t797 / 0.2048e4;
  t3766 = my_piecewise3(t88, 0, t3735 + t3764);
  tv4rho3sigma5 = t6 * t3766 + t1655 + t3714;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t3768 = t567 * t674;
  t3780 = -t3768 / 0.8e1 - 0.3e1 / 0.8e1 * t1245 * t317 - 0.3e1 / 0.8e1 * t567 * t708 - t3636 - t3638 + t3639 / 0.6e1 - t3362 + t3367 / 0.12e2 + t3375 / 0.12e2 + t3473 + t3474 / 0.1152e4 - t3485 / 0.9216e4 - t3518 / 0.9216e4;
  t3784 = t2784 * t321;
  t3796 = -t3524 / 0.1327104e7 + t3589 / 0.3456e4 + t3669 + t3671 - t3688 + t3698 - t3701 / 0.4608e4 - t3704 + t3784 / 0.6144e4 - t1253 * t729 / 0.256e3 - t1253 * t712 / 0.768e3 + t2780 * t321 / 0.2048e4 + t1253 * t719 / 0.2048e4 + t2776 * t726 / 0.294912e6;
  t3798 = my_piecewise3(t1, 0, t3780 + t3796);
  tv4rho3sigma6 = t6 * t3798 + t1728 + t3628;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t3804 = t95 * t154 * t1790 * t137;
  t3806 = t582 * t738;
  t3808 = t244 * t1693;
  t3818 = -0.3e1 / 0.4e1 * t531 * t788 - t3804 / 0.8e1 - t3806 / 0.8e1 - t3808 / 0.4e1 - 0.3e1 / 0.8e1 * t218 * t1792 - 0.3e1 / 0.8e1 * t1276 * t343 - t3720 + t3721 / 0.6e1 - t3724 + t3727 / 0.6e1 + t3611 / 0.12e2 - t3616 - t3621 / 0.9216e4;
  t3824 = t3079 * t804;
  t3826 = t548 * t1843;
  t3828 = t3624 - t3734 + t3736 / 0.576e3 + t3739 - t3740 / 0.4608e4 + t3743 - t3744 / 0.663552e6 + t3746 / 0.1728e4 + t3749 - t3750 / 0.4608e4 - t3753 + t3824 / 0.442368e6 + t3826 / 0.6144e4;
  t3830 = t1291 * t792;
  t3832 = t548 * t1830;
  t3834 = t1311 * t1834;
  t3836 = t3074 * t347;
  t3838 = t1291 * t797;
  t3840 = t1311 * t1820;
  t3842 = t3088 * t1826;
  t3844 = t548 * t1809;
  t3846 = t1311 * t1813;
  t3848 = t548 * t1817;
  t3850 = t548 * t1804;
  t3852 = t1291 * t807;
  t3856 = -t3830 / 0.1152e4 - t3832 / 0.1152e4 - t3834 / 0.331776e6 + t3836 / 0.6144e4 + t3838 / 0.3072e4 + t3840 / 0.442368e6 + t3842 / 0.84934656e8 - t3844 / 0.384e3 - 0.25e2 / 0.884736e6 * t3846 + t3848 / 0.256e3 + 0.3e1 / 0.256e3 * t3850 - t3852 / 0.384e3 + t544 * t1843 / 0.2048e4;
  t3883 = -t1287 * t792 / 0.384e3 + t1308 * t1820 / 0.147456e6 + t3060 * t1826 / 0.28311552e8 - t544 * t1830 / 0.384e3 - t1308 * t1834 / 0.110592e6 + t3066 * t347 / 0.2048e4 + t1287 * t797 / 0.1024e4 + t2994 * t804 / 0.147456e6 + 0.9e1 / 0.256e3 * t544 * t1804 - t1287 * t807 / 0.128e3 - t544 * t1809 / 0.128e3 - 0.25e2 / 0.294912e6 * t1308 * t1813 + 0.3e1 / 0.256e3 * t544 * t1817;
  t3886 = my_piecewise3(t88, 0, t3818 + t3828 + t3856 + t3883);
  tv4rho3sigma8 = t6 * t3886 + t1852 + t3714;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t3898 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t1337 * t317 - 0.3e1 / 0.8e1 * t3768 + t3639 / 0.4e1 - t3362 + t2970 * t321 / 0.2048e4 + t3784 / 0.2048e4 - t3701 / 0.3072e4 + t3473);
  tv4rho3sigma9 = t6 * t3898 + 0.3e1 * t1728;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t3901 = t1385 * t108;
  t3927 = t32 * t1417;
  t3935 = 0.1e1 / t97 / t657;
  t3940 = 0.23358399634202103338e-1 * t611 * t3901 + 0.33588425688155967615e-3 * t768 * t1385 - 0.15816806130374614524e-2 * t268 * t335 * t1461 + 0.12359353216000578294e-5 * t3214 * t1412 * t116 * t130 * t33 + 0.69128983273778274541e-2 * t597 * t1403 * t116 * sigma[2] - 0.24403072315435119552e-1 * t3201 * t1403 * sigma[2] * t61 - 0.97160380515158346364e-2 * t1777 * t1454 - 0.98516106754904741896e-2 * t629 * t118 * t1441 - 0.16569987374678167598e-3 * t275 * t3927 - 0.10980899102628513796e-3 * t1408 * t993 * t1412 * t130 + 0.2085640855200097587e-6 * t3152 * t2337 * t3935 * t655;
  t3948 = 0.1e1 / t98 / t290;
  t3957 = t330 * t1403;
  t3984 = 0.21411152009128862875e-8 * t1397 * t655 * t3935 * t46 * t48 - 0.4067178719239186592e-2 * t3138 * t2346 * t630 * t3948 - 0.12332394376798177032e-3 * t1424 * t1412 * t1755 - 0.14047856833189446932e-5 * t1758 * t1427 + 0.209e3 / 0.243e3 * t258 * t3957 - 0.40265069320467947261e0 * t1439 * t429 * t1441 * t118 - 0.12201536157717559776e-1 * t3174 * t630 * t3948 * t429 - 0.41801559058847195529e-2 * t1445 * t3957 - 0.80665711264910534075e-1 * t624 * t33 * t1417 - 0.42797350348706002486e-3 * t1398 * t1385 * t116 * t108 + 0.4171281710400195174e-6 * t1398 * t3935 * t49 * t655 - 0.1517269684499314129e0 * t249 * t3927 * t116;
  t4005 = -0.3e1 / 0.8e1 * t95 * t27 * (t3940 + t3984) * t137 - 0.3e1 / 0.8e1 * t1485 * t343 - 0.9e1 / 0.8e1 * t582 * t788 - 0.9e1 / 0.8e1 * t244 * t1792 - 0.3e1 / 0.8e1 * t3804 - 0.3e1 / 0.8e1 * t3806 - 0.3e1 / 0.4e1 * t3808 + t3721 / 0.4e1 + t3727 / 0.4e1 - t3616 + t3624 + t3736 / 0.384e3 - t3740 / 0.3072e4 - t3744 / 0.442368e6 + t3746 / 0.1152e4;
  t4021 = -t3750 / 0.3072e4 + t3824 / 0.147456e6 + t3826 / 0.2048e4 - t3830 / 0.384e3 - t3832 / 0.384e3 - t3834 / 0.110592e6 + t3836 / 0.2048e4 + t3838 / 0.1024e4 + t3840 / 0.147456e6 + t3842 / 0.28311552e8 - t3844 / 0.128e3 - 0.25e2 / 0.294912e6 * t3846 + 0.3e1 / 0.256e3 * t3848 + 0.9e1 / 0.256e3 * t3850 - t3852 / 0.128e3;
  t4031 = t786 * t653;
  t4037 = t341 * t1352;
  t4062 = -0.15e2 / 0.128e3 * t286 * t791 * t1386 - 0.45e2 / 0.128e3 * t286 * t289 * t3901 - t1368 * t792 / 0.256e3 - t651 * t4031 * t660 / 0.36864e5 - t1373 * t1834 / 0.36864e5 - t1350 * t4037 * t1359 / 0.10616832e8 + t3317 * t347 / 0.2048e4 + 0.3e1 / 0.2048e4 * t1368 * t797 + t3281 * t804 / 0.98304e5 + 0.3e1 / 0.2048e4 * t589 * t1843 + t286 * t3310 * t346 / 0.2048e4 + t1373 * t1820 / 0.49152e5 + t651 * t3286 * t803 / 0.98304e5 + t1350 * t3290 * t1825 / 0.9437184e7 + t3294 * t1826 / 0.9437184e7;
  t4072 = t1790 * t288;
  t4109 = t3297 * t3300 * t1354 * t130 / t3302 / t251 / 0.2038431744e10 - t589 * t1830 / 0.128e3 - t286 * t4072 * t292 / 0.256e3 - 0.3e1 / 0.256e3 * t286 * t1363 * t765 - 0.25e2 / 0.98304e5 * t651 * t1346 * t1812 - 0.17e2 / 0.9437184e7 * t1350 * t1353 * t1354 * t1358 + 0.9e1 / 0.256e3 * t589 * t1817 + 0.9e1 / 0.256e3 * t286 * t1829 * t614 + t651 * t1833 * t1381 / 0.4096e4 + 0.27e2 / 0.256e3 * t589 * t1804 + 0.27e2 / 0.256e3 * t286 * t647 * t1750 + 0.29e2 / 0.16384e5 * t651 * t654 * t800 * t1380 - 0.3e1 / 0.256e3 * t1368 * t807 - 0.3e1 / 0.128e3 * t589 * t1809 - 0.25e2 / 0.98304e5 * t1373 * t1813;
  t4112 = my_piecewise3(t88, 0, t4005 + t4021 + t4062 + t4109);
  tv4rho3sigma11 = t6 * t4112 + 0.3e1 * t1852;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t4120 = t26 * t381 * t839 * t83 / 0.12e2;
  t4121 = t150 * t1857;
  t4125 = t26 * t154 * t1909 * t83;
  t4127 = t48 * t400;
  t4131 = 0.1e1 / t36 / t78;
  t4162 = 0.1e1 / t35 / t78 / t398;
  t4164 = t49 * t76;
  t4190 = t413 * sigma[0];
  t4198 = -0.15642306414000731902e-6 * t981 * t4162 * t4164 - 0.78387041129197113882e-4 * t160 * t413 * sigma[0] + 0.3737729117625474888e-4 * t1579 * t1876 + 0.3558781379334288268e-2 * t425 * t826 * t406 - 0.23725209195561921787e-3 * t180 * t835 * t437 - 0.463475745600021686e-6 * t2277 * t1568 * t58 * t50 * t33 + 0.32309183898118511745e-4 * t991 * t1569 * t50 - 0.78211532070003659514e-7 * t2334 * t2337 * t4162 * t76 - 0.49877777777777777777e-2 * t411 * t4190 - 0.80291820034233235782e-9 * t980 * t4162 * t4164 - 0.19e2 / 0.162e3 * t170 * t4127;
  t4223 = t914 * t852;
  t4225 = -0.3e1 / 0.4e1 * t150 * t1911 + t4120 - t4121 / 0.4e1 - t4125 / 0.4e1 - 0.3e1 / 0.8e1 * t26 * t27 * (0.97442823481772178766e-3 * t1030 * t4127 + 0.1525192019714694972e-2 * t2302 * t2346 * t4131 * t62 + 0.12032070377749260335e-2 * t430 * t432 * t308 - 0.11555284594150620671e-2 * t396 * t4127 * t58 + 0.43574370732578377058e-6 * t395 * t1568 * t1876 + 0.86935945123737613404e-1 * t1024 * t1890 * t432 + 0.91511521182881698319e-2 * t2258 * t1605 + 0.4575576059144084916e-2 * t2303 * t62 * t4131 * t429 + 0.24572538095403418994e-2 * t1036 * t1605 + 0.12107145164436566493e-3 * t981 * t1558 * sigma[0] + t4198) * t83 - 0.3e1 / 0.8e1 * t369 * t841 - t201 * t448 * t1879 / 0.64e2 + 0.9e1 / 0.128e3 * t201 * t204 * t4190 + t456 * t921 * t1945 / 0.18432e5 + 0.139e3 / 0.226492416e9 * t929 * t932 * t1938 * t1545 - 0.19e2 / 0.36864e5 * t456 * t459 * t460 * t464 + t4223 / 0.1536e4;
  t4229 = t948 * t852 / 0.4608e4;
  t4230 = t391 * t1956;
  t4238 = t2485 * t849;
  t4243 = t2445 * t849 / 0.3538944e7;
  t4244 = t953 * t1946;
  t4247 = t948 * t844 / 0.4608e4;
  t4248 = t391 * t1928;
  t4256 = -t377 * t1956 / 0.64e2 - t4229 - t4230 / 0.192e3 - 0.25e2 / 0.147456e6 * t456 * t1523 * t1501 + 0.9e1 / 0.128e3 * t201 * t711 * t1505 - t4238 / 0.1179648e7 + t944 * t1946 / 0.18432e5 + t4243 + t4244 / 0.55296e5 - t4247 - t4248 / 0.192e3 - t201 * t1554 * t685 / 0.64e2 + 0.3e1 / 0.256e3 * t201 * t1914 * t414;
  t4258 = t914 * t844;
  t4276 = t391 * t1953;
  t4293 = t4258 / 0.1536e4 - t377 * t1928 / 0.64e2 - t929 * t2462 * t1941 / 0.37748736e8 - t2422 * t2425 * t933 * t50 / t2427 / t34 / 0.5435817984e10 + t910 * t852 / 0.1024e4 + t377 * t1953 / 0.512e3 + t4276 / 0.1536e4 + t201 * t917 * t817 / 0.1024e4 + t456 * t3571 * t725 / 0.73728e5 + t929 * t3575 * t1546 / 0.14155776e8 - t2436 * t849 / 0.786432e6 - t944 * t1935 / 0.393216e6 - t2533 * t1942 / 0.37748736e8;
  t4294 = t953 * t1935;
  t4296 = t2509 * t1942;
  t4301 = t839 * t458;
  t4311 = t391 * t1922;
  t4313 = t953 * t1925;
  t4320 = t391 * t1915;
  t4322 = t1909 * t203;
  t4326 = -t4294 / 0.1179648e7 - t4296 / 0.113246208e9 - t456 * t2454 * t848 / 0.786432e6 - t456 * t4301 * t465 / 0.110592e6 + t910 * t844 / 0.1024e4 + t377 * t1922 / 0.512e3 + t944 * t1925 / 0.73728e5 + t4311 / 0.1536e4 + t4313 / 0.221184e6 + t201 * t3591 * t320 / 0.1024e4 - t377 * t1915 / 0.384e3 - t4320 / 0.1152e4 - t201 * t4322 * t207 / 0.384e3;
  t4329 = my_piecewise3(t1, 0, t4225 + t4256 + t4293 + t4326);
  tv4rho2sigma20 = t6 * t4329 + 0.2e1 * t1960;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t4334 = t218 * t1965;
  t4339 = t95 * t381 * t883 * t137 / 0.12e2;
  t4342 = t1220 * t888;
  t4345 = t1224 * t888 / 0.4608e4;
  t4348 = t2859 * t893;
  t4351 = t2862 * t893 / 0.3538944e7;
  t4354 = t1220 * t896;
  t4357 = t1224 * t896 / 0.4608e4;
  t4358 = -0.3e1 / 0.8e1 * t485 * t885 - t4334 / 0.4e1 + t4339 + t1216 * t888 / 0.1024e4 + t4342 / 0.1536e4 - t4345 - t2848 * t893 / 0.786432e6 - t4348 / 0.1179648e7 + t4351 + t1216 * t896 / 0.1024e4 + t4354 / 0.1536e4 - t4357;
  t4359 = my_piecewise3(t88, 0, t4358);
  tv4rho2sigma25 = t6 * t4359 + 0.2e1 * t1981;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t4365 = t234 * t1857;
  t4378 = -0.3e1 / 0.8e1 * t507 * t841 - 0.3e1 / 0.8e1 * t234 * t1911 - t4365 / 0.8e1 + t4120 - t4121 / 0.8e1 - t4125 / 0.8e1 + t4223 / 0.3072e4 - t4229 - t4230 / 0.384e3 - t4238 / 0.2359296e7 + t4243 + t4244 / 0.110592e6 - t4247 - t4248 / 0.384e3 + t4258 / 0.3072e4 + t4276 / 0.3072e4 - t4294 / 0.2359296e7 - t4296 / 0.226492416e9;
  t4382 = t2639 * t849;
  t4386 = t1135 * t852;
  t4390 = t1135 * t844;
  t4412 = t4311 / 0.3072e4 + t4313 / 0.442368e6 - t4320 / 0.2304e4 - t4382 / 0.2359296e7 + t1140 * t1946 / 0.36864e5 + t4386 / 0.3072e4 - t515 * t1956 / 0.128e3 + t4390 / 0.3072e4 - t515 * t1928 / 0.128e3 - t2665 * t849 / 0.786432e6 - t1140 * t1935 / 0.786432e6 - t2648 * t1942 / 0.75497472e8 + t1131 * t852 / 0.1024e4 + t515 * t1953 / 0.1024e4 - t515 * t1915 / 0.768e3 + t1131 * t844 / 0.1024e4 + t515 * t1922 / 0.1024e4 + t1140 * t1925 / 0.147456e6;
  t4414 = my_piecewise3(t1, 0, t4378 + t4412);
  tv4rho2sigma26 = t6 * t4414 + t1960 + t1992;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t4416 = t244 * t1965;
  t4420 = t95 * t154 * t2045 * t137;
  t4430 = t1311 * t2078;
  t4432 = t1291 * t896;
  t4434 = t548 * t2083;
  t4436 = t548 * t2086;
  t4438 = t3079 * t893;
  t4440 = t1311 * t2067;
  t4442 = -t4416 / 0.8e1 - t4420 / 0.8e1 - 0.3e1 / 0.8e1 * t531 * t885 - 0.3e1 / 0.8e1 * t218 * t2047 - t4334 / 0.8e1 + t4339 + t4342 / 0.3072e4 - t4345 - t4348 / 0.2359296e7 + t4351 + t4354 / 0.3072e4 - t4357 + t4430 / 0.110592e6 + t4432 / 0.3072e4 + t4434 / 0.3072e4 - t4436 / 0.384e3 - t4438 / 0.2359296e7 - t4440 / 0.2359296e7;
  t4443 = t3088 * t2074;
  t4445 = t1291 * t888;
  t4447 = t548 * t2056;
  t4449 = t1311 * t2059;
  t4451 = t548 * t2062;
  t4453 = t548 * t2051;
  t4479 = -t4443 / 0.226492416e9 + t4445 / 0.3072e4 + t4447 / 0.3072e4 + t4449 / 0.442368e6 - t4451 / 0.384e3 - t4453 / 0.2304e4 - t1308 * t2067 / 0.786432e6 - t3060 * t2074 / 0.75497472e8 + t1308 * t2078 / 0.36864e5 + t1287 * t896 / 0.1024e4 + t544 * t2083 / 0.1024e4 - t544 * t2086 / 0.128e3 - t544 * t2051 / 0.768e3 + t1287 * t888 / 0.1024e4 + t544 * t2056 / 0.1024e4 + t1308 * t2059 / 0.147456e6 - t544 * t2062 / 0.128e3 - t2994 * t893 / 0.786432e6;
  t4481 = my_piecewise3(t88, 0, t4442 + t4479);
  tv4rho2sigma211 = t6 * t4481 + t1981 + t2090;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t4496 = -0.3e1 / 0.8e1 * t567 * t841 - t4365 / 0.4e1 + t4120 + t1253 * t844 / 0.1024e4 + t4390 / 0.1536e4 - t4247 - t2776 * t849 / 0.786432e6 - t4382 / 0.1179648e7 + t4243 + t1253 * t852 / 0.1024e4 + t4386 / 0.1536e4 - t4229;
  t4497 = my_piecewise3(t1, 0, t4496);
  tv4rho2sigma212 = t6 * t4497 + 0.2e1 * t1992;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t4513 = 0.1e1 / t97 / t132 / t598;
  t4518 = t613 * sigma[2];
  t4523 = t130 * t46 * t48;
  t4526 = t48 * t600;
  t4532 = 0.1e1 / t98 / t132;
  t4574 = 0.4575576059144084916e-2 * t3174 * t118 * t4532 * t429 + 0.24572538095403418994e-2 * t1451 * t1779 + 0.12107145164436566493e-3 * t1398 * t1731 * sigma[2] - 0.15642306414000731902e-6 * t1398 * t4513 * t4523 - 0.11555284594150620671e-2 * t596 * t4526 * t116 + 0.43574370732578377058e-6 * t595 * t1741 * t2012 + 0.86935945123737613404e-1 * t1439 * t2026 * t631 - 0.23725209195561921787e-3 * t268 * t879 * t636 - 0.463475745600021686e-6 * t3214 * t1741 * t116 * t108 * t33 + 0.3737729117625474888e-4 * t1753 * t2012 + 0.3558781379334288268e-2 * t625 * t870 * t606;
  t4588 = -0.3e1 / 0.4e1 * t244 * t2047 - 0.3e1 / 0.8e1 * t95 * t27 * (-0.78387041129197113882e-4 * t248 * t613 * sigma[2] + 0.12032070377749260335e-2 * t629 * t631 * t334 + 0.32309183898118511745e-4 * t1408 * t1742 * t108 - 0.78211532070003659514e-7 * t3152 * t2337 * t4513 * t130 - 0.49877777777777777777e-2 * t611 * t4518 - 0.80291820034233235782e-9 * t1397 * t4513 * t4523 - 0.19e2 / 0.162e3 * t258 * t4526 + 0.97442823481772178766e-3 * t1445 * t4526 + 0.1525192019714694972e-2 * t3138 * t2346 * t4532 * t118 + 0.91511521182881698319e-2 * t3201 * t1779 + t4574) * t137 - 0.3e1 / 0.8e1 * t582 * t885 - t4416 / 0.4e1 - t4420 / 0.4e1 + t4339 - t589 * t2051 / 0.384e3 - t4345 + t4351 - t4357 + t4430 / 0.55296e5 + t4432 / 0.1536e4;
  t4607 = t4434 / 0.1536e4 - t4436 / 0.192e3 - t4438 / 0.1179648e7 - t4440 / 0.1179648e7 - t4443 / 0.113246208e9 + t4445 / 0.1536e4 + t4447 / 0.1536e4 + t4449 / 0.221184e6 - t4451 / 0.192e3 - t4453 / 0.1152e4 - t589 * t2086 / 0.64e2 - t286 * t647 * t2015 / 0.64e2 + 0.9e1 / 0.128e3 * t286 * t289 * t4518;
  t4651 = t1373 * t2078 / 0.18432e5 + t651 * t1346 * t2077 / 0.18432e5 + 0.139e3 / 0.226492416e9 * t1350 * t1353 * t2070 * t1824 - 0.19e2 / 0.36864e5 * t651 * t654 * t655 * t659 - t286 * t1829 * t765 / 0.64e2 - 0.25e2 / 0.147456e6 * t651 * t1833 * t1812 + 0.9e1 / 0.128e3 * t286 * t791 * t1750 - t651 * t3286 * t892 / 0.786432e6 - t1350 * t3290 * t2073 / 0.37748736e8 - t3297 * t3300 * t1354 * t108 / t3302 / t96 / 0.5435817984e10 + t1368 * t896 / 0.1024e4 + t589 * t2083 / 0.512e3 + t286 * t1363 * t861 / 0.1024e4;
  t4664 = t2045 * t288;
  t4668 = t883 * t653;
  t4686 = t651 * t4031 * t803 / 0.73728e5 + t1350 * t4037 * t1825 / 0.14155776e8 - t3281 * t893 / 0.786432e6 - t1373 * t2067 / 0.393216e6 - t3294 * t2074 / 0.37748736e8 - t286 * t4664 * t292 / 0.384e3 - t651 * t4668 * t660 / 0.110592e6 + t1368 * t888 / 0.1024e4 + t589 * t2056 / 0.512e3 + t1373 * t2059 / 0.73728e5 + t286 * t4072 * t346 / 0.1024e4 + 0.3e1 / 0.256e3 * t286 * t2050 * t614 - t589 * t2062 / 0.64e2;
  t4689 = my_piecewise3(t88, 0, t4588 + t4607 + t4651 + t4686);
  tv4rho2sigma217 = t6 * t4689 + 0.2e1 * t2090;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t4695 = t58 * t28;
  t4712 = 0.1e1 / t35 / t2279;
  t4719 = t50 * t46 * t48;
  t4723 = 0.1e1 / t36 / t398;
  t4751 = -0.1525192019714694972e-3 * t180 * t2134 * t183 + 0.17380340460000813225e-6 * t2277 * t1869 * t4695 * t188 - 0.95027011465054446308e-5 * t1874 * t2103 - 0.3431682044358063687e-2 * t2258 * t825 * t174 * t61 + 0.2287788029572042458e-2 * t425 * t2120 * t165 - 0.31774833744056145251e-3 * t1036 * t174 * t2126 + 0.29329324526251372317e-7 * t2334 * t2337 * t4712 * t50 + 0.30109432512837463418e-9 * t980 * t4712 * t4719 - 0.5719470073930106145e-3 * t2302 * t2346 * t4723 * t308 + 0.1525192019714694972e-3 * t430 * t697 * t834 - 0.25340536390681185682e-4 * t981 * t1860 - 0.76021609172043557047e-5 * t991 * t1870 * sigma[0] - 0.11706547360991205777e-6 * t1882 * t2103 - 0.17158410221790318435e-2 * t2303 * t308 * t4723 * t429 - 0.635496674881122905e-4 * t1030 * t1864 * t825 + 0.58658649052502744635e-7 * t981 * t4712 * t4719 + 0.55419753086419753086e-3 * t411 * t206 + 0.11378764034883452015e-4 * t1885;
  t4761 = t26 * t154 * t2138 * t83 / 0.8e1;
  t4764 = t2162 * t155 * t2163 / 0.3072e4;
  t4795 = t391 * t2149 / 0.1024e4;
  t4796 = -0.3e1 / 0.8e1 * t26 * t27 * t4751 * t83 - 0.3e1 / 0.8e1 * t150 * t2140 - t4761 + t4764 - t2162 * t73 * t203 * t206 / 0.128e3 + t199 * t149 * t2164 / 0.1024e4 + t2162 * t193 * t2163 / 0.1024e4 + t456 * t4301 * t725 / 0.98304e5 - t944 * t2146 / 0.262144e6 - t456 * t3571 * t848 / 0.262144e6 - t929 * t3575 * t1941 / 0.25165824e8 + 0.3e1 / 0.1024e4 * t377 * t2149 + 0.3e1 / 0.1024e4 * t201 * t1554 * t817 + t456 * t1523 * t1945 / 0.12288e5 + t4795;
  t4801 = t2509 * t2155 / 0.603979776e9;
  t4807 = t953 * t2159 / 0.393216e6;
  t4813 = t391 * t2143 / 0.2048e4;
  t4818 = t953 * t2146 / 0.786432e6;
  t4835 = t2138 * t203;
  t4844 = -0.3e1 / 0.128e3 * t201 * t711 * t1879 + t4801 - 0.5e1 / 0.25165824e8 * t929 * t932 * t461 * t1940 - t4807 + 0.19e2 / 0.147456e6 * t456 * t459 * t76 * t724 + t4813 - 0.3e1 / 0.256e3 * t201 * t1914 * t685 - t4818 + t2533 * t2155 / 0.201326592e9 + t929 * t2462 * t2154 / 0.201326592e9 + t2422 * t2425 * t934 / t2427 / rho[0] / 0.14495514624e11 - t944 * t2159 / 0.131072e6 - t456 * t921 * t2158 / 0.131072e6 - t201 * t4835 * t207 / 0.768e3 + 0.3e1 / 0.2048e4 * t377 * t2143 + 0.3e1 / 0.2048e4 * t201 * t4322 * t320;
  t4846 = my_piecewise3(t1, 0, t4796 + t4844);
  tv4rhosigma30 = t6 * t4846 + t2168;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t4853 = t95 * t154 * t2215 * t137 / 0.8e1;
  t4857 = t548 * t2220 / 0.2048e4;
  t4861 = t1311 * t2223 / 0.786432e6;
  t4865 = t548 * t2226 / 0.1024e4;
  t4869 = t3088 * t2232 / 0.603979776e9;
  t4873 = t1311 * t2236 / 0.393216e6;
  t4879 = t2239 * t221 * t2240 / 0.3072e4;
  t4880 = -0.3e1 / 0.8e1 * t218 * t2217 - t4853 + 0.3e1 / 0.2048e4 * t544 * t2220 + t4857 - t1308 * t2223 / 0.262144e6 - t4861 + 0.3e1 / 0.1024e4 * t544 * t2226 + t4865 + t3060 * t2232 / 0.201326592e9 + t4869 - t1308 * t2236 / 0.131072e6 - t4873 + t199 * t217 * t2241 / 0.1024e4 + t4879;
  t4881 = my_piecewise3(t88, 0, t4880);
  tv4rhosigma39 = t6 * t4881 + t2245;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t4898 = -0.3e1 / 0.8e1 * t234 * t2140 - t4761 + 0.3e1 / 0.2048e4 * t515 * t2143 + t4813 - t1140 * t2146 / 0.262144e6 - t4818 + 0.3e1 / 0.1024e4 * t515 * t2149 + t4795 + t2648 * t2155 / 0.201326592e9 + t4801 - t1140 * t2159 / 0.131072e6 - t4807 + t199 * t233 * t2164 / 0.1024e4 + t4764;
  t4899 = my_piecewise3(t1, 0, t4898);
  tv4rhosigma310 = t6 * t4899 + t2168;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t4904 = 0.1e1 / t97 / t3146;
  t4911 = t108 * t46 * t48;
  t4915 = 0.1e1 / t98 / t598;
  t4957 = t116 * t28;
  t4963 = 0.29329324526251372317e-7 * t3152 * t2337 * t4904 * t108 + 0.30109432512837463418e-9 * t1397 * t4904 * t4911 - 0.5719470073930106145e-3 * t3138 * t2346 * t4915 * t334 + 0.1525192019714694972e-3 * t629 * t777 * t878 - 0.25340536390681185682e-4 * t1398 * t1996 + 0.11378764034883452015e-4 * t2021 - 0.11706547360991205777e-6 * t2018 * t2180 - 0.17158410221790318435e-2 * t3174 * t334 * t4915 * t429 - 0.635496674881122905e-4 * t1445 * t2000 * t869 + 0.58658649052502744635e-7 * t1398 * t4904 * t4911 - 0.76021609172043557047e-5 * t1408 * t2006 * sigma[2] + 0.55419753086419753086e-3 * t611 * t291 - 0.3431682044358063687e-2 * t3201 * t869 * t262 * t61 + 0.2287788029572042458e-2 * t625 * t2197 * t253 - 0.31774833744056145251e-3 * t1451 * t262 * t2203 - 0.1525192019714694972e-3 * t268 * t2211 * t271 + 0.17380340460000813225e-6 * t3214 * t2005 * t4957 * t276 - 0.95027011465054446308e-5 * t2010 * t2180;
  t5003 = -0.3e1 / 0.8e1 * t244 * t2217 - 0.3e1 / 0.8e1 * t95 * t27 * t4963 * t137 - t4853 + t199 * t243 * t2241 / 0.1024e4 + t2239 * t281 * t2240 / 0.1024e4 - t2239 * t129 * t288 * t291 / 0.128e3 + t4879 + t651 * t1833 * t2077 / 0.12288e5 - 0.3e1 / 0.128e3 * t286 * t791 * t2015 - 0.5e1 / 0.25165824e8 * t1350 * t1353 * t656 * t2072 + 0.19e2 / 0.147456e6 * t651 * t654 * t130 * t802 - 0.3e1 / 0.256e3 * t286 * t2050 * t765 + t651 * t4668 * t803 / 0.98304e5 - t1373 * t2223 / 0.262144e6 - t651 * t4031 * t892 / 0.262144e6;
  t5028 = t2215 * t288;
  t5037 = -t1350 * t4037 * t2073 / 0.25165824e8 + 0.3e1 / 0.1024e4 * t589 * t2226 + 0.3e1 / 0.1024e4 * t286 * t1829 * t861 + t3294 * t2232 / 0.201326592e9 + t1350 * t3290 * t2231 / 0.201326592e9 + t3297 * t3300 * t1355 / t3302 / rho[1] / 0.14495514624e11 - t1373 * t2236 / 0.131072e6 - t651 * t1346 * t2235 / 0.131072e6 - t286 * t5028 * t292 / 0.768e3 + 0.3e1 / 0.2048e4 * t589 * t2220 + 0.3e1 / 0.2048e4 * t286 * t4664 * t346 + t4857 - t4861 + t4865 + t4869 - t4873;
  t5039 = my_piecewise3(t88, 0, t5003 + t5037);
  tv4rhosigma319 = t6 * t5039 + t2245;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t5070 = 0.1e1 / t35 / t995;
  t5079 = sigma[0] * t46 * t48;
  t5104 = 0.12868807666342738826e-2 * t2258 * t2119 * t54 * t61 + 0.42896025554475796088e-2 * t425 * t32 / t76 * t38 - 0.16681787715629476257e-3 * t2124 * t2119 * t46 * t60 - 0.28597350369650530725e-3 * t180 * t60 / t62 / t76 * t64 + 0.21448012777237898044e-3 * t2302 * t2346 * t2251 * t834 + 0.1143894014786021229e-3 * t430 * t830 * t2133 + 0.71270258598790834731e-6 * t991 * t2097 - 0.10998496697344264619e-7 * t2334 * t2337 * t5070 * sigma[0] + 0.21949776301858510832e-7 * t2108 * t33 - 0.11291037192314048782e-9 * t980 * t5070 * t5079 + 0.14254051719758166946e-5 * t1009 * t2096 * t28 * t32 - 0.15442569199611286592e-1 * t1024 * t429 * t2133 * t830 + 0.64344038331713694132e-3 * t2303 * t2251 * t429 * t834 - 0.11915562654021054469e-3 * t1030 * t813 * t2119 - 0.65176276725003049595e-7 * t2277 * t2096 * t4695 * t32 - 0.21996993394688529238e-7 * t981 * t5070 * t5079;
  t5141 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t26 * t27 * t5104 * t83 + t201 * t4835 * t320 / 0.512e3 - t456 * t4301 * t848 / 0.131072e6 + 0.3e1 / 0.512e3 * t201 * t1914 * t817 + t929 * t3575 * t2154 / 0.50331648e8 - t456 * t1523 * t2158 / 0.32768e5 + t2162 * t316 * t2163 / 0.256e3 - t2422 * t2425 * t933 / t2427 / 0.38654705664e11 + t929 * t932 * t722 * t2153 / 0.16777216e8 - 0.5e1 / 0.196608e6 * t456 * t459 * t50 * t847);
  tv4sigma40 = t6 * t5141;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t5152 = 0.1e1 / t97 / t1410;
  t5161 = sigma[2] * t46 * t48;
  t5205 = 0.21448012777237898044e-3 * t3138 * t2346 * t3158 * t878 + 0.1143894014786021229e-3 * t629 * t874 * t2210 + 0.71270258598790834731e-6 * t1408 * t2174 - 0.10998496697344264619e-7 * t3152 * t2337 * t5152 * sigma[2] + 0.21949776301858510832e-7 * t2185 * t33 - 0.11291037192314048782e-9 * t1397 * t5152 * t5161 - 0.15442569199611286592e-1 * t1439 * t429 * t2210 * t874 + 0.64344038331713694132e-3 * t3174 * t3158 * t429 * t878 - 0.11915562654021054469e-3 * t1445 * t857 * t2196 - 0.65176276725003049595e-7 * t3214 * t2173 * t4957 * t32 - 0.21996993394688529238e-7 * t1398 * t5152 * t5161 + 0.14254051719758166946e-5 * t1424 * t2173 * t28 * t32 + 0.42896025554475796088e-2 * t625 * t32 / t130 * t100 - 0.16681787715629476257e-3 * t2201 * t2196 * t46 * t60 - 0.28597350369650530725e-3 * t268 * t60 / t118 / t130 * t120 + 0.12868807666342738826e-2 * t3201 * t2196 * t112 * t61;
  t5242 = my_piecewise3(t88, 0, -0.3e1 / 0.8e1 * t95 * t27 * t5205 * t137 + t286 * t5028 * t346 / 0.512e3 - t651 * t4668 * t892 / 0.131072e6 + 0.3e1 / 0.512e3 * t286 * t2050 * t861 + t1350 * t4037 * t2231 / 0.50331648e8 - t651 * t1833 * t2235 / 0.32768e5 + t2239 * t342 * t2240 / 0.256e3 - t3297 * t3300 * t1354 / t3302 / 0.38654705664e11 + t1350 * t1353 * t800 * t2230 / 0.16777216e8 - 0.5e1 / 0.196608e6 * t651 * t654 * t108 * t891);
  tv4sigma414 = t6 * t5242;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

