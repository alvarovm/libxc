/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_x_vmt.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t33, t38, t41, t42, t45, t46, t47;
  double t48, t51, t55, tzk0;

  gga_x_vmt_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->mu * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t25 * sigma[0];
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t38 = sigma[0] * t29 * t33;
  t41 = exp(-params->alpha * t20 * t25 * t38 / 0.24e2);
  t42 = t21 * t25;
  t45 = 0.1e1 + t42 * t38 / 0.24e2;
  t46 = 0.1e1 / t45;
  t47 = t41 * t46;
  t48 = t29 * t33 * t47;
  t51 = 0.1e1 + t27 * t48 / 0.24e2;
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t51);
  tzk0 = 0.2e1 * t55;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t33, t38, t41, t42, t45, t46, t47;
  double t48, t51, t55, tzk0;

  double t57, t61, t63, t65, t68, t69, t71, t72;
  double t73, t74, t75, t76, t78, t79, t80, t81;
  double t85, t86, t87, t88, t89, t90, t91, t94;
  double t99, tvrho0, t104, t106, t108, t109, t114, t117;
  double t121, tvsigma0;

  gga_x_vmt_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->mu * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t25 * sigma[0];
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t38 = sigma[0] * t29 * t33;
  t41 = exp(-params->alpha * t20 * t25 * t38 / 0.24e2);
  t42 = t21 * t25;
  t45 = 0.1e1 + t42 * t38 / 0.24e2;
  t46 = 0.1e1 / t45;
  t47 = t41 * t46;
  t48 = t29 * t33 * t47;
  t51 = 0.1e1 + t27 * t48 / 0.24e2;
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t51);
  tzk0 = 0.2e1 * t55;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t57 = t17 / t31;
  t61 = t30 * rho[0];
  t63 = 0.1e1 / t31 / t61;
  t65 = t29 * t63 * t47;
  t68 = t20 * t20;
  t69 = params->mu * t68;
  t71 = 0.1e1 / t23 / t22;
  t72 = sigma[0] * sigma[0];
  t73 = t71 * t72;
  t74 = t69 * t73;
  t75 = t30 * t30;
  t76 = t75 * t30;
  t78 = 0.1e1 / t18 / t76;
  t79 = t28 * t78;
  t80 = params->alpha * t41;
  t81 = t80 * t46;
  t85 = params->mu * params->mu;
  t86 = t85 * t68;
  t87 = t86 * t73;
  t88 = t45 * t45;
  t89 = 0.1e1 / t88;
  t90 = t41 * t89;
  t91 = t79 * t90;
  t94 = -t27 * t65 / 0.9e1 + t74 * t79 * t81 / 0.108e3 + t87 * t91 / 0.108e3;
  t99 = my_piecewise3(t2, 0, -t6 * t57 * t51 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t94);
  tvrho0 = 0.2e1 * rho[0] * t99 + 0.2e1 * t55;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t104 = t71 * sigma[0];
  t106 = t75 * rho[0];
  t108 = 0.1e1 / t18 / t106;
  t109 = t28 * t108;
  t114 = t109 * t90;
  t117 = t42 * t48 / 0.24e2 - t69 * t104 * t109 * t81 / 0.288e3 - t86 * t104 * t114 / 0.288e3;
  t121 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t117);
  tvsigma0 = 0.2e1 * rho[0] * t121;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t33, t38, t41, t42, t45, t46, t47;
  double t48, t51, t55, tzk0;

  double t57, t61, t63, t65, t68, t69, t71, t72;
  double t73, t74, t75, t76, t78, t79, t80, t81;
  double t85, t86, t87, t88, t89, t90, t91, t94;
  double t99, tvrho0, t104, t106, t108, t109, t114, t117;
  double t121, tvsigma0;

  double t126, t136, t139, t141, t142, t146, t149, t150;
  double t151, t152, t153, t154, t155, t156, t157, t162;
  double t163, t169, t170, t173, t177, t182, tv2rho20, t190;
  double t191, t192, t194, t198, t200, t205, t206, t218;
  double t221, t226, tv2rhosigma0, t233, t237, t249, t252, t256;
  double tv2sigma20;

  gga_x_vmt_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->mu * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t25 * sigma[0];
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t38 = sigma[0] * t29 * t33;
  t41 = exp(-params->alpha * t20 * t25 * t38 / 0.24e2);
  t42 = t21 * t25;
  t45 = 0.1e1 + t42 * t38 / 0.24e2;
  t46 = 0.1e1 / t45;
  t47 = t41 * t46;
  t48 = t29 * t33 * t47;
  t51 = 0.1e1 + t27 * t48 / 0.24e2;
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t51);
  tzk0 = 0.2e1 * t55;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t57 = t17 / t31;
  t61 = t30 * rho[0];
  t63 = 0.1e1 / t31 / t61;
  t65 = t29 * t63 * t47;
  t68 = t20 * t20;
  t69 = params->mu * t68;
  t71 = 0.1e1 / t23 / t22;
  t72 = sigma[0] * sigma[0];
  t73 = t71 * t72;
  t74 = t69 * t73;
  t75 = t30 * t30;
  t76 = t75 * t30;
  t78 = 0.1e1 / t18 / t76;
  t79 = t28 * t78;
  t80 = params->alpha * t41;
  t81 = t80 * t46;
  t85 = params->mu * params->mu;
  t86 = t85 * t68;
  t87 = t86 * t73;
  t88 = t45 * t45;
  t89 = 0.1e1 / t88;
  t90 = t41 * t89;
  t91 = t79 * t90;
  t94 = -t27 * t65 / 0.9e1 + t74 * t79 * t81 / 0.108e3 + t87 * t91 / 0.108e3;
  t99 = my_piecewise3(t2, 0, -t6 * t57 * t51 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t94);
  tvrho0 = 0.2e1 * rho[0] * t99 + 0.2e1 * t55;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t104 = t71 * sigma[0];
  t106 = t75 * rho[0];
  t108 = 0.1e1 / t18 / t106;
  t109 = t28 * t108;
  t114 = t109 * t90;
  t117 = t42 * t48 / 0.24e2 - t69 * t104 * t109 * t81 / 0.288e3 - t86 * t104 * t114 / 0.288e3;
  t121 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t117);
  tvsigma0 = 0.2e1 * rho[0] * t121;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t126 = t17 / t31 / rho[0];
  t136 = t29 / t31 / t75 * t47;
  t139 = t75 * t61;
  t141 = 0.1e1 / t18 / t139;
  t142 = t28 * t141;
  t146 = t142 * t90;
  t149 = t22 * t22;
  t150 = 0.1e1 / t149;
  t151 = params->mu * t150;
  t152 = t72 * sigma[0];
  t153 = t151 * t152;
  t154 = t75 * t75;
  t155 = t154 * t30;
  t156 = 0.1e1 / t155;
  t157 = params->alpha * params->alpha;
  t162 = t85 * t150;
  t163 = t162 * t152;
  t169 = t85 * params->mu * t150;
  t170 = t169 * t152;
  t173 = 0.1e1 / t88 / t45;
  t177 = 0.11e2 / 0.27e2 * t27 * t136 - t74 * t142 * t81 / 0.12e2 - t87 * t146 / 0.12e2 + t153 * t156 * t157 * t47 / 0.81e2 + 0.2e1 / 0.81e2 * t163 * t156 * params->alpha * t90 + 0.2e1 / 0.81e2 * t170 * t156 * t41 * t173;
  t182 = my_piecewise3(t2, 0, t6 * t126 * t51 / 0.12e2 - t6 * t57 * t94 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t177);
  tv2rho20 = 0.2e1 * rho[0] * t182 + 0.4e1 * t99;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t190 = t71 * t28;
  t191 = t69 * t190;
  t192 = t78 * params->alpha;
  t194 = sigma[0] * t41 * t46;
  t198 = t86 * t190;
  t200 = t89 * sigma[0];
  t205 = t154 * rho[0];
  t206 = 0.1e1 / t205;
  t218 = t206 * t41 * t173;
  t221 = -t42 * t65 / 0.9e1 + t191 * t192 * t194 / 0.36e2 + t198 * t78 * t41 * t200 / 0.36e2 - t151 * t72 * t206 * t157 * t47 / 0.216e3 - t162 * t72 * t206 * params->alpha * t90 / 0.108e3 - t169 * t72 * t218 / 0.108e3;
  t226 = my_piecewise3(t2, 0, -t6 * t57 * t117 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t221);
  tv2rhosigma0 = 0.2e1 * rho[0] * t226 + 0.2e1 * t121;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t233 = t86 * t71;
  t237 = 0.1e1 / t154;
  t249 = t237 * t41 * t173;
  t252 = -t191 * t108 * params->alpha * t47 / 0.144e3 - t233 * t114 / 0.144e3 + t151 * sigma[0] * t237 * t157 * t47 / 0.576e3 + t162 * sigma[0] * t237 * params->alpha * t90 / 0.288e3 + t169 * sigma[0] * t249 / 0.288e3;
  t256 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t252);
  tv2sigma20 = 0.2e1 * rho[0] * t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t33, t38, t41, t42, t45, t46, t47;
  double t48, t51, t55, tzk0;

  double t57, t61, t63, t65, t68, t69, t71, t72;
  double t73, t74, t75, t76, t78, t79, t80, t81;
  double t85, t86, t87, t88, t89, t90, t91, t94;
  double t99, tvrho0, t104, t106, t108, t109, t114, t117;
  double t121, tvsigma0;

  double t126, t136, t139, t141, t142, t146, t149, t150;
  double t151, t152, t153, t154, t155, t156, t157, t162;
  double t163, t169, t170, t173, t177, t182, tv2rho20, t190;
  double t191, t192, t194, t198, t200, t205, t206, t218;
  double t221, t226, tv2rhosigma0, t233, t237, t249, t252, t256;
  double tv2sigma20;

  double t259, t272, t276, t277, t284, t285, t298, t299;
  double t301, t302, t303, t306, t308, t309, t314, t315;
  double t320, t321, t324, t325, t327, t328, t329, t330;
  double t333, t338, tv3rho30, t350, t358, t360, t363, t365;
  double t368, t369, t372, t374, t375, t391, t396, tv3rho2sigma0;
  double t405, t407, t410, t411, t417, t421, t422, t438;
  double t443, tv3rhosigma20, t448, t452, t458, t459, t475, t479;
  double tv3sigma30;

  gga_x_vmt_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->mu * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t25 * sigma[0];
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t38 = sigma[0] * t29 * t33;
  t41 = exp(-params->alpha * t20 * t25 * t38 / 0.24e2);
  t42 = t21 * t25;
  t45 = 0.1e1 + t42 * t38 / 0.24e2;
  t46 = 0.1e1 / t45;
  t47 = t41 * t46;
  t48 = t29 * t33 * t47;
  t51 = 0.1e1 + t27 * t48 / 0.24e2;
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t51);
  tzk0 = 0.2e1 * t55;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t57 = t17 / t31;
  t61 = t30 * rho[0];
  t63 = 0.1e1 / t31 / t61;
  t65 = t29 * t63 * t47;
  t68 = t20 * t20;
  t69 = params->mu * t68;
  t71 = 0.1e1 / t23 / t22;
  t72 = sigma[0] * sigma[0];
  t73 = t71 * t72;
  t74 = t69 * t73;
  t75 = t30 * t30;
  t76 = t75 * t30;
  t78 = 0.1e1 / t18 / t76;
  t79 = t28 * t78;
  t80 = params->alpha * t41;
  t81 = t80 * t46;
  t85 = params->mu * params->mu;
  t86 = t85 * t68;
  t87 = t86 * t73;
  t88 = t45 * t45;
  t89 = 0.1e1 / t88;
  t90 = t41 * t89;
  t91 = t79 * t90;
  t94 = -t27 * t65 / 0.9e1 + t74 * t79 * t81 / 0.108e3 + t87 * t91 / 0.108e3;
  t99 = my_piecewise3(t2, 0, -t6 * t57 * t51 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t94);
  tvrho0 = 0.2e1 * rho[0] * t99 + 0.2e1 * t55;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t104 = t71 * sigma[0];
  t106 = t75 * rho[0];
  t108 = 0.1e1 / t18 / t106;
  t109 = t28 * t108;
  t114 = t109 * t90;
  t117 = t42 * t48 / 0.24e2 - t69 * t104 * t109 * t81 / 0.288e3 - t86 * t104 * t114 / 0.288e3;
  t121 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t117);
  tvsigma0 = 0.2e1 * rho[0] * t121;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t126 = t17 / t31 / rho[0];
  t136 = t29 / t31 / t75 * t47;
  t139 = t75 * t61;
  t141 = 0.1e1 / t18 / t139;
  t142 = t28 * t141;
  t146 = t142 * t90;
  t149 = t22 * t22;
  t150 = 0.1e1 / t149;
  t151 = params->mu * t150;
  t152 = t72 * sigma[0];
  t153 = t151 * t152;
  t154 = t75 * t75;
  t155 = t154 * t30;
  t156 = 0.1e1 / t155;
  t157 = params->alpha * params->alpha;
  t162 = t85 * t150;
  t163 = t162 * t152;
  t169 = t85 * params->mu * t150;
  t170 = t169 * t152;
  t173 = 0.1e1 / t88 / t45;
  t177 = 0.11e2 / 0.27e2 * t27 * t136 - t74 * t142 * t81 / 0.12e2 - t87 * t146 / 0.12e2 + t153 * t156 * t157 * t47 / 0.81e2 + 0.2e1 / 0.81e2 * t163 * t156 * params->alpha * t90 + 0.2e1 / 0.81e2 * t170 * t156 * t41 * t173;
  t182 = my_piecewise3(t2, 0, t6 * t126 * t51 / 0.12e2 - t6 * t57 * t94 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t177);
  tv2rho20 = 0.2e1 * rho[0] * t182 + 0.4e1 * t99;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t190 = t71 * t28;
  t191 = t69 * t190;
  t192 = t78 * params->alpha;
  t194 = sigma[0] * t41 * t46;
  t198 = t86 * t190;
  t200 = t89 * sigma[0];
  t205 = t154 * rho[0];
  t206 = 0.1e1 / t205;
  t218 = t206 * t41 * t173;
  t221 = -t42 * t65 / 0.9e1 + t191 * t192 * t194 / 0.36e2 + t198 * t78 * t41 * t200 / 0.36e2 - t151 * t72 * t206 * t157 * t47 / 0.216e3 - t162 * t72 * t206 * params->alpha * t90 / 0.108e3 - t169 * t72 * t218 / 0.108e3;
  t226 = my_piecewise3(t2, 0, -t6 * t57 * t117 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t221);
  tv2rhosigma0 = 0.2e1 * rho[0] * t226 + 0.2e1 * t121;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t233 = t86 * t71;
  t237 = 0.1e1 / t154;
  t249 = t237 * t41 * t173;
  t252 = -t191 * t108 * params->alpha * t47 / 0.144e3 - t233 * t114 / 0.144e3 + t151 * sigma[0] * t237 * t157 * t47 / 0.576e3 + t162 * sigma[0] * t237 * params->alpha * t90 / 0.288e3 + t169 * sigma[0] * t249 / 0.288e3;
  t256 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t252);
  tv2sigma20 = 0.2e1 * rho[0] * t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t259 = t17 * t33;
  t272 = t29 / t31 / t106 * t47;
  t276 = 0.1e1 / t18 / t154;
  t277 = t28 * t276;
  t284 = t154 * t61;
  t285 = 0.1e1 / t284;
  t298 = t72 * t72;
  t299 = t154 * t106;
  t301 = 0.1e1 / t31 / t299;
  t302 = t298 * t301;
  t303 = t157 * params->alpha;
  t306 = t20 * t25;
  t308 = t29 * t41 * t46;
  t309 = t306 * t308;
  t314 = t306 * t29;
  t315 = t90 * t314;
  t320 = t41 * t173;
  t321 = t320 * t314;
  t324 = t85 * t85;
  t325 = t324 * t150;
  t327 = t88 * t88;
  t328 = 0.1e1 / t327;
  t329 = t41 * t328;
  t330 = t329 * t314;
  t333 = -0.154e3 / 0.81e2 * t27 * t272 + 0.341e3 / 0.486e3 * t74 * t277 * t81 + 0.341e3 / 0.486e3 * t87 * t277 * t90 - 0.19e2 / 0.81e2 * t153 * t285 * t157 * t47 - 0.38e2 / 0.81e2 * t163 * t285 * params->alpha * t90 - 0.38e2 / 0.81e2 * t170 * t285 * t41 * t173 + t151 * t302 * t303 * t309 / 0.729e3 + t162 * t302 * t157 * t315 / 0.243e3 + 0.2e1 / 0.243e3 * t169 * t302 * params->alpha * t321 + 0.2e1 / 0.243e3 * t325 * t302 * t330;
  t338 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t259 * t51 + t6 * t126 * t94 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t57 * t177 - 0.3e1 / 0.8e1 * t6 * t19 * t333);
  tv3rho30 = 0.2e1 * rho[0] * t338 + 0.6e1 * t182;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t350 = t141 * params->alpha;
  t358 = t151 * t156;
  t360 = t157 * t72 * t47;
  t363 = t162 * t156;
  t365 = params->alpha * t72 * t90;
  t368 = t169 * t156;
  t369 = t320 * t72;
  t372 = t154 * t75;
  t374 = 0.1e1 / t31 / t372;
  t375 = t152 * t374;
  t391 = 0.11e2 / 0.27e2 * t42 * t136 - 0.65e2 / 0.324e3 * t191 * t350 * t194 - 0.65e2 / 0.324e3 * t198 * t141 * t41 * t200 + 0.17e2 / 0.216e3 * t358 * t360 + 0.17e2 / 0.108e3 * t363 * t365 + 0.17e2 / 0.108e3 * t368 * t369 - t151 * t375 * t303 * t309 / 0.1944e4 - t162 * t375 * t157 * t315 / 0.648e3 - t169 * t375 * params->alpha * t321 / 0.324e3 - t325 * t375 * t330 / 0.324e3;
  t396 = my_piecewise3(t2, 0, t6 * t126 * t117 / 0.12e2 - t6 * t57 * t221 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t391);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t396 + 0.4e1 * t226;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t405 = t151 * t206;
  t407 = t157 * sigma[0] * t47;
  t410 = t162 * t206;
  t411 = t80 * t200;
  t417 = t320 * sigma[0];
  t421 = 0.1e1 / t31 / t284;
  t422 = t72 * t421;
  t438 = t191 * t192 * t47 / 0.27e2 - 0.5e1 / 0.216e3 * t405 * t407 - 0.5e1 / 0.108e3 * t410 * t411 + t233 * t91 / 0.27e2 - 0.5e1 / 0.108e3 * t169 * t206 * t417 + t151 * t422 * t303 * t309 / 0.5184e4 + t162 * t422 * t157 * t315 / 0.1728e4 + t169 * t422 * params->alpha * t321 / 0.864e3 + t325 * t422 * t330 / 0.864e3;
  t443 = my_piecewise3(t2, 0, -t6 * t57 * t252 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t438);
  tv3rhosigma20 = 0.2e1 * rho[0] * t443 + 0.2e1 * t256;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t448 = t157 * t41 * t46;
  t452 = t80 * t89;
  t458 = 0.1e1 / t31 / t155;
  t459 = sigma[0] * t458;
  t475 = t151 * t237 * t448 / 0.192e3 + t162 * t237 * t452 / 0.96e2 + t169 * t249 / 0.96e2 - t151 * t459 * t303 * t309 / 0.13824e5 - t162 * t459 * t157 * t315 / 0.4608e4 - t169 * t459 * params->alpha * t321 / 0.2304e4 - t325 * t459 * t330 / 0.2304e4;
  t479 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t475);
  tv3sigma30 = 0.2e1 * rho[0] * t479;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t4, t6, t7, t8, t10, t11;
  double t13, t15, t17, t18, t19, t20, t21, t22;
  double t23, t24, t25, t26, t27, t28, t29, t30;
  double t31, t33, t38, t41, t42, t45, t46, t47;
  double t48, t51, t55, tzk0;

  double t57, t61, t63, t65, t68, t69, t71, t72;
  double t73, t74, t75, t76, t78, t79, t80, t81;
  double t85, t86, t87, t88, t89, t90, t91, t94;
  double t99, tvrho0, t104, t106, t108, t109, t114, t117;
  double t121, tvsigma0;

  double t126, t136, t139, t141, t142, t146, t149, t150;
  double t151, t152, t153, t154, t155, t156, t157, t162;
  double t163, t169, t170, t173, t177, t182, tv2rho20, t190;
  double t191, t192, t194, t198, t200, t205, t206, t218;
  double t221, t226, tv2rhosigma0, t233, t237, t249, t252, t256;
  double tv2sigma20;

  double t259, t272, t276, t277, t284, t285, t298, t299;
  double t301, t302, t303, t306, t308, t309, t314, t315;
  double t320, t321, t324, t325, t327, t328, t329, t330;
  double t333, t338, tv3rho30, t350, t358, t360, t363, t365;
  double t368, t369, t372, t374, t375, t391, t396, tv3rho2sigma0;
  double t405, t407, t410, t411, t417, t421, t422, t438;
  double t443, tv3rhosigma20, t448, t452, t458, t459, t475, t479;
  double tv3sigma30;

  double t496, t498, t502, t507, t508, t509, t512, t519;
  double t523, t526, t528, t534, t539, t544, t547, t550;
  double t583, t588, tv4rho40, t603, t663, t668, tv4rho3sigma0, t694;
  double t735, t740, tv4rho2sigma20, t758, t775, t781, t801, t806;
  double tv4rhosigma30, t829, t853, tv4sigma40;

  gga_x_vmt_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt_params * )(p->params);

  t2 = rho[0] / 0.2e1 <= p->dens_threshold;
  t3 = M_CBRT3;
  t4 = M_CBRTPI;
  t6 = t3 / t4;
  t7 = 0.1e1 <= p->zeta_threshold;
  t8 = p->zeta_threshold - 0.1e1;
  t10 = my_piecewise5(t7, t8, t7, -t8, 0);
  t11 = 0.1e1 + t10;
  t13 = POW_1_3(p->zeta_threshold);
  t15 = POW_1_3(t11);
  t17 = my_piecewise3(t11 <= p->zeta_threshold, t13 * p->zeta_threshold, t15 * t11);
  t18 = POW_1_3(rho[0]);
  t19 = t17 * t18;
  t20 = M_CBRT6;
  t21 = params->mu * t20;
  t22 = M_PI * M_PI;
  t23 = POW_1_3(t22);
  t24 = t23 * t23;
  t25 = 0.1e1 / t24;
  t26 = t25 * sigma[0];
  t27 = t21 * t26;
  t28 = M_CBRT2;
  t29 = t28 * t28;
  t30 = rho[0] * rho[0];
  t31 = t18 * t18;
  t33 = 0.1e1 / t31 / t30;
  t38 = sigma[0] * t29 * t33;
  t41 = exp(-params->alpha * t20 * t25 * t38 / 0.24e2);
  t42 = t21 * t25;
  t45 = 0.1e1 + t42 * t38 / 0.24e2;
  t46 = 0.1e1 / t45;
  t47 = t41 * t46;
  t48 = t29 * t33 * t47;
  t51 = 0.1e1 + t27 * t48 / 0.24e2;
  t55 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t51);
  tzk0 = 0.2e1 * t55;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t57 = t17 / t31;
  t61 = t30 * rho[0];
  t63 = 0.1e1 / t31 / t61;
  t65 = t29 * t63 * t47;
  t68 = t20 * t20;
  t69 = params->mu * t68;
  t71 = 0.1e1 / t23 / t22;
  t72 = sigma[0] * sigma[0];
  t73 = t71 * t72;
  t74 = t69 * t73;
  t75 = t30 * t30;
  t76 = t75 * t30;
  t78 = 0.1e1 / t18 / t76;
  t79 = t28 * t78;
  t80 = params->alpha * t41;
  t81 = t80 * t46;
  t85 = params->mu * params->mu;
  t86 = t85 * t68;
  t87 = t86 * t73;
  t88 = t45 * t45;
  t89 = 0.1e1 / t88;
  t90 = t41 * t89;
  t91 = t79 * t90;
  t94 = -t27 * t65 / 0.9e1 + t74 * t79 * t81 / 0.108e3 + t87 * t91 / 0.108e3;
  t99 = my_piecewise3(t2, 0, -t6 * t57 * t51 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t94);
  tvrho0 = 0.2e1 * rho[0] * t99 + 0.2e1 * t55;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t104 = t71 * sigma[0];
  t106 = t75 * rho[0];
  t108 = 0.1e1 / t18 / t106;
  t109 = t28 * t108;
  t114 = t109 * t90;
  t117 = t42 * t48 / 0.24e2 - t69 * t104 * t109 * t81 / 0.288e3 - t86 * t104 * t114 / 0.288e3;
  t121 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t117);
  tvsigma0 = 0.2e1 * rho[0] * t121;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t126 = t17 / t31 / rho[0];
  t136 = t29 / t31 / t75 * t47;
  t139 = t75 * t61;
  t141 = 0.1e1 / t18 / t139;
  t142 = t28 * t141;
  t146 = t142 * t90;
  t149 = t22 * t22;
  t150 = 0.1e1 / t149;
  t151 = params->mu * t150;
  t152 = t72 * sigma[0];
  t153 = t151 * t152;
  t154 = t75 * t75;
  t155 = t154 * t30;
  t156 = 0.1e1 / t155;
  t157 = params->alpha * params->alpha;
  t162 = t85 * t150;
  t163 = t162 * t152;
  t169 = t85 * params->mu * t150;
  t170 = t169 * t152;
  t173 = 0.1e1 / t88 / t45;
  t177 = 0.11e2 / 0.27e2 * t27 * t136 - t74 * t142 * t81 / 0.12e2 - t87 * t146 / 0.12e2 + t153 * t156 * t157 * t47 / 0.81e2 + 0.2e1 / 0.81e2 * t163 * t156 * params->alpha * t90 + 0.2e1 / 0.81e2 * t170 * t156 * t41 * t173;
  t182 = my_piecewise3(t2, 0, t6 * t126 * t51 / 0.12e2 - t6 * t57 * t94 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t177);
  tv2rho20 = 0.2e1 * rho[0] * t182 + 0.4e1 * t99;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t190 = t71 * t28;
  t191 = t69 * t190;
  t192 = t78 * params->alpha;
  t194 = sigma[0] * t41 * t46;
  t198 = t86 * t190;
  t200 = t89 * sigma[0];
  t205 = t154 * rho[0];
  t206 = 0.1e1 / t205;
  t218 = t206 * t41 * t173;
  t221 = -t42 * t65 / 0.9e1 + t191 * t192 * t194 / 0.36e2 + t198 * t78 * t41 * t200 / 0.36e2 - t151 * t72 * t206 * t157 * t47 / 0.216e3 - t162 * t72 * t206 * params->alpha * t90 / 0.108e3 - t169 * t72 * t218 / 0.108e3;
  t226 = my_piecewise3(t2, 0, -t6 * t57 * t117 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t221);
  tv2rhosigma0 = 0.2e1 * rho[0] * t226 + 0.2e1 * t121;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t233 = t86 * t71;
  t237 = 0.1e1 / t154;
  t249 = t237 * t41 * t173;
  t252 = -t191 * t108 * params->alpha * t47 / 0.144e3 - t233 * t114 / 0.144e3 + t151 * sigma[0] * t237 * t157 * t47 / 0.576e3 + t162 * sigma[0] * t237 * params->alpha * t90 / 0.288e3 + t169 * sigma[0] * t249 / 0.288e3;
  t256 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t252);
  tv2sigma20 = 0.2e1 * rho[0] * t256;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t259 = t17 * t33;
  t272 = t29 / t31 / t106 * t47;
  t276 = 0.1e1 / t18 / t154;
  t277 = t28 * t276;
  t284 = t154 * t61;
  t285 = 0.1e1 / t284;
  t298 = t72 * t72;
  t299 = t154 * t106;
  t301 = 0.1e1 / t31 / t299;
  t302 = t298 * t301;
  t303 = t157 * params->alpha;
  t306 = t20 * t25;
  t308 = t29 * t41 * t46;
  t309 = t306 * t308;
  t314 = t306 * t29;
  t315 = t90 * t314;
  t320 = t41 * t173;
  t321 = t320 * t314;
  t324 = t85 * t85;
  t325 = t324 * t150;
  t327 = t88 * t88;
  t328 = 0.1e1 / t327;
  t329 = t41 * t328;
  t330 = t329 * t314;
  t333 = -0.154e3 / 0.81e2 * t27 * t272 + 0.341e3 / 0.486e3 * t74 * t277 * t81 + 0.341e3 / 0.486e3 * t87 * t277 * t90 - 0.19e2 / 0.81e2 * t153 * t285 * t157 * t47 - 0.38e2 / 0.81e2 * t163 * t285 * params->alpha * t90 - 0.38e2 / 0.81e2 * t170 * t285 * t41 * t173 + t151 * t302 * t303 * t309 / 0.729e3 + t162 * t302 * t157 * t315 / 0.243e3 + 0.2e1 / 0.243e3 * t169 * t302 * params->alpha * t321 + 0.2e1 / 0.243e3 * t325 * t302 * t330;
  t338 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t259 * t51 + t6 * t126 * t94 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t57 * t177 - 0.3e1 / 0.8e1 * t6 * t19 * t333);
  tv3rho30 = 0.2e1 * rho[0] * t338 + 0.6e1 * t182;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t350 = t141 * params->alpha;
  t358 = t151 * t156;
  t360 = t157 * t72 * t47;
  t363 = t162 * t156;
  t365 = params->alpha * t72 * t90;
  t368 = t169 * t156;
  t369 = t320 * t72;
  t372 = t154 * t75;
  t374 = 0.1e1 / t31 / t372;
  t375 = t152 * t374;
  t391 = 0.11e2 / 0.27e2 * t42 * t136 - 0.65e2 / 0.324e3 * t191 * t350 * t194 - 0.65e2 / 0.324e3 * t198 * t141 * t41 * t200 + 0.17e2 / 0.216e3 * t358 * t360 + 0.17e2 / 0.108e3 * t363 * t365 + 0.17e2 / 0.108e3 * t368 * t369 - t151 * t375 * t303 * t309 / 0.1944e4 - t162 * t375 * t157 * t315 / 0.648e3 - t169 * t375 * params->alpha * t321 / 0.324e3 - t325 * t375 * t330 / 0.324e3;
  t396 = my_piecewise3(t2, 0, t6 * t126 * t117 / 0.12e2 - t6 * t57 * t221 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t391);
  tv3rho2sigma0 = 0.2e1 * rho[0] * t396 + 0.4e1 * t226;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t405 = t151 * t206;
  t407 = t157 * sigma[0] * t47;
  t410 = t162 * t206;
  t411 = t80 * t200;
  t417 = t320 * sigma[0];
  t421 = 0.1e1 / t31 / t284;
  t422 = t72 * t421;
  t438 = t191 * t192 * t47 / 0.27e2 - 0.5e1 / 0.216e3 * t405 * t407 - 0.5e1 / 0.108e3 * t410 * t411 + t233 * t91 / 0.27e2 - 0.5e1 / 0.108e3 * t169 * t206 * t417 + t151 * t422 * t303 * t309 / 0.5184e4 + t162 * t422 * t157 * t315 / 0.1728e4 + t169 * t422 * params->alpha * t321 / 0.864e3 + t325 * t422 * t330 / 0.864e3;
  t443 = my_piecewise3(t2, 0, -t6 * t57 * t252 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t438);
  tv3rhosigma20 = 0.2e1 * rho[0] * t443 + 0.2e1 * t256;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  t448 = t157 * t41 * t46;
  t452 = t80 * t89;
  t458 = 0.1e1 / t31 / t155;
  t459 = sigma[0] * t458;
  t475 = t151 * t237 * t448 / 0.192e3 + t162 * t237 * t452 / 0.96e2 + t169 * t249 / 0.96e2 - t151 * t459 * t303 * t309 / 0.13824e5 - t162 * t459 * t157 * t315 / 0.4608e4 - t169 * t459 * params->alpha * t321 / 0.2304e4 - t325 * t459 * t330 / 0.2304e4;
  t479 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t475);
  tv3sigma30 = 0.2e1 * rho[0] * t479;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t496 = t324 * params->mu * t150;
  t498 = t154 * t154;
  t502 = t298 * sigma[0] / t18 / t498 / rho[0];
  t507 = t68 * t71;
  t508 = t507 * t28;
  t509 = t41 / t327 / t45 * t508;
  t512 = 0.1e1 / t372;
  t519 = t28 / t18 / t205;
  t523 = t157 * t157;
  t526 = t28 * t41;
  t528 = t507 * t526 * t46;
  t534 = t507 * t526 * t89;
  t539 = t320 * t508;
  t544 = t329 * t508;
  t547 = t154 * t76;
  t550 = t298 / t31 / t547;
  t583 = 0.16e2 / 0.2187e4 * t496 * t502 * t509 + 0.5126e4 / 0.729e3 * t170 * t512 * t41 * t173 - 0.3047e4 / 0.486e3 * t87 * t519 * t90 + 0.2e1 / 0.6561e4 * t151 * t502 * t523 * t528 + 0.8e1 / 0.6561e4 * t162 * t502 * t303 * t534 + 0.8e1 / 0.2187e4 * t169 * t502 * t157 * t539 + 0.16e2 / 0.2187e4 * t325 * t502 * params->alpha * t544 - 0.98e2 / 0.2187e4 * t151 * t550 * t303 * t309 - 0.98e2 / 0.729e3 * t162 * t550 * t157 * t315 - 0.196e3 / 0.729e3 * t169 * t550 * params->alpha * t321 + 0.2563e4 / 0.729e3 * t153 * t512 * t157 * t47 + 0.5126e4 / 0.729e3 * t163 * t512 * params->alpha * t90 + 0.2618e4 / 0.243e3 * t27 * t29 / t31 / t76 * t47 - 0.3047e4 / 0.486e3 * t74 * t519 * t81 - 0.196e3 / 0.729e3 * t325 * t550 * t330;
  t588 = my_piecewise3(t2, 0, 0.1e2 / 0.27e2 * t6 * t17 * t63 * t51 - 0.5e1 / 0.9e1 * t6 * t259 * t94 + t6 * t126 * t177 / 0.2e1 - t6 * t57 * t333 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t19 * t583);
  tv4rho40 = 0.2e1 * rho[0] * t588 + 0.8e1 * t338;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t603 = t298 / t18 / t498;
  t663 = -0.2e1 / 0.729e3 * t496 * t603 * t509 + 0.253e3 / 0.162e3 * t191 * t276 * params->alpha * t194 + 0.89e2 / 0.972e3 * t325 * t301 * t41 * t328 * t152 * t314 - 0.1025e4 / 0.486e3 * t169 * t285 * t369 + 0.253e3 / 0.162e3 * t198 * t276 * t41 * t200 - 0.154e3 / 0.81e2 * t42 * t272 - t151 * t603 * t523 * t528 / 0.8748e4 - t162 * t603 * t303 * t534 / 0.2187e4 - t169 * t603 * t157 * t539 / 0.729e3 - 0.2e1 / 0.729e3 * t325 * t603 * params->alpha * t544 + 0.89e2 / 0.5832e4 * t151 * t301 * t303 * t152 * t309 + 0.89e2 / 0.1944e4 * t162 * t301 * t157 * t152 * t315 + 0.89e2 / 0.972e3 * t169 * t301 * params->alpha * t152 * t321 - 0.1025e4 / 0.972e3 * t151 * t285 * t360 - 0.1025e4 / 0.486e3 * t162 * t285 * t365;
  t668 = my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t259 * t117 + t6 * t126 * t221 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t57 * t391 - 0.3e1 / 0.8e1 * t6 * t19 * t663);
  tv4rho3sigma0 = 0.2e1 * rho[0] * t668 + 0.6e1 * t396;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t694 = t152 / t18 / t154 / t139;
  t735 = -0.19e2 / 0.81e2 * t233 * t146 + 0.167e3 / 0.324e3 * t368 * t417 - 0.19e2 / 0.81e2 * t191 * t350 * t47 - 0.25e2 / 0.864e3 * t325 * t374 * t41 * t328 * t72 * t314 + t496 * t694 * t509 / 0.972e3 - 0.25e2 / 0.5184e4 * t151 * t374 * t303 * t72 * t309 - 0.25e2 / 0.1728e4 * t162 * t374 * t157 * t72 * t315 - 0.25e2 / 0.864e3 * t169 * t374 * params->alpha * t41 * t173 * t72 * t314 + t151 * t694 * t523 * t528 / 0.23328e5 + t162 * t694 * t303 * t534 / 0.5832e4 + t169 * t694 * t157 * t539 / 0.1944e4 + t325 * t694 * params->alpha * t544 / 0.972e3 + 0.167e3 / 0.648e3 * t358 * t407 + 0.167e3 / 0.324e3 * t363 * t411;
  t740 = my_piecewise3(t2, 0, t6 * t126 * t252 / 0.12e2 - t6 * t57 * t438 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t19 * t735);
  tv4rho2sigma20 = 0.2e1 * rho[0] * t740 + 0.4e1 * t443;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  t758 = t26 * t29;
  t775 = t328 * t20;
  t781 = t72 / t18 / t547;
  t801 = -t405 * t448 / 0.24e2 + 0.7e1 / 0.5184e4 * t151 * t421 * t303 * t20 * t26 * t308 + 0.7e1 / 0.1728e4 * t162 * t421 * t157 * t41 * t89 * t20 * t758 - t410 * t452 / 0.12e2 + 0.7e1 / 0.864e3 * t169 * t421 * params->alpha * t41 * t173 * t20 * t758 - t169 * t218 / 0.12e2 + 0.7e1 / 0.864e3 * t325 * t421 * t41 * t775 * t758 - t151 * t781 * t523 * t528 / 0.62208e5 - t162 * t781 * t303 * t534 / 0.15552e5 - t169 * t781 * t157 * t539 / 0.5184e4 - t325 * t781 * params->alpha * t544 / 0.2592e4 - t496 * t781 * t509 / 0.2592e4;
  t806 = my_piecewise3(t2, 0, -t6 * t57 * t475 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * t801);
  tv4rhosigma30 = 0.2e1 * rho[0] * t806 + 0.2e1 * t479;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  t829 = sigma[0] / t18 / t299;
  t853 = my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (-t151 * t458 * t303 * t309 / 0.3456e4 - t162 * t458 * t157 * t315 / 0.1152e4 - t169 * t458 * params->alpha * t321 / 0.576e3 - t325 * t458 * t41 * t775 * t25 * t29 / 0.576e3 + t151 * t829 * t523 * t528 / 0.165888e6 + t162 * t829 * t303 * t534 / 0.41472e5 + t169 * t829 * t157 * t539 / 0.13824e5 + t325 * t829 * params->alpha * t544 / 0.6912e4 + t496 * t829 * t509 / 0.6912e4));
  tv4sigma40 = 0.2e1 * rho[0] * t853;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t41, t42, t43, t46, t49, t50, t51, t55;
  double t59, t60, t61, t62, t63, t64, t66, t67;
  double t68, t69, t70, t72, t74, t75, t78, t81;
  double t82, t83, t87, t91, tzk0;

  gga_x_vmt_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->mu * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = params->alpha * t28;
  t42 = t33 * sigma[0];
  t43 = t42 * t39;
  t46 = exp(-t41 * t43 / 0.24e2);
  t49 = 0.1e1 + t29 * t43 / 0.24e2;
  t50 = 0.1e1 / t49;
  t51 = t46 * t50;
  t55 = 0.1e1 + t34 * sigma[0] * t39 * t51 / 0.24e2;
  t59 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = my_piecewise5(t14, t11, t10, t15, -t17);
  t62 = 0.1e1 + t61;
  t63 = t62 <= p->zeta_threshold;
  t64 = POW_1_3(t62);
  t66 = my_piecewise3(t63, t22, t64 * t62);
  t67 = t66 * t26;
  t68 = rho[1] * rho[1];
  t69 = POW_1_3(rho[1]);
  t70 = t69 * t69;
  t72 = 0.1e1 / t70 / t68;
  t74 = t33 * sigma[2];
  t75 = t74 * t72;
  t78 = exp(-t41 * t75 / 0.24e2);
  t81 = 0.1e1 + t29 * t75 / 0.24e2;
  t82 = 0.1e1 / t81;
  t83 = t78 * t82;
  t87 = 0.1e1 + t34 * sigma[2] * t72 * t83 / 0.24e2;
  t91 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t87);
  tzk0 = t59 + t91;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t41, t42, t43, t46, t49, t50, t51, t55;
  double t59, t60, t61, t62, t63, t64, t66, t67;
  double t68, t69, t70, t72, t74, t75, t78, t81;
  double t82, t83, t87, t91, tzk0;

  double t92, t93, t94, t95, t96, t99, t100, t104;
  double t105, t106, t109, t110, t112, t117, t118, t120;
  double t121, t123, t124, t125, t127, t129, t132, t134;
  double t136, t137, t138, t142, t147, t149, t152, t153;
  double t157, t160, t162, tvrho0, t165, t166, t169, t170;
  double t175, t177, t180, t181, t185, t187, t192, t194;
  double t195, t196, t198, t200, t204, t205, t206, t210;
  double t215, tvrho1, t224, t226, t228, t235, t239, tvsigma0;
  double tvsigma1, t246, t248, t250, t257, t261, tvsigma2;

  gga_x_vmt_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->mu * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = params->alpha * t28;
  t42 = t33 * sigma[0];
  t43 = t42 * t39;
  t46 = exp(-t41 * t43 / 0.24e2);
  t49 = 0.1e1 + t29 * t43 / 0.24e2;
  t50 = 0.1e1 / t49;
  t51 = t46 * t50;
  t55 = 0.1e1 + t34 * sigma[0] * t39 * t51 / 0.24e2;
  t59 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = my_piecewise5(t14, t11, t10, t15, -t17);
  t62 = 0.1e1 + t61;
  t63 = t62 <= p->zeta_threshold;
  t64 = POW_1_3(t62);
  t66 = my_piecewise3(t63, t22, t64 * t62);
  t67 = t66 * t26;
  t68 = rho[1] * rho[1];
  t69 = POW_1_3(rho[1]);
  t70 = t69 * t69;
  t72 = 0.1e1 / t70 / t68;
  t74 = t33 * sigma[2];
  t75 = t74 * t72;
  t78 = exp(-t41 * t75 / 0.24e2);
  t81 = 0.1e1 + t29 * t75 / 0.24e2;
  t82 = 0.1e1 / t81;
  t83 = t78 * t82;
  t87 = 0.1e1 + t34 * sigma[2] * t72 * t83 / 0.24e2;
  t91 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t87);
  tzk0 = t59 + t91;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t92 = t6 * t6;
  t93 = 0.1e1 / t92;
  t94 = t16 * t93;
  t95 = t7 - t94;
  t96 = my_piecewise5(t10, 0, t14, 0, t95);
  t99 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t96);
  t100 = t99 * t26;
  t104 = t26 * t26;
  t105 = 0.1e1 / t104;
  t106 = t25 * t105;
  t109 = t5 * t106 * t55 / 0.8e1;
  t110 = t35 * rho[0];
  t112 = 0.1e1 / t37 / t110;
  t117 = t28 * t28;
  t118 = params->mu * t117;
  t120 = 0.1e1 / t31 / t30;
  t121 = sigma[0] * sigma[0];
  t123 = t118 * t120 * t121;
  t124 = t35 * t35;
  t125 = t124 * t35;
  t127 = 0.1e1 / t36 / t125;
  t129 = t127 * params->alpha * t51;
  t132 = params->mu * params->mu;
  t134 = t132 * t117 * t120;
  t136 = t49 * t49;
  t137 = 0.1e1 / t136;
  t138 = t46 * t137;
  t142 = -t34 * sigma[0] * t112 * t51 / 0.9e1 + t123 * t129 / 0.216e3 + t134 * t121 * t127 * t138 / 0.216e3;
  t147 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t142);
  t149 = my_piecewise5(t14, 0, t10, 0, -t95);
  t152 = my_piecewise3(t63, 0, 0.4e1 / 0.3e1 * t64 * t149);
  t153 = t152 * t26;
  t157 = t66 * t105;
  t160 = t5 * t157 * t87 / 0.8e1;
  t162 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t153 * t87 - t160);
  tvrho0 = t59 + t91 + t6 * (t147 + t162);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t165 = -t7 - t94;
  t166 = my_piecewise5(t10, 0, t14, 0, t165);
  t169 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t166);
  t170 = t169 * t26;
  t175 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t55 - t109);
  t177 = my_piecewise5(t14, 0, t10, 0, -t165);
  t180 = my_piecewise3(t63, 0, 0.4e1 / 0.3e1 * t64 * t177);
  t181 = t180 * t26;
  t185 = t68 * rho[1];
  t187 = 0.1e1 / t70 / t185;
  t192 = sigma[2] * sigma[2];
  t194 = t118 * t120 * t192;
  t195 = t68 * t68;
  t196 = t195 * t68;
  t198 = 0.1e1 / t69 / t196;
  t200 = t198 * params->alpha * t83;
  t204 = t81 * t81;
  t205 = 0.1e1 / t204;
  t206 = t78 * t205;
  t210 = -t34 * sigma[2] * t187 * t83 / 0.9e1 + t194 * t200 / 0.216e3 + t134 * t192 * t198 * t206 / 0.216e3;
  t215 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t181 * t87 - t160 - 0.3e1 / 0.8e1 * t5 * t67 * t210);
  tvrho1 = t59 + t91 + t6 * (t175 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t224 = t124 * rho[0];
  t226 = 0.1e1 / t36 / t224;
  t228 = t226 * params->alpha * t51;
  t235 = t34 * t39 * t46 * t50 / 0.24e2 - t118 * t120 * sigma[0] * t228 / 0.576e3 - t134 * sigma[0] * t226 * t138 / 0.576e3;
  t239 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t235);
  tvsigma0 = t6 * t239;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t246 = t195 * rho[1];
  t248 = 0.1e1 / t69 / t246;
  t250 = t248 * params->alpha * t83;
  t257 = t34 * t72 * t78 * t82 / 0.24e2 - t118 * t120 * sigma[2] * t250 / 0.576e3 - t134 * sigma[2] * t248 * t206 / 0.576e3;
  t261 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t257);
  tvsigma2 = t6 * t261;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t41, t42, t43, t46, t49, t50, t51, t55;
  double t59, t60, t61, t62, t63, t64, t66, t67;
  double t68, t69, t70, t72, t74, t75, t78, t81;
  double t82, t83, t87, t91, tzk0;

  double t92, t93, t94, t95, t96, t99, t100, t104;
  double t105, t106, t109, t110, t112, t117, t118, t120;
  double t121, t123, t124, t125, t127, t129, t132, t134;
  double t136, t137, t138, t142, t147, t149, t152, t153;
  double t157, t160, t162, tvrho0, t165, t166, t169, t170;
  double t175, t177, t180, t181, t185, t187, t192, t194;
  double t195, t196, t198, t200, t204, t205, t206, t210;
  double t215, tvrho1, t224, t226, t228, t235, t239, tvsigma0;
  double tvsigma1, t246, t248, t250, t257, t261, tvsigma2;

  double t264, t265, t266, t269, t270, t271, t273, t274;
  double t278, t279, t283, t285, t291, t292, t295, t297;
  double t300, t305, t307, t309, t316, t317, t318, t319;
  double t320, t321, t322, t323, t324, t329, t330, t336;
  double t337, t340, t344, t349, t350, t351, t352, t356;
  double t360, t361, t365, t367, t369, t372, t374, tv2rho20;
  double t377, t380, t381, t385, t386, t390, t392, t400;
  double t401, t404, t408, t409, t413, t415, t422, t425;
  double tv2rho21, t430, t434, t435, t439, t440, t446, t447;
  double t451, t455, t456, t466, t471, t473, t475, t482;
  double t483, t484, t485, t486, t491, t496, t499, t503;
  double t508, tv2rho22, t516, t524, t527, t528, t533, t534;
  double t546, t549, t554, tv2rhosigma0, tv2rhosigma1, t561, t563, tv2rhosigma2;
  double t569, tv2rhosigma3, tv2rhosigma4, t581, t584, t585, t590, t591;
  double t603, t606, t611, tv2rhosigma5, t613, t621, t633, t636;
  double t640, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t648, t660;
  double t663, t667, tv2sigma25;

  gga_x_vmt_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->mu * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = params->alpha * t28;
  t42 = t33 * sigma[0];
  t43 = t42 * t39;
  t46 = exp(-t41 * t43 / 0.24e2);
  t49 = 0.1e1 + t29 * t43 / 0.24e2;
  t50 = 0.1e1 / t49;
  t51 = t46 * t50;
  t55 = 0.1e1 + t34 * sigma[0] * t39 * t51 / 0.24e2;
  t59 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = my_piecewise5(t14, t11, t10, t15, -t17);
  t62 = 0.1e1 + t61;
  t63 = t62 <= p->zeta_threshold;
  t64 = POW_1_3(t62);
  t66 = my_piecewise3(t63, t22, t64 * t62);
  t67 = t66 * t26;
  t68 = rho[1] * rho[1];
  t69 = POW_1_3(rho[1]);
  t70 = t69 * t69;
  t72 = 0.1e1 / t70 / t68;
  t74 = t33 * sigma[2];
  t75 = t74 * t72;
  t78 = exp(-t41 * t75 / 0.24e2);
  t81 = 0.1e1 + t29 * t75 / 0.24e2;
  t82 = 0.1e1 / t81;
  t83 = t78 * t82;
  t87 = 0.1e1 + t34 * sigma[2] * t72 * t83 / 0.24e2;
  t91 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t87);
  tzk0 = t59 + t91;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t92 = t6 * t6;
  t93 = 0.1e1 / t92;
  t94 = t16 * t93;
  t95 = t7 - t94;
  t96 = my_piecewise5(t10, 0, t14, 0, t95);
  t99 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t96);
  t100 = t99 * t26;
  t104 = t26 * t26;
  t105 = 0.1e1 / t104;
  t106 = t25 * t105;
  t109 = t5 * t106 * t55 / 0.8e1;
  t110 = t35 * rho[0];
  t112 = 0.1e1 / t37 / t110;
  t117 = t28 * t28;
  t118 = params->mu * t117;
  t120 = 0.1e1 / t31 / t30;
  t121 = sigma[0] * sigma[0];
  t123 = t118 * t120 * t121;
  t124 = t35 * t35;
  t125 = t124 * t35;
  t127 = 0.1e1 / t36 / t125;
  t129 = t127 * params->alpha * t51;
  t132 = params->mu * params->mu;
  t134 = t132 * t117 * t120;
  t136 = t49 * t49;
  t137 = 0.1e1 / t136;
  t138 = t46 * t137;
  t142 = -t34 * sigma[0] * t112 * t51 / 0.9e1 + t123 * t129 / 0.216e3 + t134 * t121 * t127 * t138 / 0.216e3;
  t147 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t142);
  t149 = my_piecewise5(t14, 0, t10, 0, -t95);
  t152 = my_piecewise3(t63, 0, 0.4e1 / 0.3e1 * t64 * t149);
  t153 = t152 * t26;
  t157 = t66 * t105;
  t160 = t5 * t157 * t87 / 0.8e1;
  t162 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t153 * t87 - t160);
  tvrho0 = t59 + t91 + t6 * (t147 + t162);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t165 = -t7 - t94;
  t166 = my_piecewise5(t10, 0, t14, 0, t165);
  t169 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t166);
  t170 = t169 * t26;
  t175 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t55 - t109);
  t177 = my_piecewise5(t14, 0, t10, 0, -t165);
  t180 = my_piecewise3(t63, 0, 0.4e1 / 0.3e1 * t64 * t177);
  t181 = t180 * t26;
  t185 = t68 * rho[1];
  t187 = 0.1e1 / t70 / t185;
  t192 = sigma[2] * sigma[2];
  t194 = t118 * t120 * t192;
  t195 = t68 * t68;
  t196 = t195 * t68;
  t198 = 0.1e1 / t69 / t196;
  t200 = t198 * params->alpha * t83;
  t204 = t81 * t81;
  t205 = 0.1e1 / t204;
  t206 = t78 * t205;
  t210 = -t34 * sigma[2] * t187 * t83 / 0.9e1 + t194 * t200 / 0.216e3 + t134 * t192 * t198 * t206 / 0.216e3;
  t215 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t181 * t87 - t160 - 0.3e1 / 0.8e1 * t5 * t67 * t210);
  tvrho1 = t59 + t91 + t6 * (t175 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t224 = t124 * rho[0];
  t226 = 0.1e1 / t36 / t224;
  t228 = t226 * params->alpha * t51;
  t235 = t34 * t39 * t46 * t50 / 0.24e2 - t118 * t120 * sigma[0] * t228 / 0.576e3 - t134 * sigma[0] * t226 * t138 / 0.576e3;
  t239 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t235);
  tvsigma0 = t6 * t239;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t246 = t195 * rho[1];
  t248 = 0.1e1 / t69 / t246;
  t250 = t248 * params->alpha * t83;
  t257 = t34 * t72 * t78 * t82 / 0.24e2 - t118 * t120 * sigma[2] * t250 / 0.576e3 - t134 * sigma[2] * t248 * t206 / 0.576e3;
  t261 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t257);
  tvsigma2 = t6 * t261;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t264 = t23 * t23;
  t265 = 0.1e1 / t264;
  t266 = t96 * t96;
  t269 = t92 * t6;
  t270 = 0.1e1 / t269;
  t271 = t16 * t270;
  t273 = -0.2e1 * t93 + 0.2e1 * t271;
  t274 = my_piecewise5(t10, 0, t14, 0, t273);
  t278 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t266 + 0.4e1 / 0.3e1 * t23 * t274);
  t279 = t278 * t26;
  t283 = t99 * t105;
  t285 = t5 * t283 * t55;
  t291 = 0.1e1 / t104 / t6;
  t292 = t25 * t291;
  t295 = t5 * t292 * t55 / 0.12e2;
  t297 = t5 * t106 * t142;
  t300 = 0.1e1 / t37 / t124;
  t305 = t124 * t110;
  t307 = 0.1e1 / t36 / t305;
  t309 = t307 * params->alpha * t51;
  t316 = t30 * t30;
  t317 = 0.1e1 / t316;
  t318 = params->mu * t317;
  t319 = t121 * sigma[0];
  t320 = t318 * t319;
  t321 = t124 * t124;
  t322 = t321 * t35;
  t323 = 0.1e1 / t322;
  t324 = params->alpha * params->alpha;
  t329 = t132 * t317;
  t330 = t329 * t319;
  t336 = t132 * params->mu * t317;
  t337 = t336 * t319;
  t340 = 0.1e1 / t136 / t49;
  t344 = 0.11e2 / 0.27e2 * t34 * sigma[0] * t300 * t51 - t123 * t309 / 0.24e2 - t134 * t121 * t307 * t138 / 0.24e2 + t320 * t323 * t324 * t51 / 0.324e3 + t330 * t323 * params->alpha * t138 / 0.162e3 + t337 * t323 * t46 * t340 / 0.162e3;
  t349 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t279 * t55 - t285 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t100 * t142 + t295 - t297 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t344);
  t350 = t64 * t64;
  t351 = 0.1e1 / t350;
  t352 = t149 * t149;
  t356 = my_piecewise5(t14, 0, t10, 0, -t273);
  t360 = my_piecewise3(t63, 0, 0.4e1 / 0.9e1 * t351 * t352 + 0.4e1 / 0.3e1 * t64 * t356);
  t361 = t360 * t26;
  t365 = t152 * t105;
  t367 = t5 * t365 * t87;
  t369 = t66 * t291;
  t372 = t5 * t369 * t87 / 0.12e2;
  t374 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t361 * t87 - t367 / 0.4e1 + t372);
  tv2rho20 = 0.2e1 * t147 + 0.2e1 * t162 + t6 * (t349 + t374);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t377 = t265 * t166;
  t380 = 0.2e1 * t271;
  t381 = my_piecewise5(t10, 0, t14, 0, t380);
  t385 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t377 * t96 + 0.4e1 / 0.3e1 * t23 * t381);
  t386 = t385 * t26;
  t390 = t169 * t105;
  t392 = t5 * t390 * t55;
  t400 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t386 * t55 - t392 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t170 * t142 - t285 / 0.8e1 + t295 - t297 / 0.8e1);
  t401 = t351 * t177;
  t404 = my_piecewise5(t14, 0, t10, 0, -t380);
  t408 = my_piecewise3(t63, 0, 0.4e1 / 0.9e1 * t401 * t149 + 0.4e1 / 0.3e1 * t64 * t404);
  t409 = t408 * t26;
  t413 = t180 * t105;
  t415 = t5 * t413 * t87;
  t422 = t5 * t157 * t210;
  t425 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t409 * t87 - t415 / 0.8e1 - t367 / 0.8e1 + t372 - 0.3e1 / 0.8e1 * t5 * t153 * t210 - t422 / 0.8e1);
  tv2rho21 = t147 + t162 + t175 + t215 + t6 * (t400 + t425);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t430 = t166 * t166;
  t434 = 0.2e1 * t93 + 0.2e1 * t271;
  t435 = my_piecewise5(t10, 0, t14, 0, t434);
  t439 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t430 + 0.4e1 / 0.3e1 * t23 * t435);
  t440 = t439 * t26;
  t446 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t440 * t55 - t392 / 0.4e1 + t295);
  t447 = t177 * t177;
  t451 = my_piecewise5(t14, 0, t10, 0, -t434);
  t455 = my_piecewise3(t63, 0, 0.4e1 / 0.9e1 * t351 * t447 + 0.4e1 / 0.3e1 * t64 * t451);
  t456 = t455 * t26;
  t466 = 0.1e1 / t70 / t195;
  t471 = t195 * t185;
  t473 = 0.1e1 / t69 / t471;
  t475 = t473 * params->alpha * t83;
  t482 = t192 * sigma[2];
  t483 = t318 * t482;
  t484 = t195 * t195;
  t485 = t484 * t68;
  t486 = 0.1e1 / t485;
  t491 = t329 * t482;
  t496 = t336 * t482;
  t499 = 0.1e1 / t204 / t81;
  t503 = 0.11e2 / 0.27e2 * t34 * sigma[2] * t466 * t83 - t194 * t475 / 0.24e2 - t134 * t192 * t473 * t206 / 0.24e2 + t483 * t486 * t324 * t83 / 0.324e3 + t491 * t486 * params->alpha * t206 / 0.162e3 + t496 * t486 * t78 * t499 / 0.162e3;
  t508 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t456 * t87 - t415 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t181 * t210 + t372 - t422 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t67 * t503);
  tv2rho22 = 0.2e1 * t175 + 0.2e1 * t215 + t6 * (t446 + t508);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t516 = t5 * t106 * t235 / 0.8e1;
  t524 = params->alpha * sigma[0] * t51;
  t527 = t127 * t46;
  t528 = t137 * sigma[0];
  t533 = t321 * rho[0];
  t534 = 0.1e1 / t533;
  t546 = t534 * t46 * t340;
  t549 = -t34 * t112 * t46 * t50 / 0.9e1 + t118 * t120 * t127 * t524 / 0.72e2 + t134 * t527 * t528 / 0.72e2 - t318 * t121 * t534 * t324 * t51 / 0.864e3 - t329 * t121 * t534 * params->alpha * t138 / 0.432e3 - t336 * t121 * t546 / 0.432e3;
  t554 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t235 - t516 - 0.3e1 / 0.8e1 * t5 * t27 * t549);
  tv2rhosigma0 = t6 * t554 + t239;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t561 = t5 * t157 * t257 / 0.8e1;
  t563 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t153 * t257 - t561);
  tv2rhosigma2 = t6 * t563 + t261;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t569 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t235 - t516);
  tv2rhosigma3 = t6 * t569 + t239;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t581 = params->alpha * sigma[2] * t83;
  t584 = t198 * t78;
  t585 = t205 * sigma[2];
  t590 = t484 * rho[1];
  t591 = 0.1e1 / t590;
  t603 = t591 * t78 * t499;
  t606 = -t34 * t187 * t78 * t82 / 0.9e1 + t118 * t120 * t198 * t581 / 0.72e2 + t134 * t584 * t585 / 0.72e2 - t318 * t192 * t591 * t324 * t83 / 0.864e3 - t329 * t192 * t591 * params->alpha * t206 / 0.432e3 - t336 * t192 * t603 / 0.432e3;
  t611 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t181 * t257 - t561 - 0.3e1 / 0.8e1 * t5 * t67 * t606);
  tv2rhosigma5 = t6 * t611 + t261;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t613 = t118 * t120;
  t621 = 0.1e1 / t321;
  t633 = t621 * t46 * t340;
  t636 = -t613 * t228 / 0.288e3 - t134 * t226 * t46 * t137 / 0.288e3 + t318 * sigma[0] * t621 * t324 * t51 / 0.2304e4 + t329 * sigma[0] * t621 * params->alpha * t138 / 0.1152e4 + t336 * sigma[0] * t633 / 0.1152e4;
  t640 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t636);
  tv2sigma20 = t6 * t640;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t648 = 0.1e1 / t484;
  t660 = t648 * t78 * t499;
  t663 = -t613 * t250 / 0.288e3 - t134 * t248 * t78 * t205 / 0.288e3 + t318 * sigma[2] * t648 * t324 * t83 / 0.2304e4 + t329 * sigma[2] * t648 * params->alpha * t206 / 0.1152e4 + t336 * sigma[2] * t660 / 0.1152e4;
  t667 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t663);
  tv2sigma25 = t6 * t667;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t41, t42, t43, t46, t49, t50, t51, t55;
  double t59, t60, t61, t62, t63, t64, t66, t67;
  double t68, t69, t70, t72, t74, t75, t78, t81;
  double t82, t83, t87, t91, tzk0;

  double t92, t93, t94, t95, t96, t99, t100, t104;
  double t105, t106, t109, t110, t112, t117, t118, t120;
  double t121, t123, t124, t125, t127, t129, t132, t134;
  double t136, t137, t138, t142, t147, t149, t152, t153;
  double t157, t160, t162, tvrho0, t165, t166, t169, t170;
  double t175, t177, t180, t181, t185, t187, t192, t194;
  double t195, t196, t198, t200, t204, t205, t206, t210;
  double t215, tvrho1, t224, t226, t228, t235, t239, tvsigma0;
  double tvsigma1, t246, t248, t250, t257, t261, tvsigma2;

  double t264, t265, t266, t269, t270, t271, t273, t274;
  double t278, t279, t283, t285, t291, t292, t295, t297;
  double t300, t305, t307, t309, t316, t317, t318, t319;
  double t320, t321, t322, t323, t324, t329, t330, t336;
  double t337, t340, t344, t349, t350, t351, t352, t356;
  double t360, t361, t365, t367, t369, t372, t374, tv2rho20;
  double t377, t380, t381, t385, t386, t390, t392, t400;
  double t401, t404, t408, t409, t413, t415, t422, t425;
  double tv2rho21, t430, t434, t435, t439, t440, t446, t447;
  double t451, t455, t456, t466, t471, t473, t475, t482;
  double t483, t484, t485, t486, t491, t496, t499, t503;
  double t508, tv2rho22, t516, t524, t527, t528, t533, t534;
  double t546, t549, t554, tv2rhosigma0, tv2rhosigma1, t561, t563, tv2rhosigma2;
  double t569, tv2rhosigma3, tv2rhosigma4, t581, t584, t585, t590, t591;
  double t603, t606, t611, tv2rhosigma5, t613, t621, t633, t636;
  double t640, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t648, t660;
  double t663, t667, tv2sigma25;

  double t671, t672, t675, t678, t679, t680, t682, t683;
  double t687, t688, t692, t694, t699, t701, t704, t710;
  double t711, t714, t716, t719, t722, t728, t737, t738;
  double t751, t752, t754, t755, t757, t758, t760, t761;
  double t765, t767, t768, t772, t774, t775, t778, t779;
  double t781, t782, t784, t785, t788, t793, t795, t796;
  double t799, t803, t807, t808, t812, t814, t816, t818;
  double t820, t823, t825, tv3rho30, t828, t829, t830, t833;
  double t838, t839, t840, t841, t845, t846, t850, t853;
  double t857, t859, t863, t872, t873, t874, t877, t883;
  double t887, t888, t892, t895, t896, t898, t907, t909;
  double t912, tv3rho31, t915, t920, t923, t924, t928, t929;
  double t933, t935, t944, t945, t950, t954, t958, t959;
  double t963, t965, t972, t980, t982, t983, tv3rho32, t988;
  double t994, t995, t999, t1000, t1007, t1008, t1014, t1018;
  double t1019, t1035, t1041, t1050, t1051, t1064, t1065, t1067;
  double t1068, t1071, t1072, t1076, t1078, t1079, t1083, t1085;
  double t1086, t1090, t1091, t1093, t1096, t1101, tv3rho33, t1109;
  double t1116, t1118, t1128, t1132, t1134, t1137, t1139, t1142;
  double t1143, t1144, t1147, t1149, t1150, t1163, t1168, tv3rho2sigma0;
  double tv3rho2sigma1, t1175, t1179, t1181, tv3rho2sigma2, t1187, t1195, tv3rho2sigma3;
  double tv3rho2sigma4, t1201, t1208, t1211, tv3rho2sigma5, t1219, tv3rho2sigma6, tv3rho2sigma7;
  double t1238, t1242, t1244, t1247, t1249, t1252, t1253, t1254;
  double t1257, t1259, t1260, t1273, t1278, tv3rho2sigma8, t1285, t1288;
  double t1290, t1293, t1294, t1301, t1305, t1306, t1319, t1324;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1331, t1333, tv3rhosigma25;
  double t1339, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1346, t1348;
  double t1351, t1352, t1359, t1363, t1364, t1377, t1382, tv3rhosigma211;
  double t1385, t1389, t1395, t1396, t1409, t1413, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1415;
  double t1419, t1425, t1426, t1439, t1443, tv3sigma39;

  gga_x_vmt_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->mu * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = params->alpha * t28;
  t42 = t33 * sigma[0];
  t43 = t42 * t39;
  t46 = exp(-t41 * t43 / 0.24e2);
  t49 = 0.1e1 + t29 * t43 / 0.24e2;
  t50 = 0.1e1 / t49;
  t51 = t46 * t50;
  t55 = 0.1e1 + t34 * sigma[0] * t39 * t51 / 0.24e2;
  t59 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = my_piecewise5(t14, t11, t10, t15, -t17);
  t62 = 0.1e1 + t61;
  t63 = t62 <= p->zeta_threshold;
  t64 = POW_1_3(t62);
  t66 = my_piecewise3(t63, t22, t64 * t62);
  t67 = t66 * t26;
  t68 = rho[1] * rho[1];
  t69 = POW_1_3(rho[1]);
  t70 = t69 * t69;
  t72 = 0.1e1 / t70 / t68;
  t74 = t33 * sigma[2];
  t75 = t74 * t72;
  t78 = exp(-t41 * t75 / 0.24e2);
  t81 = 0.1e1 + t29 * t75 / 0.24e2;
  t82 = 0.1e1 / t81;
  t83 = t78 * t82;
  t87 = 0.1e1 + t34 * sigma[2] * t72 * t83 / 0.24e2;
  t91 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t87);
  tzk0 = t59 + t91;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t92 = t6 * t6;
  t93 = 0.1e1 / t92;
  t94 = t16 * t93;
  t95 = t7 - t94;
  t96 = my_piecewise5(t10, 0, t14, 0, t95);
  t99 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t96);
  t100 = t99 * t26;
  t104 = t26 * t26;
  t105 = 0.1e1 / t104;
  t106 = t25 * t105;
  t109 = t5 * t106 * t55 / 0.8e1;
  t110 = t35 * rho[0];
  t112 = 0.1e1 / t37 / t110;
  t117 = t28 * t28;
  t118 = params->mu * t117;
  t120 = 0.1e1 / t31 / t30;
  t121 = sigma[0] * sigma[0];
  t123 = t118 * t120 * t121;
  t124 = t35 * t35;
  t125 = t124 * t35;
  t127 = 0.1e1 / t36 / t125;
  t129 = t127 * params->alpha * t51;
  t132 = params->mu * params->mu;
  t134 = t132 * t117 * t120;
  t136 = t49 * t49;
  t137 = 0.1e1 / t136;
  t138 = t46 * t137;
  t142 = -t34 * sigma[0] * t112 * t51 / 0.9e1 + t123 * t129 / 0.216e3 + t134 * t121 * t127 * t138 / 0.216e3;
  t147 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t142);
  t149 = my_piecewise5(t14, 0, t10, 0, -t95);
  t152 = my_piecewise3(t63, 0, 0.4e1 / 0.3e1 * t64 * t149);
  t153 = t152 * t26;
  t157 = t66 * t105;
  t160 = t5 * t157 * t87 / 0.8e1;
  t162 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t153 * t87 - t160);
  tvrho0 = t59 + t91 + t6 * (t147 + t162);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t165 = -t7 - t94;
  t166 = my_piecewise5(t10, 0, t14, 0, t165);
  t169 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t166);
  t170 = t169 * t26;
  t175 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t55 - t109);
  t177 = my_piecewise5(t14, 0, t10, 0, -t165);
  t180 = my_piecewise3(t63, 0, 0.4e1 / 0.3e1 * t64 * t177);
  t181 = t180 * t26;
  t185 = t68 * rho[1];
  t187 = 0.1e1 / t70 / t185;
  t192 = sigma[2] * sigma[2];
  t194 = t118 * t120 * t192;
  t195 = t68 * t68;
  t196 = t195 * t68;
  t198 = 0.1e1 / t69 / t196;
  t200 = t198 * params->alpha * t83;
  t204 = t81 * t81;
  t205 = 0.1e1 / t204;
  t206 = t78 * t205;
  t210 = -t34 * sigma[2] * t187 * t83 / 0.9e1 + t194 * t200 / 0.216e3 + t134 * t192 * t198 * t206 / 0.216e3;
  t215 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t181 * t87 - t160 - 0.3e1 / 0.8e1 * t5 * t67 * t210);
  tvrho1 = t59 + t91 + t6 * (t175 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t224 = t124 * rho[0];
  t226 = 0.1e1 / t36 / t224;
  t228 = t226 * params->alpha * t51;
  t235 = t34 * t39 * t46 * t50 / 0.24e2 - t118 * t120 * sigma[0] * t228 / 0.576e3 - t134 * sigma[0] * t226 * t138 / 0.576e3;
  t239 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t235);
  tvsigma0 = t6 * t239;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t246 = t195 * rho[1];
  t248 = 0.1e1 / t69 / t246;
  t250 = t248 * params->alpha * t83;
  t257 = t34 * t72 * t78 * t82 / 0.24e2 - t118 * t120 * sigma[2] * t250 / 0.576e3 - t134 * sigma[2] * t248 * t206 / 0.576e3;
  t261 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t257);
  tvsigma2 = t6 * t261;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t264 = t23 * t23;
  t265 = 0.1e1 / t264;
  t266 = t96 * t96;
  t269 = t92 * t6;
  t270 = 0.1e1 / t269;
  t271 = t16 * t270;
  t273 = -0.2e1 * t93 + 0.2e1 * t271;
  t274 = my_piecewise5(t10, 0, t14, 0, t273);
  t278 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t266 + 0.4e1 / 0.3e1 * t23 * t274);
  t279 = t278 * t26;
  t283 = t99 * t105;
  t285 = t5 * t283 * t55;
  t291 = 0.1e1 / t104 / t6;
  t292 = t25 * t291;
  t295 = t5 * t292 * t55 / 0.12e2;
  t297 = t5 * t106 * t142;
  t300 = 0.1e1 / t37 / t124;
  t305 = t124 * t110;
  t307 = 0.1e1 / t36 / t305;
  t309 = t307 * params->alpha * t51;
  t316 = t30 * t30;
  t317 = 0.1e1 / t316;
  t318 = params->mu * t317;
  t319 = t121 * sigma[0];
  t320 = t318 * t319;
  t321 = t124 * t124;
  t322 = t321 * t35;
  t323 = 0.1e1 / t322;
  t324 = params->alpha * params->alpha;
  t329 = t132 * t317;
  t330 = t329 * t319;
  t336 = t132 * params->mu * t317;
  t337 = t336 * t319;
  t340 = 0.1e1 / t136 / t49;
  t344 = 0.11e2 / 0.27e2 * t34 * sigma[0] * t300 * t51 - t123 * t309 / 0.24e2 - t134 * t121 * t307 * t138 / 0.24e2 + t320 * t323 * t324 * t51 / 0.324e3 + t330 * t323 * params->alpha * t138 / 0.162e3 + t337 * t323 * t46 * t340 / 0.162e3;
  t349 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t279 * t55 - t285 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t100 * t142 + t295 - t297 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t344);
  t350 = t64 * t64;
  t351 = 0.1e1 / t350;
  t352 = t149 * t149;
  t356 = my_piecewise5(t14, 0, t10, 0, -t273);
  t360 = my_piecewise3(t63, 0, 0.4e1 / 0.9e1 * t351 * t352 + 0.4e1 / 0.3e1 * t64 * t356);
  t361 = t360 * t26;
  t365 = t152 * t105;
  t367 = t5 * t365 * t87;
  t369 = t66 * t291;
  t372 = t5 * t369 * t87 / 0.12e2;
  t374 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t361 * t87 - t367 / 0.4e1 + t372);
  tv2rho20 = 0.2e1 * t147 + 0.2e1 * t162 + t6 * (t349 + t374);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t377 = t265 * t166;
  t380 = 0.2e1 * t271;
  t381 = my_piecewise5(t10, 0, t14, 0, t380);
  t385 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t377 * t96 + 0.4e1 / 0.3e1 * t23 * t381);
  t386 = t385 * t26;
  t390 = t169 * t105;
  t392 = t5 * t390 * t55;
  t400 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t386 * t55 - t392 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t170 * t142 - t285 / 0.8e1 + t295 - t297 / 0.8e1);
  t401 = t351 * t177;
  t404 = my_piecewise5(t14, 0, t10, 0, -t380);
  t408 = my_piecewise3(t63, 0, 0.4e1 / 0.9e1 * t401 * t149 + 0.4e1 / 0.3e1 * t64 * t404);
  t409 = t408 * t26;
  t413 = t180 * t105;
  t415 = t5 * t413 * t87;
  t422 = t5 * t157 * t210;
  t425 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t409 * t87 - t415 / 0.8e1 - t367 / 0.8e1 + t372 - 0.3e1 / 0.8e1 * t5 * t153 * t210 - t422 / 0.8e1);
  tv2rho21 = t147 + t162 + t175 + t215 + t6 * (t400 + t425);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t430 = t166 * t166;
  t434 = 0.2e1 * t93 + 0.2e1 * t271;
  t435 = my_piecewise5(t10, 0, t14, 0, t434);
  t439 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t430 + 0.4e1 / 0.3e1 * t23 * t435);
  t440 = t439 * t26;
  t446 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t440 * t55 - t392 / 0.4e1 + t295);
  t447 = t177 * t177;
  t451 = my_piecewise5(t14, 0, t10, 0, -t434);
  t455 = my_piecewise3(t63, 0, 0.4e1 / 0.9e1 * t351 * t447 + 0.4e1 / 0.3e1 * t64 * t451);
  t456 = t455 * t26;
  t466 = 0.1e1 / t70 / t195;
  t471 = t195 * t185;
  t473 = 0.1e1 / t69 / t471;
  t475 = t473 * params->alpha * t83;
  t482 = t192 * sigma[2];
  t483 = t318 * t482;
  t484 = t195 * t195;
  t485 = t484 * t68;
  t486 = 0.1e1 / t485;
  t491 = t329 * t482;
  t496 = t336 * t482;
  t499 = 0.1e1 / t204 / t81;
  t503 = 0.11e2 / 0.27e2 * t34 * sigma[2] * t466 * t83 - t194 * t475 / 0.24e2 - t134 * t192 * t473 * t206 / 0.24e2 + t483 * t486 * t324 * t83 / 0.324e3 + t491 * t486 * params->alpha * t206 / 0.162e3 + t496 * t486 * t78 * t499 / 0.162e3;
  t508 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t456 * t87 - t415 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t181 * t210 + t372 - t422 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t67 * t503);
  tv2rho22 = 0.2e1 * t175 + 0.2e1 * t215 + t6 * (t446 + t508);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t516 = t5 * t106 * t235 / 0.8e1;
  t524 = params->alpha * sigma[0] * t51;
  t527 = t127 * t46;
  t528 = t137 * sigma[0];
  t533 = t321 * rho[0];
  t534 = 0.1e1 / t533;
  t546 = t534 * t46 * t340;
  t549 = -t34 * t112 * t46 * t50 / 0.9e1 + t118 * t120 * t127 * t524 / 0.72e2 + t134 * t527 * t528 / 0.72e2 - t318 * t121 * t534 * t324 * t51 / 0.864e3 - t329 * t121 * t534 * params->alpha * t138 / 0.432e3 - t336 * t121 * t546 / 0.432e3;
  t554 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t235 - t516 - 0.3e1 / 0.8e1 * t5 * t27 * t549);
  tv2rhosigma0 = t6 * t554 + t239;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t561 = t5 * t157 * t257 / 0.8e1;
  t563 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t153 * t257 - t561);
  tv2rhosigma2 = t6 * t563 + t261;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t569 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t235 - t516);
  tv2rhosigma3 = t6 * t569 + t239;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t581 = params->alpha * sigma[2] * t83;
  t584 = t198 * t78;
  t585 = t205 * sigma[2];
  t590 = t484 * rho[1];
  t591 = 0.1e1 / t590;
  t603 = t591 * t78 * t499;
  t606 = -t34 * t187 * t78 * t82 / 0.9e1 + t118 * t120 * t198 * t581 / 0.72e2 + t134 * t584 * t585 / 0.72e2 - t318 * t192 * t591 * t324 * t83 / 0.864e3 - t329 * t192 * t591 * params->alpha * t206 / 0.432e3 - t336 * t192 * t603 / 0.432e3;
  t611 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t181 * t257 - t561 - 0.3e1 / 0.8e1 * t5 * t67 * t606);
  tv2rhosigma5 = t6 * t611 + t261;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t613 = t118 * t120;
  t621 = 0.1e1 / t321;
  t633 = t621 * t46 * t340;
  t636 = -t613 * t228 / 0.288e3 - t134 * t226 * t46 * t137 / 0.288e3 + t318 * sigma[0] * t621 * t324 * t51 / 0.2304e4 + t329 * sigma[0] * t621 * params->alpha * t138 / 0.1152e4 + t336 * sigma[0] * t633 / 0.1152e4;
  t640 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t636);
  tv2sigma20 = t6 * t640;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t648 = 0.1e1 / t484;
  t660 = t648 * t78 * t499;
  t663 = -t613 * t250 / 0.288e3 - t134 * t248 * t78 * t205 / 0.288e3 + t318 * sigma[2] * t648 * t324 * t83 / 0.2304e4 + t329 * sigma[2] * t648 * params->alpha * t206 / 0.1152e4 + t336 * sigma[2] * t660 / 0.1152e4;
  t667 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t663);
  tv2sigma25 = t6 * t667;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t671 = 0.1e1 / t264 / t19;
  t672 = t266 * t96;
  t675 = t265 * t96;
  t678 = t92 * t92;
  t679 = 0.1e1 / t678;
  t680 = t16 * t679;
  t682 = 0.6e1 * t270 - 0.6e1 * t680;
  t683 = my_piecewise5(t10, 0, t14, 0, t682);
  t687 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t671 * t672 + 0.4e1 / 0.3e1 * t675 * t274 + 0.4e1 / 0.3e1 * t23 * t683);
  t688 = t687 * t26;
  t692 = t278 * t105;
  t694 = t5 * t692 * t55;
  t699 = t99 * t291;
  t701 = t5 * t699 * t55;
  t704 = t5 * t283 * t142;
  t710 = 0.1e1 / t104 / t92;
  t711 = t25 * t710;
  t714 = 0.5e1 / 0.36e2 * t5 * t711 * t55;
  t716 = t5 * t292 * t142;
  t719 = t5 * t106 * t344;
  t722 = 0.1e1 / t37 / t224;
  t728 = 0.1e1 / t36 / t321;
  t737 = t321 * t110;
  t738 = 0.1e1 / t737;
  t751 = t121 * t121;
  t752 = t321 * t224;
  t754 = 0.1e1 / t37 / t752;
  t755 = t751 * t754;
  t757 = t324 * params->alpha;
  t758 = t757 * t28;
  t760 = t33 * t46 * t50;
  t761 = t758 * t760;
  t765 = t324 * t46;
  t767 = t137 * t28 * t33;
  t768 = t765 * t767;
  t772 = params->alpha * t46;
  t774 = t340 * t28 * t33;
  t775 = t772 * t774;
  t778 = t132 * t132;
  t779 = t778 * t317;
  t781 = t136 * t136;
  t782 = 0.1e1 / t781;
  t784 = t28 * t33;
  t785 = t46 * t782 * t784;
  t788 = -0.154e3 / 0.81e2 * t34 * sigma[0] * t722 * t51 + 0.341e3 / 0.972e3 * t123 * t728 * params->alpha * t51 + 0.341e3 / 0.972e3 * t134 * t121 * t728 * t138 - 0.19e2 / 0.324e3 * t320 * t738 * t324 * t51 - 0.19e2 / 0.162e3 * t330 * t738 * params->alpha * t138 - 0.19e2 / 0.162e3 * t337 * t738 * t46 * t340 + t318 * t755 * t761 / 0.2916e4 + t329 * t755 * t768 / 0.972e3 + t336 * t755 * t775 / 0.486e3 + t779 * t755 * t785 / 0.486e3;
  t793 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t688 * t55 - 0.3e1 / 0.8e1 * t694 - 0.9e1 / 0.8e1 * t5 * t279 * t142 + t701 / 0.4e1 - 0.3e1 / 0.4e1 * t704 - 0.9e1 / 0.8e1 * t5 * t100 * t344 - t714 + t716 / 0.4e1 - 0.3e1 / 0.8e1 * t719 - 0.3e1 / 0.8e1 * t5 * t27 * t788);
  t795 = 0.1e1 / t350 / t62;
  t796 = t352 * t149;
  t799 = t351 * t149;
  t803 = my_piecewise5(t14, 0, t10, 0, -t682);
  t807 = my_piecewise3(t63, 0, -0.8e1 / 0.27e2 * t795 * t796 + 0.4e1 / 0.3e1 * t799 * t356 + 0.4e1 / 0.3e1 * t64 * t803);
  t808 = t807 * t26;
  t812 = t360 * t105;
  t814 = t5 * t812 * t87;
  t816 = t152 * t291;
  t818 = t5 * t816 * t87;
  t820 = t66 * t710;
  t823 = 0.5e1 / 0.36e2 * t5 * t820 * t87;
  t825 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t808 * t87 - 0.3e1 / 0.8e1 * t814 + t818 / 0.4e1 - t823);
  tv3rho30 = 0.3e1 * t349 + 0.3e1 * t374 + t6 * (t793 + t825);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t828 = 0.2e1 * t400;
  t829 = 0.2e1 * t425;
  t830 = t671 * t166;
  t833 = t265 * t381;
  t838 = 0.2e1 * t270;
  t839 = 0.6e1 * t680;
  t840 = t838 - t839;
  t841 = my_piecewise5(t10, 0, t14, 0, t840);
  t845 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t830 * t266 + 0.8e1 / 0.9e1 * t833 * t96 + 0.4e1 / 0.9e1 * t377 * t274 + 0.4e1 / 0.3e1 * t23 * t841);
  t846 = t845 * t26;
  t850 = t385 * t105;
  t853 = t5 * t850 * t55 / 0.4e1;
  t857 = t169 * t291;
  t859 = t5 * t857 * t55;
  t863 = t5 * t390 * t142 / 0.4e1;
  t872 = -0.3e1 / 0.8e1 * t5 * t846 * t55 - t853 - 0.3e1 / 0.4e1 * t5 * t386 * t142 + t859 / 0.12e2 - t863 - 0.3e1 / 0.8e1 * t5 * t170 * t344 - t694 / 0.8e1 + t701 / 0.6e1 - t704 / 0.4e1 - t714 + t716 / 0.6e1 - t719 / 0.8e1;
  t873 = my_piecewise3(t1, 0, t872);
  t874 = t795 * t177;
  t877 = t351 * t404;
  t883 = my_piecewise5(t14, 0, t10, 0, -t840);
  t887 = my_piecewise3(t63, 0, -0.8e1 / 0.27e2 * t874 * t352 + 0.8e1 / 0.9e1 * t877 * t149 + 0.4e1 / 0.9e1 * t401 * t356 + 0.4e1 / 0.3e1 * t64 * t883);
  t888 = t887 * t26;
  t892 = t408 * t105;
  t895 = t5 * t892 * t87 / 0.4e1;
  t896 = t180 * t291;
  t898 = t5 * t896 * t87;
  t907 = t5 * t365 * t210 / 0.4e1;
  t909 = t5 * t369 * t210;
  t912 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t888 * t87 - t895 + t898 / 0.12e2 - t814 / 0.8e1 + t818 / 0.6e1 - t823 - 0.3e1 / 0.8e1 * t5 * t361 * t210 - t907 + t909 / 0.12e2);
  tv3rho31 = t349 + t374 + t828 + t829 + t6 * (t873 + t912);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t915 = t671 * t430;
  t920 = t265 * t435;
  t923 = -t838 - t839;
  t924 = my_piecewise5(t10, 0, t14, 0, t923);
  t928 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t915 * t96 + 0.8e1 / 0.9e1 * t377 * t381 + 0.4e1 / 0.9e1 * t920 * t96 + 0.4e1 / 0.3e1 * t23 * t924);
  t929 = t928 * t26;
  t933 = t439 * t105;
  t935 = t5 * t933 * t55;
  t944 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t929 * t55 - t935 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t440 * t142 - t853 + t859 / 0.6e1 - t863 + t701 / 0.12e2 - t714 + t716 / 0.12e2);
  t945 = t795 * t447;
  t950 = t351 * t451;
  t954 = my_piecewise5(t14, 0, t10, 0, -t923);
  t958 = my_piecewise3(t63, 0, -0.8e1 / 0.27e2 * t945 * t149 + 0.8e1 / 0.9e1 * t401 * t404 + 0.4e1 / 0.9e1 * t950 * t149 + 0.4e1 / 0.3e1 * t64 * t954);
  t959 = t958 * t26;
  t963 = t455 * t105;
  t965 = t5 * t963 * t87;
  t972 = t5 * t413 * t210;
  t980 = t5 * t157 * t503;
  t982 = -0.3e1 / 0.8e1 * t5 * t959 * t87 - t965 / 0.8e1 - t895 + t898 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t409 * t210 - t972 / 0.4e1 + t818 / 0.12e2 - t823 - t907 + t909 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t153 * t503 - t980 / 0.8e1;
  t983 = my_piecewise3(t60, 0, t982);
  tv3rho32 = t828 + t829 + t446 + t508 + t6 * (t944 + t983);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t988 = t430 * t166;
  t994 = -0.6e1 * t270 - 0.6e1 * t680;
  t995 = my_piecewise5(t10, 0, t14, 0, t994);
  t999 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t671 * t988 + 0.4e1 / 0.3e1 * t377 * t435 + 0.4e1 / 0.3e1 * t23 * t995);
  t1000 = t999 * t26;
  t1007 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1000 * t55 - 0.3e1 / 0.8e1 * t935 + t859 / 0.4e1 - t714);
  t1008 = t447 * t177;
  t1014 = my_piecewise5(t14, 0, t10, 0, -t994);
  t1018 = my_piecewise3(t63, 0, -0.8e1 / 0.27e2 * t795 * t1008 + 0.4e1 / 0.3e1 * t401 * t451 + 0.4e1 / 0.3e1 * t64 * t1014);
  t1019 = t1018 * t26;
  t1035 = 0.1e1 / t70 / t246;
  t1041 = 0.1e1 / t69 / t484;
  t1050 = t484 * t185;
  t1051 = 0.1e1 / t1050;
  t1064 = t192 * t192;
  t1065 = t484 * t246;
  t1067 = 0.1e1 / t70 / t1065;
  t1068 = t1064 * t1067;
  t1071 = t33 * t78 * t82;
  t1072 = t758 * t1071;
  t1076 = t324 * t78;
  t1078 = t205 * t28 * t33;
  t1079 = t1076 * t1078;
  t1083 = params->alpha * t78;
  t1085 = t499 * t28 * t33;
  t1086 = t1083 * t1085;
  t1090 = t204 * t204;
  t1091 = 0.1e1 / t1090;
  t1093 = t78 * t1091 * t784;
  t1096 = -0.154e3 / 0.81e2 * t34 * sigma[2] * t1035 * t83 + 0.341e3 / 0.972e3 * t194 * t1041 * params->alpha * t83 + 0.341e3 / 0.972e3 * t134 * t192 * t1041 * t206 - 0.19e2 / 0.324e3 * t483 * t1051 * t324 * t83 - 0.19e2 / 0.162e3 * t491 * t1051 * params->alpha * t206 - 0.19e2 / 0.162e3 * t496 * t1051 * t78 * t499 + t318 * t1068 * t1072 / 0.2916e4 + t329 * t1068 * t1079 / 0.972e3 + t336 * t1068 * t1086 / 0.486e3 + t779 * t1068 * t1093 / 0.486e3;
  t1101 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t1019 * t87 - 0.3e1 / 0.8e1 * t965 - 0.9e1 / 0.8e1 * t5 * t456 * t210 + t898 / 0.4e1 - 0.3e1 / 0.4e1 * t972 - 0.9e1 / 0.8e1 * t5 * t181 * t503 - t823 + t909 / 0.4e1 - 0.3e1 / 0.8e1 * t980 - 0.3e1 / 0.8e1 * t5 * t67 * t1096);
  tv3rho33 = 0.3e1 * t446 + 0.3e1 * t508 + t6 * (t1007 + t1101);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1109 = t5 * t283 * t235;
  t1116 = t5 * t292 * t235 / 0.12e2;
  t1118 = t5 * t106 * t549;
  t1128 = t307 * t46;
  t1132 = t318 * t323;
  t1134 = t324 * t121 * t51;
  t1137 = t329 * t323;
  t1139 = params->alpha * t121 * t138;
  t1142 = t336 * t323;
  t1143 = t46 * t340;
  t1144 = t1143 * t121;
  t1147 = t321 * t124;
  t1149 = 0.1e1 / t37 / t1147;
  t1150 = t319 * t1149;
  t1163 = 0.11e2 / 0.27e2 * t34 * t300 * t46 * t50 - 0.65e2 / 0.648e3 * t118 * t120 * t307 * t524 - 0.65e2 / 0.648e3 * t134 * t1128 * t528 + 0.17e2 / 0.864e3 * t1132 * t1134 + 0.17e2 / 0.432e3 * t1137 * t1139 + 0.17e2 / 0.432e3 * t1142 * t1144 - t318 * t1150 * t761 / 0.7776e4 - t329 * t1150 * t768 / 0.2592e4 - t336 * t1150 * t775 / 0.1296e4 - t779 * t1150 * t785 / 0.1296e4;
  t1168 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t279 * t235 - t1109 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t100 * t549 + t1116 - t1118 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1163);
  tv3rho2sigma0 = t6 * t1168 + 0.2e1 * t554;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1175 = t5 * t365 * t257;
  t1179 = t5 * t369 * t257 / 0.12e2;
  t1181 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t361 * t257 - t1175 / 0.4e1 + t1179);
  tv3rho2sigma2 = t6 * t1181 + 0.2e1 * t563;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1187 = t5 * t390 * t235;
  t1195 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t386 * t235 - t1187 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t170 * t549 - t1109 / 0.8e1 + t1116 - t1118 / 0.8e1);
  tv3rho2sigma3 = t6 * t1195 + t554 + t569;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1201 = t5 * t413 * t257;
  t1208 = t5 * t157 * t606;
  t1211 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t409 * t257 - t1201 / 0.8e1 - t1175 / 0.8e1 + t1179 - 0.3e1 / 0.8e1 * t5 * t153 * t606 - t1208 / 0.8e1);
  tv3rho2sigma5 = t6 * t1211 + t563 + t611;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1219 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t440 * t235 - t1187 / 0.4e1 + t1116);
  tv3rho2sigma6 = t6 * t1219 + 0.2e1 * t569;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1238 = t473 * t78;
  t1242 = t318 * t486;
  t1244 = t324 * t192 * t83;
  t1247 = t329 * t486;
  t1249 = params->alpha * t192 * t206;
  t1252 = t336 * t486;
  t1253 = t78 * t499;
  t1254 = t1253 * t192;
  t1257 = t484 * t195;
  t1259 = 0.1e1 / t70 / t1257;
  t1260 = t482 * t1259;
  t1273 = 0.11e2 / 0.27e2 * t34 * t466 * t78 * t82 - 0.65e2 / 0.648e3 * t118 * t120 * t473 * t581 - 0.65e2 / 0.648e3 * t134 * t1238 * t585 + 0.17e2 / 0.864e3 * t1242 * t1244 + 0.17e2 / 0.432e3 * t1247 * t1249 + 0.17e2 / 0.432e3 * t1252 * t1254 - t318 * t1260 * t1072 / 0.7776e4 - t329 * t1260 * t1079 / 0.2592e4 - t336 * t1260 * t1086 / 0.1296e4 - t779 * t1260 * t1093 / 0.1296e4;
  t1278 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t456 * t257 - t1201 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t181 * t606 + t1179 - t1208 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t67 * t1273);
  tv3rho2sigma8 = t6 * t1278 + 0.2e1 * t611;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1285 = t5 * t106 * t636 / 0.8e1;
  t1288 = t318 * t534;
  t1290 = t324 * sigma[0] * t51;
  t1293 = t329 * t534;
  t1294 = t772 * t528;
  t1301 = t1143 * sigma[0];
  t1305 = 0.1e1 / t37 / t737;
  t1306 = t121 * t1305;
  t1319 = t613 * t129 / 0.54e2 - 0.5e1 / 0.864e3 * t1288 * t1290 - 0.5e1 / 0.432e3 * t1293 * t1294 + t134 * t527 * t137 / 0.54e2 - 0.5e1 / 0.432e3 * t336 * t534 * t1301 + t318 * t1306 * t761 / 0.20736e5 + t329 * t1306 * t768 / 0.6912e4 + t336 * t1306 * t775 / 0.3456e4 + t779 * t1306 * t785 / 0.3456e4;
  t1324 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t636 - t1285 - 0.3e1 / 0.8e1 * t5 * t27 * t1319);
  tv3rhosigma20 = t6 * t1324 + t640;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1331 = t5 * t157 * t663 / 0.8e1;
  t1333 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t153 * t663 - t1331);
  tv3rhosigma25 = t6 * t1333 + t667;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1339 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t636 - t1285);
  tv3rhosigma26 = t6 * t1339 + t640;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1346 = t318 * t591;
  t1348 = t324 * sigma[2] * t83;
  t1351 = t329 * t591;
  t1352 = t1083 * t585;
  t1359 = t1253 * sigma[2];
  t1363 = 0.1e1 / t70 / t1050;
  t1364 = t192 * t1363;
  t1377 = t613 * t200 / 0.54e2 - 0.5e1 / 0.864e3 * t1346 * t1348 - 0.5e1 / 0.432e3 * t1351 * t1352 + t134 * t584 * t205 / 0.54e2 - 0.5e1 / 0.432e3 * t336 * t591 * t1359 + t318 * t1364 * t1072 / 0.20736e5 + t329 * t1364 * t1079 / 0.6912e4 + t336 * t1364 * t1086 / 0.3456e4 + t779 * t1364 * t1093 / 0.3456e4;
  t1382 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t181 * t663 - t1331 - 0.3e1 / 0.8e1 * t5 * t67 * t1377);
  tv3rhosigma211 = t6 * t1382 + t667;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1385 = t765 * t50;
  t1389 = t772 * t137;
  t1395 = 0.1e1 / t37 / t322;
  t1396 = sigma[0] * t1395;
  t1409 = t318 * t621 * t1385 / 0.768e3 + t329 * t621 * t1389 / 0.384e3 + t336 * t633 / 0.384e3 - t318 * t1396 * t761 / 0.55296e5 - t329 * t1396 * t768 / 0.18432e5 - t336 * t1396 * t775 / 0.9216e4 - t779 * t1396 * t785 / 0.9216e4;
  t1413 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1409);
  tv3sigma30 = t6 * t1413;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1415 = t1076 * t82;
  t1419 = t1083 * t205;
  t1425 = 0.1e1 / t70 / t485;
  t1426 = sigma[2] * t1425;
  t1439 = t318 * t648 * t1415 / 0.768e3 + t329 * t648 * t1419 / 0.384e3 + t336 * t660 / 0.384e3 - t318 * t1426 * t1072 / 0.55296e5 - t329 * t1426 * t1079 / 0.18432e5 - t336 * t1426 * t1086 / 0.9216e4 - t779 * t1426 * t1093 / 0.9216e4;
  t1443 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t1439);
  tv3sigma39 = t6 * t1443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t5, t6, t7, t10, t11;
  double t14, t15, t16, t17, t18, t19, t20, t21;
  double t22, t23, t25, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t39;
  double t41, t42, t43, t46, t49, t50, t51, t55;
  double t59, t60, t61, t62, t63, t64, t66, t67;
  double t68, t69, t70, t72, t74, t75, t78, t81;
  double t82, t83, t87, t91, tzk0;

  double t92, t93, t94, t95, t96, t99, t100, t104;
  double t105, t106, t109, t110, t112, t117, t118, t120;
  double t121, t123, t124, t125, t127, t129, t132, t134;
  double t136, t137, t138, t142, t147, t149, t152, t153;
  double t157, t160, t162, tvrho0, t165, t166, t169, t170;
  double t175, t177, t180, t181, t185, t187, t192, t194;
  double t195, t196, t198, t200, t204, t205, t206, t210;
  double t215, tvrho1, t224, t226, t228, t235, t239, tvsigma0;
  double tvsigma1, t246, t248, t250, t257, t261, tvsigma2;

  double t264, t265, t266, t269, t270, t271, t273, t274;
  double t278, t279, t283, t285, t291, t292, t295, t297;
  double t300, t305, t307, t309, t316, t317, t318, t319;
  double t320, t321, t322, t323, t324, t329, t330, t336;
  double t337, t340, t344, t349, t350, t351, t352, t356;
  double t360, t361, t365, t367, t369, t372, t374, tv2rho20;
  double t377, t380, t381, t385, t386, t390, t392, t400;
  double t401, t404, t408, t409, t413, t415, t422, t425;
  double tv2rho21, t430, t434, t435, t439, t440, t446, t447;
  double t451, t455, t456, t466, t471, t473, t475, t482;
  double t483, t484, t485, t486, t491, t496, t499, t503;
  double t508, tv2rho22, t516, t524, t527, t528, t533, t534;
  double t546, t549, t554, tv2rhosigma0, tv2rhosigma1, t561, t563, tv2rhosigma2;
  double t569, tv2rhosigma3, tv2rhosigma4, t581, t584, t585, t590, t591;
  double t603, t606, t611, tv2rhosigma5, t613, t621, t633, t636;
  double t640, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23, tv2sigma24, t648, t660;
  double t663, t667, tv2sigma25;

  double t671, t672, t675, t678, t679, t680, t682, t683;
  double t687, t688, t692, t694, t699, t701, t704, t710;
  double t711, t714, t716, t719, t722, t728, t737, t738;
  double t751, t752, t754, t755, t757, t758, t760, t761;
  double t765, t767, t768, t772, t774, t775, t778, t779;
  double t781, t782, t784, t785, t788, t793, t795, t796;
  double t799, t803, t807, t808, t812, t814, t816, t818;
  double t820, t823, t825, tv3rho30, t828, t829, t830, t833;
  double t838, t839, t840, t841, t845, t846, t850, t853;
  double t857, t859, t863, t872, t873, t874, t877, t883;
  double t887, t888, t892, t895, t896, t898, t907, t909;
  double t912, tv3rho31, t915, t920, t923, t924, t928, t929;
  double t933, t935, t944, t945, t950, t954, t958, t959;
  double t963, t965, t972, t980, t982, t983, tv3rho32, t988;
  double t994, t995, t999, t1000, t1007, t1008, t1014, t1018;
  double t1019, t1035, t1041, t1050, t1051, t1064, t1065, t1067;
  double t1068, t1071, t1072, t1076, t1078, t1079, t1083, t1085;
  double t1086, t1090, t1091, t1093, t1096, t1101, tv3rho33, t1109;
  double t1116, t1118, t1128, t1132, t1134, t1137, t1139, t1142;
  double t1143, t1144, t1147, t1149, t1150, t1163, t1168, tv3rho2sigma0;
  double tv3rho2sigma1, t1175, t1179, t1181, tv3rho2sigma2, t1187, t1195, tv3rho2sigma3;
  double tv3rho2sigma4, t1201, t1208, t1211, tv3rho2sigma5, t1219, tv3rho2sigma6, tv3rho2sigma7;
  double t1238, t1242, t1244, t1247, t1249, t1252, t1253, t1254;
  double t1257, t1259, t1260, t1273, t1278, tv3rho2sigma8, t1285, t1288;
  double t1290, t1293, t1294, t1301, t1305, t1306, t1319, t1324;
  double tv3rhosigma20, tv3rhosigma21, tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, t1331, t1333, tv3rhosigma25;
  double t1339, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29, tv3rhosigma210, t1346, t1348;
  double t1351, t1352, t1359, t1363, t1364, t1377, t1382, tv3rhosigma211;
  double t1385, t1389, t1395, t1396, t1409, t1413, tv3sigma30, tv3sigma31;
  double tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35, tv3sigma36, tv3sigma37, tv3sigma38, t1415;
  double t1419, t1425, t1426, t1439, t1443, tv3sigma39;

  double t1447, t1451, t1454, t1458, t1462, t1468, t1470, t1476;
  double t1479, t1482, t1484, t1489, t1492, t1497, t1499, t1503;
  double t1508, t1509, t1519, t1537, t1538, t1539, t1541, t1545;
  double t1547, t1553, t1559, t1571, t1575, t1577, t1578, t1584;
  double t1591, t1593, t1594, t1598, t1607, t1609, t1610, t1611;
  double t1613, t1614, t1620, t1626, t1630, t1637, t1641, t1645;
  double t1650, t1652, tv4rho40, t1659, t1663, t1664, t1667, t1688;
  double t1689, t1690, t1691, t1695, t1704, t1710, t1711, t1713;
  double t1724, t1725, t1743, t1747, t1754, t1758, t1759, t1762;
  double t1771, t1774, t1775, t1777, t1779, t1780, tv4rho41, t1789;
  double t1793, t1808, t1821, t1825, t1834, t1845, t1846, t1855;
  double t1868, t1872, t1879, t1883, t1892, t1895, t1906, t1909;
  double t1911, t1912, tv4rho42, t1932, t1933, t1937, t1944, t1955;
  double t1956, t1973, t1977, t1984, t1992, t2001, t2011, t2013;
  double t2014, tv4rho43, t2019, t2024, t2030, t2031, t2035, t2044;
  double t2053, t2058, t2064, t2068, t2083, t2088, t2101, t2104;
  double t2109, t2113, t2118, t2135, t2137, t2142, t2148, t2154;
  double t2163, t2167, t2168, tv4rho44, t2176, t2182, t2185, t2192;
  double t2194, t2197, t2201, t2216, t2261, t2266, tv4rho3sigma0, tv4rho3sigma1;
  double t2273, t2276, t2280, t2282, tv4rho3sigma2, t2284, t2290, t2295;
  double t2299, t2308, t2309, tv4rho3sigma3, tv4rho3sigma4, t2311, t2317, t2319;
  double t2328, t2330, t2333, tv4rho3sigma5, t2339, t2348, tv4rho3sigma6, tv4rho3sigma7;
  double t2354, t2361, t2369, t2371, t2372, tv4rho3sigma8, t2381, tv4rho3sigma9;
  double tv4rho3sigma10, t2403, t2421, t2460, t2465, tv4rho3sigma11, t2472, t2479;
  double t2481, t2487, t2506, t2537, t2542, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22;
  double tv4rho2sigma23, tv4rho2sigma24, t2549, t2553, t2555, tv4rho2sigma25, t2561, t2569;
  double tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, t2575, t2582, t2585;
  double tv4rho2sigma211, t2593, tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, t2615;
  double t2629, t2658, t2663, tv4rho2sigma217, t2670, t2682, t2703, t2719;
  double t2724, tv4rhosigma30, tv4rhosigma31, tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36;
  double tv4rhosigma37, tv4rhosigma38, t2731, t2733, tv4rhosigma39, t2739, tv4rhosigma310, tv4rhosigma311;
  double tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317, tv4rhosigma318, t2755;
  double t2776, t2792, t2797, tv4rhosigma319, t2819, t2839, tv4sigma40, tv4sigma41;
  double tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45, tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49;
  double tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413, t2860, t2880, tv4sigma414;

  gga_x_vmt_params *params;

  assert(p->params != NULL);
  params = (gga_x_vmt_params * )(p->params);

  t1 = rho[0] <= p->dens_threshold;
  t2 = M_CBRT3;
  t3 = M_CBRTPI;
  t5 = t2 / t3;
  t6 = rho[0] + rho[1];
  t7 = 0.1e1 / t6;
  t10 = 0.2e1 * rho[0] * t7 <= p->zeta_threshold;
  t11 = p->zeta_threshold - 0.1e1;
  t14 = 0.2e1 * rho[1] * t7 <= p->zeta_threshold;
  t15 = -t11;
  t16 = rho[0] - rho[1];
  t17 = t16 * t7;
  t18 = my_piecewise5(t10, t11, t14, t15, t17);
  t19 = 0.1e1 + t18;
  t20 = t19 <= p->zeta_threshold;
  t21 = POW_1_3(p->zeta_threshold);
  t22 = t21 * p->zeta_threshold;
  t23 = POW_1_3(t19);
  t25 = my_piecewise3(t20, t22, t23 * t19);
  t26 = POW_1_3(t6);
  t27 = t25 * t26;
  t28 = M_CBRT6;
  t29 = params->mu * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t33 = 0.1e1 / t32;
  t34 = t29 * t33;
  t35 = rho[0] * rho[0];
  t36 = POW_1_3(rho[0]);
  t37 = t36 * t36;
  t39 = 0.1e1 / t37 / t35;
  t41 = params->alpha * t28;
  t42 = t33 * sigma[0];
  t43 = t42 * t39;
  t46 = exp(-t41 * t43 / 0.24e2);
  t49 = 0.1e1 + t29 * t43 / 0.24e2;
  t50 = 0.1e1 / t49;
  t51 = t46 * t50;
  t55 = 0.1e1 + t34 * sigma[0] * t39 * t51 / 0.24e2;
  t59 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t55);
  t60 = rho[1] <= p->dens_threshold;
  t61 = my_piecewise5(t14, t11, t10, t15, -t17);
  t62 = 0.1e1 + t61;
  t63 = t62 <= p->zeta_threshold;
  t64 = POW_1_3(t62);
  t66 = my_piecewise3(t63, t22, t64 * t62);
  t67 = t66 * t26;
  t68 = rho[1] * rho[1];
  t69 = POW_1_3(rho[1]);
  t70 = t69 * t69;
  t72 = 0.1e1 / t70 / t68;
  t74 = t33 * sigma[2];
  t75 = t74 * t72;
  t78 = exp(-t41 * t75 / 0.24e2);
  t81 = 0.1e1 + t29 * t75 / 0.24e2;
  t82 = 0.1e1 / t81;
  t83 = t78 * t82;
  t87 = 0.1e1 + t34 * sigma[2] * t72 * t83 / 0.24e2;
  t91 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t87);
  tzk0 = t59 + t91;

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t92 = t6 * t6;
  t93 = 0.1e1 / t92;
  t94 = t16 * t93;
  t95 = t7 - t94;
  t96 = my_piecewise5(t10, 0, t14, 0, t95);
  t99 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t96);
  t100 = t99 * t26;
  t104 = t26 * t26;
  t105 = 0.1e1 / t104;
  t106 = t25 * t105;
  t109 = t5 * t106 * t55 / 0.8e1;
  t110 = t35 * rho[0];
  t112 = 0.1e1 / t37 / t110;
  t117 = t28 * t28;
  t118 = params->mu * t117;
  t120 = 0.1e1 / t31 / t30;
  t121 = sigma[0] * sigma[0];
  t123 = t118 * t120 * t121;
  t124 = t35 * t35;
  t125 = t124 * t35;
  t127 = 0.1e1 / t36 / t125;
  t129 = t127 * params->alpha * t51;
  t132 = params->mu * params->mu;
  t134 = t132 * t117 * t120;
  t136 = t49 * t49;
  t137 = 0.1e1 / t136;
  t138 = t46 * t137;
  t142 = -t34 * sigma[0] * t112 * t51 / 0.9e1 + t123 * t129 / 0.216e3 + t134 * t121 * t127 * t138 / 0.216e3;
  t147 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t55 - t109 - 0.3e1 / 0.8e1 * t5 * t27 * t142);
  t149 = my_piecewise5(t14, 0, t10, 0, -t95);
  t152 = my_piecewise3(t63, 0, 0.4e1 / 0.3e1 * t64 * t149);
  t153 = t152 * t26;
  t157 = t66 * t105;
  t160 = t5 * t157 * t87 / 0.8e1;
  t162 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t153 * t87 - t160);
  tvrho0 = t59 + t91 + t6 * (t147 + t162);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t165 = -t7 - t94;
  t166 = my_piecewise5(t10, 0, t14, 0, t165);
  t169 = my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t166);
  t170 = t169 * t26;
  t175 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t55 - t109);
  t177 = my_piecewise5(t14, 0, t10, 0, -t165);
  t180 = my_piecewise3(t63, 0, 0.4e1 / 0.3e1 * t64 * t177);
  t181 = t180 * t26;
  t185 = t68 * rho[1];
  t187 = 0.1e1 / t70 / t185;
  t192 = sigma[2] * sigma[2];
  t194 = t118 * t120 * t192;
  t195 = t68 * t68;
  t196 = t195 * t68;
  t198 = 0.1e1 / t69 / t196;
  t200 = t198 * params->alpha * t83;
  t204 = t81 * t81;
  t205 = 0.1e1 / t204;
  t206 = t78 * t205;
  t210 = -t34 * sigma[2] * t187 * t83 / 0.9e1 + t194 * t200 / 0.216e3 + t134 * t192 * t198 * t206 / 0.216e3;
  t215 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t181 * t87 - t160 - 0.3e1 / 0.8e1 * t5 * t67 * t210);
  tvrho1 = t59 + t91 + t6 * (t175 + t215);

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t224 = t124 * rho[0];
  t226 = 0.1e1 / t36 / t224;
  t228 = t226 * params->alpha * t51;
  t235 = t34 * t39 * t46 * t50 / 0.24e2 - t118 * t120 * sigma[0] * t228 / 0.576e3 - t134 * sigma[0] * t226 * t138 / 0.576e3;
  t239 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t235);
  tvsigma0 = t6 * t239;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  tvsigma1 = 0.e0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t246 = t195 * rho[1];
  t248 = 0.1e1 / t69 / t246;
  t250 = t248 * params->alpha * t83;
  t257 = t34 * t72 * t78 * t82 / 0.24e2 - t118 * t120 * sigma[2] * t250 / 0.576e3 - t134 * sigma[2] * t248 * t206 / 0.576e3;
  t261 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t257);
  tvsigma2 = t6 * t261;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t264 = t23 * t23;
  t265 = 0.1e1 / t264;
  t266 = t96 * t96;
  t269 = t92 * t6;
  t270 = 0.1e1 / t269;
  t271 = t16 * t270;
  t273 = -0.2e1 * t93 + 0.2e1 * t271;
  t274 = my_piecewise5(t10, 0, t14, 0, t273);
  t278 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t266 + 0.4e1 / 0.3e1 * t23 * t274);
  t279 = t278 * t26;
  t283 = t99 * t105;
  t285 = t5 * t283 * t55;
  t291 = 0.1e1 / t104 / t6;
  t292 = t25 * t291;
  t295 = t5 * t292 * t55 / 0.12e2;
  t297 = t5 * t106 * t142;
  t300 = 0.1e1 / t37 / t124;
  t305 = t124 * t110;
  t307 = 0.1e1 / t36 / t305;
  t309 = t307 * params->alpha * t51;
  t316 = t30 * t30;
  t317 = 0.1e1 / t316;
  t318 = params->mu * t317;
  t319 = t121 * sigma[0];
  t320 = t318 * t319;
  t321 = t124 * t124;
  t322 = t321 * t35;
  t323 = 0.1e1 / t322;
  t324 = params->alpha * params->alpha;
  t329 = t132 * t317;
  t330 = t329 * t319;
  t336 = t132 * params->mu * t317;
  t337 = t336 * t319;
  t340 = 0.1e1 / t136 / t49;
  t344 = 0.11e2 / 0.27e2 * t34 * sigma[0] * t300 * t51 - t123 * t309 / 0.24e2 - t134 * t121 * t307 * t138 / 0.24e2 + t320 * t323 * t324 * t51 / 0.324e3 + t330 * t323 * params->alpha * t138 / 0.162e3 + t337 * t323 * t46 * t340 / 0.162e3;
  t349 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t279 * t55 - t285 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t100 * t142 + t295 - t297 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t344);
  t350 = t64 * t64;
  t351 = 0.1e1 / t350;
  t352 = t149 * t149;
  t356 = my_piecewise5(t14, 0, t10, 0, -t273);
  t360 = my_piecewise3(t63, 0, 0.4e1 / 0.9e1 * t351 * t352 + 0.4e1 / 0.3e1 * t64 * t356);
  t361 = t360 * t26;
  t365 = t152 * t105;
  t367 = t5 * t365 * t87;
  t369 = t66 * t291;
  t372 = t5 * t369 * t87 / 0.12e2;
  t374 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t361 * t87 - t367 / 0.4e1 + t372);
  tv2rho20 = 0.2e1 * t147 + 0.2e1 * t162 + t6 * (t349 + t374);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t377 = t265 * t166;
  t380 = 0.2e1 * t271;
  t381 = my_piecewise5(t10, 0, t14, 0, t380);
  t385 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t377 * t96 + 0.4e1 / 0.3e1 * t23 * t381);
  t386 = t385 * t26;
  t390 = t169 * t105;
  t392 = t5 * t390 * t55;
  t400 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t386 * t55 - t392 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t170 * t142 - t285 / 0.8e1 + t295 - t297 / 0.8e1);
  t401 = t351 * t177;
  t404 = my_piecewise5(t14, 0, t10, 0, -t380);
  t408 = my_piecewise3(t63, 0, 0.4e1 / 0.9e1 * t401 * t149 + 0.4e1 / 0.3e1 * t64 * t404);
  t409 = t408 * t26;
  t413 = t180 * t105;
  t415 = t5 * t413 * t87;
  t422 = t5 * t157 * t210;
  t425 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t409 * t87 - t415 / 0.8e1 - t367 / 0.8e1 + t372 - 0.3e1 / 0.8e1 * t5 * t153 * t210 - t422 / 0.8e1);
  tv2rho21 = t147 + t162 + t175 + t215 + t6 * (t400 + t425);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t430 = t166 * t166;
  t434 = 0.2e1 * t93 + 0.2e1 * t271;
  t435 = my_piecewise5(t10, 0, t14, 0, t434);
  t439 = my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t265 * t430 + 0.4e1 / 0.3e1 * t23 * t435);
  t440 = t439 * t26;
  t446 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t440 * t55 - t392 / 0.4e1 + t295);
  t447 = t177 * t177;
  t451 = my_piecewise5(t14, 0, t10, 0, -t434);
  t455 = my_piecewise3(t63, 0, 0.4e1 / 0.9e1 * t351 * t447 + 0.4e1 / 0.3e1 * t64 * t451);
  t456 = t455 * t26;
  t466 = 0.1e1 / t70 / t195;
  t471 = t195 * t185;
  t473 = 0.1e1 / t69 / t471;
  t475 = t473 * params->alpha * t83;
  t482 = t192 * sigma[2];
  t483 = t318 * t482;
  t484 = t195 * t195;
  t485 = t484 * t68;
  t486 = 0.1e1 / t485;
  t491 = t329 * t482;
  t496 = t336 * t482;
  t499 = 0.1e1 / t204 / t81;
  t503 = 0.11e2 / 0.27e2 * t34 * sigma[2] * t466 * t83 - t194 * t475 / 0.24e2 - t134 * t192 * t473 * t206 / 0.24e2 + t483 * t486 * t324 * t83 / 0.324e3 + t491 * t486 * params->alpha * t206 / 0.162e3 + t496 * t486 * t78 * t499 / 0.162e3;
  t508 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t456 * t87 - t415 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t181 * t210 + t372 - t422 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t67 * t503);
  tv2rho22 = 0.2e1 * t175 + 0.2e1 * t215 + t6 * (t446 + t508);

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t516 = t5 * t106 * t235 / 0.8e1;
  t524 = params->alpha * sigma[0] * t51;
  t527 = t127 * t46;
  t528 = t137 * sigma[0];
  t533 = t321 * rho[0];
  t534 = 0.1e1 / t533;
  t546 = t534 * t46 * t340;
  t549 = -t34 * t112 * t46 * t50 / 0.9e1 + t118 * t120 * t127 * t524 / 0.72e2 + t134 * t527 * t528 / 0.72e2 - t318 * t121 * t534 * t324 * t51 / 0.864e3 - t329 * t121 * t534 * params->alpha * t138 / 0.432e3 - t336 * t121 * t546 / 0.432e3;
  t554 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t235 - t516 - 0.3e1 / 0.8e1 * t5 * t27 * t549);
  tv2rhosigma0 = t6 * t554 + t239;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2rhosigma1 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t561 = t5 * t157 * t257 / 0.8e1;
  t563 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t153 * t257 - t561);
  tv2rhosigma2 = t6 * t563 + t261;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t569 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t235 - t516);
  tv2rhosigma3 = t6 * t569 + t239;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  tv2rhosigma4 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t581 = params->alpha * sigma[2] * t83;
  t584 = t198 * t78;
  t585 = t205 * sigma[2];
  t590 = t484 * rho[1];
  t591 = 0.1e1 / t590;
  t603 = t591 * t78 * t499;
  t606 = -t34 * t187 * t78 * t82 / 0.9e1 + t118 * t120 * t198 * t581 / 0.72e2 + t134 * t584 * t585 / 0.72e2 - t318 * t192 * t591 * t324 * t83 / 0.864e3 - t329 * t192 * t591 * params->alpha * t206 / 0.432e3 - t336 * t192 * t603 / 0.432e3;
  t611 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t181 * t257 - t561 - 0.3e1 / 0.8e1 * t5 * t67 * t606);
  tv2rhosigma5 = t6 * t611 + t261;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  t613 = t118 * t120;
  t621 = 0.1e1 / t321;
  t633 = t621 * t46 * t340;
  t636 = -t613 * t228 / 0.288e3 - t134 * t226 * t46 * t137 / 0.288e3 + t318 * sigma[0] * t621 * t324 * t51 / 0.2304e4 + t329 * sigma[0] * t621 * params->alpha * t138 / 0.1152e4 + t336 * sigma[0] * t633 / 0.1152e4;
  t640 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t636);
  tv2sigma20 = t6 * t640;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  t648 = 0.1e1 / t484;
  t660 = t648 * t78 * t499;
  t663 = -t613 * t250 / 0.288e3 - t134 * t248 * t78 * t205 / 0.288e3 + t318 * sigma[2] * t648 * t324 * t83 / 0.2304e4 + t329 * sigma[2] * t648 * params->alpha * t206 / 0.1152e4 + t336 * sigma[2] * t660 / 0.1152e4;
  t667 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t663);
  tv2sigma25 = t6 * t667;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t671 = 0.1e1 / t264 / t19;
  t672 = t266 * t96;
  t675 = t265 * t96;
  t678 = t92 * t92;
  t679 = 0.1e1 / t678;
  t680 = t16 * t679;
  t682 = 0.6e1 * t270 - 0.6e1 * t680;
  t683 = my_piecewise5(t10, 0, t14, 0, t682);
  t687 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t671 * t672 + 0.4e1 / 0.3e1 * t675 * t274 + 0.4e1 / 0.3e1 * t23 * t683);
  t688 = t687 * t26;
  t692 = t278 * t105;
  t694 = t5 * t692 * t55;
  t699 = t99 * t291;
  t701 = t5 * t699 * t55;
  t704 = t5 * t283 * t142;
  t710 = 0.1e1 / t104 / t92;
  t711 = t25 * t710;
  t714 = 0.5e1 / 0.36e2 * t5 * t711 * t55;
  t716 = t5 * t292 * t142;
  t719 = t5 * t106 * t344;
  t722 = 0.1e1 / t37 / t224;
  t728 = 0.1e1 / t36 / t321;
  t737 = t321 * t110;
  t738 = 0.1e1 / t737;
  t751 = t121 * t121;
  t752 = t321 * t224;
  t754 = 0.1e1 / t37 / t752;
  t755 = t751 * t754;
  t757 = t324 * params->alpha;
  t758 = t757 * t28;
  t760 = t33 * t46 * t50;
  t761 = t758 * t760;
  t765 = t324 * t46;
  t767 = t137 * t28 * t33;
  t768 = t765 * t767;
  t772 = params->alpha * t46;
  t774 = t340 * t28 * t33;
  t775 = t772 * t774;
  t778 = t132 * t132;
  t779 = t778 * t317;
  t781 = t136 * t136;
  t782 = 0.1e1 / t781;
  t784 = t28 * t33;
  t785 = t46 * t782 * t784;
  t788 = -0.154e3 / 0.81e2 * t34 * sigma[0] * t722 * t51 + 0.341e3 / 0.972e3 * t123 * t728 * params->alpha * t51 + 0.341e3 / 0.972e3 * t134 * t121 * t728 * t138 - 0.19e2 / 0.324e3 * t320 * t738 * t324 * t51 - 0.19e2 / 0.162e3 * t330 * t738 * params->alpha * t138 - 0.19e2 / 0.162e3 * t337 * t738 * t46 * t340 + t318 * t755 * t761 / 0.2916e4 + t329 * t755 * t768 / 0.972e3 + t336 * t755 * t775 / 0.486e3 + t779 * t755 * t785 / 0.486e3;
  t793 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t688 * t55 - 0.3e1 / 0.8e1 * t694 - 0.9e1 / 0.8e1 * t5 * t279 * t142 + t701 / 0.4e1 - 0.3e1 / 0.4e1 * t704 - 0.9e1 / 0.8e1 * t5 * t100 * t344 - t714 + t716 / 0.4e1 - 0.3e1 / 0.8e1 * t719 - 0.3e1 / 0.8e1 * t5 * t27 * t788);
  t795 = 0.1e1 / t350 / t62;
  t796 = t352 * t149;
  t799 = t351 * t149;
  t803 = my_piecewise5(t14, 0, t10, 0, -t682);
  t807 = my_piecewise3(t63, 0, -0.8e1 / 0.27e2 * t795 * t796 + 0.4e1 / 0.3e1 * t799 * t356 + 0.4e1 / 0.3e1 * t64 * t803);
  t808 = t807 * t26;
  t812 = t360 * t105;
  t814 = t5 * t812 * t87;
  t816 = t152 * t291;
  t818 = t5 * t816 * t87;
  t820 = t66 * t710;
  t823 = 0.5e1 / 0.36e2 * t5 * t820 * t87;
  t825 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t808 * t87 - 0.3e1 / 0.8e1 * t814 + t818 / 0.4e1 - t823);
  tv3rho30 = 0.3e1 * t349 + 0.3e1 * t374 + t6 * (t793 + t825);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t828 = 0.2e1 * t400;
  t829 = 0.2e1 * t425;
  t830 = t671 * t166;
  t833 = t265 * t381;
  t838 = 0.2e1 * t270;
  t839 = 0.6e1 * t680;
  t840 = t838 - t839;
  t841 = my_piecewise5(t10, 0, t14, 0, t840);
  t845 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t830 * t266 + 0.8e1 / 0.9e1 * t833 * t96 + 0.4e1 / 0.9e1 * t377 * t274 + 0.4e1 / 0.3e1 * t23 * t841);
  t846 = t845 * t26;
  t850 = t385 * t105;
  t853 = t5 * t850 * t55 / 0.4e1;
  t857 = t169 * t291;
  t859 = t5 * t857 * t55;
  t863 = t5 * t390 * t142 / 0.4e1;
  t872 = -0.3e1 / 0.8e1 * t5 * t846 * t55 - t853 - 0.3e1 / 0.4e1 * t5 * t386 * t142 + t859 / 0.12e2 - t863 - 0.3e1 / 0.8e1 * t5 * t170 * t344 - t694 / 0.8e1 + t701 / 0.6e1 - t704 / 0.4e1 - t714 + t716 / 0.6e1 - t719 / 0.8e1;
  t873 = my_piecewise3(t1, 0, t872);
  t874 = t795 * t177;
  t877 = t351 * t404;
  t883 = my_piecewise5(t14, 0, t10, 0, -t840);
  t887 = my_piecewise3(t63, 0, -0.8e1 / 0.27e2 * t874 * t352 + 0.8e1 / 0.9e1 * t877 * t149 + 0.4e1 / 0.9e1 * t401 * t356 + 0.4e1 / 0.3e1 * t64 * t883);
  t888 = t887 * t26;
  t892 = t408 * t105;
  t895 = t5 * t892 * t87 / 0.4e1;
  t896 = t180 * t291;
  t898 = t5 * t896 * t87;
  t907 = t5 * t365 * t210 / 0.4e1;
  t909 = t5 * t369 * t210;
  t912 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t888 * t87 - t895 + t898 / 0.12e2 - t814 / 0.8e1 + t818 / 0.6e1 - t823 - 0.3e1 / 0.8e1 * t5 * t361 * t210 - t907 + t909 / 0.12e2);
  tv3rho31 = t349 + t374 + t828 + t829 + t6 * (t873 + t912);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t915 = t671 * t430;
  t920 = t265 * t435;
  t923 = -t838 - t839;
  t924 = my_piecewise5(t10, 0, t14, 0, t923);
  t928 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t915 * t96 + 0.8e1 / 0.9e1 * t377 * t381 + 0.4e1 / 0.9e1 * t920 * t96 + 0.4e1 / 0.3e1 * t23 * t924);
  t929 = t928 * t26;
  t933 = t439 * t105;
  t935 = t5 * t933 * t55;
  t944 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t929 * t55 - t935 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t440 * t142 - t853 + t859 / 0.6e1 - t863 + t701 / 0.12e2 - t714 + t716 / 0.12e2);
  t945 = t795 * t447;
  t950 = t351 * t451;
  t954 = my_piecewise5(t14, 0, t10, 0, -t923);
  t958 = my_piecewise3(t63, 0, -0.8e1 / 0.27e2 * t945 * t149 + 0.8e1 / 0.9e1 * t401 * t404 + 0.4e1 / 0.9e1 * t950 * t149 + 0.4e1 / 0.3e1 * t64 * t954);
  t959 = t958 * t26;
  t963 = t455 * t105;
  t965 = t5 * t963 * t87;
  t972 = t5 * t413 * t210;
  t980 = t5 * t157 * t503;
  t982 = -0.3e1 / 0.8e1 * t5 * t959 * t87 - t965 / 0.8e1 - t895 + t898 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t409 * t210 - t972 / 0.4e1 + t818 / 0.12e2 - t823 - t907 + t909 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t153 * t503 - t980 / 0.8e1;
  t983 = my_piecewise3(t60, 0, t982);
  tv3rho32 = t828 + t829 + t446 + t508 + t6 * (t944 + t983);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t988 = t430 * t166;
  t994 = -0.6e1 * t270 - 0.6e1 * t680;
  t995 = my_piecewise5(t10, 0, t14, 0, t994);
  t999 = my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t671 * t988 + 0.4e1 / 0.3e1 * t377 * t435 + 0.4e1 / 0.3e1 * t23 * t995);
  t1000 = t999 * t26;
  t1007 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1000 * t55 - 0.3e1 / 0.8e1 * t935 + t859 / 0.4e1 - t714);
  t1008 = t447 * t177;
  t1014 = my_piecewise5(t14, 0, t10, 0, -t994);
  t1018 = my_piecewise3(t63, 0, -0.8e1 / 0.27e2 * t795 * t1008 + 0.4e1 / 0.3e1 * t401 * t451 + 0.4e1 / 0.3e1 * t64 * t1014);
  t1019 = t1018 * t26;
  t1035 = 0.1e1 / t70 / t246;
  t1041 = 0.1e1 / t69 / t484;
  t1050 = t484 * t185;
  t1051 = 0.1e1 / t1050;
  t1064 = t192 * t192;
  t1065 = t484 * t246;
  t1067 = 0.1e1 / t70 / t1065;
  t1068 = t1064 * t1067;
  t1071 = t33 * t78 * t82;
  t1072 = t758 * t1071;
  t1076 = t324 * t78;
  t1078 = t205 * t28 * t33;
  t1079 = t1076 * t1078;
  t1083 = params->alpha * t78;
  t1085 = t499 * t28 * t33;
  t1086 = t1083 * t1085;
  t1090 = t204 * t204;
  t1091 = 0.1e1 / t1090;
  t1093 = t78 * t1091 * t784;
  t1096 = -0.154e3 / 0.81e2 * t34 * sigma[2] * t1035 * t83 + 0.341e3 / 0.972e3 * t194 * t1041 * params->alpha * t83 + 0.341e3 / 0.972e3 * t134 * t192 * t1041 * t206 - 0.19e2 / 0.324e3 * t483 * t1051 * t324 * t83 - 0.19e2 / 0.162e3 * t491 * t1051 * params->alpha * t206 - 0.19e2 / 0.162e3 * t496 * t1051 * t78 * t499 + t318 * t1068 * t1072 / 0.2916e4 + t329 * t1068 * t1079 / 0.972e3 + t336 * t1068 * t1086 / 0.486e3 + t779 * t1068 * t1093 / 0.486e3;
  t1101 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t1019 * t87 - 0.3e1 / 0.8e1 * t965 - 0.9e1 / 0.8e1 * t5 * t456 * t210 + t898 / 0.4e1 - 0.3e1 / 0.4e1 * t972 - 0.9e1 / 0.8e1 * t5 * t181 * t503 - t823 + t909 / 0.4e1 - 0.3e1 / 0.8e1 * t980 - 0.3e1 / 0.8e1 * t5 * t67 * t1096);
  tv3rho33 = 0.3e1 * t446 + 0.3e1 * t508 + t6 * (t1007 + t1101);

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t1109 = t5 * t283 * t235;
  t1116 = t5 * t292 * t235 / 0.12e2;
  t1118 = t5 * t106 * t549;
  t1128 = t307 * t46;
  t1132 = t318 * t323;
  t1134 = t324 * t121 * t51;
  t1137 = t329 * t323;
  t1139 = params->alpha * t121 * t138;
  t1142 = t336 * t323;
  t1143 = t46 * t340;
  t1144 = t1143 * t121;
  t1147 = t321 * t124;
  t1149 = 0.1e1 / t37 / t1147;
  t1150 = t319 * t1149;
  t1163 = 0.11e2 / 0.27e2 * t34 * t300 * t46 * t50 - 0.65e2 / 0.648e3 * t118 * t120 * t307 * t524 - 0.65e2 / 0.648e3 * t134 * t1128 * t528 + 0.17e2 / 0.864e3 * t1132 * t1134 + 0.17e2 / 0.432e3 * t1137 * t1139 + 0.17e2 / 0.432e3 * t1142 * t1144 - t318 * t1150 * t761 / 0.7776e4 - t329 * t1150 * t768 / 0.2592e4 - t336 * t1150 * t775 / 0.1296e4 - t779 * t1150 * t785 / 0.1296e4;
  t1168 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t279 * t235 - t1109 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t100 * t549 + t1116 - t1118 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1163);
  tv3rho2sigma0 = t6 * t1168 + 0.2e1 * t554;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rho2sigma1 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t1175 = t5 * t365 * t257;
  t1179 = t5 * t369 * t257 / 0.12e2;
  t1181 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t361 * t257 - t1175 / 0.4e1 + t1179);
  tv3rho2sigma2 = t6 * t1181 + 0.2e1 * t563;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t1187 = t5 * t390 * t235;
  t1195 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t386 * t235 - t1187 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t170 * t549 - t1109 / 0.8e1 + t1116 - t1118 / 0.8e1);
  tv3rho2sigma3 = t6 * t1195 + t554 + t569;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  tv3rho2sigma4 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t1201 = t5 * t413 * t257;
  t1208 = t5 * t157 * t606;
  t1211 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t409 * t257 - t1201 / 0.8e1 - t1175 / 0.8e1 + t1179 - 0.3e1 / 0.8e1 * t5 * t153 * t606 - t1208 / 0.8e1);
  tv3rho2sigma5 = t6 * t1211 + t563 + t611;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t1219 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t440 * t235 - t1187 / 0.4e1 + t1116);
  tv3rho2sigma6 = t6 * t1219 + 0.2e1 * t569;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  tv3rho2sigma7 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t1238 = t473 * t78;
  t1242 = t318 * t486;
  t1244 = t324 * t192 * t83;
  t1247 = t329 * t486;
  t1249 = params->alpha * t192 * t206;
  t1252 = t336 * t486;
  t1253 = t78 * t499;
  t1254 = t1253 * t192;
  t1257 = t484 * t195;
  t1259 = 0.1e1 / t70 / t1257;
  t1260 = t482 * t1259;
  t1273 = 0.11e2 / 0.27e2 * t34 * t466 * t78 * t82 - 0.65e2 / 0.648e3 * t118 * t120 * t473 * t581 - 0.65e2 / 0.648e3 * t134 * t1238 * t585 + 0.17e2 / 0.864e3 * t1242 * t1244 + 0.17e2 / 0.432e3 * t1247 * t1249 + 0.17e2 / 0.432e3 * t1252 * t1254 - t318 * t1260 * t1072 / 0.7776e4 - t329 * t1260 * t1079 / 0.2592e4 - t336 * t1260 * t1086 / 0.1296e4 - t779 * t1260 * t1093 / 0.1296e4;
  t1278 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t456 * t257 - t1201 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t181 * t606 + t1179 - t1208 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t67 * t1273);
  tv3rho2sigma8 = t6 * t1278 + 0.2e1 * t611;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  t1285 = t5 * t106 * t636 / 0.8e1;
  t1288 = t318 * t534;
  t1290 = t324 * sigma[0] * t51;
  t1293 = t329 * t534;
  t1294 = t772 * t528;
  t1301 = t1143 * sigma[0];
  t1305 = 0.1e1 / t37 / t737;
  t1306 = t121 * t1305;
  t1319 = t613 * t129 / 0.54e2 - 0.5e1 / 0.864e3 * t1288 * t1290 - 0.5e1 / 0.432e3 * t1293 * t1294 + t134 * t527 * t137 / 0.54e2 - 0.5e1 / 0.432e3 * t336 * t534 * t1301 + t318 * t1306 * t761 / 0.20736e5 + t329 * t1306 * t768 / 0.6912e4 + t336 * t1306 * t775 / 0.3456e4 + t779 * t1306 * t785 / 0.3456e4;
  t1324 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t636 - t1285 - 0.3e1 / 0.8e1 * t5 * t27 * t1319);
  tv3rhosigma20 = t6 * t1324 + t640;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  t1331 = t5 * t157 * t663 / 0.8e1;
  t1333 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t153 * t663 - t1331);
  tv3rhosigma25 = t6 * t1333 + t667;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  t1339 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t636 - t1285);
  tv3rhosigma26 = t6 * t1339 + t640;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  t1346 = t318 * t591;
  t1348 = t324 * sigma[2] * t83;
  t1351 = t329 * t591;
  t1352 = t1083 * t585;
  t1359 = t1253 * sigma[2];
  t1363 = 0.1e1 / t70 / t1050;
  t1364 = t192 * t1363;
  t1377 = t613 * t200 / 0.54e2 - 0.5e1 / 0.864e3 * t1346 * t1348 - 0.5e1 / 0.432e3 * t1351 * t1352 + t134 * t584 * t205 / 0.54e2 - 0.5e1 / 0.432e3 * t336 * t591 * t1359 + t318 * t1364 * t1072 / 0.20736e5 + t329 * t1364 * t1079 / 0.6912e4 + t336 * t1364 * t1086 / 0.3456e4 + t779 * t1364 * t1093 / 0.3456e4;
  t1382 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t181 * t663 - t1331 - 0.3e1 / 0.8e1 * t5 * t67 * t1377);
  tv3rhosigma211 = t6 * t1382 + t667;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  t1385 = t765 * t50;
  t1389 = t772 * t137;
  t1395 = 0.1e1 / t37 / t322;
  t1396 = sigma[0] * t1395;
  t1409 = t318 * t621 * t1385 / 0.768e3 + t329 * t621 * t1389 / 0.384e3 + t336 * t633 / 0.384e3 - t318 * t1396 * t761 / 0.55296e5 - t329 * t1396 * t768 / 0.18432e5 - t336 * t1396 * t775 / 0.9216e4 - t779 * t1396 * t785 / 0.9216e4;
  t1413 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t1409);
  tv3sigma30 = t6 * t1413;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  t1415 = t1076 * t82;
  t1419 = t1083 * t205;
  t1425 = 0.1e1 / t70 / t485;
  t1426 = sigma[2] * t1425;
  t1439 = t318 * t648 * t1415 / 0.768e3 + t329 * t648 * t1419 / 0.384e3 + t336 * t660 / 0.384e3 - t318 * t1426 * t1072 / 0.55296e5 - t329 * t1426 * t1079 / 0.18432e5 - t336 * t1426 * t1086 / 0.9216e4 - t779 * t1426 * t1093 / 0.9216e4;
  t1443 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * t1439);
  tv3sigma39 = t6 * t1443;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t1447 = 0.1e1 / t104 / t269;
  t1451 = 0.1e2 / 0.27e2 * t5 * t25 * t1447 * t55;
  t1454 = t5 * t687 * t105 * t55;
  t1458 = t5 * t278 * t291 * t55;
  t1462 = t5 * t99 * t710 * t55;
  t1468 = t5 * t699 * t142;
  t1470 = t5 * t283 * t344;
  t1476 = t5 * t711 * t142;
  t1479 = t5 * t292 * t344;
  t1482 = t5 * t106 * t788;
  t1484 = 0.1e1 / t1147;
  t1489 = t321 * t125;
  t1492 = t751 / t37 / t1489;
  t1497 = t778 * params->mu * t317;
  t1499 = t321 * t321;
  t1503 = t751 * sigma[0] / t36 / t1499 / rho[0];
  t1508 = t117 * t120;
  t1509 = t46 / t781 / t49 * t1508;
  t1519 = 0.1e1 / t36 / t533;
  t1537 = t324 * t324;
  t1538 = t1537 * t117;
  t1539 = t120 * t46;
  t1541 = t1538 * t1539 * t50;
  t1545 = t757 * t117;
  t1547 = t1545 * t1539 * t137;
  t1553 = t765 * t340 * t117 * t120;
  t1559 = t772 * t782 * t117 * t120;
  t1571 = 0.2563e4 / 0.1458e4 * t337 * t1484 * t46 * t340 - 0.49e2 / 0.729e3 * t779 * t1492 * t785 + 0.2e1 / 0.2187e4 * t1497 * t1503 * t1509 + 0.2618e4 / 0.243e3 * t34 * sigma[0] / t37 / t125 * t51 - 0.3047e4 / 0.972e3 * t123 * t1519 * params->alpha * t51 - 0.3047e4 / 0.972e3 * t134 * t121 * t1519 * t138 + 0.2563e4 / 0.2916e4 * t320 * t1484 * t324 * t51 + 0.2563e4 / 0.1458e4 * t330 * t1484 * params->alpha * t138 + t318 * t1503 * t1541 / 0.26244e5 + t329 * t1503 * t1547 / 0.6561e4 + t336 * t1503 * t1553 / 0.2187e4 + 0.2e1 / 0.2187e4 * t779 * t1503 * t1559 - 0.49e2 / 0.4374e4 * t318 * t1492 * t761 - 0.49e2 / 0.1458e4 * t329 * t1492 * t768 - 0.49e2 / 0.729e3 * t336 * t1492 * t775;
  t1575 = t19 * t19;
  t1577 = 0.1e1 / t264 / t1575;
  t1578 = t266 * t266;
  t1584 = t274 * t274;
  t1591 = t16 / t678 / t6;
  t1593 = -0.24e2 * t679 + 0.24e2 * t1591;
  t1594 = my_piecewise5(t10, 0, t14, 0, t1593);
  t1598 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1577 * t1578 - 0.16e2 / 0.9e1 * t671 * t266 * t274 + 0.4e1 / 0.3e1 * t265 * t1584 + 0.16e2 / 0.9e1 * t675 * t683 + 0.4e1 / 0.3e1 * t23 * t1594);
  t1607 = t5 * t692 * t142;
  t1609 = t1451 - t1454 / 0.2e1 + t1458 / 0.2e1 - 0.5e1 / 0.9e1 * t1462 - 0.9e1 / 0.4e1 * t5 * t279 * t344 + t1468 - 0.3e1 / 0.2e1 * t1470 - 0.3e1 / 0.2e1 * t5 * t100 * t788 - 0.5e1 / 0.9e1 * t1476 + t1479 / 0.2e1 - t1482 / 0.2e1 - 0.3e1 / 0.8e1 * t5 * t27 * t1571 - 0.3e1 / 0.8e1 * t5 * t1598 * t26 * t55 - 0.3e1 / 0.2e1 * t5 * t688 * t142 - 0.3e1 / 0.2e1 * t1607;
  t1610 = my_piecewise3(t1, 0, t1609);
  t1611 = t62 * t62;
  t1613 = 0.1e1 / t350 / t1611;
  t1614 = t352 * t352;
  t1620 = t356 * t356;
  t1626 = my_piecewise5(t14, 0, t10, 0, -t1593);
  t1630 = my_piecewise3(t63, 0, 0.4e2 / 0.81e2 * t1613 * t1614 - 0.16e2 / 0.9e1 * t795 * t352 * t356 + 0.4e1 / 0.3e1 * t351 * t1620 + 0.16e2 / 0.9e1 * t799 * t803 + 0.4e1 / 0.3e1 * t64 * t1626);
  t1637 = t5 * t807 * t105 * t87;
  t1641 = t5 * t360 * t291 * t87;
  t1645 = t5 * t152 * t710 * t87;
  t1650 = 0.1e2 / 0.27e2 * t5 * t66 * t1447 * t87;
  t1652 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t1630 * t26 * t87 - t1637 / 0.2e1 + t1641 / 0.2e1 - 0.5e1 / 0.9e1 * t1645 + t1650);
  tv4rho40 = 0.4e1 * t793 + 0.4e1 * t825 + t6 * (t1610 + t1652);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1659 = t5 * t845 * t105 * t55;
  t1663 = t5 * t385 * t291 * t55;
  t1664 = t1663 / 0.4e1;
  t1667 = t5 * t169 * t710 * t55;
  t1688 = 0.12e2 * t679;
  t1689 = 0.24e2 * t1591;
  t1690 = -t1688 + t1689;
  t1691 = my_piecewise5(t10, 0, t14, 0, t1690);
  t1695 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1577 * t166 * t672 - 0.8e1 / 0.9e1 * t671 * t381 * t266 - 0.8e1 / 0.9e1 * t830 * t96 * t274 + 0.4e1 / 0.3e1 * t265 * t841 * t96 + 0.4e1 / 0.3e1 * t833 * t274 + 0.4e1 / 0.9e1 * t377 * t683 + 0.4e1 / 0.3e1 * t23 * t1691);
  t1704 = t5 * t850 * t142;
  t1710 = t5 * t857 * t142;
  t1711 = t1710 / 0.4e1;
  t1713 = t5 * t390 * t344;
  t1724 = -0.3e1 / 0.8e1 * t1659 + t1664 - 0.5e1 / 0.36e2 * t1667 + t1451 - t1454 / 0.8e1 + t1458 / 0.4e1 - 0.5e1 / 0.12e2 * t1462 - 0.3e1 / 0.8e1 * t5 * t1695 * t26 * t55 - 0.9e1 / 0.8e1 * t5 * t846 * t142 - 0.3e1 / 0.4e1 * t1704 - 0.9e1 / 0.8e1 * t5 * t386 * t344 + t1711 - 0.3e1 / 0.8e1 * t1713 - 0.3e1 / 0.8e1 * t5 * t170 * t788 + t1468 / 0.2e1 - 0.3e1 / 0.8e1 * t1470 - 0.5e1 / 0.12e2 * t1476 + t1479 / 0.4e1 - t1482 / 0.8e1 - 0.3e1 / 0.8e1 * t1607;
  t1725 = my_piecewise3(t1, 0, t1724);
  t1743 = my_piecewise5(t14, 0, t10, 0, -t1690);
  t1747 = my_piecewise3(t63, 0, 0.4e2 / 0.81e2 * t1613 * t177 * t796 - 0.8e1 / 0.9e1 * t795 * t404 * t352 - 0.8e1 / 0.9e1 * t874 * t149 * t356 + 0.4e1 / 0.3e1 * t351 * t883 * t149 + 0.4e1 / 0.3e1 * t877 * t356 + 0.4e1 / 0.9e1 * t401 * t803 + 0.4e1 / 0.3e1 * t64 * t1743);
  t1754 = t5 * t887 * t105 * t87;
  t1758 = t5 * t408 * t291 * t87;
  t1759 = t1758 / 0.4e1;
  t1762 = t5 * t180 * t710 * t87;
  t1771 = t5 * t812 * t210;
  t1774 = t5 * t816 * t210;
  t1775 = t1774 / 0.4e1;
  t1777 = t5 * t820 * t210;
  t1779 = -0.3e1 / 0.8e1 * t5 * t1747 * t26 * t87 - 0.3e1 / 0.8e1 * t1754 + t1759 - 0.5e1 / 0.36e2 * t1762 - t1637 / 0.8e1 + t1641 / 0.4e1 - 0.5e1 / 0.12e2 * t1645 + t1650 - 0.3e1 / 0.8e1 * t5 * t808 * t210 - 0.3e1 / 0.8e1 * t1771 + t1775 - 0.5e1 / 0.36e2 * t1777;
  t1780 = my_piecewise3(t60, 0, t1779);
  tv4rho41 = t793 + t825 + 0.3e1 * t873 + 0.3e1 * t912 + t6 * (t1725 + t1780);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t1789 = t5 * t928 * t105 * t55;
  t1793 = t5 * t439 * t291 * t55;
  t1808 = t381 * t381;
  t1821 = my_piecewise5(t10, 0, t14, 0, t1689);
  t1825 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1577 * t430 * t266 - 0.32e2 / 0.27e2 * t830 * t96 * t381 - 0.8e1 / 0.27e2 * t915 * t274 + 0.8e1 / 0.9e1 * t265 * t1808 + 0.8e1 / 0.9e1 * t377 * t841 - 0.8e1 / 0.27e2 * t671 * t435 * t266 + 0.8e1 / 0.9e1 * t265 * t924 * t96 + 0.4e1 / 0.9e1 * t920 * t274 + 0.4e1 / 0.3e1 * t23 * t1821);
  t1834 = t5 * t933 * t142;
  t1845 = -t1789 / 0.4e1 + t1793 / 0.12e2 - t1659 / 0.4e1 + t1663 / 0.3e1 - 0.5e1 / 0.18e2 * t1667 + t1451 + t1458 / 0.12e2 - 0.5e1 / 0.18e2 * t1462 - 0.3e1 / 0.8e1 * t5 * t1825 * t26 * t55 - 0.3e1 / 0.4e1 * t5 * t929 * t142 - t1834 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t440 * t344 - t1704 / 0.2e1 + t1710 / 0.3e1 - t1713 / 0.4e1 + t1468 / 0.6e1 - 0.5e1 / 0.18e2 * t1476 + t1479 / 0.12e2;
  t1846 = my_piecewise3(t1, 0, t1845);
  t1855 = t404 * t404;
  t1868 = my_piecewise5(t14, 0, t10, 0, -t1689);
  t1872 = my_piecewise3(t63, 0, 0.4e2 / 0.81e2 * t1613 * t447 * t352 - 0.32e2 / 0.27e2 * t874 * t149 * t404 - 0.8e1 / 0.27e2 * t945 * t356 + 0.8e1 / 0.9e1 * t351 * t1855 + 0.8e1 / 0.9e1 * t401 * t883 - 0.8e1 / 0.27e2 * t795 * t451 * t352 + 0.8e1 / 0.9e1 * t351 * t954 * t149 + 0.4e1 / 0.9e1 * t950 * t356 + 0.4e1 / 0.3e1 * t64 * t1868);
  t1879 = t5 * t958 * t105 * t87;
  t1883 = t5 * t455 * t291 * t87;
  t1892 = t5 * t892 * t210;
  t1895 = t5 * t896 * t210;
  t1906 = t5 * t365 * t503;
  t1909 = t5 * t369 * t503;
  t1911 = -0.3e1 / 0.8e1 * t5 * t1872 * t26 * t87 - t1879 / 0.4e1 + t1883 / 0.12e2 - t1754 / 0.4e1 + t1758 / 0.3e1 - 0.5e1 / 0.18e2 * t1762 - 0.3e1 / 0.4e1 * t5 * t888 * t210 - t1892 / 0.2e1 + t1895 / 0.6e1 + t1641 / 0.12e2 - 0.5e1 / 0.18e2 * t1645 + t1650 - t1771 / 0.4e1 + t1774 / 0.3e1 - 0.5e1 / 0.18e2 * t1777 - 0.3e1 / 0.8e1 * t5 * t361 * t503 - t1906 / 0.4e1 + t1909 / 0.12e2;
  t1912 = my_piecewise3(t60, 0, t1911);
  tv4rho42 = 0.2e1 * t873 + 0.2e1 * t912 + 0.2e1 * t944 + 0.2e1 * t983 + t6 * (t1846 + t1912);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t1932 = t1688 + t1689;
  t1933 = my_piecewise5(t10, 0, t14, 0, t1932);
  t1937 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1577 * t988 * t96 - 0.8e1 / 0.9e1 * t915 * t381 - 0.8e1 / 0.9e1 * t830 * t435 * t96 + 0.4e1 / 0.3e1 * t833 * t435 + 0.4e1 / 0.3e1 * t377 * t924 + 0.4e1 / 0.9e1 * t265 * t995 * t96 + 0.4e1 / 0.3e1 * t23 * t1933);
  t1944 = t5 * t999 * t105 * t55;
  t1955 = -0.3e1 / 0.8e1 * t5 * t1937 * t26 * t55 - t1944 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t1000 * t142 - 0.3e1 / 0.8e1 * t1789 + t1793 / 0.4e1 - 0.3e1 / 0.8e1 * t1834 + t1664 - 0.5e1 / 0.12e2 * t1667 + t1711 - 0.5e1 / 0.36e2 * t1462 + t1451 - 0.5e1 / 0.36e2 * t1476;
  t1956 = my_piecewise3(t1, 0, t1955);
  t1973 = my_piecewise5(t14, 0, t10, 0, -t1932);
  t1977 = my_piecewise3(t63, 0, 0.4e2 / 0.81e2 * t1613 * t1008 * t149 - 0.8e1 / 0.9e1 * t945 * t404 - 0.8e1 / 0.9e1 * t874 * t451 * t149 + 0.4e1 / 0.3e1 * t877 * t451 + 0.4e1 / 0.3e1 * t401 * t954 + 0.4e1 / 0.9e1 * t351 * t1014 * t149 + 0.4e1 / 0.3e1 * t64 * t1973);
  t1984 = t5 * t1018 * t105 * t87;
  t1992 = t5 * t963 * t210;
  t2001 = t5 * t413 * t503;
  t2011 = t5 * t157 * t1096;
  t2013 = -0.3e1 / 0.8e1 * t5 * t1977 * t26 * t87 - t1984 / 0.8e1 - 0.3e1 / 0.8e1 * t1879 + t1883 / 0.4e1 - 0.9e1 / 0.8e1 * t5 * t959 * t210 - 0.3e1 / 0.8e1 * t1992 + t1759 - 0.5e1 / 0.12e2 * t1762 - 0.3e1 / 0.4e1 * t1892 + t1895 / 0.2e1 - 0.9e1 / 0.8e1 * t5 * t409 * t503 - 0.3e1 / 0.8e1 * t2001 - 0.5e1 / 0.36e2 * t1645 + t1650 + t1775 - 0.5e1 / 0.12e2 * t1777 - 0.3e1 / 0.8e1 * t1906 + t1909 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t153 * t1096 - t2011 / 0.8e1;
  t2014 = my_piecewise3(t60, 0, t2013);
  tv4rho43 = 0.3e1 * t944 + 0.3e1 * t983 + t1007 + t1101 + t6 * (t1956 + t2014);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t2019 = t430 * t430;
  t2024 = t435 * t435;
  t2030 = 0.24e2 * t679 + 0.24e2 * t1591;
  t2031 = my_piecewise5(t10, 0, t14, 0, t2030);
  t2035 = my_piecewise3(t20, 0, 0.4e2 / 0.81e2 * t1577 * t2019 - 0.16e2 / 0.9e1 * t915 * t435 + 0.4e1 / 0.3e1 * t265 * t2024 + 0.16e2 / 0.9e1 * t377 * t995 + 0.4e1 / 0.3e1 * t23 * t2031);
  t2044 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t2035 * t26 * t55 - t1944 / 0.2e1 + t1793 / 0.2e1 - 0.5e1 / 0.9e1 * t1667 + t1451);
  t2053 = t447 * t447;
  t2058 = t451 * t451;
  t2064 = my_piecewise5(t14, 0, t10, 0, -t2030);
  t2068 = my_piecewise3(t63, 0, 0.4e2 / 0.81e2 * t1613 * t2053 - 0.16e2 / 0.9e1 * t945 * t451 + 0.4e1 / 0.3e1 * t351 * t2058 + 0.16e2 / 0.9e1 * t401 * t1014 + 0.4e1 / 0.3e1 * t64 * t2064);
  t2083 = 0.1e1 / t69 / t590;
  t2088 = 0.1e1 / t1257;
  t2101 = t484 * t196;
  t2104 = t1064 / t70 / t2101;
  t2109 = t484 * t484;
  t2113 = t1064 * sigma[2] / t69 / t2109 / rho[1];
  t2118 = t78 / t1090 / t81 * t1508;
  t2135 = t120 * t78;
  t2137 = t1538 * t2135 * t82;
  t2142 = t1545 * t2135 * t205;
  t2148 = t1076 * t499 * t117 * t120;
  t2154 = t1083 * t1091 * t117 * t120;
  t2163 = -0.3047e4 / 0.972e3 * t134 * t192 * t2083 * t206 + 0.2563e4 / 0.2916e4 * t483 * t2088 * t324 * t83 + 0.2563e4 / 0.1458e4 * t491 * t2088 * params->alpha * t206 + 0.2563e4 / 0.1458e4 * t496 * t2088 * t78 * t499 - 0.49e2 / 0.729e3 * t779 * t2104 * t1093 + 0.2e1 / 0.2187e4 * t1497 * t2113 * t2118 + 0.2618e4 / 0.243e3 * t34 * sigma[2] / t70 / t196 * t83 - 0.3047e4 / 0.972e3 * t194 * t2083 * params->alpha * t83 - 0.49e2 / 0.729e3 * t336 * t2104 * t1086 + t318 * t2113 * t2137 / 0.26244e5 + t329 * t2113 * t2142 / 0.6561e4 + t336 * t2113 * t2148 / 0.2187e4 + 0.2e1 / 0.2187e4 * t779 * t2113 * t2154 - 0.49e2 / 0.4374e4 * t318 * t2104 * t1072 - 0.49e2 / 0.1458e4 * t329 * t2104 * t1079;
  t2167 = t1895 + t1909 / 0.2e1 - t1984 / 0.2e1 - 0.3e1 / 0.2e1 * t1992 - 0.3e1 / 0.2e1 * t2001 - t2011 / 0.2e1 - 0.5e1 / 0.9e1 * t1777 + t1883 / 0.2e1 - 0.5e1 / 0.9e1 * t1762 + t1650 - 0.3e1 / 0.8e1 * t5 * t2068 * t26 * t87 - 0.3e1 / 0.2e1 * t5 * t1019 * t210 - 0.9e1 / 0.4e1 * t5 * t456 * t503 - 0.3e1 / 0.2e1 * t5 * t181 * t1096 - 0.3e1 / 0.8e1 * t5 * t67 * t2163;
  t2168 = my_piecewise3(t60, 0, t2167);
  tv4rho44 = 0.4e1 * t1007 + 0.4e1 * t1101 + t6 * (t2044 + t2168);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t2176 = t5 * t692 * t235;
  t2182 = t5 * t699 * t235;
  t2185 = t5 * t283 * t549;
  t2192 = 0.5e1 / 0.36e2 * t5 * t711 * t235;
  t2194 = t5 * t292 * t549;
  t2197 = t5 * t106 * t1163;
  t2201 = t751 / t36 / t1499;
  t2216 = t319 * t46;
  t2261 = -t336 * t2201 * t1553 / 0.5832e4 - t779 * t2201 * t1559 / 0.2916e4 + 0.89e2 / 0.23328e5 * t318 * t754 * t757 * t319 * t28 * t760 + 0.89e2 / 0.7776e4 * t329 * t754 * t324 * t2216 * t767 + 0.89e2 / 0.3888e4 * t336 * t754 * params->alpha * t2216 * t774 - t318 * t2201 * t1541 / 0.69984e5 - t329 * t2201 * t1547 / 0.17496e5 - 0.154e3 / 0.81e2 * t34 * t722 * t46 * t50 + 0.253e3 / 0.324e3 * t134 * t728 * t46 * t528 - 0.1025e4 / 0.3888e4 * t318 * t738 * t1134 - 0.1025e4 / 0.1944e4 * t329 * t738 * t1139 - 0.1025e4 / 0.1944e4 * t336 * t738 * t1144 + 0.89e2 / 0.3888e4 * t779 * t754 * t46 * t782 * t319 * t784 - t1497 * t2201 * t1509 / 0.2916e4 + 0.253e3 / 0.324e3 * t118 * t120 * t728 * t524;
  t2266 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t688 * t235 - 0.3e1 / 0.8e1 * t2176 - 0.9e1 / 0.8e1 * t5 * t279 * t549 + t2182 / 0.4e1 - 0.3e1 / 0.4e1 * t2185 - 0.9e1 / 0.8e1 * t5 * t100 * t1163 - t2192 + t2194 / 0.4e1 - 0.3e1 / 0.8e1 * t2197 - 0.3e1 / 0.8e1 * t5 * t27 * t2261);
  tv4rho3sigma0 = t6 * t2266 + 0.3e1 * t1168;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho3sigma1 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t2273 = t5 * t812 * t257;
  t2276 = t5 * t816 * t257;
  t2280 = 0.5e1 / 0.36e2 * t5 * t820 * t257;
  t2282 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t808 * t257 - 0.3e1 / 0.8e1 * t2273 + t2276 / 0.4e1 - t2280);
  tv4rho3sigma2 = t6 * t2282 + 0.3e1 * t1181;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t2284 = 0.2e1 * t1195;
  t2290 = t5 * t850 * t235 / 0.4e1;
  t2295 = t5 * t857 * t235;
  t2299 = t5 * t390 * t549 / 0.4e1;
  t2308 = -0.3e1 / 0.8e1 * t5 * t846 * t235 - t2290 - 0.3e1 / 0.4e1 * t5 * t386 * t549 + t2295 / 0.12e2 - t2299 - 0.3e1 / 0.8e1 * t5 * t170 * t1163 - t2176 / 0.8e1 + t2182 / 0.6e1 - t2185 / 0.4e1 - t2192 + t2194 / 0.6e1 - t2197 / 0.8e1;
  t2309 = my_piecewise3(t1, 0, t2308);
  tv4rho3sigma3 = t6 * t2309 + t1168 + t2284;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  tv4rho3sigma4 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t2311 = 0.2e1 * t1211;
  t2317 = t5 * t892 * t257 / 0.4e1;
  t2319 = t5 * t896 * t257;
  t2328 = t5 * t365 * t606 / 0.4e1;
  t2330 = t5 * t369 * t606;
  t2333 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t888 * t257 - t2317 + t2319 / 0.12e2 - t2273 / 0.8e1 + t2276 / 0.6e1 - t2280 - 0.3e1 / 0.8e1 * t5 * t361 * t606 - t2328 + t2330 / 0.12e2);
  tv4rho3sigma5 = t6 * t2333 + t1181 + t2311;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t2339 = t5 * t933 * t235;
  t2348 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t929 * t235 - t2339 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t440 * t549 - t2290 + t2295 / 0.6e1 - t2299 + t2182 / 0.12e2 - t2192 + t2194 / 0.12e2);
  tv4rho3sigma6 = t6 * t2348 + t1219 + t2284;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  tv4rho3sigma7 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t2354 = t5 * t963 * t257;
  t2361 = t5 * t413 * t606;
  t2369 = t5 * t157 * t1273;
  t2371 = -0.3e1 / 0.8e1 * t5 * t959 * t257 - t2354 / 0.8e1 - t2317 + t2319 / 0.6e1 - 0.3e1 / 0.4e1 * t5 * t409 * t606 - t2361 / 0.4e1 + t2276 / 0.12e2 - t2280 - t2328 + t2330 / 0.6e1 - 0.3e1 / 0.8e1 * t5 * t153 * t1273 - t2369 / 0.8e1;
  t2372 = my_piecewise3(t60, 0, t2371);
  tv4rho3sigma8 = t6 * t2372 + t1278 + t2311;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t2381 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t1000 * t235 - 0.3e1 / 0.8e1 * t2339 + t2295 / 0.4e1 - t2192);
  tv4rho3sigma9 = t6 * t2381 + 0.3e1 * t1219;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  tv4rho3sigma10 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t2403 = t1064 / t69 / t2109;
  t2421 = t482 * t78;
  t2460 = -0.1025e4 / 0.1944e4 * t336 * t1051 * t1254 - t329 * t2403 * t2142 / 0.17496e5 - t336 * t2403 * t2148 / 0.5832e4 - t779 * t2403 * t2154 / 0.2916e4 + 0.89e2 / 0.23328e5 * t318 * t1067 * t757 * t482 * t28 * t1071 + 0.89e2 / 0.7776e4 * t329 * t1067 * t324 * t2421 * t1078 + 0.89e2 / 0.3888e4 * t336 * t1067 * params->alpha * t2421 * t1085 - t318 * t2403 * t2137 / 0.69984e5 - 0.154e3 / 0.81e2 * t34 * t1035 * t78 * t82 + 0.253e3 / 0.324e3 * t134 * t1041 * t78 * t585 - 0.1025e4 / 0.3888e4 * t318 * t1051 * t1244 - 0.1025e4 / 0.1944e4 * t329 * t1051 * t1249 + 0.89e2 / 0.3888e4 * t779 * t1067 * t78 * t1091 * t482 * t784 - t1497 * t2403 * t2118 / 0.2916e4 + 0.253e3 / 0.324e3 * t118 * t120 * t1041 * t581;
  t2465 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t1019 * t257 - 0.3e1 / 0.8e1 * t2354 - 0.9e1 / 0.8e1 * t5 * t456 * t606 + t2319 / 0.4e1 - 0.3e1 / 0.4e1 * t2361 - 0.9e1 / 0.8e1 * t5 * t181 * t1273 - t2280 + t2330 / 0.4e1 - 0.3e1 / 0.8e1 * t2369 - 0.3e1 / 0.8e1 * t5 * t67 * t2460);
  tv4rho3sigma11 = t6 * t2465 + 0.3e1 * t1278;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  t2472 = t5 * t283 * t636;
  t2479 = t5 * t292 * t636 / 0.12e2;
  t2481 = t5 * t106 * t1319;
  t2487 = t121 * t28;
  t2506 = t319 / t36 / t321 / t305;
  t2537 = 0.167e3 / 0.1296e4 * t1142 * t1301 - 0.25e2 / 0.20736e5 * t318 * t1149 * t757 * t2487 * t760 - 0.25e2 / 0.6912e4 * t329 * t1149 * t324 * t121 * t46 * t767 - 0.25e2 / 0.3456e4 * t336 * t1149 * params->alpha * t1143 * t2487 * t33 + t318 * t2506 * t1541 / 0.186624e6 + t329 * t2506 * t1547 / 0.46656e5 + t336 * t2506 * t1553 / 0.15552e5 + t779 * t2506 * t1559 / 0.7776e4 - 0.19e2 / 0.162e3 * t134 * t1128 * t137 + 0.167e3 / 0.2592e4 * t1132 * t1290 + 0.167e3 / 0.1296e4 * t1137 * t1294 - 0.25e2 / 0.3456e4 * t779 * t1149 * t46 * t782 * t121 * t784 + t1497 * t2506 * t1509 / 0.7776e4 - 0.19e2 / 0.162e3 * t613 * t309;
  t2542 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t279 * t636 - t2472 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t100 * t1319 + t2479 - t2481 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t27 * t2537);
  tv4rho2sigma20 = t6 * t2542 + 0.2e1 * t1324;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  t2549 = t5 * t365 * t663;
  t2553 = t5 * t369 * t663 / 0.12e2;
  t2555 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t361 * t663 - t2549 / 0.4e1 + t2553);
  tv4rho2sigma25 = t6 * t2555 + 0.2e1 * t1333;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  t2561 = t5 * t390 * t636;
  t2569 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t386 * t636 - t2561 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t170 * t1319 - t2472 / 0.8e1 + t2479 - t2481 / 0.8e1);
  tv4rho2sigma26 = t6 * t2569 + t1324 + t1339;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  t2575 = t5 * t413 * t663;
  t2582 = t5 * t157 * t1377;
  t2585 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t409 * t663 - t2575 / 0.8e1 - t2549 / 0.8e1 + t2553 - 0.3e1 / 0.8e1 * t5 * t153 * t1377 - t2582 / 0.8e1);
  tv4rho2sigma211 = t6 * t2585 + t1333 + t1382;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  t2593 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t440 * t636 - t2561 / 0.4e1 + t2479);
  tv4rho2sigma212 = t6 * t2593 + 0.2e1 * t1339;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  t2615 = t482 / t69 / t484 / t471;
  t2629 = t192 * t28;
  t2658 = -0.19e2 / 0.162e3 * t613 * t475 - 0.25e2 / 0.3456e4 * t779 * t1259 * t78 * t1091 * t192 * t784 + t1497 * t2615 * t2118 / 0.7776e4 + 0.167e3 / 0.1296e4 * t1252 * t1359 - 0.25e2 / 0.6912e4 * t329 * t1259 * t324 * t192 * t78 * t1078 - 0.25e2 / 0.3456e4 * t336 * t1259 * params->alpha * t1253 * t2629 * t33 + t318 * t2615 * t2137 / 0.186624e6 + t329 * t2615 * t2142 / 0.46656e5 + t336 * t2615 * t2148 / 0.15552e5 + t779 * t2615 * t2154 / 0.7776e4 - 0.25e2 / 0.20736e5 * t318 * t1259 * t757 * t2629 * t1071 - 0.19e2 / 0.162e3 * t134 * t1238 * t205 + 0.167e3 / 0.2592e4 * t1242 * t1348 + 0.167e3 / 0.1296e4 * t1247 * t1352;
  t2663 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t456 * t663 - t2575 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t181 * t1377 + t2553 - t2582 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t67 * t2658);
  tv4rho2sigma217 = t6 * t2663 + 0.2e1 * t1382;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  t2670 = t5 * t106 * t1409 / 0.8e1;
  t2682 = t784 * sigma[0];
  t2703 = t121 / t36 / t1489;
  t2719 = -t1288 * t1385 / 0.96e2 + 0.7e1 / 0.20736e5 * t318 * t1305 * t757 * t784 * sigma[0] * t46 * t50 + 0.7e1 / 0.6912e4 * t329 * t1305 * t324 * t138 * t2682 - t1293 * t1389 / 0.48e2 + 0.7e1 / 0.3456e4 * t336 * t1305 * params->alpha * t1143 * t2682 - t336 * t546 / 0.48e2 + 0.7e1 / 0.3456e4 * t779 * t1305 * t46 * t782 * t28 * t42 - t318 * t2703 * t1541 / 0.497664e6 - t329 * t2703 * t1547 / 0.124416e6 - t336 * t2703 * t1553 / 0.41472e5 - t779 * t2703 * t1559 / 0.20736e5 - t1497 * t2703 * t1509 / 0.20736e5;
  t2724 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t100 * t1409 - t2670 - 0.3e1 / 0.8e1 * t5 * t27 * t2719);
  tv4rhosigma30 = t6 * t2724 + t1413;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  t2731 = t5 * t157 * t1439 / 0.8e1;
  t2733 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t153 * t1439 - t2731);
  tv4rhosigma39 = t6 * t2733 + t1443;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  t2739 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t170 * t1409 - t2670);
  tv4rhosigma310 = t6 * t2739 + t1413;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  t2755 = t784 * sigma[2];
  t2776 = t192 / t69 / t2101;
  t2792 = -t1346 * t1415 / 0.96e2 + 0.7e1 / 0.20736e5 * t318 * t1363 * t757 * t784 * sigma[2] * t78 * t82 + 0.7e1 / 0.6912e4 * t329 * t1363 * t324 * t206 * t2755 - t1351 * t1419 / 0.48e2 + 0.7e1 / 0.3456e4 * t336 * t1363 * params->alpha * t1253 * t2755 - t336 * t603 / 0.48e2 + 0.7e1 / 0.3456e4 * t779 * t1363 * t78 * t1091 * t28 * t74 - t318 * t2776 * t2137 / 0.497664e6 - t329 * t2776 * t2142 / 0.124416e6 - t336 * t2776 * t2148 / 0.41472e5 - t779 * t2776 * t2154 / 0.20736e5 - t1497 * t2776 * t2118 / 0.20736e5;
  t2797 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t181 * t1439 - t2731 - 0.3e1 / 0.8e1 * t5 * t67 * t2792);
  tv4rhosigma319 = t6 * t2797 + t1443;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  t2819 = sigma[0] / t36 / t752;
  t2839 = my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (-t318 * t1395 * t757 * t784 * t51 / 0.13824e5 - t329 * t1395 * t324 * t138 * t784 / 0.4608e4 - t336 * t1395 * params->alpha * t1143 * t784 / 0.2304e4 - t779 * t1395 * t785 / 0.2304e4 + t318 * t2819 * t1541 / 0.1327104e7 + t329 * t2819 * t1547 / 0.331776e6 + t336 * t2819 * t1553 / 0.110592e6 + t779 * t2819 * t1559 / 0.55296e5 + t1497 * t2819 * t1509 / 0.55296e5));
  tv4sigma40 = t6 * t2839;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  t2860 = sigma[2] / t69 / t1065;
  t2880 = my_piecewise3(t60, 0, -0.3e1 / 0.8e1 * t5 * t67 * (-t318 * t1425 * t757 * t784 * t83 / 0.13824e5 - t329 * t1425 * t324 * t206 * t784 / 0.4608e4 - t336 * t1425 * params->alpha * t1253 * t784 / 0.2304e4 - t779 * t1425 * t1093 / 0.2304e4 + t318 * t2860 * t2137 / 0.1327104e7 + t329 * t2860 * t2142 / 0.331776e6 + t336 * t2860 * t2148 / 0.110592e6 + t779 * t2860 * t2154 / 0.55296e5 + t1497 * t2860 * t2118 / 0.55296e5));
  tv4sigma414 = t6 * t2880;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif

