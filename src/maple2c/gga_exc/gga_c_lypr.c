/*
  This file was generated automatically with ../../scripts/maple2c.py.
  Do not edit this file directly as it can be overwritten!!

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at http://mozilla.org/MPL/2.0/.

  Maple version     : Maple 2016 (X86 64 LINUX)
  Maple source      : gga_c_lypr.mpl
  Type of functional: gga_exc
*/

#define maple2c_order 4
#define MAPLE2C_FLAGS (XC_FLAGS_I_HAVE_EXC | XC_FLAGS_I_HAVE_VXC | XC_FLAGS_I_HAVE_FXC | XC_FLAGS_I_HAVE_KXC | XC_FLAGS_I_HAVE_LXC)


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t12, t13, t15, t16, t18, t20, t21;
  double t23, t24, t26, t27, t29, t30, t32, t33;
  double t35, t38, t40, t41, t42, t43, t44, t45;
  double t46, t47, t48, t49, t50, t51, t52, t53;
  double t54, t55, t56, t57, t58, t59, t60, t61;
  double t62, t63, t64, t65, t66, t70, t71, t73;
  double t74, t75, t76, t78, t79, t80, t81, t82;
  double t83, t85, t86, t87, t88, t89, t92, t94;
  double t97, t101, t103, t104, t109, t110, t111, t114;
  double t115, t116, t122, t123, t125, t126, t127, t128;
  double t130, t131, t132, t134, t136, t137, t138, t142;
  double t143, t144, t145, t146, t149, t150, t151, t152;
  double t155, tzk0;

  gga_c_lypr_params *params;

  assert(p->params != NULL);
  params = (gga_c_lypr_params * )(p->params);

  t1 = params->m1 * params->omega;
  t2 = rho[0] + rho[1];
  t3 = POW_1_3(t2);
  t4 = 0.1e1 / t3;
  t6 = erfc(t1 * t4);
  t7 = rho[0] - rho[1];
  t8 = t7 * t7;
  t9 = t2 * t2;
  t10 = 0.1e1 / t9;
  t12 = -t10 * t8 + 0.1e1;
  t13 = t6 * t12;
  t15 = t4 * params->d + 0.1e1;
  t16 = 0.1e1 / t15;
  t18 = params->m2 * params->omega;
  t20 = erfc(t18 * t4);
  t21 = t20 * params->b;
  t23 = exp(-params->c * t4);
  t24 = t23 * t16;
  t26 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t27 = t3 * t3;
  t29 = 0.1e1 / t27 / t9;
  t30 = t26 * t29;
  t32 = t16 * params->d + params->c;
  t33 = t32 * t4;
  t35 = 0.47e2 - 0.7e1 * t33;
  t38 = t12 * t35 / 0.72e2 - 0.2e1 / 0.3e1;
  t40 = M_CBRT3;
  t41 = t40 * t40;
  t42 = M_PI * M_PI;
  t43 = POW_1_3(t42);
  t44 = t43 * t43;
  t45 = t41 * t44;
  t46 = 0.1e1 / t2;
  t47 = t7 * t46;
  t48 = 0.1e1 + t47;
  t49 = t48 <= p->zeta_threshold;
  t50 = p->zeta_threshold * p->zeta_threshold;
  t51 = POW_1_3(p->zeta_threshold);
  t52 = t51 * t51;
  t53 = t52 * t50;
  t54 = t48 * t48;
  t55 = POW_1_3(t48);
  t56 = t55 * t55;
  t57 = t56 * t54;
  t58 = my_piecewise3(t49, t53, t57);
  t59 = 0.1e1 - t47;
  t60 = t59 <= p->zeta_threshold;
  t61 = t59 * t59;
  t62 = POW_1_3(t59);
  t63 = t62 * t62;
  t64 = t63 * t61;
  t65 = my_piecewise3(t60, t53, t64);
  t66 = t58 + t65;
  t70 = M_CBRT2;
  t71 = t70 * t12;
  t73 = 0.5e1 / 0.2e1 - t33 / 0.18e2;
  t74 = rho[0] * rho[0];
  t75 = POW_1_3(rho[0]);
  t76 = t75 * t75;
  t78 = 0.1e1 / t76 / t74;
  t79 = sigma[0] * t78;
  t80 = t79 * t58;
  t81 = rho[1] * rho[1];
  t82 = POW_1_3(rho[1]);
  t83 = t82 * t82;
  t85 = 0.1e1 / t83 / t81;
  t86 = sigma[2] * t85;
  t87 = t86 * t65;
  t88 = t80 + t87;
  t89 = t73 * t88;
  t92 = t33 - 0.11e2;
  t94 = t52 * t50 * p->zeta_threshold;
  t97 = my_piecewise3(t49, t94, t56 * t54 * t48);
  t101 = my_piecewise3(t60, t94, t63 * t61 * t59);
  t103 = t101 * t86 + t79 * t97;
  t104 = t92 * t103;
  t109 = my_piecewise3(t49, t50, t54);
  t110 = t109 * sigma[2];
  t111 = t85 * t65;
  t114 = my_piecewise3(t60, t50, t61);
  t115 = t114 * sigma[0];
  t116 = t78 * t58;
  t122 = -t30 * t38 - 0.3e1 / 0.2e2 * t45 * t12 * t66 + t71 * t89 / 0.32e2 + t71 * t104 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t80 + 0.2e1 / 0.3e1 * t87 - t110 * t111 / 0.4e1 - t115 * t116 / 0.4e1) / 0.8e1;
  t123 = t24 * t122;
  t125 = params->b * t23;
  t126 = sqrt(M_PI);
  t127 = 0.1e1 / t126;
  t128 = t16 * t127;
  t130 = t125 * t128 * params->m2;
  t131 = params->m2 * params->m2;
  t132 = params->omega * params->omega;
  t134 = 0.1e1 / t27;
  t136 = exp(-t131 * t132 * t134);
  t137 = params->omega * t136;
  t138 = t4 * t12;
  t142 = t47 / 0.6e1;
  t143 = 0.7e1 / 0.6e1 + t142;
  t144 = t143 * sigma[0];
  t145 = t70 * t78;
  t146 = t145 * t58;
  t149 = 0.7e1 / 0.6e1 - t142;
  t150 = t149 * sigma[2];
  t151 = t70 * t85;
  t152 = t151 * t65;
  t155 = 0.7e1 / 0.6e1 * t30 - 0.7e1 / 0.48e2 * t70 * t88 + t144 * t146 / 0.8e1 + t150 * t152 / 0.8e1;
  tzk0 = params->a * (-t13 * t16 + t21 * t123 + t130 * t137 * t138 * t155 / 0.6e1);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t12, t13, t15, t16, t18, t20, t21;
  double t23, t24, t26, t27, t29, t30, t32, t33;
  double t35, t38, t40, t41, t42, t43, t44, t45;
  double t46, t47, t48, t49, t50, t51, t52, t53;
  double t54, t55, t56, t57, t58, t59, t60, t61;
  double t62, t63, t64, t65, t66, t70, t71, t73;
  double t74, t75, t76, t78, t79, t80, t81, t82;
  double t83, t85, t86, t87, t88, t89, t92, t94;
  double t97, t101, t103, t104, t109, t110, t111, t114;
  double t115, t116, t122, t123, t125, t126, t127, t128;
  double t130, t131, t132, t134, t136, t137, t138, t142;
  double t143, t144, t145, t146, t149, t150, t151, t152;
  double t155, tzk0;

  double t161, t162, t165, t166, t167, t169, t170, t171;
  double t174, t175, t176, t177, t178, t180, t181, t183;
  double t184, t185, t186, t188, t189, t190, t191, t194;
  double t195, t196, t197, t200, t201, t202, t203, t206;
  double t208, t209, t211, t213, t214, t216, t219, t220;
  double t221, t223, t228, t229, t230, t232, t233, t234;
  double t235, t237, t238, t242, t245, t246, t248, t251;
  double t252, t253, t255, t256, t257, t258, t264, t265;
  double t267, t272, t276, t278, t279, t287, t288, t291;
  double t296, t297, t300, t303, t309, t310, t312, t315;
  double t316, t317, t318, t319, t320, t322, t323, t325;
  double t326, t327, t328, t331, t332, t334, t335, t336;
  double t339, t340, t344, t345, t350, t353, t354, t357;
  double t358, t361, t364, t365, t368, t371, t376, tvrho0;
  double t379, t380, t384, t389, t390, t392, t393, t394;
  double t396, t397, t401, t404, t407, t408, t409, t411;
  double t412, t413, t420, t426, t428, t429, t437, t438;
  double t441, t444, t449, t450, t453, t459, t460, t462;
  double t469, t470, t473, t476, t477, t480, t481, t484;
  double t487, t492, tvrho1, t494, t495, t496, t499, t500;
  double t504, t510, t511, t513, t515, t516, t519, t524;
  double tvsigma0, t525, t529, t530, t535, tvsigma1, t536, t537;
  double t540, t541, t545, t551, t552, t555, t556, t559;
  double t564, tvsigma2;

  gga_c_lypr_params *params;

  assert(p->params != NULL);
  params = (gga_c_lypr_params * )(p->params);

  t1 = params->m1 * params->omega;
  t2 = rho[0] + rho[1];
  t3 = POW_1_3(t2);
  t4 = 0.1e1 / t3;
  t6 = erfc(t1 * t4);
  t7 = rho[0] - rho[1];
  t8 = t7 * t7;
  t9 = t2 * t2;
  t10 = 0.1e1 / t9;
  t12 = -t10 * t8 + 0.1e1;
  t13 = t6 * t12;
  t15 = t4 * params->d + 0.1e1;
  t16 = 0.1e1 / t15;
  t18 = params->m2 * params->omega;
  t20 = erfc(t18 * t4);
  t21 = t20 * params->b;
  t23 = exp(-params->c * t4);
  t24 = t23 * t16;
  t26 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t27 = t3 * t3;
  t29 = 0.1e1 / t27 / t9;
  t30 = t26 * t29;
  t32 = t16 * params->d + params->c;
  t33 = t32 * t4;
  t35 = 0.47e2 - 0.7e1 * t33;
  t38 = t12 * t35 / 0.72e2 - 0.2e1 / 0.3e1;
  t40 = M_CBRT3;
  t41 = t40 * t40;
  t42 = M_PI * M_PI;
  t43 = POW_1_3(t42);
  t44 = t43 * t43;
  t45 = t41 * t44;
  t46 = 0.1e1 / t2;
  t47 = t7 * t46;
  t48 = 0.1e1 + t47;
  t49 = t48 <= p->zeta_threshold;
  t50 = p->zeta_threshold * p->zeta_threshold;
  t51 = POW_1_3(p->zeta_threshold);
  t52 = t51 * t51;
  t53 = t52 * t50;
  t54 = t48 * t48;
  t55 = POW_1_3(t48);
  t56 = t55 * t55;
  t57 = t56 * t54;
  t58 = my_piecewise3(t49, t53, t57);
  t59 = 0.1e1 - t47;
  t60 = t59 <= p->zeta_threshold;
  t61 = t59 * t59;
  t62 = POW_1_3(t59);
  t63 = t62 * t62;
  t64 = t63 * t61;
  t65 = my_piecewise3(t60, t53, t64);
  t66 = t58 + t65;
  t70 = M_CBRT2;
  t71 = t70 * t12;
  t73 = 0.5e1 / 0.2e1 - t33 / 0.18e2;
  t74 = rho[0] * rho[0];
  t75 = POW_1_3(rho[0]);
  t76 = t75 * t75;
  t78 = 0.1e1 / t76 / t74;
  t79 = sigma[0] * t78;
  t80 = t79 * t58;
  t81 = rho[1] * rho[1];
  t82 = POW_1_3(rho[1]);
  t83 = t82 * t82;
  t85 = 0.1e1 / t83 / t81;
  t86 = sigma[2] * t85;
  t87 = t86 * t65;
  t88 = t80 + t87;
  t89 = t73 * t88;
  t92 = t33 - 0.11e2;
  t94 = t52 * t50 * p->zeta_threshold;
  t97 = my_piecewise3(t49, t94, t56 * t54 * t48);
  t101 = my_piecewise3(t60, t94, t63 * t61 * t59);
  t103 = t101 * t86 + t79 * t97;
  t104 = t92 * t103;
  t109 = my_piecewise3(t49, t50, t54);
  t110 = t109 * sigma[2];
  t111 = t85 * t65;
  t114 = my_piecewise3(t60, t50, t61);
  t115 = t114 * sigma[0];
  t116 = t78 * t58;
  t122 = -t30 * t38 - 0.3e1 / 0.2e2 * t45 * t12 * t66 + t71 * t89 / 0.32e2 + t71 * t104 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t80 + 0.2e1 / 0.3e1 * t87 - t110 * t111 / 0.4e1 - t115 * t116 / 0.4e1) / 0.8e1;
  t123 = t24 * t122;
  t125 = params->b * t23;
  t126 = sqrt(M_PI);
  t127 = 0.1e1 / t126;
  t128 = t16 * t127;
  t130 = t125 * t128 * params->m2;
  t131 = params->m2 * params->m2;
  t132 = params->omega * params->omega;
  t134 = 0.1e1 / t27;
  t136 = exp(-t131 * t132 * t134);
  t137 = params->omega * t136;
  t138 = t4 * t12;
  t142 = t47 / 0.6e1;
  t143 = 0.7e1 / 0.6e1 + t142;
  t144 = t143 * sigma[0];
  t145 = t70 * t78;
  t146 = t145 * t58;
  t149 = 0.7e1 / 0.6e1 - t142;
  t150 = t149 * sigma[2];
  t151 = t70 * t85;
  t152 = t151 * t65;
  t155 = 0.7e1 / 0.6e1 * t30 - 0.7e1 / 0.48e2 * t70 * t88 + t144 * t146 / 0.8e1 + t150 * t152 / 0.8e1;
  tzk0 = params->a * (-t13 * t16 + t21 * t123 + t130 * t137 * t138 * t155 / 0.6e1);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t161 = t2 * params->a;
  t162 = params->m1 * params->m1;
  t165 = exp(-t162 * t132 * t134);
  t166 = t127 * t165;
  t167 = t166 * params->m1;
  t169 = 0.1e1 / t3 / t2;
  t170 = params->omega * t169;
  t171 = t12 * t16;
  t174 = 0.2e1 / 0.3e1 * t167 * t170 * t171;
  t175 = t7 * t10;
  t176 = t9 * t2;
  t177 = 0.1e1 / t176;
  t178 = t8 * t177;
  t180 = -0.2e1 * t175 + 0.2e1 * t178;
  t181 = t6 * t180;
  t183 = t15 * t15;
  t184 = 0.1e1 / t183;
  t185 = t184 * params->d;
  t186 = t185 * t169;
  t188 = t13 * t186 / 0.3e1;
  t189 = t127 * t136;
  t190 = t189 * t18;
  t191 = t169 * params->b;
  t194 = 0.2e1 / 0.3e1 * t190 * t191 * t123;
  t195 = t21 * params->c;
  t196 = t169 * t23;
  t197 = t16 * t122;
  t200 = t195 * t196 * t197 / 0.3e1;
  t201 = t21 * t23;
  t202 = t184 * t122;
  t203 = params->d * t169;
  t206 = t201 * t202 * t203 / 0.3e1;
  t208 = 0.1e1 / t27 / t176;
  t209 = t26 * t208;
  t211 = 0.8e1 / 0.3e1 * t209 * t38;
  t213 = params->d * params->d;
  t214 = t213 * t184;
  t216 = 0.1e1 / t27 / t2;
  t219 = t169 * t32 - t214 * t216;
  t220 = 0.7e1 / 0.3e1 * t219;
  t221 = t12 * t220;
  t223 = t180 * t35 / 0.72e2 + t221 / 0.72e2;
  t228 = t56 * t48;
  t229 = t46 - t175;
  t230 = t228 * t229;
  t232 = my_piecewise3(t49, 0, 0.8e1 / 0.3e1 * t230);
  t233 = t63 * t59;
  t234 = -t229;
  t235 = t233 * t234;
  t237 = my_piecewise3(t60, 0, 0.8e1 / 0.3e1 * t235);
  t238 = t232 + t237;
  t242 = t70 * t180;
  t245 = t219 / 0.54e2;
  t246 = t245 * t88;
  t248 = t71 * t246 / 0.32e2;
  t251 = 0.1e1 / t76 / t74 / rho[0];
  t252 = sigma[0] * t251;
  t253 = t252 * t58;
  t255 = t79 * t232;
  t256 = t86 * t237;
  t257 = -0.8e1 / 0.3e1 * t253 + t255 + t256;
  t258 = t73 * t257;
  t264 = -t219 / 0.3e1;
  t265 = t264 * t103;
  t267 = t71 * t265 / 0.576e3;
  t272 = my_piecewise3(t49, 0, 0.11e2 / 0.3e1 * t57 * t229);
  t276 = my_piecewise3(t60, 0, 0.11e2 / 0.3e1 * t64 * t234);
  t278 = -0.8e1 / 0.3e1 * t252 * t97 + t79 * t272 + t86 * t276;
  t279 = t92 * t278;
  t287 = my_piecewise3(t49, 0, 0.2e1 * t48 * t229);
  t288 = t287 * sigma[2];
  t291 = t85 * t237;
  t296 = my_piecewise3(t60, 0, 0.2e1 * t59 * t234);
  t297 = t296 * sigma[0];
  t300 = t251 * t58;
  t303 = t78 * t232;
  t309 = t211 - t30 * t223 - 0.3e1 / 0.2e2 * t45 * t180 * t66 - 0.3e1 / 0.2e2 * t45 * t12 * t238 + t242 * t89 / 0.32e2 + t248 + t71 * t258 / 0.32e2 + t242 * t104 / 0.576e3 + t267 + t71 * t279 / 0.576e3 - t70 * (-0.16e2 / 0.9e1 * t253 + 0.2e1 / 0.3e1 * t255 + 0.2e1 / 0.3e1 * t256 - t288 * t111 / 0.4e1 - t110 * t291 / 0.4e1 - t297 * t116 / 0.4e1 + 0.2e1 / 0.3e1 * t115 * t300 - t115 * t303 / 0.4e1) / 0.8e1;
  t310 = t24 * t309;
  t312 = params->b * params->c;
  t315 = t312 * t216 * t23 * t16;
  t316 = t127 * params->m2;
  t317 = t316 * params->omega;
  t318 = t136 * t12;
  t319 = t318 * t155;
  t320 = t317 * t319;
  t322 = t315 * t320 / 0.18e2;
  t323 = t184 * t127;
  t325 = t125 * t323 * params->m2;
  t326 = t137 * t216;
  t327 = t12 * t155;
  t328 = t327 * params->d;
  t331 = t325 * t326 * t328 / 0.18e2;
  t332 = t131 * params->m2;
  t334 = t125 * t128 * t332;
  t335 = t132 * params->omega;
  t336 = t335 * t10;
  t339 = t334 * t336 * t319 / 0.9e1;
  t340 = t169 * t12;
  t344 = t130 * t137 * t340 * t155 / 0.18e2;
  t345 = t4 * t180;
  t350 = 0.28e2 / 0.9e1 * t209;
  t353 = t229 / 0.6e1;
  t354 = t353 * sigma[0];
  t357 = t70 * t251;
  t358 = t357 * t58;
  t361 = t145 * t232;
  t364 = -t353;
  t365 = t364 * sigma[2];
  t368 = t151 * t237;
  t371 = -t350 - 0.7e1 / 0.48e2 * t70 * t257 + t354 * t146 / 0.8e1 - t144 * t358 / 0.3e1 + t144 * t361 / 0.8e1 + t365 * t152 / 0.8e1 + t150 * t368 / 0.8e1;
  t376 = -t174 - t181 * t16 - t188 + t194 + t200 + t206 + t21 * t310 + t322 + t331 + t339 - t344 + t130 * t137 * t345 * t155 / 0.6e1 + t130 * t137 * t138 * t371 / 0.6e1;
  tvrho0 = t161 * t376 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t379 = 0.2e1 * t175 + 0.2e1 * t178;
  t380 = t6 * t379;
  t384 = t379 * t35 / 0.72e2 + t221 / 0.72e2;
  t389 = -t46 - t175;
  t390 = t228 * t389;
  t392 = my_piecewise3(t49, 0, 0.8e1 / 0.3e1 * t390);
  t393 = -t389;
  t394 = t233 * t393;
  t396 = my_piecewise3(t60, 0, 0.8e1 / 0.3e1 * t394);
  t397 = t392 + t396;
  t401 = t70 * t379;
  t404 = t79 * t392;
  t407 = 0.1e1 / t83 / t81 / rho[1];
  t408 = sigma[2] * t407;
  t409 = t408 * t65;
  t411 = t86 * t396;
  t412 = t404 - 0.8e1 / 0.3e1 * t409 + t411;
  t413 = t73 * t412;
  t420 = my_piecewise3(t49, 0, 0.11e2 / 0.3e1 * t57 * t389);
  t426 = my_piecewise3(t60, 0, 0.11e2 / 0.3e1 * t64 * t393);
  t428 = t79 * t420 - 0.8e1 / 0.3e1 * t408 * t101 + t86 * t426;
  t429 = t92 * t428;
  t437 = my_piecewise3(t49, 0, 0.2e1 * t48 * t389);
  t438 = t437 * sigma[2];
  t441 = t407 * t65;
  t444 = t85 * t396;
  t449 = my_piecewise3(t60, 0, 0.2e1 * t59 * t393);
  t450 = t449 * sigma[0];
  t453 = t78 * t392;
  t459 = t211 - t30 * t384 - 0.3e1 / 0.2e2 * t45 * t379 * t66 - 0.3e1 / 0.2e2 * t45 * t12 * t397 + t401 * t89 / 0.32e2 + t248 + t71 * t413 / 0.32e2 + t401 * t104 / 0.576e3 + t267 + t71 * t429 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t404 - 0.16e2 / 0.9e1 * t409 + 0.2e1 / 0.3e1 * t411 - t438 * t111 / 0.4e1 + 0.2e1 / 0.3e1 * t110 * t441 - t110 * t444 / 0.4e1 - t450 * t116 / 0.4e1 - t115 * t453 / 0.4e1) / 0.8e1;
  t460 = t24 * t459;
  t462 = t4 * t379;
  t469 = t389 / 0.6e1;
  t470 = t469 * sigma[0];
  t473 = t145 * t392;
  t476 = -t469;
  t477 = t476 * sigma[2];
  t480 = t70 * t407;
  t481 = t480 * t65;
  t484 = t151 * t396;
  t487 = -t350 - 0.7e1 / 0.48e2 * t70 * t412 + t470 * t146 / 0.8e1 + t144 * t473 / 0.8e1 + t477 * t152 / 0.8e1 - t150 * t481 / 0.3e1 + t150 * t484 / 0.8e1;
  t492 = -t174 - t380 * t16 - t188 + t194 + t200 + t206 + t21 * t460 + t322 + t331 + t339 - t344 + t130 * t137 * t462 * t155 / 0.6e1 + t130 * t137 * t138 * t487 / 0.6e1;
  tvrho1 = t161 * t492 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t494 = t29 * t38;
  t495 = t73 * t78;
  t496 = t495 * t58;
  t499 = t92 * t78;
  t500 = t499 * t97;
  t504 = t114 * t78;
  t510 = -t494 + t71 * t496 / 0.32e2 + t71 * t500 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t116 - t504 * t58 / 0.4e1) / 0.8e1;
  t511 = t24 * t510;
  t513 = 0.7e1 / 0.6e1 * t29;
  t515 = t143 * t78;
  t516 = t70 * t58;
  t519 = t513 - 0.7e1 / 0.48e2 * t146 + t515 * t516 / 0.8e1;
  t524 = t21 * t511 + t130 * t137 * t138 * t519 / 0.6e1;
  tvsigma0 = t161 * t524;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t525 = t16 * t29;
  t529 = t125 * t128;
  t530 = t136 * t177;
  t535 = -0.2e1 * t201 * t525 * t38 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t12;
  tvsigma1 = t161 * t535;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t536 = t73 * t85;
  t537 = t536 * t65;
  t540 = t92 * t85;
  t541 = t540 * t101;
  t545 = t109 * t85;
  t551 = -t494 + t71 * t537 / 0.32e2 + t71 * t541 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t111 - t545 * t65 / 0.4e1) / 0.8e1;
  t552 = t24 * t551;
  t555 = t149 * t85;
  t556 = t70 * t65;
  t559 = t513 - 0.7e1 / 0.48e2 * t152 + t555 * t556 / 0.8e1;
  t564 = t21 * t552 + t130 * t137 * t138 * t559 / 0.6e1;
  tvsigma2 = t161 * t564;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t12, t13, t15, t16, t18, t20, t21;
  double t23, t24, t26, t27, t29, t30, t32, t33;
  double t35, t38, t40, t41, t42, t43, t44, t45;
  double t46, t47, t48, t49, t50, t51, t52, t53;
  double t54, t55, t56, t57, t58, t59, t60, t61;
  double t62, t63, t64, t65, t66, t70, t71, t73;
  double t74, t75, t76, t78, t79, t80, t81, t82;
  double t83, t85, t86, t87, t88, t89, t92, t94;
  double t97, t101, t103, t104, t109, t110, t111, t114;
  double t115, t116, t122, t123, t125, t126, t127, t128;
  double t130, t131, t132, t134, t136, t137, t138, t142;
  double t143, t144, t145, t146, t149, t150, t151, t152;
  double t155, tzk0;

  double t161, t162, t165, t166, t167, t169, t170, t171;
  double t174, t175, t176, t177, t178, t180, t181, t183;
  double t184, t185, t186, t188, t189, t190, t191, t194;
  double t195, t196, t197, t200, t201, t202, t203, t206;
  double t208, t209, t211, t213, t214, t216, t219, t220;
  double t221, t223, t228, t229, t230, t232, t233, t234;
  double t235, t237, t238, t242, t245, t246, t248, t251;
  double t252, t253, t255, t256, t257, t258, t264, t265;
  double t267, t272, t276, t278, t279, t287, t288, t291;
  double t296, t297, t300, t303, t309, t310, t312, t315;
  double t316, t317, t318, t319, t320, t322, t323, t325;
  double t326, t327, t328, t331, t332, t334, t335, t336;
  double t339, t340, t344, t345, t350, t353, t354, t357;
  double t358, t361, t364, t365, t368, t371, t376, tvrho0;
  double t379, t380, t384, t389, t390, t392, t393, t394;
  double t396, t397, t401, t404, t407, t408, t409, t411;
  double t412, t413, t420, t426, t428, t429, t437, t438;
  double t441, t444, t449, t450, t453, t459, t460, t462;
  double t469, t470, t473, t476, t477, t480, t481, t484;
  double t487, t492, tvrho1, t494, t495, t496, t499, t500;
  double t504, t510, t511, t513, t515, t516, t519, t524;
  double tvsigma0, t525, t529, t530, t535, tvsigma1, t536, t537;
  double t540, t541, t545, t551, t552, t555, t556, t559;
  double t564, tvsigma2;

  double t565, t568, t569, t571, t572, t575, t576, t577;
  double t579, t580, t582, t583, t585, t586, t587, t588;
  double t589, t591, t592, t599, t600, t602, t603, t607;
  double t608, t609, t611, t615, t616, t620, t623, t627;
  double t628, t629, t631, t633, t635, t636, t638, t639;
  double t640, t642, t644, t645, t646, t648, t650, t651;
  double t652, t653, t658, t665, t666, t668, t669, t670;
  double t681, t688, t690, t691, t694, t698, t703, t704;
  double t705, t706, t715, t716, t721, t727, t728, t735;
  double t738, t741, t744, t747, t748, t750, t754, t756;
  double t757, t759, t761, t762, t766, t768, t769, t771;
  double t772, t773, t775, t776, t777, t779, t782, t784;
  double t786, t787, t789, t790, t791, t792, t795, t796;
  double t799, t803, t805, t814, t817, t818, t825, t826;
  double t829, t832, t835, t836, t841, t844, t849, t852;
  double t853, t854, t856, t857, t859, t860, t863, t865;
  double t866, t869, t870, t872, t873, t874, t875, t877;
  double t878, t879, t881, t883, t884, t886, t888, t890;
  double t891, t892, t895, t897, t899, t902, t903, t906;
  double t907, t909, t911, t912, t914, t916, t917, t918;
  double t919, t922, t923, t926, t928, t931, t932, t935;
  double t936, t938, t940, t943, t944, t946, t948, t949;
  double t952, t954, t955, t956, t957, t959, t961, t963;
  double t964, t965, t967, t968, t971, t972, t974, t976;
  double tv2rho20, t978, t979, t987, t990, t994, t995, t998;
  double t1002, t1003, t1007, t1008, t1011, t1017, t1018, t1020;
  double t1022, t1023, t1025, t1026, t1027, t1032, t1036, t1039;
  double t1040, t1046, t1050, t1056, t1060, t1062, t1063, t1079;
  double t1083, t1084, t1091, t1096, t1101, t1105, t1106, t1115;
  double t1118, t1121, t1125, t1128, t1130, t1132, t1133, t1134;
  double t1137, t1138, t1140, t1148, t1157, t1160, t1163, t1170;
  double t1175, t1178, t1183, t1185, t1187, t1190, t1194, t1196;
  double t1197, t1210, t1211, t1213, t1215, t1216, t1218, t1219;
  double t1221, t1223, t1224, t1226, t1232, t1234, t1236, t1238;
  double t1240, t1242, t1245, t1250, t1252, t1254, t1256, tv2rho21;
  double t1264, t1265, t1275, t1276, t1278, t1279, t1280, t1283;
  double t1284, t1285, t1287, t1288, t1289, t1291, t1293, t1294;
  double t1296, t1297, t1300, t1301, t1302, t1305, t1306, t1311;
  double t1314, t1315, t1322, t1323, t1326, t1329, t1332, t1341;
  double t1348, t1361, t1365, t1370, t1382, t1393, t1395, t1396;
  double t1402, t1411, t1412, t1419, t1422, t1425, t1431, t1432;
  double t1437, t1440, t1443, t1444, t1446, t1448, tv2rho22, t1450;
  double t1453, t1454, t1457, t1458, t1461, t1463, t1464, t1467;
  double t1468, t1470, t1471, t1472, t1475, t1480, t1481, t1483;
  double t1484, t1485, t1488, t1493, t1496, t1504, t1505, t1507;
  double t1508, t1510, t1511, t1512, t1515, t1518, t1522, t1527;
  double t1530, t1533, t1536, t1539, t1544, tv2rhosigma0, t1546, t1547;
  double t1548, t1551, t1552, t1553, t1556, t1557, t1558, t1561;
  double t1562, t1565, t1570, t1571, t1572, t1573, t1575, t1577;
  double t1578, t1582, t1583, t1584, t1588, t1589, t1593, t1598;
  double tv2rhosigma1, t1600, t1603, t1604, t1607, t1608, t1611, t1614;
  double t1615, t1617, t1618, t1623, t1624, t1626, t1627, t1631;
  double t1639, t1640, t1642, t1643, t1645, t1646, t1647, t1650;
  double t1653, t1657, t1663, t1666, t1669, t1674, tv2rhosigma2, t1676;
  double t1679, t1684, t1688, t1696, t1697, t1704, t1707, t1710;
  double t1715, tv2rhosigma3, t1724, tv2rhosigma4, t1728, t1729, t1732, t1737;
  double t1738, t1741, t1746, t1749, t1757, t1758, t1766, t1769;
  double t1772, t1775, t1780, tv2rhosigma5, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, tv2sigma25;

  gga_c_lypr_params *params;

  assert(p->params != NULL);
  params = (gga_c_lypr_params * )(p->params);

  t1 = params->m1 * params->omega;
  t2 = rho[0] + rho[1];
  t3 = POW_1_3(t2);
  t4 = 0.1e1 / t3;
  t6 = erfc(t1 * t4);
  t7 = rho[0] - rho[1];
  t8 = t7 * t7;
  t9 = t2 * t2;
  t10 = 0.1e1 / t9;
  t12 = -t10 * t8 + 0.1e1;
  t13 = t6 * t12;
  t15 = t4 * params->d + 0.1e1;
  t16 = 0.1e1 / t15;
  t18 = params->m2 * params->omega;
  t20 = erfc(t18 * t4);
  t21 = t20 * params->b;
  t23 = exp(-params->c * t4);
  t24 = t23 * t16;
  t26 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t27 = t3 * t3;
  t29 = 0.1e1 / t27 / t9;
  t30 = t26 * t29;
  t32 = t16 * params->d + params->c;
  t33 = t32 * t4;
  t35 = 0.47e2 - 0.7e1 * t33;
  t38 = t12 * t35 / 0.72e2 - 0.2e1 / 0.3e1;
  t40 = M_CBRT3;
  t41 = t40 * t40;
  t42 = M_PI * M_PI;
  t43 = POW_1_3(t42);
  t44 = t43 * t43;
  t45 = t41 * t44;
  t46 = 0.1e1 / t2;
  t47 = t7 * t46;
  t48 = 0.1e1 + t47;
  t49 = t48 <= p->zeta_threshold;
  t50 = p->zeta_threshold * p->zeta_threshold;
  t51 = POW_1_3(p->zeta_threshold);
  t52 = t51 * t51;
  t53 = t52 * t50;
  t54 = t48 * t48;
  t55 = POW_1_3(t48);
  t56 = t55 * t55;
  t57 = t56 * t54;
  t58 = my_piecewise3(t49, t53, t57);
  t59 = 0.1e1 - t47;
  t60 = t59 <= p->zeta_threshold;
  t61 = t59 * t59;
  t62 = POW_1_3(t59);
  t63 = t62 * t62;
  t64 = t63 * t61;
  t65 = my_piecewise3(t60, t53, t64);
  t66 = t58 + t65;
  t70 = M_CBRT2;
  t71 = t70 * t12;
  t73 = 0.5e1 / 0.2e1 - t33 / 0.18e2;
  t74 = rho[0] * rho[0];
  t75 = POW_1_3(rho[0]);
  t76 = t75 * t75;
  t78 = 0.1e1 / t76 / t74;
  t79 = sigma[0] * t78;
  t80 = t79 * t58;
  t81 = rho[1] * rho[1];
  t82 = POW_1_3(rho[1]);
  t83 = t82 * t82;
  t85 = 0.1e1 / t83 / t81;
  t86 = sigma[2] * t85;
  t87 = t86 * t65;
  t88 = t80 + t87;
  t89 = t73 * t88;
  t92 = t33 - 0.11e2;
  t94 = t52 * t50 * p->zeta_threshold;
  t97 = my_piecewise3(t49, t94, t56 * t54 * t48);
  t101 = my_piecewise3(t60, t94, t63 * t61 * t59);
  t103 = t101 * t86 + t79 * t97;
  t104 = t92 * t103;
  t109 = my_piecewise3(t49, t50, t54);
  t110 = t109 * sigma[2];
  t111 = t85 * t65;
  t114 = my_piecewise3(t60, t50, t61);
  t115 = t114 * sigma[0];
  t116 = t78 * t58;
  t122 = -t30 * t38 - 0.3e1 / 0.2e2 * t45 * t12 * t66 + t71 * t89 / 0.32e2 + t71 * t104 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t80 + 0.2e1 / 0.3e1 * t87 - t110 * t111 / 0.4e1 - t115 * t116 / 0.4e1) / 0.8e1;
  t123 = t24 * t122;
  t125 = params->b * t23;
  t126 = sqrt(M_PI);
  t127 = 0.1e1 / t126;
  t128 = t16 * t127;
  t130 = t125 * t128 * params->m2;
  t131 = params->m2 * params->m2;
  t132 = params->omega * params->omega;
  t134 = 0.1e1 / t27;
  t136 = exp(-t131 * t132 * t134);
  t137 = params->omega * t136;
  t138 = t4 * t12;
  t142 = t47 / 0.6e1;
  t143 = 0.7e1 / 0.6e1 + t142;
  t144 = t143 * sigma[0];
  t145 = t70 * t78;
  t146 = t145 * t58;
  t149 = 0.7e1 / 0.6e1 - t142;
  t150 = t149 * sigma[2];
  t151 = t70 * t85;
  t152 = t151 * t65;
  t155 = 0.7e1 / 0.6e1 * t30 - 0.7e1 / 0.48e2 * t70 * t88 + t144 * t146 / 0.8e1 + t150 * t152 / 0.8e1;
  tzk0 = params->a * (-t13 * t16 + t21 * t123 + t130 * t137 * t138 * t155 / 0.6e1);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t161 = t2 * params->a;
  t162 = params->m1 * params->m1;
  t165 = exp(-t162 * t132 * t134);
  t166 = t127 * t165;
  t167 = t166 * params->m1;
  t169 = 0.1e1 / t3 / t2;
  t170 = params->omega * t169;
  t171 = t12 * t16;
  t174 = 0.2e1 / 0.3e1 * t167 * t170 * t171;
  t175 = t7 * t10;
  t176 = t9 * t2;
  t177 = 0.1e1 / t176;
  t178 = t8 * t177;
  t180 = -0.2e1 * t175 + 0.2e1 * t178;
  t181 = t6 * t180;
  t183 = t15 * t15;
  t184 = 0.1e1 / t183;
  t185 = t184 * params->d;
  t186 = t185 * t169;
  t188 = t13 * t186 / 0.3e1;
  t189 = t127 * t136;
  t190 = t189 * t18;
  t191 = t169 * params->b;
  t194 = 0.2e1 / 0.3e1 * t190 * t191 * t123;
  t195 = t21 * params->c;
  t196 = t169 * t23;
  t197 = t16 * t122;
  t200 = t195 * t196 * t197 / 0.3e1;
  t201 = t21 * t23;
  t202 = t184 * t122;
  t203 = params->d * t169;
  t206 = t201 * t202 * t203 / 0.3e1;
  t208 = 0.1e1 / t27 / t176;
  t209 = t26 * t208;
  t211 = 0.8e1 / 0.3e1 * t209 * t38;
  t213 = params->d * params->d;
  t214 = t213 * t184;
  t216 = 0.1e1 / t27 / t2;
  t219 = t169 * t32 - t214 * t216;
  t220 = 0.7e1 / 0.3e1 * t219;
  t221 = t12 * t220;
  t223 = t180 * t35 / 0.72e2 + t221 / 0.72e2;
  t228 = t56 * t48;
  t229 = t46 - t175;
  t230 = t228 * t229;
  t232 = my_piecewise3(t49, 0, 0.8e1 / 0.3e1 * t230);
  t233 = t63 * t59;
  t234 = -t229;
  t235 = t233 * t234;
  t237 = my_piecewise3(t60, 0, 0.8e1 / 0.3e1 * t235);
  t238 = t232 + t237;
  t242 = t70 * t180;
  t245 = t219 / 0.54e2;
  t246 = t245 * t88;
  t248 = t71 * t246 / 0.32e2;
  t251 = 0.1e1 / t76 / t74 / rho[0];
  t252 = sigma[0] * t251;
  t253 = t252 * t58;
  t255 = t79 * t232;
  t256 = t86 * t237;
  t257 = -0.8e1 / 0.3e1 * t253 + t255 + t256;
  t258 = t73 * t257;
  t264 = -t219 / 0.3e1;
  t265 = t264 * t103;
  t267 = t71 * t265 / 0.576e3;
  t272 = my_piecewise3(t49, 0, 0.11e2 / 0.3e1 * t57 * t229);
  t276 = my_piecewise3(t60, 0, 0.11e2 / 0.3e1 * t64 * t234);
  t278 = -0.8e1 / 0.3e1 * t252 * t97 + t79 * t272 + t86 * t276;
  t279 = t92 * t278;
  t287 = my_piecewise3(t49, 0, 0.2e1 * t48 * t229);
  t288 = t287 * sigma[2];
  t291 = t85 * t237;
  t296 = my_piecewise3(t60, 0, 0.2e1 * t59 * t234);
  t297 = t296 * sigma[0];
  t300 = t251 * t58;
  t303 = t78 * t232;
  t309 = t211 - t30 * t223 - 0.3e1 / 0.2e2 * t45 * t180 * t66 - 0.3e1 / 0.2e2 * t45 * t12 * t238 + t242 * t89 / 0.32e2 + t248 + t71 * t258 / 0.32e2 + t242 * t104 / 0.576e3 + t267 + t71 * t279 / 0.576e3 - t70 * (-0.16e2 / 0.9e1 * t253 + 0.2e1 / 0.3e1 * t255 + 0.2e1 / 0.3e1 * t256 - t288 * t111 / 0.4e1 - t110 * t291 / 0.4e1 - t297 * t116 / 0.4e1 + 0.2e1 / 0.3e1 * t115 * t300 - t115 * t303 / 0.4e1) / 0.8e1;
  t310 = t24 * t309;
  t312 = params->b * params->c;
  t315 = t312 * t216 * t23 * t16;
  t316 = t127 * params->m2;
  t317 = t316 * params->omega;
  t318 = t136 * t12;
  t319 = t318 * t155;
  t320 = t317 * t319;
  t322 = t315 * t320 / 0.18e2;
  t323 = t184 * t127;
  t325 = t125 * t323 * params->m2;
  t326 = t137 * t216;
  t327 = t12 * t155;
  t328 = t327 * params->d;
  t331 = t325 * t326 * t328 / 0.18e2;
  t332 = t131 * params->m2;
  t334 = t125 * t128 * t332;
  t335 = t132 * params->omega;
  t336 = t335 * t10;
  t339 = t334 * t336 * t319 / 0.9e1;
  t340 = t169 * t12;
  t344 = t130 * t137 * t340 * t155 / 0.18e2;
  t345 = t4 * t180;
  t350 = 0.28e2 / 0.9e1 * t209;
  t353 = t229 / 0.6e1;
  t354 = t353 * sigma[0];
  t357 = t70 * t251;
  t358 = t357 * t58;
  t361 = t145 * t232;
  t364 = -t353;
  t365 = t364 * sigma[2];
  t368 = t151 * t237;
  t371 = -t350 - 0.7e1 / 0.48e2 * t70 * t257 + t354 * t146 / 0.8e1 - t144 * t358 / 0.3e1 + t144 * t361 / 0.8e1 + t365 * t152 / 0.8e1 + t150 * t368 / 0.8e1;
  t376 = -t174 - t181 * t16 - t188 + t194 + t200 + t206 + t21 * t310 + t322 + t331 + t339 - t344 + t130 * t137 * t345 * t155 / 0.6e1 + t130 * t137 * t138 * t371 / 0.6e1;
  tvrho0 = t161 * t376 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t379 = 0.2e1 * t175 + 0.2e1 * t178;
  t380 = t6 * t379;
  t384 = t379 * t35 / 0.72e2 + t221 / 0.72e2;
  t389 = -t46 - t175;
  t390 = t228 * t389;
  t392 = my_piecewise3(t49, 0, 0.8e1 / 0.3e1 * t390);
  t393 = -t389;
  t394 = t233 * t393;
  t396 = my_piecewise3(t60, 0, 0.8e1 / 0.3e1 * t394);
  t397 = t392 + t396;
  t401 = t70 * t379;
  t404 = t79 * t392;
  t407 = 0.1e1 / t83 / t81 / rho[1];
  t408 = sigma[2] * t407;
  t409 = t408 * t65;
  t411 = t86 * t396;
  t412 = t404 - 0.8e1 / 0.3e1 * t409 + t411;
  t413 = t73 * t412;
  t420 = my_piecewise3(t49, 0, 0.11e2 / 0.3e1 * t57 * t389);
  t426 = my_piecewise3(t60, 0, 0.11e2 / 0.3e1 * t64 * t393);
  t428 = t79 * t420 - 0.8e1 / 0.3e1 * t408 * t101 + t86 * t426;
  t429 = t92 * t428;
  t437 = my_piecewise3(t49, 0, 0.2e1 * t48 * t389);
  t438 = t437 * sigma[2];
  t441 = t407 * t65;
  t444 = t85 * t396;
  t449 = my_piecewise3(t60, 0, 0.2e1 * t59 * t393);
  t450 = t449 * sigma[0];
  t453 = t78 * t392;
  t459 = t211 - t30 * t384 - 0.3e1 / 0.2e2 * t45 * t379 * t66 - 0.3e1 / 0.2e2 * t45 * t12 * t397 + t401 * t89 / 0.32e2 + t248 + t71 * t413 / 0.32e2 + t401 * t104 / 0.576e3 + t267 + t71 * t429 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t404 - 0.16e2 / 0.9e1 * t409 + 0.2e1 / 0.3e1 * t411 - t438 * t111 / 0.4e1 + 0.2e1 / 0.3e1 * t110 * t441 - t110 * t444 / 0.4e1 - t450 * t116 / 0.4e1 - t115 * t453 / 0.4e1) / 0.8e1;
  t460 = t24 * t459;
  t462 = t4 * t379;
  t469 = t389 / 0.6e1;
  t470 = t469 * sigma[0];
  t473 = t145 * t392;
  t476 = -t469;
  t477 = t476 * sigma[2];
  t480 = t70 * t407;
  t481 = t480 * t65;
  t484 = t151 * t396;
  t487 = -t350 - 0.7e1 / 0.48e2 * t70 * t412 + t470 * t146 / 0.8e1 + t144 * t473 / 0.8e1 + t477 * t152 / 0.8e1 - t150 * t481 / 0.3e1 + t150 * t484 / 0.8e1;
  t492 = -t174 - t380 * t16 - t188 + t194 + t200 + t206 + t21 * t460 + t322 + t331 + t339 - t344 + t130 * t137 * t462 * t155 / 0.6e1 + t130 * t137 * t138 * t487 / 0.6e1;
  tvrho1 = t161 * t492 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t494 = t29 * t38;
  t495 = t73 * t78;
  t496 = t495 * t58;
  t499 = t92 * t78;
  t500 = t499 * t97;
  t504 = t114 * t78;
  t510 = -t494 + t71 * t496 / 0.32e2 + t71 * t500 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t116 - t504 * t58 / 0.4e1) / 0.8e1;
  t511 = t24 * t510;
  t513 = 0.7e1 / 0.6e1 * t29;
  t515 = t143 * t78;
  t516 = t70 * t58;
  t519 = t513 - 0.7e1 / 0.48e2 * t146 + t515 * t516 / 0.8e1;
  t524 = t21 * t511 + t130 * t137 * t138 * t519 / 0.6e1;
  tvsigma0 = t161 * t524;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t525 = t16 * t29;
  t529 = t125 * t128;
  t530 = t136 * t177;
  t535 = -0.2e1 * t201 * t525 * t38 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t12;
  tvsigma1 = t161 * t535;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t536 = t73 * t85;
  t537 = t536 * t65;
  t540 = t92 * t85;
  t541 = t540 * t101;
  t545 = t109 * t85;
  t551 = -t494 + t71 * t537 / 0.32e2 + t71 * t541 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t111 - t545 * t65 / 0.4e1) / 0.8e1;
  t552 = t24 * t551;
  t555 = t149 * t85;
  t556 = t70 * t65;
  t559 = t513 - 0.7e1 / 0.48e2 * t152 + t555 * t556 / 0.8e1;
  t564 = t21 * t552 + t130 * t137 * t138 * t559 / 0.6e1;
  tvsigma2 = t161 * t564;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t565 = params->a * t376;
  t568 = 0.1e1 / t3 / t9;
  t569 = t185 * t568;
  t571 = 0.4e1 / 0.9e1 * t13 * t569;
  t572 = t181 * t186;
  t575 = 0.1e1 / t183 / t15;
  t576 = t575 * t213;
  t577 = t576 * t29;
  t579 = 0.2e1 / 0.9e1 * t13 * t577;
  t580 = t9 * t9;
  t582 = 0.1e1 / t27 / t580;
  t583 = t26 * t582;
  t585 = 0.88e2 / 0.9e1 * t583 * t38;
  t586 = 0.2e1 * t10;
  t587 = t7 * t177;
  t588 = 0.8e1 * t587;
  t589 = 0.1e1 / t580;
  t591 = 0.6e1 * t8 * t589;
  t592 = -t586 + t588 - t591;
  t599 = t229 * t229;
  t600 = t56 * t599;
  t602 = -t10 + t587;
  t603 = 0.2e1 * t602;
  t607 = my_piecewise3(t49, 0, 0.4e2 / 0.9e1 * t600 + 0.8e1 / 0.3e1 * t228 * t603);
  t608 = t234 * t234;
  t609 = t63 * t608;
  t611 = -t603;
  t615 = my_piecewise3(t60, 0, 0.4e2 / 0.9e1 * t609 + 0.8e1 / 0.3e1 * t233 * t611);
  t616 = t607 + t615;
  t620 = t70 * t592;
  t623 = t242 * t246;
  t627 = t213 * params->d;
  t628 = t627 * t575;
  t629 = t628 * t177;
  t631 = t214 * t29;
  t633 = t32 * t568;
  t635 = -t629 / 0.81e2 + t631 / 0.27e2 - 0.2e1 / 0.81e2 * t633;
  t636 = t635 * t88;
  t638 = t71 * t636 / 0.32e2;
  t639 = t245 * t257;
  t640 = t71 * t639;
  t642 = t74 * t74;
  t644 = 0.1e1 / t76 / t642;
  t645 = sigma[0] * t644;
  t646 = t645 * t58;
  t648 = t252 * t232;
  t650 = t79 * t607;
  t651 = t86 * t615;
  t652 = 0.88e2 / 0.9e1 * t646 - 0.16e2 / 0.3e1 * t648 + t650 + t651;
  t653 = t73 * t652;
  t658 = t242 * t265;
  t665 = 0.2e1 / 0.9e1 * t629 - 0.2e1 / 0.3e1 * t631 + 0.4e1 / 0.9e1 * t633;
  t666 = t665 * t103;
  t668 = t71 * t666 / 0.576e3;
  t669 = t264 * t278;
  t670 = t71 * t669;
  t681 = my_piecewise3(t49, 0, 0.88e2 / 0.9e1 * t228 * t599 + 0.11e2 / 0.3e1 * t57 * t603);
  t688 = my_piecewise3(t60, 0, 0.88e2 / 0.9e1 * t233 * t608 + 0.11e2 / 0.3e1 * t64 * t611);
  t690 = 0.88e2 / 0.9e1 * t645 * t97 - 0.16e2 / 0.3e1 * t252 * t272 + t79 * t681 + t86 * t688;
  t691 = t92 * t690;
  t694 = t209 * t223;
  t698 = t180 * t220;
  t703 = -0.14e2 / 0.9e1 * t629 + 0.14e2 / 0.3e1 * t631 - 0.28e2 / 0.9e1 * t633;
  t704 = t12 * t703;
  t705 = t704 / 0.72e2;
  t706 = t592 * t35 / 0.72e2 + t698 / 0.36e2 + t705;
  t715 = my_piecewise3(t49, 0, 0.2e1 * t48 * t603 + 0.2e1 * t599);
  t716 = t715 * sigma[2];
  t721 = t85 * t615;
  t727 = my_piecewise3(t60, 0, 0.2e1 * t59 * t611 + 0.2e1 * t608);
  t728 = t727 * sigma[0];
  t735 = t644 * t58;
  t738 = t251 * t232;
  t741 = t78 * t607;
  t744 = 0.176e3 / 0.27e2 * t646 - 0.32e2 / 0.9e1 * t648 + 0.2e1 / 0.3e1 * t650 + 0.2e1 / 0.3e1 * t651 - t716 * t111 / 0.4e1 - t288 * t291 / 0.2e1 - t110 * t721 / 0.4e1 - t728 * t116 / 0.4e1 + 0.4e1 / 0.3e1 * t297 * t300 - t297 * t303 / 0.2e1 - 0.22e2 / 0.9e1 * t115 * t735 + 0.4e1 / 0.3e1 * t115 * t738 - t115 * t741 / 0.4e1;
  t747 = -t585 - 0.3e1 / 0.2e2 * t45 * t592 * t66 - 0.3e1 / 0.1e2 * t45 * t180 * t238 - 0.3e1 / 0.2e2 * t45 * t12 * t616 + t620 * t89 / 0.32e2 + t623 / 0.16e2 + t242 * t258 / 0.16e2 + t638 + t640 / 0.16e2 + t71 * t653 / 0.32e2 + t620 * t104 / 0.576e3 + t658 / 0.288e3 + t242 * t279 / 0.288e3 + t668 + t670 / 0.288e3 + t71 * t691 / 0.576e3 + 0.16e2 / 0.3e1 * t694 - t30 * t706 - t70 * t744 / 0.8e1;
  t748 = t24 * t747;
  t750 = t166 * t1;
  t754 = 0.4e1 / 0.9e1 * t750 * t29 * t12 * t185;
  t756 = t21 * params->c * t29;
  t757 = t23 * t184;
  t759 = t757 * t122 * params->d;
  t761 = 0.2e1 / 0.9e1 * t756 * t759;
  t762 = t568 * t12;
  t766 = 0.2e1 / 0.27e2 * t130 * t137 * t762 * t155;
  t768 = t189 * t18 * t29;
  t769 = t312 * t123;
  t771 = 0.4e1 / 0.9e1 * t768 * t769;
  t772 = t202 * params->d;
  t773 = t125 * t772;
  t775 = 0.4e1 / 0.9e1 * t768 * t773;
  t776 = t136 * t180;
  t777 = t776 * t155;
  t779 = t334 * t336 * t777;
  t782 = t318 * t371;
  t784 = t334 * t336 * t782;
  t786 = t131 * t131;
  t787 = t786 * params->m2;
  t789 = t125 * t128 * t787;
  t790 = t132 * t132;
  t791 = t790 * params->omega;
  t792 = t791 * t208;
  t795 = 0.2e1 / 0.27e2 * t789 * t792 * t319;
  t796 = t169 * t180;
  t799 = t130 * t137 * t796 * t155;
  t803 = t130 * t137 * t340 * t371;
  t805 = t4 * t592;
  t814 = 0.308e3 / 0.27e2 * t583;
  t817 = t602 / 0.3e1;
  t818 = t817 * sigma[0];
  t825 = t70 * t644;
  t826 = t825 * t58;
  t829 = t357 * t232;
  t832 = t145 * t607;
  t835 = -t817;
  t836 = t835 * sigma[2];
  t841 = t151 * t615;
  t844 = t814 - 0.7e1 / 0.48e2 * t70 * t652 + t818 * t146 / 0.8e1 - 0.2e1 / 0.3e1 * t354 * t358 + t354 * t361 / 0.4e1 + 0.11e2 / 0.9e1 * t144 * t826 - 0.2e1 / 0.3e1 * t144 * t829 + t144 * t832 / 0.8e1 + t836 * t152 / 0.8e1 + t365 * t368 / 0.4e1 + t150 * t841 / 0.8e1;
  t849 = t335 * t177;
  t852 = 0.7e1 / 0.27e2 * t334 * t849 * t319;
  t853 = t317 * t777;
  t854 = t315 * t853;
  t856 = t317 * t782;
  t857 = t315 * t856;
  t859 = params->c * params->c;
  t860 = params->b * t859;
  t863 = t860 * t177 * t23 * t16;
  t865 = t863 * t320 / 0.54e2;
  t866 = 0.2e1 / 0.9e1 * t784 + t795 - t799 / 0.9e1 - t803 / 0.9e1 + t130 * t137 * t805 * t155 / 0.6e1 + t130 * t137 * t345 * t371 / 0.3e1 + t130 * t137 * t138 * t844 / 0.6e1 - t852 + t854 / 0.9e1 + t857 / 0.9e1 + t865;
  t869 = 0.1e1 / t3 / t176;
  t870 = t869 * t23;
  t872 = t312 * t870 * t16;
  t873 = t127 * t332;
  t874 = t873 * t335;
  t875 = t874 * t319;
  t877 = 0.2e1 / 0.27e2 * t872 * t875;
  t878 = t180 * t155;
  t879 = t878 * params->d;
  t881 = t325 * t326 * t879;
  t883 = t12 * t371;
  t884 = t883 * params->d;
  t886 = t325 * t326 * t884;
  t888 = t575 * t127;
  t890 = t125 * t888 * params->m2;
  t891 = t137 * t177;
  t892 = t327 * t213;
  t895 = t890 * t891 * t892 / 0.27e2;
  t897 = t125 * t323 * t332;
  t899 = t335 * t869 * t136;
  t902 = 0.2e1 / 0.27e2 * t897 * t899 * t328;
  t903 = t137 * t29;
  t906 = t325 * t903 * t328 / 0.9e1;
  t907 = t29 * t23;
  t909 = t312 * t907 * t16;
  t911 = t909 * t320 / 0.9e1;
  t912 = t180 * t16;
  t914 = t167 * t170 * t912;
  t916 = t162 * params->m1;
  t917 = t127 * t916;
  t918 = t917 * t335;
  t919 = t177 * t165;
  t922 = 0.4e1 / 0.9e1 * t918 * t919 * t171;
  t923 = params->omega * t568;
  t926 = 0.8e1 / 0.9e1 * t167 * t923 * t171;
  t928 = t568 * t23;
  t931 = 0.4e1 / 0.9e1 * t195 * t928 * t197;
  t932 = params->d * t568;
  t935 = 0.4e1 / 0.9e1 * t201 * t202 * t932;
  t936 = t16 * t309;
  t938 = t195 * t196 * t936;
  t940 = t21 * t859;
  t943 = t940 * t907 * t197 / 0.9e1;
  t944 = t184 * t309;
  t946 = t201 * t944 * t203;
  t948 = t575 * t122;
  t949 = t213 * t29;
  t952 = 0.2e1 / 0.9e1 * t201 * t948 * t949;
  t954 = t757 * t127;
  t955 = t312 * t177 * t954;
  t956 = t18 * t136;
  t957 = t956 * t328;
  t959 = t955 * t957 / 0.27e2;
  t961 = t190 * t191 * t310;
  t963 = t873 * t849;
  t964 = t136 * params->b;
  t965 = t964 * t123;
  t967 = 0.4e1 / 0.9e1 * t963 * t965;
  t968 = t568 * params->b;
  t971 = 0.8e1 / 0.9e1 * t190 * t968 * t123;
  t972 = t6 * t592;
  t974 = -t931 - t935 + 0.2e1 / 0.3e1 * t938 + t943 + 0.2e1 / 0.3e1 * t946 + t952 + t959 + 0.4e1 / 0.3e1 * t961 + t967 - t971 - t972 * t16;
  t976 = t571 - 0.2e1 / 0.3e1 * t572 - t579 + t21 * t748 - t754 + t761 + t766 + t771 + t775 + 0.2e1 / 0.9e1 * t779 + t866 + t877 + t881 / 0.9e1 + t886 / 0.9e1 + t895 + t902 - t906 - t911 - 0.4e1 / 0.3e1 * t914 - t922 + t926 + t974;
  tv2rho20 = t161 * t976 + 0.2e1 * t565;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t978 = params->a * t492;
  t979 = t380 * t186;
  t987 = t56 * t389;
  t990 = t228 * t7;
  t994 = my_piecewise3(t49, 0, 0.4e2 / 0.9e1 * t987 * t229 + 0.16e2 / 0.3e1 * t990 * t177);
  t995 = t63 * t393;
  t998 = t233 * t7;
  t1002 = my_piecewise3(t60, 0, 0.4e2 / 0.9e1 * t995 * t234 - 0.16e2 / 0.3e1 * t998 * t177);
  t1003 = t994 + t1002;
  t1007 = t586 - t591;
  t1008 = t70 * t1007;
  t1011 = t401 * t246;
  t1017 = t245 * t412;
  t1018 = t71 * t1017;
  t1020 = t252 * t392;
  t1022 = t79 * t994;
  t1023 = t408 * t237;
  t1025 = t86 * t1002;
  t1026 = -0.8e1 / 0.3e1 * t1020 + t1022 - 0.8e1 / 0.3e1 * t1023 + t1025;
  t1027 = t73 * t1026;
  t1032 = t401 * t265;
  t1036 = -t585 - 0.3e1 / 0.2e2 * t45 * t379 * t238 - 0.3e1 / 0.2e2 * t45 * t180 * t397 - 0.3e1 / 0.2e2 * t45 * t12 * t1003 + t1008 * t89 / 0.32e2 + t1011 / 0.32e2 + t401 * t258 / 0.32e2 + t242 * t413 / 0.32e2 + t1018 / 0.32e2 + t71 * t1027 / 0.32e2 + t1008 * t104 / 0.576e3 + t1032 / 0.576e3 + t401 * t279 / 0.576e3;
  t1039 = t264 * t428;
  t1040 = t71 * t1039;
  t1046 = t57 * t7;
  t1050 = my_piecewise3(t49, 0, 0.88e2 / 0.9e1 * t390 * t229 + 0.22e2 / 0.3e1 * t1046 * t177);
  t1056 = t64 * t7;
  t1060 = my_piecewise3(t60, 0, 0.88e2 / 0.9e1 * t394 * t234 - 0.22e2 / 0.3e1 * t1056 * t177);
  t1062 = -0.8e1 / 0.3e1 * t252 * t420 + t79 * t1050 - 0.8e1 / 0.3e1 * t408 * t276 + t86 * t1060;
  t1063 = t92 * t1062;
  t1079 = t48 * t7;
  t1083 = my_piecewise3(t49, 0, 0.4e1 * t1079 * t177 + 0.2e1 * t229 * t389);
  t1084 = t1083 * sigma[2];
  t1091 = t407 * t237;
  t1096 = t85 * t1002;
  t1101 = t59 * t7;
  t1105 = my_piecewise3(t60, 0, -0.4e1 * t1101 * t177 + 0.2e1 * t234 * t393);
  t1106 = t1105 * sigma[0];
  t1115 = t251 * t392;
  t1118 = t78 * t994;
  t1121 = -0.16e2 / 0.9e1 * t1020 + 0.2e1 / 0.3e1 * t1022 - 0.16e2 / 0.9e1 * t1023 + 0.2e1 / 0.3e1 * t1025 - t1084 * t111 / 0.4e1 - t438 * t291 / 0.4e1 + 0.2e1 / 0.3e1 * t288 * t441 + 0.2e1 / 0.3e1 * t110 * t1091 - t288 * t444 / 0.4e1 - t110 * t1096 / 0.4e1 - t1106 * t116 / 0.4e1 + 0.2e1 / 0.3e1 * t450 * t300 - t450 * t303 / 0.4e1 - t297 * t453 / 0.4e1 + 0.2e1 / 0.3e1 * t115 * t1115 - t115 * t1118 / 0.4e1;
  t1125 = t209 * t384;
  t1128 = t379 * t220;
  t1130 = t1007 * t35 / 0.72e2 + t1128 / 0.72e2 + t698 / 0.72e2 + t704 / 0.72e2;
  t1132 = t242 * t429 / 0.576e3 + t1040 / 0.576e3 + t71 * t1063 / 0.576e3 - 0.3e1 / 0.2e2 * t45 * t1007 * t66 + t623 / 0.32e2 + t638 + t640 / 0.32e2 + t658 / 0.576e3 + t668 + t670 / 0.576e3 - t70 * t1121 / 0.8e1 + 0.8e1 / 0.3e1 * t694 + 0.8e1 / 0.3e1 * t1125 - t30 * t1130;
  t1133 = t1036 + t1132;
  t1134 = t24 * t1133;
  t1137 = t136 * t379;
  t1138 = t1137 * t155;
  t1140 = t334 * t336 * t1138;
  t1148 = t587 * sigma[0];
  t1157 = t357 * t392;
  t1160 = t145 * t994;
  t1163 = t587 * sigma[2];
  t1170 = t480 * t237;
  t1175 = t151 * t1002;
  t1178 = t814 - 0.7e1 / 0.48e2 * t70 * t1026 + t1148 * t146 / 0.24e2 - t470 * t358 / 0.3e1 + t470 * t361 / 0.8e1 + t354 * t473 / 0.8e1 - t144 * t1157 / 0.3e1 + t144 * t1160 / 0.8e1 - t1163 * t152 / 0.24e2 + t477 * t368 / 0.8e1 - t365 * t481 / 0.3e1 - t150 * t1170 / 0.3e1 + t365 * t484 / 0.8e1 + t150 * t1175 / 0.8e1;
  t1183 = t318 * t487;
  t1185 = t334 * t336 * t1183;
  t1187 = t169 * t379;
  t1190 = t130 * t137 * t1187 * t155;
  t1194 = t130 * t137 * t340 * t487;
  t1196 = -t979 / 0.3e1 + t21 * t1134 + t571 - t572 / 0.3e1 - t579 - t754 + t761 + t1140 / 0.9e1 + t130 * t137 * t345 * t487 / 0.6e1 + t130 * t137 * t138 * t1178 / 0.6e1 + t1185 / 0.9e1 - t1190 / 0.18e2 - t1194 / 0.18e2 + t766;
  t1197 = t4 * t1007;
  t1210 = t12 * t487;
  t1211 = t1210 * params->d;
  t1213 = t325 * t326 * t1211;
  t1215 = t317 * t1138;
  t1216 = t315 * t1215;
  t1218 = t379 * t155;
  t1219 = t1218 * params->d;
  t1221 = t325 * t326 * t1219;
  t1223 = t317 * t1183;
  t1224 = t315 * t1223;
  t1226 = t130 * t137 * t1197 * t155 / 0.6e1 + t130 * t137 * t462 * t371 / 0.6e1 + t771 + t775 + t779 / 0.9e1 + t784 / 0.9e1 + t795 - t799 / 0.18e2 - t803 / 0.18e2 - t852 + t1213 / 0.18e2 + t1216 / 0.18e2 + t1221 / 0.18e2 + t1224 / 0.18e2;
  t1232 = t379 * t16;
  t1234 = t167 * t170 * t1232;
  t1236 = t16 * t459;
  t1238 = t195 * t196 * t1236;
  t1240 = t184 * t459;
  t1242 = t201 * t1240 * t203;
  t1245 = t854 / 0.18e2 + t857 / 0.18e2 + t865 + t877 + t881 / 0.18e2 + t886 / 0.18e2 + t895 + t902 - t906 - t911 - 0.2e1 / 0.3e1 * t1234 + t1238 / 0.3e1 + t1242 / 0.3e1 - 0.2e1 / 0.3e1 * t914;
  t1250 = t190 * t191 * t460;
  t1252 = t6 * t1007;
  t1254 = -t922 + t926 - t931 - t935 + t938 / 0.3e1 + t943 + t946 / 0.3e1 + t952 + t959 + 0.2e1 / 0.3e1 * t961 + t967 - t971 + 0.2e1 / 0.3e1 * t1250 - t1252 * t16;
  t1256 = t1196 + t1226 + t1245 + t1254;
  tv2rho21 = t1256 * t161 + t565 + t978;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1264 = -t586 - t588 - t591;
  t1265 = t4 * t1264;
  t1275 = t389 * t389;
  t1276 = t56 * t1275;
  t1278 = t10 + t587;
  t1279 = 0.2e1 * t1278;
  t1280 = t228 * t1279;
  t1283 = my_piecewise3(t49, 0, 0.4e2 / 0.9e1 * t1276 + 0.8e1 / 0.3e1 * t1280);
  t1284 = t79 * t1283;
  t1285 = t81 * t81;
  t1287 = 0.1e1 / t83 / t1285;
  t1288 = sigma[2] * t1287;
  t1289 = t1288 * t65;
  t1291 = t408 * t396;
  t1293 = t393 * t393;
  t1294 = t63 * t1293;
  t1296 = -t1279;
  t1297 = t233 * t1296;
  t1300 = my_piecewise3(t60, 0, 0.4e2 / 0.9e1 * t1294 + 0.8e1 / 0.3e1 * t1297);
  t1301 = t86 * t1300;
  t1302 = t1284 + 0.88e2 / 0.9e1 * t1289 - 0.16e2 / 0.3e1 * t1291 + t1301;
  t1305 = t1278 / 0.3e1;
  t1306 = t1305 * sigma[0];
  t1311 = t145 * t1283;
  t1314 = -t1305;
  t1315 = t1314 * sigma[2];
  t1322 = t70 * t1287;
  t1323 = t1322 * t65;
  t1326 = t480 * t396;
  t1329 = t151 * t1300;
  t1332 = t814 - 0.7e1 / 0.48e2 * t70 * t1302 + t1306 * t146 / 0.8e1 + t470 * t473 / 0.4e1 + t144 * t1311 / 0.8e1 + t1315 * t152 / 0.8e1 - 0.2e1 / 0.3e1 * t477 * t481 + t477 * t484 / 0.4e1 + 0.11e2 / 0.9e1 * t150 * t1323 - 0.2e1 / 0.3e1 * t150 * t1326 + t150 * t1329 / 0.8e1;
  t1341 = t130 * t137 * t462 * t487 / 0.3e1 + t130 * t137 * t138 * t1332 / 0.6e1 + t766 + t771 + t775 + t795 - t852 + t1213 / 0.9e1 + t1216 / 0.9e1 + t1221 / 0.9e1 + t1224 / 0.9e1;
  t1348 = t6 * t1264;
  t1361 = t1283 + t1300;
  t1365 = t70 * t1264;
  t1370 = t73 * t1302;
  t1382 = my_piecewise3(t49, 0, 0.88e2 / 0.9e1 * t228 * t1275 + 0.11e2 / 0.3e1 * t57 * t1279);
  t1393 = my_piecewise3(t60, 0, 0.88e2 / 0.9e1 * t233 * t1293 + 0.11e2 / 0.3e1 * t64 * t1296);
  t1395 = t79 * t1382 + 0.88e2 / 0.9e1 * t1288 * t101 - 0.16e2 / 0.3e1 * t408 * t426 + t86 * t1393;
  t1396 = t92 * t1395;
  t1402 = t1264 * t35 / 0.72e2 + t1128 / 0.36e2 + t705;
  t1411 = my_piecewise3(t49, 0, 0.2e1 * t1279 * t48 + 0.2e1 * t1275);
  t1412 = t1411 * sigma[2];
  t1419 = t1287 * t65;
  t1422 = t407 * t396;
  t1425 = t85 * t1300;
  t1431 = my_piecewise3(t60, 0, 0.2e1 * t1296 * t59 + 0.2e1 * t1293);
  t1432 = t1431 * sigma[0];
  t1437 = t78 * t1283;
  t1440 = 0.2e1 / 0.3e1 * t1284 + 0.176e3 / 0.27e2 * t1289 - 0.32e2 / 0.9e1 * t1291 + 0.2e1 / 0.3e1 * t1301 - t1412 * t111 / 0.4e1 + 0.4e1 / 0.3e1 * t438 * t441 - t438 * t444 / 0.2e1 - 0.22e2 / 0.9e1 * t110 * t1419 + 0.4e1 / 0.3e1 * t110 * t1422 - t110 * t1425 / 0.4e1 - t1432 * t116 / 0.4e1 - t450 * t453 / 0.2e1 - t115 * t1437 / 0.4e1;
  t1443 = -t585 + t638 + t668 + 0.16e2 / 0.3e1 * t1125 + t1011 / 0.16e2 + t1018 / 0.16e2 + t1032 / 0.288e3 + t1040 / 0.288e3 - 0.3e1 / 0.2e2 * t45 * t1264 * t66 - 0.3e1 / 0.1e2 * t45 * t379 * t397 - 0.3e1 / 0.2e2 * t45 * t12 * t1361 + t1365 * t89 / 0.32e2 + t401 * t413 / 0.16e2 + t71 * t1370 / 0.32e2 + t1365 * t104 / 0.576e3 + t401 * t429 / 0.288e3 + t71 * t1396 / 0.576e3 - t30 * t1402 - t70 * t1440 / 0.8e1;
  t1444 = t24 * t1443;
  t1446 = t926 - t931 - t935 + t943 + t952 + t959 + t967 - t971 + 0.4e1 / 0.3e1 * t1250 - t1348 * t16 + t21 * t1444;
  t1448 = -0.2e1 / 0.3e1 * t979 + t571 - t579 - t754 + t761 + 0.2e1 / 0.9e1 * t1140 + 0.2e1 / 0.9e1 * t1185 - t1190 / 0.9e1 - t1194 / 0.9e1 + t130 * t137 * t1265 * t155 / 0.6e1 + t1341 + t865 + t877 + t895 + t902 - t906 - t911 - 0.4e1 / 0.3e1 * t1234 + 0.2e1 / 0.3e1 * t1238 + 0.2e1 / 0.3e1 * t1242 - t922 + t1446;
  tv2rho22 = t1448 * t161 + 0.2e1 * t978;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1450 = params->a * t524;
  t1453 = 0.2e1 / 0.3e1 * t190 * t191 * t511;
  t1454 = t16 * t510;
  t1457 = t195 * t196 * t1454 / 0.3e1;
  t1458 = t184 * t510;
  t1461 = t201 * t1458 * t203 / 0.3e1;
  t1463 = 0.8e1 / 0.3e1 * t208 * t38;
  t1464 = t29 * t223;
  t1467 = t245 * t78;
  t1468 = t1467 * t58;
  t1470 = t71 * t1468 / 0.32e2;
  t1471 = t73 * t251;
  t1472 = t1471 * t58;
  t1475 = t495 * t232;
  t1480 = t264 * t78;
  t1481 = t1480 * t97;
  t1483 = t71 * t1481 / 0.576e3;
  t1484 = t92 * t251;
  t1485 = t1484 * t97;
  t1488 = t499 * t272;
  t1493 = t296 * t78;
  t1496 = t114 * t251;
  t1504 = t1463 - t1464 + t242 * t496 / 0.32e2 + t1470 - t71 * t1472 / 0.12e2 + t71 * t1475 / 0.32e2 + t242 * t500 / 0.576e3 + t1483 - t71 * t1485 / 0.216e3 + t71 * t1488 / 0.576e3 - t70 * (-0.16e2 / 0.9e1 * t300 + 0.2e1 / 0.3e1 * t303 - t1493 * t58 / 0.4e1 + 0.2e1 / 0.3e1 * t1496 * t58 - t504 * t232 / 0.4e1) / 0.8e1;
  t1505 = t24 * t1504;
  t1507 = t318 * t519;
  t1508 = t317 * t1507;
  t1510 = t315 * t1508 / 0.18e2;
  t1511 = t12 * t519;
  t1512 = t1511 * params->d;
  t1515 = t325 * t326 * t1512 / 0.18e2;
  t1518 = t334 * t336 * t1507 / 0.9e1;
  t1522 = t130 * t137 * t340 * t519 / 0.18e2;
  t1527 = 0.28e2 / 0.9e1 * t208;
  t1530 = t353 * t78;
  t1533 = t143 * t251;
  t1536 = t70 * t232;
  t1539 = -t1527 + 0.7e1 / 0.18e2 * t358 - 0.7e1 / 0.48e2 * t361 + t1530 * t516 / 0.8e1 - t1533 * t516 / 0.3e1 + t515 * t1536 / 0.8e1;
  t1544 = t1453 + t1457 + t1461 + t21 * t1505 + t1510 + t1515 + t1518 - t1522 + t130 * t137 * t345 * t519 / 0.6e1 + t130 * t137 * t138 * t1539 / 0.6e1;
  tv2rhosigma0 = t1544 * t161 + t1450;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1546 = params->a * t535;
  t1547 = t589 * params->b;
  t1548 = t24 * t38;
  t1551 = 0.4e1 / 0.3e1 * t190 * t1547 * t1548;
  t1552 = t589 * t23;
  t1553 = t16 * t38;
  t1556 = 0.2e1 / 0.3e1 * t195 * t1552 * t1553;
  t1557 = t184 * t589;
  t1558 = t38 * params->d;
  t1561 = 0.2e1 / 0.3e1 * t201 * t1557 * t1558;
  t1562 = t16 * t208;
  t1565 = 0.16e2 / 0.3e1 * t201 * t1562 * t38;
  t1570 = 0.1e1 / t3 / t580;
  t1571 = t1570 * t23;
  t1572 = t1571 * t16;
  t1573 = t312 * t1572;
  t1575 = t316 * t137 * t12;
  t1577 = 0.7e1 / 0.54e2 * t1573 * t1575;
  t1578 = t1570 * t12;
  t1582 = 0.7e1 / 0.54e2 * t325 * t137 * t1578 * params->d;
  t1583 = t332 * t335;
  t1584 = t582 * t136;
  t1588 = 0.7e1 / 0.27e2 * t529 * t1583 * t1584 * t12;
  t1589 = t136 * t589;
  t1593 = 0.7e1 / 0.6e1 * t529 * t18 * t1589 * t12;
  t1598 = -t1551 - t1556 - t1561 + t1565 - 0.2e1 * t201 * t525 * t223 + t1577 + t1582 + t1588 - t1593 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t180;
  tv2rhosigma1 = t1598 * t161 + t1546;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1600 = params->a * t564;
  t1603 = 0.2e1 / 0.3e1 * t190 * t191 * t552;
  t1604 = t16 * t551;
  t1607 = t195 * t196 * t1604 / 0.3e1;
  t1608 = t184 * t551;
  t1611 = t201 * t1608 * t203 / 0.3e1;
  t1614 = t245 * t85;
  t1615 = t1614 * t65;
  t1617 = t71 * t1615 / 0.32e2;
  t1618 = t536 * t237;
  t1623 = t264 * t85;
  t1624 = t1623 * t101;
  t1626 = t71 * t1624 / 0.576e3;
  t1627 = t540 * t276;
  t1631 = t287 * t85;
  t1639 = t1463 - t1464 + t242 * t537 / 0.32e2 + t1617 + t71 * t1618 / 0.32e2 + t242 * t541 / 0.576e3 + t1626 + t71 * t1627 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t291 - t1631 * t65 / 0.4e1 - t545 * t237 / 0.4e1) / 0.8e1;
  t1640 = t24 * t1639;
  t1642 = t318 * t559;
  t1643 = t317 * t1642;
  t1645 = t315 * t1643 / 0.18e2;
  t1646 = t12 * t559;
  t1647 = t1646 * params->d;
  t1650 = t325 * t326 * t1647 / 0.18e2;
  t1653 = t334 * t336 * t1642 / 0.9e1;
  t1657 = t130 * t137 * t340 * t559 / 0.18e2;
  t1663 = t364 * t85;
  t1666 = t70 * t237;
  t1669 = -t1527 - 0.7e1 / 0.48e2 * t368 + t1663 * t556 / 0.8e1 + t555 * t1666 / 0.8e1;
  t1674 = t1603 + t1607 + t1611 + t21 * t1640 + t1645 + t1650 + t1653 - t1657 + t130 * t137 * t345 * t559 / 0.6e1 + t130 * t137 * t138 * t1669 / 0.6e1;
  tv2rhosigma2 = t161 * t1674 + t1600;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1676 = t29 * t384;
  t1679 = t495 * t392;
  t1684 = t499 * t420;
  t1688 = t449 * t78;
  t1696 = t1463 - t1676 + t401 * t496 / 0.32e2 + t1470 + t71 * t1679 / 0.32e2 + t401 * t500 / 0.576e3 + t1483 + t71 * t1684 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t453 - t1688 * t58 / 0.4e1 - t504 * t392 / 0.4e1) / 0.8e1;
  t1697 = t24 * t1696;
  t1704 = t469 * t78;
  t1707 = t70 * t392;
  t1710 = -t1527 - 0.7e1 / 0.48e2 * t473 + t1704 * t516 / 0.8e1 + t515 * t1707 / 0.8e1;
  t1715 = t1453 + t1457 + t1461 + t21 * t1697 + t1510 + t1515 + t1518 - t1522 + t130 * t137 * t462 * t519 / 0.6e1 + t130 * t137 * t138 * t1710 / 0.6e1;
  tv2rhosigma3 = t161 * t1715 + t1450;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  t1724 = -t1551 - t1556 - t1561 + t1565 - 0.2e1 * t201 * t525 * t384 + t1577 + t1582 + t1588 - t1593 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t379;
  tv2rhosigma4 = t161 * t1724 + t1546;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1728 = t73 * t407;
  t1729 = t1728 * t65;
  t1732 = t536 * t396;
  t1737 = t92 * t407;
  t1738 = t1737 * t101;
  t1741 = t540 * t426;
  t1746 = t437 * t85;
  t1749 = t109 * t407;
  t1757 = t1463 - t1676 + t401 * t537 / 0.32e2 + t1617 - t71 * t1729 / 0.12e2 + t71 * t1732 / 0.32e2 + t401 * t541 / 0.576e3 + t1626 - t71 * t1738 / 0.216e3 + t71 * t1741 / 0.576e3 - t70 * (-0.16e2 / 0.9e1 * t441 + 0.2e1 / 0.3e1 * t444 - t1746 * t65 / 0.4e1 + 0.2e1 / 0.3e1 * t1749 * t65 - t545 * t396 / 0.4e1) / 0.8e1;
  t1758 = t24 * t1757;
  t1766 = t476 * t85;
  t1769 = t149 * t407;
  t1772 = t70 * t396;
  t1775 = -t1527 + 0.7e1 / 0.18e2 * t481 - 0.7e1 / 0.48e2 * t484 + t1766 * t556 / 0.8e1 - t1769 * t556 / 0.3e1 + t555 * t1772 / 0.8e1;
  t1780 = t1603 + t1607 + t1611 + t21 * t1758 + t1645 + t1650 + t1653 - t1657 + t130 * t137 * t462 * t559 / 0.6e1 + t130 * t137 * t138 * t1775 / 0.6e1;
  tv2rhosigma5 = t161 * t1780 + t1600;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  tv2sigma20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t12, t13, t15, t16, t18, t20, t21;
  double t23, t24, t26, t27, t29, t30, t32, t33;
  double t35, t38, t40, t41, t42, t43, t44, t45;
  double t46, t47, t48, t49, t50, t51, t52, t53;
  double t54, t55, t56, t57, t58, t59, t60, t61;
  double t62, t63, t64, t65, t66, t70, t71, t73;
  double t74, t75, t76, t78, t79, t80, t81, t82;
  double t83, t85, t86, t87, t88, t89, t92, t94;
  double t97, t101, t103, t104, t109, t110, t111, t114;
  double t115, t116, t122, t123, t125, t126, t127, t128;
  double t130, t131, t132, t134, t136, t137, t138, t142;
  double t143, t144, t145, t146, t149, t150, t151, t152;
  double t155, tzk0;

  double t161, t162, t165, t166, t167, t169, t170, t171;
  double t174, t175, t176, t177, t178, t180, t181, t183;
  double t184, t185, t186, t188, t189, t190, t191, t194;
  double t195, t196, t197, t200, t201, t202, t203, t206;
  double t208, t209, t211, t213, t214, t216, t219, t220;
  double t221, t223, t228, t229, t230, t232, t233, t234;
  double t235, t237, t238, t242, t245, t246, t248, t251;
  double t252, t253, t255, t256, t257, t258, t264, t265;
  double t267, t272, t276, t278, t279, t287, t288, t291;
  double t296, t297, t300, t303, t309, t310, t312, t315;
  double t316, t317, t318, t319, t320, t322, t323, t325;
  double t326, t327, t328, t331, t332, t334, t335, t336;
  double t339, t340, t344, t345, t350, t353, t354, t357;
  double t358, t361, t364, t365, t368, t371, t376, tvrho0;
  double t379, t380, t384, t389, t390, t392, t393, t394;
  double t396, t397, t401, t404, t407, t408, t409, t411;
  double t412, t413, t420, t426, t428, t429, t437, t438;
  double t441, t444, t449, t450, t453, t459, t460, t462;
  double t469, t470, t473, t476, t477, t480, t481, t484;
  double t487, t492, tvrho1, t494, t495, t496, t499, t500;
  double t504, t510, t511, t513, t515, t516, t519, t524;
  double tvsigma0, t525, t529, t530, t535, tvsigma1, t536, t537;
  double t540, t541, t545, t551, t552, t555, t556, t559;
  double t564, tvsigma2;

  double t565, t568, t569, t571, t572, t575, t576, t577;
  double t579, t580, t582, t583, t585, t586, t587, t588;
  double t589, t591, t592, t599, t600, t602, t603, t607;
  double t608, t609, t611, t615, t616, t620, t623, t627;
  double t628, t629, t631, t633, t635, t636, t638, t639;
  double t640, t642, t644, t645, t646, t648, t650, t651;
  double t652, t653, t658, t665, t666, t668, t669, t670;
  double t681, t688, t690, t691, t694, t698, t703, t704;
  double t705, t706, t715, t716, t721, t727, t728, t735;
  double t738, t741, t744, t747, t748, t750, t754, t756;
  double t757, t759, t761, t762, t766, t768, t769, t771;
  double t772, t773, t775, t776, t777, t779, t782, t784;
  double t786, t787, t789, t790, t791, t792, t795, t796;
  double t799, t803, t805, t814, t817, t818, t825, t826;
  double t829, t832, t835, t836, t841, t844, t849, t852;
  double t853, t854, t856, t857, t859, t860, t863, t865;
  double t866, t869, t870, t872, t873, t874, t875, t877;
  double t878, t879, t881, t883, t884, t886, t888, t890;
  double t891, t892, t895, t897, t899, t902, t903, t906;
  double t907, t909, t911, t912, t914, t916, t917, t918;
  double t919, t922, t923, t926, t928, t931, t932, t935;
  double t936, t938, t940, t943, t944, t946, t948, t949;
  double t952, t954, t955, t956, t957, t959, t961, t963;
  double t964, t965, t967, t968, t971, t972, t974, t976;
  double tv2rho20, t978, t979, t987, t990, t994, t995, t998;
  double t1002, t1003, t1007, t1008, t1011, t1017, t1018, t1020;
  double t1022, t1023, t1025, t1026, t1027, t1032, t1036, t1039;
  double t1040, t1046, t1050, t1056, t1060, t1062, t1063, t1079;
  double t1083, t1084, t1091, t1096, t1101, t1105, t1106, t1115;
  double t1118, t1121, t1125, t1128, t1130, t1132, t1133, t1134;
  double t1137, t1138, t1140, t1148, t1157, t1160, t1163, t1170;
  double t1175, t1178, t1183, t1185, t1187, t1190, t1194, t1196;
  double t1197, t1210, t1211, t1213, t1215, t1216, t1218, t1219;
  double t1221, t1223, t1224, t1226, t1232, t1234, t1236, t1238;
  double t1240, t1242, t1245, t1250, t1252, t1254, t1256, tv2rho21;
  double t1264, t1265, t1275, t1276, t1278, t1279, t1280, t1283;
  double t1284, t1285, t1287, t1288, t1289, t1291, t1293, t1294;
  double t1296, t1297, t1300, t1301, t1302, t1305, t1306, t1311;
  double t1314, t1315, t1322, t1323, t1326, t1329, t1332, t1341;
  double t1348, t1361, t1365, t1370, t1382, t1393, t1395, t1396;
  double t1402, t1411, t1412, t1419, t1422, t1425, t1431, t1432;
  double t1437, t1440, t1443, t1444, t1446, t1448, tv2rho22, t1450;
  double t1453, t1454, t1457, t1458, t1461, t1463, t1464, t1467;
  double t1468, t1470, t1471, t1472, t1475, t1480, t1481, t1483;
  double t1484, t1485, t1488, t1493, t1496, t1504, t1505, t1507;
  double t1508, t1510, t1511, t1512, t1515, t1518, t1522, t1527;
  double t1530, t1533, t1536, t1539, t1544, tv2rhosigma0, t1546, t1547;
  double t1548, t1551, t1552, t1553, t1556, t1557, t1558, t1561;
  double t1562, t1565, t1570, t1571, t1572, t1573, t1575, t1577;
  double t1578, t1582, t1583, t1584, t1588, t1589, t1593, t1598;
  double tv2rhosigma1, t1600, t1603, t1604, t1607, t1608, t1611, t1614;
  double t1615, t1617, t1618, t1623, t1624, t1626, t1627, t1631;
  double t1639, t1640, t1642, t1643, t1645, t1646, t1647, t1650;
  double t1653, t1657, t1663, t1666, t1669, t1674, tv2rhosigma2, t1676;
  double t1679, t1684, t1688, t1696, t1697, t1704, t1707, t1710;
  double t1715, tv2rhosigma3, t1724, tv2rhosigma4, t1728, t1729, t1732, t1737;
  double t1738, t1741, t1746, t1749, t1757, t1758, t1766, t1769;
  double t1772, t1775, t1780, tv2rhosigma5, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, tv2sigma25;

  double t1782, t1784, t1785, t1786, t1787, t1788, t1790, t1791;
  double t1792, t1795, t1796, t1798, t1799, t1800, t1802, t1803;
  double t1804, t1806, t1808, t1810, t1813, t1815, t1817, t1820;
  double t1822, t1824, t1825, t1827, t1828, t1831, t1832, t1835;
  double t1839, t1843, t1845, t1850, t1864, t1865, t1866, t1869;
  double t1870, t1879, t1882, t1884, t1885, t1888, t1891, t1895;
  double t1896, t1899, t1900, t1907, t1908, t1911, t1914, t1918;
  double t1919, t1922, t1923, t1925, t1927, t1929, t1930, t1931;
  double t1935, t1936, t1937, t1938, t1944, t1947, t1949, t1952;
  double t1953, t1956, t1960, t1962, t1965, t1966, t1970, t1971;
  double t1972, t1974, t1975, t1976, t1978, t1979, t1980, t1982;
  double t1983, t1986, t1988, t1990, t1992, t1994, t1996, t1999;
  double t2000, t2003, t2006, t2007, t2010, t2011, t2013, t2016;
  double t2018, t2020, t2021, t2022, t2025, t2026, t2028, t2029;
  double t2031, t2032, t2034, t2036, t2037, t2038, t2040, t2041;
  double t2044, t2046, t2048, t2049, t2050, t2051, t2053, t2055;
  double t2056, t2057, t2059, t2060, t2061, t2063, t2064, t2065;
  double t2066, t2068, t2071, t2073, t2075, t2076, t2077, t2079;
  double t2081, t2083, t2085, t2087, t2088, t2090, t2092, t2095;
  double t2101, t2108, t2113, t2114, t2121, t2124, t2129, t2130;
  double t2139, t2142, t2145, t2148, t2151, t2152, t2154, t2155;
  double t2170, t2179, t2181, t2182, t2185, t2189, t2191, t2199;
  double t2200, t2202, t2203, t2204, t2205, t2207, t2208, t2210;
  double t2213, t2216, t2220, t2222, t2230, t2231, t2233, t2243;
  double t2249, t2250, t2251, t2253, t2255, t2257, t2258, t2260;
  double t2261, t2265, t2267, t2270, t2272, t2274, t2277, t2279;
  double t2281, t2282, t2285, t2286, t2288, t2290, t2291, t2294;
  double t2297, t2299, t2300, t2301, t2303, t2307, t2311, t2313;
  double t2315, t2316, t2318, t2319, t2322, t2324, t2326, t2328;
  double t2330, t2331, t2333, t2336, t2338, t2340, t2341, t2342;
  double t2344, t2345, t2346, t2349, t2351, t2352, t2355, t2357;
  double t2358, t2359, t2360, t2361, t2362, t2364, t2365, t2368;
  double t2370, t2373, t2375, t2378, t2380, t2381, t2383, t2384;
  double t2386, t2388, t2389, t2391, t2392, t2394, t2396, t2397;
  double t2399, t2400, t2402, t2404, t2406, t2408, t2409, t2411;
  double t2412, t2413, t2414, t2416, t2417, t2418, t2420, t2422;
  double t2424, t2426, t2428, t2429, t2430, t2433, t2435, t2437;
  double t2440, t2441, t2444, t2446, t2448, t2449, t2452, t2455;
  double t2457, t2459, t2461, t2462, t2465, t2467, t2469, t2470;
  double t2472, t2474, t2475, t2478, tv3rho30, t2481, t2483, t2484;
  double t2489, t2490, t2491, t2492, t2496, t2497, t2501, t2503;
  double t2520, t2523, t2524, t2529, t2534, t2535, t2538, t2539;
  double t2544, t2549, t2550, t2554, t2555, t2559, t2562, t2565;
  double t2571, t2574, t2575, t2577, t2579, t2580, t2582, t2584;
  double t2585, t2587, t2588, t2589, t2592, t2597, t2600, t2603;
  double t2609, t2612, t2613, t2615, t2617, t2633, t2648, t2650;
  double t2651, t2654, t2666, t2671, t2672, t2679, t2680, t2689;
  double t2692, t2699, t2704, t2705, t2712, t2713, t2726, t2729;
  double t2732, t2746, t2748, t2749, t2751, t2753, t2766, t2775;
  double t2787, t2788, t2789, t2791, t2792, t2793, t2795, t2804;
  double t2805, t2808, t2813, t2816, t2818, t2828, t2831, t2832;
  double t2838, t2841, t2842, t2849, t2852, t2863, t2866, t2871;
  double t2876, t2883, t2890, t2895, t2900, t2901, t2906, t2910;
  double t2913, t2915, t2917, t2921, t2925, t2927, t2932, t2936;
  double t2938, t2940, t2943, t2947, t2955, t2968, t2970, t2972;
  double t2973, t2974, t2977, t2978, t2980, t2981, t2982, t2985;
  double t2986, t2987, t2990, t2992, t2994, t2995, t2996, t2999;
  double t3000, t3002, t3003, t3004, t3007, t3008, t3009, t3012;
  double t3014, t3017, t3019, t3021, t3023, t3025, t3028, t3030;
  double t3032, t3033, t3035, t3038, t3041, t3044, t3046, t3049;
  double t3050, t3053, t3054, t3057, t3059, t3062, t3064, t3066;
  double t3069, t3070, t3072, t3073, t3079, t3083, t3084, t3085;
  double t3087, t3091, tv3rho31, t3093, t3095, t3096, t3107, t3112;
  double t3114, t3117, t3121, t3125, t3126, t3141, t3146, t3151;
  double t3156, t3159, t3160, t3163, t3164, t3167, t3170, t3175;
  double t3176, t3179, t3188, t3193, t3196, t3199, t3200, t3207;
  double t3210, t3212, t3214, t3216, t3218, t3220, t3225, t3230;
  double t3235, t3239, t3245, t3258, t3273, t3275, t3276, t3279;
  double t3282, t3288, t3294, t3295, t3300, t3301, t3306, t3307;
  double t3313, t3319, t3320, t3337, t3341, t3343, t3344, t3348;
  double t3358, t3368, t3377, t3378, t3380, t3390, t3394, t3396;
  double t3405, t3406, t3421, t3424, t3427, t3428, t3429, t3444;
  double t3449, t3454, t3457, t3458, t3463, t3465, t3467, t3470;
  double t3474, t3478, t3488, t3495, t3507, t3508, t3510, t3511;
  double t3513, t3515, t3516, t3518, t3519, t3521, t3523, t3524;
  double t3526, t3527, t3529, t3533, t3538, t3540, t3542, t3544;
  double t3546, t3548, t3558, t3560, t3564, tv3rho32, t3568, t3569;
  double t3580, t3581, t3585, t3586, t3587, t3590, t3591, t3592;
  double t3596, t3597, t3600, t3601, t3605, t3612, t3615, t3616;
  double t3617, t3619, t3621, t3623, t3624, t3625, t3641, t3656;
  double t3658, t3659, t3666, t3679, t3680, t3689, t3692, t3695;
  double t3703, t3704, t3711, t3714, t3721, t3723, t3736, t3737;
  double t3738, t3741, t3742, t3747, t3760, t3764, t3780, t3781;
  double t3784, t3791, t3794, t3795, t3804, t3807, t3809, t3814;
  double t3819, t3828, t3843, t3853, t3856, tv3rho33, t3858, t3863;
  double t3866, t3871, t3883, t3887, t3888, t3890, t3891, t3892;
  double t3894, t3897, t3902, t3906, t3907, t3909, t3910, t3911;
  double t3912, t3914, t3917, t3922, t3923, t3924, t3926, t3927;
  double t3932, t3933, t3934, t3936, t3937, t3940, t3941, t3942;
  double t3944, t3945, t3946, t3947, t3949, t3951, t3952, t3953;
  double t3955, t3957, t3958, t3960, t3962, t3965, t3967, t3970;
  double t3973, t3974, t3975, t3976, t3978, t3979, t3980, t3983;
  double t3984, t3986, t3988, t3990, t3993, t3997, t3998, t4000;
  double t4001, t4002, t4004, t4005, t4007, t4010, t4014, t4017;
  double t4021, t4031, t4035, t4038, t4043, t4048, t4051, t4058;
  double t4061, t4062, t4064, t4068, t4069, t4071, t4073, t4076;
  double t4079, t4081, t4083, t4085, t4086, t4087, tv3rho2sigma0, t4089;
  double t4092, t4097, t4100, t4101, t4103, t4104, t4105, t4107;
  double t4109, t4110, t4112, t4113, t4114, t4115, t4118, t4119;
  double t4120, t4121, t4123, t4124, t4128, t4130, t4131, t4133;
  double t4135, t4136, t4138, t4140, t4141, t4143, t4144, t4146;
  double t4147, t4148, t4149, t4150, t4152, t4154, t4158, t4164;
  double t4165, t4168, t4169, t4172, t4173, t4175, t4179, t4180;
  double t4182, t4184, t4185, t4188, t4189, t4193, t4194, t4198;
  double t4199, t4202, t4203, t4205, t4207, t4208, t4209, t4211;
  double t4214, t4216, t4218, t4219, t4223, t4226, t4232, t4233;
  double tv3rho2sigma1, t4235, t4239, t4243, t4244, t4246, t4247, t4248;
  double t4250, t4255, t4259, t4260, t4262, t4263, t4264, t4266;
  double t4270, t4280, t4281, t4283, t4285, t4286, t4287, t4289;
  double t4291, t4294, t4297, t4298, t4299, t4300, t4302, t4303;
  double t4304, t4307, t4308, t4310, t4312, t4315, t4316, t4317;
  double t4319, t4322, t4324, t4326, t4331, t4334, t4341, t4345;
  double t4351, t4356, t4358, t4359, t4360, t4362, t4364, t4367;
  double t4371, t4374, t4378, t4381, t4384, t4385, t4387, t4391;
  double t4392, t4394, t4396, t4399, t4402, t4404, t4406, t4408;
  double t4409, t4410, tv3rho2sigma2, t4412, t4413, t4416, t4422, t4423;
  double t4425, t4430, t4436, t4437, t4439, t4442, t4445, t4450;
  double t4459, t4460, t4461, t4464, t4467, t4481, t4482, t4483;
  double t4485, t4486, t4488, t4490, t4491, t4492, t4494, t4495;
  double t4497, t4499, t4500, t4501, t4505, t4510, t4515, t4526;
  double t4536, t4545, t4548, t4555, t4559, t4561, t4564, t4566;
  double t4568, t4570, t4574, t4576, t4578, tv3rho2sigma3, t4580, t4586;
  double t4591, t4592, t4597, t4599, t4602, t4604, t4606, t4608;
  double t4615, t4617, t4619, t4627, t4629, t4630, tv3rho2sigma4, t4632;
  double t4635, t4641, t4642, t4643, t4645, t4650, t4651, t4653;
  double t4658, t4662, t4665, t4666, t4667, t4669, t4674, t4675;
  double t4677, t4686, t4691, t4703, t4704, t4705, t4707, t4708;
  double t4709, t4711, t4712, t4714, t4716, t4717, t4718, t4720;
  double t4721, t4723, t4728, t4734, t4746, t4753, t4756, t4762;
  double t4773, t4777, t4781, t4783, t4786, t4788, t4790, t4792;
  double t4796, t4798, t4800, tv3rho2sigma5, t4803, t4804, t4811, t4820;
  double t4824, t4834, t4835, t4850, t4855, t4858, t4863, t4871;
  double t4872, tv3rho2sigma6, t4881, t4891, t4892, tv3rho2sigma7, t4902, t4905;
  double t4910, t4915, t4918, t4940, t4943, t4948, t4960, t4961;
  double t4964, t4967, t4968, t4975, t4978, t4985, t4988, t4991;
  double t4992, t4993, t4995, t5003, t5004, tv3rho2sigma8, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, tv3rhosigma211, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35;
  double tv3sigma36, tv3sigma37, tv3sigma38, tv3sigma39;

  gga_c_lypr_params *params;

  assert(p->params != NULL);
  params = (gga_c_lypr_params * )(p->params);

  t1 = params->m1 * params->omega;
  t2 = rho[0] + rho[1];
  t3 = POW_1_3(t2);
  t4 = 0.1e1 / t3;
  t6 = erfc(t1 * t4);
  t7 = rho[0] - rho[1];
  t8 = t7 * t7;
  t9 = t2 * t2;
  t10 = 0.1e1 / t9;
  t12 = -t10 * t8 + 0.1e1;
  t13 = t6 * t12;
  t15 = t4 * params->d + 0.1e1;
  t16 = 0.1e1 / t15;
  t18 = params->m2 * params->omega;
  t20 = erfc(t18 * t4);
  t21 = t20 * params->b;
  t23 = exp(-params->c * t4);
  t24 = t23 * t16;
  t26 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t27 = t3 * t3;
  t29 = 0.1e1 / t27 / t9;
  t30 = t26 * t29;
  t32 = t16 * params->d + params->c;
  t33 = t32 * t4;
  t35 = 0.47e2 - 0.7e1 * t33;
  t38 = t12 * t35 / 0.72e2 - 0.2e1 / 0.3e1;
  t40 = M_CBRT3;
  t41 = t40 * t40;
  t42 = M_PI * M_PI;
  t43 = POW_1_3(t42);
  t44 = t43 * t43;
  t45 = t41 * t44;
  t46 = 0.1e1 / t2;
  t47 = t7 * t46;
  t48 = 0.1e1 + t47;
  t49 = t48 <= p->zeta_threshold;
  t50 = p->zeta_threshold * p->zeta_threshold;
  t51 = POW_1_3(p->zeta_threshold);
  t52 = t51 * t51;
  t53 = t52 * t50;
  t54 = t48 * t48;
  t55 = POW_1_3(t48);
  t56 = t55 * t55;
  t57 = t56 * t54;
  t58 = my_piecewise3(t49, t53, t57);
  t59 = 0.1e1 - t47;
  t60 = t59 <= p->zeta_threshold;
  t61 = t59 * t59;
  t62 = POW_1_3(t59);
  t63 = t62 * t62;
  t64 = t63 * t61;
  t65 = my_piecewise3(t60, t53, t64);
  t66 = t58 + t65;
  t70 = M_CBRT2;
  t71 = t70 * t12;
  t73 = 0.5e1 / 0.2e1 - t33 / 0.18e2;
  t74 = rho[0] * rho[0];
  t75 = POW_1_3(rho[0]);
  t76 = t75 * t75;
  t78 = 0.1e1 / t76 / t74;
  t79 = sigma[0] * t78;
  t80 = t79 * t58;
  t81 = rho[1] * rho[1];
  t82 = POW_1_3(rho[1]);
  t83 = t82 * t82;
  t85 = 0.1e1 / t83 / t81;
  t86 = sigma[2] * t85;
  t87 = t86 * t65;
  t88 = t80 + t87;
  t89 = t73 * t88;
  t92 = t33 - 0.11e2;
  t94 = t52 * t50 * p->zeta_threshold;
  t97 = my_piecewise3(t49, t94, t56 * t54 * t48);
  t101 = my_piecewise3(t60, t94, t63 * t61 * t59);
  t103 = t101 * t86 + t79 * t97;
  t104 = t92 * t103;
  t109 = my_piecewise3(t49, t50, t54);
  t110 = t109 * sigma[2];
  t111 = t85 * t65;
  t114 = my_piecewise3(t60, t50, t61);
  t115 = t114 * sigma[0];
  t116 = t78 * t58;
  t122 = -t30 * t38 - 0.3e1 / 0.2e2 * t45 * t12 * t66 + t71 * t89 / 0.32e2 + t71 * t104 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t80 + 0.2e1 / 0.3e1 * t87 - t110 * t111 / 0.4e1 - t115 * t116 / 0.4e1) / 0.8e1;
  t123 = t24 * t122;
  t125 = params->b * t23;
  t126 = sqrt(M_PI);
  t127 = 0.1e1 / t126;
  t128 = t16 * t127;
  t130 = t125 * t128 * params->m2;
  t131 = params->m2 * params->m2;
  t132 = params->omega * params->omega;
  t134 = 0.1e1 / t27;
  t136 = exp(-t131 * t132 * t134);
  t137 = params->omega * t136;
  t138 = t4 * t12;
  t142 = t47 / 0.6e1;
  t143 = 0.7e1 / 0.6e1 + t142;
  t144 = t143 * sigma[0];
  t145 = t70 * t78;
  t146 = t145 * t58;
  t149 = 0.7e1 / 0.6e1 - t142;
  t150 = t149 * sigma[2];
  t151 = t70 * t85;
  t152 = t151 * t65;
  t155 = 0.7e1 / 0.6e1 * t30 - 0.7e1 / 0.48e2 * t70 * t88 + t144 * t146 / 0.8e1 + t150 * t152 / 0.8e1;
  tzk0 = params->a * (-t13 * t16 + t21 * t123 + t130 * t137 * t138 * t155 / 0.6e1);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t161 = t2 * params->a;
  t162 = params->m1 * params->m1;
  t165 = exp(-t162 * t132 * t134);
  t166 = t127 * t165;
  t167 = t166 * params->m1;
  t169 = 0.1e1 / t3 / t2;
  t170 = params->omega * t169;
  t171 = t12 * t16;
  t174 = 0.2e1 / 0.3e1 * t167 * t170 * t171;
  t175 = t7 * t10;
  t176 = t9 * t2;
  t177 = 0.1e1 / t176;
  t178 = t8 * t177;
  t180 = -0.2e1 * t175 + 0.2e1 * t178;
  t181 = t6 * t180;
  t183 = t15 * t15;
  t184 = 0.1e1 / t183;
  t185 = t184 * params->d;
  t186 = t185 * t169;
  t188 = t13 * t186 / 0.3e1;
  t189 = t127 * t136;
  t190 = t189 * t18;
  t191 = t169 * params->b;
  t194 = 0.2e1 / 0.3e1 * t190 * t191 * t123;
  t195 = t21 * params->c;
  t196 = t169 * t23;
  t197 = t16 * t122;
  t200 = t195 * t196 * t197 / 0.3e1;
  t201 = t21 * t23;
  t202 = t184 * t122;
  t203 = params->d * t169;
  t206 = t201 * t202 * t203 / 0.3e1;
  t208 = 0.1e1 / t27 / t176;
  t209 = t26 * t208;
  t211 = 0.8e1 / 0.3e1 * t209 * t38;
  t213 = params->d * params->d;
  t214 = t213 * t184;
  t216 = 0.1e1 / t27 / t2;
  t219 = t169 * t32 - t214 * t216;
  t220 = 0.7e1 / 0.3e1 * t219;
  t221 = t12 * t220;
  t223 = t180 * t35 / 0.72e2 + t221 / 0.72e2;
  t228 = t56 * t48;
  t229 = t46 - t175;
  t230 = t228 * t229;
  t232 = my_piecewise3(t49, 0, 0.8e1 / 0.3e1 * t230);
  t233 = t63 * t59;
  t234 = -t229;
  t235 = t233 * t234;
  t237 = my_piecewise3(t60, 0, 0.8e1 / 0.3e1 * t235);
  t238 = t232 + t237;
  t242 = t70 * t180;
  t245 = t219 / 0.54e2;
  t246 = t245 * t88;
  t248 = t71 * t246 / 0.32e2;
  t251 = 0.1e1 / t76 / t74 / rho[0];
  t252 = sigma[0] * t251;
  t253 = t252 * t58;
  t255 = t79 * t232;
  t256 = t86 * t237;
  t257 = -0.8e1 / 0.3e1 * t253 + t255 + t256;
  t258 = t73 * t257;
  t264 = -t219 / 0.3e1;
  t265 = t264 * t103;
  t267 = t71 * t265 / 0.576e3;
  t272 = my_piecewise3(t49, 0, 0.11e2 / 0.3e1 * t57 * t229);
  t276 = my_piecewise3(t60, 0, 0.11e2 / 0.3e1 * t64 * t234);
  t278 = -0.8e1 / 0.3e1 * t252 * t97 + t79 * t272 + t86 * t276;
  t279 = t92 * t278;
  t287 = my_piecewise3(t49, 0, 0.2e1 * t48 * t229);
  t288 = t287 * sigma[2];
  t291 = t85 * t237;
  t296 = my_piecewise3(t60, 0, 0.2e1 * t59 * t234);
  t297 = t296 * sigma[0];
  t300 = t251 * t58;
  t303 = t78 * t232;
  t309 = t211 - t30 * t223 - 0.3e1 / 0.2e2 * t45 * t180 * t66 - 0.3e1 / 0.2e2 * t45 * t12 * t238 + t242 * t89 / 0.32e2 + t248 + t71 * t258 / 0.32e2 + t242 * t104 / 0.576e3 + t267 + t71 * t279 / 0.576e3 - t70 * (-0.16e2 / 0.9e1 * t253 + 0.2e1 / 0.3e1 * t255 + 0.2e1 / 0.3e1 * t256 - t288 * t111 / 0.4e1 - t110 * t291 / 0.4e1 - t297 * t116 / 0.4e1 + 0.2e1 / 0.3e1 * t115 * t300 - t115 * t303 / 0.4e1) / 0.8e1;
  t310 = t24 * t309;
  t312 = params->b * params->c;
  t315 = t312 * t216 * t23 * t16;
  t316 = t127 * params->m2;
  t317 = t316 * params->omega;
  t318 = t136 * t12;
  t319 = t318 * t155;
  t320 = t317 * t319;
  t322 = t315 * t320 / 0.18e2;
  t323 = t184 * t127;
  t325 = t125 * t323 * params->m2;
  t326 = t137 * t216;
  t327 = t12 * t155;
  t328 = t327 * params->d;
  t331 = t325 * t326 * t328 / 0.18e2;
  t332 = t131 * params->m2;
  t334 = t125 * t128 * t332;
  t335 = t132 * params->omega;
  t336 = t335 * t10;
  t339 = t334 * t336 * t319 / 0.9e1;
  t340 = t169 * t12;
  t344 = t130 * t137 * t340 * t155 / 0.18e2;
  t345 = t4 * t180;
  t350 = 0.28e2 / 0.9e1 * t209;
  t353 = t229 / 0.6e1;
  t354 = t353 * sigma[0];
  t357 = t70 * t251;
  t358 = t357 * t58;
  t361 = t145 * t232;
  t364 = -t353;
  t365 = t364 * sigma[2];
  t368 = t151 * t237;
  t371 = -t350 - 0.7e1 / 0.48e2 * t70 * t257 + t354 * t146 / 0.8e1 - t144 * t358 / 0.3e1 + t144 * t361 / 0.8e1 + t365 * t152 / 0.8e1 + t150 * t368 / 0.8e1;
  t376 = -t174 - t181 * t16 - t188 + t194 + t200 + t206 + t21 * t310 + t322 + t331 + t339 - t344 + t130 * t137 * t345 * t155 / 0.6e1 + t130 * t137 * t138 * t371 / 0.6e1;
  tvrho0 = t161 * t376 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t379 = 0.2e1 * t175 + 0.2e1 * t178;
  t380 = t6 * t379;
  t384 = t379 * t35 / 0.72e2 + t221 / 0.72e2;
  t389 = -t46 - t175;
  t390 = t228 * t389;
  t392 = my_piecewise3(t49, 0, 0.8e1 / 0.3e1 * t390);
  t393 = -t389;
  t394 = t233 * t393;
  t396 = my_piecewise3(t60, 0, 0.8e1 / 0.3e1 * t394);
  t397 = t392 + t396;
  t401 = t70 * t379;
  t404 = t79 * t392;
  t407 = 0.1e1 / t83 / t81 / rho[1];
  t408 = sigma[2] * t407;
  t409 = t408 * t65;
  t411 = t86 * t396;
  t412 = t404 - 0.8e1 / 0.3e1 * t409 + t411;
  t413 = t73 * t412;
  t420 = my_piecewise3(t49, 0, 0.11e2 / 0.3e1 * t57 * t389);
  t426 = my_piecewise3(t60, 0, 0.11e2 / 0.3e1 * t64 * t393);
  t428 = t79 * t420 - 0.8e1 / 0.3e1 * t408 * t101 + t86 * t426;
  t429 = t92 * t428;
  t437 = my_piecewise3(t49, 0, 0.2e1 * t48 * t389);
  t438 = t437 * sigma[2];
  t441 = t407 * t65;
  t444 = t85 * t396;
  t449 = my_piecewise3(t60, 0, 0.2e1 * t59 * t393);
  t450 = t449 * sigma[0];
  t453 = t78 * t392;
  t459 = t211 - t30 * t384 - 0.3e1 / 0.2e2 * t45 * t379 * t66 - 0.3e1 / 0.2e2 * t45 * t12 * t397 + t401 * t89 / 0.32e2 + t248 + t71 * t413 / 0.32e2 + t401 * t104 / 0.576e3 + t267 + t71 * t429 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t404 - 0.16e2 / 0.9e1 * t409 + 0.2e1 / 0.3e1 * t411 - t438 * t111 / 0.4e1 + 0.2e1 / 0.3e1 * t110 * t441 - t110 * t444 / 0.4e1 - t450 * t116 / 0.4e1 - t115 * t453 / 0.4e1) / 0.8e1;
  t460 = t24 * t459;
  t462 = t4 * t379;
  t469 = t389 / 0.6e1;
  t470 = t469 * sigma[0];
  t473 = t145 * t392;
  t476 = -t469;
  t477 = t476 * sigma[2];
  t480 = t70 * t407;
  t481 = t480 * t65;
  t484 = t151 * t396;
  t487 = -t350 - 0.7e1 / 0.48e2 * t70 * t412 + t470 * t146 / 0.8e1 + t144 * t473 / 0.8e1 + t477 * t152 / 0.8e1 - t150 * t481 / 0.3e1 + t150 * t484 / 0.8e1;
  t492 = -t174 - t380 * t16 - t188 + t194 + t200 + t206 + t21 * t460 + t322 + t331 + t339 - t344 + t130 * t137 * t462 * t155 / 0.6e1 + t130 * t137 * t138 * t487 / 0.6e1;
  tvrho1 = t161 * t492 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t494 = t29 * t38;
  t495 = t73 * t78;
  t496 = t495 * t58;
  t499 = t92 * t78;
  t500 = t499 * t97;
  t504 = t114 * t78;
  t510 = -t494 + t71 * t496 / 0.32e2 + t71 * t500 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t116 - t504 * t58 / 0.4e1) / 0.8e1;
  t511 = t24 * t510;
  t513 = 0.7e1 / 0.6e1 * t29;
  t515 = t143 * t78;
  t516 = t70 * t58;
  t519 = t513 - 0.7e1 / 0.48e2 * t146 + t515 * t516 / 0.8e1;
  t524 = t21 * t511 + t130 * t137 * t138 * t519 / 0.6e1;
  tvsigma0 = t161 * t524;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t525 = t16 * t29;
  t529 = t125 * t128;
  t530 = t136 * t177;
  t535 = -0.2e1 * t201 * t525 * t38 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t12;
  tvsigma1 = t161 * t535;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t536 = t73 * t85;
  t537 = t536 * t65;
  t540 = t92 * t85;
  t541 = t540 * t101;
  t545 = t109 * t85;
  t551 = -t494 + t71 * t537 / 0.32e2 + t71 * t541 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t111 - t545 * t65 / 0.4e1) / 0.8e1;
  t552 = t24 * t551;
  t555 = t149 * t85;
  t556 = t70 * t65;
  t559 = t513 - 0.7e1 / 0.48e2 * t152 + t555 * t556 / 0.8e1;
  t564 = t21 * t552 + t130 * t137 * t138 * t559 / 0.6e1;
  tvsigma2 = t161 * t564;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t565 = params->a * t376;
  t568 = 0.1e1 / t3 / t9;
  t569 = t185 * t568;
  t571 = 0.4e1 / 0.9e1 * t13 * t569;
  t572 = t181 * t186;
  t575 = 0.1e1 / t183 / t15;
  t576 = t575 * t213;
  t577 = t576 * t29;
  t579 = 0.2e1 / 0.9e1 * t13 * t577;
  t580 = t9 * t9;
  t582 = 0.1e1 / t27 / t580;
  t583 = t26 * t582;
  t585 = 0.88e2 / 0.9e1 * t583 * t38;
  t586 = 0.2e1 * t10;
  t587 = t7 * t177;
  t588 = 0.8e1 * t587;
  t589 = 0.1e1 / t580;
  t591 = 0.6e1 * t8 * t589;
  t592 = -t586 + t588 - t591;
  t599 = t229 * t229;
  t600 = t56 * t599;
  t602 = -t10 + t587;
  t603 = 0.2e1 * t602;
  t607 = my_piecewise3(t49, 0, 0.4e2 / 0.9e1 * t600 + 0.8e1 / 0.3e1 * t228 * t603);
  t608 = t234 * t234;
  t609 = t63 * t608;
  t611 = -t603;
  t615 = my_piecewise3(t60, 0, 0.4e2 / 0.9e1 * t609 + 0.8e1 / 0.3e1 * t233 * t611);
  t616 = t607 + t615;
  t620 = t70 * t592;
  t623 = t242 * t246;
  t627 = t213 * params->d;
  t628 = t627 * t575;
  t629 = t628 * t177;
  t631 = t214 * t29;
  t633 = t32 * t568;
  t635 = -t629 / 0.81e2 + t631 / 0.27e2 - 0.2e1 / 0.81e2 * t633;
  t636 = t635 * t88;
  t638 = t71 * t636 / 0.32e2;
  t639 = t245 * t257;
  t640 = t71 * t639;
  t642 = t74 * t74;
  t644 = 0.1e1 / t76 / t642;
  t645 = sigma[0] * t644;
  t646 = t645 * t58;
  t648 = t252 * t232;
  t650 = t79 * t607;
  t651 = t86 * t615;
  t652 = 0.88e2 / 0.9e1 * t646 - 0.16e2 / 0.3e1 * t648 + t650 + t651;
  t653 = t73 * t652;
  t658 = t242 * t265;
  t665 = 0.2e1 / 0.9e1 * t629 - 0.2e1 / 0.3e1 * t631 + 0.4e1 / 0.9e1 * t633;
  t666 = t665 * t103;
  t668 = t71 * t666 / 0.576e3;
  t669 = t264 * t278;
  t670 = t71 * t669;
  t681 = my_piecewise3(t49, 0, 0.88e2 / 0.9e1 * t228 * t599 + 0.11e2 / 0.3e1 * t57 * t603);
  t688 = my_piecewise3(t60, 0, 0.88e2 / 0.9e1 * t233 * t608 + 0.11e2 / 0.3e1 * t64 * t611);
  t690 = 0.88e2 / 0.9e1 * t645 * t97 - 0.16e2 / 0.3e1 * t252 * t272 + t79 * t681 + t86 * t688;
  t691 = t92 * t690;
  t694 = t209 * t223;
  t698 = t180 * t220;
  t703 = -0.14e2 / 0.9e1 * t629 + 0.14e2 / 0.3e1 * t631 - 0.28e2 / 0.9e1 * t633;
  t704 = t12 * t703;
  t705 = t704 / 0.72e2;
  t706 = t592 * t35 / 0.72e2 + t698 / 0.36e2 + t705;
  t715 = my_piecewise3(t49, 0, 0.2e1 * t48 * t603 + 0.2e1 * t599);
  t716 = t715 * sigma[2];
  t721 = t85 * t615;
  t727 = my_piecewise3(t60, 0, 0.2e1 * t59 * t611 + 0.2e1 * t608);
  t728 = t727 * sigma[0];
  t735 = t644 * t58;
  t738 = t251 * t232;
  t741 = t78 * t607;
  t744 = 0.176e3 / 0.27e2 * t646 - 0.32e2 / 0.9e1 * t648 + 0.2e1 / 0.3e1 * t650 + 0.2e1 / 0.3e1 * t651 - t716 * t111 / 0.4e1 - t288 * t291 / 0.2e1 - t110 * t721 / 0.4e1 - t728 * t116 / 0.4e1 + 0.4e1 / 0.3e1 * t297 * t300 - t297 * t303 / 0.2e1 - 0.22e2 / 0.9e1 * t115 * t735 + 0.4e1 / 0.3e1 * t115 * t738 - t115 * t741 / 0.4e1;
  t747 = -t585 - 0.3e1 / 0.2e2 * t45 * t592 * t66 - 0.3e1 / 0.1e2 * t45 * t180 * t238 - 0.3e1 / 0.2e2 * t45 * t12 * t616 + t620 * t89 / 0.32e2 + t623 / 0.16e2 + t242 * t258 / 0.16e2 + t638 + t640 / 0.16e2 + t71 * t653 / 0.32e2 + t620 * t104 / 0.576e3 + t658 / 0.288e3 + t242 * t279 / 0.288e3 + t668 + t670 / 0.288e3 + t71 * t691 / 0.576e3 + 0.16e2 / 0.3e1 * t694 - t30 * t706 - t70 * t744 / 0.8e1;
  t748 = t24 * t747;
  t750 = t166 * t1;
  t754 = 0.4e1 / 0.9e1 * t750 * t29 * t12 * t185;
  t756 = t21 * params->c * t29;
  t757 = t23 * t184;
  t759 = t757 * t122 * params->d;
  t761 = 0.2e1 / 0.9e1 * t756 * t759;
  t762 = t568 * t12;
  t766 = 0.2e1 / 0.27e2 * t130 * t137 * t762 * t155;
  t768 = t189 * t18 * t29;
  t769 = t312 * t123;
  t771 = 0.4e1 / 0.9e1 * t768 * t769;
  t772 = t202 * params->d;
  t773 = t125 * t772;
  t775 = 0.4e1 / 0.9e1 * t768 * t773;
  t776 = t136 * t180;
  t777 = t776 * t155;
  t779 = t334 * t336 * t777;
  t782 = t318 * t371;
  t784 = t334 * t336 * t782;
  t786 = t131 * t131;
  t787 = t786 * params->m2;
  t789 = t125 * t128 * t787;
  t790 = t132 * t132;
  t791 = t790 * params->omega;
  t792 = t791 * t208;
  t795 = 0.2e1 / 0.27e2 * t789 * t792 * t319;
  t796 = t169 * t180;
  t799 = t130 * t137 * t796 * t155;
  t803 = t130 * t137 * t340 * t371;
  t805 = t4 * t592;
  t814 = 0.308e3 / 0.27e2 * t583;
  t817 = t602 / 0.3e1;
  t818 = t817 * sigma[0];
  t825 = t70 * t644;
  t826 = t825 * t58;
  t829 = t357 * t232;
  t832 = t145 * t607;
  t835 = -t817;
  t836 = t835 * sigma[2];
  t841 = t151 * t615;
  t844 = t814 - 0.7e1 / 0.48e2 * t70 * t652 + t818 * t146 / 0.8e1 - 0.2e1 / 0.3e1 * t354 * t358 + t354 * t361 / 0.4e1 + 0.11e2 / 0.9e1 * t144 * t826 - 0.2e1 / 0.3e1 * t144 * t829 + t144 * t832 / 0.8e1 + t836 * t152 / 0.8e1 + t365 * t368 / 0.4e1 + t150 * t841 / 0.8e1;
  t849 = t335 * t177;
  t852 = 0.7e1 / 0.27e2 * t334 * t849 * t319;
  t853 = t317 * t777;
  t854 = t315 * t853;
  t856 = t317 * t782;
  t857 = t315 * t856;
  t859 = params->c * params->c;
  t860 = params->b * t859;
  t863 = t860 * t177 * t23 * t16;
  t865 = t863 * t320 / 0.54e2;
  t866 = 0.2e1 / 0.9e1 * t784 + t795 - t799 / 0.9e1 - t803 / 0.9e1 + t130 * t137 * t805 * t155 / 0.6e1 + t130 * t137 * t345 * t371 / 0.3e1 + t130 * t137 * t138 * t844 / 0.6e1 - t852 + t854 / 0.9e1 + t857 / 0.9e1 + t865;
  t869 = 0.1e1 / t3 / t176;
  t870 = t869 * t23;
  t872 = t312 * t870 * t16;
  t873 = t127 * t332;
  t874 = t873 * t335;
  t875 = t874 * t319;
  t877 = 0.2e1 / 0.27e2 * t872 * t875;
  t878 = t180 * t155;
  t879 = t878 * params->d;
  t881 = t325 * t326 * t879;
  t883 = t12 * t371;
  t884 = t883 * params->d;
  t886 = t325 * t326 * t884;
  t888 = t575 * t127;
  t890 = t125 * t888 * params->m2;
  t891 = t137 * t177;
  t892 = t327 * t213;
  t895 = t890 * t891 * t892 / 0.27e2;
  t897 = t125 * t323 * t332;
  t899 = t335 * t869 * t136;
  t902 = 0.2e1 / 0.27e2 * t897 * t899 * t328;
  t903 = t137 * t29;
  t906 = t325 * t903 * t328 / 0.9e1;
  t907 = t29 * t23;
  t909 = t312 * t907 * t16;
  t911 = t909 * t320 / 0.9e1;
  t912 = t180 * t16;
  t914 = t167 * t170 * t912;
  t916 = t162 * params->m1;
  t917 = t127 * t916;
  t918 = t917 * t335;
  t919 = t177 * t165;
  t922 = 0.4e1 / 0.9e1 * t918 * t919 * t171;
  t923 = params->omega * t568;
  t926 = 0.8e1 / 0.9e1 * t167 * t923 * t171;
  t928 = t568 * t23;
  t931 = 0.4e1 / 0.9e1 * t195 * t928 * t197;
  t932 = params->d * t568;
  t935 = 0.4e1 / 0.9e1 * t201 * t202 * t932;
  t936 = t16 * t309;
  t938 = t195 * t196 * t936;
  t940 = t21 * t859;
  t943 = t940 * t907 * t197 / 0.9e1;
  t944 = t184 * t309;
  t946 = t201 * t944 * t203;
  t948 = t575 * t122;
  t949 = t213 * t29;
  t952 = 0.2e1 / 0.9e1 * t201 * t948 * t949;
  t954 = t757 * t127;
  t955 = t312 * t177 * t954;
  t956 = t18 * t136;
  t957 = t956 * t328;
  t959 = t955 * t957 / 0.27e2;
  t961 = t190 * t191 * t310;
  t963 = t873 * t849;
  t964 = t136 * params->b;
  t965 = t964 * t123;
  t967 = 0.4e1 / 0.9e1 * t963 * t965;
  t968 = t568 * params->b;
  t971 = 0.8e1 / 0.9e1 * t190 * t968 * t123;
  t972 = t6 * t592;
  t974 = -t931 - t935 + 0.2e1 / 0.3e1 * t938 + t943 + 0.2e1 / 0.3e1 * t946 + t952 + t959 + 0.4e1 / 0.3e1 * t961 + t967 - t971 - t972 * t16;
  t976 = t571 - 0.2e1 / 0.3e1 * t572 - t579 + t21 * t748 - t754 + t761 + t766 + t771 + t775 + 0.2e1 / 0.9e1 * t779 + t866 + t877 + t881 / 0.9e1 + t886 / 0.9e1 + t895 + t902 - t906 - t911 - 0.4e1 / 0.3e1 * t914 - t922 + t926 + t974;
  tv2rho20 = t161 * t976 + 0.2e1 * t565;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t978 = params->a * t492;
  t979 = t380 * t186;
  t987 = t56 * t389;
  t990 = t228 * t7;
  t994 = my_piecewise3(t49, 0, 0.4e2 / 0.9e1 * t987 * t229 + 0.16e2 / 0.3e1 * t990 * t177);
  t995 = t63 * t393;
  t998 = t233 * t7;
  t1002 = my_piecewise3(t60, 0, 0.4e2 / 0.9e1 * t995 * t234 - 0.16e2 / 0.3e1 * t998 * t177);
  t1003 = t994 + t1002;
  t1007 = t586 - t591;
  t1008 = t70 * t1007;
  t1011 = t401 * t246;
  t1017 = t245 * t412;
  t1018 = t71 * t1017;
  t1020 = t252 * t392;
  t1022 = t79 * t994;
  t1023 = t408 * t237;
  t1025 = t86 * t1002;
  t1026 = -0.8e1 / 0.3e1 * t1020 + t1022 - 0.8e1 / 0.3e1 * t1023 + t1025;
  t1027 = t73 * t1026;
  t1032 = t401 * t265;
  t1036 = -t585 - 0.3e1 / 0.2e2 * t45 * t379 * t238 - 0.3e1 / 0.2e2 * t45 * t180 * t397 - 0.3e1 / 0.2e2 * t45 * t12 * t1003 + t1008 * t89 / 0.32e2 + t1011 / 0.32e2 + t401 * t258 / 0.32e2 + t242 * t413 / 0.32e2 + t1018 / 0.32e2 + t71 * t1027 / 0.32e2 + t1008 * t104 / 0.576e3 + t1032 / 0.576e3 + t401 * t279 / 0.576e3;
  t1039 = t264 * t428;
  t1040 = t71 * t1039;
  t1046 = t57 * t7;
  t1050 = my_piecewise3(t49, 0, 0.88e2 / 0.9e1 * t390 * t229 + 0.22e2 / 0.3e1 * t1046 * t177);
  t1056 = t64 * t7;
  t1060 = my_piecewise3(t60, 0, 0.88e2 / 0.9e1 * t394 * t234 - 0.22e2 / 0.3e1 * t1056 * t177);
  t1062 = -0.8e1 / 0.3e1 * t252 * t420 + t79 * t1050 - 0.8e1 / 0.3e1 * t408 * t276 + t86 * t1060;
  t1063 = t92 * t1062;
  t1079 = t48 * t7;
  t1083 = my_piecewise3(t49, 0, 0.4e1 * t1079 * t177 + 0.2e1 * t229 * t389);
  t1084 = t1083 * sigma[2];
  t1091 = t407 * t237;
  t1096 = t85 * t1002;
  t1101 = t59 * t7;
  t1105 = my_piecewise3(t60, 0, -0.4e1 * t1101 * t177 + 0.2e1 * t234 * t393);
  t1106 = t1105 * sigma[0];
  t1115 = t251 * t392;
  t1118 = t78 * t994;
  t1121 = -0.16e2 / 0.9e1 * t1020 + 0.2e1 / 0.3e1 * t1022 - 0.16e2 / 0.9e1 * t1023 + 0.2e1 / 0.3e1 * t1025 - t1084 * t111 / 0.4e1 - t438 * t291 / 0.4e1 + 0.2e1 / 0.3e1 * t288 * t441 + 0.2e1 / 0.3e1 * t110 * t1091 - t288 * t444 / 0.4e1 - t110 * t1096 / 0.4e1 - t1106 * t116 / 0.4e1 + 0.2e1 / 0.3e1 * t450 * t300 - t450 * t303 / 0.4e1 - t297 * t453 / 0.4e1 + 0.2e1 / 0.3e1 * t115 * t1115 - t115 * t1118 / 0.4e1;
  t1125 = t209 * t384;
  t1128 = t379 * t220;
  t1130 = t1007 * t35 / 0.72e2 + t1128 / 0.72e2 + t698 / 0.72e2 + t704 / 0.72e2;
  t1132 = t242 * t429 / 0.576e3 + t1040 / 0.576e3 + t71 * t1063 / 0.576e3 - 0.3e1 / 0.2e2 * t45 * t1007 * t66 + t623 / 0.32e2 + t638 + t640 / 0.32e2 + t658 / 0.576e3 + t668 + t670 / 0.576e3 - t70 * t1121 / 0.8e1 + 0.8e1 / 0.3e1 * t694 + 0.8e1 / 0.3e1 * t1125 - t30 * t1130;
  t1133 = t1036 + t1132;
  t1134 = t24 * t1133;
  t1137 = t136 * t379;
  t1138 = t1137 * t155;
  t1140 = t334 * t336 * t1138;
  t1148 = t587 * sigma[0];
  t1157 = t357 * t392;
  t1160 = t145 * t994;
  t1163 = t587 * sigma[2];
  t1170 = t480 * t237;
  t1175 = t151 * t1002;
  t1178 = t814 - 0.7e1 / 0.48e2 * t70 * t1026 + t1148 * t146 / 0.24e2 - t470 * t358 / 0.3e1 + t470 * t361 / 0.8e1 + t354 * t473 / 0.8e1 - t144 * t1157 / 0.3e1 + t144 * t1160 / 0.8e1 - t1163 * t152 / 0.24e2 + t477 * t368 / 0.8e1 - t365 * t481 / 0.3e1 - t150 * t1170 / 0.3e1 + t365 * t484 / 0.8e1 + t150 * t1175 / 0.8e1;
  t1183 = t318 * t487;
  t1185 = t334 * t336 * t1183;
  t1187 = t169 * t379;
  t1190 = t130 * t137 * t1187 * t155;
  t1194 = t130 * t137 * t340 * t487;
  t1196 = -t979 / 0.3e1 + t21 * t1134 + t571 - t572 / 0.3e1 - t579 - t754 + t761 + t1140 / 0.9e1 + t130 * t137 * t345 * t487 / 0.6e1 + t130 * t137 * t138 * t1178 / 0.6e1 + t1185 / 0.9e1 - t1190 / 0.18e2 - t1194 / 0.18e2 + t766;
  t1197 = t4 * t1007;
  t1210 = t12 * t487;
  t1211 = t1210 * params->d;
  t1213 = t325 * t326 * t1211;
  t1215 = t317 * t1138;
  t1216 = t315 * t1215;
  t1218 = t379 * t155;
  t1219 = t1218 * params->d;
  t1221 = t325 * t326 * t1219;
  t1223 = t317 * t1183;
  t1224 = t315 * t1223;
  t1226 = t130 * t137 * t1197 * t155 / 0.6e1 + t130 * t137 * t462 * t371 / 0.6e1 + t771 + t775 + t779 / 0.9e1 + t784 / 0.9e1 + t795 - t799 / 0.18e2 - t803 / 0.18e2 - t852 + t1213 / 0.18e2 + t1216 / 0.18e2 + t1221 / 0.18e2 + t1224 / 0.18e2;
  t1232 = t379 * t16;
  t1234 = t167 * t170 * t1232;
  t1236 = t16 * t459;
  t1238 = t195 * t196 * t1236;
  t1240 = t184 * t459;
  t1242 = t201 * t1240 * t203;
  t1245 = t854 / 0.18e2 + t857 / 0.18e2 + t865 + t877 + t881 / 0.18e2 + t886 / 0.18e2 + t895 + t902 - t906 - t911 - 0.2e1 / 0.3e1 * t1234 + t1238 / 0.3e1 + t1242 / 0.3e1 - 0.2e1 / 0.3e1 * t914;
  t1250 = t190 * t191 * t460;
  t1252 = t6 * t1007;
  t1254 = -t922 + t926 - t931 - t935 + t938 / 0.3e1 + t943 + t946 / 0.3e1 + t952 + t959 + 0.2e1 / 0.3e1 * t961 + t967 - t971 + 0.2e1 / 0.3e1 * t1250 - t1252 * t16;
  t1256 = t1196 + t1226 + t1245 + t1254;
  tv2rho21 = t1256 * t161 + t565 + t978;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1264 = -t586 - t588 - t591;
  t1265 = t4 * t1264;
  t1275 = t389 * t389;
  t1276 = t56 * t1275;
  t1278 = t10 + t587;
  t1279 = 0.2e1 * t1278;
  t1280 = t228 * t1279;
  t1283 = my_piecewise3(t49, 0, 0.4e2 / 0.9e1 * t1276 + 0.8e1 / 0.3e1 * t1280);
  t1284 = t79 * t1283;
  t1285 = t81 * t81;
  t1287 = 0.1e1 / t83 / t1285;
  t1288 = sigma[2] * t1287;
  t1289 = t1288 * t65;
  t1291 = t408 * t396;
  t1293 = t393 * t393;
  t1294 = t63 * t1293;
  t1296 = -t1279;
  t1297 = t233 * t1296;
  t1300 = my_piecewise3(t60, 0, 0.4e2 / 0.9e1 * t1294 + 0.8e1 / 0.3e1 * t1297);
  t1301 = t86 * t1300;
  t1302 = t1284 + 0.88e2 / 0.9e1 * t1289 - 0.16e2 / 0.3e1 * t1291 + t1301;
  t1305 = t1278 / 0.3e1;
  t1306 = t1305 * sigma[0];
  t1311 = t145 * t1283;
  t1314 = -t1305;
  t1315 = t1314 * sigma[2];
  t1322 = t70 * t1287;
  t1323 = t1322 * t65;
  t1326 = t480 * t396;
  t1329 = t151 * t1300;
  t1332 = t814 - 0.7e1 / 0.48e2 * t70 * t1302 + t1306 * t146 / 0.8e1 + t470 * t473 / 0.4e1 + t144 * t1311 / 0.8e1 + t1315 * t152 / 0.8e1 - 0.2e1 / 0.3e1 * t477 * t481 + t477 * t484 / 0.4e1 + 0.11e2 / 0.9e1 * t150 * t1323 - 0.2e1 / 0.3e1 * t150 * t1326 + t150 * t1329 / 0.8e1;
  t1341 = t130 * t137 * t462 * t487 / 0.3e1 + t130 * t137 * t138 * t1332 / 0.6e1 + t766 + t771 + t775 + t795 - t852 + t1213 / 0.9e1 + t1216 / 0.9e1 + t1221 / 0.9e1 + t1224 / 0.9e1;
  t1348 = t6 * t1264;
  t1361 = t1283 + t1300;
  t1365 = t70 * t1264;
  t1370 = t73 * t1302;
  t1382 = my_piecewise3(t49, 0, 0.88e2 / 0.9e1 * t228 * t1275 + 0.11e2 / 0.3e1 * t57 * t1279);
  t1393 = my_piecewise3(t60, 0, 0.88e2 / 0.9e1 * t233 * t1293 + 0.11e2 / 0.3e1 * t64 * t1296);
  t1395 = t79 * t1382 + 0.88e2 / 0.9e1 * t1288 * t101 - 0.16e2 / 0.3e1 * t408 * t426 + t86 * t1393;
  t1396 = t92 * t1395;
  t1402 = t1264 * t35 / 0.72e2 + t1128 / 0.36e2 + t705;
  t1411 = my_piecewise3(t49, 0, 0.2e1 * t1279 * t48 + 0.2e1 * t1275);
  t1412 = t1411 * sigma[2];
  t1419 = t1287 * t65;
  t1422 = t407 * t396;
  t1425 = t85 * t1300;
  t1431 = my_piecewise3(t60, 0, 0.2e1 * t1296 * t59 + 0.2e1 * t1293);
  t1432 = t1431 * sigma[0];
  t1437 = t78 * t1283;
  t1440 = 0.2e1 / 0.3e1 * t1284 + 0.176e3 / 0.27e2 * t1289 - 0.32e2 / 0.9e1 * t1291 + 0.2e1 / 0.3e1 * t1301 - t1412 * t111 / 0.4e1 + 0.4e1 / 0.3e1 * t438 * t441 - t438 * t444 / 0.2e1 - 0.22e2 / 0.9e1 * t110 * t1419 + 0.4e1 / 0.3e1 * t110 * t1422 - t110 * t1425 / 0.4e1 - t1432 * t116 / 0.4e1 - t450 * t453 / 0.2e1 - t115 * t1437 / 0.4e1;
  t1443 = -t585 + t638 + t668 + 0.16e2 / 0.3e1 * t1125 + t1011 / 0.16e2 + t1018 / 0.16e2 + t1032 / 0.288e3 + t1040 / 0.288e3 - 0.3e1 / 0.2e2 * t45 * t1264 * t66 - 0.3e1 / 0.1e2 * t45 * t379 * t397 - 0.3e1 / 0.2e2 * t45 * t12 * t1361 + t1365 * t89 / 0.32e2 + t401 * t413 / 0.16e2 + t71 * t1370 / 0.32e2 + t1365 * t104 / 0.576e3 + t401 * t429 / 0.288e3 + t71 * t1396 / 0.576e3 - t30 * t1402 - t70 * t1440 / 0.8e1;
  t1444 = t24 * t1443;
  t1446 = t926 - t931 - t935 + t943 + t952 + t959 + t967 - t971 + 0.4e1 / 0.3e1 * t1250 - t1348 * t16 + t21 * t1444;
  t1448 = -0.2e1 / 0.3e1 * t979 + t571 - t579 - t754 + t761 + 0.2e1 / 0.9e1 * t1140 + 0.2e1 / 0.9e1 * t1185 - t1190 / 0.9e1 - t1194 / 0.9e1 + t130 * t137 * t1265 * t155 / 0.6e1 + t1341 + t865 + t877 + t895 + t902 - t906 - t911 - 0.4e1 / 0.3e1 * t1234 + 0.2e1 / 0.3e1 * t1238 + 0.2e1 / 0.3e1 * t1242 - t922 + t1446;
  tv2rho22 = t1448 * t161 + 0.2e1 * t978;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1450 = params->a * t524;
  t1453 = 0.2e1 / 0.3e1 * t190 * t191 * t511;
  t1454 = t16 * t510;
  t1457 = t195 * t196 * t1454 / 0.3e1;
  t1458 = t184 * t510;
  t1461 = t201 * t1458 * t203 / 0.3e1;
  t1463 = 0.8e1 / 0.3e1 * t208 * t38;
  t1464 = t29 * t223;
  t1467 = t245 * t78;
  t1468 = t1467 * t58;
  t1470 = t71 * t1468 / 0.32e2;
  t1471 = t73 * t251;
  t1472 = t1471 * t58;
  t1475 = t495 * t232;
  t1480 = t264 * t78;
  t1481 = t1480 * t97;
  t1483 = t71 * t1481 / 0.576e3;
  t1484 = t92 * t251;
  t1485 = t1484 * t97;
  t1488 = t499 * t272;
  t1493 = t296 * t78;
  t1496 = t114 * t251;
  t1504 = t1463 - t1464 + t242 * t496 / 0.32e2 + t1470 - t71 * t1472 / 0.12e2 + t71 * t1475 / 0.32e2 + t242 * t500 / 0.576e3 + t1483 - t71 * t1485 / 0.216e3 + t71 * t1488 / 0.576e3 - t70 * (-0.16e2 / 0.9e1 * t300 + 0.2e1 / 0.3e1 * t303 - t1493 * t58 / 0.4e1 + 0.2e1 / 0.3e1 * t1496 * t58 - t504 * t232 / 0.4e1) / 0.8e1;
  t1505 = t24 * t1504;
  t1507 = t318 * t519;
  t1508 = t317 * t1507;
  t1510 = t315 * t1508 / 0.18e2;
  t1511 = t12 * t519;
  t1512 = t1511 * params->d;
  t1515 = t325 * t326 * t1512 / 0.18e2;
  t1518 = t334 * t336 * t1507 / 0.9e1;
  t1522 = t130 * t137 * t340 * t519 / 0.18e2;
  t1527 = 0.28e2 / 0.9e1 * t208;
  t1530 = t353 * t78;
  t1533 = t143 * t251;
  t1536 = t70 * t232;
  t1539 = -t1527 + 0.7e1 / 0.18e2 * t358 - 0.7e1 / 0.48e2 * t361 + t1530 * t516 / 0.8e1 - t1533 * t516 / 0.3e1 + t515 * t1536 / 0.8e1;
  t1544 = t1453 + t1457 + t1461 + t21 * t1505 + t1510 + t1515 + t1518 - t1522 + t130 * t137 * t345 * t519 / 0.6e1 + t130 * t137 * t138 * t1539 / 0.6e1;
  tv2rhosigma0 = t1544 * t161 + t1450;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1546 = params->a * t535;
  t1547 = t589 * params->b;
  t1548 = t24 * t38;
  t1551 = 0.4e1 / 0.3e1 * t190 * t1547 * t1548;
  t1552 = t589 * t23;
  t1553 = t16 * t38;
  t1556 = 0.2e1 / 0.3e1 * t195 * t1552 * t1553;
  t1557 = t184 * t589;
  t1558 = t38 * params->d;
  t1561 = 0.2e1 / 0.3e1 * t201 * t1557 * t1558;
  t1562 = t16 * t208;
  t1565 = 0.16e2 / 0.3e1 * t201 * t1562 * t38;
  t1570 = 0.1e1 / t3 / t580;
  t1571 = t1570 * t23;
  t1572 = t1571 * t16;
  t1573 = t312 * t1572;
  t1575 = t316 * t137 * t12;
  t1577 = 0.7e1 / 0.54e2 * t1573 * t1575;
  t1578 = t1570 * t12;
  t1582 = 0.7e1 / 0.54e2 * t325 * t137 * t1578 * params->d;
  t1583 = t332 * t335;
  t1584 = t582 * t136;
  t1588 = 0.7e1 / 0.27e2 * t529 * t1583 * t1584 * t12;
  t1589 = t136 * t589;
  t1593 = 0.7e1 / 0.6e1 * t529 * t18 * t1589 * t12;
  t1598 = -t1551 - t1556 - t1561 + t1565 - 0.2e1 * t201 * t525 * t223 + t1577 + t1582 + t1588 - t1593 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t180;
  tv2rhosigma1 = t1598 * t161 + t1546;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1600 = params->a * t564;
  t1603 = 0.2e1 / 0.3e1 * t190 * t191 * t552;
  t1604 = t16 * t551;
  t1607 = t195 * t196 * t1604 / 0.3e1;
  t1608 = t184 * t551;
  t1611 = t201 * t1608 * t203 / 0.3e1;
  t1614 = t245 * t85;
  t1615 = t1614 * t65;
  t1617 = t71 * t1615 / 0.32e2;
  t1618 = t536 * t237;
  t1623 = t264 * t85;
  t1624 = t1623 * t101;
  t1626 = t71 * t1624 / 0.576e3;
  t1627 = t540 * t276;
  t1631 = t287 * t85;
  t1639 = t1463 - t1464 + t242 * t537 / 0.32e2 + t1617 + t71 * t1618 / 0.32e2 + t242 * t541 / 0.576e3 + t1626 + t71 * t1627 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t291 - t1631 * t65 / 0.4e1 - t545 * t237 / 0.4e1) / 0.8e1;
  t1640 = t24 * t1639;
  t1642 = t318 * t559;
  t1643 = t317 * t1642;
  t1645 = t315 * t1643 / 0.18e2;
  t1646 = t12 * t559;
  t1647 = t1646 * params->d;
  t1650 = t325 * t326 * t1647 / 0.18e2;
  t1653 = t334 * t336 * t1642 / 0.9e1;
  t1657 = t130 * t137 * t340 * t559 / 0.18e2;
  t1663 = t364 * t85;
  t1666 = t70 * t237;
  t1669 = -t1527 - 0.7e1 / 0.48e2 * t368 + t1663 * t556 / 0.8e1 + t555 * t1666 / 0.8e1;
  t1674 = t1603 + t1607 + t1611 + t21 * t1640 + t1645 + t1650 + t1653 - t1657 + t130 * t137 * t345 * t559 / 0.6e1 + t130 * t137 * t138 * t1669 / 0.6e1;
  tv2rhosigma2 = t161 * t1674 + t1600;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1676 = t29 * t384;
  t1679 = t495 * t392;
  t1684 = t499 * t420;
  t1688 = t449 * t78;
  t1696 = t1463 - t1676 + t401 * t496 / 0.32e2 + t1470 + t71 * t1679 / 0.32e2 + t401 * t500 / 0.576e3 + t1483 + t71 * t1684 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t453 - t1688 * t58 / 0.4e1 - t504 * t392 / 0.4e1) / 0.8e1;
  t1697 = t24 * t1696;
  t1704 = t469 * t78;
  t1707 = t70 * t392;
  t1710 = -t1527 - 0.7e1 / 0.48e2 * t473 + t1704 * t516 / 0.8e1 + t515 * t1707 / 0.8e1;
  t1715 = t1453 + t1457 + t1461 + t21 * t1697 + t1510 + t1515 + t1518 - t1522 + t130 * t137 * t462 * t519 / 0.6e1 + t130 * t137 * t138 * t1710 / 0.6e1;
  tv2rhosigma3 = t161 * t1715 + t1450;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  t1724 = -t1551 - t1556 - t1561 + t1565 - 0.2e1 * t201 * t525 * t384 + t1577 + t1582 + t1588 - t1593 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t379;
  tv2rhosigma4 = t161 * t1724 + t1546;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1728 = t73 * t407;
  t1729 = t1728 * t65;
  t1732 = t536 * t396;
  t1737 = t92 * t407;
  t1738 = t1737 * t101;
  t1741 = t540 * t426;
  t1746 = t437 * t85;
  t1749 = t109 * t407;
  t1757 = t1463 - t1676 + t401 * t537 / 0.32e2 + t1617 - t71 * t1729 / 0.12e2 + t71 * t1732 / 0.32e2 + t401 * t541 / 0.576e3 + t1626 - t71 * t1738 / 0.216e3 + t71 * t1741 / 0.576e3 - t70 * (-0.16e2 / 0.9e1 * t441 + 0.2e1 / 0.3e1 * t444 - t1746 * t65 / 0.4e1 + 0.2e1 / 0.3e1 * t1749 * t65 - t545 * t396 / 0.4e1) / 0.8e1;
  t1758 = t24 * t1757;
  t1766 = t476 * t85;
  t1769 = t149 * t407;
  t1772 = t70 * t396;
  t1775 = -t1527 + 0.7e1 / 0.18e2 * t481 - 0.7e1 / 0.48e2 * t484 + t1766 * t556 / 0.8e1 - t1769 * t556 / 0.3e1 + t555 * t1772 / 0.8e1;
  t1780 = t1603 + t1607 + t1611 + t21 * t1758 + t1645 + t1650 + t1653 - t1657 + t130 * t137 * t462 * t559 / 0.6e1 + t130 * t137 * t138 * t1775 / 0.6e1;
  tv2rhosigma5 = t161 * t1780 + t1600;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  tv2sigma20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1782 = params->a * t976;
  t1784 = 0.12e2 * t177;
  t1785 = t7 * t589;
  t1786 = 0.36e2 * t1785;
  t1787 = t580 * t2;
  t1788 = 0.1e1 / t1787;
  t1790 = 0.24e2 * t8 * t1788;
  t1791 = t1784 - t1786 + t1790;
  t1792 = t6 * t1791;
  t1795 = t189 * t18 * t589;
  t1796 = t860 * t123;
  t1798 = 0.2e1 / 0.9e1 * t1795 * t1796;
  t1799 = t948 * t213;
  t1800 = t125 * t1799;
  t1802 = 0.4e1 / 0.9e1 * t1795 * t1800;
  t1803 = t136 * t592;
  t1804 = t1803 * t155;
  t1806 = t334 * t336 * t1804;
  t1808 = t776 * t371;
  t1810 = t334 * t336 * t1808;
  t1813 = t789 * t792 * t777;
  t1815 = t318 * t844;
  t1817 = t334 * t336 * t1815;
  t1820 = t789 * t792 * t782;
  t1822 = t786 * t332;
  t1824 = t125 * t128 * t1822;
  t1825 = t790 * t335;
  t1827 = 0.1e1 / t3 / t1787;
  t1828 = t1825 * t1827;
  t1831 = 0.4e1 / 0.81e2 * t1824 * t1828 * t319;
  t1832 = t169 * t592;
  t1835 = t130 * t137 * t1832 * t155;
  t1839 = t130 * t137 * t796 * t371;
  t1843 = t130 * t137 * t340 * t844;
  t1845 = t4 * t1791;
  t1850 = -t1792 * t16 + t1798 + t1802 + t1806 / 0.3e1 + 0.2e1 / 0.3e1 * t1810 + 0.2e1 / 0.9e1 * t1813 + t1817 / 0.3e1 + 0.2e1 / 0.9e1 * t1820 + t1831 - t1835 / 0.6e1 - t1839 / 0.3e1 - t1843 / 0.6e1 + t130 * t137 * t1845 * t155 / 0.6e1;
  t1864 = 0.1e1 / t76 / t642 / rho[0];
  t1865 = t70 * t1864;
  t1866 = t1865 * t58;
  t1869 = t177 - t1785;
  t1870 = t1869 * sigma[0];
  t1879 = t825 * t232;
  t1882 = t357 * t607;
  t1884 = 0.1e1 / t55;
  t1885 = t599 * t229;
  t1888 = t56 * t229;
  t1891 = 0.6e1 * t1869;
  t1895 = my_piecewise3(t49, 0, 0.8e2 / 0.27e2 * t1884 * t1885 + 0.4e2 / 0.3e1 * t1888 * t603 + 0.8e1 / 0.3e1 * t228 * t1891);
  t1896 = t145 * t1895;
  t1899 = -t1869;
  t1900 = t1899 * sigma[2];
  t1907 = 0.1e1 / t62;
  t1908 = t608 * t234;
  t1911 = t63 * t234;
  t1914 = -t1891;
  t1918 = my_piecewise3(t60, 0, 0.8e2 / 0.27e2 * t1907 * t1908 + 0.4e2 / 0.3e1 * t1911 * t611 + 0.8e1 / 0.3e1 * t233 * t1914);
  t1919 = t151 * t1918;
  t1922 = sigma[0] * t1864;
  t1923 = t1922 * t58;
  t1925 = t645 * t232;
  t1927 = t252 * t607;
  t1929 = t79 * t1895;
  t1930 = t86 * t1918;
  t1931 = -0.1232e4 / 0.27e2 * t1923 + 0.88e2 / 0.3e1 * t1925 - 0.8e1 * t1927 + t1929 + t1930;
  t1935 = 0.1e1 / t27 / t1787;
  t1936 = t26 * t1935;
  t1937 = 0.4312e4 / 0.81e2 * t1936;
  t1938 = -t818 * t358 + 0.11e2 / 0.3e1 * t354 * t826 - 0.154e3 / 0.27e2 * t144 * t1866 + t1870 * t146 / 0.8e1 + 0.3e1 / 0.8e1 * t818 * t361 - 0.2e1 * t354 * t829 + 0.3e1 / 0.8e1 * t354 * t832 + 0.11e2 / 0.3e1 * t144 * t1879 - t144 * t1882 + t144 * t1896 / 0.8e1 + t1900 * t152 / 0.8e1 + 0.3e1 / 0.8e1 * t836 * t368 + 0.3e1 / 0.8e1 * t365 * t841 + t150 * t1919 / 0.8e1 - 0.7e1 / 0.48e2 * t70 * t1931 - t1937;
  t1944 = t334 * t849 * t777;
  t1947 = t334 * t849 * t782;
  t1949 = t791 * t582;
  t1952 = 0.4e1 / 0.9e1 * t789 * t1949 * t319;
  t1953 = t568 * t180;
  t1956 = t130 * t137 * t1953 * t155;
  t1960 = t130 * t137 * t762 * t371;
  t1962 = t335 * t589;
  t1965 = 0.67e2 / 0.81e2 * t334 * t1962 * t319;
  t1966 = t869 * t12;
  t1970 = 0.14e2 / 0.81e2 * t130 * t137 * t1966 * t155;
  t1971 = t312 * t310;
  t1972 = t768 * t1971;
  t1974 = t944 * params->d;
  t1975 = t125 * t1974;
  t1976 = t768 * t1975;
  t1978 = t335 * t1570;
  t1979 = t1978 * t136;
  t1980 = t873 * t1979;
  t1982 = 0.4e1 / 0.9e1 * t1980 * t769;
  t1983 = t130 * t137 * t805 * t371 / 0.2e1 + t130 * t137 * t345 * t844 / 0.2e1 + t130 * t137 * t138 * t1938 / 0.6e1 - 0.7e1 / 0.9e1 * t1944 - 0.7e1 / 0.9e1 * t1947 - t1952 + 0.2e1 / 0.9e1 * t1956 + 0.2e1 / 0.9e1 * t1960 + t1965 - t1970 + 0.4e1 / 0.3e1 * t1972 + 0.4e1 / 0.3e1 * t1976 + t1982;
  t1986 = 0.4e1 / 0.9e1 * t1980 * t773;
  t1988 = t189 * t18 * t208;
  t1990 = 0.16e2 / 0.9e1 * t1988 * t769;
  t1992 = 0.16e2 / 0.9e1 * t1988 * t773;
  t1994 = t167 * t923 * t912;
  t1996 = t589 * t165;
  t1999 = 0.52e2 / 0.27e2 * t918 * t1996 * t171;
  t2000 = params->omega * t869;
  t2003 = 0.56e2 / 0.27e2 * t167 * t2000 * t171;
  t2006 = 0.28e2 / 0.27e2 * t195 * t870 * t197;
  t2007 = params->d * t869;
  t2010 = 0.28e2 / 0.27e2 * t201 * t202 * t2007;
  t2011 = t592 * t16;
  t2013 = t167 * t170 * t2011;
  t2016 = t918 * t919 * t912;
  t2018 = t162 * t162;
  t2020 = t127 * t2018 * params->m1;
  t2021 = t2020 * t791;
  t2022 = t582 * t165;
  t2025 = 0.8e1 / 0.27e2 * t2021 * t2022 * t171;
  t2026 = t16 * t747;
  t2028 = t195 * t196 * t2026;
  t2029 = t184 * t747;
  t2031 = t201 * t2029 * t203;
  t2032 = t1986 - t1990 - t1992 + 0.8e1 / 0.3e1 * t1994 + t1999 - t2003 + t2006 + t2010 - 0.2e1 * t2013 - 0.4e1 / 0.3e1 * t2016 - t2025 + t2028 + t2031;
  t2034 = t312 * t589 * t954;
  t2036 = 0.5e1 / 0.27e2 * t2034 * t957;
  t2037 = t956 * t879;
  t2038 = t955 * t2037;
  t2040 = t956 * t884;
  t2041 = t955 * t2040;
  t2044 = t860 * t1570 * t954;
  t2046 = t2044 * t957 / 0.54e2;
  t2048 = t23 * t575;
  t2049 = t2048 * t127;
  t2050 = t312 * t1570 * t2049;
  t2051 = t956 * t892;
  t2053 = t2050 * t2051 / 0.27e2;
  t2055 = t312 * t582 * t954;
  t2056 = t1583 * t136;
  t2057 = t2056 * t328;
  t2059 = 0.2e1 / 0.27e2 * t2055 * t2057;
  t2060 = t972 * t186;
  t2061 = t181 * t577;
  t2063 = t183 * t183;
  t2064 = 0.1e1 / t2063;
  t2065 = t2064 * t627;
  t2066 = t2065 * t589;
  t2068 = 0.2e1 / 0.9e1 * t13 * t2066;
  t2071 = t592 * t220;
  t2073 = t180 * t703;
  t2075 = t213 * t213;
  t2076 = t2075 * t2064;
  t2077 = t2076 * t1570;
  t2079 = t628 * t589;
  t2081 = t214 * t208;
  t2083 = t32 * t869;
  t2085 = -0.14e2 / 0.9e1 * t2077 + 0.7e2 / 0.9e1 * t2079 - 0.364e3 / 0.27e2 * t2081 + 0.196e3 / 0.27e2 * t2083;
  t2087 = t12 * t2085 / 0.72e2;
  t2088 = t1791 * t35 / 0.72e2 + t2071 / 0.24e2 + t2073 / 0.24e2 + t2087;
  t2090 = t583 * t223;
  t2092 = t209 * t706;
  t2095 = 0.1232e4 / 0.27e2 * t1936 * t38;
  t2101 = t1864 * t58;
  t2108 = t229 * t603;
  t2113 = my_piecewise3(t49, 0, 0.2e1 * t1891 * t48 + 0.6e1 * t2108);
  t2114 = t2113 * sigma[2];
  t2121 = t85 * t1918;
  t2124 = t234 * t611;
  t2129 = my_piecewise3(t60, 0, 0.2e1 * t1914 * t59 + 0.6e1 * t2124);
  t2130 = t2129 * sigma[0];
  t2139 = t644 * t232;
  t2142 = t251 * t607;
  t2145 = t78 * t1895;
  t2148 = -0.2464e4 / 0.81e2 * t1923 + 0.2e1 * t728 * t300 - 0.22e2 / 0.3e1 * t297 * t735 + 0.308e3 / 0.27e2 * t115 * t2101 + 0.176e3 / 0.9e1 * t1925 - 0.16e2 / 0.3e1 * t1927 + 0.2e1 / 0.3e1 * t1929 + 0.2e1 / 0.3e1 * t1930 - t2114 * t111 / 0.4e1 - 0.3e1 / 0.4e1 * t716 * t291 - 0.3e1 / 0.4e1 * t288 * t721 - t110 * t2121 / 0.4e1 - t2130 * t116 / 0.4e1 - 0.3e1 / 0.4e1 * t728 * t303 + 0.4e1 * t297 * t738 - 0.3e1 / 0.4e1 * t297 * t741 - 0.22e2 / 0.3e1 * t115 * t2139 + 0.2e1 * t115 * t2142 - t115 * t2145 / 0.4e1;
  t2151 = t665 * t278;
  t2152 = t71 * t2151;
  t2154 = t264 * t690;
  t2155 = t71 * t2154;
  t2170 = my_piecewise3(t49, 0, 0.44e3 / 0.27e2 * t56 * t1885 + 0.88e2 / 0.3e1 * t230 * t603 + 0.11e2 / 0.3e1 * t57 * t1891);
  t2179 = my_piecewise3(t60, 0, 0.44e3 / 0.27e2 * t63 * t1908 + 0.88e2 / 0.3e1 * t235 * t611 + 0.11e2 / 0.3e1 * t64 * t1914);
  t2181 = -0.1232e4 / 0.27e2 * t1922 * t97 + 0.88e2 / 0.3e1 * t645 * t272 - 0.8e1 * t252 * t681 + t79 * t2170 + t86 * t2179;
  t2182 = t92 * t2181;
  t2185 = t620 * t246;
  t2189 = t242 * t636;
  t2191 = t242 * t639;
  t2199 = -t2077 / 0.81e2 + 0.5e1 / 0.81e2 * t2079 - 0.26e2 / 0.243e3 * t2081 + 0.14e2 / 0.243e3 * t2083;
  t2200 = t2199 * t88;
  t2202 = t71 * t2200 / 0.32e2;
  t2203 = -t30 * t2088 - 0.88e2 / 0.3e1 * t2090 + 0.8e1 * t2092 + t2095 - t70 * t2148 / 0.8e1 + t2152 / 0.192e3 + t2155 / 0.192e3 + t71 * t2182 / 0.576e3 + 0.3e1 / 0.32e2 * t2185 + 0.3e1 / 0.32e2 * t620 * t258 + 0.3e1 / 0.32e2 * t2189 + 0.3e1 / 0.16e2 * t2191 + 0.3e1 / 0.32e2 * t242 * t653 + t2202;
  t2204 = t635 * t257;
  t2205 = t71 * t2204;
  t2207 = t245 * t652;
  t2208 = t71 * t2207;
  t2210 = t73 * t1931;
  t2213 = t70 * t1791;
  t2216 = t620 * t265;
  t2220 = t242 * t666;
  t2222 = t242 * t669;
  t2230 = 0.2e1 / 0.9e1 * t2077 - 0.1e2 / 0.9e1 * t2079 + 0.52e2 / 0.27e2 * t2081 - 0.28e2 / 0.27e2 * t2083;
  t2231 = t2230 * t103;
  t2233 = t71 * t2231 / 0.576e3;
  t2243 = t1895 + t1918;
  t2249 = 0.3e1 / 0.32e2 * t2205 + 0.3e1 / 0.32e2 * t2208 + t71 * t2210 / 0.32e2 + t2213 * t104 / 0.576e3 + t2216 / 0.192e3 + t620 * t279 / 0.192e3 + t2220 / 0.192e3 + t2222 / 0.96e2 + t242 * t691 / 0.192e3 + t2233 - 0.3e1 / 0.2e2 * t45 * t1791 * t66 - 0.9e1 / 0.2e2 * t45 * t592 * t238 - 0.9e1 / 0.2e2 * t45 * t180 * t616 - 0.3e1 / 0.2e2 * t45 * t12 * t2243 + t2213 * t89 / 0.32e2;
  t2250 = t2203 + t2249;
  t2251 = t24 * t2250;
  t2253 = t181 * t569;
  t2255 = t576 * t208;
  t2257 = 0.8e1 / 0.9e1 * t13 * t2255;
  t2258 = t185 * t869;
  t2260 = 0.28e2 / 0.27e2 * t13 * t2258;
  t2261 = -t2036 + t2038 / 0.9e1 + t2041 / 0.9e1 + t2046 + t2053 + t2059 - t2060 - 0.2e1 / 0.3e1 * t2061 - t2068 + t21 * t2251 + 0.4e1 / 0.3e1 * t2253 + t2257 - t2260;
  t2265 = t195 * t928 * t936;
  t2267 = t208 * t23;
  t2270 = 0.4e1 / 0.9e1 * t940 * t2267 * t197;
  t2272 = t201 * t944 * t932;
  t2274 = t213 * t208;
  t2277 = 0.8e1 / 0.9e1 * t201 * t948 * t2274;
  t2279 = t940 * t907 * t936;
  t2281 = t859 * params->c;
  t2282 = t21 * t2281;
  t2285 = t2282 * t1552 * t197 / 0.27e2;
  t2286 = t575 * t309;
  t2288 = t201 * t2286 * t949;
  t2290 = t2064 * t122;
  t2291 = t627 * t589;
  t2294 = 0.2e1 / 0.9e1 * t201 * t2290 * t2291;
  t2297 = t750 * t29 * t180 * t185;
  t2299 = t917 * t1978;
  t2300 = t165 * t12;
  t2301 = t2300 * t185;
  t2303 = 0.4e1 / 0.9e1 * t2299 * t2301;
  t2307 = 0.4e1 / 0.9e1 * t750 * t589 * t12 * t576;
  t2311 = 0.16e2 / 0.9e1 * t750 * t208 * t12 * t185;
  t2313 = t21 * params->c * t208;
  t2315 = 0.8e1 / 0.9e1 * t2313 * t759;
  t2316 = -0.4e1 / 0.3e1 * t2265 - t2270 - 0.4e1 / 0.3e1 * t2272 - t2277 + t2279 / 0.3e1 + t2285 + 0.2e1 / 0.3e1 * t2288 + t2294 - 0.4e1 / 0.3e1 * t2297 - t2303 - t2307 + t2311 - t2315;
  t2318 = t757 * t309 * params->d;
  t2319 = t756 * t2318;
  t2322 = t21 * t859 * t589;
  t2324 = t2322 * t759 / 0.9e1;
  t2326 = t21 * params->c * t589;
  t2328 = t2048 * t122 * t213;
  t2330 = 0.2e1 / 0.9e1 * t2326 * t2328;
  t2331 = t909 * t853;
  t2333 = t909 * t856;
  t2336 = t860 * t1552 * t16;
  t2338 = 0.5e1 / 0.54e2 * t2336 * t320;
  t2340 = 0.11e2 / 0.27e2 * t1573 * t875;
  t2341 = t312 * t23;
  t2342 = t2341 * t772;
  t2344 = 0.4e1 / 0.9e1 * t1795 * t2342;
  t2345 = t874 * t777;
  t2346 = t872 * t2345;
  t2349 = t897 * t899 * t879;
  t2351 = t874 * t782;
  t2352 = t872 * t2351;
  t2355 = t897 * t899 * t884;
  t2357 = t1788 * t23;
  t2358 = t2357 * t16;
  t2359 = t312 * t2358;
  t2360 = t127 * t787;
  t2361 = t2360 * t791;
  t2362 = t2361 * t319;
  t2364 = 0.2e1 / 0.27e2 * t2359 * t2362;
  t2365 = 0.2e1 / 0.3e1 * t2319 + t2324 + t2330 - t2331 / 0.3e1 - t2333 / 0.3e1 - t2338 - t2340 + t2344 + 0.2e1 / 0.9e1 * t2346 + 0.2e1 / 0.9e1 * t2349 + 0.2e1 / 0.9e1 * t2352 + 0.2e1 / 0.9e1 * t2355 + t2364;
  t2368 = t125 * t323 * t787;
  t2370 = t791 * t1788 * t136;
  t2373 = 0.2e1 / 0.27e2 * t2368 * t2370 * t328;
  t2375 = t325 * t903 * t879;
  t2378 = t325 * t903 * t884;
  t2380 = t317 * t1804;
  t2381 = t315 * t2380;
  t2383 = t592 * t155;
  t2384 = t2383 * params->d;
  t2386 = t325 * t326 * t2384;
  t2388 = t317 * t1808;
  t2389 = t315 * t2388;
  t2391 = t180 * t371;
  t2392 = t2391 * params->d;
  t2394 = t325 * t326 * t2392;
  t2396 = t317 * t1815;
  t2397 = t315 * t2396;
  t2399 = t12 * t844;
  t2400 = t2399 * params->d;
  t2402 = t325 * t326 * t2400;
  t2404 = t863 * t853;
  t2406 = t863 * t856;
  t2408 = params->b * t2281;
  t2409 = t2408 * t1572;
  t2411 = t2409 * t320 / 0.162e3;
  t2412 = t582 * t23;
  t2413 = t2412 * t16;
  t2414 = t860 * t2413;
  t2416 = t2414 * t875 / 0.27e2;
  t2417 = t2373 - t2375 / 0.3e1 - t2378 / 0.3e1 + t2381 / 0.6e1 + t2386 / 0.6e1 + t2389 / 0.3e1 + t2394 / 0.3e1 + t2397 / 0.6e1 + t2402 / 0.6e1 + t2404 / 0.18e2 + t2406 / 0.18e2 + t2411 + t2416;
  t2418 = t878 * t213;
  t2420 = t890 * t891 * t2418;
  t2422 = t883 * t213;
  t2424 = t890 * t891 * t2422;
  t2426 = t2064 * t127;
  t2428 = t125 * t2426 * params->m2;
  t2429 = t137 * t1570;
  t2430 = t327 * t627;
  t2433 = t2428 * t2429 * t2430 / 0.27e2;
  t2435 = t125 * t888 * t332;
  t2437 = t335 * t582 * t136;
  t2440 = 0.2e1 / 0.27e2 * t2435 * t2437 * t892;
  t2441 = t137 * t208;
  t2444 = 0.26e2 / 0.81e2 * t325 * t2441 * t328;
  t2446 = t312 * t2267 * t16;
  t2448 = 0.26e2 / 0.81e2 * t2446 * t320;
  t2449 = t137 * t589;
  t2452 = 0.5e1 / 0.27e2 * t890 * t2449 * t892;
  t2455 = 0.11e2 / 0.27e2 * t897 * t1979 * t328;
  t2457 = t190 * t968 * t310;
  t2459 = t873 * t1962;
  t2461 = 0.52e2 / 0.27e2 * t2459 * t965;
  t2462 = t869 * params->b;
  t2465 = 0.56e2 / 0.27e2 * t190 * t2462 * t123;
  t2467 = t190 * t191 * t748;
  t2469 = t964 * t310;
  t2470 = t963 * t2469;
  t2472 = t2360 * t1949;
  t2474 = 0.8e1 / 0.27e2 * t2472 * t965;
  t2475 = t2420 / 0.9e1 + t2424 / 0.9e1 + t2433 + t2440 + t2444 + t2448 - t2452 - t2455 - 0.8e1 / 0.3e1 * t2457 - t2461 + t2465 + 0.2e1 * t2467 + 0.4e1 / 0.3e1 * t2470 + t2474;
  t2478 = t1850 + t1983 + t2032 + t2261 + t2316 + t2365 + t2417 + t2475;
  tv3rho30 = t161 * t2478 + 0.3e1 * t1782;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t2481 = 0.2e1 * params->a * t1256;
  t2483 = 0.2e1 / 0.3e1 * t1252 * t186;
  t2484 = t380 * t577;
  t2489 = 0.16e2 / 0.3e1 * t209 * t1130;
  t2490 = 0.4e1 * t177;
  t2491 = 0.12e2 * t1785;
  t2492 = -t2490 - t2491 + t1790;
  t2496 = t1007 * t220 / 0.36e2;
  t2497 = t379 * t703;
  t2501 = t2492 * t35 / 0.72e2 + t2496 + t2497 / 0.72e2 + t2071 / 0.72e2 + t2073 / 0.36e2 + t2087;
  t2503 = t583 * t384;
  t2520 = t1884 * t389;
  t2523 = t56 * t7;
  t2524 = t229 * t177;
  t2529 = t228 * t177;
  t2534 = my_piecewise3(t49, 0, 0.8e2 / 0.27e2 * t2520 * t599 + 0.16e3 / 0.9e1 * t2523 * t2524 + 0.4e2 / 0.9e1 * t987 * t603 + 0.16e2 / 0.3e1 * t2529 - 0.16e2 * t990 * t589);
  t2535 = t1907 * t393;
  t2538 = t63 * t7;
  t2539 = t234 * t177;
  t2544 = t233 * t177;
  t2549 = my_piecewise3(t60, 0, 0.8e2 / 0.27e2 * t2535 * t608 - 0.16e3 / 0.9e1 * t2538 * t2539 + 0.4e2 / 0.9e1 * t995 * t611 - 0.16e2 / 0.3e1 * t2544 + 0.16e2 * t998 * t589);
  t2550 = t2534 + t2549;
  t2554 = -0.176e3 / 0.9e1 * t2090 + 0.8e1 / 0.3e1 * t2092 + t2095 + t2489 - t30 * t2501 - 0.88e2 / 0.9e1 * t2503 - 0.3e1 / 0.2e2 * t45 * t2492 * t66 - 0.3e1 / 0.1e2 * t45 * t1007 * t238 - 0.3e1 / 0.2e2 * t45 * t379 * t616 - 0.3e1 / 0.2e2 * t45 * t592 * t397 - 0.3e1 / 0.1e2 * t45 * t180 * t1003 - 0.3e1 / 0.2e2 * t45 * t12 * t2550;
  t2555 = t70 * t2492;
  t2559 = t1008 * t246 / 0.16e2;
  t2562 = t401 * t636;
  t2565 = t401 * t639 / 0.16e2;
  t2571 = t242 * t1017 / 0.16e2;
  t2574 = t635 * t412;
  t2575 = t71 * t2574;
  t2577 = t245 * t1026;
  t2579 = t71 * t2577 / 0.16e2;
  t2580 = t645 * t392;
  t2582 = t252 * t994;
  t2584 = t79 * t2534;
  t2585 = t408 * t615;
  t2587 = t86 * t2549;
  t2588 = 0.88e2 / 0.9e1 * t2580 - 0.16e2 / 0.3e1 * t2582 + t2584 - 0.8e1 / 0.3e1 * t2585 + t2587;
  t2589 = t73 * t2588;
  t2592 = t2555 * t89 / 0.32e2 + t2559 + t1008 * t258 / 0.16e2 + t2562 / 0.32e2 + t2565 + t401 * t653 / 0.32e2 + t620 * t413 / 0.32e2 + t2571 + t242 * t1027 / 0.16e2 + t2575 / 0.32e2 + t2579 + t71 * t2589 / 0.32e2;
  t2597 = t1008 * t265 / 0.288e3;
  t2600 = t401 * t666;
  t2603 = t401 * t669 / 0.288e3;
  t2609 = t242 * t1039 / 0.288e3;
  t2612 = t665 * t428;
  t2613 = t71 * t2612;
  t2615 = t264 * t1062;
  t2617 = t71 * t2615 / 0.288e3;
  t2633 = my_piecewise3(t49, 0, 0.44e3 / 0.27e2 * t987 * t599 + 0.352e3 / 0.9e1 * t990 * t2524 + 0.88e2 / 0.9e1 * t390 * t603 + 0.22e2 / 0.3e1 * t57 * t177 - 0.22e2 * t1046 * t589);
  t2648 = my_piecewise3(t60, 0, 0.44e3 / 0.27e2 * t995 * t608 - 0.352e3 / 0.9e1 * t998 * t2539 + 0.88e2 / 0.9e1 * t394 * t611 - 0.22e2 / 0.3e1 * t64 * t177 + 0.22e2 * t1056 * t589);
  t2650 = 0.88e2 / 0.9e1 * t645 * t420 - 0.16e2 / 0.3e1 * t252 * t1050 + t79 * t2633 - 0.8e1 / 0.3e1 * t408 * t688 + t86 * t2648;
  t2651 = t92 * t2650;
  t2654 = t2555 * t104 / 0.576e3 + t2597 + t1008 * t279 / 0.288e3 + t2600 / 0.576e3 + t2603 + t401 * t691 / 0.576e3 + t620 * t429 / 0.576e3 + t2609 + t242 * t1063 / 0.288e3 + t2613 / 0.576e3 + t2617 + t71 * t2651 / 0.576e3;
  t2666 = t644 * t392;
  t2671 = t229 * t7;
  t2672 = t2671 * t177;
  t2679 = my_piecewise3(t49, 0, -0.12e2 * t1079 * t589 + 0.4e1 * t177 * t48 + 0.2e1 * t389 * t603 + 0.8e1 * t2672);
  t2680 = t2679 * sigma[2];
  t2689 = 0.176e3 / 0.27e2 * t2580 - 0.32e2 / 0.9e1 * t2582 + 0.2e1 / 0.3e1 * t2584 - 0.16e2 / 0.9e1 * t2585 + 0.2e1 / 0.3e1 * t2587 + 0.4e1 / 0.3e1 * t1106 * t300 - 0.22e2 / 0.9e1 * t450 * t735 + 0.4e1 / 0.3e1 * t297 * t1115 - 0.22e2 / 0.9e1 * t115 * t2666 - t2680 * t111 / 0.4e1 - t1084 * t291 / 0.2e1 - t438 * t721 / 0.4e1 + 0.2e1 / 0.3e1 * t716 * t441;
  t2692 = t407 * t615;
  t2699 = t85 * t2549;
  t2704 = t234 * t7;
  t2705 = t2704 * t177;
  t2712 = my_piecewise3(t60, 0, 0.12e2 * t1101 * t589 - 0.4e1 * t177 * t59 + 0.2e1 * t393 * t611 - 0.8e1 * t2705);
  t2713 = t2712 * sigma[0];
  t2726 = t251 * t994;
  t2729 = t78 * t2534;
  t2732 = 0.4e1 / 0.3e1 * t288 * t1091 + 0.2e1 / 0.3e1 * t110 * t2692 - t716 * t444 / 0.4e1 - t288 * t1096 / 0.2e1 - t110 * t2699 / 0.4e1 - t2713 * t116 / 0.4e1 - t1106 * t303 / 0.2e1 + 0.4e1 / 0.3e1 * t450 * t738 - t450 * t741 / 0.4e1 - t728 * t453 / 0.4e1 - t297 * t1118 / 0.2e1 + 0.4e1 / 0.3e1 * t115 * t2726 - t115 * t2729 / 0.4e1;
  t2746 = -t70 * (t2689 + t2732) / 0.8e1 + t2152 / 0.288e3 + t2155 / 0.576e3 + t2185 / 0.32e2 + t2189 / 0.16e2 + t2191 / 0.16e2 + t2202 + t2205 / 0.16e2 + t2208 / 0.32e2 + t2216 / 0.576e3 + t2220 / 0.288e3 + t2222 / 0.288e3 + t2233;
  t2748 = t2554 + t2592 + t2654 + t2746;
  t2749 = t24 * t2748;
  t2751 = t6 * t2492;
  t2753 = t380 * t569;
  t2766 = -t2483 - 0.2e1 / 0.9e1 * t2484 + t21 * t2749 - t2751 * t16 + 0.4e1 / 0.9e1 * t2753 + t1798 + t1802 + t1806 / 0.9e1 + 0.2e1 / 0.9e1 * t1810 + 0.4e1 / 0.27e2 * t1813 + t1817 / 0.9e1 + 0.4e1 / 0.27e2 * t1820 + t1831 - t1835 / 0.18e2 - t1839 / 0.9e1 - t1843 / 0.18e2 - 0.14e2 / 0.27e2 * t1944 - 0.14e2 / 0.27e2 * t1947 - t1952 + 0.4e1 / 0.27e2 * t1956;
  t2775 = 0.4e1 / 0.27e2 * t1960 + t1965 - t1970 + 0.8e1 / 0.9e1 * t1972 + 0.8e1 / 0.9e1 * t1976 + t1982 + t1986 - t1990 - t1992 + 0.16e2 / 0.9e1 * t1994 + t1999 - t2003 + t2006 + t2010 - 0.2e1 / 0.3e1 * t2013 - 0.8e1 / 0.9e1 * t2016 - t2025 + t2028 / 0.3e1 + t2031 / 0.3e1 - t2036;
  t2787 = 0.2e1 / 0.27e2 * t2038 + 0.2e1 / 0.27e2 * t2041 + t2046 + t2053 + t2059 - t2060 / 0.3e1 - 0.4e1 / 0.9e1 * t2061 - t2068 + 0.8e1 / 0.9e1 * t2253 + t2257 - t2260 - 0.8e1 / 0.9e1 * t2265 - t2270 - 0.8e1 / 0.9e1 * t2272 - t2277 + 0.2e1 / 0.9e1 * t2279 + t2285 + 0.4e1 / 0.9e1 * t2288 + t2294 - 0.8e1 / 0.9e1 * t2297;
  t2788 = t312 * t460;
  t2789 = t768 * t2788;
  t2791 = t1240 * params->d;
  t2792 = t125 * t2791;
  t2793 = t768 * t2792;
  t2795 = t4 * t2492;
  t2804 = t136 * t1007;
  t2805 = t2804 * t155;
  t2808 = 0.2e1 / 0.9e1 * t334 * t336 * t2805;
  t2813 = t1137 * t371;
  t2816 = 0.2e1 / 0.9e1 * t334 * t336 * t2813;
  t2818 = t789 * t792 * t1138;
  t2828 = t750 * t29 * t379 * t185;
  t2831 = t757 * t459 * params->d;
  t2832 = t756 * t2831;
  t2838 = t776 * t487;
  t2841 = 0.2e1 / 0.9e1 * t334 * t336 * t2838;
  t2842 = t177 * sigma[0];
  t2849 = t825 * t392;
  t2852 = t177 * sigma[2];
  t2863 = t357 * t994;
  t2866 = t145 * t2534;
  t2871 = t2842 * t146 / 0.24e2 + 0.11e2 / 0.9e1 * t470 * t826 - 0.2e1 / 0.3e1 * t354 * t1157 + 0.11e2 / 0.9e1 * t144 * t2849 - t2852 * t152 / 0.24e2 - 0.2e1 / 0.3e1 * t470 * t829 + t470 * t832 / 0.8e1 + t818 * t473 / 0.8e1 + t354 * t1160 / 0.4e1 - 0.2e1 / 0.3e1 * t144 * t2863 + t144 * t2866 / 0.8e1 + t477 * t841 / 0.8e1;
  t2876 = t480 * t615;
  t2883 = t151 * t2549;
  t2890 = t1785 * sigma[0];
  t2895 = t1785 * sigma[2];
  t2900 = -t836 * t481 / 0.3e1 - 0.2e1 / 0.3e1 * t365 * t1170 - t150 * t2876 / 0.3e1 + t836 * t484 / 0.8e1 + t365 * t1175 / 0.4e1 + t150 * t2883 / 0.8e1 - 0.7e1 / 0.48e2 * t70 * t2588 - t1937 - t1163 * t368 / 0.12e2 - t2890 * t146 / 0.8e1 - 0.2e1 / 0.9e1 * t1148 * t358 + t2895 * t152 / 0.8e1 + t1148 * t361 / 0.12e2;
  t2901 = t2871 + t2900;
  t2906 = -t2307 + t2311 - t2315 + 0.4e1 / 0.9e1 * t2319 + t2324 + t2330 - 0.4e1 / 0.9e1 * t2828 + 0.2e1 / 0.9e1 * t2832 + t130 * t137 * t345 * t1178 / 0.3e1 + t2841 + t130 * t137 * t138 * t2901 / 0.6e1;
  t2910 = t318 * t1178;
  t2913 = 0.2e1 / 0.9e1 * t334 * t336 * t2910;
  t2915 = t789 * t792 * t1183;
  t2917 = t169 * t1007;
  t2921 = t130 * t137 * t2917 * t155 / 0.9e1;
  t2925 = t130 * t137 * t1187 * t371 / 0.9e1;
  t2927 = t334 * t849 * t1138;
  t2932 = t130 * t137 * t796 * t487 / 0.9e1;
  t2936 = t130 * t137 * t340 * t1178 / 0.9e1;
  t2938 = t334 * t849 * t1183;
  t2940 = t568 * t379;
  t2943 = t130 * t137 * t2940 * t155;
  t2947 = t130 * t137 * t762 * t487;
  t2955 = t2913 + 0.2e1 / 0.27e2 * t2915 - t2921 - t2925 - 0.7e1 / 0.27e2 * t2927 - t2932 - t2936 - 0.7e1 / 0.27e2 * t2938 + 0.2e1 / 0.27e2 * t2943 + 0.2e1 / 0.27e2 * t2947 - 0.2e1 / 0.9e1 * t2331 - 0.2e1 / 0.9e1 * t2333 - t2338 - t2340 + t2344 + 0.4e1 / 0.27e2 * t2346 + 0.4e1 / 0.27e2 * t2349 + 0.4e1 / 0.27e2 * t2352 + 0.4e1 / 0.27e2 * t2355 + t2364;
  t2968 = t2373 - 0.2e1 / 0.9e1 * t2375 - 0.2e1 / 0.9e1 * t2378 + t2381 / 0.18e2 + t2386 / 0.18e2 + t2389 / 0.9e1 + t2394 / 0.9e1 + t2397 / 0.18e2 + t2402 / 0.18e2 + t2404 / 0.27e2 + t2406 / 0.27e2 + t2411 + t2416 + 0.2e1 / 0.27e2 * t2420 + 0.2e1 / 0.27e2 * t2424 + t2433 + t2440 + t2444 + t2448 - t2452;
  t2970 = t317 * t2805;
  t2972 = t315 * t2970 / 0.9e1;
  t2973 = t1007 * t155;
  t2974 = t2973 * params->d;
  t2977 = t325 * t326 * t2974 / 0.9e1;
  t2978 = t317 * t2813;
  t2980 = t315 * t2978 / 0.9e1;
  t2981 = t379 * t371;
  t2982 = t2981 * params->d;
  t2985 = t325 * t326 * t2982 / 0.9e1;
  t2986 = t874 * t1138;
  t2987 = t872 * t2986;
  t2990 = t897 * t899 * t1219;
  t2992 = t317 * t2838;
  t2994 = t315 * t2992 / 0.9e1;
  t2995 = t180 * t487;
  t2996 = t2995 * params->d;
  t2999 = t325 * t326 * t2996 / 0.9e1;
  t3000 = t317 * t2910;
  t3002 = t315 * t3000 / 0.9e1;
  t3003 = t12 * t1178;
  t3004 = t3003 * params->d;
  t3007 = t325 * t326 * t3004 / 0.9e1;
  t3008 = t874 * t1183;
  t3009 = t872 * t3008;
  t3012 = t897 * t899 * t1211;
  t3014 = t909 * t1215;
  t3017 = t325 * t903 * t1219;
  t3019 = t863 * t1215;
  t3021 = t1218 * t213;
  t3023 = t890 * t891 * t3021;
  t3025 = t909 * t1223;
  t3028 = t325 * t903 * t1211;
  t3030 = t863 * t1223;
  t3032 = -t2455 + t2972 + t2977 + t2980 + t2985 + 0.2e1 / 0.27e2 * t2987 + 0.2e1 / 0.27e2 * t2990 + t2994 + t2999 + t3002 + t3007 + 0.2e1 / 0.27e2 * t3009 + 0.2e1 / 0.27e2 * t3012 - t3014 / 0.9e1 - t3017 / 0.9e1 + t3019 / 0.54e2 + t3023 / 0.27e2 - t3025 / 0.9e1 - t3028 / 0.9e1 + t3030 / 0.54e2;
  t3033 = t1210 * t213;
  t3035 = t890 * t891 * t3033;
  t3038 = t167 * t923 * t1232;
  t3041 = t195 * t928 * t1236;
  t3044 = t201 * t1240 * t932;
  t3046 = t16 * t1133;
  t3049 = 0.2e1 / 0.3e1 * t195 * t196 * t3046;
  t3050 = t184 * t1133;
  t3053 = 0.2e1 / 0.3e1 * t201 * t3050 * t203;
  t3054 = t1007 * t16;
  t3057 = 0.4e1 / 0.3e1 * t167 * t170 * t3054;
  t3059 = t918 * t919 * t1232;
  t3062 = t940 * t907 * t1236;
  t3064 = t575 * t459;
  t3066 = t201 * t3064 * t949;
  t3069 = t956 * t1219;
  t3070 = t955 * t3069;
  t3072 = t956 * t1211;
  t3073 = t955 * t3072;
  t3079 = t190 * t968 * t460;
  t3083 = 0.4e1 / 0.3e1 * t190 * t191 * t1134;
  t3084 = t964 * t460;
  t3085 = t963 * t3084;
  t3087 = t3070 / 0.27e2 + t3073 / 0.27e2 - 0.16e2 / 0.9e1 * t2457 - t2461 + t2465 + 0.2e1 / 0.3e1 * t2467 + 0.8e1 / 0.9e1 * t2470 + t2474 - 0.8e1 / 0.9e1 * t3079 + t3083 + 0.4e1 / 0.9e1 * t3085;
  t3091 = 0.2e1 / 0.9e1 * t3066 + t2787 - 0.4e1 / 0.9e1 * t3059 + t3062 / 0.9e1 - t3057 + t2766 + t2955 + t2906 + t3087 + t3032 - t2303 + t3049 + t3053 - 0.4e1 / 0.9e1 * t3044 + t2808 + 0.4e1 / 0.9e1 * t2789 + t2775 + 0.4e1 / 0.9e1 * t2793 + t130 * t137 * t2795 * t155 / 0.6e1 + t130 * t137 * t1197 * t371 / 0.3e1 + t130 * t137 * t462 * t844 / 0.6e1 + t130 * t137 * t805 * t487 / 0.6e1 + t2816 + 0.2e1 / 0.27e2 * t2818 + t2968 - 0.4e1 / 0.9e1 * t3041 + t3035 / 0.27e2 + 0.8e1 / 0.9e1 * t3038;
  tv3rho31 = t161 * t3091 + t1782 + t2481;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t3093 = params->a * t1448;
  t3095 = -t2490 + t2491 + t1790;
  t3096 = t6 * t3095;
  t3107 = -t2483 - 0.4e1 / 0.9e1 * t2484 - t3096 * t16 + 0.8e1 / 0.9e1 * t2753 + t1798 + t1802 + 0.2e1 / 0.27e2 * t1813 + 0.2e1 / 0.27e2 * t1820 + t1831 - 0.7e1 / 0.27e2 * t1944 - 0.7e1 / 0.27e2 * t1947 - t1952 + 0.2e1 / 0.27e2 * t1956 + 0.2e1 / 0.27e2 * t1960 + t1965 - t1970 + 0.4e1 / 0.9e1 * t1972 + 0.4e1 / 0.9e1 * t1976 + t1982 + t1986;
  t3112 = t1348 * t186;
  t3114 = t389 * t7;
  t3117 = t229 * t1279;
  t3121 = -0.2e1 * t177 - 0.6e1 * t1785;
  t3125 = my_piecewise3(t49, 0, 0.8e1 * t177 * t3114 + 0.2e1 * t3121 * t48 + 0.2e1 * t3117);
  t3126 = t3125 * sigma[2];
  t3141 = t1287 * t237;
  t3146 = t407 * t1002;
  t3151 = t1907 * t1293;
  t3156 = t63 * t1296;
  t3159 = -t3121;
  t3160 = t233 * t3159;
  t3163 = my_piecewise3(t60, 0, 0.8e2 / 0.27e2 * t3151 * t234 - 0.16e3 / 0.9e1 * t995 * t587 + 0.4e2 / 0.9e1 * t3156 * t234 + 0.8e1 / 0.3e1 * t3160);
  t3164 = t85 * t3163;
  t3167 = t393 * t7;
  t3170 = t234 * t1296;
  t3175 = my_piecewise3(t60, 0, -0.8e1 * t177 * t3167 + 0.2e1 * t3159 * t59 + 0.2e1 * t3170);
  t3176 = t3175 * sigma[0];
  t3179 = -t3126 * t111 / 0.4e1 - t1412 * t291 / 0.4e1 + 0.4e1 / 0.3e1 * t1084 * t441 + 0.4e1 / 0.3e1 * t438 * t1091 - t1084 * t444 / 0.2e1 - t438 * t1096 / 0.2e1 - 0.22e2 / 0.9e1 * t288 * t1419 - 0.22e2 / 0.9e1 * t110 * t3141 + 0.4e1 / 0.3e1 * t288 * t1422 + 0.4e1 / 0.3e1 * t110 * t3146 - t288 * t1425 / 0.4e1 - t110 * t3164 / 0.4e1 - t3176 * t116 / 0.4e1;
  t3188 = t1884 * t1275;
  t3193 = t56 * t1279;
  t3196 = t228 * t3121;
  t3199 = my_piecewise3(t49, 0, 0.8e2 / 0.27e2 * t3188 * t229 + 0.16e3 / 0.9e1 * t987 * t587 + 0.4e2 / 0.9e1 * t3193 * t229 + 0.8e1 / 0.3e1 * t3196);
  t3200 = t78 * t3199;
  t3207 = t251 * t1283;
  t3210 = t252 * t1283;
  t3212 = t79 * t3199;
  t3214 = t1288 * t237;
  t3216 = t408 * t1002;
  t3218 = t86 * t3163;
  t3220 = -t1432 * t303 / 0.4e1 - t1106 * t453 / 0.2e1 - t450 * t1118 / 0.2e1 - t297 * t1437 / 0.4e1 - t115 * t3200 / 0.4e1 + 0.2e1 / 0.3e1 * t1432 * t300 + 0.4e1 / 0.3e1 * t450 * t1115 + 0.2e1 / 0.3e1 * t115 * t3207 - 0.16e2 / 0.9e1 * t3210 + 0.2e1 / 0.3e1 * t3212 + 0.176e3 / 0.27e2 * t3214 - 0.32e2 / 0.9e1 * t3216 + 0.2e1 / 0.3e1 * t3218;
  t3225 = t209 * t1402;
  t3230 = -t70 * (t3179 + t3220) / 0.8e1 - 0.88e2 / 0.9e1 * t2090 + t2095 + 0.8e1 / 0.3e1 * t3225 + t2489 - 0.176e3 / 0.9e1 * t2503 + t2559 + t2562 / 0.16e2 + t2565 + t2571 + t2575 / 0.16e2 + t2579;
  t3235 = t1264 * t220;
  t3239 = t3095 * t35 / 0.72e2 + t3235 / 0.72e2 + t2496 + t2497 / 0.36e2 + t2073 / 0.72e2 + t2087;
  t3245 = t2597 + t2600 / 0.288e3 + t2603 + t2609 + t2613 / 0.288e3 + t2617 - t30 * t3239 + t2152 / 0.576e3 + t2189 / 0.32e2 + t2202 + t2205 / 0.32e2 + t2220 / 0.576e3;
  t3258 = my_piecewise3(t49, 0, 0.44e3 / 0.27e2 * t1276 * t229 + 0.352e3 / 0.9e1 * t390 * t587 + 0.88e2 / 0.9e1 * t1280 * t229 + 0.11e2 / 0.3e1 * t57 * t3121);
  t3273 = my_piecewise3(t60, 0, 0.44e3 / 0.27e2 * t1294 * t234 - 0.352e3 / 0.9e1 * t394 * t587 + 0.88e2 / 0.9e1 * t1297 * t234 + 0.11e2 / 0.3e1 * t64 * t3159);
  t3275 = -0.8e1 / 0.3e1 * t252 * t1382 + t79 * t3258 + 0.88e2 / 0.9e1 * t1288 * t276 - 0.16e2 / 0.3e1 * t408 * t1060 + t86 * t3273;
  t3276 = t92 * t3275;
  t3279 = t70 * t3095;
  t3282 = t1365 * t246;
  t3288 = t401 * t1017;
  t3294 = t245 * t1302;
  t3295 = t71 * t3294;
  t3300 = -0.8e1 / 0.3e1 * t3210 + t3212 + 0.88e2 / 0.9e1 * t3214 - 0.16e2 / 0.3e1 * t3216 + t3218;
  t3301 = t73 * t3300;
  t3306 = t2233 + t71 * t3276 / 0.576e3 + t3279 * t89 / 0.32e2 + t3282 / 0.32e2 + t1365 * t258 / 0.32e2 + t1008 * t413 / 0.16e2 + t3288 / 0.16e2 + t401 * t1027 / 0.16e2 + t242 * t1370 / 0.32e2 + t3295 / 0.32e2 + t71 * t3301 / 0.32e2 + t3279 * t104 / 0.576e3;
  t3307 = t1365 * t265;
  t3313 = t401 * t1039;
  t3319 = t264 * t1395;
  t3320 = t71 * t3319;
  t3337 = t3199 + t3163;
  t3341 = t3307 / 0.576e3 + t1365 * t279 / 0.576e3 + t1008 * t429 / 0.288e3 + t3313 / 0.288e3 + t401 * t1063 / 0.288e3 + t242 * t1396 / 0.576e3 + t3320 / 0.576e3 - 0.3e1 / 0.2e2 * t45 * t3095 * t66 - 0.3e1 / 0.2e2 * t45 * t1264 * t238 - 0.3e1 / 0.1e2 * t45 * t1007 * t397 - 0.3e1 / 0.1e2 * t45 * t379 * t1003 - 0.3e1 / 0.2e2 * t45 * t180 * t1361 - 0.3e1 / 0.2e2 * t45 * t12 * t3337;
  t3343 = t3230 + t3245 + t3306 + t3341;
  t3344 = t24 * t3343;
  t3348 = -t1990 - t1992 + 0.8e1 / 0.9e1 * t1994 + t1999 - t2003 + t2006 + t2010 - 0.4e1 / 0.9e1 * t2016 - t2025 - t2036 + t2038 / 0.27e2 + t2041 / 0.27e2 + t2046 + t2053 + t2059 - t3112 / 0.3e1 + t21 * t3344 - 0.2e1 / 0.9e1 * t2061 - t2068 + 0.4e1 / 0.9e1 * t2253;
  t3358 = t2257 - t2260 - 0.4e1 / 0.9e1 * t2265 - t2270 - 0.4e1 / 0.9e1 * t2272 - t2277 + t2279 / 0.9e1 + t2285 + 0.2e1 / 0.9e1 * t2288 + t2294 - 0.4e1 / 0.9e1 * t2297 + 0.8e1 / 0.9e1 * t2789 + 0.8e1 / 0.9e1 * t2793 + t2808 + t2816 + 0.4e1 / 0.27e2 * t2818 - t2303 - t2307 + t2311 - t2315;
  t3368 = t4 * t3095;
  t3377 = t136 * t1264;
  t3378 = t3377 * t155;
  t3380 = t334 * t336 * t3378;
  t3390 = -0.14e2 / 0.27e2 * t2927 - t2932 - t2936 - 0.14e2 / 0.27e2 * t2938 + 0.4e1 / 0.27e2 * t2943 + 0.4e1 / 0.27e2 * t2947 + t130 * t137 * t3368 * t155 / 0.6e1 + t130 * t137 * t1265 * t371 / 0.6e1 + t3380 / 0.9e1 + t130 * t137 * t1197 * t487 / 0.3e1 + t130 * t137 * t462 * t1178 / 0.3e1;
  t3394 = t1137 * t487;
  t3396 = t334 * t336 * t3394;
  t3405 = -t177 / 0.3e1 - t1785;
  t3406 = t3405 * sigma[0];
  t3421 = t357 * t1283;
  t3424 = t145 * t3199;
  t3427 = -t1937 - 0.7e1 / 0.48e2 * t70 * t3300 + t3406 * t146 / 0.8e1 - t1306 * t358 / 0.3e1 + t1306 * t361 / 0.8e1 + t1148 * t473 / 0.12e2 - 0.2e1 / 0.3e1 * t470 * t1157 + t470 * t1160 / 0.4e1 + t354 * t1311 / 0.8e1 - t144 * t3421 / 0.3e1 + t144 * t3424 / 0.8e1;
  t3428 = -t3405;
  t3429 = t3428 * sigma[2];
  t3444 = t1322 * t237;
  t3449 = t480 * t1002;
  t3454 = t151 * t3163;
  t3457 = t3429 * t152 / 0.8e1 + t1315 * t368 / 0.8e1 + 0.2e1 / 0.9e1 * t1163 * t481 - 0.2e1 / 0.3e1 * t477 * t1170 - t1163 * t484 / 0.12e2 + t477 * t1175 / 0.4e1 + 0.11e2 / 0.9e1 * t365 * t1323 + 0.11e2 / 0.9e1 * t150 * t3444 - 0.2e1 / 0.3e1 * t365 * t1326 - 0.2e1 / 0.3e1 * t150 * t3449 + t365 * t1329 / 0.8e1 + t150 * t3454 / 0.8e1;
  t3458 = t3427 + t3457;
  t3463 = t318 * t1332;
  t3465 = t334 * t336 * t3463;
  t3467 = t169 * t1264;
  t3470 = t130 * t137 * t3467 * t155;
  t3474 = t130 * t137 * t1187 * t487;
  t3478 = t130 * t137 * t340 * t1332;
  t3488 = 0.2e1 / 0.9e1 * t3396 + t130 * t137 * t345 * t1332 / 0.6e1 + t130 * t137 * t138 * t3458 / 0.6e1 + t3465 / 0.9e1 - t3470 / 0.18e2 - t3474 / 0.9e1 - t3478 / 0.18e2 - t2331 / 0.9e1 - t2333 / 0.9e1 - t2338 - t2340 + t2344 + 0.2e1 / 0.27e2 * t2346 + 0.2e1 / 0.27e2 * t2349 + 0.2e1 / 0.27e2 * t2352 + 0.2e1 / 0.27e2 * t2355 + t2364 + t2373 - t2375 / 0.9e1 - t2378 / 0.9e1;
  t3495 = t2404 / 0.54e2 + t2406 / 0.54e2 + t2411 + t2416 + t2420 / 0.27e2 + t2424 / 0.27e2 + t2433 + t2440 + t2444 + t2448 - t2452 - t2455 + t2972 + t2977 + t2980 + t2985 + 0.4e1 / 0.27e2 * t2987 + 0.4e1 / 0.27e2 * t2990 + t2994 + t2999;
  t3507 = t317 * t3378;
  t3508 = t315 * t3507;
  t3510 = t1264 * t155;
  t3511 = t3510 * params->d;
  t3513 = t325 * t326 * t3511;
  t3515 = t317 * t3394;
  t3516 = t315 * t3515;
  t3518 = t379 * t487;
  t3519 = t3518 * params->d;
  t3521 = t325 * t326 * t3519;
  t3523 = t317 * t3463;
  t3524 = t315 * t3523;
  t3526 = t12 * t1332;
  t3527 = t3526 * params->d;
  t3529 = t325 * t326 * t3527;
  t3533 = t3002 + t3007 + 0.4e1 / 0.27e2 * t3009 + 0.4e1 / 0.27e2 * t3012 - 0.2e1 / 0.9e1 * t3014 - 0.2e1 / 0.9e1 * t3017 + t3019 / 0.27e2 + 0.2e1 / 0.27e2 * t3023 - 0.2e1 / 0.9e1 * t3025 - 0.2e1 / 0.9e1 * t3028 + t3030 / 0.27e2 + 0.2e1 / 0.27e2 * t3035 + t3508 / 0.18e2 + t3513 / 0.18e2 + t3516 / 0.9e1 + t3521 / 0.9e1 + t3524 / 0.18e2 + t3529 / 0.18e2 + 0.16e2 / 0.9e1 * t3038 - 0.8e1 / 0.9e1 * t3041;
  t3538 = t1264 * t16;
  t3540 = t167 * t170 * t3538;
  t3542 = t16 * t1443;
  t3544 = t195 * t196 * t3542;
  t3546 = t184 * t1443;
  t3548 = t201 * t3546 * t203;
  t3558 = t190 * t191 * t1444;
  t3560 = 0.2e1 / 0.27e2 * t3070 + 0.2e1 / 0.27e2 * t3073 - 0.8e1 / 0.9e1 * t2457 - t2461 + t2465 + 0.4e1 / 0.9e1 * t2470 + t2474 - 0.16e2 / 0.9e1 * t3079 + t3083 + 0.8e1 / 0.9e1 * t3085 + 0.2e1 / 0.3e1 * t3558;
  t3564 = t3495 + t3488 + 0.4e1 / 0.9e1 * t3066 - 0.8e1 / 0.9e1 * t3059 + 0.2e1 / 0.9e1 * t3062 - t3057 + t3049 + t3053 - 0.8e1 / 0.9e1 * t3044 + t3107 + t2913 + 0.4e1 / 0.27e2 * t2915 + t2841 + 0.4e1 / 0.9e1 * t2832 - t2925 - t2921 + t2330 + 0.2e1 / 0.9e1 * t2319 - 0.8e1 / 0.9e1 * t2828 + t3390 + t3358 + t3348 + t3560 + t3548 / 0.3e1 - 0.2e1 / 0.3e1 * t3540 + t3544 / 0.3e1 + t3533 + t2324;
  tv3rho32 = t161 * t3564 + t2481 + t3093;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t3568 = t1784 + t1786 + t1790;
  t3569 = t6 * t3568;
  t3580 = t1275 * t389;
  t3581 = t1884 * t3580;
  t3585 = -t177 - t1785;
  t3586 = 0.6e1 * t3585;
  t3587 = t228 * t3586;
  t3590 = my_piecewise3(t49, 0, 0.8e2 / 0.27e2 * t3581 + 0.4e2 / 0.3e1 * t987 * t1279 + 0.8e1 / 0.3e1 * t3587);
  t3591 = t1293 * t393;
  t3592 = t1907 * t3591;
  t3596 = -t3586;
  t3597 = t233 * t3596;
  t3600 = my_piecewise3(t60, 0, 0.8e2 / 0.27e2 * t3592 + 0.4e2 / 0.3e1 * t995 * t1296 + 0.8e1 / 0.3e1 * t3597);
  t3601 = t3590 + t3600;
  t3605 = t70 * t3568;
  t3612 = t79 * t3590;
  t3615 = 0.1e1 / t83 / t1285 / rho[1];
  t3616 = sigma[2] * t3615;
  t3617 = t3616 * t65;
  t3619 = t1288 * t396;
  t3621 = t408 * t1300;
  t3623 = t86 * t3600;
  t3624 = t3612 - 0.1232e4 / 0.27e2 * t3617 + 0.88e2 / 0.3e1 * t3619 - 0.8e1 * t3621 + t3623;
  t3625 = t73 * t3624;
  t3641 = my_piecewise3(t49, 0, 0.44e3 / 0.27e2 * t56 * t3580 + 0.88e2 / 0.3e1 * t390 * t1279 + 0.11e2 / 0.3e1 * t57 * t3586);
  t3656 = my_piecewise3(t60, 0, 0.44e3 / 0.27e2 * t63 * t3591 + 0.88e2 / 0.3e1 * t394 * t1296 + 0.11e2 / 0.3e1 * t64 * t3596);
  t3658 = t79 * t3641 - 0.1232e4 / 0.27e2 * t3616 * t101 + 0.88e2 / 0.3e1 * t1288 * t426 - 0.8e1 * t408 * t1393 + t86 * t3656;
  t3659 = t92 * t3658;
  t3666 = t3615 * t65;
  t3679 = my_piecewise3(t49, 0, 0.6e1 * t1279 * t389 + 0.2e1 * t3586 * t48);
  t3680 = t3679 * sigma[2];
  t3689 = t1287 * t396;
  t3692 = t407 * t1300;
  t3695 = t85 * t3600;
  t3703 = my_piecewise3(t60, 0, 0.6e1 * t1296 * t393 + 0.2e1 * t3596 * t59);
  t3704 = t3703 * sigma[0];
  t3711 = t78 * t3590;
  t3714 = 0.2e1 * t1412 * t441 - 0.22e2 / 0.3e1 * t438 * t1419 + 0.308e3 / 0.27e2 * t110 * t3666 + 0.2e1 / 0.3e1 * t3612 + 0.176e3 / 0.9e1 * t3619 - 0.16e2 / 0.3e1 * t3621 + 0.2e1 / 0.3e1 * t3623 - 0.2464e4 / 0.81e2 * t3617 - t3680 * t111 / 0.4e1 - 0.3e1 / 0.4e1 * t1412 * t444 + 0.4e1 * t438 * t1422 - 0.3e1 / 0.4e1 * t438 * t1425 - 0.22e2 / 0.3e1 * t110 * t3689 + 0.2e1 * t110 * t3692 - t110 * t3695 / 0.4e1 - t3704 * t116 / 0.4e1 - 0.3e1 / 0.4e1 * t1432 * t453 - 0.3e1 / 0.4e1 * t450 * t1437 - t115 * t3711 / 0.4e1;
  t3721 = t3568 * t35 / 0.72e2 + t3235 / 0.24e2 + t2497 / 0.24e2 + t2087;
  t3723 = -0.3e1 / 0.2e2 * t45 * t3568 * t66 - 0.9e1 / 0.2e2 * t45 * t1264 * t397 - 0.9e1 / 0.2e2 * t45 * t379 * t1361 - 0.3e1 / 0.2e2 * t45 * t12 * t3601 + t3605 * t89 / 0.32e2 + 0.3e1 / 0.32e2 * t1365 * t413 + 0.3e1 / 0.32e2 * t401 * t1370 + t71 * t3625 / 0.32e2 + t3605 * t104 / 0.576e3 + t1365 * t429 / 0.192e3 + t401 * t1396 / 0.192e3 + t71 * t3659 / 0.576e3 - t70 * t3714 / 0.8e1 - t30 * t3721;
  t3736 = t2095 + 0.8e1 * t3225 - 0.88e2 / 0.3e1 * t2503 + 0.3e1 / 0.32e2 * t2562 + 0.3e1 / 0.32e2 * t2575 + t2600 / 0.192e3 + t2613 / 0.192e3 + t2202 + t2233 + 0.3e1 / 0.32e2 * t3282 + 0.3e1 / 0.16e2 * t3288 + 0.3e1 / 0.32e2 * t3295 + t3307 / 0.192e3 + t3313 / 0.96e2 + t3320 / 0.192e3;
  t3737 = t3723 + t3736;
  t3738 = t24 * t3737;
  t3741 = -0.2e1 / 0.3e1 * t2484 - t3569 * t16 + t21 * t3738 + 0.4e1 / 0.3e1 * t2753 + t1798 + t1802 + t1831 - t1952 + t1965 - t1970 + t1982 + t1986 - t1990;
  t3742 = -t1992 + t1999 - t2003 + t2006 + t2010 - t2025 - t2036 + t2046 + t2053 + t2059 - t3112 - t2068 + t2257;
  t3747 = -t2260 - t2270 - t2277 + t2285 + t2294 + 0.4e1 / 0.3e1 * t2789 + 0.4e1 / 0.3e1 * t2793 + 0.2e1 / 0.9e1 * t2818 - t2303 - t2307 + t2311 - t2315 + t2324;
  t3760 = t2330 - 0.4e1 / 0.3e1 * t2828 + 0.2e1 / 0.3e1 * t2832 + 0.2e1 / 0.9e1 * t2915 - 0.7e1 / 0.9e1 * t2927 - 0.7e1 / 0.9e1 * t2938 + 0.2e1 / 0.9e1 * t2943 + 0.2e1 / 0.9e1 * t2947 + t3380 / 0.3e1 + 0.2e1 / 0.3e1 * t3396 + t3465 / 0.3e1 - t3470 / 0.6e1 - t3474 / 0.3e1;
  t3764 = t4 * t3568;
  t3780 = t70 * t3615;
  t3781 = t3780 * t65;
  t3784 = t3585 * sigma[0];
  t3791 = t145 * t3590;
  t3794 = -t3585;
  t3795 = t3794 * sigma[2];
  t3804 = t1322 * t396;
  t3807 = t480 * t1300;
  t3809 = t151 * t3600;
  t3814 = -t1315 * t481 + 0.11e2 / 0.3e1 * t477 * t1323 - 0.154e3 / 0.27e2 * t150 * t3781 + t3784 * t146 / 0.8e1 + 0.3e1 / 0.8e1 * t1306 * t473 + 0.3e1 / 0.8e1 * t470 * t1311 + t144 * t3791 / 0.8e1 + t3795 * t152 / 0.8e1 + 0.3e1 / 0.8e1 * t1315 * t484 - 0.2e1 * t477 * t1326 + 0.3e1 / 0.8e1 * t477 * t1329 + 0.11e2 / 0.3e1 * t150 * t3804 - t150 * t3807 + t150 * t3809 / 0.8e1 - 0.7e1 / 0.48e2 * t70 * t3624 - t1937;
  t3819 = -t3478 / 0.6e1 + t130 * t137 * t3764 * t155 / 0.6e1 + t130 * t137 * t1265 * t487 / 0.2e1 + t130 * t137 * t462 * t1332 / 0.2e1 + t130 * t137 * t138 * t3814 / 0.6e1 - t2338 - t2340 + t2344 + t2364 + t2373 + t2411 + t2416 + t2433;
  t3828 = t2440 + t2444 + t2448 - t2452 - t2455 + 0.2e1 / 0.9e1 * t2987 + 0.2e1 / 0.9e1 * t2990 + 0.2e1 / 0.9e1 * t3009 + 0.2e1 / 0.9e1 * t3012 - t3014 / 0.3e1 - t3017 / 0.3e1 + t3019 / 0.18e2 + t3023 / 0.9e1;
  t3843 = -t3025 / 0.3e1 - t3028 / 0.3e1 + t3030 / 0.18e2 + t3035 / 0.9e1 + t3508 / 0.6e1 + t3513 / 0.6e1 + t3516 / 0.3e1 + t3521 / 0.3e1 + t3524 / 0.6e1 + t3529 / 0.6e1 + 0.8e1 / 0.3e1 * t3038 - 0.4e1 / 0.3e1 * t3041 - 0.4e1 / 0.3e1 * t3044;
  t3853 = -0.4e1 / 0.3e1 * t3059 + t3062 / 0.3e1 + 0.2e1 / 0.3e1 * t3066 - 0.2e1 * t3540 + t3544 + t3548 + t3070 / 0.9e1 + t3073 / 0.9e1 - t2461 + t2465 + t2474 - 0.8e1 / 0.3e1 * t3079 + 0.4e1 / 0.3e1 * t3085 + 0.2e1 * t3558;
  t3856 = t3741 + t3742 + t3747 + t3760 + t3819 + t3828 + t3843 + t3853;
  tv3rho33 = t161 * t3856 + 0.3e1 * t3093;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t3858 = params->a * t1544;
  t3863 = t727 * t78;
  t3866 = t296 * t251;
  t3871 = t114 * t644;
  t3883 = t242 * t1468;
  t3887 = t635 * t78;
  t3888 = t3887 * t58;
  t3890 = t71 * t3888 / 0.32e2;
  t3891 = t1467 * t232;
  t3892 = t71 * t3891;
  t3894 = t1471 * t232;
  t3897 = t495 * t607;
  t3902 = t242 * t1481;
  t3906 = t665 * t78;
  t3907 = t3906 * t97;
  t3909 = t71 * t3907 / 0.576e3;
  t3910 = -t70 * (0.176e3 / 0.27e2 * t735 - 0.32e2 / 0.9e1 * t738 + 0.2e1 / 0.3e1 * t741 - t3863 * t58 / 0.4e1 + 0.4e1 / 0.3e1 * t3866 * t58 - t1493 * t232 / 0.2e1 - 0.22e2 / 0.9e1 * t3871 * t58 + 0.4e1 / 0.3e1 * t1496 * t232 - t504 * t607 / 0.4e1) / 0.8e1 + t620 * t496 / 0.32e2 + t3883 / 0.16e2 + t242 * t1475 / 0.16e2 + t3890 + t3892 / 0.16e2 - t71 * t3894 / 0.6e1 + t71 * t3897 / 0.32e2 + t620 * t500 / 0.576e3 + t3902 / 0.288e3 + t242 * t1488 / 0.288e3 + t3909;
  t3911 = t1480 * t272;
  t3912 = t71 * t3911;
  t3914 = t1484 * t272;
  t3917 = t499 * t681;
  t3922 = t245 * t251;
  t3923 = t3922 * t58;
  t3924 = t71 * t3923;
  t3926 = t73 * t644;
  t3927 = t3926 * t58;
  t3932 = t264 * t251;
  t3933 = t3932 * t97;
  t3934 = t71 * t3933;
  t3936 = t92 * t644;
  t3937 = t3936 * t97;
  t3940 = t208 * t223;
  t3941 = 0.16e2 / 0.3e1 * t3940;
  t3942 = t29 * t706;
  t3944 = 0.88e2 / 0.9e1 * t582 * t38;
  t3945 = t3912 / 0.288e3 - t71 * t3914 / 0.108e3 + t71 * t3917 / 0.576e3 - t242 * t1472 / 0.6e1 - t3924 / 0.6e1 + 0.11e2 / 0.36e2 * t71 * t3927 - t242 * t1485 / 0.108e3 - t3934 / 0.108e3 + 0.11e2 / 0.648e3 * t71 * t3937 + t3941 - t3942 - t3944;
  t3946 = t3910 + t3945;
  t3947 = t24 * t3946;
  t3949 = t956 * t1512;
  t3951 = t955 * t3949 / 0.27e2;
  t3952 = t180 * t519;
  t3953 = t3952 * params->d;
  t3955 = t325 * t326 * t3953;
  t3957 = t12 * t1539;
  t3958 = t3957 * params->d;
  t3960 = t325 * t326 * t3958;
  t3962 = t1511 * t213;
  t3965 = t890 * t891 * t3962 / 0.27e2;
  t3967 = t909 * t1508 / 0.9e1;
  t3970 = t325 * t903 * t1512 / 0.9e1;
  t3973 = 0.2e1 / 0.27e2 * t897 * t899 * t1512;
  t3974 = t776 * t519;
  t3975 = t317 * t3974;
  t3976 = t315 * t3975;
  t3978 = t318 * t1539;
  t3979 = t317 * t3978;
  t3980 = t315 * t3979;
  t3983 = t863 * t1508 / 0.54e2;
  t3984 = t874 * t1507;
  t3986 = 0.2e1 / 0.27e2 * t872 * t3984;
  t3988 = t757 * t510 * params->d;
  t3990 = 0.2e1 / 0.9e1 * t756 * t3988;
  t3993 = 0.7e1 / 0.27e2 * t334 * t849 * t1507;
  t3997 = 0.2e1 / 0.27e2 * t130 * t137 * t762 * t519;
  t3998 = t312 * t511;
  t4000 = 0.4e1 / 0.9e1 * t768 * t3998;
  t4001 = t1458 * params->d;
  t4002 = t125 * t4001;
  t4004 = 0.4e1 / 0.9e1 * t768 * t4002;
  t4005 = t21 * t3947 + t3951 + t3955 / 0.9e1 + t3960 / 0.9e1 + t3965 - t3967 - t3970 + t3973 + t3976 / 0.9e1 + t3980 / 0.9e1 + t3983 + t3986 + t3990 - t3993 + t3997 + t4000 + t4004;
  t4007 = t334 * t336 * t3974;
  t4010 = t334 * t336 * t3978;
  t4014 = 0.2e1 / 0.27e2 * t789 * t792 * t1507;
  t4017 = t130 * t137 * t796 * t519;
  t4021 = t130 * t137 * t340 * t1539;
  t4031 = 0.308e3 / 0.27e2 * t582;
  t4035 = t817 * t78;
  t4038 = t353 * t251;
  t4043 = t143 * t644;
  t4048 = t70 * t607;
  t4051 = t4031 - 0.77e2 / 0.54e2 * t826 + 0.7e1 / 0.9e1 * t829 - 0.7e1 / 0.48e2 * t832 + t4035 * t516 / 0.8e1 - 0.2e1 / 0.3e1 * t4038 * t516 + t1530 * t1536 / 0.4e1 + 0.11e2 / 0.9e1 * t4043 * t516 - 0.2e1 / 0.3e1 * t1533 * t1536 + t515 * t4048 / 0.8e1;
  t4058 = 0.4e1 / 0.9e1 * t195 * t928 * t1454;
  t4061 = 0.4e1 / 0.9e1 * t201 * t1458 * t932;
  t4062 = t16 * t1504;
  t4064 = t195 * t196 * t4062;
  t4068 = t940 * t907 * t1454 / 0.9e1;
  t4069 = t184 * t1504;
  t4071 = t201 * t4069 * t203;
  t4073 = t575 * t510;
  t4076 = 0.2e1 / 0.9e1 * t201 * t4073 * t949;
  t4079 = 0.8e1 / 0.9e1 * t190 * t968 * t511;
  t4081 = t190 * t191 * t1505;
  t4083 = t964 * t511;
  t4085 = 0.4e1 / 0.9e1 * t963 * t4083;
  t4086 = 0.2e1 / 0.9e1 * t4007 + 0.2e1 / 0.9e1 * t4010 + t4014 - t4017 / 0.9e1 - t4021 / 0.9e1 + t130 * t137 * t805 * t519 / 0.6e1 + t130 * t137 * t345 * t1539 / 0.3e1 + t130 * t137 * t138 * t4051 / 0.6e1 - t4058 - t4061 + 0.2e1 / 0.3e1 * t4064 + t4068 + 0.2e1 / 0.3e1 * t4071 + t4076 - t4079 + 0.4e1 / 0.3e1 * t4081 + t4085;
  t4087 = t4005 + t4086;
  tv3rho2sigma0 = t161 * t4087 + 0.2e1 * t3858;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t4089 = params->a * t1598;
  t4092 = t201 * t1562 * t223;
  t4097 = t16 * t582;
  t4100 = 0.176e3 / 0.9e1 * t201 * t4097 * t38;
  t4101 = t1935 * t23;
  t4103 = t312 * t4101 * t184;
  t4104 = t318 * params->d;
  t4105 = t317 * t4104;
  t4107 = 0.7e1 / 0.81e2 * t4103 * t4105;
  t4109 = t21 * params->c * t1827;
  t4110 = t757 * t1558;
  t4112 = 0.4e1 / 0.9e1 * t4109 * t4110;
  t4113 = t580 * t9;
  t4114 = 0.1e1 / t4113;
  t4115 = t335 * t4114;
  t4118 = 0.14e2 / 0.81e2 * t897 * t4115 * t4104;
  t4119 = t1827 * t23;
  t4120 = t4119 * t16;
  t4121 = t312 * t4120;
  t4123 = 0.77e2 / 0.81e2 * t4121 * t1575;
  t4124 = t1827 * t12;
  t4128 = 0.77e2 / 0.81e2 * t325 * t137 * t4124 * params->d;
  t4130 = t189 * t18 * t1827;
  t4131 = t312 * t1548;
  t4133 = 0.8e1 / 0.9e1 * t4130 * t4131;
  t4135 = t184 * t38 * params->d;
  t4136 = t125 * t4135;
  t4138 = 0.8e1 / 0.9e1 * t4130 * t4136;
  t4140 = t316 * t137 * t180;
  t4141 = t1573 * t4140;
  t4143 = t4101 * t16;
  t4144 = t860 * t4143;
  t4146 = 0.7e1 / 0.162e3 * t4144 * t1575;
  t4147 = t4114 * t23;
  t4148 = t4147 * t16;
  t4149 = t312 * t4148;
  t4150 = t335 * t136;
  t4152 = t873 * t4150 * t12;
  t4154 = 0.14e2 / 0.81e2 * t4149 * t4152;
  t4158 = t325 * t137 * t1570 * t180 * params->d;
  t4164 = 0.7e1 / 0.81e2 * t890 * t137 * t1935 * t12 * t213;
  t4165 = 0.32e2 / 0.3e1 * t4092 - 0.2e1 * t201 * t525 * t706 - t4100 + t4107 - t4112 + t4118 - t4123 - t4128 - t4133 - t4138 + 0.7e1 / 0.27e2 * t4141 + t4146 + t4154 + 0.7e1 / 0.27e2 * t4158 + t4164;
  t4168 = 0.4e2 / 0.9e1 * t195 * t2357 * t1553;
  t4169 = t184 * t1788;
  t4172 = 0.4e2 / 0.9e1 * t201 * t4169 * t1558;
  t4173 = t16 * t223;
  t4175 = t195 * t1552 * t4173;
  t4179 = 0.2e1 / 0.9e1 * t940 * t4119 * t1553;
  t4180 = t223 * params->d;
  t4182 = t201 * t1557 * t4180;
  t4184 = t575 * t1827;
  t4185 = t38 * t213;
  t4188 = 0.4e1 / 0.9e1 * t201 * t4184 * t4185;
  t4189 = t1935 * t136;
  t4193 = 0.161e3 / 0.81e2 * t529 * t1583 * t4189 * t12;
  t4194 = t136 * t1788;
  t4198 = 0.14e2 / 0.3e1 * t529 * t18 * t4194 * t12;
  t4199 = t1788 * params->b;
  t4202 = 0.8e2 / 0.9e1 * t190 * t4199 * t1548;
  t4203 = t24 * t223;
  t4205 = t190 * t1547 * t4203;
  t4207 = t335 * t1935;
  t4208 = t873 * t4207;
  t4209 = t964 * t1548;
  t4211 = 0.8e1 / 0.9e1 * t4208 * t4209;
  t4214 = t529 * t1583 * t1584 * t180;
  t4216 = t787 * t791;
  t4218 = 0.1e1 / t3 / t4113;
  t4219 = t4218 * t136;
  t4223 = 0.14e2 / 0.81e2 * t529 * t4216 * t4219 * t12;
  t4226 = t529 * t18 * t1589 * t180;
  t4232 = t4168 + t4172 - 0.4e1 / 0.3e1 * t4175 - t4179 - 0.4e1 / 0.3e1 * t4182 - t4188 - t4193 + t4198 + t4202 - 0.8e1 / 0.3e1 * t4205 - t4211 + 0.14e2 / 0.27e2 * t4214 + t4223 - 0.7e1 / 0.3e1 * t4226 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t592;
  t4233 = t4165 + t4232;
  tv3rho2sigma1 = t161 * t4233 + 0.2e1 * t4089;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t4235 = params->a * t1674;
  t4239 = t242 * t1615;
  t4243 = t635 * t85;
  t4244 = t4243 * t65;
  t4246 = t71 * t4244 / 0.32e2;
  t4247 = t1614 * t237;
  t4248 = t71 * t4247;
  t4250 = t536 * t615;
  t4255 = t242 * t1624;
  t4259 = t665 * t85;
  t4260 = t4259 * t101;
  t4262 = t71 * t4260 / 0.576e3;
  t4263 = t1623 * t276;
  t4264 = t71 * t4263;
  t4266 = t540 * t688;
  t4270 = t715 * t85;
  t4280 = -t3944 + t3941 - t3942 + t620 * t537 / 0.32e2 + t4239 / 0.16e2 + t242 * t1618 / 0.16e2 + t4246 + t4248 / 0.16e2 + t71 * t4250 / 0.32e2 + t620 * t541 / 0.576e3 + t4255 / 0.288e3 + t242 * t1627 / 0.288e3 + t4262 + t4264 / 0.288e3 + t71 * t4266 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t721 - t4270 * t65 / 0.4e1 - t1631 * t237 / 0.2e1 - t545 * t615 / 0.4e1) / 0.8e1;
  t4281 = t24 * t4280;
  t4283 = t956 * t1647;
  t4285 = t955 * t4283 / 0.27e2;
  t4286 = t12 * t1669;
  t4287 = t4286 * params->d;
  t4289 = t325 * t326 * t4287;
  t4291 = t1646 * t213;
  t4294 = t890 * t891 * t4291 / 0.27e2;
  t4297 = 0.2e1 / 0.27e2 * t897 * t899 * t1647;
  t4298 = t776 * t559;
  t4299 = t317 * t4298;
  t4300 = t315 * t4299;
  t4302 = t318 * t1669;
  t4303 = t317 * t4302;
  t4304 = t315 * t4303;
  t4307 = t863 * t1643 / 0.54e2;
  t4308 = t874 * t1642;
  t4310 = 0.2e1 / 0.27e2 * t872 * t4308;
  t4312 = t909 * t1643 / 0.9e1;
  t4315 = t325 * t903 * t1647 / 0.9e1;
  t4316 = t180 * t559;
  t4317 = t4316 * params->d;
  t4319 = t325 * t326 * t4317;
  t4322 = t757 * t551 * params->d;
  t4324 = 0.2e1 / 0.9e1 * t756 * t4322;
  t4326 = t835 * t85;
  t4331 = t70 * t615;
  t4334 = t4031 - 0.7e1 / 0.48e2 * t841 + t4326 * t556 / 0.8e1 + t1663 * t1666 / 0.4e1 + t555 * t4331 / 0.8e1;
  t4341 = t130 * t137 * t796 * t559;
  t4345 = t130 * t137 * t340 * t1669;
  t4351 = t21 * t4281 + t4285 + t4289 / 0.9e1 + t4294 + t4297 + t4300 / 0.9e1 + t4304 / 0.9e1 + t4307 + t4310 - t4312 - t4315 + t4319 / 0.9e1 + t4324 + t130 * t137 * t138 * t4334 / 0.6e1 - t4341 / 0.9e1 - t4345 / 0.9e1 + t130 * t137 * t805 * t559 / 0.6e1;
  t4356 = t312 * t552;
  t4358 = 0.4e1 / 0.9e1 * t768 * t4356;
  t4359 = t1608 * params->d;
  t4360 = t125 * t4359;
  t4362 = 0.4e1 / 0.9e1 * t768 * t4360;
  t4364 = t334 * t336 * t4298;
  t4367 = t334 * t336 * t4302;
  t4371 = 0.2e1 / 0.27e2 * t789 * t792 * t1642;
  t4374 = 0.7e1 / 0.27e2 * t334 * t849 * t1642;
  t4378 = 0.2e1 / 0.27e2 * t130 * t137 * t762 * t559;
  t4381 = 0.4e1 / 0.9e1 * t195 * t928 * t1604;
  t4384 = 0.4e1 / 0.9e1 * t201 * t1608 * t932;
  t4385 = t16 * t1639;
  t4387 = t195 * t196 * t4385;
  t4391 = t940 * t907 * t1604 / 0.9e1;
  t4392 = t184 * t1639;
  t4394 = t201 * t4392 * t203;
  t4396 = t575 * t551;
  t4399 = 0.2e1 / 0.9e1 * t201 * t4396 * t949;
  t4402 = 0.8e1 / 0.9e1 * t190 * t968 * t552;
  t4404 = t190 * t191 * t1640;
  t4406 = t964 * t552;
  t4408 = 0.4e1 / 0.9e1 * t963 * t4406;
  t4409 = t130 * t137 * t345 * t1669 / 0.3e1 + t4358 + t4362 + 0.2e1 / 0.9e1 * t4364 + 0.2e1 / 0.9e1 * t4367 + t4371 - t4374 + t4378 - t4381 - t4384 + 0.2e1 / 0.3e1 * t4387 + t4391 + 0.2e1 / 0.3e1 * t4394 + t4399 - t4402 + 0.4e1 / 0.3e1 * t4404 + t4408;
  t4410 = t4351 + t4409;
  tv3rho2sigma2 = t161 * t4410 + 0.2e1 * t4235;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t4412 = params->a * t1715;
  t4413 = 0.8e1 / 0.3e1 * t3940;
  t4416 = t401 * t1468;
  t4422 = t1467 * t392;
  t4423 = t71 * t4422;
  t4425 = t495 * t994;
  t4430 = t401 * t1481;
  t4436 = t1480 * t420;
  t4437 = t71 * t4436;
  t4439 = t499 * t1050;
  t4442 = -t3944 + t4413 + t1008 * t496 / 0.32e2 + t4416 / 0.32e2 + t401 * t1475 / 0.32e2 + t242 * t1679 / 0.32e2 + t4423 / 0.32e2 + t71 * t4425 / 0.32e2 + t1008 * t500 / 0.576e3 + t4430 / 0.576e3 + t401 * t1488 / 0.576e3 + t242 * t1684 / 0.576e3 + t4437 / 0.576e3 + t71 * t4439 / 0.576e3;
  t4445 = t1471 * t392;
  t4450 = t1484 * t420;
  t4459 = t208 * t384;
  t4460 = 0.8e1 / 0.3e1 * t4459;
  t4461 = t29 * t1130;
  t4464 = t1105 * t78;
  t4467 = t449 * t251;
  t4481 = -t401 * t1472 / 0.12e2 - t71 * t4445 / 0.12e2 - t401 * t1485 / 0.216e3 - t71 * t4450 / 0.216e3 + t3883 / 0.32e2 + t3890 + t3892 / 0.32e2 + t3902 / 0.576e3 + t3909 + t3912 / 0.576e3 - t3924 / 0.12e2 - t3934 / 0.216e3 + t4460 - t4461 - t70 * (-0.16e2 / 0.9e1 * t1115 + 0.2e1 / 0.3e1 * t1118 - t4464 * t58 / 0.4e1 + 0.2e1 / 0.3e1 * t4467 * t58 - t1688 * t232 / 0.4e1 - t1493 * t392 / 0.4e1 + 0.2e1 / 0.3e1 * t1496 * t392 - t504 * t994 / 0.4e1) / 0.8e1;
  t4482 = t4442 + t4481;
  t4483 = t24 * t4482;
  t4485 = t379 * t519;
  t4486 = t4485 * params->d;
  t4488 = t325 * t326 * t4486;
  t4490 = t318 * t1710;
  t4491 = t317 * t4490;
  t4492 = t315 * t4491;
  t4494 = t12 * t1710;
  t4495 = t4494 * params->d;
  t4497 = t325 * t326 * t4495;
  t4499 = t1137 * t519;
  t4500 = t317 * t4499;
  t4501 = t315 * t4500;
  t4505 = t21 * t4483 + t3951 + t4488 / 0.18e2 + t4492 / 0.18e2 + t4497 / 0.18e2 + t4501 / 0.18e2 + t3955 / 0.18e2 + t3960 / 0.18e2 + t3965 - t3967 - t3970;
  t4510 = t3973 + t3976 / 0.18e2 + t3980 / 0.18e2 + t3983 + t3986 + t3990 - t3993 + t3997 + t4000 + t4004 + t4007 / 0.9e1 + t4010 / 0.9e1;
  t4515 = t334 * t336 * t4490;
  t4526 = t334 * t336 * t4499;
  t4536 = t469 * t251;
  t4545 = t70 * t994;
  t4548 = t4031 + 0.7e1 / 0.18e2 * t1157 - 0.7e1 / 0.48e2 * t1160 + t587 * t146 / 0.24e2 - t4536 * t516 / 0.3e1 + t1704 * t1536 / 0.8e1 + t1530 * t1707 / 0.8e1 - t1533 * t1707 / 0.3e1 + t515 * t4545 / 0.8e1;
  t4555 = t130 * t137 * t340 * t1710;
  t4559 = t130 * t137 * t1187 * t519;
  t4561 = t4014 - t4017 / 0.18e2 - t4021 / 0.18e2 + t4515 / 0.9e1 + t130 * t137 * t1197 * t519 / 0.6e1 + t130 * t137 * t462 * t1539 / 0.6e1 + t4526 / 0.9e1 + t130 * t137 * t345 * t1710 / 0.6e1 + t130 * t137 * t138 * t4548 / 0.6e1 - t4555 / 0.18e2 - t4559 / 0.18e2;
  t4564 = t16 * t1696;
  t4566 = t195 * t196 * t4564;
  t4568 = t184 * t1696;
  t4570 = t201 * t4568 * t203;
  t4574 = t190 * t191 * t1697;
  t4576 = -t4058 - t4061 + t4064 / 0.3e1 + t4068 + t4071 / 0.3e1 + t4076 + t4566 / 0.3e1 + t4570 / 0.3e1 - t4079 + 0.2e1 / 0.3e1 * t4081 + t4085 + 0.2e1 / 0.3e1 * t4574;
  t4578 = t4505 + t4510 + t4561 + t4576;
  tv3rho2sigma3 = t161 * t4578 + t3858 + t4412;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t4580 = params->a * t1724;
  t4586 = t201 * t1562 * t384;
  t4591 = t316 * t137 * t379;
  t4592 = t1573 * t4591;
  t4597 = t325 * t137 * t1570 * t379 * params->d;
  t4599 = 0.16e2 / 0.3e1 * t4092 - t4100 + t4107 - t4112 - 0.2e1 * t201 * t525 * t1130 + 0.16e2 / 0.3e1 * t4586 + t4118 - t4123 - t4128 - t4133 - t4138 + 0.7e1 / 0.54e2 * t4141 + t4146 + t4154 + 0.7e1 / 0.54e2 * t4158 + t4164 + 0.7e1 / 0.54e2 * t4592 + 0.7e1 / 0.54e2 * t4597 + t4168;
  t4602 = t16 * t384;
  t4604 = t195 * t1552 * t4602;
  t4606 = t384 * params->d;
  t4608 = t201 * t1557 * t4606;
  t4615 = t529 * t18 * t1589 * t379;
  t4617 = t24 * t384;
  t4619 = t190 * t1547 * t4617;
  t4627 = t529 * t1583 * t1584 * t379;
  t4629 = t4172 - 0.2e1 / 0.3e1 * t4175 - t4179 - 0.2e1 / 0.3e1 * t4182 - t4188 - 0.2e1 / 0.3e1 * t4604 - 0.2e1 / 0.3e1 * t4608 - t4193 + t4198 + t4202 - 0.4e1 / 0.3e1 * t4205 - t4211 + 0.7e1 / 0.27e2 * t4214 + t4223 - 0.7e1 / 0.6e1 * t4226 - 0.7e1 / 0.6e1 * t4615 - 0.4e1 / 0.3e1 * t4619 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t1007 + 0.7e1 / 0.27e2 * t4627;
  t4630 = t4599 + t4629;
  tv3rho2sigma4 = t161 * t4630 + t4089 + t4580;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t4632 = params->a * t1780;
  t4635 = t401 * t1615;
  t4641 = t245 * t407;
  t4642 = t4641 * t65;
  t4643 = t71 * t4642;
  t4645 = t1728 * t237;
  t4650 = t1614 * t396;
  t4651 = t71 * t4650;
  t4653 = t536 * t1002;
  t4658 = t401 * t1624;
  t4662 = -t3944 + t4413 + t1008 * t537 / 0.32e2 + t4635 / 0.32e2 + t401 * t1618 / 0.32e2 - t242 * t1729 / 0.12e2 - t4643 / 0.12e2 - t71 * t4645 / 0.12e2 + t242 * t1732 / 0.32e2 + t4651 / 0.32e2 + t71 * t4653 / 0.32e2 + t1008 * t541 / 0.576e3 + t4658 / 0.576e3 + t401 * t1627 / 0.576e3;
  t4665 = t264 * t407;
  t4666 = t4665 * t101;
  t4667 = t71 * t4666;
  t4669 = t1737 * t276;
  t4674 = t1623 * t426;
  t4675 = t71 * t4674;
  t4677 = t540 * t1060;
  t4686 = t1083 * t85;
  t4691 = t287 * t407;
  t4703 = -t242 * t1738 / 0.216e3 - t4667 / 0.216e3 - t71 * t4669 / 0.216e3 + t242 * t1741 / 0.576e3 + t4675 / 0.576e3 + t71 * t4677 / 0.576e3 + t4239 / 0.32e2 + t4246 + t4248 / 0.32e2 + t4255 / 0.576e3 + t4262 + t4264 / 0.576e3 + t4460 - t4461 - t70 * (-0.16e2 / 0.9e1 * t1091 + 0.2e1 / 0.3e1 * t1096 - t4686 * t65 / 0.4e1 - t1746 * t237 / 0.4e1 + 0.2e1 / 0.3e1 * t4691 * t65 + 0.2e1 / 0.3e1 * t1749 * t237 - t1631 * t396 / 0.4e1 - t545 * t1002 / 0.4e1) / 0.8e1;
  t4704 = t4662 + t4703;
  t4705 = t24 * t4704;
  t4707 = t1137 * t559;
  t4708 = t317 * t4707;
  t4709 = t315 * t4708;
  t4711 = t379 * t559;
  t4712 = t4711 * params->d;
  t4714 = t325 * t326 * t4712;
  t4716 = t318 * t1775;
  t4717 = t317 * t4716;
  t4718 = t315 * t4717;
  t4720 = t12 * t1775;
  t4721 = t4720 * params->d;
  t4723 = t325 * t326 * t4721;
  t4728 = t21 * t4705 + t4285 + t4709 / 0.18e2 + t4714 / 0.18e2 + t4718 / 0.18e2 + t4723 / 0.18e2 + t4289 / 0.18e2 + t4294 + t4297 + t4300 / 0.18e2 + t4304 / 0.18e2;
  t4734 = t4307 + t4310 - t4312 - t4315 + t4319 / 0.18e2 + t4324 - t4341 / 0.18e2 - t4345 / 0.18e2 + t4358 + t4362 + t4364 / 0.9e1 + t4367 / 0.9e1;
  t4746 = t364 * t407;
  t4753 = t70 * t1002;
  t4756 = t4031 + 0.7e1 / 0.18e2 * t1170 - 0.7e1 / 0.48e2 * t1175 - t587 * t152 / 0.24e2 + t1766 * t1666 / 0.8e1 - t4746 * t556 / 0.3e1 - t1769 * t1666 / 0.3e1 + t1663 * t1772 / 0.8e1 + t555 * t4753 / 0.8e1;
  t4762 = t334 * t336 * t4716;
  t4773 = t334 * t336 * t4707;
  t4777 = t130 * t137 * t340 * t1775;
  t4781 = t130 * t137 * t1187 * t559;
  t4783 = t4371 - t4374 + t4378 + t130 * t137 * t345 * t1775 / 0.6e1 + t130 * t137 * t138 * t4756 / 0.6e1 + t4762 / 0.9e1 + t130 * t137 * t1197 * t559 / 0.6e1 + t130 * t137 * t462 * t1669 / 0.6e1 + t4773 / 0.9e1 - t4777 / 0.18e2 - t4781 / 0.18e2;
  t4786 = t16 * t1757;
  t4788 = t195 * t196 * t4786;
  t4790 = t184 * t1757;
  t4792 = t201 * t4790 * t203;
  t4796 = t190 * t191 * t1758;
  t4798 = -t4381 - t4384 + t4387 / 0.3e1 + t4391 + t4394 / 0.3e1 + t4399 + t4788 / 0.3e1 + t4792 / 0.3e1 - t4402 + 0.2e1 / 0.3e1 * t4404 + t4408 + 0.2e1 / 0.3e1 * t4796;
  t4800 = t4728 + t4734 + t4783 + t4798;
  tv3rho2sigma5 = t161 * t4800 + t4235 + t4632;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t4803 = 0.16e2 / 0.3e1 * t4459;
  t4804 = t29 * t1402;
  t4811 = t495 * t1283;
  t4820 = t499 * t1382;
  t4824 = t1431 * t78;
  t4834 = -t3944 + t4803 - t4804 + t1365 * t496 / 0.32e2 + t4416 / 0.16e2 + t401 * t1679 / 0.16e2 + t3890 + t4423 / 0.16e2 + t71 * t4811 / 0.32e2 + t1365 * t500 / 0.576e3 + t4430 / 0.288e3 + t401 * t1684 / 0.288e3 + t3909 + t4437 / 0.288e3 + t71 * t4820 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t1437 - t4824 * t58 / 0.4e1 - t1688 * t392 / 0.2e1 - t504 * t1283 / 0.4e1) / 0.8e1;
  t4835 = t24 * t4834;
  t4850 = t1305 * t78;
  t4855 = t70 * t1283;
  t4858 = t4031 - 0.7e1 / 0.48e2 * t1311 + t4850 * t516 / 0.8e1 + t1704 * t1707 / 0.4e1 + t515 * t4855 / 0.8e1;
  t4863 = t21 * t4835 + t3951 + t4488 / 0.9e1 + t4492 / 0.9e1 + t4497 / 0.9e1 + t4501 / 0.9e1 + t130 * t137 * t1265 * t519 / 0.6e1 + t130 * t137 * t462 * t1710 / 0.3e1 + t130 * t137 * t138 * t4858 / 0.6e1 + t3965 - t3967 - t3970 + t3973 + t3983 + t3986 + t3990 - t3993;
  t4871 = t3997 + t4000 + t4004 + t4014 + 0.2e1 / 0.9e1 * t4515 + 0.2e1 / 0.9e1 * t4526 - t4555 / 0.9e1 - t4559 / 0.9e1 - t4058 - t4061 + t4068 + t4076 + 0.2e1 / 0.3e1 * t4566 + 0.2e1 / 0.3e1 * t4570 - t4079 + t4085 + 0.4e1 / 0.3e1 * t4574;
  t4872 = t4863 + t4871;
  tv3rho2sigma6 = t161 * t4872 + 0.2e1 * t4412;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  t4881 = -t4100 + t4107 - t4112 + 0.32e2 / 0.3e1 * t4586 - 0.2e1 * t201 * t525 * t1402 + t4118 - t4123 - t4128 - t4133 - t4138 + t4146 + t4154 + t4164 + 0.7e1 / 0.27e2 * t4592 + 0.7e1 / 0.27e2 * t4597;
  t4891 = t4168 + t4172 - t4179 - t4188 - 0.4e1 / 0.3e1 * t4604 - 0.4e1 / 0.3e1 * t4608 - t4193 + t4198 + t4202 - t4211 + t4223 - 0.7e1 / 0.3e1 * t4615 - 0.8e1 / 0.3e1 * t4619 + 0.14e2 / 0.27e2 * t4627 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t1264;
  t4892 = t4881 + t4891;
  tv3rho2sigma7 = t161 * t4892 + 0.2e1 * t4580;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t4902 = t1314 * t85;
  t4905 = t476 * t407;
  t4910 = t149 * t1287;
  t4915 = t70 * t1300;
  t4918 = t4031 - 0.77e2 / 0.54e2 * t1323 + 0.7e1 / 0.9e1 * t1326 - 0.7e1 / 0.48e2 * t1329 + t4902 * t556 / 0.8e1 - 0.2e1 / 0.3e1 * t4905 * t556 + t1766 * t1772 / 0.4e1 + 0.11e2 / 0.9e1 * t4910 * t556 - 0.2e1 / 0.3e1 * t1769 * t1772 + t555 * t4915 / 0.8e1;
  t4940 = t1411 * t85;
  t4943 = t437 * t407;
  t4948 = t109 * t1287;
  t4960 = t73 * t1287;
  t4961 = t4960 * t65;
  t4964 = t4246 + t4262 + t4635 / 0.16e2 - t4643 / 0.6e1 + t4651 / 0.16e2 + t4658 / 0.288e3 - t4667 / 0.108e3 + t4675 / 0.288e3 - t4804 - t70 * (0.176e3 / 0.27e2 * t1419 - 0.32e2 / 0.9e1 * t1422 + 0.2e1 / 0.3e1 * t1425 - t4940 * t65 / 0.4e1 + 0.4e1 / 0.3e1 * t4943 * t65 - t1746 * t396 / 0.2e1 - 0.22e2 / 0.9e1 * t4948 * t65 + 0.4e1 / 0.3e1 * t1749 * t396 - t545 * t1300 / 0.4e1) / 0.8e1 - t401 * t1729 / 0.6e1 + 0.11e2 / 0.36e2 * t71 * t4961;
  t4967 = t92 * t1287;
  t4968 = t4967 * t101;
  t4975 = t1728 * t396;
  t4978 = t536 * t1300;
  t4985 = t1737 * t426;
  t4988 = t540 * t1393;
  t4991 = -t401 * t1738 / 0.108e3 + 0.11e2 / 0.648e3 * t71 * t4968 + t1365 * t537 / 0.32e2 + t401 * t1732 / 0.16e2 - t71 * t4975 / 0.6e1 + t71 * t4978 / 0.32e2 + t1365 * t541 / 0.576e3 + t401 * t1741 / 0.288e3 - t71 * t4985 / 0.108e3 + t71 * t4988 / 0.576e3 - t3944 + t4803;
  t4992 = t4964 + t4991;
  t4993 = t24 * t4992;
  t4995 = t4285 + t4709 / 0.9e1 + t4714 / 0.9e1 + t4718 / 0.9e1 + t4723 / 0.9e1 + t130 * t137 * t138 * t4918 / 0.6e1 + t130 * t137 * t1265 * t559 / 0.6e1 + t130 * t137 * t462 * t1775 / 0.3e1 + t4294 + t4297 + t4307 + t4310 - t4312 - t4315 + t21 * t4993 + t4324 + t4358;
  t5003 = t4362 + t4371 - t4374 + t4378 + 0.2e1 / 0.9e1 * t4762 + 0.2e1 / 0.9e1 * t4773 - t4777 / 0.9e1 - t4781 / 0.9e1 - t4381 - t4384 + t4391 + t4399 + 0.2e1 / 0.3e1 * t4788 + 0.2e1 / 0.3e1 * t4792 - t4402 + t4408 + 0.4e1 / 0.3e1 * t4796;
  t5004 = t4995 + t5003;
  tv3rho2sigma8 = t161 * t5004 + 0.2e1 * t4632;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  tv3rhosigma20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  tv3rhosigma26 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  tv3rhosigma211 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  tv3sigma30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  tv3sigma39 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_pol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t1, t2, t3, t4, t6, t7, t8, t9;
  double t10, t12, t13, t15, t16, t18, t20, t21;
  double t23, t24, t26, t27, t29, t30, t32, t33;
  double t35, t38, t40, t41, t42, t43, t44, t45;
  double t46, t47, t48, t49, t50, t51, t52, t53;
  double t54, t55, t56, t57, t58, t59, t60, t61;
  double t62, t63, t64, t65, t66, t70, t71, t73;
  double t74, t75, t76, t78, t79, t80, t81, t82;
  double t83, t85, t86, t87, t88, t89, t92, t94;
  double t97, t101, t103, t104, t109, t110, t111, t114;
  double t115, t116, t122, t123, t125, t126, t127, t128;
  double t130, t131, t132, t134, t136, t137, t138, t142;
  double t143, t144, t145, t146, t149, t150, t151, t152;
  double t155, tzk0;

  double t161, t162, t165, t166, t167, t169, t170, t171;
  double t174, t175, t176, t177, t178, t180, t181, t183;
  double t184, t185, t186, t188, t189, t190, t191, t194;
  double t195, t196, t197, t200, t201, t202, t203, t206;
  double t208, t209, t211, t213, t214, t216, t219, t220;
  double t221, t223, t228, t229, t230, t232, t233, t234;
  double t235, t237, t238, t242, t245, t246, t248, t251;
  double t252, t253, t255, t256, t257, t258, t264, t265;
  double t267, t272, t276, t278, t279, t287, t288, t291;
  double t296, t297, t300, t303, t309, t310, t312, t315;
  double t316, t317, t318, t319, t320, t322, t323, t325;
  double t326, t327, t328, t331, t332, t334, t335, t336;
  double t339, t340, t344, t345, t350, t353, t354, t357;
  double t358, t361, t364, t365, t368, t371, t376, tvrho0;
  double t379, t380, t384, t389, t390, t392, t393, t394;
  double t396, t397, t401, t404, t407, t408, t409, t411;
  double t412, t413, t420, t426, t428, t429, t437, t438;
  double t441, t444, t449, t450, t453, t459, t460, t462;
  double t469, t470, t473, t476, t477, t480, t481, t484;
  double t487, t492, tvrho1, t494, t495, t496, t499, t500;
  double t504, t510, t511, t513, t515, t516, t519, t524;
  double tvsigma0, t525, t529, t530, t535, tvsigma1, t536, t537;
  double t540, t541, t545, t551, t552, t555, t556, t559;
  double t564, tvsigma2;

  double t565, t568, t569, t571, t572, t575, t576, t577;
  double t579, t580, t582, t583, t585, t586, t587, t588;
  double t589, t591, t592, t599, t600, t602, t603, t607;
  double t608, t609, t611, t615, t616, t620, t623, t627;
  double t628, t629, t631, t633, t635, t636, t638, t639;
  double t640, t642, t644, t645, t646, t648, t650, t651;
  double t652, t653, t658, t665, t666, t668, t669, t670;
  double t681, t688, t690, t691, t694, t698, t703, t704;
  double t705, t706, t715, t716, t721, t727, t728, t735;
  double t738, t741, t744, t747, t748, t750, t754, t756;
  double t757, t759, t761, t762, t766, t768, t769, t771;
  double t772, t773, t775, t776, t777, t779, t782, t784;
  double t786, t787, t789, t790, t791, t792, t795, t796;
  double t799, t803, t805, t814, t817, t818, t825, t826;
  double t829, t832, t835, t836, t841, t844, t849, t852;
  double t853, t854, t856, t857, t859, t860, t863, t865;
  double t866, t869, t870, t872, t873, t874, t875, t877;
  double t878, t879, t881, t883, t884, t886, t888, t890;
  double t891, t892, t895, t897, t899, t902, t903, t906;
  double t907, t909, t911, t912, t914, t916, t917, t918;
  double t919, t922, t923, t926, t928, t931, t932, t935;
  double t936, t938, t940, t943, t944, t946, t948, t949;
  double t952, t954, t955, t956, t957, t959, t961, t963;
  double t964, t965, t967, t968, t971, t972, t974, t976;
  double tv2rho20, t978, t979, t987, t990, t994, t995, t998;
  double t1002, t1003, t1007, t1008, t1011, t1017, t1018, t1020;
  double t1022, t1023, t1025, t1026, t1027, t1032, t1036, t1039;
  double t1040, t1046, t1050, t1056, t1060, t1062, t1063, t1079;
  double t1083, t1084, t1091, t1096, t1101, t1105, t1106, t1115;
  double t1118, t1121, t1125, t1128, t1130, t1132, t1133, t1134;
  double t1137, t1138, t1140, t1148, t1157, t1160, t1163, t1170;
  double t1175, t1178, t1183, t1185, t1187, t1190, t1194, t1196;
  double t1197, t1210, t1211, t1213, t1215, t1216, t1218, t1219;
  double t1221, t1223, t1224, t1226, t1232, t1234, t1236, t1238;
  double t1240, t1242, t1245, t1250, t1252, t1254, t1256, tv2rho21;
  double t1264, t1265, t1275, t1276, t1278, t1279, t1280, t1283;
  double t1284, t1285, t1287, t1288, t1289, t1291, t1293, t1294;
  double t1296, t1297, t1300, t1301, t1302, t1305, t1306, t1311;
  double t1314, t1315, t1322, t1323, t1326, t1329, t1332, t1341;
  double t1348, t1361, t1365, t1370, t1382, t1393, t1395, t1396;
  double t1402, t1411, t1412, t1419, t1422, t1425, t1431, t1432;
  double t1437, t1440, t1443, t1444, t1446, t1448, tv2rho22, t1450;
  double t1453, t1454, t1457, t1458, t1461, t1463, t1464, t1467;
  double t1468, t1470, t1471, t1472, t1475, t1480, t1481, t1483;
  double t1484, t1485, t1488, t1493, t1496, t1504, t1505, t1507;
  double t1508, t1510, t1511, t1512, t1515, t1518, t1522, t1527;
  double t1530, t1533, t1536, t1539, t1544, tv2rhosigma0, t1546, t1547;
  double t1548, t1551, t1552, t1553, t1556, t1557, t1558, t1561;
  double t1562, t1565, t1570, t1571, t1572, t1573, t1575, t1577;
  double t1578, t1582, t1583, t1584, t1588, t1589, t1593, t1598;
  double tv2rhosigma1, t1600, t1603, t1604, t1607, t1608, t1611, t1614;
  double t1615, t1617, t1618, t1623, t1624, t1626, t1627, t1631;
  double t1639, t1640, t1642, t1643, t1645, t1646, t1647, t1650;
  double t1653, t1657, t1663, t1666, t1669, t1674, tv2rhosigma2, t1676;
  double t1679, t1684, t1688, t1696, t1697, t1704, t1707, t1710;
  double t1715, tv2rhosigma3, t1724, tv2rhosigma4, t1728, t1729, t1732, t1737;
  double t1738, t1741, t1746, t1749, t1757, t1758, t1766, t1769;
  double t1772, t1775, t1780, tv2rhosigma5, tv2sigma20, tv2sigma21, tv2sigma22, tv2sigma23;
  double tv2sigma24, tv2sigma25;

  double t1782, t1784, t1785, t1786, t1787, t1788, t1790, t1791;
  double t1792, t1795, t1796, t1798, t1799, t1800, t1802, t1803;
  double t1804, t1806, t1808, t1810, t1813, t1815, t1817, t1820;
  double t1822, t1824, t1825, t1827, t1828, t1831, t1832, t1835;
  double t1839, t1843, t1845, t1850, t1864, t1865, t1866, t1869;
  double t1870, t1879, t1882, t1884, t1885, t1888, t1891, t1895;
  double t1896, t1899, t1900, t1907, t1908, t1911, t1914, t1918;
  double t1919, t1922, t1923, t1925, t1927, t1929, t1930, t1931;
  double t1935, t1936, t1937, t1938, t1944, t1947, t1949, t1952;
  double t1953, t1956, t1960, t1962, t1965, t1966, t1970, t1971;
  double t1972, t1974, t1975, t1976, t1978, t1979, t1980, t1982;
  double t1983, t1986, t1988, t1990, t1992, t1994, t1996, t1999;
  double t2000, t2003, t2006, t2007, t2010, t2011, t2013, t2016;
  double t2018, t2020, t2021, t2022, t2025, t2026, t2028, t2029;
  double t2031, t2032, t2034, t2036, t2037, t2038, t2040, t2041;
  double t2044, t2046, t2048, t2049, t2050, t2051, t2053, t2055;
  double t2056, t2057, t2059, t2060, t2061, t2063, t2064, t2065;
  double t2066, t2068, t2071, t2073, t2075, t2076, t2077, t2079;
  double t2081, t2083, t2085, t2087, t2088, t2090, t2092, t2095;
  double t2101, t2108, t2113, t2114, t2121, t2124, t2129, t2130;
  double t2139, t2142, t2145, t2148, t2151, t2152, t2154, t2155;
  double t2170, t2179, t2181, t2182, t2185, t2189, t2191, t2199;
  double t2200, t2202, t2203, t2204, t2205, t2207, t2208, t2210;
  double t2213, t2216, t2220, t2222, t2230, t2231, t2233, t2243;
  double t2249, t2250, t2251, t2253, t2255, t2257, t2258, t2260;
  double t2261, t2265, t2267, t2270, t2272, t2274, t2277, t2279;
  double t2281, t2282, t2285, t2286, t2288, t2290, t2291, t2294;
  double t2297, t2299, t2300, t2301, t2303, t2307, t2311, t2313;
  double t2315, t2316, t2318, t2319, t2322, t2324, t2326, t2328;
  double t2330, t2331, t2333, t2336, t2338, t2340, t2341, t2342;
  double t2344, t2345, t2346, t2349, t2351, t2352, t2355, t2357;
  double t2358, t2359, t2360, t2361, t2362, t2364, t2365, t2368;
  double t2370, t2373, t2375, t2378, t2380, t2381, t2383, t2384;
  double t2386, t2388, t2389, t2391, t2392, t2394, t2396, t2397;
  double t2399, t2400, t2402, t2404, t2406, t2408, t2409, t2411;
  double t2412, t2413, t2414, t2416, t2417, t2418, t2420, t2422;
  double t2424, t2426, t2428, t2429, t2430, t2433, t2435, t2437;
  double t2440, t2441, t2444, t2446, t2448, t2449, t2452, t2455;
  double t2457, t2459, t2461, t2462, t2465, t2467, t2469, t2470;
  double t2472, t2474, t2475, t2478, tv3rho30, t2481, t2483, t2484;
  double t2489, t2490, t2491, t2492, t2496, t2497, t2501, t2503;
  double t2520, t2523, t2524, t2529, t2534, t2535, t2538, t2539;
  double t2544, t2549, t2550, t2554, t2555, t2559, t2562, t2565;
  double t2571, t2574, t2575, t2577, t2579, t2580, t2582, t2584;
  double t2585, t2587, t2588, t2589, t2592, t2597, t2600, t2603;
  double t2609, t2612, t2613, t2615, t2617, t2633, t2648, t2650;
  double t2651, t2654, t2666, t2671, t2672, t2679, t2680, t2689;
  double t2692, t2699, t2704, t2705, t2712, t2713, t2726, t2729;
  double t2732, t2746, t2748, t2749, t2751, t2753, t2766, t2775;
  double t2787, t2788, t2789, t2791, t2792, t2793, t2795, t2804;
  double t2805, t2808, t2813, t2816, t2818, t2828, t2831, t2832;
  double t2838, t2841, t2842, t2849, t2852, t2863, t2866, t2871;
  double t2876, t2883, t2890, t2895, t2900, t2901, t2906, t2910;
  double t2913, t2915, t2917, t2921, t2925, t2927, t2932, t2936;
  double t2938, t2940, t2943, t2947, t2955, t2968, t2970, t2972;
  double t2973, t2974, t2977, t2978, t2980, t2981, t2982, t2985;
  double t2986, t2987, t2990, t2992, t2994, t2995, t2996, t2999;
  double t3000, t3002, t3003, t3004, t3007, t3008, t3009, t3012;
  double t3014, t3017, t3019, t3021, t3023, t3025, t3028, t3030;
  double t3032, t3033, t3035, t3038, t3041, t3044, t3046, t3049;
  double t3050, t3053, t3054, t3057, t3059, t3062, t3064, t3066;
  double t3069, t3070, t3072, t3073, t3079, t3083, t3084, t3085;
  double t3087, t3091, tv3rho31, t3093, t3095, t3096, t3107, t3112;
  double t3114, t3117, t3121, t3125, t3126, t3141, t3146, t3151;
  double t3156, t3159, t3160, t3163, t3164, t3167, t3170, t3175;
  double t3176, t3179, t3188, t3193, t3196, t3199, t3200, t3207;
  double t3210, t3212, t3214, t3216, t3218, t3220, t3225, t3230;
  double t3235, t3239, t3245, t3258, t3273, t3275, t3276, t3279;
  double t3282, t3288, t3294, t3295, t3300, t3301, t3306, t3307;
  double t3313, t3319, t3320, t3337, t3341, t3343, t3344, t3348;
  double t3358, t3368, t3377, t3378, t3380, t3390, t3394, t3396;
  double t3405, t3406, t3421, t3424, t3427, t3428, t3429, t3444;
  double t3449, t3454, t3457, t3458, t3463, t3465, t3467, t3470;
  double t3474, t3478, t3488, t3495, t3507, t3508, t3510, t3511;
  double t3513, t3515, t3516, t3518, t3519, t3521, t3523, t3524;
  double t3526, t3527, t3529, t3533, t3538, t3540, t3542, t3544;
  double t3546, t3548, t3558, t3560, t3564, tv3rho32, t3568, t3569;
  double t3580, t3581, t3585, t3586, t3587, t3590, t3591, t3592;
  double t3596, t3597, t3600, t3601, t3605, t3612, t3615, t3616;
  double t3617, t3619, t3621, t3623, t3624, t3625, t3641, t3656;
  double t3658, t3659, t3666, t3679, t3680, t3689, t3692, t3695;
  double t3703, t3704, t3711, t3714, t3721, t3723, t3736, t3737;
  double t3738, t3741, t3742, t3747, t3760, t3764, t3780, t3781;
  double t3784, t3791, t3794, t3795, t3804, t3807, t3809, t3814;
  double t3819, t3828, t3843, t3853, t3856, tv3rho33, t3858, t3863;
  double t3866, t3871, t3883, t3887, t3888, t3890, t3891, t3892;
  double t3894, t3897, t3902, t3906, t3907, t3909, t3910, t3911;
  double t3912, t3914, t3917, t3922, t3923, t3924, t3926, t3927;
  double t3932, t3933, t3934, t3936, t3937, t3940, t3941, t3942;
  double t3944, t3945, t3946, t3947, t3949, t3951, t3952, t3953;
  double t3955, t3957, t3958, t3960, t3962, t3965, t3967, t3970;
  double t3973, t3974, t3975, t3976, t3978, t3979, t3980, t3983;
  double t3984, t3986, t3988, t3990, t3993, t3997, t3998, t4000;
  double t4001, t4002, t4004, t4005, t4007, t4010, t4014, t4017;
  double t4021, t4031, t4035, t4038, t4043, t4048, t4051, t4058;
  double t4061, t4062, t4064, t4068, t4069, t4071, t4073, t4076;
  double t4079, t4081, t4083, t4085, t4086, t4087, tv3rho2sigma0, t4089;
  double t4092, t4097, t4100, t4101, t4103, t4104, t4105, t4107;
  double t4109, t4110, t4112, t4113, t4114, t4115, t4118, t4119;
  double t4120, t4121, t4123, t4124, t4128, t4130, t4131, t4133;
  double t4135, t4136, t4138, t4140, t4141, t4143, t4144, t4146;
  double t4147, t4148, t4149, t4150, t4152, t4154, t4158, t4164;
  double t4165, t4168, t4169, t4172, t4173, t4175, t4179, t4180;
  double t4182, t4184, t4185, t4188, t4189, t4193, t4194, t4198;
  double t4199, t4202, t4203, t4205, t4207, t4208, t4209, t4211;
  double t4214, t4216, t4218, t4219, t4223, t4226, t4232, t4233;
  double tv3rho2sigma1, t4235, t4239, t4243, t4244, t4246, t4247, t4248;
  double t4250, t4255, t4259, t4260, t4262, t4263, t4264, t4266;
  double t4270, t4280, t4281, t4283, t4285, t4286, t4287, t4289;
  double t4291, t4294, t4297, t4298, t4299, t4300, t4302, t4303;
  double t4304, t4307, t4308, t4310, t4312, t4315, t4316, t4317;
  double t4319, t4322, t4324, t4326, t4331, t4334, t4341, t4345;
  double t4351, t4356, t4358, t4359, t4360, t4362, t4364, t4367;
  double t4371, t4374, t4378, t4381, t4384, t4385, t4387, t4391;
  double t4392, t4394, t4396, t4399, t4402, t4404, t4406, t4408;
  double t4409, t4410, tv3rho2sigma2, t4412, t4413, t4416, t4422, t4423;
  double t4425, t4430, t4436, t4437, t4439, t4442, t4445, t4450;
  double t4459, t4460, t4461, t4464, t4467, t4481, t4482, t4483;
  double t4485, t4486, t4488, t4490, t4491, t4492, t4494, t4495;
  double t4497, t4499, t4500, t4501, t4505, t4510, t4515, t4526;
  double t4536, t4545, t4548, t4555, t4559, t4561, t4564, t4566;
  double t4568, t4570, t4574, t4576, t4578, tv3rho2sigma3, t4580, t4586;
  double t4591, t4592, t4597, t4599, t4602, t4604, t4606, t4608;
  double t4615, t4617, t4619, t4627, t4629, t4630, tv3rho2sigma4, t4632;
  double t4635, t4641, t4642, t4643, t4645, t4650, t4651, t4653;
  double t4658, t4662, t4665, t4666, t4667, t4669, t4674, t4675;
  double t4677, t4686, t4691, t4703, t4704, t4705, t4707, t4708;
  double t4709, t4711, t4712, t4714, t4716, t4717, t4718, t4720;
  double t4721, t4723, t4728, t4734, t4746, t4753, t4756, t4762;
  double t4773, t4777, t4781, t4783, t4786, t4788, t4790, t4792;
  double t4796, t4798, t4800, tv3rho2sigma5, t4803, t4804, t4811, t4820;
  double t4824, t4834, t4835, t4850, t4855, t4858, t4863, t4871;
  double t4872, tv3rho2sigma6, t4881, t4891, t4892, tv3rho2sigma7, t4902, t4905;
  double t4910, t4915, t4918, t4940, t4943, t4948, t4960, t4961;
  double t4964, t4967, t4968, t4975, t4978, t4985, t4988, t4991;
  double t4992, t4993, t4995, t5003, t5004, tv3rho2sigma8, tv3rhosigma20, tv3rhosigma21;
  double tv3rhosigma22, tv3rhosigma23, tv3rhosigma24, tv3rhosigma25, tv3rhosigma26, tv3rhosigma27, tv3rhosigma28, tv3rhosigma29;
  double tv3rhosigma210, tv3rhosigma211, tv3sigma30, tv3sigma31, tv3sigma32, tv3sigma33, tv3sigma34, tv3sigma35;
  double tv3sigma36, tv3sigma37, tv3sigma38, tv3sigma39;

  double t5006, t5008, t5009, t5010, t5011, t5012, t5013, t5016;
  double t5018, t5020, t5024, t5027, t5028, t5032, t5034, t5036;
  double t5041, t5043, t5047, t5048, t5050, t5055, t5058, t5061;
  double t5064, t5072, t5075, t5078, t5082, t5086, t5089, t5093;
  double t5095, t5100, t5101, t5104, t5106, t5110, t5113, t5116;
  double t5121, t5123, t5128, t5132, t5135, t5139, t5141, t5144;
  double t5147, t5149, t5152, t5154, t5156, t5158, t5165, t5167;
  double t5170, t5172, t5174, t5179, t5183, t5187, t5191, t5193;
  double t5195, t5200, t5205, t5209, t5210, t5214, t5216, t5218;
  double t5223, t5225, t5228, t5233, t5236, t5237, t5240, t5243;
  double t5244, t5245, t5247, t5251, t5258, t5260, t5263, t5265;
  double t5267, t5270, t5273, t5276, t5278, t5279, t5281, t5283;
  double t5285, t5286, t5289, t5292, t5295, t5298, t5300, t5302;
  double t5307, t5309, t5311, t5313, t5318, t5320, t5323, t5325;
  double t5328, t5331, t5333, t5338, t5341, t5342, t5344, t5349;
  double t5351, t5353, t5356, t5359, t5361, t5362, t5363, t5366;
  double t5367, t5368, t5371, t5373, t5375, t5378, t5380, t5383;
  double t5386, t5387, t5389, t5393, t5396, t5400, t5405, t5406;
  double t5412, t5413, t5415, t5417, t5421, t5423, t5427, t5429;
  double t5433, t5436, t5439, t5442, t5450, t5454, t5455, t5458;
  double t5461, t5465, t5469, t5477, t5483, t5484, t5485, t5488;
  double t5491, t5492, t5494, t5496, t5501, t5502, t5506, t5508;
  double t5510, t5514, t5516, t5518, t5520, t5522, t5526, t5529;
  double t5531, t5533, t5535, t5538, t5539, t5540, t5542, t5544;
  double t5546, t5549, t5550, t5556, t5561, t5562, t5566, t5567;
  double t5570, t5571, t5577, t5582, t5586, t5587, t5605, t5612;
  double t5629, t5648, t5652, t5664, t5666, t5669, t5672, t5693;
  double t5706, t5712, t5716, t5718, t5722, t5724, t5726, t5727;
  double t5739, t5741, t5744, t5747, t5753, t5757, t5762, t5767;
  double t5769, t5773, t5775, t5793, t5798, t5800, t5802, t5805;
  double t5807, t5810, t5814, t5816, t5820, t5823, t5825, t5827;
  double t5831, t5835, t5839, t5842, t5845, t5847, t5848, t5851;
  double t5853, t5856, t5859, t5864, t5868, t5871, t5874, t5877;
  double t5880, t5883, t5886, t5889, t5893, t5894, t5900, t5902;
  double t5904, t5905, t5907, t5909, t5910, t5912, t5914, t5916;
  double t5918, t5919, t5922, t5926, t5929, t5934, t5936, t5939;
  double t5940, t5942, t5945, t5951, t5977, t5994, t6003, t6027;
  double t6031, t6034, t6037, t6039, t6043, t6045, t6046, t6050;
  double t6053, t6057, t6059, t6063, t6067, t6071, t6074, t6078;
  double t6081, t6085, t6089, t6090, t6095, t6099, t6102, t6104;
  double t6108, t6110, t6114, t6118, t6122, t6126, t6130, t6133;
  double t6135, t6138, t6140, t6144, t6146, t6149, t6151, t6155;
  double t6156, tv4rho40, t6162, t6164, t6165, t6166, t6168, t6170;
  double t6171, t6172, t6210, t6212, t6233, t6242, t6250, t6253;
  double t6261, t6263, t6278, t6280, t6305, t6313, t6316, t6324;
  double t6326, t6330, t6332, t6334, t6336, t6338, t6340, t6342;
  double t6346, t6347, t6373, t6376, t6380, t6381, t6382, t6383;
  double t6387, t6389, t6390, t6391, t6397, t6401, t6402, t6403;
  double t6408, t6411, t6412, t6414, t6420, t6424, t6428, t6431;
  double t6434, t6435, t6437, t6462, t6464, t6485, t6487, t6495;
  double t6499, t6500, t6501, t6505, t6507, t6508, t6509, t6515;
  double t6519, t6520, t6522, t6542, t6544, t6545, t6546, t6553;
  double t6558, t6559, t6560, t6561, t6566, t6568, t6570, t6573;
  double t6575, t6577, t6580, t6583, t6584, t6586, t6587, t6589;
  double t6592, t6593, t6595, t6596, t6597, t6599, t6602, t6603;
  double t6605, t6606, t6608, t6610, t6615, t6617, t6619, t6624;
  double t6627, t6630, t6632, t6634, t6639, t6641, t6643, t6648;
  double t6650, t6652, t6653, t6655, t6656, t6657, t6659, t6664;
  double t6667, t6669, t6670, t6672, t6673, t6675, t6676, t6678;
  double t6679, t6680, t6682, t6687, t6690, t6692, t6697, t6698;
  double t6700, t6701, t6703, t6704, t6706, t6709, t6710, t6712;
  double t6714, t6715, t6717, t6718, t6721, t6722, t6723, t6726;
  double t6728, t6729, t6731, t6732, t6734, t6735, t6736, t6737;
  double t6738, t6739, t6740, t6743, t6745, t6748, t6750, t6753;
  double t6755, t6757, t6760, t6762, t6765, t6767, t6769, t6770;
  double t6773, t6774, t6775, t6776, t6779, t6780, t6781, t6782;
  double t6783, t6787, t6789, t6791, t6793, t6797, t6802, t6806;
  double t6807, t6810, t6814, t6816, t6820, t6821, t6822, t6824;
  double t6830, t6833, t6836, t6839, t6840, t6842, t6845, t6846;
  double t6848, t6851, t6852, t6854, t6857, t6861, t6862, t6865;
  double t6866, t6869, t6872, t6873, t6875, t6878, t6882, t6886;
  double t6888, t6889, t6892, t6903, t6909, t6920, t6926, t6936;
  double t6947, t6962, t6972, t6983, t6988, t6995, t7002, t7005;
  double t7006, t7008, t7009, t7010, t7011, t7014, t7018, t7019;
  double t7020, t7024, t7026, t7028, t7069, t7102, t7106, t7111;
  double t7118, t7121, t7122, t7124, t7130, t7137, t7144, t7147;
  double t7148, t7154, t7157, t7158, t7160, t7173, t7174, t7175;
  double t7177, t7181, t7182, t7184, t7189, t7190, t7192, t7193;
  double t7196, t7199, t7200, t7202, t7206, t7210, t7213, t7214;
  double t7217, t7219, t7224, t7225, t7229, t7233, t7237, t7242;
  double t7245, t7249, t7250, t7255, t7265, t7279, t7280, t7294;
  double t7299, t7304, t7308, t7314, t7317, t7318, t7319, t7322;
  double t7323, t7324, t7327, t7329, tv4rho41, t7337, t7344, t7346;
  double t7348, t7350, t7356, t7361, t7364, t7366, t7368, t7393;
  double t7394, t7395, t7397, t7422, t7423, t7424, t7429, t7430;
  double t7433, t7435, t7438, t7440, t7446, t7450, t7452, t7458;
  double t7460, t7465, t7468, t7494, t7520, t7544, t7557, t7561;
  double t7563, t7569, t7573, t7623, t7632, t7642, t7678, t7688;
  double t7695, t7697, t7701, t7714, t7726, t7739, t7741, t7750;
  double t7760, t7764, t7769, t7771, t7772, t7774, t7779, t7782;
  double t7784, t7786, t7791, t7794, t7796, t7798, t7803, t7805;
  double t7807, t7812, t7815, t7817, t7820, t7822, t7824, t7827;
  double t7829, t7832, t7835, t7837, t7839, t7844, t7846, t7849;
  double t7851, t7853, t7857, t7861, t7863, t7865, t7867, t7870;
  double t7874, t7878, t7881, t7884, t7891, t7907, t7922, t7937;
  double t7952, t7969, t7982, t7997, t8008, t8016, t8026, t8034;
  double t8037, t8040, t8042, t8052, t8068, t8078, t8091, t8095;
  double t8142, t8181, t8189, t8191, t8195, t8202, t8205, t8216;
  double t8223, t8226, t8237, t8239, t8250, t8254, t8258, t8262;
  double t8267, t8271, t8275, t8278, t8282, t8286, t8289, t8294;
  double t8296, t8300, t8303, t8314, t8329, t8346, t8361, t8373;
  double t8376, t8385, t8388, t8391, t8395, t8398, t8402, t8404;
  double t8406, t8410, t8414, t8422, t8428, t8431, t8443, tv4rho42;
  double t8451, t8455, t8462, t8475, t8489, t8496, t8498, t8507;
  double t8517, t8521, t8522, t8524, t8526, t8528, t8537, t8545;
  double t8549, t8550, t8582, t8592, t8626, t8645, t8667, t8670;
  double t8682, t8688, t8695, t8714, t8737, t8743, t8749, t8751;
  double t8757, t8764, t8770, t8774, t8777, t8783, t8806, t8821;
  double t8827, t8830, t8842, t8846, t8883, t8886, t8925, t8931;
  double t8933, t8945, t8947, t8957, t8959, t8961, t8971, t8973;
  double t8977, t8981, t8986, t8990, t8994, t9002, t9014, t9022;
  double t9032, t9041, t9048, t9055, t9059, t9063, t9065, t9071;
  double t9083, t9090, t9101, t9110, t9116, t9129, t9140, t9148;
  double t9156, t9166, t9171, t9178, t9180, t9186, t9189, t9194;
  double t9197, t9202, t9205, t9210, t9217, t9223, t9230, t9237;
  double tv4rho43, t9247, t9260, t9272, t9277, t9282, t9283, t9287;
  double t9288, t9291, t9292, t9293, t9295, t9297, t9299, t9301;
  double t9306, t9311, t9315, t9316, t9317, t9345, t9349, t9372;
  double t9385, t9406, t9421, t9438, t9451, t9463, t9467, t9474;
  double t9475, t9487, t9520, t9530, t9546, t9560, t9582, t9586;
  double t9606, t9627, t9662, t9677, t9684, t9692, t9701, t9707;
  double tv4rho44, t9713, t9715, t9717, t9720, t9724, t9727, t9731;
  double t9734, t9737, t9740, t9743, t9746, t9750, t9751, t9752;
  double t9754, t9758, t9762, t9765, t9767, t9769, t9772, t9776;
  double t9789, t9809, t9816, t9818, t9830, t9834, t9835, t9837;
  double t9840, t9842, t9843, t9844, t9873, t9876, t9877, t9879;
  double t9884, t9887, t9896, t9898, t9907, t9915, t9921, t9928;
  double t9930, t9934, t9936, t9943, t9945, t9948, t9958, t9960;
  double t9963, t9965, t9972, t9974, t9977, t9983, t9990, t9992;
  double t9998, t10001, t10003, t10006, t10007, t10009, t10013, t10016;
  double t10018, t10020, t10023, t10025, t10029, t10031, t10033, t10037;
  double t10038, t10041, t10043, t10048, t10053, t10057, t10062, t10066;
  double t10069, t10072, t10074, t10077, t10078, t10080, t10083, t10085;
  double t10088, t10091, t10093, t10096, t10099, t10103, t10107, t10110;
  double t10111, t10115, t10118, t10120, t10124, t10127, t10129, t10133;
  double t10136, t10139, t10144, t10146, t10148, t10151, t10153, t10156;
  double t10159, t10163, t10165, t10168, t10170, t10173, t10175, t10178;
  double t10180, tv4rho3sigma0, t10185, t10191, t10193, t10195, t10197, t10198;
  double t10200, t10203, t10205, t10208, t10210, t10214, t10215, t10216;
  double t10219, t10222, t10227, t10228, t10231, t10235, t10241, t10243;
  double t10245, t10247, t10252, t10255, t10257, t10261, t10263, t10266;
  double t10267, t10271, t10273, t10276, t10279, t10283, t10285, t10289;
  double t10293, t10302, t10306, t10310, t10314, t10317, t10321, t10326;
  double t10329, t10335, t10336, t10341, t10346, t10351, t10353, t10359;
  double t10362, t10369, t10374, t10377, t10382, t10384, t10387, t10392;
  double t10397, t10400, t10405, t10409, t10410, t10415, t10419, t10422;
  double t10426, t10429, t10433, t10436, t10439, t10443, t10445, t10450;
  double t10453, t10457, t10459, t10464, t10469, t10471, t10476, tv4rho3sigma1;
  double t10480, t10487, t10491, t10493, t10500, t10501, t10503, t10506;
  double t10513, t10517, t10519, t10526, t10528, t10531, t10546, t10566;
  double t10568, t10573, t10576, t10579, t10582, t10586, t10590, t10593;
  double t10597, t10598, t10600, t10603, t10606, t10609, t10612, t10616;
  double t10618, t10628, t10630, t10632, t10634, t10636, t10639, t10641;
  double t10644, t10648, t10651, t10654, t10661, t10664, t10668, t10670;
  double t10671, t10673, t10676, t10677, t10680, t10683, t10686, t10689;
  double t10690, t10693, t10696, t10701, t10703, t10707, t10712, t10715;
  double t10720, t10723, t10727, t10730, t10733, t10735, t10738, t10741;
  double t10742, t10745, t10749, t10752, t10754, t10757, t10759, t10761;
  double t10764, t10765, t10770, t10773, t10774, t10778, t10780, t10784;
  double t10787, t10790, t10793, t10796, t10798, t10802, t10805, t10810;
  double t10811, t10813, t10816, t10819, t10822, t10826, t10828, t10830;
  double t10832, t10836, t10839, t10841, t10843, tv4rho3sigma2, t10849, t10850;
  double t10851, t10853, t10859, t10863, t10867, t10874, t10877, t10880;
  double t10881, t10887, t10891, t10895, t10902, t10905, t10907, t10938;
  double t10942, t10943, t10944, t10947, t10964, t10972, t10989, t10996;
  double t11003, t11004, t11010, t11052, t11058, t11068, t11071, t11076;
  double t11079, t11080, t11083, t11084, t11087, t11089, t11094, t11097;
  double t11101, t11103, t11107, t11111, t11115, t11117, t11120, t11124;
  double t11132, t11143, t11146, t11150, t11155, t11156, t11158, t11161;
  double t11164, t11166, t11169, t11171, t11175, t11180, t11183, t11188;
  double t11191, t11195, t11200, t11204, t11207, t11211, t11213, t11221;
  double t11234, t11238, t11243, t11247, t11249, t11252, t11255, t11262;
  double t11265, t11268, t11273, t11278, t11282, t11284, t11286, tv4rho3sigma3;
  double t11292, t11294, t11299, t11301, t11306, t11311, t11312, t11316;
  double t11322, t11326, t11328, t11330, t11335, t11339, t11340, t11342;
  double t11345, t11348, t11352, t11355, t11362, t11368, t11374, t11381;
  double t11387, t11394, t11396, t11399, t11401, t11409, t11413, t11416;
  double t11419, t11428, t11432, t11435, t11440, t11441, tv4rho3sigma4, t11447;
  double t11451, t11453, t11456, t11460, t11466, t11469, t11474, t11477;
  double t11479, t11481, t11484, t11510, t11515, t11518, t11520, t11536;
  double t11538, t11540, t11544, t11549, t11553, t11557, t11561, t11565;
  double t11567, t11571, t11574, t11577, t11582, t11594, t11600, t11603;
  double t11608, t11611, t11616, t11619, t11623, t11625, t11628, t11631;
  double t11634, t11636, t11639, t11641, t11644, t11647, t11651, t11652;
  double t11659, t11662, t11663, t11673, t11686, t11694, t11697, t11700;
  double t11724, t11734, t11738, t11741, t11747, t11752, t11756, t11757;
  double t11765, t11769, t11773, t11780, t11783, t11786, t11791, t11793;
  double t11798, t11802, t11809, t11813, t11817, t11824, t11827, t11835;
  double t11840, t11844, t11846, t11848, tv4rho3sigma5, t11853, t11854, t11856;
  double t11861, t11863, t11865, t11870, t11872, t11874, t11879, t11883;
  double t11887, t11893, t11903, t11915, t11918, t11922, t11924, t11925;
  double t11926, t11949, t11952, t11969, t11977, t11984, t11991, t11993;
  double t11998, t12005, t12012, t12016, t12026, t12037, t12047, t12083;
  double t12089, t12095, t12101, t12112, t12116, t12120, t12124, t12131;
  double t12133, tv4rho3sigma6, t12138, t12149, t12153, t12155, t12161, t12166;
  double t12175, t12182, t12187, t12193, t12200, t12202, t12206, t12215;
  double t12223, t12227, t12229, tv4rho3sigma7, t12234, t12245, t12247, t12250;
  double t12260, t12270, t12283, t12295, t12302, t12341, t12346, t12348;
  double t12358, t12360, t12370, t12372, t12376, t12380, t12382, t12385;
  double t12390, t12393, t12398, t12401, t12406, t12409, t12443, t12451;
  double t12458, t12463, t12467, t12475, t12482, t12490, t12497, t12503;
  double t12505, t12511, t12519, t12526, t12532, t12539, t12546, t12554;
  double t12556, tv4rho3sigma8, t12571, t12577, t12586, t12592, t12596, t12602;
  double t12604, t12622, t12632, t12633, t12649, t12684, t12692, tv4rho3sigma9;
  double t12715, t12717, t12723, t12737, tv4rho3sigma10, t12770, t12789, t12818;
  double t12832, t12845, t12858, t12863, t12873, t12878, t12881, t12911;
  double t12928, t12939, t12947, tv4rho3sigma11, tv4rho2sigma20, tv4rho2sigma21, tv4rho2sigma22, tv4rho2sigma23;
  double tv4rho2sigma24, tv4rho2sigma25, tv4rho2sigma26, tv4rho2sigma27, tv4rho2sigma28, tv4rho2sigma29, tv4rho2sigma210, tv4rho2sigma211;
  double tv4rho2sigma212, tv4rho2sigma213, tv4rho2sigma214, tv4rho2sigma215, tv4rho2sigma216, tv4rho2sigma217, tv4rhosigma30, tv4rhosigma31;
  double tv4rhosigma32, tv4rhosigma33, tv4rhosigma34, tv4rhosigma35, tv4rhosigma36, tv4rhosigma37, tv4rhosigma38, tv4rhosigma39;
  double tv4rhosigma310, tv4rhosigma311, tv4rhosigma312, tv4rhosigma313, tv4rhosigma314, tv4rhosigma315, tv4rhosigma316, tv4rhosigma317;
  double tv4rhosigma318, tv4rhosigma319, tv4sigma40, tv4sigma41, tv4sigma42, tv4sigma43, tv4sigma44, tv4sigma45;
  double tv4sigma46, tv4sigma47, tv4sigma48, tv4sigma49, tv4sigma410, tv4sigma411, tv4sigma412, tv4sigma413;
  double tv4sigma414;

  gga_c_lypr_params *params;

  assert(p->params != NULL);
  params = (gga_c_lypr_params * )(p->params);

  t1 = params->m1 * params->omega;
  t2 = rho[0] + rho[1];
  t3 = POW_1_3(t2);
  t4 = 0.1e1 / t3;
  t6 = erfc(t1 * t4);
  t7 = rho[0] - rho[1];
  t8 = t7 * t7;
  t9 = t2 * t2;
  t10 = 0.1e1 / t9;
  t12 = -t10 * t8 + 0.1e1;
  t13 = t6 * t12;
  t15 = t4 * params->d + 0.1e1;
  t16 = 0.1e1 / t15;
  t18 = params->m2 * params->omega;
  t20 = erfc(t18 * t4);
  t21 = t20 * params->b;
  t23 = exp(-params->c * t4);
  t24 = t23 * t16;
  t26 = sigma[0] + 0.2e1 * sigma[1] + sigma[2];
  t27 = t3 * t3;
  t29 = 0.1e1 / t27 / t9;
  t30 = t26 * t29;
  t32 = t16 * params->d + params->c;
  t33 = t32 * t4;
  t35 = 0.47e2 - 0.7e1 * t33;
  t38 = t12 * t35 / 0.72e2 - 0.2e1 / 0.3e1;
  t40 = M_CBRT3;
  t41 = t40 * t40;
  t42 = M_PI * M_PI;
  t43 = POW_1_3(t42);
  t44 = t43 * t43;
  t45 = t41 * t44;
  t46 = 0.1e1 / t2;
  t47 = t7 * t46;
  t48 = 0.1e1 + t47;
  t49 = t48 <= p->zeta_threshold;
  t50 = p->zeta_threshold * p->zeta_threshold;
  t51 = POW_1_3(p->zeta_threshold);
  t52 = t51 * t51;
  t53 = t52 * t50;
  t54 = t48 * t48;
  t55 = POW_1_3(t48);
  t56 = t55 * t55;
  t57 = t56 * t54;
  t58 = my_piecewise3(t49, t53, t57);
  t59 = 0.1e1 - t47;
  t60 = t59 <= p->zeta_threshold;
  t61 = t59 * t59;
  t62 = POW_1_3(t59);
  t63 = t62 * t62;
  t64 = t63 * t61;
  t65 = my_piecewise3(t60, t53, t64);
  t66 = t58 + t65;
  t70 = M_CBRT2;
  t71 = t70 * t12;
  t73 = 0.5e1 / 0.2e1 - t33 / 0.18e2;
  t74 = rho[0] * rho[0];
  t75 = POW_1_3(rho[0]);
  t76 = t75 * t75;
  t78 = 0.1e1 / t76 / t74;
  t79 = sigma[0] * t78;
  t80 = t79 * t58;
  t81 = rho[1] * rho[1];
  t82 = POW_1_3(rho[1]);
  t83 = t82 * t82;
  t85 = 0.1e1 / t83 / t81;
  t86 = sigma[2] * t85;
  t87 = t86 * t65;
  t88 = t80 + t87;
  t89 = t73 * t88;
  t92 = t33 - 0.11e2;
  t94 = t52 * t50 * p->zeta_threshold;
  t97 = my_piecewise3(t49, t94, t56 * t54 * t48);
  t101 = my_piecewise3(t60, t94, t63 * t61 * t59);
  t103 = t101 * t86 + t79 * t97;
  t104 = t92 * t103;
  t109 = my_piecewise3(t49, t50, t54);
  t110 = t109 * sigma[2];
  t111 = t85 * t65;
  t114 = my_piecewise3(t60, t50, t61);
  t115 = t114 * sigma[0];
  t116 = t78 * t58;
  t122 = -t30 * t38 - 0.3e1 / 0.2e2 * t45 * t12 * t66 + t71 * t89 / 0.32e2 + t71 * t104 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t80 + 0.2e1 / 0.3e1 * t87 - t110 * t111 / 0.4e1 - t115 * t116 / 0.4e1) / 0.8e1;
  t123 = t24 * t122;
  t125 = params->b * t23;
  t126 = sqrt(M_PI);
  t127 = 0.1e1 / t126;
  t128 = t16 * t127;
  t130 = t125 * t128 * params->m2;
  t131 = params->m2 * params->m2;
  t132 = params->omega * params->omega;
  t134 = 0.1e1 / t27;
  t136 = exp(-t131 * t132 * t134);
  t137 = params->omega * t136;
  t138 = t4 * t12;
  t142 = t47 / 0.6e1;
  t143 = 0.7e1 / 0.6e1 + t142;
  t144 = t143 * sigma[0];
  t145 = t70 * t78;
  t146 = t145 * t58;
  t149 = 0.7e1 / 0.6e1 - t142;
  t150 = t149 * sigma[2];
  t151 = t70 * t85;
  t152 = t151 * t65;
  t155 = 0.7e1 / 0.6e1 * t30 - 0.7e1 / 0.48e2 * t70 * t88 + t144 * t146 / 0.8e1 + t150 * t152 / 0.8e1;
  tzk0 = params->a * (-t13 * t16 + t21 * t123 + t130 * t137 * t138 * t155 / 0.6e1);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t161 = t2 * params->a;
  t162 = params->m1 * params->m1;
  t165 = exp(-t162 * t132 * t134);
  t166 = t127 * t165;
  t167 = t166 * params->m1;
  t169 = 0.1e1 / t3 / t2;
  t170 = params->omega * t169;
  t171 = t12 * t16;
  t174 = 0.2e1 / 0.3e1 * t167 * t170 * t171;
  t175 = t7 * t10;
  t176 = t9 * t2;
  t177 = 0.1e1 / t176;
  t178 = t8 * t177;
  t180 = -0.2e1 * t175 + 0.2e1 * t178;
  t181 = t6 * t180;
  t183 = t15 * t15;
  t184 = 0.1e1 / t183;
  t185 = t184 * params->d;
  t186 = t185 * t169;
  t188 = t13 * t186 / 0.3e1;
  t189 = t127 * t136;
  t190 = t189 * t18;
  t191 = t169 * params->b;
  t194 = 0.2e1 / 0.3e1 * t190 * t191 * t123;
  t195 = t21 * params->c;
  t196 = t169 * t23;
  t197 = t16 * t122;
  t200 = t195 * t196 * t197 / 0.3e1;
  t201 = t21 * t23;
  t202 = t184 * t122;
  t203 = params->d * t169;
  t206 = t201 * t202 * t203 / 0.3e1;
  t208 = 0.1e1 / t27 / t176;
  t209 = t26 * t208;
  t211 = 0.8e1 / 0.3e1 * t209 * t38;
  t213 = params->d * params->d;
  t214 = t213 * t184;
  t216 = 0.1e1 / t27 / t2;
  t219 = t169 * t32 - t214 * t216;
  t220 = 0.7e1 / 0.3e1 * t219;
  t221 = t12 * t220;
  t223 = t180 * t35 / 0.72e2 + t221 / 0.72e2;
  t228 = t56 * t48;
  t229 = t46 - t175;
  t230 = t228 * t229;
  t232 = my_piecewise3(t49, 0, 0.8e1 / 0.3e1 * t230);
  t233 = t63 * t59;
  t234 = -t229;
  t235 = t233 * t234;
  t237 = my_piecewise3(t60, 0, 0.8e1 / 0.3e1 * t235);
  t238 = t232 + t237;
  t242 = t70 * t180;
  t245 = t219 / 0.54e2;
  t246 = t245 * t88;
  t248 = t71 * t246 / 0.32e2;
  t251 = 0.1e1 / t76 / t74 / rho[0];
  t252 = sigma[0] * t251;
  t253 = t252 * t58;
  t255 = t79 * t232;
  t256 = t86 * t237;
  t257 = -0.8e1 / 0.3e1 * t253 + t255 + t256;
  t258 = t73 * t257;
  t264 = -t219 / 0.3e1;
  t265 = t264 * t103;
  t267 = t71 * t265 / 0.576e3;
  t272 = my_piecewise3(t49, 0, 0.11e2 / 0.3e1 * t57 * t229);
  t276 = my_piecewise3(t60, 0, 0.11e2 / 0.3e1 * t64 * t234);
  t278 = -0.8e1 / 0.3e1 * t252 * t97 + t79 * t272 + t86 * t276;
  t279 = t92 * t278;
  t287 = my_piecewise3(t49, 0, 0.2e1 * t48 * t229);
  t288 = t287 * sigma[2];
  t291 = t85 * t237;
  t296 = my_piecewise3(t60, 0, 0.2e1 * t59 * t234);
  t297 = t296 * sigma[0];
  t300 = t251 * t58;
  t303 = t78 * t232;
  t309 = t211 - t30 * t223 - 0.3e1 / 0.2e2 * t45 * t180 * t66 - 0.3e1 / 0.2e2 * t45 * t12 * t238 + t242 * t89 / 0.32e2 + t248 + t71 * t258 / 0.32e2 + t242 * t104 / 0.576e3 + t267 + t71 * t279 / 0.576e3 - t70 * (-0.16e2 / 0.9e1 * t253 + 0.2e1 / 0.3e1 * t255 + 0.2e1 / 0.3e1 * t256 - t288 * t111 / 0.4e1 - t110 * t291 / 0.4e1 - t297 * t116 / 0.4e1 + 0.2e1 / 0.3e1 * t115 * t300 - t115 * t303 / 0.4e1) / 0.8e1;
  t310 = t24 * t309;
  t312 = params->b * params->c;
  t315 = t312 * t216 * t23 * t16;
  t316 = t127 * params->m2;
  t317 = t316 * params->omega;
  t318 = t136 * t12;
  t319 = t318 * t155;
  t320 = t317 * t319;
  t322 = t315 * t320 / 0.18e2;
  t323 = t184 * t127;
  t325 = t125 * t323 * params->m2;
  t326 = t137 * t216;
  t327 = t12 * t155;
  t328 = t327 * params->d;
  t331 = t325 * t326 * t328 / 0.18e2;
  t332 = t131 * params->m2;
  t334 = t125 * t128 * t332;
  t335 = t132 * params->omega;
  t336 = t335 * t10;
  t339 = t334 * t336 * t319 / 0.9e1;
  t340 = t169 * t12;
  t344 = t130 * t137 * t340 * t155 / 0.18e2;
  t345 = t4 * t180;
  t350 = 0.28e2 / 0.9e1 * t209;
  t353 = t229 / 0.6e1;
  t354 = t353 * sigma[0];
  t357 = t70 * t251;
  t358 = t357 * t58;
  t361 = t145 * t232;
  t364 = -t353;
  t365 = t364 * sigma[2];
  t368 = t151 * t237;
  t371 = -t350 - 0.7e1 / 0.48e2 * t70 * t257 + t354 * t146 / 0.8e1 - t144 * t358 / 0.3e1 + t144 * t361 / 0.8e1 + t365 * t152 / 0.8e1 + t150 * t368 / 0.8e1;
  t376 = -t174 - t181 * t16 - t188 + t194 + t200 + t206 + t21 * t310 + t322 + t331 + t339 - t344 + t130 * t137 * t345 * t155 / 0.6e1 + t130 * t137 * t138 * t371 / 0.6e1;
  tvrho0 = t161 * t376 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t379 = 0.2e1 * t175 + 0.2e1 * t178;
  t380 = t6 * t379;
  t384 = t379 * t35 / 0.72e2 + t221 / 0.72e2;
  t389 = -t46 - t175;
  t390 = t228 * t389;
  t392 = my_piecewise3(t49, 0, 0.8e1 / 0.3e1 * t390);
  t393 = -t389;
  t394 = t233 * t393;
  t396 = my_piecewise3(t60, 0, 0.8e1 / 0.3e1 * t394);
  t397 = t392 + t396;
  t401 = t70 * t379;
  t404 = t79 * t392;
  t407 = 0.1e1 / t83 / t81 / rho[1];
  t408 = sigma[2] * t407;
  t409 = t408 * t65;
  t411 = t86 * t396;
  t412 = t404 - 0.8e1 / 0.3e1 * t409 + t411;
  t413 = t73 * t412;
  t420 = my_piecewise3(t49, 0, 0.11e2 / 0.3e1 * t57 * t389);
  t426 = my_piecewise3(t60, 0, 0.11e2 / 0.3e1 * t64 * t393);
  t428 = t79 * t420 - 0.8e1 / 0.3e1 * t408 * t101 + t86 * t426;
  t429 = t92 * t428;
  t437 = my_piecewise3(t49, 0, 0.2e1 * t48 * t389);
  t438 = t437 * sigma[2];
  t441 = t407 * t65;
  t444 = t85 * t396;
  t449 = my_piecewise3(t60, 0, 0.2e1 * t59 * t393);
  t450 = t449 * sigma[0];
  t453 = t78 * t392;
  t459 = t211 - t30 * t384 - 0.3e1 / 0.2e2 * t45 * t379 * t66 - 0.3e1 / 0.2e2 * t45 * t12 * t397 + t401 * t89 / 0.32e2 + t248 + t71 * t413 / 0.32e2 + t401 * t104 / 0.576e3 + t267 + t71 * t429 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t404 - 0.16e2 / 0.9e1 * t409 + 0.2e1 / 0.3e1 * t411 - t438 * t111 / 0.4e1 + 0.2e1 / 0.3e1 * t110 * t441 - t110 * t444 / 0.4e1 - t450 * t116 / 0.4e1 - t115 * t453 / 0.4e1) / 0.8e1;
  t460 = t24 * t459;
  t462 = t4 * t379;
  t469 = t389 / 0.6e1;
  t470 = t469 * sigma[0];
  t473 = t145 * t392;
  t476 = -t469;
  t477 = t476 * sigma[2];
  t480 = t70 * t407;
  t481 = t480 * t65;
  t484 = t151 * t396;
  t487 = -t350 - 0.7e1 / 0.48e2 * t70 * t412 + t470 * t146 / 0.8e1 + t144 * t473 / 0.8e1 + t477 * t152 / 0.8e1 - t150 * t481 / 0.3e1 + t150 * t484 / 0.8e1;
  t492 = -t174 - t380 * t16 - t188 + t194 + t200 + t206 + t21 * t460 + t322 + t331 + t339 - t344 + t130 * t137 * t462 * t155 / 0.6e1 + t130 * t137 * t138 * t487 / 0.6e1;
  tvrho1 = t161 * t492 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 1] += tvrho1;

  t494 = t29 * t38;
  t495 = t73 * t78;
  t496 = t495 * t58;
  t499 = t92 * t78;
  t500 = t499 * t97;
  t504 = t114 * t78;
  t510 = -t494 + t71 * t496 / 0.32e2 + t71 * t500 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t116 - t504 * t58 / 0.4e1) / 0.8e1;
  t511 = t24 * t510;
  t513 = 0.7e1 / 0.6e1 * t29;
  t515 = t143 * t78;
  t516 = t70 * t58;
  t519 = t513 - 0.7e1 / 0.48e2 * t146 + t515 * t516 / 0.8e1;
  t524 = t21 * t511 + t130 * t137 * t138 * t519 / 0.6e1;
  tvsigma0 = t161 * t524;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t525 = t16 * t29;
  t529 = t125 * t128;
  t530 = t136 * t177;
  t535 = -0.2e1 * t201 * t525 * t38 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t12;
  tvsigma1 = t161 * t535;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 1] += tvsigma1;

  t536 = t73 * t85;
  t537 = t536 * t65;
  t540 = t92 * t85;
  t541 = t540 * t101;
  t545 = t109 * t85;
  t551 = -t494 + t71 * t537 / 0.32e2 + t71 * t541 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t111 - t545 * t65 / 0.4e1) / 0.8e1;
  t552 = t24 * t551;
  t555 = t149 * t85;
  t556 = t70 * t65;
  t559 = t513 - 0.7e1 / 0.48e2 * t152 + t555 * t556 / 0.8e1;
  t564 = t21 * t552 + t130 * t137 * t138 * t559 / 0.6e1;
  tvsigma2 = t161 * t564;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 2] += tvsigma2;

  t565 = params->a * t376;
  t568 = 0.1e1 / t3 / t9;
  t569 = t185 * t568;
  t571 = 0.4e1 / 0.9e1 * t13 * t569;
  t572 = t181 * t186;
  t575 = 0.1e1 / t183 / t15;
  t576 = t575 * t213;
  t577 = t576 * t29;
  t579 = 0.2e1 / 0.9e1 * t13 * t577;
  t580 = t9 * t9;
  t582 = 0.1e1 / t27 / t580;
  t583 = t26 * t582;
  t585 = 0.88e2 / 0.9e1 * t583 * t38;
  t586 = 0.2e1 * t10;
  t587 = t7 * t177;
  t588 = 0.8e1 * t587;
  t589 = 0.1e1 / t580;
  t591 = 0.6e1 * t8 * t589;
  t592 = -t586 + t588 - t591;
  t599 = t229 * t229;
  t600 = t56 * t599;
  t602 = -t10 + t587;
  t603 = 0.2e1 * t602;
  t607 = my_piecewise3(t49, 0, 0.4e2 / 0.9e1 * t600 + 0.8e1 / 0.3e1 * t228 * t603);
  t608 = t234 * t234;
  t609 = t63 * t608;
  t611 = -t603;
  t615 = my_piecewise3(t60, 0, 0.4e2 / 0.9e1 * t609 + 0.8e1 / 0.3e1 * t233 * t611);
  t616 = t607 + t615;
  t620 = t70 * t592;
  t623 = t242 * t246;
  t627 = t213 * params->d;
  t628 = t627 * t575;
  t629 = t628 * t177;
  t631 = t214 * t29;
  t633 = t32 * t568;
  t635 = -t629 / 0.81e2 + t631 / 0.27e2 - 0.2e1 / 0.81e2 * t633;
  t636 = t635 * t88;
  t638 = t71 * t636 / 0.32e2;
  t639 = t245 * t257;
  t640 = t71 * t639;
  t642 = t74 * t74;
  t644 = 0.1e1 / t76 / t642;
  t645 = sigma[0] * t644;
  t646 = t645 * t58;
  t648 = t252 * t232;
  t650 = t79 * t607;
  t651 = t86 * t615;
  t652 = 0.88e2 / 0.9e1 * t646 - 0.16e2 / 0.3e1 * t648 + t650 + t651;
  t653 = t73 * t652;
  t658 = t242 * t265;
  t665 = 0.2e1 / 0.9e1 * t629 - 0.2e1 / 0.3e1 * t631 + 0.4e1 / 0.9e1 * t633;
  t666 = t665 * t103;
  t668 = t71 * t666 / 0.576e3;
  t669 = t264 * t278;
  t670 = t71 * t669;
  t681 = my_piecewise3(t49, 0, 0.88e2 / 0.9e1 * t228 * t599 + 0.11e2 / 0.3e1 * t57 * t603);
  t688 = my_piecewise3(t60, 0, 0.88e2 / 0.9e1 * t233 * t608 + 0.11e2 / 0.3e1 * t64 * t611);
  t690 = 0.88e2 / 0.9e1 * t645 * t97 - 0.16e2 / 0.3e1 * t252 * t272 + t79 * t681 + t86 * t688;
  t691 = t92 * t690;
  t694 = t209 * t223;
  t698 = t180 * t220;
  t703 = -0.14e2 / 0.9e1 * t629 + 0.14e2 / 0.3e1 * t631 - 0.28e2 / 0.9e1 * t633;
  t704 = t12 * t703;
  t705 = t704 / 0.72e2;
  t706 = t592 * t35 / 0.72e2 + t698 / 0.36e2 + t705;
  t715 = my_piecewise3(t49, 0, 0.2e1 * t48 * t603 + 0.2e1 * t599);
  t716 = t715 * sigma[2];
  t721 = t85 * t615;
  t727 = my_piecewise3(t60, 0, 0.2e1 * t59 * t611 + 0.2e1 * t608);
  t728 = t727 * sigma[0];
  t735 = t644 * t58;
  t738 = t251 * t232;
  t741 = t78 * t607;
  t744 = 0.176e3 / 0.27e2 * t646 - 0.32e2 / 0.9e1 * t648 + 0.2e1 / 0.3e1 * t650 + 0.2e1 / 0.3e1 * t651 - t716 * t111 / 0.4e1 - t288 * t291 / 0.2e1 - t110 * t721 / 0.4e1 - t728 * t116 / 0.4e1 + 0.4e1 / 0.3e1 * t297 * t300 - t297 * t303 / 0.2e1 - 0.22e2 / 0.9e1 * t115 * t735 + 0.4e1 / 0.3e1 * t115 * t738 - t115 * t741 / 0.4e1;
  t747 = -t585 - 0.3e1 / 0.2e2 * t45 * t592 * t66 - 0.3e1 / 0.1e2 * t45 * t180 * t238 - 0.3e1 / 0.2e2 * t45 * t12 * t616 + t620 * t89 / 0.32e2 + t623 / 0.16e2 + t242 * t258 / 0.16e2 + t638 + t640 / 0.16e2 + t71 * t653 / 0.32e2 + t620 * t104 / 0.576e3 + t658 / 0.288e3 + t242 * t279 / 0.288e3 + t668 + t670 / 0.288e3 + t71 * t691 / 0.576e3 + 0.16e2 / 0.3e1 * t694 - t30 * t706 - t70 * t744 / 0.8e1;
  t748 = t24 * t747;
  t750 = t166 * t1;
  t754 = 0.4e1 / 0.9e1 * t750 * t29 * t12 * t185;
  t756 = t21 * params->c * t29;
  t757 = t23 * t184;
  t759 = t757 * t122 * params->d;
  t761 = 0.2e1 / 0.9e1 * t756 * t759;
  t762 = t568 * t12;
  t766 = 0.2e1 / 0.27e2 * t130 * t137 * t762 * t155;
  t768 = t189 * t18 * t29;
  t769 = t312 * t123;
  t771 = 0.4e1 / 0.9e1 * t768 * t769;
  t772 = t202 * params->d;
  t773 = t125 * t772;
  t775 = 0.4e1 / 0.9e1 * t768 * t773;
  t776 = t136 * t180;
  t777 = t776 * t155;
  t779 = t334 * t336 * t777;
  t782 = t318 * t371;
  t784 = t334 * t336 * t782;
  t786 = t131 * t131;
  t787 = t786 * params->m2;
  t789 = t125 * t128 * t787;
  t790 = t132 * t132;
  t791 = t790 * params->omega;
  t792 = t791 * t208;
  t795 = 0.2e1 / 0.27e2 * t789 * t792 * t319;
  t796 = t169 * t180;
  t799 = t130 * t137 * t796 * t155;
  t803 = t130 * t137 * t340 * t371;
  t805 = t4 * t592;
  t814 = 0.308e3 / 0.27e2 * t583;
  t817 = t602 / 0.3e1;
  t818 = t817 * sigma[0];
  t825 = t70 * t644;
  t826 = t825 * t58;
  t829 = t357 * t232;
  t832 = t145 * t607;
  t835 = -t817;
  t836 = t835 * sigma[2];
  t841 = t151 * t615;
  t844 = t814 - 0.7e1 / 0.48e2 * t70 * t652 + t818 * t146 / 0.8e1 - 0.2e1 / 0.3e1 * t354 * t358 + t354 * t361 / 0.4e1 + 0.11e2 / 0.9e1 * t144 * t826 - 0.2e1 / 0.3e1 * t144 * t829 + t144 * t832 / 0.8e1 + t836 * t152 / 0.8e1 + t365 * t368 / 0.4e1 + t150 * t841 / 0.8e1;
  t849 = t335 * t177;
  t852 = 0.7e1 / 0.27e2 * t334 * t849 * t319;
  t853 = t317 * t777;
  t854 = t315 * t853;
  t856 = t317 * t782;
  t857 = t315 * t856;
  t859 = params->c * params->c;
  t860 = params->b * t859;
  t863 = t860 * t177 * t23 * t16;
  t865 = t863 * t320 / 0.54e2;
  t866 = 0.2e1 / 0.9e1 * t784 + t795 - t799 / 0.9e1 - t803 / 0.9e1 + t130 * t137 * t805 * t155 / 0.6e1 + t130 * t137 * t345 * t371 / 0.3e1 + t130 * t137 * t138 * t844 / 0.6e1 - t852 + t854 / 0.9e1 + t857 / 0.9e1 + t865;
  t869 = 0.1e1 / t3 / t176;
  t870 = t869 * t23;
  t872 = t312 * t870 * t16;
  t873 = t127 * t332;
  t874 = t873 * t335;
  t875 = t874 * t319;
  t877 = 0.2e1 / 0.27e2 * t872 * t875;
  t878 = t180 * t155;
  t879 = t878 * params->d;
  t881 = t325 * t326 * t879;
  t883 = t12 * t371;
  t884 = t883 * params->d;
  t886 = t325 * t326 * t884;
  t888 = t575 * t127;
  t890 = t125 * t888 * params->m2;
  t891 = t137 * t177;
  t892 = t327 * t213;
  t895 = t890 * t891 * t892 / 0.27e2;
  t897 = t125 * t323 * t332;
  t899 = t335 * t869 * t136;
  t902 = 0.2e1 / 0.27e2 * t897 * t899 * t328;
  t903 = t137 * t29;
  t906 = t325 * t903 * t328 / 0.9e1;
  t907 = t29 * t23;
  t909 = t312 * t907 * t16;
  t911 = t909 * t320 / 0.9e1;
  t912 = t180 * t16;
  t914 = t167 * t170 * t912;
  t916 = t162 * params->m1;
  t917 = t127 * t916;
  t918 = t917 * t335;
  t919 = t177 * t165;
  t922 = 0.4e1 / 0.9e1 * t918 * t919 * t171;
  t923 = params->omega * t568;
  t926 = 0.8e1 / 0.9e1 * t167 * t923 * t171;
  t928 = t568 * t23;
  t931 = 0.4e1 / 0.9e1 * t195 * t928 * t197;
  t932 = params->d * t568;
  t935 = 0.4e1 / 0.9e1 * t201 * t202 * t932;
  t936 = t16 * t309;
  t938 = t195 * t196 * t936;
  t940 = t21 * t859;
  t943 = t940 * t907 * t197 / 0.9e1;
  t944 = t184 * t309;
  t946 = t201 * t944 * t203;
  t948 = t575 * t122;
  t949 = t213 * t29;
  t952 = 0.2e1 / 0.9e1 * t201 * t948 * t949;
  t954 = t757 * t127;
  t955 = t312 * t177 * t954;
  t956 = t18 * t136;
  t957 = t956 * t328;
  t959 = t955 * t957 / 0.27e2;
  t961 = t190 * t191 * t310;
  t963 = t873 * t849;
  t964 = t136 * params->b;
  t965 = t964 * t123;
  t967 = 0.4e1 / 0.9e1 * t963 * t965;
  t968 = t568 * params->b;
  t971 = 0.8e1 / 0.9e1 * t190 * t968 * t123;
  t972 = t6 * t592;
  t974 = -t931 - t935 + 0.2e1 / 0.3e1 * t938 + t943 + 0.2e1 / 0.3e1 * t946 + t952 + t959 + 0.4e1 / 0.3e1 * t961 + t967 - t971 - t972 * t16;
  t976 = t571 - 0.2e1 / 0.3e1 * t572 - t579 + t21 * t748 - t754 + t761 + t766 + t771 + t775 + 0.2e1 / 0.9e1 * t779 + t866 + t877 + t881 / 0.9e1 + t886 / 0.9e1 + t895 + t902 - t906 - t911 - 0.4e1 / 0.3e1 * t914 - t922 + t926 + t974;
  tv2rho20 = t161 * t976 + 0.2e1 * t565;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t978 = params->a * t492;
  t979 = t380 * t186;
  t987 = t56 * t389;
  t990 = t228 * t7;
  t994 = my_piecewise3(t49, 0, 0.4e2 / 0.9e1 * t987 * t229 + 0.16e2 / 0.3e1 * t990 * t177);
  t995 = t63 * t393;
  t998 = t233 * t7;
  t1002 = my_piecewise3(t60, 0, 0.4e2 / 0.9e1 * t995 * t234 - 0.16e2 / 0.3e1 * t998 * t177);
  t1003 = t994 + t1002;
  t1007 = t586 - t591;
  t1008 = t70 * t1007;
  t1011 = t401 * t246;
  t1017 = t245 * t412;
  t1018 = t71 * t1017;
  t1020 = t252 * t392;
  t1022 = t79 * t994;
  t1023 = t408 * t237;
  t1025 = t86 * t1002;
  t1026 = -0.8e1 / 0.3e1 * t1020 + t1022 - 0.8e1 / 0.3e1 * t1023 + t1025;
  t1027 = t73 * t1026;
  t1032 = t401 * t265;
  t1036 = -t585 - 0.3e1 / 0.2e2 * t45 * t379 * t238 - 0.3e1 / 0.2e2 * t45 * t180 * t397 - 0.3e1 / 0.2e2 * t45 * t12 * t1003 + t1008 * t89 / 0.32e2 + t1011 / 0.32e2 + t401 * t258 / 0.32e2 + t242 * t413 / 0.32e2 + t1018 / 0.32e2 + t71 * t1027 / 0.32e2 + t1008 * t104 / 0.576e3 + t1032 / 0.576e3 + t401 * t279 / 0.576e3;
  t1039 = t264 * t428;
  t1040 = t71 * t1039;
  t1046 = t57 * t7;
  t1050 = my_piecewise3(t49, 0, 0.88e2 / 0.9e1 * t390 * t229 + 0.22e2 / 0.3e1 * t1046 * t177);
  t1056 = t64 * t7;
  t1060 = my_piecewise3(t60, 0, 0.88e2 / 0.9e1 * t394 * t234 - 0.22e2 / 0.3e1 * t1056 * t177);
  t1062 = -0.8e1 / 0.3e1 * t252 * t420 + t79 * t1050 - 0.8e1 / 0.3e1 * t408 * t276 + t86 * t1060;
  t1063 = t92 * t1062;
  t1079 = t48 * t7;
  t1083 = my_piecewise3(t49, 0, 0.4e1 * t1079 * t177 + 0.2e1 * t229 * t389);
  t1084 = t1083 * sigma[2];
  t1091 = t407 * t237;
  t1096 = t85 * t1002;
  t1101 = t59 * t7;
  t1105 = my_piecewise3(t60, 0, -0.4e1 * t1101 * t177 + 0.2e1 * t234 * t393);
  t1106 = t1105 * sigma[0];
  t1115 = t251 * t392;
  t1118 = t78 * t994;
  t1121 = -0.16e2 / 0.9e1 * t1020 + 0.2e1 / 0.3e1 * t1022 - 0.16e2 / 0.9e1 * t1023 + 0.2e1 / 0.3e1 * t1025 - t1084 * t111 / 0.4e1 - t438 * t291 / 0.4e1 + 0.2e1 / 0.3e1 * t288 * t441 + 0.2e1 / 0.3e1 * t110 * t1091 - t288 * t444 / 0.4e1 - t110 * t1096 / 0.4e1 - t1106 * t116 / 0.4e1 + 0.2e1 / 0.3e1 * t450 * t300 - t450 * t303 / 0.4e1 - t297 * t453 / 0.4e1 + 0.2e1 / 0.3e1 * t115 * t1115 - t115 * t1118 / 0.4e1;
  t1125 = t209 * t384;
  t1128 = t379 * t220;
  t1130 = t1007 * t35 / 0.72e2 + t1128 / 0.72e2 + t698 / 0.72e2 + t704 / 0.72e2;
  t1132 = t242 * t429 / 0.576e3 + t1040 / 0.576e3 + t71 * t1063 / 0.576e3 - 0.3e1 / 0.2e2 * t45 * t1007 * t66 + t623 / 0.32e2 + t638 + t640 / 0.32e2 + t658 / 0.576e3 + t668 + t670 / 0.576e3 - t70 * t1121 / 0.8e1 + 0.8e1 / 0.3e1 * t694 + 0.8e1 / 0.3e1 * t1125 - t30 * t1130;
  t1133 = t1036 + t1132;
  t1134 = t24 * t1133;
  t1137 = t136 * t379;
  t1138 = t1137 * t155;
  t1140 = t334 * t336 * t1138;
  t1148 = t587 * sigma[0];
  t1157 = t357 * t392;
  t1160 = t145 * t994;
  t1163 = t587 * sigma[2];
  t1170 = t480 * t237;
  t1175 = t151 * t1002;
  t1178 = t814 - 0.7e1 / 0.48e2 * t70 * t1026 + t1148 * t146 / 0.24e2 - t470 * t358 / 0.3e1 + t470 * t361 / 0.8e1 + t354 * t473 / 0.8e1 - t144 * t1157 / 0.3e1 + t144 * t1160 / 0.8e1 - t1163 * t152 / 0.24e2 + t477 * t368 / 0.8e1 - t365 * t481 / 0.3e1 - t150 * t1170 / 0.3e1 + t365 * t484 / 0.8e1 + t150 * t1175 / 0.8e1;
  t1183 = t318 * t487;
  t1185 = t334 * t336 * t1183;
  t1187 = t169 * t379;
  t1190 = t130 * t137 * t1187 * t155;
  t1194 = t130 * t137 * t340 * t487;
  t1196 = -t979 / 0.3e1 + t21 * t1134 + t571 - t572 / 0.3e1 - t579 - t754 + t761 + t1140 / 0.9e1 + t130 * t137 * t345 * t487 / 0.6e1 + t130 * t137 * t138 * t1178 / 0.6e1 + t1185 / 0.9e1 - t1190 / 0.18e2 - t1194 / 0.18e2 + t766;
  t1197 = t4 * t1007;
  t1210 = t12 * t487;
  t1211 = t1210 * params->d;
  t1213 = t325 * t326 * t1211;
  t1215 = t317 * t1138;
  t1216 = t315 * t1215;
  t1218 = t379 * t155;
  t1219 = t1218 * params->d;
  t1221 = t325 * t326 * t1219;
  t1223 = t317 * t1183;
  t1224 = t315 * t1223;
  t1226 = t130 * t137 * t1197 * t155 / 0.6e1 + t130 * t137 * t462 * t371 / 0.6e1 + t771 + t775 + t779 / 0.9e1 + t784 / 0.9e1 + t795 - t799 / 0.18e2 - t803 / 0.18e2 - t852 + t1213 / 0.18e2 + t1216 / 0.18e2 + t1221 / 0.18e2 + t1224 / 0.18e2;
  t1232 = t379 * t16;
  t1234 = t167 * t170 * t1232;
  t1236 = t16 * t459;
  t1238 = t195 * t196 * t1236;
  t1240 = t184 * t459;
  t1242 = t201 * t1240 * t203;
  t1245 = t854 / 0.18e2 + t857 / 0.18e2 + t865 + t877 + t881 / 0.18e2 + t886 / 0.18e2 + t895 + t902 - t906 - t911 - 0.2e1 / 0.3e1 * t1234 + t1238 / 0.3e1 + t1242 / 0.3e1 - 0.2e1 / 0.3e1 * t914;
  t1250 = t190 * t191 * t460;
  t1252 = t6 * t1007;
  t1254 = -t922 + t926 - t931 - t935 + t938 / 0.3e1 + t943 + t946 / 0.3e1 + t952 + t959 + 0.2e1 / 0.3e1 * t961 + t967 - t971 + 0.2e1 / 0.3e1 * t1250 - t1252 * t16;
  t1256 = t1196 + t1226 + t1245 + t1254;
  tv2rho21 = t1256 * t161 + t565 + t978;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 1] += tv2rho21;

  t1264 = -t586 - t588 - t591;
  t1265 = t4 * t1264;
  t1275 = t389 * t389;
  t1276 = t56 * t1275;
  t1278 = t10 + t587;
  t1279 = 0.2e1 * t1278;
  t1280 = t228 * t1279;
  t1283 = my_piecewise3(t49, 0, 0.4e2 / 0.9e1 * t1276 + 0.8e1 / 0.3e1 * t1280);
  t1284 = t79 * t1283;
  t1285 = t81 * t81;
  t1287 = 0.1e1 / t83 / t1285;
  t1288 = sigma[2] * t1287;
  t1289 = t1288 * t65;
  t1291 = t408 * t396;
  t1293 = t393 * t393;
  t1294 = t63 * t1293;
  t1296 = -t1279;
  t1297 = t233 * t1296;
  t1300 = my_piecewise3(t60, 0, 0.4e2 / 0.9e1 * t1294 + 0.8e1 / 0.3e1 * t1297);
  t1301 = t86 * t1300;
  t1302 = t1284 + 0.88e2 / 0.9e1 * t1289 - 0.16e2 / 0.3e1 * t1291 + t1301;
  t1305 = t1278 / 0.3e1;
  t1306 = t1305 * sigma[0];
  t1311 = t145 * t1283;
  t1314 = -t1305;
  t1315 = t1314 * sigma[2];
  t1322 = t70 * t1287;
  t1323 = t1322 * t65;
  t1326 = t480 * t396;
  t1329 = t151 * t1300;
  t1332 = t814 - 0.7e1 / 0.48e2 * t70 * t1302 + t1306 * t146 / 0.8e1 + t470 * t473 / 0.4e1 + t144 * t1311 / 0.8e1 + t1315 * t152 / 0.8e1 - 0.2e1 / 0.3e1 * t477 * t481 + t477 * t484 / 0.4e1 + 0.11e2 / 0.9e1 * t150 * t1323 - 0.2e1 / 0.3e1 * t150 * t1326 + t150 * t1329 / 0.8e1;
  t1341 = t130 * t137 * t462 * t487 / 0.3e1 + t130 * t137 * t138 * t1332 / 0.6e1 + t766 + t771 + t775 + t795 - t852 + t1213 / 0.9e1 + t1216 / 0.9e1 + t1221 / 0.9e1 + t1224 / 0.9e1;
  t1348 = t6 * t1264;
  t1361 = t1283 + t1300;
  t1365 = t70 * t1264;
  t1370 = t73 * t1302;
  t1382 = my_piecewise3(t49, 0, 0.88e2 / 0.9e1 * t228 * t1275 + 0.11e2 / 0.3e1 * t57 * t1279);
  t1393 = my_piecewise3(t60, 0, 0.88e2 / 0.9e1 * t233 * t1293 + 0.11e2 / 0.3e1 * t64 * t1296);
  t1395 = t79 * t1382 + 0.88e2 / 0.9e1 * t1288 * t101 - 0.16e2 / 0.3e1 * t408 * t426 + t86 * t1393;
  t1396 = t92 * t1395;
  t1402 = t1264 * t35 / 0.72e2 + t1128 / 0.36e2 + t705;
  t1411 = my_piecewise3(t49, 0, 0.2e1 * t1279 * t48 + 0.2e1 * t1275);
  t1412 = t1411 * sigma[2];
  t1419 = t1287 * t65;
  t1422 = t407 * t396;
  t1425 = t85 * t1300;
  t1431 = my_piecewise3(t60, 0, 0.2e1 * t1296 * t59 + 0.2e1 * t1293);
  t1432 = t1431 * sigma[0];
  t1437 = t78 * t1283;
  t1440 = 0.2e1 / 0.3e1 * t1284 + 0.176e3 / 0.27e2 * t1289 - 0.32e2 / 0.9e1 * t1291 + 0.2e1 / 0.3e1 * t1301 - t1412 * t111 / 0.4e1 + 0.4e1 / 0.3e1 * t438 * t441 - t438 * t444 / 0.2e1 - 0.22e2 / 0.9e1 * t110 * t1419 + 0.4e1 / 0.3e1 * t110 * t1422 - t110 * t1425 / 0.4e1 - t1432 * t116 / 0.4e1 - t450 * t453 / 0.2e1 - t115 * t1437 / 0.4e1;
  t1443 = -t585 + t638 + t668 + 0.16e2 / 0.3e1 * t1125 + t1011 / 0.16e2 + t1018 / 0.16e2 + t1032 / 0.288e3 + t1040 / 0.288e3 - 0.3e1 / 0.2e2 * t45 * t1264 * t66 - 0.3e1 / 0.1e2 * t45 * t379 * t397 - 0.3e1 / 0.2e2 * t45 * t12 * t1361 + t1365 * t89 / 0.32e2 + t401 * t413 / 0.16e2 + t71 * t1370 / 0.32e2 + t1365 * t104 / 0.576e3 + t401 * t429 / 0.288e3 + t71 * t1396 / 0.576e3 - t30 * t1402 - t70 * t1440 / 0.8e1;
  t1444 = t24 * t1443;
  t1446 = t926 - t931 - t935 + t943 + t952 + t959 + t967 - t971 + 0.4e1 / 0.3e1 * t1250 - t1348 * t16 + t21 * t1444;
  t1448 = -0.2e1 / 0.3e1 * t979 + t571 - t579 - t754 + t761 + 0.2e1 / 0.9e1 * t1140 + 0.2e1 / 0.9e1 * t1185 - t1190 / 0.9e1 - t1194 / 0.9e1 + t130 * t137 * t1265 * t155 / 0.6e1 + t1341 + t865 + t877 + t895 + t902 - t906 - t911 - 0.4e1 / 0.3e1 * t1234 + 0.2e1 / 0.3e1 * t1238 + 0.2e1 / 0.3e1 * t1242 - t922 + t1446;
  tv2rho22 = t1448 * t161 + 0.2e1 * t978;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 2] += tv2rho22;

  t1450 = params->a * t524;
  t1453 = 0.2e1 / 0.3e1 * t190 * t191 * t511;
  t1454 = t16 * t510;
  t1457 = t195 * t196 * t1454 / 0.3e1;
  t1458 = t184 * t510;
  t1461 = t201 * t1458 * t203 / 0.3e1;
  t1463 = 0.8e1 / 0.3e1 * t208 * t38;
  t1464 = t29 * t223;
  t1467 = t245 * t78;
  t1468 = t1467 * t58;
  t1470 = t71 * t1468 / 0.32e2;
  t1471 = t73 * t251;
  t1472 = t1471 * t58;
  t1475 = t495 * t232;
  t1480 = t264 * t78;
  t1481 = t1480 * t97;
  t1483 = t71 * t1481 / 0.576e3;
  t1484 = t92 * t251;
  t1485 = t1484 * t97;
  t1488 = t499 * t272;
  t1493 = t296 * t78;
  t1496 = t114 * t251;
  t1504 = t1463 - t1464 + t242 * t496 / 0.32e2 + t1470 - t71 * t1472 / 0.12e2 + t71 * t1475 / 0.32e2 + t242 * t500 / 0.576e3 + t1483 - t71 * t1485 / 0.216e3 + t71 * t1488 / 0.576e3 - t70 * (-0.16e2 / 0.9e1 * t300 + 0.2e1 / 0.3e1 * t303 - t1493 * t58 / 0.4e1 + 0.2e1 / 0.3e1 * t1496 * t58 - t504 * t232 / 0.4e1) / 0.8e1;
  t1505 = t24 * t1504;
  t1507 = t318 * t519;
  t1508 = t317 * t1507;
  t1510 = t315 * t1508 / 0.18e2;
  t1511 = t12 * t519;
  t1512 = t1511 * params->d;
  t1515 = t325 * t326 * t1512 / 0.18e2;
  t1518 = t334 * t336 * t1507 / 0.9e1;
  t1522 = t130 * t137 * t340 * t519 / 0.18e2;
  t1527 = 0.28e2 / 0.9e1 * t208;
  t1530 = t353 * t78;
  t1533 = t143 * t251;
  t1536 = t70 * t232;
  t1539 = -t1527 + 0.7e1 / 0.18e2 * t358 - 0.7e1 / 0.48e2 * t361 + t1530 * t516 / 0.8e1 - t1533 * t516 / 0.3e1 + t515 * t1536 / 0.8e1;
  t1544 = t1453 + t1457 + t1461 + t21 * t1505 + t1510 + t1515 + t1518 - t1522 + t130 * t137 * t345 * t519 / 0.6e1 + t130 * t137 * t138 * t1539 / 0.6e1;
  tv2rhosigma0 = t1544 * t161 + t1450;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  t1546 = params->a * t535;
  t1547 = t589 * params->b;
  t1548 = t24 * t38;
  t1551 = 0.4e1 / 0.3e1 * t190 * t1547 * t1548;
  t1552 = t589 * t23;
  t1553 = t16 * t38;
  t1556 = 0.2e1 / 0.3e1 * t195 * t1552 * t1553;
  t1557 = t184 * t589;
  t1558 = t38 * params->d;
  t1561 = 0.2e1 / 0.3e1 * t201 * t1557 * t1558;
  t1562 = t16 * t208;
  t1565 = 0.16e2 / 0.3e1 * t201 * t1562 * t38;
  t1570 = 0.1e1 / t3 / t580;
  t1571 = t1570 * t23;
  t1572 = t1571 * t16;
  t1573 = t312 * t1572;
  t1575 = t316 * t137 * t12;
  t1577 = 0.7e1 / 0.54e2 * t1573 * t1575;
  t1578 = t1570 * t12;
  t1582 = 0.7e1 / 0.54e2 * t325 * t137 * t1578 * params->d;
  t1583 = t332 * t335;
  t1584 = t582 * t136;
  t1588 = 0.7e1 / 0.27e2 * t529 * t1583 * t1584 * t12;
  t1589 = t136 * t589;
  t1593 = 0.7e1 / 0.6e1 * t529 * t18 * t1589 * t12;
  t1598 = -t1551 - t1556 - t1561 + t1565 - 0.2e1 * t201 * t525 * t223 + t1577 + t1582 + t1588 - t1593 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t180;
  tv2rhosigma1 = t1598 * t161 + t1546;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 1] += tv2rhosigma1;

  t1600 = params->a * t564;
  t1603 = 0.2e1 / 0.3e1 * t190 * t191 * t552;
  t1604 = t16 * t551;
  t1607 = t195 * t196 * t1604 / 0.3e1;
  t1608 = t184 * t551;
  t1611 = t201 * t1608 * t203 / 0.3e1;
  t1614 = t245 * t85;
  t1615 = t1614 * t65;
  t1617 = t71 * t1615 / 0.32e2;
  t1618 = t536 * t237;
  t1623 = t264 * t85;
  t1624 = t1623 * t101;
  t1626 = t71 * t1624 / 0.576e3;
  t1627 = t540 * t276;
  t1631 = t287 * t85;
  t1639 = t1463 - t1464 + t242 * t537 / 0.32e2 + t1617 + t71 * t1618 / 0.32e2 + t242 * t541 / 0.576e3 + t1626 + t71 * t1627 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t291 - t1631 * t65 / 0.4e1 - t545 * t237 / 0.4e1) / 0.8e1;
  t1640 = t24 * t1639;
  t1642 = t318 * t559;
  t1643 = t317 * t1642;
  t1645 = t315 * t1643 / 0.18e2;
  t1646 = t12 * t559;
  t1647 = t1646 * params->d;
  t1650 = t325 * t326 * t1647 / 0.18e2;
  t1653 = t334 * t336 * t1642 / 0.9e1;
  t1657 = t130 * t137 * t340 * t559 / 0.18e2;
  t1663 = t364 * t85;
  t1666 = t70 * t237;
  t1669 = -t1527 - 0.7e1 / 0.48e2 * t368 + t1663 * t556 / 0.8e1 + t555 * t1666 / 0.8e1;
  t1674 = t1603 + t1607 + t1611 + t21 * t1640 + t1645 + t1650 + t1653 - t1657 + t130 * t137 * t345 * t559 / 0.6e1 + t130 * t137 * t138 * t1669 / 0.6e1;
  tv2rhosigma2 = t161 * t1674 + t1600;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 2] += tv2rhosigma2;

  t1676 = t29 * t384;
  t1679 = t495 * t392;
  t1684 = t499 * t420;
  t1688 = t449 * t78;
  t1696 = t1463 - t1676 + t401 * t496 / 0.32e2 + t1470 + t71 * t1679 / 0.32e2 + t401 * t500 / 0.576e3 + t1483 + t71 * t1684 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t453 - t1688 * t58 / 0.4e1 - t504 * t392 / 0.4e1) / 0.8e1;
  t1697 = t24 * t1696;
  t1704 = t469 * t78;
  t1707 = t70 * t392;
  t1710 = -t1527 - 0.7e1 / 0.48e2 * t473 + t1704 * t516 / 0.8e1 + t515 * t1707 / 0.8e1;
  t1715 = t1453 + t1457 + t1461 + t21 * t1697 + t1510 + t1515 + t1518 - t1522 + t130 * t137 * t462 * t519 / 0.6e1 + t130 * t137 * t138 * t1710 / 0.6e1;
  tv2rhosigma3 = t161 * t1715 + t1450;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 3] += tv2rhosigma3;

  t1724 = -t1551 - t1556 - t1561 + t1565 - 0.2e1 * t201 * t525 * t384 + t1577 + t1582 + t1588 - t1593 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t379;
  tv2rhosigma4 = t161 * t1724 + t1546;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 4] += tv2rhosigma4;

  t1728 = t73 * t407;
  t1729 = t1728 * t65;
  t1732 = t536 * t396;
  t1737 = t92 * t407;
  t1738 = t1737 * t101;
  t1741 = t540 * t426;
  t1746 = t437 * t85;
  t1749 = t109 * t407;
  t1757 = t1463 - t1676 + t401 * t537 / 0.32e2 + t1617 - t71 * t1729 / 0.12e2 + t71 * t1732 / 0.32e2 + t401 * t541 / 0.576e3 + t1626 - t71 * t1738 / 0.216e3 + t71 * t1741 / 0.576e3 - t70 * (-0.16e2 / 0.9e1 * t441 + 0.2e1 / 0.3e1 * t444 - t1746 * t65 / 0.4e1 + 0.2e1 / 0.3e1 * t1749 * t65 - t545 * t396 / 0.4e1) / 0.8e1;
  t1758 = t24 * t1757;
  t1766 = t476 * t85;
  t1769 = t149 * t407;
  t1772 = t70 * t396;
  t1775 = -t1527 + 0.7e1 / 0.18e2 * t481 - 0.7e1 / 0.48e2 * t484 + t1766 * t556 / 0.8e1 - t1769 * t556 / 0.3e1 + t555 * t1772 / 0.8e1;
  t1780 = t1603 + t1607 + t1611 + t21 * t1758 + t1645 + t1650 + t1653 - t1657 + t130 * t137 * t462 * t559 / 0.6e1 + t130 * t137 * t138 * t1775 / 0.6e1;
  tv2rhosigma5 = t161 * t1780 + t1600;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 5] += tv2rhosigma5;

  tv2sigma20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  tv2sigma21 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 1] += tv2sigma21;

  tv2sigma22 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 2] += tv2sigma22;

  tv2sigma23 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 3] += tv2sigma23;

  tv2sigma24 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 4] += tv2sigma24;

  tv2sigma25 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 5] += tv2sigma25;

  t1782 = params->a * t976;
  t1784 = 0.12e2 * t177;
  t1785 = t7 * t589;
  t1786 = 0.36e2 * t1785;
  t1787 = t580 * t2;
  t1788 = 0.1e1 / t1787;
  t1790 = 0.24e2 * t8 * t1788;
  t1791 = t1784 - t1786 + t1790;
  t1792 = t6 * t1791;
  t1795 = t189 * t18 * t589;
  t1796 = t860 * t123;
  t1798 = 0.2e1 / 0.9e1 * t1795 * t1796;
  t1799 = t948 * t213;
  t1800 = t125 * t1799;
  t1802 = 0.4e1 / 0.9e1 * t1795 * t1800;
  t1803 = t136 * t592;
  t1804 = t1803 * t155;
  t1806 = t334 * t336 * t1804;
  t1808 = t776 * t371;
  t1810 = t334 * t336 * t1808;
  t1813 = t789 * t792 * t777;
  t1815 = t318 * t844;
  t1817 = t334 * t336 * t1815;
  t1820 = t789 * t792 * t782;
  t1822 = t786 * t332;
  t1824 = t125 * t128 * t1822;
  t1825 = t790 * t335;
  t1827 = 0.1e1 / t3 / t1787;
  t1828 = t1825 * t1827;
  t1831 = 0.4e1 / 0.81e2 * t1824 * t1828 * t319;
  t1832 = t169 * t592;
  t1835 = t130 * t137 * t1832 * t155;
  t1839 = t130 * t137 * t796 * t371;
  t1843 = t130 * t137 * t340 * t844;
  t1845 = t4 * t1791;
  t1850 = -t1792 * t16 + t1798 + t1802 + t1806 / 0.3e1 + 0.2e1 / 0.3e1 * t1810 + 0.2e1 / 0.9e1 * t1813 + t1817 / 0.3e1 + 0.2e1 / 0.9e1 * t1820 + t1831 - t1835 / 0.6e1 - t1839 / 0.3e1 - t1843 / 0.6e1 + t130 * t137 * t1845 * t155 / 0.6e1;
  t1864 = 0.1e1 / t76 / t642 / rho[0];
  t1865 = t70 * t1864;
  t1866 = t1865 * t58;
  t1869 = t177 - t1785;
  t1870 = t1869 * sigma[0];
  t1879 = t825 * t232;
  t1882 = t357 * t607;
  t1884 = 0.1e1 / t55;
  t1885 = t599 * t229;
  t1888 = t56 * t229;
  t1891 = 0.6e1 * t1869;
  t1895 = my_piecewise3(t49, 0, 0.8e2 / 0.27e2 * t1884 * t1885 + 0.4e2 / 0.3e1 * t1888 * t603 + 0.8e1 / 0.3e1 * t228 * t1891);
  t1896 = t145 * t1895;
  t1899 = -t1869;
  t1900 = t1899 * sigma[2];
  t1907 = 0.1e1 / t62;
  t1908 = t608 * t234;
  t1911 = t63 * t234;
  t1914 = -t1891;
  t1918 = my_piecewise3(t60, 0, 0.8e2 / 0.27e2 * t1907 * t1908 + 0.4e2 / 0.3e1 * t1911 * t611 + 0.8e1 / 0.3e1 * t233 * t1914);
  t1919 = t151 * t1918;
  t1922 = sigma[0] * t1864;
  t1923 = t1922 * t58;
  t1925 = t645 * t232;
  t1927 = t252 * t607;
  t1929 = t79 * t1895;
  t1930 = t86 * t1918;
  t1931 = -0.1232e4 / 0.27e2 * t1923 + 0.88e2 / 0.3e1 * t1925 - 0.8e1 * t1927 + t1929 + t1930;
  t1935 = 0.1e1 / t27 / t1787;
  t1936 = t26 * t1935;
  t1937 = 0.4312e4 / 0.81e2 * t1936;
  t1938 = -t818 * t358 + 0.11e2 / 0.3e1 * t354 * t826 - 0.154e3 / 0.27e2 * t144 * t1866 + t1870 * t146 / 0.8e1 + 0.3e1 / 0.8e1 * t818 * t361 - 0.2e1 * t354 * t829 + 0.3e1 / 0.8e1 * t354 * t832 + 0.11e2 / 0.3e1 * t144 * t1879 - t144 * t1882 + t144 * t1896 / 0.8e1 + t1900 * t152 / 0.8e1 + 0.3e1 / 0.8e1 * t836 * t368 + 0.3e1 / 0.8e1 * t365 * t841 + t150 * t1919 / 0.8e1 - 0.7e1 / 0.48e2 * t70 * t1931 - t1937;
  t1944 = t334 * t849 * t777;
  t1947 = t334 * t849 * t782;
  t1949 = t791 * t582;
  t1952 = 0.4e1 / 0.9e1 * t789 * t1949 * t319;
  t1953 = t568 * t180;
  t1956 = t130 * t137 * t1953 * t155;
  t1960 = t130 * t137 * t762 * t371;
  t1962 = t335 * t589;
  t1965 = 0.67e2 / 0.81e2 * t334 * t1962 * t319;
  t1966 = t869 * t12;
  t1970 = 0.14e2 / 0.81e2 * t130 * t137 * t1966 * t155;
  t1971 = t312 * t310;
  t1972 = t768 * t1971;
  t1974 = t944 * params->d;
  t1975 = t125 * t1974;
  t1976 = t768 * t1975;
  t1978 = t335 * t1570;
  t1979 = t1978 * t136;
  t1980 = t873 * t1979;
  t1982 = 0.4e1 / 0.9e1 * t1980 * t769;
  t1983 = t130 * t137 * t805 * t371 / 0.2e1 + t130 * t137 * t345 * t844 / 0.2e1 + t130 * t137 * t138 * t1938 / 0.6e1 - 0.7e1 / 0.9e1 * t1944 - 0.7e1 / 0.9e1 * t1947 - t1952 + 0.2e1 / 0.9e1 * t1956 + 0.2e1 / 0.9e1 * t1960 + t1965 - t1970 + 0.4e1 / 0.3e1 * t1972 + 0.4e1 / 0.3e1 * t1976 + t1982;
  t1986 = 0.4e1 / 0.9e1 * t1980 * t773;
  t1988 = t189 * t18 * t208;
  t1990 = 0.16e2 / 0.9e1 * t1988 * t769;
  t1992 = 0.16e2 / 0.9e1 * t1988 * t773;
  t1994 = t167 * t923 * t912;
  t1996 = t589 * t165;
  t1999 = 0.52e2 / 0.27e2 * t918 * t1996 * t171;
  t2000 = params->omega * t869;
  t2003 = 0.56e2 / 0.27e2 * t167 * t2000 * t171;
  t2006 = 0.28e2 / 0.27e2 * t195 * t870 * t197;
  t2007 = params->d * t869;
  t2010 = 0.28e2 / 0.27e2 * t201 * t202 * t2007;
  t2011 = t592 * t16;
  t2013 = t167 * t170 * t2011;
  t2016 = t918 * t919 * t912;
  t2018 = t162 * t162;
  t2020 = t127 * t2018 * params->m1;
  t2021 = t2020 * t791;
  t2022 = t582 * t165;
  t2025 = 0.8e1 / 0.27e2 * t2021 * t2022 * t171;
  t2026 = t16 * t747;
  t2028 = t195 * t196 * t2026;
  t2029 = t184 * t747;
  t2031 = t201 * t2029 * t203;
  t2032 = t1986 - t1990 - t1992 + 0.8e1 / 0.3e1 * t1994 + t1999 - t2003 + t2006 + t2010 - 0.2e1 * t2013 - 0.4e1 / 0.3e1 * t2016 - t2025 + t2028 + t2031;
  t2034 = t312 * t589 * t954;
  t2036 = 0.5e1 / 0.27e2 * t2034 * t957;
  t2037 = t956 * t879;
  t2038 = t955 * t2037;
  t2040 = t956 * t884;
  t2041 = t955 * t2040;
  t2044 = t860 * t1570 * t954;
  t2046 = t2044 * t957 / 0.54e2;
  t2048 = t23 * t575;
  t2049 = t2048 * t127;
  t2050 = t312 * t1570 * t2049;
  t2051 = t956 * t892;
  t2053 = t2050 * t2051 / 0.27e2;
  t2055 = t312 * t582 * t954;
  t2056 = t1583 * t136;
  t2057 = t2056 * t328;
  t2059 = 0.2e1 / 0.27e2 * t2055 * t2057;
  t2060 = t972 * t186;
  t2061 = t181 * t577;
  t2063 = t183 * t183;
  t2064 = 0.1e1 / t2063;
  t2065 = t2064 * t627;
  t2066 = t2065 * t589;
  t2068 = 0.2e1 / 0.9e1 * t13 * t2066;
  t2071 = t592 * t220;
  t2073 = t180 * t703;
  t2075 = t213 * t213;
  t2076 = t2075 * t2064;
  t2077 = t2076 * t1570;
  t2079 = t628 * t589;
  t2081 = t214 * t208;
  t2083 = t32 * t869;
  t2085 = -0.14e2 / 0.9e1 * t2077 + 0.7e2 / 0.9e1 * t2079 - 0.364e3 / 0.27e2 * t2081 + 0.196e3 / 0.27e2 * t2083;
  t2087 = t12 * t2085 / 0.72e2;
  t2088 = t1791 * t35 / 0.72e2 + t2071 / 0.24e2 + t2073 / 0.24e2 + t2087;
  t2090 = t583 * t223;
  t2092 = t209 * t706;
  t2095 = 0.1232e4 / 0.27e2 * t1936 * t38;
  t2101 = t1864 * t58;
  t2108 = t229 * t603;
  t2113 = my_piecewise3(t49, 0, 0.2e1 * t1891 * t48 + 0.6e1 * t2108);
  t2114 = t2113 * sigma[2];
  t2121 = t85 * t1918;
  t2124 = t234 * t611;
  t2129 = my_piecewise3(t60, 0, 0.2e1 * t1914 * t59 + 0.6e1 * t2124);
  t2130 = t2129 * sigma[0];
  t2139 = t644 * t232;
  t2142 = t251 * t607;
  t2145 = t78 * t1895;
  t2148 = -0.2464e4 / 0.81e2 * t1923 + 0.2e1 * t728 * t300 - 0.22e2 / 0.3e1 * t297 * t735 + 0.308e3 / 0.27e2 * t115 * t2101 + 0.176e3 / 0.9e1 * t1925 - 0.16e2 / 0.3e1 * t1927 + 0.2e1 / 0.3e1 * t1929 + 0.2e1 / 0.3e1 * t1930 - t2114 * t111 / 0.4e1 - 0.3e1 / 0.4e1 * t716 * t291 - 0.3e1 / 0.4e1 * t288 * t721 - t110 * t2121 / 0.4e1 - t2130 * t116 / 0.4e1 - 0.3e1 / 0.4e1 * t728 * t303 + 0.4e1 * t297 * t738 - 0.3e1 / 0.4e1 * t297 * t741 - 0.22e2 / 0.3e1 * t115 * t2139 + 0.2e1 * t115 * t2142 - t115 * t2145 / 0.4e1;
  t2151 = t665 * t278;
  t2152 = t71 * t2151;
  t2154 = t264 * t690;
  t2155 = t71 * t2154;
  t2170 = my_piecewise3(t49, 0, 0.44e3 / 0.27e2 * t56 * t1885 + 0.88e2 / 0.3e1 * t230 * t603 + 0.11e2 / 0.3e1 * t57 * t1891);
  t2179 = my_piecewise3(t60, 0, 0.44e3 / 0.27e2 * t63 * t1908 + 0.88e2 / 0.3e1 * t235 * t611 + 0.11e2 / 0.3e1 * t64 * t1914);
  t2181 = -0.1232e4 / 0.27e2 * t1922 * t97 + 0.88e2 / 0.3e1 * t645 * t272 - 0.8e1 * t252 * t681 + t79 * t2170 + t86 * t2179;
  t2182 = t92 * t2181;
  t2185 = t620 * t246;
  t2189 = t242 * t636;
  t2191 = t242 * t639;
  t2199 = -t2077 / 0.81e2 + 0.5e1 / 0.81e2 * t2079 - 0.26e2 / 0.243e3 * t2081 + 0.14e2 / 0.243e3 * t2083;
  t2200 = t2199 * t88;
  t2202 = t71 * t2200 / 0.32e2;
  t2203 = -t30 * t2088 - 0.88e2 / 0.3e1 * t2090 + 0.8e1 * t2092 + t2095 - t70 * t2148 / 0.8e1 + t2152 / 0.192e3 + t2155 / 0.192e3 + t71 * t2182 / 0.576e3 + 0.3e1 / 0.32e2 * t2185 + 0.3e1 / 0.32e2 * t620 * t258 + 0.3e1 / 0.32e2 * t2189 + 0.3e1 / 0.16e2 * t2191 + 0.3e1 / 0.32e2 * t242 * t653 + t2202;
  t2204 = t635 * t257;
  t2205 = t71 * t2204;
  t2207 = t245 * t652;
  t2208 = t71 * t2207;
  t2210 = t73 * t1931;
  t2213 = t70 * t1791;
  t2216 = t620 * t265;
  t2220 = t242 * t666;
  t2222 = t242 * t669;
  t2230 = 0.2e1 / 0.9e1 * t2077 - 0.1e2 / 0.9e1 * t2079 + 0.52e2 / 0.27e2 * t2081 - 0.28e2 / 0.27e2 * t2083;
  t2231 = t2230 * t103;
  t2233 = t71 * t2231 / 0.576e3;
  t2243 = t1895 + t1918;
  t2249 = 0.3e1 / 0.32e2 * t2205 + 0.3e1 / 0.32e2 * t2208 + t71 * t2210 / 0.32e2 + t2213 * t104 / 0.576e3 + t2216 / 0.192e3 + t620 * t279 / 0.192e3 + t2220 / 0.192e3 + t2222 / 0.96e2 + t242 * t691 / 0.192e3 + t2233 - 0.3e1 / 0.2e2 * t45 * t1791 * t66 - 0.9e1 / 0.2e2 * t45 * t592 * t238 - 0.9e1 / 0.2e2 * t45 * t180 * t616 - 0.3e1 / 0.2e2 * t45 * t12 * t2243 + t2213 * t89 / 0.32e2;
  t2250 = t2203 + t2249;
  t2251 = t24 * t2250;
  t2253 = t181 * t569;
  t2255 = t576 * t208;
  t2257 = 0.8e1 / 0.9e1 * t13 * t2255;
  t2258 = t185 * t869;
  t2260 = 0.28e2 / 0.27e2 * t13 * t2258;
  t2261 = -t2036 + t2038 / 0.9e1 + t2041 / 0.9e1 + t2046 + t2053 + t2059 - t2060 - 0.2e1 / 0.3e1 * t2061 - t2068 + t21 * t2251 + 0.4e1 / 0.3e1 * t2253 + t2257 - t2260;
  t2265 = t195 * t928 * t936;
  t2267 = t208 * t23;
  t2270 = 0.4e1 / 0.9e1 * t940 * t2267 * t197;
  t2272 = t201 * t944 * t932;
  t2274 = t213 * t208;
  t2277 = 0.8e1 / 0.9e1 * t201 * t948 * t2274;
  t2279 = t940 * t907 * t936;
  t2281 = t859 * params->c;
  t2282 = t21 * t2281;
  t2285 = t2282 * t1552 * t197 / 0.27e2;
  t2286 = t575 * t309;
  t2288 = t201 * t2286 * t949;
  t2290 = t2064 * t122;
  t2291 = t627 * t589;
  t2294 = 0.2e1 / 0.9e1 * t201 * t2290 * t2291;
  t2297 = t750 * t29 * t180 * t185;
  t2299 = t917 * t1978;
  t2300 = t165 * t12;
  t2301 = t2300 * t185;
  t2303 = 0.4e1 / 0.9e1 * t2299 * t2301;
  t2307 = 0.4e1 / 0.9e1 * t750 * t589 * t12 * t576;
  t2311 = 0.16e2 / 0.9e1 * t750 * t208 * t12 * t185;
  t2313 = t21 * params->c * t208;
  t2315 = 0.8e1 / 0.9e1 * t2313 * t759;
  t2316 = -0.4e1 / 0.3e1 * t2265 - t2270 - 0.4e1 / 0.3e1 * t2272 - t2277 + t2279 / 0.3e1 + t2285 + 0.2e1 / 0.3e1 * t2288 + t2294 - 0.4e1 / 0.3e1 * t2297 - t2303 - t2307 + t2311 - t2315;
  t2318 = t757 * t309 * params->d;
  t2319 = t756 * t2318;
  t2322 = t21 * t859 * t589;
  t2324 = t2322 * t759 / 0.9e1;
  t2326 = t21 * params->c * t589;
  t2328 = t2048 * t122 * t213;
  t2330 = 0.2e1 / 0.9e1 * t2326 * t2328;
  t2331 = t909 * t853;
  t2333 = t909 * t856;
  t2336 = t860 * t1552 * t16;
  t2338 = 0.5e1 / 0.54e2 * t2336 * t320;
  t2340 = 0.11e2 / 0.27e2 * t1573 * t875;
  t2341 = t312 * t23;
  t2342 = t2341 * t772;
  t2344 = 0.4e1 / 0.9e1 * t1795 * t2342;
  t2345 = t874 * t777;
  t2346 = t872 * t2345;
  t2349 = t897 * t899 * t879;
  t2351 = t874 * t782;
  t2352 = t872 * t2351;
  t2355 = t897 * t899 * t884;
  t2357 = t1788 * t23;
  t2358 = t2357 * t16;
  t2359 = t312 * t2358;
  t2360 = t127 * t787;
  t2361 = t2360 * t791;
  t2362 = t2361 * t319;
  t2364 = 0.2e1 / 0.27e2 * t2359 * t2362;
  t2365 = 0.2e1 / 0.3e1 * t2319 + t2324 + t2330 - t2331 / 0.3e1 - t2333 / 0.3e1 - t2338 - t2340 + t2344 + 0.2e1 / 0.9e1 * t2346 + 0.2e1 / 0.9e1 * t2349 + 0.2e1 / 0.9e1 * t2352 + 0.2e1 / 0.9e1 * t2355 + t2364;
  t2368 = t125 * t323 * t787;
  t2370 = t791 * t1788 * t136;
  t2373 = 0.2e1 / 0.27e2 * t2368 * t2370 * t328;
  t2375 = t325 * t903 * t879;
  t2378 = t325 * t903 * t884;
  t2380 = t317 * t1804;
  t2381 = t315 * t2380;
  t2383 = t592 * t155;
  t2384 = t2383 * params->d;
  t2386 = t325 * t326 * t2384;
  t2388 = t317 * t1808;
  t2389 = t315 * t2388;
  t2391 = t180 * t371;
  t2392 = t2391 * params->d;
  t2394 = t325 * t326 * t2392;
  t2396 = t317 * t1815;
  t2397 = t315 * t2396;
  t2399 = t12 * t844;
  t2400 = t2399 * params->d;
  t2402 = t325 * t326 * t2400;
  t2404 = t863 * t853;
  t2406 = t863 * t856;
  t2408 = params->b * t2281;
  t2409 = t2408 * t1572;
  t2411 = t2409 * t320 / 0.162e3;
  t2412 = t582 * t23;
  t2413 = t2412 * t16;
  t2414 = t860 * t2413;
  t2416 = t2414 * t875 / 0.27e2;
  t2417 = t2373 - t2375 / 0.3e1 - t2378 / 0.3e1 + t2381 / 0.6e1 + t2386 / 0.6e1 + t2389 / 0.3e1 + t2394 / 0.3e1 + t2397 / 0.6e1 + t2402 / 0.6e1 + t2404 / 0.18e2 + t2406 / 0.18e2 + t2411 + t2416;
  t2418 = t878 * t213;
  t2420 = t890 * t891 * t2418;
  t2422 = t883 * t213;
  t2424 = t890 * t891 * t2422;
  t2426 = t2064 * t127;
  t2428 = t125 * t2426 * params->m2;
  t2429 = t137 * t1570;
  t2430 = t327 * t627;
  t2433 = t2428 * t2429 * t2430 / 0.27e2;
  t2435 = t125 * t888 * t332;
  t2437 = t335 * t582 * t136;
  t2440 = 0.2e1 / 0.27e2 * t2435 * t2437 * t892;
  t2441 = t137 * t208;
  t2444 = 0.26e2 / 0.81e2 * t325 * t2441 * t328;
  t2446 = t312 * t2267 * t16;
  t2448 = 0.26e2 / 0.81e2 * t2446 * t320;
  t2449 = t137 * t589;
  t2452 = 0.5e1 / 0.27e2 * t890 * t2449 * t892;
  t2455 = 0.11e2 / 0.27e2 * t897 * t1979 * t328;
  t2457 = t190 * t968 * t310;
  t2459 = t873 * t1962;
  t2461 = 0.52e2 / 0.27e2 * t2459 * t965;
  t2462 = t869 * params->b;
  t2465 = 0.56e2 / 0.27e2 * t190 * t2462 * t123;
  t2467 = t190 * t191 * t748;
  t2469 = t964 * t310;
  t2470 = t963 * t2469;
  t2472 = t2360 * t1949;
  t2474 = 0.8e1 / 0.27e2 * t2472 * t965;
  t2475 = t2420 / 0.9e1 + t2424 / 0.9e1 + t2433 + t2440 + t2444 + t2448 - t2452 - t2455 - 0.8e1 / 0.3e1 * t2457 - t2461 + t2465 + 0.2e1 * t2467 + 0.4e1 / 0.3e1 * t2470 + t2474;
  t2478 = t1850 + t1983 + t2032 + t2261 + t2316 + t2365 + t2417 + t2475;
  tv3rho30 = t161 * t2478 + 0.3e1 * t1782;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t2481 = 0.2e1 * params->a * t1256;
  t2483 = 0.2e1 / 0.3e1 * t1252 * t186;
  t2484 = t380 * t577;
  t2489 = 0.16e2 / 0.3e1 * t209 * t1130;
  t2490 = 0.4e1 * t177;
  t2491 = 0.12e2 * t1785;
  t2492 = -t2490 - t2491 + t1790;
  t2496 = t1007 * t220 / 0.36e2;
  t2497 = t379 * t703;
  t2501 = t2492 * t35 / 0.72e2 + t2496 + t2497 / 0.72e2 + t2071 / 0.72e2 + t2073 / 0.36e2 + t2087;
  t2503 = t583 * t384;
  t2520 = t1884 * t389;
  t2523 = t56 * t7;
  t2524 = t229 * t177;
  t2529 = t228 * t177;
  t2534 = my_piecewise3(t49, 0, 0.8e2 / 0.27e2 * t2520 * t599 + 0.16e3 / 0.9e1 * t2523 * t2524 + 0.4e2 / 0.9e1 * t987 * t603 + 0.16e2 / 0.3e1 * t2529 - 0.16e2 * t990 * t589);
  t2535 = t1907 * t393;
  t2538 = t63 * t7;
  t2539 = t234 * t177;
  t2544 = t233 * t177;
  t2549 = my_piecewise3(t60, 0, 0.8e2 / 0.27e2 * t2535 * t608 - 0.16e3 / 0.9e1 * t2538 * t2539 + 0.4e2 / 0.9e1 * t995 * t611 - 0.16e2 / 0.3e1 * t2544 + 0.16e2 * t998 * t589);
  t2550 = t2534 + t2549;
  t2554 = -0.176e3 / 0.9e1 * t2090 + 0.8e1 / 0.3e1 * t2092 + t2095 + t2489 - t30 * t2501 - 0.88e2 / 0.9e1 * t2503 - 0.3e1 / 0.2e2 * t45 * t2492 * t66 - 0.3e1 / 0.1e2 * t45 * t1007 * t238 - 0.3e1 / 0.2e2 * t45 * t379 * t616 - 0.3e1 / 0.2e2 * t45 * t592 * t397 - 0.3e1 / 0.1e2 * t45 * t180 * t1003 - 0.3e1 / 0.2e2 * t45 * t12 * t2550;
  t2555 = t70 * t2492;
  t2559 = t1008 * t246 / 0.16e2;
  t2562 = t401 * t636;
  t2565 = t401 * t639 / 0.16e2;
  t2571 = t242 * t1017 / 0.16e2;
  t2574 = t635 * t412;
  t2575 = t71 * t2574;
  t2577 = t245 * t1026;
  t2579 = t71 * t2577 / 0.16e2;
  t2580 = t645 * t392;
  t2582 = t252 * t994;
  t2584 = t79 * t2534;
  t2585 = t408 * t615;
  t2587 = t86 * t2549;
  t2588 = 0.88e2 / 0.9e1 * t2580 - 0.16e2 / 0.3e1 * t2582 + t2584 - 0.8e1 / 0.3e1 * t2585 + t2587;
  t2589 = t73 * t2588;
  t2592 = t2555 * t89 / 0.32e2 + t2559 + t1008 * t258 / 0.16e2 + t2562 / 0.32e2 + t2565 + t401 * t653 / 0.32e2 + t620 * t413 / 0.32e2 + t2571 + t242 * t1027 / 0.16e2 + t2575 / 0.32e2 + t2579 + t71 * t2589 / 0.32e2;
  t2597 = t1008 * t265 / 0.288e3;
  t2600 = t401 * t666;
  t2603 = t401 * t669 / 0.288e3;
  t2609 = t242 * t1039 / 0.288e3;
  t2612 = t665 * t428;
  t2613 = t71 * t2612;
  t2615 = t264 * t1062;
  t2617 = t71 * t2615 / 0.288e3;
  t2633 = my_piecewise3(t49, 0, 0.44e3 / 0.27e2 * t987 * t599 + 0.352e3 / 0.9e1 * t990 * t2524 + 0.88e2 / 0.9e1 * t390 * t603 + 0.22e2 / 0.3e1 * t57 * t177 - 0.22e2 * t1046 * t589);
  t2648 = my_piecewise3(t60, 0, 0.44e3 / 0.27e2 * t995 * t608 - 0.352e3 / 0.9e1 * t998 * t2539 + 0.88e2 / 0.9e1 * t394 * t611 - 0.22e2 / 0.3e1 * t64 * t177 + 0.22e2 * t1056 * t589);
  t2650 = 0.88e2 / 0.9e1 * t645 * t420 - 0.16e2 / 0.3e1 * t252 * t1050 + t79 * t2633 - 0.8e1 / 0.3e1 * t408 * t688 + t86 * t2648;
  t2651 = t92 * t2650;
  t2654 = t2555 * t104 / 0.576e3 + t2597 + t1008 * t279 / 0.288e3 + t2600 / 0.576e3 + t2603 + t401 * t691 / 0.576e3 + t620 * t429 / 0.576e3 + t2609 + t242 * t1063 / 0.288e3 + t2613 / 0.576e3 + t2617 + t71 * t2651 / 0.576e3;
  t2666 = t644 * t392;
  t2671 = t229 * t7;
  t2672 = t2671 * t177;
  t2679 = my_piecewise3(t49, 0, -0.12e2 * t1079 * t589 + 0.4e1 * t177 * t48 + 0.2e1 * t389 * t603 + 0.8e1 * t2672);
  t2680 = t2679 * sigma[2];
  t2689 = 0.176e3 / 0.27e2 * t2580 - 0.32e2 / 0.9e1 * t2582 + 0.2e1 / 0.3e1 * t2584 - 0.16e2 / 0.9e1 * t2585 + 0.2e1 / 0.3e1 * t2587 + 0.4e1 / 0.3e1 * t1106 * t300 - 0.22e2 / 0.9e1 * t450 * t735 + 0.4e1 / 0.3e1 * t297 * t1115 - 0.22e2 / 0.9e1 * t115 * t2666 - t2680 * t111 / 0.4e1 - t1084 * t291 / 0.2e1 - t438 * t721 / 0.4e1 + 0.2e1 / 0.3e1 * t716 * t441;
  t2692 = t407 * t615;
  t2699 = t85 * t2549;
  t2704 = t234 * t7;
  t2705 = t2704 * t177;
  t2712 = my_piecewise3(t60, 0, 0.12e2 * t1101 * t589 - 0.4e1 * t177 * t59 + 0.2e1 * t393 * t611 - 0.8e1 * t2705);
  t2713 = t2712 * sigma[0];
  t2726 = t251 * t994;
  t2729 = t78 * t2534;
  t2732 = 0.4e1 / 0.3e1 * t288 * t1091 + 0.2e1 / 0.3e1 * t110 * t2692 - t716 * t444 / 0.4e1 - t288 * t1096 / 0.2e1 - t110 * t2699 / 0.4e1 - t2713 * t116 / 0.4e1 - t1106 * t303 / 0.2e1 + 0.4e1 / 0.3e1 * t450 * t738 - t450 * t741 / 0.4e1 - t728 * t453 / 0.4e1 - t297 * t1118 / 0.2e1 + 0.4e1 / 0.3e1 * t115 * t2726 - t115 * t2729 / 0.4e1;
  t2746 = -t70 * (t2689 + t2732) / 0.8e1 + t2152 / 0.288e3 + t2155 / 0.576e3 + t2185 / 0.32e2 + t2189 / 0.16e2 + t2191 / 0.16e2 + t2202 + t2205 / 0.16e2 + t2208 / 0.32e2 + t2216 / 0.576e3 + t2220 / 0.288e3 + t2222 / 0.288e3 + t2233;
  t2748 = t2554 + t2592 + t2654 + t2746;
  t2749 = t24 * t2748;
  t2751 = t6 * t2492;
  t2753 = t380 * t569;
  t2766 = -t2483 - 0.2e1 / 0.9e1 * t2484 + t21 * t2749 - t2751 * t16 + 0.4e1 / 0.9e1 * t2753 + t1798 + t1802 + t1806 / 0.9e1 + 0.2e1 / 0.9e1 * t1810 + 0.4e1 / 0.27e2 * t1813 + t1817 / 0.9e1 + 0.4e1 / 0.27e2 * t1820 + t1831 - t1835 / 0.18e2 - t1839 / 0.9e1 - t1843 / 0.18e2 - 0.14e2 / 0.27e2 * t1944 - 0.14e2 / 0.27e2 * t1947 - t1952 + 0.4e1 / 0.27e2 * t1956;
  t2775 = 0.4e1 / 0.27e2 * t1960 + t1965 - t1970 + 0.8e1 / 0.9e1 * t1972 + 0.8e1 / 0.9e1 * t1976 + t1982 + t1986 - t1990 - t1992 + 0.16e2 / 0.9e1 * t1994 + t1999 - t2003 + t2006 + t2010 - 0.2e1 / 0.3e1 * t2013 - 0.8e1 / 0.9e1 * t2016 - t2025 + t2028 / 0.3e1 + t2031 / 0.3e1 - t2036;
  t2787 = 0.2e1 / 0.27e2 * t2038 + 0.2e1 / 0.27e2 * t2041 + t2046 + t2053 + t2059 - t2060 / 0.3e1 - 0.4e1 / 0.9e1 * t2061 - t2068 + 0.8e1 / 0.9e1 * t2253 + t2257 - t2260 - 0.8e1 / 0.9e1 * t2265 - t2270 - 0.8e1 / 0.9e1 * t2272 - t2277 + 0.2e1 / 0.9e1 * t2279 + t2285 + 0.4e1 / 0.9e1 * t2288 + t2294 - 0.8e1 / 0.9e1 * t2297;
  t2788 = t312 * t460;
  t2789 = t768 * t2788;
  t2791 = t1240 * params->d;
  t2792 = t125 * t2791;
  t2793 = t768 * t2792;
  t2795 = t4 * t2492;
  t2804 = t136 * t1007;
  t2805 = t2804 * t155;
  t2808 = 0.2e1 / 0.9e1 * t334 * t336 * t2805;
  t2813 = t1137 * t371;
  t2816 = 0.2e1 / 0.9e1 * t334 * t336 * t2813;
  t2818 = t789 * t792 * t1138;
  t2828 = t750 * t29 * t379 * t185;
  t2831 = t757 * t459 * params->d;
  t2832 = t756 * t2831;
  t2838 = t776 * t487;
  t2841 = 0.2e1 / 0.9e1 * t334 * t336 * t2838;
  t2842 = t177 * sigma[0];
  t2849 = t825 * t392;
  t2852 = t177 * sigma[2];
  t2863 = t357 * t994;
  t2866 = t145 * t2534;
  t2871 = t2842 * t146 / 0.24e2 + 0.11e2 / 0.9e1 * t470 * t826 - 0.2e1 / 0.3e1 * t354 * t1157 + 0.11e2 / 0.9e1 * t144 * t2849 - t2852 * t152 / 0.24e2 - 0.2e1 / 0.3e1 * t470 * t829 + t470 * t832 / 0.8e1 + t818 * t473 / 0.8e1 + t354 * t1160 / 0.4e1 - 0.2e1 / 0.3e1 * t144 * t2863 + t144 * t2866 / 0.8e1 + t477 * t841 / 0.8e1;
  t2876 = t480 * t615;
  t2883 = t151 * t2549;
  t2890 = t1785 * sigma[0];
  t2895 = t1785 * sigma[2];
  t2900 = -t836 * t481 / 0.3e1 - 0.2e1 / 0.3e1 * t365 * t1170 - t150 * t2876 / 0.3e1 + t836 * t484 / 0.8e1 + t365 * t1175 / 0.4e1 + t150 * t2883 / 0.8e1 - 0.7e1 / 0.48e2 * t70 * t2588 - t1937 - t1163 * t368 / 0.12e2 - t2890 * t146 / 0.8e1 - 0.2e1 / 0.9e1 * t1148 * t358 + t2895 * t152 / 0.8e1 + t1148 * t361 / 0.12e2;
  t2901 = t2871 + t2900;
  t2906 = -t2307 + t2311 - t2315 + 0.4e1 / 0.9e1 * t2319 + t2324 + t2330 - 0.4e1 / 0.9e1 * t2828 + 0.2e1 / 0.9e1 * t2832 + t130 * t137 * t345 * t1178 / 0.3e1 + t2841 + t130 * t137 * t138 * t2901 / 0.6e1;
  t2910 = t318 * t1178;
  t2913 = 0.2e1 / 0.9e1 * t334 * t336 * t2910;
  t2915 = t789 * t792 * t1183;
  t2917 = t169 * t1007;
  t2921 = t130 * t137 * t2917 * t155 / 0.9e1;
  t2925 = t130 * t137 * t1187 * t371 / 0.9e1;
  t2927 = t334 * t849 * t1138;
  t2932 = t130 * t137 * t796 * t487 / 0.9e1;
  t2936 = t130 * t137 * t340 * t1178 / 0.9e1;
  t2938 = t334 * t849 * t1183;
  t2940 = t568 * t379;
  t2943 = t130 * t137 * t2940 * t155;
  t2947 = t130 * t137 * t762 * t487;
  t2955 = t2913 + 0.2e1 / 0.27e2 * t2915 - t2921 - t2925 - 0.7e1 / 0.27e2 * t2927 - t2932 - t2936 - 0.7e1 / 0.27e2 * t2938 + 0.2e1 / 0.27e2 * t2943 + 0.2e1 / 0.27e2 * t2947 - 0.2e1 / 0.9e1 * t2331 - 0.2e1 / 0.9e1 * t2333 - t2338 - t2340 + t2344 + 0.4e1 / 0.27e2 * t2346 + 0.4e1 / 0.27e2 * t2349 + 0.4e1 / 0.27e2 * t2352 + 0.4e1 / 0.27e2 * t2355 + t2364;
  t2968 = t2373 - 0.2e1 / 0.9e1 * t2375 - 0.2e1 / 0.9e1 * t2378 + t2381 / 0.18e2 + t2386 / 0.18e2 + t2389 / 0.9e1 + t2394 / 0.9e1 + t2397 / 0.18e2 + t2402 / 0.18e2 + t2404 / 0.27e2 + t2406 / 0.27e2 + t2411 + t2416 + 0.2e1 / 0.27e2 * t2420 + 0.2e1 / 0.27e2 * t2424 + t2433 + t2440 + t2444 + t2448 - t2452;
  t2970 = t317 * t2805;
  t2972 = t315 * t2970 / 0.9e1;
  t2973 = t1007 * t155;
  t2974 = t2973 * params->d;
  t2977 = t325 * t326 * t2974 / 0.9e1;
  t2978 = t317 * t2813;
  t2980 = t315 * t2978 / 0.9e1;
  t2981 = t379 * t371;
  t2982 = t2981 * params->d;
  t2985 = t325 * t326 * t2982 / 0.9e1;
  t2986 = t874 * t1138;
  t2987 = t872 * t2986;
  t2990 = t897 * t899 * t1219;
  t2992 = t317 * t2838;
  t2994 = t315 * t2992 / 0.9e1;
  t2995 = t180 * t487;
  t2996 = t2995 * params->d;
  t2999 = t325 * t326 * t2996 / 0.9e1;
  t3000 = t317 * t2910;
  t3002 = t315 * t3000 / 0.9e1;
  t3003 = t12 * t1178;
  t3004 = t3003 * params->d;
  t3007 = t325 * t326 * t3004 / 0.9e1;
  t3008 = t874 * t1183;
  t3009 = t872 * t3008;
  t3012 = t897 * t899 * t1211;
  t3014 = t909 * t1215;
  t3017 = t325 * t903 * t1219;
  t3019 = t863 * t1215;
  t3021 = t1218 * t213;
  t3023 = t890 * t891 * t3021;
  t3025 = t909 * t1223;
  t3028 = t325 * t903 * t1211;
  t3030 = t863 * t1223;
  t3032 = -t2455 + t2972 + t2977 + t2980 + t2985 + 0.2e1 / 0.27e2 * t2987 + 0.2e1 / 0.27e2 * t2990 + t2994 + t2999 + t3002 + t3007 + 0.2e1 / 0.27e2 * t3009 + 0.2e1 / 0.27e2 * t3012 - t3014 / 0.9e1 - t3017 / 0.9e1 + t3019 / 0.54e2 + t3023 / 0.27e2 - t3025 / 0.9e1 - t3028 / 0.9e1 + t3030 / 0.54e2;
  t3033 = t1210 * t213;
  t3035 = t890 * t891 * t3033;
  t3038 = t167 * t923 * t1232;
  t3041 = t195 * t928 * t1236;
  t3044 = t201 * t1240 * t932;
  t3046 = t16 * t1133;
  t3049 = 0.2e1 / 0.3e1 * t195 * t196 * t3046;
  t3050 = t184 * t1133;
  t3053 = 0.2e1 / 0.3e1 * t201 * t3050 * t203;
  t3054 = t1007 * t16;
  t3057 = 0.4e1 / 0.3e1 * t167 * t170 * t3054;
  t3059 = t918 * t919 * t1232;
  t3062 = t940 * t907 * t1236;
  t3064 = t575 * t459;
  t3066 = t201 * t3064 * t949;
  t3069 = t956 * t1219;
  t3070 = t955 * t3069;
  t3072 = t956 * t1211;
  t3073 = t955 * t3072;
  t3079 = t190 * t968 * t460;
  t3083 = 0.4e1 / 0.3e1 * t190 * t191 * t1134;
  t3084 = t964 * t460;
  t3085 = t963 * t3084;
  t3087 = t3070 / 0.27e2 + t3073 / 0.27e2 - 0.16e2 / 0.9e1 * t2457 - t2461 + t2465 + 0.2e1 / 0.3e1 * t2467 + 0.8e1 / 0.9e1 * t2470 + t2474 - 0.8e1 / 0.9e1 * t3079 + t3083 + 0.4e1 / 0.9e1 * t3085;
  t3091 = 0.2e1 / 0.9e1 * t3066 + t2787 - 0.4e1 / 0.9e1 * t3059 + t3062 / 0.9e1 - t3057 + t2766 + t2955 + t2906 + t3087 + t3032 - t2303 + t3049 + t3053 - 0.4e1 / 0.9e1 * t3044 + t2808 + 0.4e1 / 0.9e1 * t2789 + t2775 + 0.4e1 / 0.9e1 * t2793 + t130 * t137 * t2795 * t155 / 0.6e1 + t130 * t137 * t1197 * t371 / 0.3e1 + t130 * t137 * t462 * t844 / 0.6e1 + t130 * t137 * t805 * t487 / 0.6e1 + t2816 + 0.2e1 / 0.27e2 * t2818 + t2968 - 0.4e1 / 0.9e1 * t3041 + t3035 / 0.27e2 + 0.8e1 / 0.9e1 * t3038;
  tv3rho31 = t161 * t3091 + t1782 + t2481;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 1] += tv3rho31;

  t3093 = params->a * t1448;
  t3095 = -t2490 + t2491 + t1790;
  t3096 = t6 * t3095;
  t3107 = -t2483 - 0.4e1 / 0.9e1 * t2484 - t3096 * t16 + 0.8e1 / 0.9e1 * t2753 + t1798 + t1802 + 0.2e1 / 0.27e2 * t1813 + 0.2e1 / 0.27e2 * t1820 + t1831 - 0.7e1 / 0.27e2 * t1944 - 0.7e1 / 0.27e2 * t1947 - t1952 + 0.2e1 / 0.27e2 * t1956 + 0.2e1 / 0.27e2 * t1960 + t1965 - t1970 + 0.4e1 / 0.9e1 * t1972 + 0.4e1 / 0.9e1 * t1976 + t1982 + t1986;
  t3112 = t1348 * t186;
  t3114 = t389 * t7;
  t3117 = t229 * t1279;
  t3121 = -0.2e1 * t177 - 0.6e1 * t1785;
  t3125 = my_piecewise3(t49, 0, 0.8e1 * t177 * t3114 + 0.2e1 * t3121 * t48 + 0.2e1 * t3117);
  t3126 = t3125 * sigma[2];
  t3141 = t1287 * t237;
  t3146 = t407 * t1002;
  t3151 = t1907 * t1293;
  t3156 = t63 * t1296;
  t3159 = -t3121;
  t3160 = t233 * t3159;
  t3163 = my_piecewise3(t60, 0, 0.8e2 / 0.27e2 * t3151 * t234 - 0.16e3 / 0.9e1 * t995 * t587 + 0.4e2 / 0.9e1 * t3156 * t234 + 0.8e1 / 0.3e1 * t3160);
  t3164 = t85 * t3163;
  t3167 = t393 * t7;
  t3170 = t234 * t1296;
  t3175 = my_piecewise3(t60, 0, -0.8e1 * t177 * t3167 + 0.2e1 * t3159 * t59 + 0.2e1 * t3170);
  t3176 = t3175 * sigma[0];
  t3179 = -t3126 * t111 / 0.4e1 - t1412 * t291 / 0.4e1 + 0.4e1 / 0.3e1 * t1084 * t441 + 0.4e1 / 0.3e1 * t438 * t1091 - t1084 * t444 / 0.2e1 - t438 * t1096 / 0.2e1 - 0.22e2 / 0.9e1 * t288 * t1419 - 0.22e2 / 0.9e1 * t110 * t3141 + 0.4e1 / 0.3e1 * t288 * t1422 + 0.4e1 / 0.3e1 * t110 * t3146 - t288 * t1425 / 0.4e1 - t110 * t3164 / 0.4e1 - t3176 * t116 / 0.4e1;
  t3188 = t1884 * t1275;
  t3193 = t56 * t1279;
  t3196 = t228 * t3121;
  t3199 = my_piecewise3(t49, 0, 0.8e2 / 0.27e2 * t3188 * t229 + 0.16e3 / 0.9e1 * t987 * t587 + 0.4e2 / 0.9e1 * t3193 * t229 + 0.8e1 / 0.3e1 * t3196);
  t3200 = t78 * t3199;
  t3207 = t251 * t1283;
  t3210 = t252 * t1283;
  t3212 = t79 * t3199;
  t3214 = t1288 * t237;
  t3216 = t408 * t1002;
  t3218 = t86 * t3163;
  t3220 = -t1432 * t303 / 0.4e1 - t1106 * t453 / 0.2e1 - t450 * t1118 / 0.2e1 - t297 * t1437 / 0.4e1 - t115 * t3200 / 0.4e1 + 0.2e1 / 0.3e1 * t1432 * t300 + 0.4e1 / 0.3e1 * t450 * t1115 + 0.2e1 / 0.3e1 * t115 * t3207 - 0.16e2 / 0.9e1 * t3210 + 0.2e1 / 0.3e1 * t3212 + 0.176e3 / 0.27e2 * t3214 - 0.32e2 / 0.9e1 * t3216 + 0.2e1 / 0.3e1 * t3218;
  t3225 = t209 * t1402;
  t3230 = -t70 * (t3179 + t3220) / 0.8e1 - 0.88e2 / 0.9e1 * t2090 + t2095 + 0.8e1 / 0.3e1 * t3225 + t2489 - 0.176e3 / 0.9e1 * t2503 + t2559 + t2562 / 0.16e2 + t2565 + t2571 + t2575 / 0.16e2 + t2579;
  t3235 = t1264 * t220;
  t3239 = t3095 * t35 / 0.72e2 + t3235 / 0.72e2 + t2496 + t2497 / 0.36e2 + t2073 / 0.72e2 + t2087;
  t3245 = t2597 + t2600 / 0.288e3 + t2603 + t2609 + t2613 / 0.288e3 + t2617 - t30 * t3239 + t2152 / 0.576e3 + t2189 / 0.32e2 + t2202 + t2205 / 0.32e2 + t2220 / 0.576e3;
  t3258 = my_piecewise3(t49, 0, 0.44e3 / 0.27e2 * t1276 * t229 + 0.352e3 / 0.9e1 * t390 * t587 + 0.88e2 / 0.9e1 * t1280 * t229 + 0.11e2 / 0.3e1 * t57 * t3121);
  t3273 = my_piecewise3(t60, 0, 0.44e3 / 0.27e2 * t1294 * t234 - 0.352e3 / 0.9e1 * t394 * t587 + 0.88e2 / 0.9e1 * t1297 * t234 + 0.11e2 / 0.3e1 * t64 * t3159);
  t3275 = -0.8e1 / 0.3e1 * t252 * t1382 + t79 * t3258 + 0.88e2 / 0.9e1 * t1288 * t276 - 0.16e2 / 0.3e1 * t408 * t1060 + t86 * t3273;
  t3276 = t92 * t3275;
  t3279 = t70 * t3095;
  t3282 = t1365 * t246;
  t3288 = t401 * t1017;
  t3294 = t245 * t1302;
  t3295 = t71 * t3294;
  t3300 = -0.8e1 / 0.3e1 * t3210 + t3212 + 0.88e2 / 0.9e1 * t3214 - 0.16e2 / 0.3e1 * t3216 + t3218;
  t3301 = t73 * t3300;
  t3306 = t2233 + t71 * t3276 / 0.576e3 + t3279 * t89 / 0.32e2 + t3282 / 0.32e2 + t1365 * t258 / 0.32e2 + t1008 * t413 / 0.16e2 + t3288 / 0.16e2 + t401 * t1027 / 0.16e2 + t242 * t1370 / 0.32e2 + t3295 / 0.32e2 + t71 * t3301 / 0.32e2 + t3279 * t104 / 0.576e3;
  t3307 = t1365 * t265;
  t3313 = t401 * t1039;
  t3319 = t264 * t1395;
  t3320 = t71 * t3319;
  t3337 = t3199 + t3163;
  t3341 = t3307 / 0.576e3 + t1365 * t279 / 0.576e3 + t1008 * t429 / 0.288e3 + t3313 / 0.288e3 + t401 * t1063 / 0.288e3 + t242 * t1396 / 0.576e3 + t3320 / 0.576e3 - 0.3e1 / 0.2e2 * t45 * t3095 * t66 - 0.3e1 / 0.2e2 * t45 * t1264 * t238 - 0.3e1 / 0.1e2 * t45 * t1007 * t397 - 0.3e1 / 0.1e2 * t45 * t379 * t1003 - 0.3e1 / 0.2e2 * t45 * t180 * t1361 - 0.3e1 / 0.2e2 * t45 * t12 * t3337;
  t3343 = t3230 + t3245 + t3306 + t3341;
  t3344 = t24 * t3343;
  t3348 = -t1990 - t1992 + 0.8e1 / 0.9e1 * t1994 + t1999 - t2003 + t2006 + t2010 - 0.4e1 / 0.9e1 * t2016 - t2025 - t2036 + t2038 / 0.27e2 + t2041 / 0.27e2 + t2046 + t2053 + t2059 - t3112 / 0.3e1 + t21 * t3344 - 0.2e1 / 0.9e1 * t2061 - t2068 + 0.4e1 / 0.9e1 * t2253;
  t3358 = t2257 - t2260 - 0.4e1 / 0.9e1 * t2265 - t2270 - 0.4e1 / 0.9e1 * t2272 - t2277 + t2279 / 0.9e1 + t2285 + 0.2e1 / 0.9e1 * t2288 + t2294 - 0.4e1 / 0.9e1 * t2297 + 0.8e1 / 0.9e1 * t2789 + 0.8e1 / 0.9e1 * t2793 + t2808 + t2816 + 0.4e1 / 0.27e2 * t2818 - t2303 - t2307 + t2311 - t2315;
  t3368 = t4 * t3095;
  t3377 = t136 * t1264;
  t3378 = t3377 * t155;
  t3380 = t334 * t336 * t3378;
  t3390 = -0.14e2 / 0.27e2 * t2927 - t2932 - t2936 - 0.14e2 / 0.27e2 * t2938 + 0.4e1 / 0.27e2 * t2943 + 0.4e1 / 0.27e2 * t2947 + t130 * t137 * t3368 * t155 / 0.6e1 + t130 * t137 * t1265 * t371 / 0.6e1 + t3380 / 0.9e1 + t130 * t137 * t1197 * t487 / 0.3e1 + t130 * t137 * t462 * t1178 / 0.3e1;
  t3394 = t1137 * t487;
  t3396 = t334 * t336 * t3394;
  t3405 = -t177 / 0.3e1 - t1785;
  t3406 = t3405 * sigma[0];
  t3421 = t357 * t1283;
  t3424 = t145 * t3199;
  t3427 = -t1937 - 0.7e1 / 0.48e2 * t70 * t3300 + t3406 * t146 / 0.8e1 - t1306 * t358 / 0.3e1 + t1306 * t361 / 0.8e1 + t1148 * t473 / 0.12e2 - 0.2e1 / 0.3e1 * t470 * t1157 + t470 * t1160 / 0.4e1 + t354 * t1311 / 0.8e1 - t144 * t3421 / 0.3e1 + t144 * t3424 / 0.8e1;
  t3428 = -t3405;
  t3429 = t3428 * sigma[2];
  t3444 = t1322 * t237;
  t3449 = t480 * t1002;
  t3454 = t151 * t3163;
  t3457 = t3429 * t152 / 0.8e1 + t1315 * t368 / 0.8e1 + 0.2e1 / 0.9e1 * t1163 * t481 - 0.2e1 / 0.3e1 * t477 * t1170 - t1163 * t484 / 0.12e2 + t477 * t1175 / 0.4e1 + 0.11e2 / 0.9e1 * t365 * t1323 + 0.11e2 / 0.9e1 * t150 * t3444 - 0.2e1 / 0.3e1 * t365 * t1326 - 0.2e1 / 0.3e1 * t150 * t3449 + t365 * t1329 / 0.8e1 + t150 * t3454 / 0.8e1;
  t3458 = t3427 + t3457;
  t3463 = t318 * t1332;
  t3465 = t334 * t336 * t3463;
  t3467 = t169 * t1264;
  t3470 = t130 * t137 * t3467 * t155;
  t3474 = t130 * t137 * t1187 * t487;
  t3478 = t130 * t137 * t340 * t1332;
  t3488 = 0.2e1 / 0.9e1 * t3396 + t130 * t137 * t345 * t1332 / 0.6e1 + t130 * t137 * t138 * t3458 / 0.6e1 + t3465 / 0.9e1 - t3470 / 0.18e2 - t3474 / 0.9e1 - t3478 / 0.18e2 - t2331 / 0.9e1 - t2333 / 0.9e1 - t2338 - t2340 + t2344 + 0.2e1 / 0.27e2 * t2346 + 0.2e1 / 0.27e2 * t2349 + 0.2e1 / 0.27e2 * t2352 + 0.2e1 / 0.27e2 * t2355 + t2364 + t2373 - t2375 / 0.9e1 - t2378 / 0.9e1;
  t3495 = t2404 / 0.54e2 + t2406 / 0.54e2 + t2411 + t2416 + t2420 / 0.27e2 + t2424 / 0.27e2 + t2433 + t2440 + t2444 + t2448 - t2452 - t2455 + t2972 + t2977 + t2980 + t2985 + 0.4e1 / 0.27e2 * t2987 + 0.4e1 / 0.27e2 * t2990 + t2994 + t2999;
  t3507 = t317 * t3378;
  t3508 = t315 * t3507;
  t3510 = t1264 * t155;
  t3511 = t3510 * params->d;
  t3513 = t325 * t326 * t3511;
  t3515 = t317 * t3394;
  t3516 = t315 * t3515;
  t3518 = t379 * t487;
  t3519 = t3518 * params->d;
  t3521 = t325 * t326 * t3519;
  t3523 = t317 * t3463;
  t3524 = t315 * t3523;
  t3526 = t12 * t1332;
  t3527 = t3526 * params->d;
  t3529 = t325 * t326 * t3527;
  t3533 = t3002 + t3007 + 0.4e1 / 0.27e2 * t3009 + 0.4e1 / 0.27e2 * t3012 - 0.2e1 / 0.9e1 * t3014 - 0.2e1 / 0.9e1 * t3017 + t3019 / 0.27e2 + 0.2e1 / 0.27e2 * t3023 - 0.2e1 / 0.9e1 * t3025 - 0.2e1 / 0.9e1 * t3028 + t3030 / 0.27e2 + 0.2e1 / 0.27e2 * t3035 + t3508 / 0.18e2 + t3513 / 0.18e2 + t3516 / 0.9e1 + t3521 / 0.9e1 + t3524 / 0.18e2 + t3529 / 0.18e2 + 0.16e2 / 0.9e1 * t3038 - 0.8e1 / 0.9e1 * t3041;
  t3538 = t1264 * t16;
  t3540 = t167 * t170 * t3538;
  t3542 = t16 * t1443;
  t3544 = t195 * t196 * t3542;
  t3546 = t184 * t1443;
  t3548 = t201 * t3546 * t203;
  t3558 = t190 * t191 * t1444;
  t3560 = 0.2e1 / 0.27e2 * t3070 + 0.2e1 / 0.27e2 * t3073 - 0.8e1 / 0.9e1 * t2457 - t2461 + t2465 + 0.4e1 / 0.9e1 * t2470 + t2474 - 0.16e2 / 0.9e1 * t3079 + t3083 + 0.8e1 / 0.9e1 * t3085 + 0.2e1 / 0.3e1 * t3558;
  t3564 = t3495 + t3488 + 0.4e1 / 0.9e1 * t3066 - 0.8e1 / 0.9e1 * t3059 + 0.2e1 / 0.9e1 * t3062 - t3057 + t3049 + t3053 - 0.8e1 / 0.9e1 * t3044 + t3107 + t2913 + 0.4e1 / 0.27e2 * t2915 + t2841 + 0.4e1 / 0.9e1 * t2832 - t2925 - t2921 + t2330 + 0.2e1 / 0.9e1 * t2319 - 0.8e1 / 0.9e1 * t2828 + t3390 + t3358 + t3348 + t3560 + t3548 / 0.3e1 - 0.2e1 / 0.3e1 * t3540 + t3544 / 0.3e1 + t3533 + t2324;
  tv3rho32 = t161 * t3564 + t2481 + t3093;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 2] += tv3rho32;

  t3568 = t1784 + t1786 + t1790;
  t3569 = t6 * t3568;
  t3580 = t1275 * t389;
  t3581 = t1884 * t3580;
  t3585 = -t177 - t1785;
  t3586 = 0.6e1 * t3585;
  t3587 = t228 * t3586;
  t3590 = my_piecewise3(t49, 0, 0.8e2 / 0.27e2 * t3581 + 0.4e2 / 0.3e1 * t987 * t1279 + 0.8e1 / 0.3e1 * t3587);
  t3591 = t1293 * t393;
  t3592 = t1907 * t3591;
  t3596 = -t3586;
  t3597 = t233 * t3596;
  t3600 = my_piecewise3(t60, 0, 0.8e2 / 0.27e2 * t3592 + 0.4e2 / 0.3e1 * t995 * t1296 + 0.8e1 / 0.3e1 * t3597);
  t3601 = t3590 + t3600;
  t3605 = t70 * t3568;
  t3612 = t79 * t3590;
  t3615 = 0.1e1 / t83 / t1285 / rho[1];
  t3616 = sigma[2] * t3615;
  t3617 = t3616 * t65;
  t3619 = t1288 * t396;
  t3621 = t408 * t1300;
  t3623 = t86 * t3600;
  t3624 = t3612 - 0.1232e4 / 0.27e2 * t3617 + 0.88e2 / 0.3e1 * t3619 - 0.8e1 * t3621 + t3623;
  t3625 = t73 * t3624;
  t3641 = my_piecewise3(t49, 0, 0.44e3 / 0.27e2 * t56 * t3580 + 0.88e2 / 0.3e1 * t390 * t1279 + 0.11e2 / 0.3e1 * t57 * t3586);
  t3656 = my_piecewise3(t60, 0, 0.44e3 / 0.27e2 * t63 * t3591 + 0.88e2 / 0.3e1 * t394 * t1296 + 0.11e2 / 0.3e1 * t64 * t3596);
  t3658 = t79 * t3641 - 0.1232e4 / 0.27e2 * t3616 * t101 + 0.88e2 / 0.3e1 * t1288 * t426 - 0.8e1 * t408 * t1393 + t86 * t3656;
  t3659 = t92 * t3658;
  t3666 = t3615 * t65;
  t3679 = my_piecewise3(t49, 0, 0.6e1 * t1279 * t389 + 0.2e1 * t3586 * t48);
  t3680 = t3679 * sigma[2];
  t3689 = t1287 * t396;
  t3692 = t407 * t1300;
  t3695 = t85 * t3600;
  t3703 = my_piecewise3(t60, 0, 0.6e1 * t1296 * t393 + 0.2e1 * t3596 * t59);
  t3704 = t3703 * sigma[0];
  t3711 = t78 * t3590;
  t3714 = 0.2e1 * t1412 * t441 - 0.22e2 / 0.3e1 * t438 * t1419 + 0.308e3 / 0.27e2 * t110 * t3666 + 0.2e1 / 0.3e1 * t3612 + 0.176e3 / 0.9e1 * t3619 - 0.16e2 / 0.3e1 * t3621 + 0.2e1 / 0.3e1 * t3623 - 0.2464e4 / 0.81e2 * t3617 - t3680 * t111 / 0.4e1 - 0.3e1 / 0.4e1 * t1412 * t444 + 0.4e1 * t438 * t1422 - 0.3e1 / 0.4e1 * t438 * t1425 - 0.22e2 / 0.3e1 * t110 * t3689 + 0.2e1 * t110 * t3692 - t110 * t3695 / 0.4e1 - t3704 * t116 / 0.4e1 - 0.3e1 / 0.4e1 * t1432 * t453 - 0.3e1 / 0.4e1 * t450 * t1437 - t115 * t3711 / 0.4e1;
  t3721 = t3568 * t35 / 0.72e2 + t3235 / 0.24e2 + t2497 / 0.24e2 + t2087;
  t3723 = -0.3e1 / 0.2e2 * t45 * t3568 * t66 - 0.9e1 / 0.2e2 * t45 * t1264 * t397 - 0.9e1 / 0.2e2 * t45 * t379 * t1361 - 0.3e1 / 0.2e2 * t45 * t12 * t3601 + t3605 * t89 / 0.32e2 + 0.3e1 / 0.32e2 * t1365 * t413 + 0.3e1 / 0.32e2 * t401 * t1370 + t71 * t3625 / 0.32e2 + t3605 * t104 / 0.576e3 + t1365 * t429 / 0.192e3 + t401 * t1396 / 0.192e3 + t71 * t3659 / 0.576e3 - t70 * t3714 / 0.8e1 - t30 * t3721;
  t3736 = t2095 + 0.8e1 * t3225 - 0.88e2 / 0.3e1 * t2503 + 0.3e1 / 0.32e2 * t2562 + 0.3e1 / 0.32e2 * t2575 + t2600 / 0.192e3 + t2613 / 0.192e3 + t2202 + t2233 + 0.3e1 / 0.32e2 * t3282 + 0.3e1 / 0.16e2 * t3288 + 0.3e1 / 0.32e2 * t3295 + t3307 / 0.192e3 + t3313 / 0.96e2 + t3320 / 0.192e3;
  t3737 = t3723 + t3736;
  t3738 = t24 * t3737;
  t3741 = -0.2e1 / 0.3e1 * t2484 - t3569 * t16 + t21 * t3738 + 0.4e1 / 0.3e1 * t2753 + t1798 + t1802 + t1831 - t1952 + t1965 - t1970 + t1982 + t1986 - t1990;
  t3742 = -t1992 + t1999 - t2003 + t2006 + t2010 - t2025 - t2036 + t2046 + t2053 + t2059 - t3112 - t2068 + t2257;
  t3747 = -t2260 - t2270 - t2277 + t2285 + t2294 + 0.4e1 / 0.3e1 * t2789 + 0.4e1 / 0.3e1 * t2793 + 0.2e1 / 0.9e1 * t2818 - t2303 - t2307 + t2311 - t2315 + t2324;
  t3760 = t2330 - 0.4e1 / 0.3e1 * t2828 + 0.2e1 / 0.3e1 * t2832 + 0.2e1 / 0.9e1 * t2915 - 0.7e1 / 0.9e1 * t2927 - 0.7e1 / 0.9e1 * t2938 + 0.2e1 / 0.9e1 * t2943 + 0.2e1 / 0.9e1 * t2947 + t3380 / 0.3e1 + 0.2e1 / 0.3e1 * t3396 + t3465 / 0.3e1 - t3470 / 0.6e1 - t3474 / 0.3e1;
  t3764 = t4 * t3568;
  t3780 = t70 * t3615;
  t3781 = t3780 * t65;
  t3784 = t3585 * sigma[0];
  t3791 = t145 * t3590;
  t3794 = -t3585;
  t3795 = t3794 * sigma[2];
  t3804 = t1322 * t396;
  t3807 = t480 * t1300;
  t3809 = t151 * t3600;
  t3814 = -t1315 * t481 + 0.11e2 / 0.3e1 * t477 * t1323 - 0.154e3 / 0.27e2 * t150 * t3781 + t3784 * t146 / 0.8e1 + 0.3e1 / 0.8e1 * t1306 * t473 + 0.3e1 / 0.8e1 * t470 * t1311 + t144 * t3791 / 0.8e1 + t3795 * t152 / 0.8e1 + 0.3e1 / 0.8e1 * t1315 * t484 - 0.2e1 * t477 * t1326 + 0.3e1 / 0.8e1 * t477 * t1329 + 0.11e2 / 0.3e1 * t150 * t3804 - t150 * t3807 + t150 * t3809 / 0.8e1 - 0.7e1 / 0.48e2 * t70 * t3624 - t1937;
  t3819 = -t3478 / 0.6e1 + t130 * t137 * t3764 * t155 / 0.6e1 + t130 * t137 * t1265 * t487 / 0.2e1 + t130 * t137 * t462 * t1332 / 0.2e1 + t130 * t137 * t138 * t3814 / 0.6e1 - t2338 - t2340 + t2344 + t2364 + t2373 + t2411 + t2416 + t2433;
  t3828 = t2440 + t2444 + t2448 - t2452 - t2455 + 0.2e1 / 0.9e1 * t2987 + 0.2e1 / 0.9e1 * t2990 + 0.2e1 / 0.9e1 * t3009 + 0.2e1 / 0.9e1 * t3012 - t3014 / 0.3e1 - t3017 / 0.3e1 + t3019 / 0.18e2 + t3023 / 0.9e1;
  t3843 = -t3025 / 0.3e1 - t3028 / 0.3e1 + t3030 / 0.18e2 + t3035 / 0.9e1 + t3508 / 0.6e1 + t3513 / 0.6e1 + t3516 / 0.3e1 + t3521 / 0.3e1 + t3524 / 0.6e1 + t3529 / 0.6e1 + 0.8e1 / 0.3e1 * t3038 - 0.4e1 / 0.3e1 * t3041 - 0.4e1 / 0.3e1 * t3044;
  t3853 = -0.4e1 / 0.3e1 * t3059 + t3062 / 0.3e1 + 0.2e1 / 0.3e1 * t3066 - 0.2e1 * t3540 + t3544 + t3548 + t3070 / 0.9e1 + t3073 / 0.9e1 - t2461 + t2465 + t2474 - 0.8e1 / 0.3e1 * t3079 + 0.4e1 / 0.3e1 * t3085 + 0.2e1 * t3558;
  t3856 = t3741 + t3742 + t3747 + t3760 + t3819 + t3828 + t3843 + t3853;
  tv3rho33 = t161 * t3856 + 0.3e1 * t3093;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 3] += tv3rho33;

  t3858 = params->a * t1544;
  t3863 = t727 * t78;
  t3866 = t296 * t251;
  t3871 = t114 * t644;
  t3883 = t242 * t1468;
  t3887 = t635 * t78;
  t3888 = t3887 * t58;
  t3890 = t71 * t3888 / 0.32e2;
  t3891 = t1467 * t232;
  t3892 = t71 * t3891;
  t3894 = t1471 * t232;
  t3897 = t495 * t607;
  t3902 = t242 * t1481;
  t3906 = t665 * t78;
  t3907 = t3906 * t97;
  t3909 = t71 * t3907 / 0.576e3;
  t3910 = -t70 * (0.176e3 / 0.27e2 * t735 - 0.32e2 / 0.9e1 * t738 + 0.2e1 / 0.3e1 * t741 - t3863 * t58 / 0.4e1 + 0.4e1 / 0.3e1 * t3866 * t58 - t1493 * t232 / 0.2e1 - 0.22e2 / 0.9e1 * t3871 * t58 + 0.4e1 / 0.3e1 * t1496 * t232 - t504 * t607 / 0.4e1) / 0.8e1 + t620 * t496 / 0.32e2 + t3883 / 0.16e2 + t242 * t1475 / 0.16e2 + t3890 + t3892 / 0.16e2 - t71 * t3894 / 0.6e1 + t71 * t3897 / 0.32e2 + t620 * t500 / 0.576e3 + t3902 / 0.288e3 + t242 * t1488 / 0.288e3 + t3909;
  t3911 = t1480 * t272;
  t3912 = t71 * t3911;
  t3914 = t1484 * t272;
  t3917 = t499 * t681;
  t3922 = t245 * t251;
  t3923 = t3922 * t58;
  t3924 = t71 * t3923;
  t3926 = t73 * t644;
  t3927 = t3926 * t58;
  t3932 = t264 * t251;
  t3933 = t3932 * t97;
  t3934 = t71 * t3933;
  t3936 = t92 * t644;
  t3937 = t3936 * t97;
  t3940 = t208 * t223;
  t3941 = 0.16e2 / 0.3e1 * t3940;
  t3942 = t29 * t706;
  t3944 = 0.88e2 / 0.9e1 * t582 * t38;
  t3945 = t3912 / 0.288e3 - t71 * t3914 / 0.108e3 + t71 * t3917 / 0.576e3 - t242 * t1472 / 0.6e1 - t3924 / 0.6e1 + 0.11e2 / 0.36e2 * t71 * t3927 - t242 * t1485 / 0.108e3 - t3934 / 0.108e3 + 0.11e2 / 0.648e3 * t71 * t3937 + t3941 - t3942 - t3944;
  t3946 = t3910 + t3945;
  t3947 = t24 * t3946;
  t3949 = t956 * t1512;
  t3951 = t955 * t3949 / 0.27e2;
  t3952 = t180 * t519;
  t3953 = t3952 * params->d;
  t3955 = t325 * t326 * t3953;
  t3957 = t12 * t1539;
  t3958 = t3957 * params->d;
  t3960 = t325 * t326 * t3958;
  t3962 = t1511 * t213;
  t3965 = t890 * t891 * t3962 / 0.27e2;
  t3967 = t909 * t1508 / 0.9e1;
  t3970 = t325 * t903 * t1512 / 0.9e1;
  t3973 = 0.2e1 / 0.27e2 * t897 * t899 * t1512;
  t3974 = t776 * t519;
  t3975 = t317 * t3974;
  t3976 = t315 * t3975;
  t3978 = t318 * t1539;
  t3979 = t317 * t3978;
  t3980 = t315 * t3979;
  t3983 = t863 * t1508 / 0.54e2;
  t3984 = t874 * t1507;
  t3986 = 0.2e1 / 0.27e2 * t872 * t3984;
  t3988 = t757 * t510 * params->d;
  t3990 = 0.2e1 / 0.9e1 * t756 * t3988;
  t3993 = 0.7e1 / 0.27e2 * t334 * t849 * t1507;
  t3997 = 0.2e1 / 0.27e2 * t130 * t137 * t762 * t519;
  t3998 = t312 * t511;
  t4000 = 0.4e1 / 0.9e1 * t768 * t3998;
  t4001 = t1458 * params->d;
  t4002 = t125 * t4001;
  t4004 = 0.4e1 / 0.9e1 * t768 * t4002;
  t4005 = t21 * t3947 + t3951 + t3955 / 0.9e1 + t3960 / 0.9e1 + t3965 - t3967 - t3970 + t3973 + t3976 / 0.9e1 + t3980 / 0.9e1 + t3983 + t3986 + t3990 - t3993 + t3997 + t4000 + t4004;
  t4007 = t334 * t336 * t3974;
  t4010 = t334 * t336 * t3978;
  t4014 = 0.2e1 / 0.27e2 * t789 * t792 * t1507;
  t4017 = t130 * t137 * t796 * t519;
  t4021 = t130 * t137 * t340 * t1539;
  t4031 = 0.308e3 / 0.27e2 * t582;
  t4035 = t817 * t78;
  t4038 = t353 * t251;
  t4043 = t143 * t644;
  t4048 = t70 * t607;
  t4051 = t4031 - 0.77e2 / 0.54e2 * t826 + 0.7e1 / 0.9e1 * t829 - 0.7e1 / 0.48e2 * t832 + t4035 * t516 / 0.8e1 - 0.2e1 / 0.3e1 * t4038 * t516 + t1530 * t1536 / 0.4e1 + 0.11e2 / 0.9e1 * t4043 * t516 - 0.2e1 / 0.3e1 * t1533 * t1536 + t515 * t4048 / 0.8e1;
  t4058 = 0.4e1 / 0.9e1 * t195 * t928 * t1454;
  t4061 = 0.4e1 / 0.9e1 * t201 * t1458 * t932;
  t4062 = t16 * t1504;
  t4064 = t195 * t196 * t4062;
  t4068 = t940 * t907 * t1454 / 0.9e1;
  t4069 = t184 * t1504;
  t4071 = t201 * t4069 * t203;
  t4073 = t575 * t510;
  t4076 = 0.2e1 / 0.9e1 * t201 * t4073 * t949;
  t4079 = 0.8e1 / 0.9e1 * t190 * t968 * t511;
  t4081 = t190 * t191 * t1505;
  t4083 = t964 * t511;
  t4085 = 0.4e1 / 0.9e1 * t963 * t4083;
  t4086 = 0.2e1 / 0.9e1 * t4007 + 0.2e1 / 0.9e1 * t4010 + t4014 - t4017 / 0.9e1 - t4021 / 0.9e1 + t130 * t137 * t805 * t519 / 0.6e1 + t130 * t137 * t345 * t1539 / 0.3e1 + t130 * t137 * t138 * t4051 / 0.6e1 - t4058 - t4061 + 0.2e1 / 0.3e1 * t4064 + t4068 + 0.2e1 / 0.3e1 * t4071 + t4076 - t4079 + 0.4e1 / 0.3e1 * t4081 + t4085;
  t4087 = t4005 + t4086;
  tv3rho2sigma0 = t161 * t4087 + 0.2e1 * t3858;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  t4089 = params->a * t1598;
  t4092 = t201 * t1562 * t223;
  t4097 = t16 * t582;
  t4100 = 0.176e3 / 0.9e1 * t201 * t4097 * t38;
  t4101 = t1935 * t23;
  t4103 = t312 * t4101 * t184;
  t4104 = t318 * params->d;
  t4105 = t317 * t4104;
  t4107 = 0.7e1 / 0.81e2 * t4103 * t4105;
  t4109 = t21 * params->c * t1827;
  t4110 = t757 * t1558;
  t4112 = 0.4e1 / 0.9e1 * t4109 * t4110;
  t4113 = t580 * t9;
  t4114 = 0.1e1 / t4113;
  t4115 = t335 * t4114;
  t4118 = 0.14e2 / 0.81e2 * t897 * t4115 * t4104;
  t4119 = t1827 * t23;
  t4120 = t4119 * t16;
  t4121 = t312 * t4120;
  t4123 = 0.77e2 / 0.81e2 * t4121 * t1575;
  t4124 = t1827 * t12;
  t4128 = 0.77e2 / 0.81e2 * t325 * t137 * t4124 * params->d;
  t4130 = t189 * t18 * t1827;
  t4131 = t312 * t1548;
  t4133 = 0.8e1 / 0.9e1 * t4130 * t4131;
  t4135 = t184 * t38 * params->d;
  t4136 = t125 * t4135;
  t4138 = 0.8e1 / 0.9e1 * t4130 * t4136;
  t4140 = t316 * t137 * t180;
  t4141 = t1573 * t4140;
  t4143 = t4101 * t16;
  t4144 = t860 * t4143;
  t4146 = 0.7e1 / 0.162e3 * t4144 * t1575;
  t4147 = t4114 * t23;
  t4148 = t4147 * t16;
  t4149 = t312 * t4148;
  t4150 = t335 * t136;
  t4152 = t873 * t4150 * t12;
  t4154 = 0.14e2 / 0.81e2 * t4149 * t4152;
  t4158 = t325 * t137 * t1570 * t180 * params->d;
  t4164 = 0.7e1 / 0.81e2 * t890 * t137 * t1935 * t12 * t213;
  t4165 = 0.32e2 / 0.3e1 * t4092 - 0.2e1 * t201 * t525 * t706 - t4100 + t4107 - t4112 + t4118 - t4123 - t4128 - t4133 - t4138 + 0.7e1 / 0.27e2 * t4141 + t4146 + t4154 + 0.7e1 / 0.27e2 * t4158 + t4164;
  t4168 = 0.4e2 / 0.9e1 * t195 * t2357 * t1553;
  t4169 = t184 * t1788;
  t4172 = 0.4e2 / 0.9e1 * t201 * t4169 * t1558;
  t4173 = t16 * t223;
  t4175 = t195 * t1552 * t4173;
  t4179 = 0.2e1 / 0.9e1 * t940 * t4119 * t1553;
  t4180 = t223 * params->d;
  t4182 = t201 * t1557 * t4180;
  t4184 = t575 * t1827;
  t4185 = t38 * t213;
  t4188 = 0.4e1 / 0.9e1 * t201 * t4184 * t4185;
  t4189 = t1935 * t136;
  t4193 = 0.161e3 / 0.81e2 * t529 * t1583 * t4189 * t12;
  t4194 = t136 * t1788;
  t4198 = 0.14e2 / 0.3e1 * t529 * t18 * t4194 * t12;
  t4199 = t1788 * params->b;
  t4202 = 0.8e2 / 0.9e1 * t190 * t4199 * t1548;
  t4203 = t24 * t223;
  t4205 = t190 * t1547 * t4203;
  t4207 = t335 * t1935;
  t4208 = t873 * t4207;
  t4209 = t964 * t1548;
  t4211 = 0.8e1 / 0.9e1 * t4208 * t4209;
  t4214 = t529 * t1583 * t1584 * t180;
  t4216 = t787 * t791;
  t4218 = 0.1e1 / t3 / t4113;
  t4219 = t4218 * t136;
  t4223 = 0.14e2 / 0.81e2 * t529 * t4216 * t4219 * t12;
  t4226 = t529 * t18 * t1589 * t180;
  t4232 = t4168 + t4172 - 0.4e1 / 0.3e1 * t4175 - t4179 - 0.4e1 / 0.3e1 * t4182 - t4188 - t4193 + t4198 + t4202 - 0.8e1 / 0.3e1 * t4205 - t4211 + 0.14e2 / 0.27e2 * t4214 + t4223 - 0.7e1 / 0.3e1 * t4226 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t592;
  t4233 = t4165 + t4232;
  tv3rho2sigma1 = t161 * t4233 + 0.2e1 * t4089;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 1] += tv3rho2sigma1;

  t4235 = params->a * t1674;
  t4239 = t242 * t1615;
  t4243 = t635 * t85;
  t4244 = t4243 * t65;
  t4246 = t71 * t4244 / 0.32e2;
  t4247 = t1614 * t237;
  t4248 = t71 * t4247;
  t4250 = t536 * t615;
  t4255 = t242 * t1624;
  t4259 = t665 * t85;
  t4260 = t4259 * t101;
  t4262 = t71 * t4260 / 0.576e3;
  t4263 = t1623 * t276;
  t4264 = t71 * t4263;
  t4266 = t540 * t688;
  t4270 = t715 * t85;
  t4280 = -t3944 + t3941 - t3942 + t620 * t537 / 0.32e2 + t4239 / 0.16e2 + t242 * t1618 / 0.16e2 + t4246 + t4248 / 0.16e2 + t71 * t4250 / 0.32e2 + t620 * t541 / 0.576e3 + t4255 / 0.288e3 + t242 * t1627 / 0.288e3 + t4262 + t4264 / 0.288e3 + t71 * t4266 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t721 - t4270 * t65 / 0.4e1 - t1631 * t237 / 0.2e1 - t545 * t615 / 0.4e1) / 0.8e1;
  t4281 = t24 * t4280;
  t4283 = t956 * t1647;
  t4285 = t955 * t4283 / 0.27e2;
  t4286 = t12 * t1669;
  t4287 = t4286 * params->d;
  t4289 = t325 * t326 * t4287;
  t4291 = t1646 * t213;
  t4294 = t890 * t891 * t4291 / 0.27e2;
  t4297 = 0.2e1 / 0.27e2 * t897 * t899 * t1647;
  t4298 = t776 * t559;
  t4299 = t317 * t4298;
  t4300 = t315 * t4299;
  t4302 = t318 * t1669;
  t4303 = t317 * t4302;
  t4304 = t315 * t4303;
  t4307 = t863 * t1643 / 0.54e2;
  t4308 = t874 * t1642;
  t4310 = 0.2e1 / 0.27e2 * t872 * t4308;
  t4312 = t909 * t1643 / 0.9e1;
  t4315 = t325 * t903 * t1647 / 0.9e1;
  t4316 = t180 * t559;
  t4317 = t4316 * params->d;
  t4319 = t325 * t326 * t4317;
  t4322 = t757 * t551 * params->d;
  t4324 = 0.2e1 / 0.9e1 * t756 * t4322;
  t4326 = t835 * t85;
  t4331 = t70 * t615;
  t4334 = t4031 - 0.7e1 / 0.48e2 * t841 + t4326 * t556 / 0.8e1 + t1663 * t1666 / 0.4e1 + t555 * t4331 / 0.8e1;
  t4341 = t130 * t137 * t796 * t559;
  t4345 = t130 * t137 * t340 * t1669;
  t4351 = t21 * t4281 + t4285 + t4289 / 0.9e1 + t4294 + t4297 + t4300 / 0.9e1 + t4304 / 0.9e1 + t4307 + t4310 - t4312 - t4315 + t4319 / 0.9e1 + t4324 + t130 * t137 * t138 * t4334 / 0.6e1 - t4341 / 0.9e1 - t4345 / 0.9e1 + t130 * t137 * t805 * t559 / 0.6e1;
  t4356 = t312 * t552;
  t4358 = 0.4e1 / 0.9e1 * t768 * t4356;
  t4359 = t1608 * params->d;
  t4360 = t125 * t4359;
  t4362 = 0.4e1 / 0.9e1 * t768 * t4360;
  t4364 = t334 * t336 * t4298;
  t4367 = t334 * t336 * t4302;
  t4371 = 0.2e1 / 0.27e2 * t789 * t792 * t1642;
  t4374 = 0.7e1 / 0.27e2 * t334 * t849 * t1642;
  t4378 = 0.2e1 / 0.27e2 * t130 * t137 * t762 * t559;
  t4381 = 0.4e1 / 0.9e1 * t195 * t928 * t1604;
  t4384 = 0.4e1 / 0.9e1 * t201 * t1608 * t932;
  t4385 = t16 * t1639;
  t4387 = t195 * t196 * t4385;
  t4391 = t940 * t907 * t1604 / 0.9e1;
  t4392 = t184 * t1639;
  t4394 = t201 * t4392 * t203;
  t4396 = t575 * t551;
  t4399 = 0.2e1 / 0.9e1 * t201 * t4396 * t949;
  t4402 = 0.8e1 / 0.9e1 * t190 * t968 * t552;
  t4404 = t190 * t191 * t1640;
  t4406 = t964 * t552;
  t4408 = 0.4e1 / 0.9e1 * t963 * t4406;
  t4409 = t130 * t137 * t345 * t1669 / 0.3e1 + t4358 + t4362 + 0.2e1 / 0.9e1 * t4364 + 0.2e1 / 0.9e1 * t4367 + t4371 - t4374 + t4378 - t4381 - t4384 + 0.2e1 / 0.3e1 * t4387 + t4391 + 0.2e1 / 0.3e1 * t4394 + t4399 - t4402 + 0.4e1 / 0.3e1 * t4404 + t4408;
  t4410 = t4351 + t4409;
  tv3rho2sigma2 = t161 * t4410 + 0.2e1 * t4235;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 2] += tv3rho2sigma2;

  t4412 = params->a * t1715;
  t4413 = 0.8e1 / 0.3e1 * t3940;
  t4416 = t401 * t1468;
  t4422 = t1467 * t392;
  t4423 = t71 * t4422;
  t4425 = t495 * t994;
  t4430 = t401 * t1481;
  t4436 = t1480 * t420;
  t4437 = t71 * t4436;
  t4439 = t499 * t1050;
  t4442 = -t3944 + t4413 + t1008 * t496 / 0.32e2 + t4416 / 0.32e2 + t401 * t1475 / 0.32e2 + t242 * t1679 / 0.32e2 + t4423 / 0.32e2 + t71 * t4425 / 0.32e2 + t1008 * t500 / 0.576e3 + t4430 / 0.576e3 + t401 * t1488 / 0.576e3 + t242 * t1684 / 0.576e3 + t4437 / 0.576e3 + t71 * t4439 / 0.576e3;
  t4445 = t1471 * t392;
  t4450 = t1484 * t420;
  t4459 = t208 * t384;
  t4460 = 0.8e1 / 0.3e1 * t4459;
  t4461 = t29 * t1130;
  t4464 = t1105 * t78;
  t4467 = t449 * t251;
  t4481 = -t401 * t1472 / 0.12e2 - t71 * t4445 / 0.12e2 - t401 * t1485 / 0.216e3 - t71 * t4450 / 0.216e3 + t3883 / 0.32e2 + t3890 + t3892 / 0.32e2 + t3902 / 0.576e3 + t3909 + t3912 / 0.576e3 - t3924 / 0.12e2 - t3934 / 0.216e3 + t4460 - t4461 - t70 * (-0.16e2 / 0.9e1 * t1115 + 0.2e1 / 0.3e1 * t1118 - t4464 * t58 / 0.4e1 + 0.2e1 / 0.3e1 * t4467 * t58 - t1688 * t232 / 0.4e1 - t1493 * t392 / 0.4e1 + 0.2e1 / 0.3e1 * t1496 * t392 - t504 * t994 / 0.4e1) / 0.8e1;
  t4482 = t4442 + t4481;
  t4483 = t24 * t4482;
  t4485 = t379 * t519;
  t4486 = t4485 * params->d;
  t4488 = t325 * t326 * t4486;
  t4490 = t318 * t1710;
  t4491 = t317 * t4490;
  t4492 = t315 * t4491;
  t4494 = t12 * t1710;
  t4495 = t4494 * params->d;
  t4497 = t325 * t326 * t4495;
  t4499 = t1137 * t519;
  t4500 = t317 * t4499;
  t4501 = t315 * t4500;
  t4505 = t21 * t4483 + t3951 + t4488 / 0.18e2 + t4492 / 0.18e2 + t4497 / 0.18e2 + t4501 / 0.18e2 + t3955 / 0.18e2 + t3960 / 0.18e2 + t3965 - t3967 - t3970;
  t4510 = t3973 + t3976 / 0.18e2 + t3980 / 0.18e2 + t3983 + t3986 + t3990 - t3993 + t3997 + t4000 + t4004 + t4007 / 0.9e1 + t4010 / 0.9e1;
  t4515 = t334 * t336 * t4490;
  t4526 = t334 * t336 * t4499;
  t4536 = t469 * t251;
  t4545 = t70 * t994;
  t4548 = t4031 + 0.7e1 / 0.18e2 * t1157 - 0.7e1 / 0.48e2 * t1160 + t587 * t146 / 0.24e2 - t4536 * t516 / 0.3e1 + t1704 * t1536 / 0.8e1 + t1530 * t1707 / 0.8e1 - t1533 * t1707 / 0.3e1 + t515 * t4545 / 0.8e1;
  t4555 = t130 * t137 * t340 * t1710;
  t4559 = t130 * t137 * t1187 * t519;
  t4561 = t4014 - t4017 / 0.18e2 - t4021 / 0.18e2 + t4515 / 0.9e1 + t130 * t137 * t1197 * t519 / 0.6e1 + t130 * t137 * t462 * t1539 / 0.6e1 + t4526 / 0.9e1 + t130 * t137 * t345 * t1710 / 0.6e1 + t130 * t137 * t138 * t4548 / 0.6e1 - t4555 / 0.18e2 - t4559 / 0.18e2;
  t4564 = t16 * t1696;
  t4566 = t195 * t196 * t4564;
  t4568 = t184 * t1696;
  t4570 = t201 * t4568 * t203;
  t4574 = t190 * t191 * t1697;
  t4576 = -t4058 - t4061 + t4064 / 0.3e1 + t4068 + t4071 / 0.3e1 + t4076 + t4566 / 0.3e1 + t4570 / 0.3e1 - t4079 + 0.2e1 / 0.3e1 * t4081 + t4085 + 0.2e1 / 0.3e1 * t4574;
  t4578 = t4505 + t4510 + t4561 + t4576;
  tv3rho2sigma3 = t161 * t4578 + t3858 + t4412;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 3] += tv3rho2sigma3;

  t4580 = params->a * t1724;
  t4586 = t201 * t1562 * t384;
  t4591 = t316 * t137 * t379;
  t4592 = t1573 * t4591;
  t4597 = t325 * t137 * t1570 * t379 * params->d;
  t4599 = 0.16e2 / 0.3e1 * t4092 - t4100 + t4107 - t4112 - 0.2e1 * t201 * t525 * t1130 + 0.16e2 / 0.3e1 * t4586 + t4118 - t4123 - t4128 - t4133 - t4138 + 0.7e1 / 0.54e2 * t4141 + t4146 + t4154 + 0.7e1 / 0.54e2 * t4158 + t4164 + 0.7e1 / 0.54e2 * t4592 + 0.7e1 / 0.54e2 * t4597 + t4168;
  t4602 = t16 * t384;
  t4604 = t195 * t1552 * t4602;
  t4606 = t384 * params->d;
  t4608 = t201 * t1557 * t4606;
  t4615 = t529 * t18 * t1589 * t379;
  t4617 = t24 * t384;
  t4619 = t190 * t1547 * t4617;
  t4627 = t529 * t1583 * t1584 * t379;
  t4629 = t4172 - 0.2e1 / 0.3e1 * t4175 - t4179 - 0.2e1 / 0.3e1 * t4182 - t4188 - 0.2e1 / 0.3e1 * t4604 - 0.2e1 / 0.3e1 * t4608 - t4193 + t4198 + t4202 - 0.4e1 / 0.3e1 * t4205 - t4211 + 0.7e1 / 0.27e2 * t4214 + t4223 - 0.7e1 / 0.6e1 * t4226 - 0.7e1 / 0.6e1 * t4615 - 0.4e1 / 0.3e1 * t4619 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t1007 + 0.7e1 / 0.27e2 * t4627;
  t4630 = t4599 + t4629;
  tv3rho2sigma4 = t161 * t4630 + t4089 + t4580;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 4] += tv3rho2sigma4;

  t4632 = params->a * t1780;
  t4635 = t401 * t1615;
  t4641 = t245 * t407;
  t4642 = t4641 * t65;
  t4643 = t71 * t4642;
  t4645 = t1728 * t237;
  t4650 = t1614 * t396;
  t4651 = t71 * t4650;
  t4653 = t536 * t1002;
  t4658 = t401 * t1624;
  t4662 = -t3944 + t4413 + t1008 * t537 / 0.32e2 + t4635 / 0.32e2 + t401 * t1618 / 0.32e2 - t242 * t1729 / 0.12e2 - t4643 / 0.12e2 - t71 * t4645 / 0.12e2 + t242 * t1732 / 0.32e2 + t4651 / 0.32e2 + t71 * t4653 / 0.32e2 + t1008 * t541 / 0.576e3 + t4658 / 0.576e3 + t401 * t1627 / 0.576e3;
  t4665 = t264 * t407;
  t4666 = t4665 * t101;
  t4667 = t71 * t4666;
  t4669 = t1737 * t276;
  t4674 = t1623 * t426;
  t4675 = t71 * t4674;
  t4677 = t540 * t1060;
  t4686 = t1083 * t85;
  t4691 = t287 * t407;
  t4703 = -t242 * t1738 / 0.216e3 - t4667 / 0.216e3 - t71 * t4669 / 0.216e3 + t242 * t1741 / 0.576e3 + t4675 / 0.576e3 + t71 * t4677 / 0.576e3 + t4239 / 0.32e2 + t4246 + t4248 / 0.32e2 + t4255 / 0.576e3 + t4262 + t4264 / 0.576e3 + t4460 - t4461 - t70 * (-0.16e2 / 0.9e1 * t1091 + 0.2e1 / 0.3e1 * t1096 - t4686 * t65 / 0.4e1 - t1746 * t237 / 0.4e1 + 0.2e1 / 0.3e1 * t4691 * t65 + 0.2e1 / 0.3e1 * t1749 * t237 - t1631 * t396 / 0.4e1 - t545 * t1002 / 0.4e1) / 0.8e1;
  t4704 = t4662 + t4703;
  t4705 = t24 * t4704;
  t4707 = t1137 * t559;
  t4708 = t317 * t4707;
  t4709 = t315 * t4708;
  t4711 = t379 * t559;
  t4712 = t4711 * params->d;
  t4714 = t325 * t326 * t4712;
  t4716 = t318 * t1775;
  t4717 = t317 * t4716;
  t4718 = t315 * t4717;
  t4720 = t12 * t1775;
  t4721 = t4720 * params->d;
  t4723 = t325 * t326 * t4721;
  t4728 = t21 * t4705 + t4285 + t4709 / 0.18e2 + t4714 / 0.18e2 + t4718 / 0.18e2 + t4723 / 0.18e2 + t4289 / 0.18e2 + t4294 + t4297 + t4300 / 0.18e2 + t4304 / 0.18e2;
  t4734 = t4307 + t4310 - t4312 - t4315 + t4319 / 0.18e2 + t4324 - t4341 / 0.18e2 - t4345 / 0.18e2 + t4358 + t4362 + t4364 / 0.9e1 + t4367 / 0.9e1;
  t4746 = t364 * t407;
  t4753 = t70 * t1002;
  t4756 = t4031 + 0.7e1 / 0.18e2 * t1170 - 0.7e1 / 0.48e2 * t1175 - t587 * t152 / 0.24e2 + t1766 * t1666 / 0.8e1 - t4746 * t556 / 0.3e1 - t1769 * t1666 / 0.3e1 + t1663 * t1772 / 0.8e1 + t555 * t4753 / 0.8e1;
  t4762 = t334 * t336 * t4716;
  t4773 = t334 * t336 * t4707;
  t4777 = t130 * t137 * t340 * t1775;
  t4781 = t130 * t137 * t1187 * t559;
  t4783 = t4371 - t4374 + t4378 + t130 * t137 * t345 * t1775 / 0.6e1 + t130 * t137 * t138 * t4756 / 0.6e1 + t4762 / 0.9e1 + t130 * t137 * t1197 * t559 / 0.6e1 + t130 * t137 * t462 * t1669 / 0.6e1 + t4773 / 0.9e1 - t4777 / 0.18e2 - t4781 / 0.18e2;
  t4786 = t16 * t1757;
  t4788 = t195 * t196 * t4786;
  t4790 = t184 * t1757;
  t4792 = t201 * t4790 * t203;
  t4796 = t190 * t191 * t1758;
  t4798 = -t4381 - t4384 + t4387 / 0.3e1 + t4391 + t4394 / 0.3e1 + t4399 + t4788 / 0.3e1 + t4792 / 0.3e1 - t4402 + 0.2e1 / 0.3e1 * t4404 + t4408 + 0.2e1 / 0.3e1 * t4796;
  t4800 = t4728 + t4734 + t4783 + t4798;
  tv3rho2sigma5 = t161 * t4800 + t4235 + t4632;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 5] += tv3rho2sigma5;

  t4803 = 0.16e2 / 0.3e1 * t4459;
  t4804 = t29 * t1402;
  t4811 = t495 * t1283;
  t4820 = t499 * t1382;
  t4824 = t1431 * t78;
  t4834 = -t3944 + t4803 - t4804 + t1365 * t496 / 0.32e2 + t4416 / 0.16e2 + t401 * t1679 / 0.16e2 + t3890 + t4423 / 0.16e2 + t71 * t4811 / 0.32e2 + t1365 * t500 / 0.576e3 + t4430 / 0.288e3 + t401 * t1684 / 0.288e3 + t3909 + t4437 / 0.288e3 + t71 * t4820 / 0.576e3 - t70 * (0.2e1 / 0.3e1 * t1437 - t4824 * t58 / 0.4e1 - t1688 * t392 / 0.2e1 - t504 * t1283 / 0.4e1) / 0.8e1;
  t4835 = t24 * t4834;
  t4850 = t1305 * t78;
  t4855 = t70 * t1283;
  t4858 = t4031 - 0.7e1 / 0.48e2 * t1311 + t4850 * t516 / 0.8e1 + t1704 * t1707 / 0.4e1 + t515 * t4855 / 0.8e1;
  t4863 = t21 * t4835 + t3951 + t4488 / 0.9e1 + t4492 / 0.9e1 + t4497 / 0.9e1 + t4501 / 0.9e1 + t130 * t137 * t1265 * t519 / 0.6e1 + t130 * t137 * t462 * t1710 / 0.3e1 + t130 * t137 * t138 * t4858 / 0.6e1 + t3965 - t3967 - t3970 + t3973 + t3983 + t3986 + t3990 - t3993;
  t4871 = t3997 + t4000 + t4004 + t4014 + 0.2e1 / 0.9e1 * t4515 + 0.2e1 / 0.9e1 * t4526 - t4555 / 0.9e1 - t4559 / 0.9e1 - t4058 - t4061 + t4068 + t4076 + 0.2e1 / 0.3e1 * t4566 + 0.2e1 / 0.3e1 * t4570 - t4079 + t4085 + 0.4e1 / 0.3e1 * t4574;
  t4872 = t4863 + t4871;
  tv3rho2sigma6 = t161 * t4872 + 0.2e1 * t4412;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 6] += tv3rho2sigma6;

  t4881 = -t4100 + t4107 - t4112 + 0.32e2 / 0.3e1 * t4586 - 0.2e1 * t201 * t525 * t1402 + t4118 - t4123 - t4128 - t4133 - t4138 + t4146 + t4154 + t4164 + 0.7e1 / 0.27e2 * t4592 + 0.7e1 / 0.27e2 * t4597;
  t4891 = t4168 + t4172 - t4179 - t4188 - 0.4e1 / 0.3e1 * t4604 - 0.4e1 / 0.3e1 * t4608 - t4193 + t4198 + t4202 - t4211 + t4223 - 0.7e1 / 0.3e1 * t4615 - 0.8e1 / 0.3e1 * t4619 + 0.14e2 / 0.27e2 * t4627 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t1264;
  t4892 = t4881 + t4891;
  tv3rho2sigma7 = t161 * t4892 + 0.2e1 * t4580;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 7] += tv3rho2sigma7;

  t4902 = t1314 * t85;
  t4905 = t476 * t407;
  t4910 = t149 * t1287;
  t4915 = t70 * t1300;
  t4918 = t4031 - 0.77e2 / 0.54e2 * t1323 + 0.7e1 / 0.9e1 * t1326 - 0.7e1 / 0.48e2 * t1329 + t4902 * t556 / 0.8e1 - 0.2e1 / 0.3e1 * t4905 * t556 + t1766 * t1772 / 0.4e1 + 0.11e2 / 0.9e1 * t4910 * t556 - 0.2e1 / 0.3e1 * t1769 * t1772 + t555 * t4915 / 0.8e1;
  t4940 = t1411 * t85;
  t4943 = t437 * t407;
  t4948 = t109 * t1287;
  t4960 = t73 * t1287;
  t4961 = t4960 * t65;
  t4964 = t4246 + t4262 + t4635 / 0.16e2 - t4643 / 0.6e1 + t4651 / 0.16e2 + t4658 / 0.288e3 - t4667 / 0.108e3 + t4675 / 0.288e3 - t4804 - t70 * (0.176e3 / 0.27e2 * t1419 - 0.32e2 / 0.9e1 * t1422 + 0.2e1 / 0.3e1 * t1425 - t4940 * t65 / 0.4e1 + 0.4e1 / 0.3e1 * t4943 * t65 - t1746 * t396 / 0.2e1 - 0.22e2 / 0.9e1 * t4948 * t65 + 0.4e1 / 0.3e1 * t1749 * t396 - t545 * t1300 / 0.4e1) / 0.8e1 - t401 * t1729 / 0.6e1 + 0.11e2 / 0.36e2 * t71 * t4961;
  t4967 = t92 * t1287;
  t4968 = t4967 * t101;
  t4975 = t1728 * t396;
  t4978 = t536 * t1300;
  t4985 = t1737 * t426;
  t4988 = t540 * t1393;
  t4991 = -t401 * t1738 / 0.108e3 + 0.11e2 / 0.648e3 * t71 * t4968 + t1365 * t537 / 0.32e2 + t401 * t1732 / 0.16e2 - t71 * t4975 / 0.6e1 + t71 * t4978 / 0.32e2 + t1365 * t541 / 0.576e3 + t401 * t1741 / 0.288e3 - t71 * t4985 / 0.108e3 + t71 * t4988 / 0.576e3 - t3944 + t4803;
  t4992 = t4964 + t4991;
  t4993 = t24 * t4992;
  t4995 = t4285 + t4709 / 0.9e1 + t4714 / 0.9e1 + t4718 / 0.9e1 + t4723 / 0.9e1 + t130 * t137 * t138 * t4918 / 0.6e1 + t130 * t137 * t1265 * t559 / 0.6e1 + t130 * t137 * t462 * t1775 / 0.3e1 + t4294 + t4297 + t4307 + t4310 - t4312 - t4315 + t21 * t4993 + t4324 + t4358;
  t5003 = t4362 + t4371 - t4374 + t4378 + 0.2e1 / 0.9e1 * t4762 + 0.2e1 / 0.9e1 * t4773 - t4777 / 0.9e1 - t4781 / 0.9e1 - t4381 - t4384 + t4391 + t4399 + 0.2e1 / 0.3e1 * t4788 + 0.2e1 / 0.3e1 * t4792 - t4402 + t4408 + 0.4e1 / 0.3e1 * t4796;
  t5004 = t4995 + t5003;
  tv3rho2sigma8 = t161 * t5004 + 0.2e1 * t4632;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 8] += tv3rho2sigma8;

  tv3rhosigma20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3rhosigma21 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 1] += tv3rhosigma21;

  tv3rhosigma22 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 2] += tv3rhosigma22;

  tv3rhosigma23 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 3] += tv3rhosigma23;

  tv3rhosigma24 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 4] += tv3rhosigma24;

  tv3rhosigma25 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 5] += tv3rhosigma25;

  tv3rhosigma26 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 6] += tv3rhosigma26;

  tv3rhosigma27 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 7] += tv3rhosigma27;

  tv3rhosigma28 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 8] += tv3rhosigma28;

  tv3rhosigma29 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 9] += tv3rhosigma29;

  tv3rhosigma210 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 10] += tv3rhosigma210;

  tv3rhosigma211 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 11] += tv3rhosigma211;

  tv3sigma30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  tv3sigma31 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 1] += tv3sigma31;

  tv3sigma32 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 2] += tv3sigma32;

  tv3sigma33 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 3] += tv3sigma33;

  tv3sigma34 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 4] += tv3sigma34;

  tv3sigma35 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 5] += tv3sigma35;

  tv3sigma36 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 6] += tv3sigma36;

  tv3sigma37 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 7] += tv3sigma37;

  tv3sigma38 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 8] += tv3sigma38;

  tv3sigma39 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 9] += tv3sigma39;

  t5006 = params->a * t2478;
  t5008 = 0.72e2 * t589;
  t5009 = t7 * t1788;
  t5010 = 0.192e3 * t5009;
  t5011 = t8 * t4114;
  t5012 = 0.12e3 * t5011;
  t5013 = -t5008 + t5010 - t5012;
  t5016 = t972 * t569;
  t5018 = t181 * t2255;
  t5020 = t181 * t2258;
  t5024 = 0.32e3 / 0.81e2 * t13 * t576 * t582;
  t5027 = 0.28e3 / 0.81e2 * t13 * t185 * t1570;
  t5028 = t2446 * t856;
  t5032 = 0.116e3 / 0.243e3 * t860 * t2358 * t320;
  t5034 = 0.548e3 / 0.243e3 * t4121 * t875;
  t5036 = t918 * t1996 * t912;
  t5041 = 0.8e1 / 0.3e1 * t2021 * t1935 * t165 * t171;
  t5043 = t195 * t870 * t936;
  t5047 = 0.16e3 / 0.81e2 * t940 * t2412 * t197;
  t5048 = -t6 * t5013 * t16 + 0.8e1 / 0.3e1 * t5016 + 0.32e2 / 0.9e1 * t5018 - 0.112e3 / 0.27e2 * t5020 - t5024 + t5027 + 0.104e3 / 0.81e2 * t5028 + t5032 + t5034 + 0.208e3 / 0.27e2 * t5036 + t5041 + 0.112e3 / 0.27e2 * t5043 + t5047;
  t5050 = t201 * t944 * t2007;
  t5055 = 0.32e3 / 0.81e2 * t201 * t948 * t213 * t582;
  t5058 = t167 * t170 * t1791 * t16;
  t5061 = t918 * t919 * t2011;
  t5064 = t2021 * t2022 * t912;
  t5072 = 0.16e2 / 0.81e2 * t127 * t2018 * t916 * t1825 * t4218 * t165 * t171;
  t5075 = t195 * t196 * t16 * t2250;
  t5078 = t940 * t907 * t2026;
  t5082 = t201 * t184 * t2250 * t203;
  t5086 = t201 * t575 * t747 * t949;
  t5089 = t940 * t2267 * t936;
  t5093 = 0.8e1 / 0.27e2 * t2282 * t2357 * t197;
  t5095 = t201 * t2286 * t2274;
  t5100 = 0.16e2 / 0.9e1 * t201 * t2290 * t627 * t1788;
  t5101 = 0.112e3 / 0.27e2 * t5050 + t5055 - 0.8e1 / 0.3e1 * t5058 - 0.8e1 / 0.3e1 * t5061 - 0.32e2 / 0.27e2 * t5064 - t5072 + 0.4e1 / 0.3e1 * t5075 + 0.2e1 / 0.3e1 * t5078 + 0.4e1 / 0.3e1 * t5082 + 0.4e1 / 0.3e1 * t5086 - 0.16e2 / 0.9e1 * t5089 - t5093 - 0.32e2 / 0.9e1 * t5095 - t5100;
  t5104 = t2282 * t1552 * t936;
  t5106 = t859 * t859;
  t5110 = t21 * t5106 * t4119 * t197 / 0.81e2;
  t5113 = t201 * t2064 * t309 * t2291;
  t5116 = 0.1e1 / t2063 / t15;
  t5121 = 0.8e1 / 0.27e2 * t201 * t5116 * t122 * t2075 * t1827;
  t5123 = t167 * t2000 * t912;
  t5128 = 0.736e3 / 0.81e2 * t918 * t1788 * t165 * t171;
  t5132 = 0.56e3 / 0.81e2 * t167 * params->omega * t1570 * t171;
  t5135 = 0.28e3 / 0.81e2 * t195 * t1571 * t197;
  t5139 = 0.28e3 / 0.81e2 * t201 * t202 * params->d * t1570;
  t5141 = t195 * t928 * t2026;
  t5144 = t201 * t2029 * t932;
  t5147 = t167 * t923 * t2011;
  t5149 = t312 * t1935;
  t5152 = 0.2e2 / 0.27e2 * t5149 * t954 * t2057;
  t5154 = t2055 * t2056 * t879;
  t5156 = 0.4e1 / 0.27e2 * t5104 + t5110 + 0.8e1 / 0.9e1 * t5113 + t5121 - 0.224e3 / 0.27e2 * t5123 - t5128 + t5132 - t5135 - t5139 - 0.8e1 / 0.3e1 * t5141 - 0.8e1 / 0.3e1 * t5144 + 0.16e2 / 0.3e1 * t5147 - t5152 + 0.8e1 / 0.27e2 * t5154;
  t5158 = t2055 * t2056 * t884;
  t5165 = 0.8e1 / 0.81e2 * t312 * t4218 * t954 * t4216 * t136 * t328;
  t5167 = t955 * t956 * t2384;
  t5170 = t955 * t956 * t2392;
  t5172 = t2034 * t2037;
  t5174 = t2034 * t2040;
  t5179 = 0.14e2 / 0.81e2 * t860 * t1827 * t954 * t957;
  t5183 = 0.2e1 / 0.81e2 * t860 * t1935 * t2049 * t2051;
  t5187 = 0.28e2 / 0.81e2 * t312 * t1827 * t2049 * t2051;
  t5191 = 0.232e3 / 0.243e3 * t312 * t1788 * t954 * t957;
  t5193 = t2050 * t956 * t2422;
  t5195 = t23 * t2064;
  t5200 = 0.4e1 / 0.81e2 * t5149 * t5195 * t127 * t956 * t2430;
  t5205 = 0.8e1 / 0.81e2 * t312 * t4114 * t2049 * t2056 * t892;
  t5209 = 0.4e1 / 0.81e2 * t860 * t4114 * t954 * t2057;
  t5210 = 0.8e1 / 0.27e2 * t5158 + t5165 + 0.2e1 / 0.9e1 * t5167 + 0.4e1 / 0.9e1 * t5170 - 0.2e2 / 0.27e2 * t5172 - 0.2e2 / 0.27e2 * t5174 - t5179 + t5183 - t5187 + t5191 + 0.4e1 / 0.27e2 * t5193 + t5200 + t5205 + t5209;
  t5214 = t2050 * t956 * t2418;
  t5216 = t2044 * t2037;
  t5218 = t2044 * t2040;
  t5223 = 0.2e1 / 0.243e3 * t2408 * t1935 * t954 * t957;
  t5225 = t955 * t956 * t2400;
  t5228 = t1795 * t2341 * t1974;
  t5233 = 0.8e1 / 0.27e2 * t4130 * t860 * t23 * t772;
  t5236 = 0.16e2 / 0.27e2 * t4130 * t2341 * t1799;
  t5237 = t2446 * t853;
  t5240 = t2368 * t2370 * t884;
  t5243 = 0.1e1 / t27 / t4113;
  t5244 = t5243 * t23;
  t5245 = t5244 * t16;
  t5247 = t127 * t1822;
  t5251 = 0.16e2 / 0.243e3 * t312 * t5245 * t5247 * t1825 * t319;
  t5258 = 0.16e2 / 0.243e3 * t125 * t323 * t1822 * t1825 * t5243 * t136 * t328;
  t5260 = t872 * t874 * t1808;
  t5263 = t897 * t899 * t2392;
  t5265 = 0.4e1 / 0.27e2 * t5214 + 0.2e1 / 0.27e2 * t5216 + 0.2e1 / 0.27e2 * t5218 + t5223 + 0.2e1 / 0.9e1 * t5225 + 0.16e2 / 0.9e1 * t5228 + t5233 + t5236 + 0.104e3 / 0.81e2 * t5237 + 0.8e1 / 0.27e2 * t5240 + t5251 + t5258 + 0.8e1 / 0.9e1 * t5260 + 0.8e1 / 0.9e1 * t5263;
  t5267 = t2359 * t2361 * t777;
  t5270 = t2368 * t2370 * t879;
  t5273 = t872 * t874 * t1804;
  t5276 = t897 * t899 * t2384;
  t5278 = t4207 * t136;
  t5279 = t873 * t5278;
  t5281 = 0.16e2 / 0.27e2 * t5279 * t2342;
  t5283 = t189 * t18 * t1788;
  t5285 = 0.32e2 / 0.9e1 * t5283 * t2342;
  t5286 = t909 * t2396;
  t5289 = t325 * t903 * t2400;
  t5292 = t872 * t874 * t1815;
  t5295 = t897 * t899 * t2400;
  t5298 = t2359 * t2361 * t782;
  t5300 = t1803 * t371;
  t5302 = t315 * t317 * t5300;
  t5307 = t325 * t326 * t592 * t371 * params->d;
  t5309 = t776 * t844;
  t5311 = t315 * t317 * t5309;
  t5313 = 0.8e1 / 0.27e2 * t5267 + 0.8e1 / 0.27e2 * t5270 + 0.4e1 / 0.9e1 * t5273 + 0.4e1 / 0.9e1 * t5276 + t5281 - t5285 - 0.2e1 / 0.3e1 * t5286 - 0.2e1 / 0.3e1 * t5289 + 0.4e1 / 0.9e1 * t5292 + 0.4e1 / 0.9e1 * t5295 + 0.8e1 / 0.27e2 * t5298 + 0.2e1 / 0.3e1 * t5302 + 0.2e1 / 0.3e1 * t5307 + 0.2e1 / 0.3e1 * t5311;
  t5318 = t325 * t326 * t180 * t844 * params->d;
  t5320 = t909 * t2380;
  t5323 = t325 * t903 * t2384;
  t5325 = t909 * t2388;
  t5328 = t325 * t903 * t2392;
  t5331 = t136 * t1791 * t155;
  t5333 = t315 * t317 * t5331;
  t5338 = t325 * t326 * t1791 * t155 * params->d;
  t5341 = 0.1e2 / 0.27e2 * t4144 * t875;
  t5342 = t318 * t1938;
  t5344 = t315 * t317 * t5342;
  t5349 = t325 * t326 * t12 * t1938 * params->d;
  t5351 = t2336 * t853;
  t5353 = t1573 * t2345;
  t5356 = t325 * t2441 * t879;
  t5359 = t2435 * t2437 * t2422;
  t5361 = 0.2e1 / 0.3e1 * t5318 - 0.2e1 / 0.3e1 * t5320 - 0.2e1 / 0.3e1 * t5323 - 0.4e1 / 0.3e1 * t5325 - 0.4e1 / 0.3e1 * t5328 + 0.2e1 / 0.9e1 * t5333 + 0.2e1 / 0.9e1 * t5338 - t5341 + 0.2e1 / 0.9e1 * t5344 + 0.2e1 / 0.9e1 * t5349 - 0.1e2 / 0.27e2 * t5351 - 0.44e2 / 0.27e2 * t5353 + 0.104e3 / 0.81e2 * t5356 + 0.8e1 / 0.27e2 * t5359;
  t5362 = t791 * t4114;
  t5363 = t5362 * t136;
  t5366 = 0.64e2 / 0.81e2 * t2368 * t5363 * t328;
  t5367 = t4218 * t23;
  t5368 = t5367 * t16;
  t5371 = 0.4e1 / 0.81e2 * t860 * t5368 * t2362;
  t5373 = t897 * t1979 * t884;
  t5375 = t2414 * t2351;
  t5378 = t897 * t1979 * t879;
  t5380 = t2414 * t2345;
  t5383 = t2435 * t2437 * t2418;
  t5386 = 0.64e2 / 0.81e2 * t4149 * t2362;
  t5387 = t2336 * t856;
  t5389 = t1573 * t2351;
  t5393 = 0.14e2 / 0.243e3 * t2408 * t4120 * t320;
  t5396 = t2428 * t2429 * t878 * t627;
  t5400 = t2428 * t2429 * t883 * t627;
  t5405 = params->b * t5106 * t4143 * t320 / 0.486e3;
  t5406 = -t5366 + t5371 - 0.44e2 / 0.27e2 * t5373 + 0.4e1 / 0.27e2 * t5375 - 0.44e2 / 0.27e2 * t5378 + 0.4e1 / 0.27e2 * t5380 + 0.8e1 / 0.27e2 * t5383 - t5386 - 0.1e2 / 0.27e2 * t5387 - 0.44e2 / 0.27e2 * t5389 - t5393 + 0.4e1 / 0.27e2 * t5396 + 0.4e1 / 0.27e2 * t5400 + t5405;
  t5412 = 0.4e1 / 0.243e3 * t2408 * t4148 * t875;
  t5413 = t2409 * t853;
  t5415 = t2409 * t856;
  t5417 = t863 * t2396;
  t5421 = t890 * t891 * t2399 * t213;
  t5423 = t863 * t2388;
  t5427 = t890 * t891 * t2391 * t213;
  t5429 = t863 * t2380;
  t5433 = t890 * t891 * t2383 * t213;
  t5436 = t890 * t2449 * t2418;
  t5439 = t325 * t2441 * t884;
  t5442 = t890 * t2449 * t2422;
  t5450 = 0.8e1 / 0.81e2 * t125 * t888 * t787 * t791 * t4218 * t136 * t892;
  t5454 = 0.28e2 / 0.81e2 * t2428 * t137 * t1827 * t2430;
  t5455 = t5412 + 0.2e1 / 0.81e2 * t5413 + 0.2e1 / 0.81e2 * t5415 + t5417 / 0.9e1 + 0.2e1 / 0.9e1 * t5421 + 0.2e1 / 0.9e1 * t5423 + 0.4e1 / 0.9e1 * t5427 + t5429 / 0.9e1 + 0.2e1 / 0.9e1 * t5433 - 0.2e2 / 0.27e2 * t5436 + 0.104e3 / 0.81e2 * t5439 - 0.2e2 / 0.27e2 * t5442 + t5450 - t5454;
  t5458 = 0.2e2 / 0.27e2 * t2435 * t5278 * t892;
  t5461 = 0.1e3 / 0.81e2 * t312 * t2413 * t320;
  t5465 = 0.1e3 / 0.81e2 * t325 * t137 * t582 * t328;
  t5469 = 0.232e3 / 0.243e3 * t890 * t137 * t1788 * t892;
  t5477 = 0.4e1 / 0.81e2 * t125 * t5116 * t127 * params->m2 * t137 * t1935 * t327 * t2075;
  t5483 = 0.8e1 / 0.81e2 * t125 * t2426 * t332 * t4115 * t136 * t2430;
  t5484 = t335 * t1827;
  t5485 = t5484 * t136;
  t5488 = 0.548e3 / 0.243e3 * t897 * t5485 * t328;
  t5491 = 0.16e2 / 0.9e1 * t13 * t2065 * t1788;
  t5492 = t1792 * t186;
  t5494 = t972 * t577;
  t5496 = t181 * t2066;
  t5501 = 0.8e1 / 0.27e2 * t13 * t5116 * t2075 * t1827;
  t5502 = t209 * t2088;
  t5506 = t1791 * t220;
  t5508 = t592 * t703;
  t5510 = t180 * t2085;
  t5514 = t2075 * params->d * t5116 * t1935;
  t5516 = t2076 * t1827;
  t5518 = t628 * t1788;
  t5520 = t214 * t582;
  t5522 = t32 * t1570;
  t5526 = t12 * (-0.56e2 / 0.27e2 * t5514 + 0.392e3 / 0.27e2 * t5516 - 0.3248e4 / 0.81e2 * t5518 + 0.14e4 / 0.27e2 * t5520 - 0.196e4 / 0.81e2 * t5522) / 0.72e2;
  t5529 = t1936 * t223;
  t5531 = t583 * t706;
  t5533 = t26 * t5243;
  t5535 = 0.20944e5 / 0.81e2 * t5533 * t38;
  t5538 = 0.1e1 / t76 / t642 / t74;
  t5539 = sigma[0] * t5538;
  t5540 = t5539 * t58;
  t5542 = t1922 * t232;
  t5544 = t645 * t607;
  t5546 = t252 * t1895;
  t5549 = 0.1e1 / t55 / t48;
  t5550 = t599 * t599;
  t5556 = t603 * t603;
  t5561 = -t589 + t5009;
  t5562 = 0.24e2 * t5561;
  t5566 = my_piecewise3(t49, 0, -0.8e2 / 0.81e2 * t5549 * t5550 + 0.16e3 / 0.9e1 * t1884 * t599 * t603 + 0.4e2 / 0.3e1 * t56 * t5556 + 0.16e3 / 0.9e1 * t1888 * t1891 + 0.8e1 / 0.3e1 * t228 * t5562);
  t5567 = t79 * t5566;
  t5570 = 0.1e1 / t62 / t59;
  t5571 = t608 * t608;
  t5577 = t611 * t611;
  t5582 = -t5562;
  t5586 = my_piecewise3(t60, 0, -0.8e2 / 0.81e2 * t5570 * t5571 + 0.16e3 / 0.9e1 * t1907 * t608 * t611 + 0.4e2 / 0.3e1 * t63 * t5577 + 0.16e3 / 0.9e1 * t1911 * t1914 + 0.8e1 / 0.3e1 * t233 * t5582);
  t5587 = t86 * t5586;
  t5605 = 0.41888e5 / 0.243e3 * t5540 - 0.9856e4 / 0.81e2 * t5542 + 0.352e3 / 0.9e1 * t5544 - 0.64e2 / 0.9e1 * t5546 + 0.2e1 / 0.3e1 * t5567 + 0.2e1 / 0.3e1 * t5587 - 0.44e2 / 0.3e1 * t728 * t735 + 0.1232e4 / 0.27e2 * t297 * t2101 - 0.5236e4 / 0.81e2 * t115 * t5538 * t58 + 0.8e1 / 0.3e1 * t2130 * t300 + 0.8e1 * t728 * t738 - 0.88e2 / 0.3e1 * t297 * t2139 + 0.1232e4 / 0.27e2 * t115 * t1864 * t232;
  t5612 = my_piecewise3(t49, 0, 0.8e1 * t1891 * t229 + 0.2e1 * t48 * t5562 + 0.6e1 * t5556);
  t5629 = my_piecewise3(t60, 0, 0.8e1 * t1914 * t234 + 0.2e1 * t5582 * t59 + 0.6e1 * t5577);
  t5648 = -t5612 * sigma[2] * t111 / 0.4e1 - t2114 * t291 - 0.3e1 / 0.2e1 * t716 * t721 - t288 * t2121 - t110 * t85 * t5586 / 0.4e1 - t5629 * sigma[0] * t116 / 0.4e1 - t2130 * t303 - 0.3e1 / 0.2e1 * t728 * t741 + 0.8e1 * t297 * t2142 - t297 * t2145 - 0.44e2 / 0.3e1 * t115 * t644 * t607 + 0.8e1 / 0.3e1 * t115 * t251 * t1895 - t115 * t78 * t5566 / 0.4e1;
  t5652 = t242 * t2154;
  t5664 = t71 * (0.8e1 / 0.27e2 * t5514 - 0.56e2 / 0.27e2 * t5516 + 0.464e3 / 0.81e2 * t5518 - 0.2e3 / 0.27e2 * t5520 + 0.28e3 / 0.81e2 * t5522) * t103 / 0.576e3;
  t5666 = t71 * t2230 * t278;
  t5669 = t71 * t665 * t690;
  t5672 = t71 * t264 * t2181;
  t5693 = my_piecewise3(t49, 0, 0.88e3 / 0.81e2 * t1884 * t5550 + 0.88e3 / 0.9e1 * t600 * t603 + 0.88e2 / 0.3e1 * t228 * t5556 + 0.352e3 / 0.9e1 * t230 * t1891 + 0.11e2 / 0.3e1 * t57 * t5562);
  t5706 = my_piecewise3(t60, 0, 0.88e3 / 0.81e2 * t1907 * t5571 + 0.88e3 / 0.9e1 * t609 * t611 + 0.88e2 / 0.3e1 * t233 * t5577 + 0.352e3 / 0.9e1 * t235 * t1914 + 0.11e2 / 0.3e1 * t64 * t5582);
  t5712 = t2213 * t265;
  t5716 = t620 * t666;
  t5718 = t620 * t669;
  t5722 = t242 * t2231;
  t5724 = t242 * t2151;
  t5726 = 0.32e2 / 0.3e1 * t5502 - t30 * (t5013 * t35 / 0.72e2 + t5506 / 0.18e2 + t5508 / 0.12e2 + t5510 / 0.18e2 + t5526) + 0.4928e4 / 0.27e2 * t5529 - 0.176e3 / 0.3e1 * t5531 - t5535 - t70 * (t5605 + t5648) / 0.8e1 + t5652 / 0.48e2 + t242 * t2182 / 0.144e3 + t5664 + t5666 / 0.144e3 + t5669 / 0.96e2 + t5672 / 0.144e3 + t71 * t92 * (0.20944e5 / 0.81e2 * t5539 * t97 - 0.4928e4 / 0.27e2 * t1922 * t272 + 0.176e3 / 0.3e1 * t645 * t681 - 0.32e2 / 0.3e1 * t252 * t2170 + t79 * t5693 + t86 * t5706) / 0.576e3 + t5712 / 0.144e3 + t2213 * t279 / 0.144e3 + t5716 / 0.96e2 + t5718 / 0.48e2 + t620 * t691 / 0.96e2 + t5722 / 0.144e3 + t5724 / 0.48e2;
  t5727 = t242 * t2207;
  t5739 = t71 * (-0.4e1 / 0.243e3 * t5514 + 0.28e2 / 0.243e3 * t5516 - 0.232e3 / 0.729e3 * t5518 + 0.1e3 / 0.243e3 * t5520 - 0.14e3 / 0.729e3 * t5522) * t88 / 0.32e2;
  t5741 = t71 * t2199 * t257;
  t5744 = t71 * t635 * t652;
  t5747 = t71 * t245 * t1931;
  t5753 = 0.20944e5 / 0.81e2 * t5540 - 0.4928e4 / 0.27e2 * t5542 + 0.176e3 / 0.3e1 * t5544 - 0.32e2 / 0.3e1 * t5546 + t5567 + t5587;
  t5757 = t70 * t5013;
  t5762 = t2213 * t246;
  t5767 = t620 * t636;
  t5769 = t620 * t639;
  t5773 = t242 * t2200;
  t5775 = t242 * t2204;
  t5793 = t2213 * t258 / 0.8e1 + 0.3e1 / 0.16e2 * t5767 + 0.3e1 / 0.8e1 * t5769 + 0.3e1 / 0.16e2 * t620 * t653 + t5773 / 0.8e1 + 0.3e1 / 0.8e1 * t5775 - 0.3e1 / 0.2e2 * t45 * t5013 * t66 - 0.3e1 / 0.5e1 * t45 * t1791 * t238 - 0.9e1 / 0.1e2 * t45 * t592 * t616 - 0.3e1 / 0.5e1 * t45 * t180 * t2243 - 0.3e1 / 0.2e2 * t45 * t12 * (t5566 + t5586);
  t5798 = t1988 * t1971;
  t5800 = -t5458 - t5461 - t5465 + t5469 + t5477 + t5483 + t5488 + t5491 - 0.4e1 / 0.3e1 * t5492 - 0.4e1 / 0.3e1 * t5494 - 0.8e1 / 0.9e1 * t5496 - t5501 + t21 * t24 * (t5726 + 0.3e1 / 0.8e1 * t5727 + t242 * t2210 / 0.8e1 + t5739 + t5741 / 0.8e1 + 0.3e1 / 0.16e2 * t5744 + t5747 / 0.8e1 + t71 * t73 * t5753 / 0.32e2 + t5757 * t104 / 0.576e3 + t5757 * t89 / 0.32e2 + t5762 / 0.8e1 + t5793) - 0.64e2 / 0.9e1 * t5798;
  t5802 = t1988 * t1975;
  t5805 = t768 * t312 * t748;
  t5807 = t1980 * t1971;
  t5810 = t1795 * t860 * t310;
  t5814 = t768 * t125 * t2029 * params->d;
  t5816 = t1980 * t1975;
  t5820 = t1795 * t125 * t2286 * t213;
  t5823 = t189 * t18 * t582;
  t5825 = 0.64e3 / 0.81e2 * t5823 * t769;
  t5827 = 0.64e3 / 0.81e2 * t5823 * t773;
  t5831 = t130 * t137 * t568 * t592 * t155;
  t5835 = t130 * t137 * t1953 * t371;
  t5839 = t130 * t137 * t762 * t844;
  t5842 = t334 * t849 * t1815;
  t5845 = t789 * t1949 * t782;
  t5847 = -0.64e2 / 0.9e1 * t5802 + 0.8e1 / 0.3e1 * t5805 + 0.16e2 / 0.9e1 * t5807 + 0.8e1 / 0.9e1 * t5810 + 0.8e1 / 0.3e1 * t5814 + 0.16e2 / 0.9e1 * t5816 + 0.16e2 / 0.9e1 * t5820 + t5825 + t5827 + 0.4e1 / 0.9e1 * t5831 + 0.8e1 / 0.9e1 * t5835 + 0.4e1 / 0.9e1 * t5839 - 0.14e2 / 0.9e1 * t5842 - 0.16e2 / 0.9e1 * t5845;
  t5848 = t1825 * t4218;
  t5851 = 0.136e3 / 0.243e3 * t1824 * t5848 * t319;
  t5853 = t334 * t849 * t1808;
  t5856 = t789 * t1949 * t777;
  t5859 = t334 * t849 * t1804;
  t5864 = t130 * t137 * t169 * t1791 * t155;
  t5868 = t130 * t137 * t1832 * t371;
  t5871 = t334 * t336 * t5331;
  t5874 = t334 * t336 * t5300;
  t5877 = t789 * t792 * t1804;
  t5880 = t334 * t336 * t5309;
  t5883 = t789 * t792 * t1808;
  t5886 = t1824 * t1828 * t777;
  t5889 = t334 * t336 * t5342;
  t5893 = 0.8e1 / 0.81e2 * t4130 * t2408 * t123;
  t5894 = -t5851 - 0.28e2 / 0.9e1 * t5853 - 0.16e2 / 0.9e1 * t5856 - 0.14e2 / 0.9e1 * t5859 - 0.2e1 / 0.9e1 * t5864 - 0.2e1 / 0.3e1 * t5868 + 0.4e1 / 0.9e1 * t5871 + 0.4e1 / 0.3e1 * t5874 + 0.4e1 / 0.9e1 * t5877 + 0.4e1 / 0.3e1 * t5880 + 0.8e1 / 0.9e1 * t5883 + 0.16e2 / 0.81e2 * t5886 + 0.4e1 / 0.9e1 * t5889 + t5893;
  t5900 = 0.16e2 / 0.27e2 * t4130 * t125 * t2290 * t627;
  t5902 = 0.16e2 / 0.9e1 * t5283 * t1796;
  t5904 = 0.32e2 / 0.9e1 * t5283 * t1800;
  t5905 = t873 * t5485;
  t5907 = 0.304e3 / 0.81e2 * t5905 * t769;
  t5909 = 0.304e3 / 0.81e2 * t5905 * t773;
  t5910 = t2360 * t5363;
  t5912 = 0.32e2 / 0.81e2 * t5910 * t769;
  t5914 = 0.8e1 / 0.27e2 * t5279 * t1796;
  t5916 = 0.32e2 / 0.81e2 * t5910 * t773;
  t5918 = 0.16e2 / 0.27e2 * t5279 * t1800;
  t5919 = t335 * t1788;
  t5922 = 0.832e3 / 0.243e3 * t334 * t5919 * t319;
  t5926 = 0.14e3 / 0.243e3 * t130 * t137 * t1578 * t155;
  t5929 = t130 * t137 * t1966 * t371;
  t5934 = t130 * t137 * t869 * t180 * t155;
  t5936 = t791 * t1935;
  t5939 = 0.638e3 / 0.243e3 * t789 * t5936 * t319;
  t5940 = t5900 - t5902 - t5904 - t5907 - t5909 + t5912 + t5914 + t5916 + t5918 - t5922 + t5926 - 0.56e2 / 0.81e2 * t5929 - 0.56e2 / 0.81e2 * t5934 + t5939;
  t5942 = t334 * t1962 * t782;
  t5945 = t334 * t1962 * t777;
  t5951 = -0.4e1 * t5561;
  t5977 = t144 * t145 * t5566 / 0.8e1 + t5951 * sigma[2] * t152 / 0.8e1 + t1900 * t368 / 0.2e1 + 0.3e1 / 0.4e1 * t836 * t841 + t365 * t1919 / 0.2e1 + t150 * t151 * t5586 / 0.8e1 - 0.4e1 / 0.3e1 * t1870 * t358 - 0.4e1 * t818 * t829 + 0.44e2 / 0.3e1 * t354 * t1879 - 0.616e3 / 0.27e2 * t144 * t1865 * t232 - t5951 * sigma[0] * t146 / 0.8e1;
  t5994 = 0.73304e5 / 0.243e3 * t5533;
  t6003 = t1870 * t361 / 0.2e1 + 0.3e1 / 0.4e1 * t818 * t832 - 0.4e1 * t354 * t1882 + t354 * t1896 / 0.2e1 + 0.22e2 / 0.3e1 * t144 * t825 * t607 - 0.4e1 / 0.3e1 * t144 * t357 * t1895 - 0.7e1 / 0.48e2 * t70 * t5753 + t5994 + 0.22e2 / 0.3e1 * t818 * t826 - 0.616e3 / 0.27e2 * t354 * t1866 + 0.2618e4 / 0.81e2 * t144 * t5538 * t70 * t58;
  t6027 = t130 * t137 * t796 * t844;
  t6031 = t130 * t137 * t340 * t1938;
  t6034 = t789 * t792 * t1815;
  t6037 = t1824 * t1828 * t782;
  t6039 = t786 * t786;
  t6043 = t790 * t790;
  t6045 = t580 * t176;
  t6046 = 0.1e1 / t6045;
  t6050 = 0.8e1 / 0.243e3 * t125 * t128 * t6039 * params->m2 * t6043 * params->omega * t6046 * t319;
  t6053 = t750 * t208 * t180 * t185;
  t6057 = t750 * t29 * t592 * t185;
  t6059 = 0.268e3 / 0.81e2 * t5942 + 0.268e3 / 0.81e2 * t5945 + t130 * t137 * t138 * (t5977 + t6003) / 0.6e1 + t130 * t137 * t4 * t5013 * t155 / 0.6e1 + 0.2e1 / 0.3e1 * t130 * t137 * t1845 * t371 + t130 * t137 * t805 * t844 + 0.2e1 / 0.3e1 * t130 * t137 * t345 * t1938 - 0.2e1 / 0.3e1 * t6027 - 0.2e1 / 0.9e1 * t6031 + 0.4e1 / 0.9e1 * t6034 + 0.16e2 / 0.81e2 * t6037 + t6050 + 0.64e2 / 0.9e1 * t6053 - 0.8e1 / 0.3e1 * t6057;
  t6063 = t2299 * t165 * t180 * t185;
  t6067 = t750 * t589 * t180 * t576;
  t6071 = 0.304e3 / 0.81e2 * t917 * t5484 * t2301;
  t6074 = 0.32e2 / 0.81e2 * t2020 * t5362 * t2301;
  t6078 = 0.16e2 / 0.27e2 * t917 * t4207 * t2300 * t576;
  t6081 = 0.16e2 / 0.27e2 * t750 * t4124 * t2065;
  t6085 = 0.64e3 / 0.81e2 * t750 * t582 * t12 * t185;
  t6089 = 0.32e3 / 0.81e2 * t21 * params->c * t582 * t759;
  t6090 = t2313 * t2318;
  t6095 = 0.8e1 / 0.9e1 * t21 * t859 * t1788 * t759;
  t6099 = 0.16e2 / 0.9e1 * t21 * params->c * t1788 * t2328;
  t6102 = t756 * t757 * t747 * params->d;
  t6104 = t2322 * t2318;
  t6108 = t2326 * t2048 * t309 * t213;
  t6110 = -0.16e2 / 0.9e1 * t6063 - 0.16e2 / 0.9e1 * t6067 + t6071 - t6074 - t6078 - t6081 - t6085 + t6089 - 0.32e2 / 0.9e1 * t6090 - t6095 - t6099 + 0.4e1 / 0.3e1 * t6102 + 0.4e1 / 0.9e1 * t6104 + 0.8e1 / 0.9e1 * t6108;
  t6114 = 0.4e1 / 0.81e2 * t21 * t2281 * t1827 * t759;
  t6118 = 0.4e1 / 0.27e2 * t21 * t859 * t1827 * t2328;
  t6122 = 0.8e1 / 0.27e2 * t4109 * t5195 * t122 * t627;
  t6126 = 0.32e2 / 0.9e1 * t750 * t1788 * t12 * t576;
  t6130 = 0.56e3 / 0.81e2 * t190 * t1570 * params->b * t123;
  t6133 = 0.736e3 / 0.81e2 * t873 * t5919 * t965;
  t6135 = t190 * t2462 * t310;
  t6138 = t190 * t968 * t748;
  t6140 = t2459 * t2469;
  t6144 = 0.8e1 / 0.3e1 * t2360 * t5936 * t965;
  t6146 = t190 * t191 * t2251;
  t6149 = t963 * t964 * t748;
  t6151 = t2472 * t2469;
  t6155 = 0.16e2 / 0.81e2 * t5247 * t5848 * t965;
  t6156 = t6114 + t6118 + t6122 + t6126 - t6130 + t6133 + 0.224e3 / 0.27e2 * t6135 - 0.16e2 / 0.3e1 * t6138 - 0.208e3 / 0.27e2 * t6140 - t6144 + 0.8e1 / 0.3e1 * t6146 + 0.8e1 / 0.3e1 * t6149 + 0.32e2 / 0.27e2 * t6151 + t6155;
  tv4rho40 = 0.4e1 * t5006 + t161 * (t5048 + t5101 + t5156 + t5210 + t5265 + t5313 + t5361 + t5406 + t5455 + t5800 + t5847 + t5894 + t5940 + t6059 + t6110 + t6156);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t6162 = params->a * t3091;
  t6164 = t1252 * t569;
  t6165 = 0.4e1 / 0.3e1 * t6164;
  t6166 = t380 * t2255;
  t6168 = t209 * t2501;
  t6170 = t583 * t1130;
  t6171 = 0.88e2 / 0.3e1 * t6170;
  t6172 = t1936 * t384;
  t6210 = 0.48e2 * t1079 * t1788;
  t6212 = my_piecewise3(t49, 0, 0.12e2 * t177 * t603 * t7 + 0.2e1 * t1891 * t389 - 0.36e2 * t2671 * t589 - 0.24e2 * t48 * t589 + 0.12e2 * t2524 + t6210);
  t6233 = -0.22e2 / 0.3e1 * t1106 * t735 + 0.308e3 / 0.27e2 * t450 * t2101 - 0.22e2 / 0.3e1 * t297 * t2666 + 0.308e3 / 0.27e2 * t115 * t1864 * t392 + 0.2e1 * t2713 * t300 + 0.4e1 * t1106 * t738 - 0.22e2 / 0.3e1 * t450 * t2139 + 0.2e1 * t728 * t1115 + 0.4e1 * t297 * t2726 - 0.22e2 / 0.3e1 * t115 * t644 * t994 - t6212 * sigma[2] * t111 / 0.4e1 - 0.3e1 / 0.4e1 * t2680 * t291 - 0.3e1 / 0.4e1 * t1084 * t721 - t438 * t2121 / 0.4e1 + 0.2e1 / 0.3e1 * t2114 * t441 + 0.2e1 * t716 * t1091 + 0.2e1 * t288 * t2692 + 0.2e1 / 0.3e1 * t110 * t407 * t1918 - t2114 * t444 / 0.4e1;
  t6242 = t177 * t608;
  t6250 = t589 * t234;
  t6253 = t177 * t611;
  t6261 = 0.64e2 * t998 * t1788;
  t6263 = my_piecewise3(t60, 0, -0.8e2 / 0.81e2 * t5570 * t393 * t1908 - 0.16e3 / 0.9e1 * t1907 * t7 * t6242 + 0.8e2 / 0.9e1 * t2535 * t2124 - 0.8e2 / 0.3e1 * t63 * t177 * t234 + 0.8e2 * t2538 * t6250 - 0.8e2 / 0.3e1 * t2538 * t6253 + 0.4e2 / 0.9e1 * t995 * t1914 + 0.32e2 * t233 * t589 - t6261);
  t6278 = 0.48e2 * t1101 * t1788;
  t6280 = my_piecewise3(t60, 0, -0.12e2 * t177 * t611 * t7 + 0.2e1 * t1914 * t393 + 0.36e2 * t2704 * t589 + 0.24e2 * t589 * t59 - 0.12e2 * t2539 - t6278);
  t6305 = t177 * t599;
  t6313 = t589 * t229;
  t6316 = t177 * t603;
  t6324 = 0.64e2 * t990 * t1788;
  t6326 = my_piecewise3(t49, 0, -0.8e2 / 0.81e2 * t5549 * t389 * t1885 + 0.16e3 / 0.9e1 * t1884 * t7 * t6305 + 0.8e2 / 0.9e1 * t2520 * t2108 + 0.8e2 / 0.3e1 * t56 * t177 * t229 - 0.8e2 * t2523 * t6313 + 0.8e2 / 0.3e1 * t2523 * t6316 + 0.4e2 / 0.9e1 * t987 * t1891 - 0.32e2 * t228 * t589 + t6324);
  t6330 = t1922 * t392;
  t6332 = t645 * t994;
  t6334 = t252 * t2534;
  t6336 = t79 * t6326;
  t6338 = t408 * t1918;
  t6340 = t86 * t6263;
  t6342 = -0.3e1 / 0.4e1 * t716 * t1096 - 0.3e1 / 0.4e1 * t288 * t2699 - t110 * t85 * t6263 / 0.4e1 - t6280 * sigma[0] * t116 / 0.4e1 - 0.3e1 / 0.4e1 * t2713 * t303 - 0.3e1 / 0.4e1 * t1106 * t741 + 0.2e1 * t450 * t2142 - t450 * t2145 / 0.4e1 - t2130 * t453 / 0.4e1 - 0.3e1 / 0.4e1 * t728 * t1118 - 0.3e1 / 0.4e1 * t297 * t2729 + 0.2e1 * t115 * t251 * t2534 - t115 * t78 * t6326 / 0.4e1 - 0.2464e4 / 0.81e2 * t6330 + 0.176e3 / 0.9e1 * t6332 - 0.16e2 / 0.3e1 * t6334 + 0.2e1 / 0.3e1 * t6336 - 0.16e2 / 0.9e1 * t6338 + 0.2e1 / 0.3e1 * t6340;
  t6346 = 0.96e2 * t5009;
  t6347 = t6346 - t5012;
  t6373 = t70 * t6347;
  t6376 = t2555 * t246;
  t6380 = 0.8e1 * t6168 - t6171 + 0.1232e4 / 0.27e2 * t6172 + 0.8e1 / 0.3e1 * t5502 + 0.1232e4 / 0.9e1 * t5529 - 0.88e2 / 0.3e1 * t5531 - t5535 - t70 * (t6233 + t6342) / 0.8e1 - 0.3e1 / 0.2e2 * t45 * t6347 * t66 - 0.9e1 / 0.2e2 * t45 * t2492 * t238 - 0.9e1 / 0.2e2 * t45 * t1007 * t616 - 0.3e1 / 0.2e2 * t45 * t379 * t2243 - 0.3e1 / 0.2e2 * t45 * t1791 * t397 - 0.9e1 / 0.2e2 * t45 * t592 * t1003 - 0.9e1 / 0.2e2 * t45 * t180 * t2550 - 0.3e1 / 0.2e2 * t45 * t12 * (t6326 + t6263) + t6373 * t89 / 0.32e2 + 0.3e1 / 0.32e2 * t6376 + 0.3e1 / 0.32e2 * t2555 * t258;
  t6381 = t1008 * t636;
  t6382 = 0.3e1 / 0.32e2 * t6381;
  t6383 = t1008 * t639;
  t6387 = t401 * t2200;
  t6389 = t401 * t2204;
  t6390 = 0.3e1 / 0.32e2 * t6389;
  t6391 = t401 * t2207;
  t6397 = t620 * t1017;
  t6401 = t242 * t2574;
  t6402 = 0.3e1 / 0.32e2 * t6401;
  t6403 = t242 * t2577;
  t6408 = t71 * t2199 * t412;
  t6411 = t71 * t635 * t1026;
  t6412 = 0.3e1 / 0.32e2 * t6411;
  t6414 = t71 * t245 * t2588;
  t6420 = -0.1232e4 / 0.27e2 * t6330 + 0.88e2 / 0.3e1 * t6332 - 0.8e1 * t6334 + t6336 - 0.8e1 / 0.3e1 * t6338 + t6340;
  t6424 = t242 * t2615;
  t6428 = t6382 + 0.3e1 / 0.16e2 * t6383 + 0.3e1 / 0.32e2 * t1008 * t653 + t6387 / 0.32e2 + t6390 + 0.3e1 / 0.32e2 * t6391 + t401 * t2210 / 0.32e2 + t2213 * t413 / 0.32e2 + 0.3e1 / 0.32e2 * t6397 + 0.3e1 / 0.32e2 * t620 * t1027 + t6402 + 0.3e1 / 0.16e2 * t6403 + 0.3e1 / 0.32e2 * t242 * t2589 + t6408 / 0.32e2 + t6412 + 0.3e1 / 0.32e2 * t6414 + t71 * t73 * t6420 / 0.32e2 + t6424 / 0.96e2 + t242 * t2651 / 0.192e3;
  t6431 = t71 * t2230 * t428;
  t6434 = t71 * t665 * t1062;
  t6435 = t6434 / 0.192e3;
  t6437 = t71 * t264 * t2650;
  t6462 = 0.88e2 * t1046 * t1788;
  t6464 = my_piecewise3(t49, 0, 0.88e3 / 0.81e2 * t2520 * t1885 + 0.88e3 / 0.9e1 * t2523 * t6305 + 0.44e3 / 0.9e1 * t987 * t2108 + 0.176e3 / 0.3e1 * t2529 * t229 - 0.176e3 * t990 * t6313 + 0.176e3 / 0.3e1 * t990 * t6316 + 0.88e2 / 0.9e1 * t390 * t1891 - 0.44e2 * t57 * t589 + t6462);
  t6485 = 0.88e2 * t1056 * t1788;
  t6487 = my_piecewise3(t60, 0, 0.88e3 / 0.81e2 * t2535 * t1908 - 0.88e3 / 0.9e1 * t2538 * t6242 + 0.44e3 / 0.9e1 * t995 * t2124 - 0.176e3 / 0.3e1 * t2544 * t234 + 0.176e3 * t998 * t6250 - 0.176e3 / 0.3e1 * t998 * t6253 + 0.88e2 / 0.9e1 * t394 * t1914 + 0.44e2 * t64 * t589 - t6485);
  t6495 = t2555 * t265;
  t6499 = t1008 * t666;
  t6500 = t6499 / 0.192e3;
  t6501 = t1008 * t669;
  t6505 = t401 * t2231;
  t6507 = t401 * t2151;
  t6508 = t6507 / 0.192e3;
  t6509 = t401 * t2154;
  t6515 = t620 * t1039;
  t6519 = t242 * t2612;
  t6520 = t6519 / 0.192e3;
  t6522 = t6431 / 0.576e3 + t6435 + t6437 / 0.192e3 + t71 * t92 * (-0.1232e4 / 0.27e2 * t1922 * t420 + 0.88e2 / 0.3e1 * t645 * t1050 - 0.8e1 * t252 * t2633 + t79 * t6464 - 0.8e1 / 0.3e1 * t408 * t2179 + t86 * t6487) / 0.576e3 + t6373 * t104 / 0.576e3 + t6495 / 0.192e3 + t2555 * t279 / 0.192e3 + t6500 + t6501 / 0.96e2 + t1008 * t691 / 0.192e3 + t6505 / 0.576e3 + t6508 + t6509 / 0.192e3 + t401 * t2182 / 0.576e3 + t2213 * t429 / 0.576e3 + t6515 / 0.192e3 + t620 * t1063 / 0.192e3 + t6520 + t5652 / 0.192e3;
  t6542 = t2492 * t220;
  t6544 = t1007 * t703;
  t6545 = t6544 / 0.24e2;
  t6546 = t379 * t2085;
  t6553 = t5664 + t5666 / 0.192e3 + t5669 / 0.192e3 + t5672 / 0.576e3 + t5712 / 0.576e3 + t5716 / 0.192e3 + t5718 / 0.192e3 + t5722 / 0.192e3 + t5724 / 0.96e2 + 0.3e1 / 0.32e2 * t5727 + t5739 + 0.3e1 / 0.32e2 * t5741 + 0.3e1 / 0.32e2 * t5744 + t5747 / 0.32e2 + t5762 / 0.32e2 + 0.3e1 / 0.32e2 * t5767 + 0.3e1 / 0.32e2 * t5769 + 0.3e1 / 0.32e2 * t5773 + 0.3e1 / 0.16e2 * t5775 - t30 * (t6347 * t35 / 0.72e2 + t6542 / 0.24e2 + t6545 + t6546 / 0.72e2 + t5506 / 0.72e2 + t5508 / 0.24e2 + t5510 / 0.24e2 + t5526);
  t6558 = t2751 * t186;
  t6559 = t1252 * t577;
  t6560 = 0.2e1 / 0.3e1 * t6559;
  t6561 = t380 * t2066;
  t6566 = t6165 + 0.8e1 / 0.9e1 * t6166 + t21 * t24 * (t6380 + t6428 + t6522 + t6553) - t6558 - t6560 - 0.2e1 / 0.9e1 * t6561 + 0.4e1 / 0.3e1 * t5016 + 0.8e1 / 0.3e1 * t5018 - 0.28e2 / 0.9e1 * t5020 - t5024 + t5027;
  t6568 = t2050 * t956 * t3033;
  t6570 = t2044 * t3069;
  t6573 = t2050 * t956 * t3021;
  t6575 = t2034 * t3072;
  t6577 = t2034 * t3069;
  t6580 = t2055 * t2056 * t1211;
  t6583 = t955 * t956 * t2996;
  t6584 = t6583 / 0.9e1;
  t6586 = t955 * t956 * t3004;
  t6587 = t6586 / 0.9e1;
  t6589 = t2055 * t2056 * t1219;
  t6592 = t955 * t956 * t2974;
  t6593 = t6592 / 0.9e1;
  t6595 = t955 * t956 * t2982;
  t6596 = t6595 / 0.9e1;
  t6597 = t2044 * t3072;
  t6599 = t6568 / 0.27e2 + t6570 / 0.54e2 + t6573 / 0.27e2 - 0.5e1 / 0.27e2 * t6575 - 0.5e1 / 0.27e2 * t6577 + 0.2e1 / 0.27e2 * t6580 + t6584 + t6587 + 0.2e1 / 0.27e2 * t6589 + t6593 + t6596 + t6597 / 0.54e2;
  t6602 = t872 * t874 * t2813;
  t6603 = 0.2e1 / 0.9e1 * t6602;
  t6605 = t897 * t899 * t2982;
  t6606 = 0.2e1 / 0.9e1 * t6605;
  t6608 = t136 * t2492 * t155;
  t6610 = t315 * t317 * t6608;
  t6615 = t325 * t326 * t2492 * t155 * params->d;
  t6617 = t2804 * t371;
  t6619 = t315 * t317 * t6617;
  t6624 = t325 * t326 * t1007 * t371 * params->d;
  t6627 = t1795 * t2341 * t2791;
  t6630 = t2368 * t2370 * t1219;
  t6632 = t1803 * t487;
  t6634 = t315 * t317 * t6632;
  t6639 = t325 * t326 * t592 * t487 * params->d;
  t6641 = t776 * t1178;
  t6643 = t315 * t317 * t6641;
  t6648 = t325 * t326 * t180 * t1178 * params->d;
  t6650 = t6603 + t6606 + t6610 / 0.6e1 + t6615 / 0.6e1 + t6619 / 0.3e1 + t6624 / 0.3e1 + 0.4e1 / 0.9e1 * t6627 + 0.2e1 / 0.27e2 * t6630 + t6634 / 0.6e1 + t6639 / 0.6e1 + t6643 / 0.3e1 + t6648 / 0.3e1;
  t6652 = t872 * t874 * t2805;
  t6653 = 0.2e1 / 0.9e1 * t6652;
  t6655 = t897 * t899 * t2974;
  t6656 = 0.2e1 / 0.9e1 * t6655;
  t6657 = t1137 * t844;
  t6659 = t315 * t317 * t6657;
  t6664 = t325 * t326 * t379 * t844 * params->d;
  t6667 = t2368 * t2370 * t1211;
  t6669 = t909 * t2970;
  t6670 = t6669 / 0.3e1;
  t6672 = t325 * t903 * t2974;
  t6673 = t6672 / 0.3e1;
  t6675 = t872 * t874 * t2838;
  t6676 = 0.2e1 / 0.9e1 * t6675;
  t6678 = t897 * t899 * t2996;
  t6679 = 0.2e1 / 0.9e1 * t6678;
  t6680 = t318 * t2901;
  t6682 = t315 * t317 * t6680;
  t6687 = t325 * t326 * t12 * t2901 * params->d;
  t6690 = t2359 * t2361 * t1138;
  t6692 = t6653 + t6656 + t6659 / 0.6e1 + t6664 / 0.6e1 + 0.2e1 / 0.27e2 * t6667 - t6670 - t6673 + t6676 + t6679 + t6682 / 0.6e1 + t6687 / 0.6e1 + 0.2e1 / 0.27e2 * t6690;
  t6697 = t890 * t891 * t2973 * t213;
  t6698 = t6697 / 0.9e1;
  t6700 = t872 * t874 * t2910;
  t6701 = 0.2e1 / 0.9e1 * t6700;
  t6703 = t897 * t899 * t3004;
  t6704 = 0.2e1 / 0.9e1 * t6703;
  t6706 = t2359 * t2361 * t1183;
  t6709 = t325 * t903 * t3004;
  t6710 = t6709 / 0.3e1;
  t6712 = t2435 * t2437 * t3021;
  t6714 = t909 * t2992;
  t6715 = t6714 / 0.3e1;
  t6717 = t325 * t903 * t2996;
  t6718 = t6717 / 0.3e1;
  t6721 = t890 * t891 * t2981 * t213;
  t6722 = t6721 / 0.9e1;
  t6723 = t1573 * t2986;
  t6726 = t897 * t1979 * t1219;
  t6728 = t6698 + t6701 + t6704 + 0.2e1 / 0.27e2 * t6706 - t6710 + 0.2e1 / 0.27e2 * t6712 - t6715 - t6718 + t6722 - 0.11e2 / 0.27e2 * t6723 - 0.11e2 / 0.27e2 * t6726;
  t6729 = t2414 * t2986;
  t6731 = t909 * t2978;
  t6732 = t6731 / 0.3e1;
  t6734 = t325 * t903 * t2982;
  t6735 = t6734 / 0.3e1;
  t6736 = t863 * t2978;
  t6737 = t6736 / 0.18e2;
  t6738 = t863 * t2970;
  t6739 = t6738 / 0.18e2;
  t6740 = t2446 * t1223;
  t6743 = t325 * t2441 * t1211;
  t6745 = t2336 * t1215;
  t6748 = t890 * t2449 * t3021;
  t6750 = t2409 * t1215;
  t6753 = t2435 * t2437 * t3033;
  t6755 = t2446 * t1215;
  t6757 = t6729 / 0.27e2 - t6732 - t6735 + t6737 + t6739 + 0.26e2 / 0.81e2 * t6740 + 0.26e2 / 0.81e2 * t6743 - 0.5e1 / 0.54e2 * t6745 - 0.5e1 / 0.27e2 * t6748 + t6750 / 0.162e3 + 0.2e1 / 0.27e2 * t6753 + 0.26e2 / 0.81e2 * t6755;
  t6760 = t325 * t2441 * t1219;
  t6762 = t1573 * t3008;
  t6765 = t897 * t1979 * t1211;
  t6767 = t2414 * t3008;
  t6769 = t863 * t3000;
  t6770 = t6769 / 0.18e2;
  t6773 = t890 * t891 * t3003 * t213;
  t6774 = t6773 / 0.9e1;
  t6775 = t863 * t2992;
  t6776 = t6775 / 0.18e2;
  t6779 = t890 * t891 * t2995 * t213;
  t6780 = t6779 / 0.9e1;
  t6781 = t909 * t3000;
  t6782 = t6781 / 0.3e1;
  t6783 = t2409 * t1223;
  t6787 = t2428 * t2429 * t1210 * t627;
  t6789 = t2336 * t1223;
  t6791 = 0.26e2 / 0.81e2 * t6760 - 0.11e2 / 0.27e2 * t6762 - 0.11e2 / 0.27e2 * t6765 + t6767 / 0.27e2 + t6770 + t6774 + t6776 + t6780 - t6782 + t6783 / 0.162e3 + t6787 / 0.27e2 - 0.5e1 / 0.54e2 * t6789;
  t6793 = t890 * t2449 * t3033;
  t6797 = t2428 * t2429 * t1218 * t627;
  t6802 = t750 * t208 * t379 * t185;
  t6806 = t750 * t29 * t1007 * t185;
  t6807 = 0.4e1 / 0.3e1 * t6806;
  t6810 = t2299 * t165 * t379 * t185;
  t6814 = t750 * t589 * t379 * t576;
  t6816 = t2313 * t2831;
  t6820 = t756 * t757 * t1133 * params->d;
  t6821 = 0.2e1 / 0.3e1 * t6820;
  t6822 = t2322 * t2831;
  t6824 = -0.5e1 / 0.27e2 * t6793 + t6797 / 0.27e2 + 0.26e2 / 0.27e2 * t5028 + t5032 + t5034 + 0.16e2 / 0.9e1 * t6802 - t6807 - 0.4e1 / 0.9e1 * t6810 - 0.4e1 / 0.9e1 * t6814 - 0.8e1 / 0.9e1 * t6816 + t6821 + t6822 / 0.9e1;
  t6830 = t2326 * t2048 * t459 * t213;
  t6833 = t167 * t2000 * t1232;
  t6836 = t195 * t870 * t1236;
  t6839 = t167 * t923 * t3054;
  t6840 = 0.8e1 / 0.3e1 * t6839;
  t6842 = t918 * t1996 * t1232;
  t6845 = t195 * t928 * t3046;
  t6846 = 0.4e1 / 0.3e1 * t6845;
  t6848 = t940 * t2267 * t1236;
  t6851 = t201 * t3050 * t932;
  t6852 = 0.4e1 / 0.3e1 * t6851;
  t6854 = t201 * t3064 * t2274;
  t6857 = t201 * t1240 * t2007;
  t6861 = t201 * t184 * t2748 * t203;
  t6862 = 0.2e1 / 0.9e1 * t6830 - 0.56e2 / 0.27e2 * t6833 + 0.28e2 / 0.27e2 * t6836 + t6840 + 0.52e2 / 0.27e2 * t6842 - t6846 - 0.4e1 / 0.9e1 * t6848 - t6852 - 0.8e1 / 0.9e1 * t6854 + 0.28e2 / 0.27e2 * t6857 + t6861;
  t6865 = t201 * t575 * t1133 * t949;
  t6866 = 0.2e1 / 0.3e1 * t6865;
  t6869 = t167 * t170 * t2492 * t16;
  t6872 = t918 * t919 * t3054;
  t6873 = 0.4e1 / 0.3e1 * t6872;
  t6875 = t2021 * t2022 * t1232;
  t6878 = t2282 * t1552 * t1236;
  t6882 = t201 * t2064 * t459 * t2291;
  t6886 = t195 * t196 * t16 * t2748;
  t6888 = t940 * t907 * t3046;
  t6889 = t6888 / 0.3e1;
  t6892 = t6866 - 0.2e1 * t6869 - t6873 - 0.8e1 / 0.27e2 * t6875 + t6878 / 0.27e2 + 0.2e1 / 0.9e1 * t6882 + t6886 + t6889 + 0.52e2 / 0.9e1 * t5036 + t5041 + 0.28e2 / 0.9e1 * t5043 + t5047;
  t6903 = 0.28e2 / 0.9e1 * t5050 + t5055 - 0.2e1 / 0.3e1 * t5058 - 0.4e1 / 0.3e1 * t5061 - 0.8e1 / 0.9e1 * t5064 - t5072 + t5075 / 0.3e1 + t5078 / 0.3e1 + t5082 / 0.3e1 + 0.2e1 / 0.3e1 * t5086 - 0.4e1 / 0.3e1 * t5089 - t5093;
  t6909 = -0.8e1 / 0.3e1 * t5095 - t5100 + t5104 / 0.9e1 + t5110 + 0.2e1 / 0.3e1 * t5113 + t5121 - 0.56e2 / 0.9e1 * t5123 - t5128 + t5132 - t5135 - t5139 - 0.4e1 / 0.3e1 * t5141;
  t6920 = -0.4e1 / 0.3e1 * t5144 + 0.8e1 / 0.3e1 * t5147 - t5152 + 0.2e1 / 0.9e1 * t5154 + 0.2e1 / 0.9e1 * t5158 + t5165 + t5167 / 0.9e1 + 0.2e1 / 0.9e1 * t5170 - 0.5e1 / 0.9e1 * t5172 - 0.5e1 / 0.9e1 * t5174 - t5179;
  t6926 = t5183 - t5187 + t5191 + t5193 / 0.9e1 + t5200 + t5205 + t5209 + t5214 / 0.9e1 + t5216 / 0.18e2 + t5218 / 0.18e2 + t5223 + t5225 / 0.9e1;
  t6936 = 0.4e1 / 0.3e1 * t5228 + t5233 + t5236 + 0.26e2 / 0.27e2 * t5237 + 0.2e1 / 0.9e1 * t5240 + t5251 + t5258 + 0.4e1 / 0.9e1 * t5260 + 0.4e1 / 0.9e1 * t5263 + 0.2e1 / 0.9e1 * t5267 + 0.2e1 / 0.9e1 * t5270 + 0.2e1 / 0.9e1 * t5273;
  t6947 = 0.2e1 / 0.9e1 * t5276 + t5281 - t5285 - t5286 / 0.3e1 - t5289 / 0.3e1 + 0.2e1 / 0.9e1 * t5292 + 0.2e1 / 0.9e1 * t5295 + 0.2e1 / 0.9e1 * t5298 + t5302 / 0.6e1 + t5307 / 0.6e1 + t5311 / 0.6e1 + t5318 / 0.6e1;
  t6962 = -t5320 / 0.3e1 - t5323 / 0.3e1 - 0.2e1 / 0.3e1 * t5325 - 0.2e1 / 0.3e1 * t5328 + t5333 / 0.18e2 + t5338 / 0.18e2 - t5341 + t5344 / 0.18e2 + t5349 / 0.18e2 - 0.5e1 / 0.18e2 * t5351 - 0.11e2 / 0.9e1 * t5353;
  t6972 = 0.26e2 / 0.27e2 * t5356 + 0.2e1 / 0.9e1 * t5359 - t5366 + t5371 - 0.11e2 / 0.9e1 * t5373 + t5375 / 0.9e1 - 0.11e2 / 0.9e1 * t5378 + t5380 / 0.9e1 + 0.2e1 / 0.9e1 * t5383 - t5386 - 0.5e1 / 0.18e2 * t5387 - 0.11e2 / 0.9e1 * t5389;
  t6983 = -t5393 + t5396 / 0.9e1 + t5400 / 0.9e1 + t5405 + t5412 + t5413 / 0.54e2 + t5415 / 0.54e2 + t5417 / 0.18e2 + t5421 / 0.9e1 + t5423 / 0.9e1 + 0.2e1 / 0.9e1 * t5427 + t5429 / 0.18e2;
  t6988 = t5433 / 0.9e1 - 0.5e1 / 0.9e1 * t5436 + 0.26e2 / 0.27e2 * t5439 - 0.5e1 / 0.9e1 * t5442 + t5450 - t5454 - t5458 - t5461 - t5465 + t5469 + t5477 + t5483;
  t6995 = t334 * t336 * t6608;
  t7002 = t334 * t336 * t6617;
  t7005 = t789 * t792 * t2805;
  t7006 = 0.2e1 / 0.9e1 * t7005;
  t7008 = t768 * t312 * t1134;
  t7009 = 0.4e1 / 0.3e1 * t7008;
  t7010 = t5488 + t5491 - t5492 / 0.3e1 - 0.2e1 / 0.3e1 * t5494 - 0.2e1 / 0.3e1 * t5496 - t5501 + t6995 / 0.3e1 + t130 * t137 * t1197 * t844 / 0.2e1 + 0.2e1 / 0.3e1 * t7002 + t7006 + t7009;
  t7011 = t1980 * t2788;
  t7014 = t1795 * t860 * t460;
  t7018 = t768 * t125 * t3050 * params->d;
  t7019 = 0.4e1 / 0.3e1 * t7018;
  t7020 = t1980 * t2792;
  t7024 = t1795 * t125 * t3064 * t213;
  t7026 = t1988 * t2788;
  t7028 = t1988 * t2792;
  t7069 = t150 * t151 * t6263 / 0.8e1 + t1870 * t473 / 0.8e1 + 0.3e1 / 0.8e1 * t818 * t1160 + 0.3e1 / 0.8e1 * t354 * t2866 - t144 * t357 * t2534 + t144 * t145 * t6326 / 0.8e1 + t477 * t1919 / 0.8e1 - t1900 * t481 / 0.3e1 - t836 * t1170 - t365 * t2876 - t150 * t480 * t1918 / 0.3e1 + t1900 * t484 / 0.8e1 + 0.3e1 / 0.8e1 * t836 * t1175 + 0.3e1 / 0.8e1 * t365 * t2883 + t2842 * t361 / 0.8e1 + 0.11e2 / 0.3e1 * t470 * t1879 - t818 * t1157 - 0.2e1 * t354 * t2863 + 0.11e2 / 0.3e1 * t144 * t825 * t994;
  t7102 = t5009 * sigma[0] * t146 / 0.2e1;
  t7106 = t5009 * sigma[2] * t152 / 0.2e1;
  t7111 = -t2852 * t368 / 0.8e1 - t470 * t1882 + t470 * t1896 / 0.8e1 - t589 * sigma[0] * t146 / 0.4e1 - t2842 * t358 / 0.3e1 - 0.154e3 / 0.27e2 * t470 * t1866 + 0.11e2 / 0.3e1 * t354 * t2849 - 0.154e3 / 0.27e2 * t144 * t1865 * t392 + t589 * sigma[2] * t152 / 0.4e1 + t5994 - 0.7e1 / 0.48e2 * t70 * t6420 + 0.3e1 / 0.8e1 * t2895 * t368 + t1148 * t832 / 0.8e1 + 0.11e2 / 0.9e1 * t1148 * t826 - t1163 * t841 / 0.8e1 + t7102 + t2890 * t358 - t7106 - 0.3e1 / 0.8e1 * t2890 * t361 - 0.2e1 / 0.3e1 * t1148 * t829;
  t7118 = t334 * t336 * t6680;
  t7121 = t789 * t792 * t2910;
  t7122 = 0.2e1 / 0.9e1 * t7121;
  t7124 = t1824 * t1828 * t1183;
  t7130 = 0.4e1 / 0.9e1 * t7011 + 0.2e1 / 0.9e1 * t7014 + t7019 + 0.4e1 / 0.9e1 * t7020 + 0.4e1 / 0.9e1 * t7024 - 0.16e2 / 0.9e1 * t7026 - 0.16e2 / 0.9e1 * t7028 + t130 * t137 * t138 * (t7069 + t7111) / 0.6e1 + t7118 / 0.3e1 + t7122 + 0.4e1 / 0.81e2 * t7124 + t130 * t137 * t1845 * t487 / 0.6e1;
  t7137 = t334 * t336 * t6632;
  t7144 = t334 * t336 * t6641;
  t7147 = t789 * t792 * t2838;
  t7148 = 0.2e1 / 0.9e1 * t7147;
  t7154 = t334 * t336 * t6657;
  t7157 = t789 * t792 * t2813;
  t7158 = 0.2e1 / 0.9e1 * t7157;
  t7160 = t1824 * t1828 * t1138;
  t7173 = t130 * t137 * t1953 * t487;
  t7174 = 0.2e1 / 0.9e1 * t7173;
  t7175 = t130 * t137 * t805 * t1178 / 0.2e1 + t7137 / 0.3e1 + t130 * t137 * t345 * t2901 / 0.2e1 + 0.2e1 / 0.3e1 * t7144 + t7148 + t130 * t137 * t462 * t1938 / 0.6e1 + t7154 / 0.3e1 + t7158 + 0.4e1 / 0.81e2 * t7160 + t130 * t137 * t4 * t6347 * t155 / 0.6e1 + t130 * t137 * t2795 * t371 / 0.2e1 + t7174;
  t7177 = t334 * t1962 * t1138;
  t7181 = t130 * t137 * t2940 * t371;
  t7182 = 0.2e1 / 0.9e1 * t7181;
  t7184 = t789 * t1949 * t1183;
  t7189 = t130 * t137 * t568 * t1007 * t155;
  t7190 = 0.2e1 / 0.9e1 * t7189;
  t7192 = t334 * t849 * t2838;
  t7193 = 0.7e1 / 0.9e1 * t7192;
  t7196 = t130 * t137 * t340 * t2901;
  t7199 = t334 * t849 * t2910;
  t7200 = 0.7e1 / 0.9e1 * t7199;
  t7202 = t789 * t1949 * t1138;
  t7206 = t130 * t137 * t1832 * t487;
  t7210 = t130 * t137 * t796 * t1178;
  t7213 = t334 * t849 * t2805;
  t7214 = 0.7e1 / 0.9e1 * t7213;
  t7217 = t130 * t137 * t1187 * t844;
  t7219 = 0.67e2 / 0.81e2 * t7177 + t7182 - 0.4e1 / 0.9e1 * t7184 + t7190 - t7193 - t7196 / 0.6e1 - t7200 - 0.4e1 / 0.9e1 * t7202 - t7206 / 0.6e1 - t7210 / 0.3e1 - t7214 - t7217 / 0.6e1;
  t7224 = t334 * t849 * t2813;
  t7225 = 0.7e1 / 0.9e1 * t7224;
  t7229 = t130 * t137 * t169 * t2492 * t155;
  t7233 = t130 * t137 * t2917 * t371;
  t7237 = t130 * t137 * t1966 * t487;
  t7242 = t130 * t137 * t869 * t379 * t155;
  t7245 = t334 * t1962 * t1183;
  t7249 = t130 * t137 * t762 * t1178;
  t7250 = 0.2e1 / 0.9e1 * t7249;
  t7255 = -t7225 - t7229 / 0.6e1 - t7233 / 0.3e1 - 0.14e2 / 0.81e2 * t7237 - 0.14e2 / 0.81e2 * t7242 + 0.67e2 / 0.81e2 * t7245 + t7250 - 0.16e2 / 0.3e1 * t5798 - 0.16e2 / 0.3e1 * t5802 + 0.4e1 / 0.3e1 * t5805 + 0.4e1 / 0.3e1 * t5807;
  t7265 = 0.2e1 / 0.3e1 * t5810 + 0.4e1 / 0.3e1 * t5814 + 0.4e1 / 0.3e1 * t5816 + 0.4e1 / 0.3e1 * t5820 + t5825 + t5827 + 0.2e1 / 0.9e1 * t5831 + 0.4e1 / 0.9e1 * t5835 + 0.2e1 / 0.9e1 * t5839 - 0.7e1 / 0.9e1 * t5842 - 0.4e1 / 0.3e1 * t5845 - t5851;
  t7279 = -0.14e2 / 0.9e1 * t5853 - 0.4e1 / 0.3e1 * t5856 - 0.7e1 / 0.9e1 * t5859 - t5864 / 0.18e2 - t5868 / 0.6e1 + t5871 / 0.9e1 + t5874 / 0.3e1 + 0.2e1 / 0.9e1 * t5877 + t5880 / 0.3e1 + 0.4e1 / 0.9e1 * t5883 + 0.4e1 / 0.27e2 * t5886 + t5889 / 0.9e1;
  t7280 = t5893 + t5900 - t5902 - t5904 - t5907 - t5909 + t5912 + t5914 + t5916 + t5918 - t5922 + t5926;
  t7294 = -0.14e2 / 0.27e2 * t5929 - 0.14e2 / 0.27e2 * t5934 + t5939 + 0.67e2 / 0.27e2 * t5942 + 0.67e2 / 0.27e2 * t5945 - t6027 / 0.6e1 - t6031 / 0.18e2 + 0.2e1 / 0.9e1 * t6034 + 0.4e1 / 0.27e2 * t6037 + t6050 - t6 * t6347 * t16 + 0.16e2 / 0.3e1 * t6053;
  t7299 = -0.4e1 / 0.3e1 * t6057 - 0.4e1 / 0.3e1 * t6063 - 0.4e1 / 0.3e1 * t6067 + t6071 - t6074 - t6078 - t6081 - t6085 + t6089 - 0.8e1 / 0.3e1 * t6090 - t6095 - t6099;
  t7304 = t380 * t2258;
  t7308 = 0.2e1 / 0.3e1 * t6102 + t6104 / 0.3e1 + 0.2e1 / 0.3e1 * t6108 + t6114 + t6118 + t6122 + t6126 - 0.28e2 / 0.27e2 * t7304 - t6130 + t6133 + 0.56e2 / 0.9e1 * t6135 - 0.8e1 / 0.3e1 * t6138;
  t7314 = t190 * t2462 * t460;
  t7317 = t963 * t964 * t1134;
  t7318 = 0.4e1 / 0.3e1 * t7317;
  t7319 = t2472 * t3084;
  t7322 = t190 * t968 * t1134;
  t7323 = 0.8e1 / 0.3e1 * t7322;
  t7324 = t2459 * t3084;
  t7327 = t190 * t191 * t2749;
  t7329 = -0.52e2 / 0.9e1 * t6140 - t6144 + 0.2e1 / 0.3e1 * t6146 + 0.4e1 / 0.3e1 * t6149 + 0.8e1 / 0.9e1 * t6151 + t6155 + 0.56e2 / 0.27e2 * t7314 + t7318 + 0.8e1 / 0.27e2 * t7319 - t7323 - 0.52e2 / 0.27e2 * t7324 + 0.2e1 * t7327;
  tv4rho41 = t5006 + 0.3e1 * t6162 + t161 * (t6862 + t7308 + t6824 + t6566 + t7175 + t6903 + t6962 + t6650 + t6972 + t7329 + t6988 + t6983 + t6909 + t7010 + t6926 + t6599 + t6947 + t6936 + t7130 + t6920 + t7299 + t6728 + t6791 + t6757 + t7265 + t6692 + t7255 + t7280 + t7279 + t7219 + t6892 + t7294);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 1] += tv4rho41;

  t7337 = params->a * t3564;
  t7344 = t3096 * t186;
  t7346 = t1348 * t577;
  t7348 = t401 * t2574;
  t7350 = t401 * t2577;
  t7356 = t242 * t3294;
  t7361 = t71 * t635 * t1302;
  t7364 = t71 * t245 * t3300;
  t7366 = t645 * t1283;
  t7368 = t252 * t3199;
  t7393 = my_piecewise3(t49, 0, -0.8e2 / 0.81e2 * t5549 * t1275 * t599 + 0.64e3 / 0.27e2 * t2520 * t2672 + 0.8e2 / 0.27e2 * t3188 * t603 + 0.32e3 / 0.9e1 * t56 * t8 * t4114 + 0.16e3 / 0.9e1 * t987 * t177 - 0.16e3 / 0.3e1 * t987 * t1785 + 0.8e2 / 0.27e2 * t1884 * t1279 * t599 + 0.8e2 / 0.9e1 * t56 * t3121 * t229 + 0.4e2 / 0.9e1 * t3193 * t603 + t6324);
  t7394 = t79 * t7393;
  t7395 = t1288 * t615;
  t7397 = t408 * t2549;
  t7422 = my_piecewise3(t60, 0, -0.8e2 / 0.81e2 * t5570 * t1293 * t608 - 0.64e3 / 0.27e2 * t2535 * t2705 + 0.8e2 / 0.27e2 * t3151 * t611 + 0.32e3 / 0.9e1 * t63 * t8 * t4114 - 0.16e3 / 0.9e1 * t995 * t177 + 0.16e3 / 0.3e1 * t995 * t1785 + 0.8e2 / 0.27e2 * t1907 * t1296 * t608 + 0.8e2 / 0.9e1 * t63 * t3159 * t234 + 0.4e2 / 0.9e1 * t3156 * t611 - t6261);
  t7423 = t86 * t7422;
  t7424 = 0.88e2 / 0.9e1 * t7366 - 0.16e2 / 0.3e1 * t7368 + t7394 + 0.88e2 / 0.9e1 * t7395 - 0.16e2 / 0.3e1 * t7397 + t7423;
  t7429 = 0.24e2 * t589 - t5012;
  t7430 = t70 * t7429;
  t7433 = t3279 * t265;
  t7435 = t7348 / 0.16e2 + t7350 / 0.8e1 + t401 * t2589 / 0.16e2 + t620 * t1370 / 0.32e2 + t7356 / 0.16e2 + t242 * t3301 / 0.16e2 + t7361 / 0.32e2 + t7364 / 0.16e2 + t71 * t73 * t7424 / 0.32e2 + t7430 * t104 / 0.576e3 + t7433 / 0.288e3;
  t7438 = t1365 * t666;
  t7440 = t1365 * t669;
  t7446 = t1008 * t1039;
  t7450 = t401 * t2612;
  t7452 = t401 * t2615;
  t7458 = t3279 * t279 / 0.288e3 + t7438 / 0.576e3 + t7440 / 0.288e3 + t1365 * t691 / 0.576e3 + t2555 * t429 / 0.288e3 + t7446 / 0.144e3 + t1008 * t1063 / 0.144e3 + t7450 / 0.288e3 + t7452 / 0.144e3 + t401 * t2651 / 0.288e3 + t620 * t1396 / 0.576e3;
  t7460 = t242 * t3319;
  t7465 = t71 * t665 * t1395;
  t7468 = t71 * t264 * t3275;
  t7494 = my_piecewise3(t49, 0, 0.88e3 / 0.81e2 * t3188 * t599 + 0.352e4 / 0.27e2 * t987 * t2672 + 0.44e3 / 0.27e2 * t1276 * t603 + 0.704e3 / 0.9e1 * t228 * t8 * t4114 + 0.352e3 / 0.9e1 * t390 * t177 - 0.352e3 / 0.3e1 * t390 * t1785 + 0.44e3 / 0.27e2 * t3193 * t599 + 0.176e3 / 0.9e1 * t3196 * t229 + 0.88e2 / 0.9e1 * t1280 * t603 + t6462);
  t7520 = my_piecewise3(t60, 0, 0.88e3 / 0.81e2 * t3151 * t608 - 0.352e4 / 0.27e2 * t995 * t2705 + 0.44e3 / 0.27e2 * t1294 * t611 + 0.704e3 / 0.9e1 * t233 * t8 * t4114 - 0.352e3 / 0.9e1 * t394 * t177 + 0.352e3 / 0.3e1 * t394 * t1785 + 0.44e3 / 0.27e2 * t3156 * t608 + 0.176e3 / 0.9e1 * t3160 * t234 + 0.88e2 / 0.9e1 * t1297 * t611 - t6485);
  t7544 = t7460 / 0.288e3 + t242 * t3276 / 0.288e3 + t7465 / 0.576e3 + t7468 / 0.288e3 + t71 * t92 * (0.88e2 / 0.9e1 * t645 * t1382 - 0.16e2 / 0.3e1 * t252 * t3258 + t79 * t7494 + 0.88e2 / 0.9e1 * t1288 * t688 - 0.16e2 / 0.3e1 * t408 * t2648 + t86 * t7520) / 0.576e3 - 0.3e1 / 0.2e2 * t45 * t7429 * t66 - 0.3e1 / 0.1e2 * t45 * t3095 * t238 - 0.3e1 / 0.2e2 * t45 * t1264 * t616 - 0.3e1 / 0.1e2 * t45 * t2492 * t397 - 0.3e1 / 0.5e1 * t45 * t1007 * t1003 - 0.3e1 / 0.1e2 * t45 * t379 * t2550;
  t7557 = t3279 * t246;
  t7561 = t1365 * t636;
  t7563 = t1365 * t639;
  t7569 = t1008 * t1017;
  t7573 = -0.3e1 / 0.2e2 * t45 * t592 * t1361 - 0.3e1 / 0.1e2 * t45 * t180 * t3337 - 0.3e1 / 0.2e2 * t45 * t12 * (t7393 + t7422) + t7430 * t89 / 0.32e2 + t7557 / 0.16e2 + t3279 * t258 / 0.16e2 + t7561 / 0.32e2 + t7563 / 0.16e2 + t1365 * t653 / 0.32e2 + t2555 * t413 / 0.16e2 + t7569 / 0.8e1 + t1008 * t1027 / 0.8e1;
  t7623 = 0.8e1 / 0.3e1 * t1084 * t1091 + 0.4e1 / 0.3e1 * t438 * t2692 - t2680 * t444 / 0.2e1 - t1084 * t1096 - t438 * t2699 / 0.2e1 - 0.22e2 / 0.9e1 * t716 * t1419 - 0.44e2 / 0.9e1 * t288 * t3141 - 0.22e2 / 0.9e1 * t110 * t1287 * t615 + 0.4e1 / 0.3e1 * t716 * t1422 + 0.8e1 / 0.3e1 * t288 * t3146 + 0.4e1 / 0.3e1 * t110 * t407 * t2549;
  t7632 = 0.16e2 * t5011;
  t7642 = my_piecewise3(t60, 0, 0.2e1 * t1296 * t611 - 0.8e1 * t177 * t393 + 0.4e1 * t234 * t3159 + 0.24e2 * t3167 * t589 - t6278 + t7632);
  t7678 = my_piecewise3(t49, 0, 0.2e1 * t1279 * t603 + 0.8e1 * t177 * t389 + 0.4e1 * t229 * t3121 - 0.24e2 * t3114 * t589 + t6210 + t7632);
  t7688 = 0.8e1 / 0.3e1 * t1106 * t1115 + 0.8e1 / 0.3e1 * t450 * t2726 + 0.4e1 / 0.3e1 * t297 * t3207 + 0.4e1 / 0.3e1 * t115 * t251 * t3199 - t7678 * sigma[2] * t111 / 0.4e1 + 0.176e3 / 0.27e2 * t7366 - 0.32e2 / 0.9e1 * t7368 + 0.2e1 / 0.3e1 * t7394 + 0.176e3 / 0.27e2 * t7395 - 0.32e2 / 0.9e1 * t7397 + 0.2e1 / 0.3e1 * t7423;
  t7695 = t583 * t1402;
  t7697 = t209 * t3239;
  t7701 = 0.16e2 / 0.3e1 * t6168 - 0.352e3 / 0.9e1 * t6170 + 0.2464e4 / 0.27e2 * t6172 - t70 * (-t1432 * t741 / 0.4e1 - t2713 * t453 / 0.2e1 - t1106 * t1118 - t450 * t2729 / 0.2e1 - t728 * t1437 / 0.4e1 - t297 * t3200 / 0.2e1 - t115 * t78 * t7393 / 0.4e1 - t3126 * t291 / 0.2e1 - t1412 * t721 / 0.4e1 + 0.4e1 / 0.3e1 * t2680 * t441 + t7623 - t716 * t1425 / 0.4e1 - t288 * t3164 / 0.2e1 - t110 * t85 * t7422 / 0.4e1 - t7642 * sigma[0] * t116 / 0.4e1 - t3176 * t303 / 0.2e1 - 0.22e2 / 0.9e1 * t1432 * t735 - 0.44e2 / 0.9e1 * t450 * t2666 - 0.22e2 / 0.9e1 * t115 * t644 * t1283 + 0.4e1 / 0.3e1 * t3176 * t300 + 0.4e1 / 0.3e1 * t1432 * t738 + t7688) / 0.8e1 + 0.2464e4 / 0.27e2 * t5529 - 0.88e2 / 0.9e1 * t5531 - t5535 - 0.88e2 / 0.9e1 * t7695 + 0.16e2 / 0.3e1 * t7697 + t6376 / 0.16e2 + t6381 / 0.8e1;
  t7714 = t6383 / 0.8e1 + t6387 / 0.16e2 + t6389 / 0.8e1 + t6391 / 0.16e2 + t6397 / 0.16e2 + t6401 / 0.8e1 + t6403 / 0.8e1 + t6408 / 0.16e2 + t6411 / 0.8e1 + t6414 / 0.16e2 + t6424 / 0.144e3 + t6431 / 0.288e3;
  t7726 = t6434 / 0.144e3 + t6437 / 0.288e3 + t6495 / 0.288e3 + t6499 / 0.144e3 + t6501 / 0.144e3 + t6505 / 0.288e3 + t6507 / 0.144e3 + t6509 / 0.288e3 + t6515 / 0.288e3 + t6519 / 0.144e3 + t5664;
  t7739 = t3095 * t220;
  t7741 = t1264 * t703;
  t7750 = t5666 / 0.288e3 + t5669 / 0.576e3 + t5716 / 0.576e3 + t5722 / 0.288e3 + t5724 / 0.288e3 + t5739 + t5741 / 0.16e2 + t5744 / 0.32e2 + t5767 / 0.32e2 + t5773 / 0.16e2 + t5775 / 0.16e2 - t30 * (t7429 * t35 / 0.72e2 + t7739 / 0.36e2 + t7741 / 0.72e2 + t6542 / 0.36e2 + t6544 / 0.18e2 + t6546 / 0.36e2 + t5508 / 0.72e2 + t5510 / 0.36e2 + t5526);
  t7760 = t750 * t29 * t1264 * t185;
  t7764 = t756 * t757 * t1443 * params->d;
  t7769 = t325 * t326 * t3095 * t155 * params->d;
  t7771 = 0.16e2 / 0.9e1 * t6164 + 0.16e2 / 0.9e1 * t6166 - 0.2e1 / 0.3e1 * t6558 - 0.8e1 / 0.9e1 * t6559 - 0.4e1 / 0.9e1 * t6561 - 0.2e1 / 0.3e1 * t7344 - 0.2e1 / 0.9e1 * t7346 + t21 * t24 * (t7435 + t7458 + t7544 + t7573 + t7701 + t7714 + t7726 + t7750) + 0.4e1 / 0.9e1 * t5016 + 0.16e2 / 0.9e1 * t5018 - 0.4e1 / 0.9e1 * t7760 + 0.2e1 / 0.9e1 * t7764 + t7769 / 0.9e1;
  t7772 = t3377 * t371;
  t7774 = t315 * t317 * t7772;
  t7779 = t325 * t326 * t1264 * t371 * params->d;
  t7782 = t872 * t874 * t3378;
  t7784 = t318 * t3458;
  t7786 = t315 * t317 * t7784;
  t7791 = t325 * t326 * t12 * t3458 * params->d;
  t7794 = t897 * t899 * t3511;
  t7796 = t2804 * t487;
  t7798 = t315 * t317 * t7796;
  t7803 = t325 * t326 * t1007 * t487 * params->d;
  t7805 = t1137 * t1178;
  t7807 = t315 * t317 * t7805;
  t7812 = t325 * t326 * t379 * t1178 * params->d;
  t7815 = t136 * t3095 * t155;
  t7817 = t315 * t317 * t7815;
  t7820 = t897 * t899 * t3527;
  t7822 = t909 * t3507;
  t7824 = t7774 / 0.9e1 + t7779 / 0.9e1 + 0.2e1 / 0.27e2 * t7782 + t7786 / 0.9e1 + t7791 / 0.9e1 + 0.2e1 / 0.27e2 * t7794 + 0.2e1 / 0.9e1 * t7798 + 0.2e1 / 0.9e1 * t7803 + 0.2e1 / 0.9e1 * t7807 + 0.2e1 / 0.9e1 * t7812 + t7817 / 0.9e1 + 0.2e1 / 0.27e2 * t7820 - t7822 / 0.9e1;
  t7827 = t325 * t903 * t3511;
  t7829 = t863 * t3507;
  t7832 = t872 * t874 * t3394;
  t7835 = t897 * t899 * t3519;
  t7837 = t776 * t1332;
  t7839 = t315 * t317 * t7837;
  t7844 = t325 * t326 * t180 * t1332 * params->d;
  t7846 = t909 * t3523;
  t7849 = t325 * t903 * t3527;
  t7851 = t863 * t3523;
  t7853 = t863 * t3515;
  t7857 = t890 * t891 * t3518 * t213;
  t7861 = t890 * t891 * t3510 * t213;
  t7863 = t909 * t3515;
  t7865 = -t7827 / 0.9e1 + t7829 / 0.54e2 + 0.4e1 / 0.27e2 * t7832 + 0.4e1 / 0.27e2 * t7835 + t7839 / 0.9e1 + t7844 / 0.9e1 - t7846 / 0.9e1 - t7849 / 0.9e1 + t7851 / 0.54e2 + t7853 / 0.27e2 + 0.2e1 / 0.27e2 * t7857 + t7861 / 0.27e2 - 0.2e1 / 0.9e1 * t7863;
  t7867 = t325 * t903 * t3519;
  t7870 = t872 * t874 * t3463;
  t7874 = t890 * t891 * t3526 * t213;
  t7878 = t190 * t191 * t3344;
  t7881 = t963 * t964 * t1444;
  t7884 = t190 * t968 * t1444;
  t7891 = -0.2e1 / 0.9e1 * t7867 + 0.2e1 / 0.27e2 * t7870 + t7874 / 0.27e2 - 0.56e2 / 0.27e2 * t5020 - t5024 + t5027 + 0.4e1 / 0.3e1 * t7878 + 0.4e1 / 0.9e1 * t7881 - 0.8e1 / 0.9e1 * t7884 + 0.2e1 / 0.27e2 * t6568 + t6570 / 0.27e2 + 0.2e1 / 0.27e2 * t6573 - 0.1e2 / 0.27e2 * t6575 - 0.1e2 / 0.27e2 * t6577;
  t7907 = 0.4e1 / 0.27e2 * t6580 + 0.4e1 / 0.27e2 * t6583 + 0.4e1 / 0.27e2 * t6586 + 0.4e1 / 0.27e2 * t6589 + 0.4e1 / 0.27e2 * t6592 + 0.4e1 / 0.27e2 * t6595 + t6597 / 0.27e2 + 0.8e1 / 0.27e2 * t6602 + 0.8e1 / 0.27e2 * t6605 + t6610 / 0.9e1 + t6615 / 0.9e1 + 0.2e1 / 0.9e1 * t6619 + 0.2e1 / 0.9e1 * t6624;
  t7922 = 0.8e1 / 0.9e1 * t6627 + 0.4e1 / 0.27e2 * t6630 + t6634 / 0.9e1 + t6639 / 0.9e1 + 0.2e1 / 0.9e1 * t6643 + 0.2e1 / 0.9e1 * t6648 + 0.8e1 / 0.27e2 * t6652 + 0.8e1 / 0.27e2 * t6655 + t6659 / 0.9e1 + t6664 / 0.9e1 + 0.4e1 / 0.27e2 * t6667 - 0.4e1 / 0.9e1 * t6669 - 0.4e1 / 0.9e1 * t6672 + 0.8e1 / 0.27e2 * t6675;
  t7937 = 0.8e1 / 0.27e2 * t6678 + t6682 / 0.9e1 + t6687 / 0.9e1 + 0.4e1 / 0.27e2 * t6690 + 0.4e1 / 0.27e2 * t6697 + 0.8e1 / 0.27e2 * t6700 + 0.8e1 / 0.27e2 * t6703 + 0.4e1 / 0.27e2 * t6706 - 0.4e1 / 0.9e1 * t6709 + 0.4e1 / 0.27e2 * t6712 - 0.4e1 / 0.9e1 * t6714 - 0.4e1 / 0.9e1 * t6717 + 0.4e1 / 0.27e2 * t6721;
  t7952 = -0.22e2 / 0.27e2 * t6723 - 0.22e2 / 0.27e2 * t6726 + 0.2e1 / 0.27e2 * t6729 - 0.4e1 / 0.9e1 * t6731 - 0.4e1 / 0.9e1 * t6734 + 0.2e1 / 0.27e2 * t6736 + 0.2e1 / 0.27e2 * t6738 + 0.52e2 / 0.81e2 * t6740 + 0.52e2 / 0.81e2 * t6743 - 0.5e1 / 0.27e2 * t6745 - 0.1e2 / 0.27e2 * t6748 + t6750 / 0.81e2 + 0.4e1 / 0.27e2 * t6753 + 0.52e2 / 0.81e2 * t6755;
  t7969 = 0.52e2 / 0.81e2 * t6760 - 0.22e2 / 0.27e2 * t6762 - 0.22e2 / 0.27e2 * t6765 + 0.2e1 / 0.27e2 * t6767 + 0.2e1 / 0.27e2 * t6769 + 0.4e1 / 0.27e2 * t6773 + 0.2e1 / 0.27e2 * t6775 + 0.4e1 / 0.27e2 * t6779 - 0.4e1 / 0.9e1 * t6781 + t6783 / 0.81e2 + 0.2e1 / 0.27e2 * t6787 - 0.5e1 / 0.27e2 * t6789 - 0.1e2 / 0.27e2 * t6793;
  t7982 = 0.2e1 / 0.27e2 * t6797 + 0.52e2 / 0.81e2 * t5028 + t5032 + t5034 + 0.32e2 / 0.9e1 * t6802 - 0.16e2 / 0.9e1 * t6806 - 0.8e1 / 0.9e1 * t6810 - 0.8e1 / 0.9e1 * t6814 - 0.16e2 / 0.9e1 * t6816 + 0.8e1 / 0.9e1 * t6820 + 0.2e1 / 0.9e1 * t6822 + 0.4e1 / 0.9e1 * t6830 - 0.112e3 / 0.27e2 * t6833 + 0.56e2 / 0.27e2 * t6836;
  t7997 = 0.32e2 / 0.9e1 * t6839 + 0.104e3 / 0.27e2 * t6842 - 0.16e2 / 0.9e1 * t6845 - 0.8e1 / 0.9e1 * t6848 - 0.16e2 / 0.9e1 * t6851 - 0.16e2 / 0.9e1 * t6854 + 0.56e2 / 0.27e2 * t6857 + 0.2e1 / 0.3e1 * t6861 + 0.8e1 / 0.9e1 * t6865 - 0.4e1 / 0.3e1 * t6869 - 0.16e2 / 0.9e1 * t6872 - 0.16e2 / 0.27e2 * t6875 + 0.2e1 / 0.27e2 * t6878;
  t8008 = 0.4e1 / 0.9e1 * t6882 + 0.2e1 / 0.3e1 * t6886 + 0.4e1 / 0.9e1 * t6888 + 0.104e3 / 0.27e2 * t5036 + t5041 + 0.56e2 / 0.27e2 * t5043 + t5047 + 0.56e2 / 0.27e2 * t5050 + t5055 - 0.4e1 / 0.9e1 * t5061 - 0.16e2 / 0.27e2 * t5064 - t5072 + t5078 / 0.9e1 + 0.2e1 / 0.9e1 * t5086;
  t8016 = -0.8e1 / 0.9e1 * t5089 - t5093 - 0.16e2 / 0.9e1 * t5095 - t5100 + 0.2e1 / 0.27e2 * t5104 + t5110 + 0.4e1 / 0.9e1 * t5113 + t5121 - 0.112e3 / 0.27e2 * t5123 - t5128 + t5132 - t5135 - t5139;
  t8026 = -0.4e1 / 0.9e1 * t5141 - 0.4e1 / 0.9e1 * t5144 + 0.8e1 / 0.9e1 * t5147 - t5152 + 0.4e1 / 0.27e2 * t5154 + 0.4e1 / 0.27e2 * t5158 + t5165 + t5167 / 0.27e2 + 0.2e1 / 0.27e2 * t5170 - 0.1e2 / 0.27e2 * t5172 - 0.1e2 / 0.27e2 * t5174 - t5179 + t5183 - t5187;
  t8034 = t955 * t956 * t3519;
  t8037 = t955 * t956 * t3527;
  t8040 = t955 * t956 * t3511;
  t8042 = t5191 + 0.2e1 / 0.27e2 * t5193 + t5200 + t5205 + t5209 + 0.2e1 / 0.27e2 * t5214 + t5216 / 0.27e2 + t5218 / 0.27e2 + t5223 + t5225 / 0.27e2 + 0.2e1 / 0.27e2 * t8034 + t8037 / 0.27e2 + t8040 / 0.27e2;
  t8052 = 0.8e1 / 0.9e1 * t5228 + t5233 + t5236 + 0.52e2 / 0.81e2 * t5237 + 0.4e1 / 0.27e2 * t5240 + t5251 + t5258 + 0.4e1 / 0.27e2 * t5260 + 0.4e1 / 0.27e2 * t5263 + 0.4e1 / 0.27e2 * t5267 + 0.4e1 / 0.27e2 * t5270 + 0.2e1 / 0.27e2 * t5273 + 0.2e1 / 0.27e2 * t5276 + t5281;
  t8068 = -t5285 - t5286 / 0.9e1 - t5289 / 0.9e1 + 0.2e1 / 0.27e2 * t5292 + 0.2e1 / 0.27e2 * t5295 + 0.4e1 / 0.27e2 * t5298 - t5320 / 0.9e1 - t5323 / 0.9e1 - 0.2e1 / 0.9e1 * t5325 - 0.2e1 / 0.9e1 * t5328 - t5341 - 0.5e1 / 0.27e2 * t5351 - 0.22e2 / 0.27e2 * t5353;
  t8078 = 0.52e2 / 0.81e2 * t5356 + 0.4e1 / 0.27e2 * t5359 - t5366 + t5371 - 0.22e2 / 0.27e2 * t5373 + 0.2e1 / 0.27e2 * t5375 - 0.22e2 / 0.27e2 * t5378 + 0.2e1 / 0.27e2 * t5380 + 0.4e1 / 0.27e2 * t5383 - t5386 - 0.5e1 / 0.27e2 * t5387 - 0.22e2 / 0.27e2 * t5389 - t5393;
  t8091 = 0.2e1 / 0.27e2 * t5396 + 0.2e1 / 0.27e2 * t5400 + t5405 + t5412 + t5413 / 0.81e2 + t5415 / 0.81e2 + t5417 / 0.54e2 + t5421 / 0.27e2 + t5423 / 0.27e2 + 0.2e1 / 0.27e2 * t5427 + t5429 / 0.54e2 + t5433 / 0.27e2 - 0.1e2 / 0.27e2 * t5436;
  t8095 = t334 * t336 * t7815;
  t8142 = t150 * t151 * t7422 / 0.8e1 + t470 * t2866 / 0.4e1 + t818 * t1311 / 0.8e1 + t354 * t3424 / 0.4e1 - 0.2e1 / 0.3e1 * t144 * t357 * t3199 + t144 * t145 * t7393 / 0.8e1 + t3429 * t368 / 0.4e1 + t1315 * t841 / 0.8e1 - 0.2e1 / 0.3e1 * t477 * t2876 + t477 * t2883 / 0.4e1 + 0.11e2 / 0.9e1 * t836 * t1323 + 0.22e2 / 0.9e1 * t365 * t3444 + 0.11e2 / 0.9e1 * t150 * t1322 * t615 - 0.2e1 / 0.3e1 * t836 * t1326 - 0.4e1 / 0.3e1 * t365 * t3449 - 0.2e1 / 0.3e1 * t150 * t480 * t2549 + t3406 * t361 / 0.4e1 - 0.2e1 / 0.3e1 * t1306 * t829 + t1306 * t832 / 0.8e1 - 0.4e1 / 0.3e1 * t470 * t2863;
  t8181 = -0.7e1 / 0.48e2 * t70 * t7424 + t1148 * t1160 / 0.6e1 + 0.4e1 / 0.9e1 * t1163 * t1170 - t1163 * t1175 / 0.6e1 + t2895 * t484 / 0.4e1 - t2890 * t473 / 0.4e1 - 0.4e1 / 0.9e1 * t1148 * t1157 - 0.2e1 / 0.3e1 * t2895 * t481 + t5994 + t7102 - t7106;
  t8189 = t334 * t336 * t7784;
  t8191 = 0.52e2 / 0.81e2 * t5439 - 0.1e2 / 0.27e2 * t5442 + t5450 - t5454 - t5458 - t5461 - t5465 + t5469 + t5477 + t5483 + t5488 + 0.2e1 / 0.9e1 * t8095 + t130 * t137 * t138 * (t8142 - 0.2e1 / 0.3e1 * t3406 * t358 + 0.11e2 / 0.9e1 * t1306 * t826 + t2842 * t473 / 0.12e2 + 0.22e2 / 0.9e1 * t470 * t2849 - 0.2e1 / 0.3e1 * t354 * t3421 + 0.11e2 / 0.9e1 * t144 * t825 * t1283 + 0.2e1 / 0.9e1 * t2852 * t481 - t2852 * t484 / 0.12e2 + t836 * t1329 / 0.8e1 + t365 * t3454 / 0.4e1 + t8181) / 0.6e1 + 0.2e1 / 0.9e1 * t8189;
  t8195 = t789 * t792 * t3463;
  t8202 = t334 * t336 * t7805;
  t8205 = t789 * t792 * t3394;
  t8216 = t334 * t336 * t7837;
  t8223 = t334 * t336 * t7772;
  t8226 = t789 * t792 * t3378;
  t8237 = t334 * t336 * t7796;
  t8239 = 0.2e1 / 0.27e2 * t8195 + t130 * t137 * t462 * t2901 / 0.3e1 + 0.4e1 / 0.9e1 * t8202 + 0.4e1 / 0.27e2 * t8205 + t130 * t137 * t805 * t1332 / 0.6e1 + t130 * t137 * t345 * t3458 / 0.3e1 + 0.2e1 / 0.9e1 * t8216 + t130 * t137 * t1265 * t844 / 0.6e1 + 0.2e1 / 0.9e1 * t8223 + 0.2e1 / 0.27e2 * t8226 + t130 * t137 * t2795 * t487 / 0.3e1 + 0.2e1 / 0.3e1 * t130 * t137 * t1197 * t1178 + 0.4e1 / 0.9e1 * t8237;
  t8250 = t768 * t312 * t1444;
  t8254 = t768 * t125 * t3546 * params->d;
  t8258 = t130 * t137 * t762 * t1332;
  t8262 = t130 * t137 * t2940 * t487;
  t8267 = t130 * t137 * t568 * t1264 * t155;
  t8271 = t130 * t137 * t796 * t1332;
  t8275 = t130 * t137 * t340 * t3458;
  t8278 = t334 * t849 * t3463;
  t8282 = t130 * t137 * t2917 * t487;
  t8286 = t130 * t137 * t1187 * t1178;
  t8289 = t334 * t849 * t3394;
  t8294 = t130 * t137 * t169 * t3095 * t155;
  t8296 = t130 * t137 * t4 * t7429 * t155 / 0.6e1 + t130 * t137 * t3368 * t371 / 0.3e1 + 0.4e1 / 0.9e1 * t8250 + 0.4e1 / 0.9e1 * t8254 + 0.2e1 / 0.27e2 * t8258 + 0.4e1 / 0.27e2 * t8262 + 0.2e1 / 0.27e2 * t8267 - t8271 / 0.9e1 - t8275 / 0.9e1 - 0.7e1 / 0.27e2 * t8278 - 0.2e1 / 0.9e1 * t8282 - 0.2e1 / 0.9e1 * t8286 - 0.14e2 / 0.27e2 * t8289 - t8294 / 0.9e1;
  t8300 = t130 * t137 * t3467 * t371;
  t8303 = t334 * t849 * t3378;
  t8314 = -t8300 / 0.9e1 - 0.7e1 / 0.27e2 * t8303 + t5491 - 0.2e1 / 0.9e1 * t5494 - 0.4e1 / 0.9e1 * t5496 - t5501 + 0.2e1 / 0.9e1 * t6995 + 0.4e1 / 0.9e1 * t7002 + 0.8e1 / 0.27e2 * t7005 + 0.16e2 / 0.9e1 * t7008 + 0.8e1 / 0.9e1 * t7011 + 0.4e1 / 0.9e1 * t7014 + 0.16e2 / 0.9e1 * t7018;
  t8329 = 0.8e1 / 0.9e1 * t7020 + 0.8e1 / 0.9e1 * t7024 - 0.32e2 / 0.9e1 * t7026 - 0.32e2 / 0.9e1 * t7028 + 0.2e1 / 0.9e1 * t7118 + 0.8e1 / 0.27e2 * t7121 + 0.8e1 / 0.81e2 * t7124 + 0.2e1 / 0.9e1 * t7137 + 0.4e1 / 0.9e1 * t7144 + 0.8e1 / 0.27e2 * t7147 + 0.2e1 / 0.9e1 * t7154 + 0.8e1 / 0.27e2 * t7157 + 0.8e1 / 0.81e2 * t7160 + 0.8e1 / 0.27e2 * t7173;
  t8346 = 0.134e3 / 0.81e2 * t7177 + 0.8e1 / 0.27e2 * t7181 - 0.8e1 / 0.9e1 * t7184 + 0.8e1 / 0.27e2 * t7189 - 0.28e2 / 0.27e2 * t7192 - t7196 / 0.9e1 - 0.28e2 / 0.27e2 * t7199 - 0.8e1 / 0.9e1 * t7202 - t7206 / 0.9e1 - 0.2e1 / 0.9e1 * t7210 - 0.28e2 / 0.27e2 * t7213 - t7217 / 0.9e1 - 0.28e2 / 0.27e2 * t7224;
  t8361 = -t7229 / 0.9e1 - 0.2e1 / 0.9e1 * t7233 - 0.28e2 / 0.81e2 * t7237 - 0.28e2 / 0.81e2 * t7242 + 0.134e3 / 0.81e2 * t7245 + 0.8e1 / 0.27e2 * t7249 - 0.32e2 / 0.9e1 * t5798 - 0.32e2 / 0.9e1 * t5802 + 0.4e1 / 0.9e1 * t5805 + 0.8e1 / 0.9e1 * t5807 + 0.4e1 / 0.9e1 * t5810 + 0.4e1 / 0.9e1 * t5814 + 0.8e1 / 0.9e1 * t5816 + 0.8e1 / 0.9e1 * t5820;
  t8373 = t5825 + t5827 + 0.2e1 / 0.27e2 * t5831 + 0.4e1 / 0.27e2 * t5835 + 0.2e1 / 0.27e2 * t5839 - 0.7e1 / 0.27e2 * t5842 - 0.8e1 / 0.9e1 * t5845 - t5851 - 0.14e2 / 0.27e2 * t5853 - 0.8e1 / 0.9e1 * t5856 - 0.7e1 / 0.27e2 * t5859 + 0.2e1 / 0.27e2 * t5877 + 0.4e1 / 0.27e2 * t5883;
  t8376 = 0.8e1 / 0.81e2 * t5886 + t5893 + t5900 - t5902 - t5904 - t5907 - t5909 + t5912 + t5914 + t5916 + t5918 - t5922 + t5926 - 0.28e2 / 0.81e2 * t5929;
  t8385 = t167 * t923 * t3538;
  t8388 = t195 * t928 * t3542;
  t8391 = t201 * t3546 * t932;
  t8395 = t167 * t170 * t3095 * t16;
  t8398 = t918 * t919 * t3538;
  t8402 = t195 * t196 * t16 * t3343;
  t8404 = -0.28e2 / 0.81e2 * t5934 + t5939 + 0.134e3 / 0.81e2 * t5942 + 0.134e3 / 0.81e2 * t5945 + 0.2e1 / 0.27e2 * t6034 + 0.8e1 / 0.81e2 * t6037 + t6050 + 0.8e1 / 0.9e1 * t8385 - 0.4e1 / 0.9e1 * t8388 - 0.4e1 / 0.9e1 * t8391 - 0.4e1 / 0.3e1 * t8395 - 0.4e1 / 0.9e1 * t8398 + 0.2e1 / 0.3e1 * t8402;
  t8406 = t940 * t907 * t3542;
  t8410 = t201 * t184 * t3343 * t203;
  t8414 = t201 * t575 * t1443 * t949;
  t8422 = t8406 / 0.9e1 + 0.2e1 / 0.3e1 * t8410 + 0.2e1 / 0.9e1 * t8414 - t6 * t7429 * t16 + 0.32e2 / 0.9e1 * t6053 - 0.4e1 / 0.9e1 * t6057 - 0.8e1 / 0.9e1 * t6063 - 0.8e1 / 0.9e1 * t6067 + t6071 - t6074 - t6078 - t6081 - t6085 + t6089;
  t8428 = t1348 * t569;
  t8431 = -0.16e2 / 0.9e1 * t6090 - t6095 - t6099 + 0.2e1 / 0.9e1 * t6102 + 0.2e1 / 0.9e1 * t6104 + 0.4e1 / 0.9e1 * t6108 + t6114 + t6118 + t6122 + t6126 + 0.4e1 / 0.9e1 * t8428 - 0.56e2 / 0.27e2 * t7304 - t6130;
  t8443 = t6133 + 0.112e3 / 0.27e2 * t6135 - 0.8e1 / 0.9e1 * t6138 - 0.104e3 / 0.27e2 * t6140 - t6144 + 0.4e1 / 0.9e1 * t6149 + 0.16e2 / 0.27e2 * t6151 + t6155 + 0.112e3 / 0.27e2 * t7314 + 0.16e2 / 0.9e1 * t7317 + 0.16e2 / 0.27e2 * t7319 - 0.32e2 / 0.9e1 * t7322 - 0.104e3 / 0.27e2 * t7324 + 0.4e1 / 0.3e1 * t7327;
  tv4rho42 = 0.2e1 * t6162 + 0.2e1 * t7337 + t161 * (t8431 + t7937 + t8314 + t8008 + t8376 + t7865 + t8026 + t8191 + t8422 + t7952 + t8091 + t8078 + t8373 + t8329 + t8361 + t8296 + t7771 + t7982 + t8443 + t8068 + t8239 + t7922 + t7969 + t7907 + t8346 + t7997 + t8404 + t7824 + t8052 + t8042 + t8016 + t7891);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 2] += tv4rho42;

  t8451 = params->a * t3856;
  t8455 = -t6346 - t5012;
  t8462 = t6165 + 0.8e1 / 0.3e1 * t6166 - t6560 - 0.2e1 / 0.3e1 * t6561 - t7344 - 0.2e1 / 0.3e1 * t7346 - t6 * t8455 * t16 + 0.8e1 / 0.9e1 * t5018 - 0.4e1 / 0.3e1 * t7760 + 0.2e1 / 0.3e1 * t7764 + t7769 / 0.6e1;
  t8475 = t7774 / 0.6e1 + t7779 / 0.6e1 + 0.2e1 / 0.9e1 * t7782 + t7786 / 0.6e1 + t7791 / 0.6e1 + 0.2e1 / 0.9e1 * t7794 + t7798 / 0.3e1 + t7803 / 0.3e1 + t7807 / 0.3e1 + t7812 / 0.3e1 + t7817 / 0.6e1 + 0.2e1 / 0.9e1 * t7820;
  t8489 = -t7822 / 0.3e1 - t7827 / 0.3e1 + t7829 / 0.18e2 + 0.4e1 / 0.9e1 * t7832 + 0.4e1 / 0.9e1 * t7835 + t7839 / 0.6e1 + t7844 / 0.6e1 - t7846 / 0.3e1 - t7849 / 0.3e1 + t7851 / 0.18e2 + t7853 / 0.9e1 + 0.2e1 / 0.9e1 * t7857;
  t8496 = t3569 * t186;
  t8498 = t252 * t3590;
  t8507 = t177 * t1279;
  t8517 = 0.12e2 * t589 + 0.24e2 * t5009;
  t8521 = my_piecewise3(t49, 0, -0.8e2 / 0.81e2 * t5549 * t3580 * t229 + 0.16e3 / 0.9e1 * t3188 * t587 + 0.8e2 / 0.9e1 * t2520 * t3117 + 0.8e2 / 0.3e1 * t2523 * t8507 + 0.4e2 / 0.3e1 * t987 * t3121 + 0.4e2 / 0.9e1 * t56 * t3586 * t229 + 0.8e1 / 0.3e1 * t228 * t8517);
  t8522 = t79 * t8521;
  t8524 = t3616 * t237;
  t8526 = t1288 * t1002;
  t8528 = t408 * t3163;
  t8537 = t177 * t1296;
  t8545 = -t8517;
  t8549 = my_piecewise3(t60, 0, -0.8e2 / 0.81e2 * t5570 * t3591 * t234 - 0.16e3 / 0.9e1 * t3151 * t587 + 0.8e2 / 0.9e1 * t2535 * t3170 - 0.8e2 / 0.3e1 * t2538 * t8537 + 0.4e2 / 0.3e1 * t995 * t3159 + 0.4e2 / 0.9e1 * t63 * t3596 * t234 + 0.8e1 / 0.3e1 * t233 * t8545);
  t8550 = t86 * t8549;
  t8582 = my_piecewise3(t60, 0, -0.12e2 * t1296 * t587 + 0.2e1 * t234 * t3596 + 0.6e1 * t3159 * t393 + 0.2e1 * t59 * t8545);
  t8592 = -0.16e2 / 0.9e1 * t8498 + 0.2e1 / 0.3e1 * t8522 - 0.2464e4 / 0.81e2 * t8524 + 0.176e3 / 0.9e1 * t8526 - 0.16e2 / 0.3e1 * t8528 + 0.2e1 / 0.3e1 * t8550 + 0.4e1 * t438 * t3146 - 0.3e1 / 0.4e1 * t1084 * t1425 - 0.3e1 / 0.4e1 * t438 * t3164 - 0.22e2 / 0.3e1 * t288 * t3689 - 0.22e2 / 0.3e1 * t110 * t1287 * t1002 + 0.2e1 * t288 * t3692 + 0.2e1 * t110 * t407 * t3163 - t288 * t3695 / 0.4e1 - t110 * t85 * t8549 / 0.4e1 - t8582 * sigma[0] * t116 / 0.4e1 - t3704 * t303 / 0.4e1 - 0.3e1 / 0.4e1 * t3176 * t453 - 0.3e1 / 0.4e1 * t1432 * t1118;
  t8626 = my_piecewise3(t49, 0, 0.12e2 * t1279 * t587 + 0.2e1 * t229 * t3586 + 0.6e1 * t3121 * t389 + 0.2e1 * t48 * t8517);
  t8645 = -0.3e1 / 0.4e1 * t1106 * t1437 - 0.3e1 / 0.4e1 * t450 * t3200 + 0.2e1 / 0.3e1 * t3704 * t300 + 0.2e1 * t1432 * t1115 + 0.2e1 * t450 * t3207 + 0.2e1 / 0.3e1 * t115 * t251 * t3590 + 0.2e1 * t1412 * t1091 - 0.22e2 / 0.3e1 * t1084 * t1419 - 0.22e2 / 0.3e1 * t438 * t3141 + 0.308e3 / 0.27e2 * t288 * t3666 + 0.308e3 / 0.27e2 * t110 * t3615 * t237 - t8626 * sigma[2] * t111 / 0.4e1 - t3680 * t291 / 0.4e1 - 0.3e1 / 0.4e1 * t3126 * t444 - 0.3e1 / 0.4e1 * t1412 * t1096 + 0.4e1 * t1084 * t1422 - t297 * t3711 / 0.4e1 - t115 * t78 * t8521 / 0.4e1 + 0.2e1 * t3126 * t441;
  t8667 = -t70 * (t8592 + t8645) / 0.8e1 + 0.3e1 / 0.16e2 * t7348 + 0.3e1 / 0.16e2 * t7350 + 0.3e1 / 0.32e2 * t7356 + 0.3e1 / 0.32e2 * t7361 + 0.3e1 / 0.32e2 * t7364 + t7433 / 0.192e3 + t7438 / 0.192e3 + t7440 / 0.192e3 + t7446 / 0.96e2 + t7450 / 0.96e2 + t7452 / 0.96e2 + t7460 / 0.192e3 + t7465 / 0.192e3 + t7468 / 0.192e3 + 0.3e1 / 0.32e2 * t7557 + 0.3e1 / 0.32e2 * t7561 + 0.3e1 / 0.32e2 * t7563 + 0.3e1 / 0.16e2 * t7569;
  t8670 = t3568 * t220;
  t8682 = t209 * t3721;
  t8688 = t401 * t3319;
  t8695 = t71 * t264 * t3658;
  t8714 = my_piecewise3(t49, 0, 0.88e3 / 0.81e2 * t3581 * t229 + 0.88e3 / 0.9e1 * t1276 * t587 + 0.44e3 / 0.9e1 * t987 * t3117 + 0.176e3 / 0.3e1 * t990 * t8507 + 0.88e2 / 0.3e1 * t390 * t3121 + 0.88e2 / 0.9e1 * t3587 * t229 + 0.11e2 / 0.3e1 * t57 * t8517);
  t8737 = my_piecewise3(t60, 0, 0.88e3 / 0.81e2 * t3592 * t234 - 0.88e3 / 0.9e1 * t1294 * t587 + 0.44e3 / 0.9e1 * t995 * t3170 - 0.176e3 / 0.3e1 * t998 * t8537 + 0.88e2 / 0.3e1 * t394 * t3159 + 0.88e2 / 0.9e1 * t3597 * t234 + 0.11e2 / 0.3e1 * t64 * t8545);
  t8743 = t3605 * t246;
  t8749 = t1365 * t1017;
  t8751 = -t30 * (t8455 * t35 / 0.72e2 + t8670 / 0.72e2 + t7739 / 0.24e2 + t7741 / 0.24e2 + t6545 + t6546 / 0.24e2 + t5510 / 0.72e2 + t5526) - t6171 + 0.1232e4 / 0.9e1 * t6172 + 0.1232e4 / 0.27e2 * t5529 - t5535 - 0.88e2 / 0.3e1 * t7695 + 0.8e1 * t7697 + 0.8e1 / 0.3e1 * t8682 + t1365 * t1063 / 0.192e3 + t1008 * t1396 / 0.192e3 + t8688 / 0.192e3 + t401 * t3276 / 0.192e3 + t242 * t3659 / 0.576e3 + t8695 / 0.576e3 + t71 * t92 * (-0.8e1 / 0.3e1 * t252 * t3641 + t79 * t8714 - 0.1232e4 / 0.27e2 * t3616 * t276 + 0.88e2 / 0.3e1 * t1288 * t1060 - 0.8e1 * t408 * t3273 + t86 * t8737) / 0.576e3 + t8743 / 0.32e2 + t3605 * t258 / 0.32e2 + 0.3e1 / 0.32e2 * t3279 * t413 + 0.3e1 / 0.32e2 * t8749;
  t8757 = t401 * t3294;
  t8764 = t71 * t245 * t3624;
  t8770 = -0.8e1 / 0.3e1 * t8498 + t8522 - 0.1232e4 / 0.27e2 * t8524 + 0.88e2 / 0.3e1 * t8526 - 0.8e1 * t8528 + t8550;
  t8774 = t70 * t8455;
  t8777 = t3605 * t265;
  t8783 = t1365 * t1039;
  t8806 = 0.3e1 / 0.32e2 * t1365 * t1027 + 0.3e1 / 0.32e2 * t1008 * t1370 + 0.3e1 / 0.32e2 * t8757 + 0.3e1 / 0.32e2 * t401 * t3301 + t242 * t3625 / 0.32e2 + t8764 / 0.32e2 + t71 * t73 * t8770 / 0.32e2 + t8774 * t104 / 0.576e3 + t8777 / 0.576e3 + t3605 * t279 / 0.576e3 + t3279 * t429 / 0.192e3 + t8783 / 0.192e3 - 0.3e1 / 0.2e2 * t45 * t8455 * t66 - 0.3e1 / 0.2e2 * t45 * t3568 * t238 - 0.9e1 / 0.2e2 * t45 * t3095 * t397 - 0.9e1 / 0.2e2 * t45 * t1264 * t1003 - 0.9e1 / 0.2e2 * t45 * t1007 * t1361 - 0.9e1 / 0.2e2 * t45 * t379 * t3337 - 0.3e1 / 0.2e2 * t45 * t180 * t3601;
  t8821 = -0.3e1 / 0.2e2 * t45 * t12 * (t8521 + t8549) + t8774 * t89 / 0.32e2 + t6382 + 0.3e1 / 0.32e2 * t6387 + t6390 + t6402 + 0.3e1 / 0.32e2 * t6408 + t6412 + t6431 / 0.192e3 + t6435 + t6500 + t6505 / 0.192e3 + t6508 + t6520 + t5664 + t5666 / 0.576e3 + t5722 / 0.576e3 + t5739 + t5741 / 0.32e2 + t5773 / 0.32e2;
  t8827 = t190 * t191 * t3738;
  t8830 = t7861 / 0.9e1 - 0.2e1 / 0.3e1 * t7863 - 0.2e1 / 0.3e1 * t7867 + 0.2e1 / 0.9e1 * t7870 + t7874 / 0.9e1 - 0.28e2 / 0.27e2 * t5020 - t5024 + t5027 - t8496 / 0.3e1 + t21 * t24 * (t8667 + t8751 + t8806 + t8821) + 0.2e1 / 0.3e1 * t8827 + 0.2e1 * t7878;
  t8842 = 0.4e1 / 0.3e1 * t7881 - 0.8e1 / 0.3e1 * t7884 + t6568 / 0.9e1 + t6570 / 0.18e2 + t6573 / 0.9e1 - 0.5e1 / 0.9e1 * t6575 - 0.5e1 / 0.9e1 * t6577 + 0.2e1 / 0.9e1 * t6580 + t6584 + t6587 + 0.2e1 / 0.9e1 * t6589;
  t8846 = t130 * t137 * t3467 * t487;
  t8883 = t5994 - t1306 * t1157 - t470 * t3421 - t144 * t357 * t3590 / 0.3e1 - 0.2e1 * t477 * t3449 + 0.3e1 / 0.8e1 * t477 * t3454 + 0.11e2 / 0.3e1 * t365 * t3804 + 0.11e2 / 0.3e1 * t150 * t1322 * t1002 - t365 * t3807 - t150 * t480 * t3163 + t365 * t3809 / 0.8e1 + t150 * t151 * t8549 / 0.8e1 - t3429 * t481 - t1315 * t1170 + 0.11e2 / 0.3e1 * t477 * t3444 - 0.154e3 / 0.27e2 * t365 * t3781 - 0.154e3 / 0.27e2 * t150 * t3780 * t237;
  t8886 = 0.2e1 * t589 + 0.4e1 * t5009;
  t8925 = t8886 * sigma[0] * t146 / 0.8e1 + t3784 * t361 / 0.8e1 + 0.3e1 / 0.8e1 * t3406 * t473 + 0.3e1 / 0.8e1 * t1306 * t1160 + 0.3e1 / 0.8e1 * t470 * t3424 + t354 * t3791 / 0.8e1 + t144 * t145 * t8521 / 0.8e1 - t8886 * sigma[2] * t152 / 0.8e1 + t3795 * t368 / 0.8e1 + 0.3e1 / 0.8e1 * t3429 * t484 + 0.3e1 / 0.8e1 * t1315 * t1175 - t3784 * t358 / 0.3e1 - 0.7e1 / 0.48e2 * t70 * t8770 - 0.11e2 / 0.9e1 * t1163 * t1323 + t1148 * t1311 / 0.8e1 + 0.2e1 / 0.3e1 * t1163 * t1326 - t1163 * t1329 / 0.8e1;
  t8931 = t318 * t3814;
  t8933 = t334 * t336 * t8931;
  t8945 = t136 * t3568 * t155;
  t8947 = t334 * t336 * t8945;
  t8957 = t6593 + t6596 + t6597 / 0.18e2 - t8846 / 0.6e1 + t130 * t137 * t345 * t3814 / 0.6e1 + t130 * t137 * t138 * (t8883 + t8925) / 0.6e1 + t8933 / 0.9e1 + t130 * t137 * t4 * t8455 * t155 / 0.6e1 + t130 * t137 * t3764 * t371 / 0.6e1 + t8947 / 0.9e1 + t130 * t137 * t3368 * t487 / 0.2e1 + t130 * t137 * t1265 * t1178 / 0.2e1;
  t8959 = t3377 * t487;
  t8961 = t334 * t336 * t8959;
  t8971 = t1137 * t1332;
  t8973 = t334 * t336 * t8971;
  t8977 = t130 * t137 * t1187 * t1332;
  t8981 = t130 * t137 * t340 * t3814;
  t8986 = t130 * t137 * t169 * t3568 * t155;
  t8990 = t8961 / 0.3e1 + t130 * t137 * t1197 * t1332 / 0.2e1 + t130 * t137 * t462 * t3458 / 0.2e1 + t8973 / 0.3e1 - t8977 / 0.6e1 - t8981 / 0.18e2 - t8986 / 0.18e2 + t6603 + t6606 + 0.4e1 / 0.3e1 * t6627 + 0.2e1 / 0.9e1 * t6630 + t6653;
  t8994 = t6656 + 0.2e1 / 0.9e1 * t6667 - t6670 - t6673 + t6676 + t6679 + 0.2e1 / 0.9e1 * t6690 + t6698 + t6701 + t6704 + 0.2e1 / 0.9e1 * t6706 - t6710;
  t9002 = 0.2e1 / 0.9e1 * t6712 - t6715 - t6718 + t6722 - 0.11e2 / 0.9e1 * t6723 - 0.11e2 / 0.9e1 * t6726 + t6729 / 0.9e1 - t6732 - t6735 + t6737 + t6739;
  t9014 = 0.26e2 / 0.27e2 * t6740 + 0.26e2 / 0.27e2 * t6743 - 0.5e1 / 0.18e2 * t6745 - 0.5e1 / 0.9e1 * t6748 + t6750 / 0.54e2 + 0.2e1 / 0.9e1 * t6753 + 0.26e2 / 0.27e2 * t6755 + 0.26e2 / 0.27e2 * t6760 - 0.11e2 / 0.9e1 * t6762 - 0.11e2 / 0.9e1 * t6765 + t6767 / 0.9e1 + t6770;
  t9022 = t6774 + t6776 + t6780 - t6782 + t6783 / 0.54e2 + t6787 / 0.9e1 - 0.5e1 / 0.18e2 * t6789 - 0.5e1 / 0.9e1 * t6793 + t6797 / 0.9e1 + 0.26e2 / 0.81e2 * t5028 + t5032 + t5034;
  t9032 = 0.16e2 / 0.3e1 * t6802 - t6807 - 0.4e1 / 0.3e1 * t6810 - 0.4e1 / 0.3e1 * t6814 - 0.8e1 / 0.3e1 * t6816 + t6821 + t6822 / 0.3e1 + 0.2e1 / 0.3e1 * t6830 - 0.56e2 / 0.9e1 * t6833 + 0.28e2 / 0.9e1 * t6836 + t6840 + 0.52e2 / 0.9e1 * t6842;
  t9041 = -t6846 - 0.4e1 / 0.3e1 * t6848 - t6852 - 0.8e1 / 0.3e1 * t6854 + 0.28e2 / 0.9e1 * t6857 + t6866 - t6873 - 0.8e1 / 0.9e1 * t6875 + t6878 / 0.9e1 + 0.2e1 / 0.3e1 * t6882 + t6889;
  t9048 = 0.52e2 / 0.27e2 * t5036 + t5041 + 0.28e2 / 0.27e2 * t5043 + t5047 + 0.28e2 / 0.27e2 * t5050 + t5055 - 0.8e1 / 0.27e2 * t5064 - t5072 - 0.4e1 / 0.9e1 * t5089 - t5093 - 0.8e1 / 0.9e1 * t5095 - t5100;
  t9055 = t195 * t196 * t16 * t3737;
  t9059 = t201 * t184 * t3737 * t203;
  t9063 = t167 * t170 * t3568 * t16;
  t9065 = t5104 / 0.27e2 + t5110 + 0.2e1 / 0.9e1 * t5113 + t5121 - 0.56e2 / 0.27e2 * t5123 - t5128 + t5132 - t5135 - t5139 + t9055 / 0.3e1 + t9059 / 0.3e1 - 0.2e1 / 0.3e1 * t9063;
  t9071 = -t5152 + 0.2e1 / 0.27e2 * t5154 + 0.2e1 / 0.27e2 * t5158 + t5165 - 0.5e1 / 0.27e2 * t5172 - 0.5e1 / 0.27e2 * t5174 - t5179 + t5183 - t5187 + t5191 + t5193 / 0.27e2 + t5200;
  t9083 = t5205 + t5209 + t5214 / 0.27e2 + t5216 / 0.54e2 + t5218 / 0.54e2 + t5223 + 0.2e1 / 0.9e1 * t8034 + t8037 / 0.9e1 + t8040 / 0.9e1 + 0.4e1 / 0.9e1 * t5228 + t5233;
  t9090 = t5236 + 0.26e2 / 0.81e2 * t5237 + 0.2e1 / 0.27e2 * t5240 + t5251 + t5258 + 0.2e1 / 0.27e2 * t5267 + 0.2e1 / 0.27e2 * t5270 + t5281 - t5285 + 0.2e1 / 0.27e2 * t5298 - t5341 - 0.5e1 / 0.54e2 * t5351;
  t9101 = -0.11e2 / 0.27e2 * t5353 + 0.26e2 / 0.81e2 * t5356 + 0.2e1 / 0.27e2 * t5359 - t5366 + t5371 - 0.11e2 / 0.27e2 * t5373 + t5375 / 0.27e2 - 0.11e2 / 0.27e2 * t5378 + t5380 / 0.27e2 + 0.2e1 / 0.27e2 * t5383 - t5386 - 0.5e1 / 0.54e2 * t5387;
  t9110 = -0.11e2 / 0.27e2 * t5389 - t5393 + t5396 / 0.27e2 + t5400 / 0.27e2 + t5405 + t5412 + t5413 / 0.162e3 + t5415 / 0.162e3 - 0.5e1 / 0.27e2 * t5436 + 0.26e2 / 0.81e2 * t5439 - 0.5e1 / 0.27e2 * t5442 + t5450;
  t9116 = -t5454 - t5458 - t5461 - t5465 + t5469 + t5477 + t5483 + t5488 + t8095 / 0.3e1 + t8189 / 0.3e1 + 0.2e1 / 0.9e1 * t8195;
  t9129 = 0.2e1 / 0.3e1 * t8202 + 0.4e1 / 0.9e1 * t8205 + t8216 / 0.3e1 + t8223 / 0.3e1 + 0.2e1 / 0.9e1 * t8226 + 0.2e1 / 0.3e1 * t8237 + 0.4e1 / 0.3e1 * t8250 + 0.4e1 / 0.3e1 * t8254 + 0.2e1 / 0.9e1 * t8258 + 0.4e1 / 0.9e1 * t8262 + 0.2e1 / 0.9e1 * t8267 - t8271 / 0.6e1;
  t9140 = -t8275 / 0.6e1 - 0.7e1 / 0.9e1 * t8278 - t8282 / 0.3e1 - t8286 / 0.3e1 - 0.14e2 / 0.9e1 * t8289 - t8294 / 0.6e1 - t8300 / 0.6e1 - 0.7e1 / 0.9e1 * t8303 + t5491 - 0.2e1 / 0.9e1 * t5496 - t5501 + t7006;
  t9148 = t7009 + 0.4e1 / 0.3e1 * t7011 + 0.2e1 / 0.3e1 * t7014 + t7019 + 0.4e1 / 0.3e1 * t7020 + 0.4e1 / 0.3e1 * t7024 - 0.16e2 / 0.3e1 * t7026 - 0.16e2 / 0.3e1 * t7028 + t7122 + 0.4e1 / 0.27e2 * t7124 + t7148 + t7158;
  t9156 = 0.4e1 / 0.27e2 * t7160 + t7174 + 0.67e2 / 0.27e2 * t7177 + t7182 - 0.4e1 / 0.3e1 * t7184 + t7190 - t7193 - t7200 - 0.4e1 / 0.3e1 * t7202 - t7214 - t7225;
  t9166 = -0.14e2 / 0.27e2 * t7237 - 0.14e2 / 0.27e2 * t7242 + 0.67e2 / 0.27e2 * t7245 + t7250 - 0.16e2 / 0.9e1 * t5798 - 0.16e2 / 0.9e1 * t5802 + 0.4e1 / 0.9e1 * t5807 + 0.2e1 / 0.9e1 * t5810 + 0.4e1 / 0.9e1 * t5816 + 0.4e1 / 0.9e1 * t5820 + t5825 + t5827;
  t9171 = -0.4e1 / 0.9e1 * t5845 - t5851 - 0.4e1 / 0.9e1 * t5856 + 0.4e1 / 0.81e2 * t5886 + t5893 + t5900 - t5902 - t5904 - t5907 - t5909 + t5912 + t5914;
  t9178 = t315 * t317 * t8945;
  t9180 = t5916 + t5918 - t5922 + t5926 - 0.14e2 / 0.81e2 * t5929 - 0.14e2 / 0.81e2 * t5934 + t5939 + 0.67e2 / 0.81e2 * t5942 + 0.67e2 / 0.81e2 * t5945 + 0.4e1 / 0.81e2 * t6037 + t6050 + t9178 / 0.18e2;
  t9186 = t325 * t326 * t3568 * t155 * params->d;
  t9189 = t315 * t317 * t8959;
  t9194 = t325 * t326 * t1264 * t487 * params->d;
  t9197 = t315 * t317 * t8971;
  t9202 = t325 * t326 * t379 * t1332 * params->d;
  t9205 = t315 * t317 * t8931;
  t9210 = t325 * t326 * t12 * t3814 * params->d;
  t9217 = t9186 / 0.18e2 + t9189 / 0.6e1 + t9194 / 0.6e1 + t9197 / 0.6e1 + t9202 / 0.6e1 + t9205 / 0.18e2 + t9210 / 0.18e2 + 0.8e1 / 0.3e1 * t8385 - 0.4e1 / 0.3e1 * t8388 - 0.4e1 / 0.3e1 * t8391 - 0.2e1 * t8395 - 0.4e1 / 0.3e1 * t8398;
  t9223 = t8402 + t8406 / 0.3e1 + t8410 + 0.2e1 / 0.3e1 * t8414 + 0.16e2 / 0.9e1 * t6053 - 0.4e1 / 0.9e1 * t6063 - 0.4e1 / 0.9e1 * t6067 + t6071 - t6074 - t6078 - t6081 - t6085;
  t9230 = t6089 - 0.8e1 / 0.9e1 * t6090 - t6095 - t6099 + t6104 / 0.9e1 + 0.2e1 / 0.9e1 * t6108 + t6114 + t6118 + t6122 + t6126 + 0.4e1 / 0.3e1 * t8428 - 0.28e2 / 0.9e1 * t7304;
  t9237 = -t6130 + t6133 + 0.56e2 / 0.27e2 * t6135 - 0.52e2 / 0.27e2 * t6140 - t6144 + 0.8e1 / 0.27e2 * t6151 + t6155 + 0.56e2 / 0.9e1 * t7314 + t7318 + 0.8e1 / 0.9e1 * t7319 - t7323 - 0.52e2 / 0.9e1 * t7324;
  tv4rho43 = 0.3e1 * t7337 + t8451 + t161 * (t9166 + t9156 + t9237 + t9071 + t9116 + t9140 + t9230 + t9002 + t8994 + t9180 + t8842 + t9223 + t9048 + t9083 + t9032 + t9217 + t8489 + t9171 + t8475 + t9101 + t8830 + t9148 + t9110 + t9090 + t9041 + t9014 + t9129 + t8990 + t9022 + t8957 + t8462 + t9065);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 3] += tv4rho43;

  t9247 = -t5008 - t5010 - t5012;
  t9260 = 0.32e2 / 0.9e1 * t6166 - 0.8e1 / 0.9e1 * t6561 - t6 * t9247 * t16 - 0.4e1 / 0.3e1 * t7346 - 0.8e1 / 0.3e1 * t7760 + 0.4e1 / 0.3e1 * t7764 + 0.4e1 / 0.9e1 * t7782 + 0.4e1 / 0.9e1 * t7794 + 0.4e1 / 0.9e1 * t7820 - 0.2e1 / 0.3e1 * t7822 - 0.2e1 / 0.3e1 * t7827 + t7829 / 0.9e1 + 0.8e1 / 0.9e1 * t7832;
  t9272 = t1275 * t1275;
  t9277 = t1279 * t1279;
  t9282 = t589 + t5009;
  t9283 = 0.24e2 * t9282;
  t9287 = my_piecewise3(t49, 0, -0.8e2 / 0.81e2 * t5549 * t9272 + 0.16e3 / 0.9e1 * t3188 * t1279 + 0.4e2 / 0.3e1 * t56 * t9277 + 0.16e3 / 0.9e1 * t987 * t3586 + 0.8e1 / 0.3e1 * t228 * t9283);
  t9288 = t79 * t9287;
  t9291 = 0.1e1 / t83 / t1285 / t81;
  t9292 = sigma[2] * t9291;
  t9293 = t9292 * t65;
  t9295 = t3616 * t396;
  t9297 = t1288 * t1300;
  t9299 = t408 * t3600;
  t9301 = t1293 * t1293;
  t9306 = t1296 * t1296;
  t9311 = -t9283;
  t9315 = my_piecewise3(t60, 0, -0.8e2 / 0.81e2 * t5570 * t9301 + 0.16e3 / 0.9e1 * t3151 * t1296 + 0.4e2 / 0.3e1 * t63 * t9306 + 0.16e3 / 0.9e1 * t995 * t3596 + 0.8e1 / 0.3e1 * t233 * t9311);
  t9316 = t86 * t9315;
  t9317 = t9288 + 0.20944e5 / 0.81e2 * t9293 - 0.4928e4 / 0.27e2 * t9295 + 0.176e3 / 0.3e1 * t9297 - 0.32e2 / 0.3e1 * t9299 + t9316;
  t9345 = -0.7e1 / 0.48e2 * t70 * t9317 + 0.22e2 / 0.3e1 * t1315 * t1323 - 0.616e3 / 0.27e2 * t477 * t3781 + 0.2618e4 / 0.81e2 * t150 * t9291 * t70 * t65 + t477 * t3809 / 0.2e1 + 0.22e2 / 0.3e1 * t150 * t1322 * t1300 - 0.4e1 / 0.3e1 * t150 * t480 * t3600 + t150 * t151 * t9315 / 0.8e1 - 0.4e1 / 0.3e1 * t3795 * t481 - 0.4e1 * t1315 * t1326 + 0.44e2 / 0.3e1 * t477 * t3804;
  t9349 = 0.4e1 * t9282;
  t9372 = -0.616e3 / 0.27e2 * t150 * t3780 * t396 + t9349 * sigma[0] * t146 / 0.8e1 + t3784 * t473 / 0.2e1 + 0.3e1 / 0.4e1 * t1306 * t1311 + t470 * t3791 / 0.2e1 + t144 * t145 * t9287 / 0.8e1 - t9349 * sigma[2] * t152 / 0.8e1 + t3795 * t484 / 0.2e1 + 0.3e1 / 0.4e1 * t1315 * t1329 - 0.4e1 * t477 * t3807 + t5994;
  t9385 = 0.8e1 / 0.9e1 * t7835 - 0.2e1 / 0.3e1 * t7846 - 0.2e1 / 0.3e1 * t7849 + t7851 / 0.9e1 + 0.2e1 / 0.9e1 * t7853 + 0.4e1 / 0.9e1 * t7857 + 0.2e1 / 0.9e1 * t7861 - 0.4e1 / 0.3e1 * t7863 - 0.4e1 / 0.3e1 * t7867 + 0.4e1 / 0.9e1 * t7870 + 0.2e1 / 0.9e1 * t7874 + t130 * t137 * t138 * (t9345 + t9372) / 0.6e1 + t130 * t137 * t1265 * t1332 + 0.2e1 / 0.3e1 * t130 * t137 * t462 * t3814;
  t9406 = t130 * t137 * t4 * t9247 * t155 / 0.6e1 + 0.2e1 / 0.3e1 * t130 * t137 * t3764 * t487 - t5024 + t5027 - 0.4e1 / 0.3e1 * t8496 + 0.8e1 / 0.3e1 * t8827 + 0.8e1 / 0.3e1 * t7881 - 0.16e2 / 0.3e1 * t7884 + 0.4e1 / 0.27e2 * t6568 + 0.2e1 / 0.27e2 * t6570 + 0.4e1 / 0.27e2 * t6573 - 0.2e2 / 0.27e2 * t6575 - 0.2e2 / 0.27e2 * t6577 + 0.8e1 / 0.27e2 * t6580;
  t9421 = 0.8e1 / 0.27e2 * t6589 + 0.2e1 / 0.27e2 * t6597 - 0.2e1 / 0.3e1 * t8846 + 0.4e1 / 0.9e1 * t8933 + 0.4e1 / 0.9e1 * t8947 + 0.4e1 / 0.3e1 * t8961 + 0.4e1 / 0.3e1 * t8973 - 0.2e1 / 0.3e1 * t8977 - 0.2e1 / 0.9e1 * t8981 - 0.2e1 / 0.9e1 * t8986 + 0.16e2 / 0.9e1 * t6627 + 0.8e1 / 0.27e2 * t6630 + 0.8e1 / 0.27e2 * t6667 + 0.8e1 / 0.27e2 * t6690;
  t9438 = 0.8e1 / 0.27e2 * t6706 + 0.8e1 / 0.27e2 * t6712 - 0.44e2 / 0.27e2 * t6723 - 0.44e2 / 0.27e2 * t6726 + 0.4e1 / 0.27e2 * t6729 + 0.104e3 / 0.81e2 * t6740 + 0.104e3 / 0.81e2 * t6743 - 0.1e2 / 0.27e2 * t6745 - 0.2e2 / 0.27e2 * t6748 + 0.2e1 / 0.81e2 * t6750 + 0.8e1 / 0.27e2 * t6753 + 0.104e3 / 0.81e2 * t6755 + 0.104e3 / 0.81e2 * t6760 - 0.44e2 / 0.27e2 * t6762;
  t9451 = -0.44e2 / 0.27e2 * t6765 + 0.4e1 / 0.27e2 * t6767 + 0.2e1 / 0.81e2 * t6783 + 0.4e1 / 0.27e2 * t6787 - 0.1e2 / 0.27e2 * t6789 - 0.2e2 / 0.27e2 * t6793 + 0.4e1 / 0.27e2 * t6797 + t5032 + t5034 + 0.64e2 / 0.9e1 * t6802 - 0.16e2 / 0.9e1 * t6810 - 0.16e2 / 0.9e1 * t6814 - 0.32e2 / 0.9e1 * t6816 + 0.4e1 / 0.9e1 * t6822;
  t9463 = 0.8e1 / 0.9e1 * t6830 - 0.224e3 / 0.27e2 * t6833 + 0.112e3 / 0.27e2 * t6836 + 0.208e3 / 0.27e2 * t6842 - 0.16e2 / 0.9e1 * t6848 - 0.32e2 / 0.9e1 * t6854 + 0.112e3 / 0.27e2 * t6857 - 0.32e2 / 0.27e2 * t6875 + 0.4e1 / 0.27e2 * t6878 + 0.8e1 / 0.9e1 * t6882 + t5041 + t5047 + t5055 - t5072;
  t9467 = -t5093 - t5100 + t5110 + t5121 - t5128 + t5132 - t5135 - t5139 + 0.4e1 / 0.3e1 * t9055 + 0.4e1 / 0.3e1 * t9059 - 0.8e1 / 0.3e1 * t9063 - t5152 + t5165 - t5179;
  t9474 = t5183 - t5187 + t5191 + t5200 + t5205 + t5209 + t5223 + 0.4e1 / 0.9e1 * t8034 + 0.2e1 / 0.9e1 * t8037 + 0.2e1 / 0.9e1 * t8040 + t5233 + t5236 + t5251 + t5258;
  t9475 = t5281 - t5285 - t5341 - t5366 + t5371 - t5386 - t5393 + t5405 + t5412 + t5450 - t5454 - t5458 - t5461 - t5465;
  t9487 = t5469 + t5477 + t5483 + t5488 + 0.4e1 / 0.9e1 * t8195 + 0.8e1 / 0.9e1 * t8205 + 0.4e1 / 0.9e1 * t8226 + 0.8e1 / 0.3e1 * t8250 + 0.8e1 / 0.3e1 * t8254 + 0.4e1 / 0.9e1 * t8258 + 0.8e1 / 0.9e1 * t8262 + 0.4e1 / 0.9e1 * t8267 - 0.14e2 / 0.9e1 * t8278 - 0.28e2 / 0.9e1 * t8289;
  t9520 = my_piecewise3(t49, 0, 0.8e1 * t3586 * t389 + 0.2e1 * t48 * t9283 + 0.6e1 * t9277);
  t9530 = -0.44e2 / 0.3e1 * t1412 * t1419 + 0.1232e4 / 0.27e2 * t438 * t3666 - 0.5236e4 / 0.81e2 * t110 * t9291 * t65 - t115 * t78 * t9287 / 0.4e1 + 0.8e1 / 0.3e1 * t3680 * t441 + 0.8e1 * t1412 * t1422 - 0.88e2 / 0.3e1 * t438 * t3689 + 0.1232e4 / 0.27e2 * t110 * t3615 * t396 - t9520 * sigma[2] * t111 / 0.4e1 - t3680 * t444 - 0.3e1 / 0.2e1 * t1412 * t1425 + 0.8e1 * t438 * t3692 - t438 * t3695;
  t9546 = my_piecewise3(t60, 0, 0.8e1 * t3596 * t393 + 0.2e1 * t59 * t9311 + 0.6e1 * t9306);
  t9560 = -0.44e2 / 0.3e1 * t110 * t1287 * t1300 + 0.8e1 / 0.3e1 * t110 * t407 * t3600 - t110 * t85 * t9315 / 0.4e1 - t9546 * sigma[0] * t116 / 0.4e1 - t3704 * t453 - 0.3e1 / 0.2e1 * t1432 * t1437 - t450 * t3711 + 0.2e1 / 0.3e1 * t9288 + 0.41888e5 / 0.243e3 * t9293 - 0.9856e4 / 0.81e2 * t9295 + 0.352e3 / 0.9e1 * t9297 - 0.64e2 / 0.9e1 * t9299 + 0.2e1 / 0.3e1 * t9316;
  t9582 = 0.3e1 / 0.8e1 * t7348 + 0.3e1 / 0.16e2 * t7361 + t7438 / 0.96e2 + t7450 / 0.48e2 + t7465 / 0.96e2 + 0.3e1 / 0.16e2 * t7561 - t70 * (t9530 + t9560) / 0.8e1 + 0.4928e4 / 0.27e2 * t6172 - t5535 - 0.176e3 / 0.3e1 * t7695 - t30 * (t9247 * t35 / 0.72e2 + t8670 / 0.18e2 + t7741 / 0.12e2 + t6546 / 0.18e2 + t5526) + 0.32e2 / 0.3e1 * t8682 + t8688 / 0.48e2 + t8695 / 0.144e3 + t8743 / 0.8e1 + 0.3e1 / 0.8e1 * t8749 + 0.3e1 / 0.8e1 * t8757 + t8764 / 0.8e1 + t8777 / 0.144e3 + t8783 / 0.48e2;
  t9586 = t70 * t9247;
  t9606 = my_piecewise3(t49, 0, 0.88e3 / 0.81e2 * t1884 * t9272 + 0.88e3 / 0.9e1 * t1276 * t1279 + 0.88e2 / 0.3e1 * t228 * t9277 + 0.352e3 / 0.9e1 * t390 * t3586 + 0.11e2 / 0.3e1 * t57 * t9283);
  t9627 = my_piecewise3(t60, 0, 0.88e3 / 0.81e2 * t1907 * t9301 + 0.88e3 / 0.9e1 * t1294 * t1296 + 0.88e2 / 0.3e1 * t233 * t9306 + 0.352e3 / 0.9e1 * t394 * t3596 + 0.11e2 / 0.3e1 * t64 * t9311);
  t9662 = t6387 / 0.8e1 + t6408 / 0.8e1 - 0.3e1 / 0.2e2 * t45 * t12 * (t9287 + t9315) + t9586 * t89 / 0.32e2 + t3605 * t413 / 0.8e1 + 0.3e1 / 0.16e2 * t1365 * t1370 + t401 * t3625 / 0.8e1 + t6431 / 0.144e3 + t6505 / 0.144e3 + t5664 + t5739;
  t9677 = -0.14e2 / 0.9e1 * t8303 + t5491 + t21 * t24 * (t9582 + t71 * t73 * t9317 / 0.32e2 + t9586 * t104 / 0.576e3 + t3605 * t429 / 0.144e3 + t1365 * t1396 / 0.96e2 + t401 * t3659 / 0.144e3 + t71 * t92 * (t79 * t9606 + 0.20944e5 / 0.81e2 * t9292 * t101 - 0.4928e4 / 0.27e2 * t3616 * t426 + 0.176e3 / 0.3e1 * t1288 * t1393 - 0.32e2 / 0.3e1 * t408 * t3656 + t86 * t9627) / 0.576e3 - 0.3e1 / 0.2e2 * t45 * t9247 * t66 - 0.3e1 / 0.5e1 * t45 * t3568 * t397 - 0.9e1 / 0.1e2 * t45 * t1264 * t1361 - 0.3e1 / 0.5e1 * t45 * t379 * t3601 + t9662) - t5501 + 0.16e2 / 0.9e1 * t7011 + 0.8e1 / 0.9e1 * t7014 + 0.16e2 / 0.9e1 * t7020 + 0.16e2 / 0.9e1 * t7024 - 0.64e2 / 0.9e1 * t7026 - 0.64e2 / 0.9e1 * t7028 + 0.16e2 / 0.81e2 * t7124 + 0.16e2 / 0.81e2 * t7160 + 0.268e3 / 0.81e2 * t7177 - 0.16e2 / 0.9e1 * t7184;
  t9684 = -0.16e2 / 0.9e1 * t7202 - 0.56e2 / 0.81e2 * t7237 - 0.56e2 / 0.81e2 * t7242 + 0.268e3 / 0.81e2 * t7245 + t5825 + t5827 - t5851 + t5893 + t5900 - t5902 - t5904 - t5907 - t5909 + t5912;
  t9692 = t5914 + t5916 + t5918 - t5922 + t5926 + t5939 + t6050 + 0.2e1 / 0.9e1 * t9178 + 0.2e1 / 0.9e1 * t9186 + 0.2e1 / 0.3e1 * t9189 + 0.2e1 / 0.3e1 * t9194 + 0.2e1 / 0.3e1 * t9197 + 0.2e1 / 0.3e1 * t9202 + 0.2e1 / 0.9e1 * t9205;
  t9701 = 0.2e1 / 0.9e1 * t9210 + 0.16e2 / 0.3e1 * t8385 - 0.8e1 / 0.3e1 * t8388 - 0.8e1 / 0.3e1 * t8391 - 0.8e1 / 0.3e1 * t8398 + 0.2e1 / 0.3e1 * t8406 + 0.4e1 / 0.3e1 * t8414 + t6071 - t6074 - t6078 - t6081 - t6085 + t6089 - t6095;
  t9707 = -t6099 + t6114 + t6118 + t6122 + t6126 + 0.8e1 / 0.3e1 * t8428 - 0.112e3 / 0.27e2 * t7304 - t6130 + t6133 - t6144 + t6155 + 0.224e3 / 0.27e2 * t7314 + 0.32e2 / 0.27e2 * t7319 - 0.208e3 / 0.27e2 * t7324;
  tv4rho44 = 0.4e1 * t8451 + t161 * (t9260 + t9385 + t9406 + t9421 + t9438 + t9451 + t9463 + t9467 + t9474 + t9475 + t9487 + t9677 + t9684 + t9692 + t9701 + t9707);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 4] += tv4rho44;

  t9713 = params->a * t4087;
  t9715 = t318 * t4051;
  t9717 = t334 * t336 * t9715;
  t9720 = t789 * t792 * t3978;
  t9724 = 0.4e1 / 0.81e2 * t1824 * t1828 * t1507;
  t9727 = t130 * t137 * t1832 * t519;
  t9731 = t130 * t137 * t796 * t1539;
  t9734 = t768 * t312 * t1505;
  t9737 = 0.4e1 / 0.9e1 * t1980 * t3998;
  t9740 = 0.2e1 / 0.9e1 * t1795 * t860 * t511;
  t9743 = t768 * t125 * t4069 * params->d;
  t9746 = 0.4e1 / 0.9e1 * t1980 * t4002;
  t9750 = 0.4e1 / 0.9e1 * t1795 * t125 * t4073 * t213;
  t9751 = t9717 / 0.3e1 + 0.2e1 / 0.9e1 * t9720 + t9724 - t9727 / 0.6e1 - t9731 / 0.3e1 + 0.4e1 / 0.3e1 * t9734 + t9737 + t9740 + 0.4e1 / 0.3e1 * t9743 + t9746 + t9750;
  t9752 = t1803 * t519;
  t9754 = t334 * t336 * t9752;
  t9758 = t130 * t137 * t1953 * t519;
  t9762 = t130 * t137 * t762 * t1539;
  t9765 = 0.16e2 / 0.9e1 * t1988 * t3998;
  t9767 = 0.16e2 / 0.9e1 * t1988 * t4002;
  t9769 = t334 * t849 * t3974;
  t9772 = t334 * t849 * t3978;
  t9776 = 0.4e1 / 0.9e1 * t789 * t1949 * t1507;
  t9789 = 0.4312e4 / 0.81e2 * t1935;
  t9809 = -t817 * t251 * t516 + 0.11e2 / 0.3e1 * t353 * t644 * t516 - 0.154e3 / 0.27e2 * t143 * t1864 * t516 - t9789 + 0.539e3 / 0.81e2 * t1866 + t1869 * t78 * t516 / 0.8e1 + 0.3e1 / 0.8e1 * t4035 * t1536 - 0.2e1 * t4038 * t1536 + 0.3e1 / 0.8e1 * t1530 * t4048 + 0.11e2 / 0.3e1 * t4043 * t1536 - t1533 * t4048 + t515 * t70 * t1895 / 0.8e1 - 0.77e2 / 0.18e2 * t1879 + 0.7e1 / 0.6e1 * t1882 - 0.7e1 / 0.48e2 * t1896;
  t9816 = t130 * t137 * t340 * t4051;
  t9818 = t9754 / 0.3e1 + 0.2e1 / 0.9e1 * t9758 + 0.2e1 / 0.9e1 * t9762 - t9765 - t9767 - 0.7e1 / 0.9e1 * t9769 - 0.7e1 / 0.9e1 * t9772 - t9776 + t130 * t137 * t345 * t4051 / 0.2e1 + t130 * t137 * t138 * t9809 / 0.6e1 - t9816 / 0.6e1;
  t9830 = 0.67e2 / 0.81e2 * t334 * t1962 * t1507;
  t9834 = 0.14e2 / 0.81e2 * t130 * t137 * t1966 * t519;
  t9835 = t776 * t1539;
  t9837 = t334 * t336 * t9835;
  t9840 = t789 * t792 * t3974;
  t9842 = t582 * t223;
  t9843 = 0.88e2 / 0.3e1 * t9842;
  t9844 = t29 * t2088;
  t9873 = -0.2464e4 / 0.81e2 * t2101 + 0.176e3 / 0.9e1 * t2139 - 0.16e2 / 0.3e1 * t2142 + 0.2e1 / 0.3e1 * t2145 - t2129 * t78 * t58 / 0.4e1 + 0.2e1 * t727 * t251 * t58 - 0.3e1 / 0.4e1 * t3863 * t232 - 0.22e2 / 0.3e1 * t296 * t644 * t58 + 0.4e1 * t3866 * t232 - 0.3e1 / 0.4e1 * t1493 * t607 + 0.308e3 / 0.27e2 * t114 * t1864 * t58 - 0.22e2 / 0.3e1 * t3871 * t232 + 0.2e1 * t1496 * t607 - t504 * t1895 / 0.4e1;
  t9876 = t208 * t706;
  t9877 = 0.8e1 * t9876;
  t9879 = 0.1232e4 / 0.27e2 * t1935 * t38;
  t9884 = t71 * t665 * t251 * t97;
  t9887 = t71 * t3932 * t272;
  t9896 = t71 * t245 * t644 * t58;
  t9898 = -t9843 - t9844 - t70 * t9873 / 0.8e1 + t9877 + t9879 - t242 * t3914 / 0.36e2 - t9884 / 0.72e2 - t9887 / 0.36e2 + 0.11e2 / 0.216e3 * t71 * t3936 * t272 + 0.11e2 / 0.12e2 * t242 * t3927 + 0.11e2 / 0.12e2 * t9896;
  t9907 = t71 * t264 * t644 * t97;
  t9915 = t242 * t3923;
  t9921 = t71 * t635 * t251 * t58;
  t9928 = t620 * t1481;
  t9930 = -0.77e2 / 0.54e2 * t71 * t73 * t1864 * t58 + 0.11e2 / 0.216e3 * t242 * t3937 + 0.11e2 / 0.216e3 * t9907 - 0.77e2 / 0.972e3 * t71 * t92 * t1864 * t97 - t620 * t1472 / 0.4e1 - t9915 / 0.2e1 - t242 * t3894 / 0.2e1 - t9921 / 0.4e1 + t71 * t495 * t1895 / 0.32e2 + t2213 * t500 / 0.576e3 + t9928 / 0.192e3;
  t9934 = t242 * t3907;
  t9936 = t242 * t3911;
  t9943 = t71 * t2230 * t78 * t97 / 0.576e3;
  t9945 = t71 * t3906 * t272;
  t9948 = t71 * t1480 * t681;
  t9958 = t620 * t1468;
  t9960 = t620 * t1488 / 0.192e3 + t9934 / 0.192e3 + t9936 / 0.96e2 + t242 * t3917 / 0.192e3 + t9943 + t9945 / 0.192e3 + t9948 / 0.192e3 - t71 * t1484 * t681 / 0.72e2 + t71 * t499 * t2170 / 0.576e3 + t2213 * t496 / 0.32e2 + 0.3e1 / 0.32e2 * t9958;
  t9963 = t242 * t3888;
  t9965 = t242 * t3891;
  t9972 = t71 * t2199 * t78 * t58 / 0.32e2;
  t9974 = t71 * t3887 * t232;
  t9977 = t71 * t1467 * t607;
  t9983 = t71 * t3922 * t232;
  t9990 = t242 * t3933;
  t9992 = 0.3e1 / 0.32e2 * t620 * t1475 + 0.3e1 / 0.32e2 * t9963 + 0.3e1 / 0.16e2 * t9965 + 0.3e1 / 0.32e2 * t242 * t3897 + t9972 + 0.3e1 / 0.32e2 * t9974 + 0.3e1 / 0.32e2 * t9977 - t71 * t1471 * t607 / 0.4e1 - t9983 / 0.2e1 + 0.11e2 / 0.12e2 * t71 * t3926 * t232 - t620 * t1485 / 0.72e2 - t9990 / 0.36e2;
  t9998 = t963 * t964 * t1505;
  t10001 = 0.8e1 / 0.27e2 * t2472 * t4083;
  t10003 = t190 * t968 * t1505;
  t10006 = 0.52e2 / 0.27e2 * t2459 * t4083;
  t10007 = t130 * t137 * t1845 * t519 / 0.6e1 + t130 * t137 * t805 * t1539 / 0.2e1 + t9830 - t9834 + 0.2e1 / 0.3e1 * t9837 + 0.2e1 / 0.9e1 * t9840 + t21 * t24 * (t9898 + t9930 + t9960 + t9992) + 0.4e1 / 0.3e1 * t9998 + t10001 - 0.8e1 / 0.3e1 * t10003 - t10006;
  t10009 = t190 * t191 * t3947;
  t10013 = 0.56e2 / 0.27e2 * t190 * t2462 * t511;
  t10016 = 0.2e1 / 0.27e2 * t2368 * t2370 * t1512;
  t10018 = 0.11e2 / 0.27e2 * t1573 * t3984;
  t10020 = 0.26e2 / 0.81e2 * t2446 * t1508;
  t10023 = 0.26e2 / 0.81e2 * t325 * t2441 * t1512;
  t10025 = t325 * t903 * t3958;
  t10029 = 0.5e1 / 0.27e2 * t890 * t2449 * t3962;
  t10031 = 0.5e1 / 0.54e2 * t2336 * t1508;
  t10033 = t325 * t903 * t3953;
  t10037 = 0.11e2 / 0.27e2 * t897 * t1979 * t1512;
  t10038 = 0.2e1 * t10009 + t10013 + t10016 - t10018 + t10020 + t10023 - t10025 / 0.3e1 - t10029 - t10031 - t10033 / 0.3e1 - t10037;
  t10041 = t909 * t3975;
  t10043 = t909 * t3979;
  t10048 = t325 * t326 * t592 * t519 * params->d;
  t10053 = t325 * t326 * t180 * t1539 * params->d;
  t10057 = t890 * t891 * t3952 * t213;
  t10062 = t325 * t326 * t12 * t4051 * params->d;
  t10066 = t890 * t891 * t3957 * t213;
  t10069 = t872 * t874 * t3978;
  t10072 = t2409 * t1508 / 0.162e3;
  t10074 = t2414 * t3984 / 0.27e2;
  t10077 = 0.2e1 / 0.27e2 * t2359 * t2361 * t1507;
  t10078 = -t10041 / 0.3e1 - t10043 / 0.3e1 + t10048 / 0.6e1 + t10053 / 0.3e1 + t10057 / 0.9e1 + t10062 / 0.6e1 + t10066 / 0.9e1 + 0.2e1 / 0.9e1 * t10069 + t10072 + t10074 + t10077;
  t10080 = t315 * t317 * t9752;
  t10083 = t315 * t317 * t9835;
  t10085 = t863 * t3975;
  t10088 = t872 * t874 * t3974;
  t10091 = t315 * t317 * t9715;
  t10093 = t863 * t3979;
  t10096 = t897 * t899 * t3953;
  t10099 = t897 * t899 * t3958;
  t10103 = 0.2e1 / 0.27e2 * t2435 * t2437 * t3962;
  t10107 = t2428 * t2429 * t1511 * t627 / 0.27e2;
  t10110 = 0.4e1 / 0.9e1 * t1795 * t2341 * t4001;
  t10111 = t10080 / 0.6e1 + t10083 / 0.3e1 + t10085 / 0.18e2 + 0.2e1 / 0.9e1 * t10088 + t10091 / 0.6e1 + t10093 / 0.18e2 + 0.2e1 / 0.9e1 * t10096 + 0.2e1 / 0.9e1 * t10099 + t10103 + t10107 + t10110;
  t10115 = 0.28e2 / 0.27e2 * t195 * t870 * t1454;
  t10118 = 0.28e2 / 0.27e2 * t201 * t1458 * t2007;
  t10120 = t201 * t4069 * t932;
  t10124 = 0.8e1 / 0.9e1 * t201 * t4073 * t2274;
  t10127 = t195 * t196 * t16 * t3946;
  t10129 = t940 * t907 * t4062;
  t10133 = t2282 * t1552 * t1454 / 0.27e2;
  t10136 = t201 * t184 * t3946 * t203;
  t10139 = t201 * t575 * t1504 * t949;
  t10144 = 0.2e1 / 0.9e1 * t201 * t2064 * t510 * t2291;
  t10146 = t195 * t928 * t4062;
  t10148 = t10115 + t10118 - 0.4e1 / 0.3e1 * t10120 - t10124 + t10127 + t10129 / 0.3e1 + t10133 + t10136 + 0.2e1 / 0.3e1 * t10139 + t10144 - 0.4e1 / 0.3e1 * t10146;
  t10151 = 0.4e1 / 0.9e1 * t940 * t2267 * t1454;
  t10153 = 0.8e1 / 0.9e1 * t2313 * t3988;
  t10156 = t756 * t757 * t1504 * params->d;
  t10159 = t2322 * t3988 / 0.9e1;
  t10163 = 0.2e1 / 0.9e1 * t2326 * t2048 * t510 * t213;
  t10165 = 0.5e1 / 0.27e2 * t2034 * t3949;
  t10168 = t2050 * t956 * t3962 / 0.27e2;
  t10170 = t2044 * t3949 / 0.54e2;
  t10173 = 0.2e1 / 0.27e2 * t2055 * t2056 * t1512;
  t10175 = t955 * t956 * t3953;
  t10178 = t955 * t956 * t3958;
  t10180 = -t10151 - t10153 + 0.2e1 / 0.3e1 * t10156 + t10159 + t10163 - t10165 + t10168 + t10170 + t10173 + t10175 / 0.9e1 + t10178 / 0.9e1;
  tv4rho3sigma0 = 0.3e1 * t9713 + t161 * (t9751 + t9818 + t10007 + t10038 + t10078 + t10111 + t10148 + t10180);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  t10185 = params->a * t4233;
  t10191 = 0.91e2 / 0.81e2 * t890 * t137 * t5243 * t12 * t213;
  t10193 = t189 * t18 * t4218;
  t10195 = 0.32e2 / 0.3e1 * t10193 * t4131;
  t10197 = 0.32e2 / 0.3e1 * t10193 * t4136;
  t10198 = t776 * params->d;
  t10200 = t897 * t4115 * t10198;
  t10203 = 0.1e1 / t3 / t6045;
  t10205 = t318 * t213;
  t10208 = 0.14e2 / 0.81e2 * t2435 * t335 * t10203 * t10205;
  t10210 = 0.1e1 / t27 / t6045;
  t10214 = 0.14e2 / 0.81e2 * t2368 * t791 * t10210 * t4104;
  t10215 = t6046 * t23;
  t10216 = t10215 * t16;
  t10219 = 0.7e1 / 0.3e1 * t312 * t10216 * t4152;
  t10222 = 0.161e4 / 0.243e3 * t312 * t5368 * t1575;
  t10227 = 0.161e4 / 0.243e3 * t325 * t137 * t4218 * t12 * params->d;
  t10228 = t335 * t6046;
  t10231 = 0.7e1 / 0.3e1 * t897 * t10228 * t4104;
  t10235 = t890 * t137 * t1935 * t180 * t213;
  t10241 = 0.7e1 / 0.81e2 * t2428 * t137 * t6046 * t12 * t627;
  t10243 = t873 * t10228 * t136;
  t10245 = 0.8e1 / 0.9e1 * t10243 * t4136;
  t10247 = t189 * t18 * t5243;
  t10252 = 0.8e1 / 0.9e1 * t10247 * t125 * t575 * t38 * t213;
  t10255 = t1573 * t316 * t137 * t592;
  t10257 = t4144 * t4140;
  t10261 = t4149 * t873 * t4150 * t180;
  t10263 = -t10191 + t10195 + t10197 + 0.14e2 / 0.27e2 * t10200 + t10208 + t10214 - t10219 + t10222 + t10227 - t10231 + 0.7e1 / 0.27e2 * t10235 + t10241 - t10245 - t10252 + 0.7e1 / 0.18e2 * t10255 + 0.7e1 / 0.54e2 * t10257 + 0.14e2 / 0.27e2 * t10261;
  t10266 = 0.7e1 / 0.486e3 * t2408 * t10216 * t1575;
  t10267 = t10203 * t23;
  t10271 = 0.7e1 / 0.81e2 * t860 * t10267 * t16 * t4152;
  t10273 = t4130 * t312 * t4203;
  t10276 = 0.8e1 / 0.9e1 * t10243 * t4131;
  t10279 = 0.4e1 / 0.9e1 * t10247 * t860 * t1548;
  t10283 = t4130 * t125 * t184 * t223 * params->d;
  t10285 = t4121 * t4140;
  t10289 = 0.91e2 / 0.162e3 * t860 * t5245 * t1575;
  t10293 = t325 * t137 * t1827 * t180 * params->d;
  t10302 = 0.14e2 / 0.81e2 * t312 * t10210 * t23 * t16 * t2360 * t791 * t136 * t12;
  t10306 = t325 * t137 * t1570 * t592 * params->d;
  t10310 = t529 * t4216 * t4219 * t180;
  t10314 = t529 * t18 * t4194 * t180;
  t10317 = t190 * t4199 * t4203;
  t10321 = t190 * t1547 * t24 * t706;
  t10326 = 0.296e3 / 0.27e2 * t873 * t335 * t5243 * t4209;
  t10329 = t529 * t1583 * t4189 * t180;
  t10335 = 0.196e3 / 0.81e2 * t529 * t4216 * t10203 * t136 * t12;
  t10336 = t10266 + t10271 - 0.8e1 / 0.3e1 * t10273 - t10276 - t10279 - 0.8e1 / 0.3e1 * t10283 - 0.77e2 / 0.27e2 * t10285 - t10289 - 0.77e2 / 0.27e2 * t10293 + t10302 + 0.7e1 / 0.18e2 * t10306 + 0.14e2 / 0.27e2 * t10310 + 0.14e2 * t10314 + 0.8e2 / 0.3e1 * t10317 - 0.4e1 * t10321 + t10326 - 0.161e3 / 0.27e2 * t10329 - t10335;
  t10341 = 0.1552e4 / 0.27e2 * t190 * t4114 * params->b * t1548;
  t10346 = 0.3493e4 / 0.243e3 * t529 * t1583 * t5243 * t136 * t12;
  t10351 = 0.7e2 / 0.3e1 * t529 * t18 * t136 * t4114 * t12;
  t10353 = t580 * t580;
  t10359 = 0.28e2 / 0.243e3 * t529 * t1822 * t1825 / t10353 * t136 * t12;
  t10362 = t529 * t18 * t1589 * t592;
  t10369 = t4208 * t964 * t4203;
  t10374 = 0.16e2 / 0.27e2 * t2360 * t791 * t10203 * t4209;
  t10377 = t529 * t1583 * t1584 * t592;
  t10382 = 0.2464e4 / 0.27e2 * t201 * t16 * t1935 * t38;
  t10384 = t201 * t4097 * t223;
  t10387 = t4103 * t317 * t10198;
  t10392 = 0.7e1 / 0.162e3 * t860 * t10215 * t184 * t4105;
  t10397 = 0.7e1 / 0.81e2 * t312 * t10215 * t575 * t317 * t10205;
  t10400 = 0.8e1 / 0.9e1 * t10247 * t2341 * t4135;
  t10405 = 0.14e2 / 0.81e2 * t312 * t10267 * t184 * t874 * t4104;
  t10409 = 0.91e2 / 0.81e2 * t312 * t5244 * t184 * t4105;
  t10410 = -t10341 + t10346 - t10351 + t10359 - 0.7e1 / 0.2e1 * t10362 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t1791 - 0.8e1 / 0.3e1 * t10369 - t10374 + 0.7e1 / 0.9e1 * t10377 + t10382 - 0.176e3 / 0.3e1 * t10384 + 0.7e1 / 0.27e2 * t10387 + t10392 + t10397 - t10400 + t10405 - t10409;
  t10415 = 0.4e1 / 0.9e1 * t201 * t2064 * t5243 * t38 * t627;
  t10419 = 0.16e2 / 0.3e1 * t201 * t575 * t4218 * t4185;
  t10422 = t195 * t1552 * t16 * t706;
  t10426 = t201 * t1557 * t706 * params->d;
  t10429 = t940 * t4119 * t4173;
  t10433 = 0.2e1 / 0.27e2 * t2282 * t5244 * t1553;
  t10436 = t201 * t4184 * t223 * t213;
  t10439 = t195 * t2357 * t4173;
  t10443 = 0.8e1 / 0.3e1 * t940 * t5367 * t1553;
  t10445 = t201 * t4169 * t4180;
  t10450 = 0.776e3 / 0.27e2 * t201 * t184 * t4114 * t1558;
  t10453 = 0.776e3 / 0.27e2 * t195 * t4147 * t1553;
  t10457 = 0.16e2 / 0.3e1 * t21 * params->c * t4218 * t4110;
  t10459 = t4109 * t757 * t4180;
  t10464 = 0.2e1 / 0.9e1 * t21 * t859 * t5243 * t4110;
  t10469 = 0.4e1 / 0.9e1 * t21 * params->c * t5243 * t2048 * t4185;
  t10471 = t201 * t1562 * t706;
  t10476 = -t10415 + t10419 - 0.2e1 * t10422 - 0.2e1 * t10426 - 0.2e1 / 0.3e1 * t10429 - t10433 - 0.4e1 / 0.3e1 * t10436 + 0.4e2 / 0.3e1 * t10439 + t10443 + 0.4e2 / 0.3e1 * t10445 - t10450 - t10453 + t10457 - 0.4e1 / 0.3e1 * t10459 - t10464 - t10469 + 0.16e2 * t10471 - 0.2e1 * t201 * t525 * t2088;
  tv4rho3sigma1 = 0.3e1 * t10185 + t161 * (t10263 + t10336 + t10410 + t10476);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 1] += tv4rho3sigma1;

  t10480 = params->a * t4410;
  t10487 = t620 * t1615;
  t10491 = t242 * t4244;
  t10493 = t242 * t4247;
  t10500 = t71 * t2199 * t85 * t65 / 0.32e2;
  t10501 = -t9843 - t9844 + t9877 + t9879 + t71 * t540 * t2179 / 0.576e3 + t2213 * t537 / 0.32e2 + 0.3e1 / 0.32e2 * t10487 + 0.3e1 / 0.32e2 * t620 * t1618 + 0.3e1 / 0.32e2 * t10491 + 0.3e1 / 0.16e2 * t10493 + 0.3e1 / 0.32e2 * t242 * t4250 + t10500;
  t10503 = t71 * t4243 * t237;
  t10506 = t71 * t1614 * t615;
  t10513 = t620 * t1624;
  t10517 = t242 * t4260;
  t10519 = t242 * t4263;
  t10526 = t71 * t2230 * t85 * t101 / 0.576e3;
  t10528 = t71 * t4259 * t276;
  t10531 = t71 * t1623 * t688;
  t10546 = 0.3e1 / 0.32e2 * t10503 + 0.3e1 / 0.32e2 * t10506 + t71 * t536 * t1918 / 0.32e2 + t2213 * t541 / 0.576e3 + t10513 / 0.192e3 + t620 * t1627 / 0.192e3 + t10517 / 0.192e3 + t10519 / 0.96e2 + t242 * t4266 / 0.192e3 + t10526 + t10528 / 0.192e3 + t10531 / 0.192e3 - t70 * (0.2e1 / 0.3e1 * t2121 - t2113 * t85 * t65 / 0.4e1 - 0.3e1 / 0.4e1 * t4270 * t237 - 0.3e1 / 0.4e1 * t1631 * t615 - t545 * t1918 / 0.4e1) / 0.8e1;
  t10566 = t318 * t4334;
  t10568 = t334 * t336 * t10566;
  t10573 = 0.14e2 / 0.81e2 * t130 * t137 * t1966 * t559;
  t10576 = 0.67e2 / 0.81e2 * t334 * t1962 * t1642;
  t10579 = 0.4e1 / 0.9e1 * t789 * t1949 * t1642;
  t10582 = t130 * t137 * t762 * t1669;
  t10586 = t130 * t137 * t340 * t4334;
  t10590 = t130 * t137 * t1953 * t559;
  t10593 = t789 * t792 * t4302;
  t10597 = 0.4e1 / 0.81e2 * t1824 * t1828 * t1642;
  t10598 = t21 * t24 * (t10501 + t10546) + t130 * t137 * t138 * (-t9789 - 0.7e1 / 0.48e2 * t1919 + t1899 * t85 * t556 / 0.8e1 + 0.3e1 / 0.8e1 * t4326 * t1666 + 0.3e1 / 0.8e1 * t1663 * t4331 + t555 * t70 * t1918 / 0.8e1) / 0.6e1 + t10568 / 0.3e1 - t10573 + t10576 - t10579 + 0.2e1 / 0.9e1 * t10582 - t10586 / 0.6e1 + 0.2e1 / 0.9e1 * t10590 + 0.2e1 / 0.9e1 * t10593 + t10597;
  t10600 = t768 * t312 * t1640;
  t10603 = 0.4e1 / 0.9e1 * t1980 * t4356;
  t10606 = 0.2e1 / 0.9e1 * t1795 * t860 * t552;
  t10609 = t768 * t125 * t4392 * params->d;
  t10612 = 0.4e1 / 0.9e1 * t1980 * t4360;
  t10616 = 0.4e1 / 0.9e1 * t1795 * t125 * t4396 * t213;
  t10618 = t789 * t792 * t4298;
  t10628 = t1803 * t559;
  t10630 = t334 * t336 * t10628;
  t10632 = t776 * t1669;
  t10634 = t334 * t336 * t10632;
  t10636 = 0.4e1 / 0.3e1 * t10600 + t10603 + t10606 + 0.4e1 / 0.3e1 * t10609 + t10612 + t10616 + 0.2e1 / 0.9e1 * t10618 + t130 * t137 * t1845 * t559 / 0.6e1 + t130 * t137 * t805 * t1669 / 0.2e1 + t10630 / 0.3e1 + 0.2e1 / 0.3e1 * t10634;
  t10639 = 0.16e2 / 0.9e1 * t1988 * t4356;
  t10641 = 0.16e2 / 0.9e1 * t1988 * t4360;
  t10644 = t130 * t137 * t1832 * t559;
  t10648 = t130 * t137 * t796 * t1669;
  t10651 = t334 * t849 * t4298;
  t10654 = t334 * t849 * t4302;
  t10661 = t190 * t191 * t4281;
  t10664 = t963 * t964 * t1640;
  t10668 = 0.56e2 / 0.27e2 * t190 * t2462 * t552;
  t10670 = 0.8e1 / 0.27e2 * t2472 * t4406;
  t10671 = -t10639 - t10641 - t10644 / 0.6e1 - t10648 / 0.3e1 - 0.7e1 / 0.9e1 * t10651 - 0.7e1 / 0.9e1 * t10654 + t130 * t137 * t345 * t4334 / 0.2e1 + 0.2e1 * t10661 + 0.4e1 / 0.3e1 * t10664 + t10668 + t10670;
  t10673 = t190 * t968 * t1640;
  t10676 = 0.52e2 / 0.27e2 * t2459 * t4406;
  t10677 = t909 * t4299;
  t10680 = t325 * t903 * t4317;
  t10683 = 0.5e1 / 0.54e2 * t2336 * t1643;
  t10686 = 0.5e1 / 0.27e2 * t890 * t2449 * t4291;
  t10689 = 0.11e2 / 0.27e2 * t897 * t1979 * t1647;
  t10690 = t909 * t4303;
  t10693 = t325 * t903 * t4287;
  t10696 = t315 * t317 * t10628;
  t10701 = t325 * t326 * t592 * t559 * params->d;
  t10703 = -0.8e1 / 0.3e1 * t10673 - t10676 - t10677 / 0.3e1 - t10680 / 0.3e1 - t10683 - t10686 - t10689 - t10690 / 0.3e1 - t10693 / 0.3e1 + t10696 / 0.6e1 + t10701 / 0.6e1;
  t10707 = t315 * t317 * t10632;
  t10712 = t325 * t326 * t180 * t1669 * params->d;
  t10715 = t315 * t317 * t10566;
  t10720 = t325 * t326 * t12 * t4334 * params->d;
  t10723 = t897 * t899 * t4287;
  t10727 = 0.2e1 / 0.27e2 * t2359 * t2361 * t1642;
  t10730 = 0.2e1 / 0.27e2 * t2368 * t2370 * t1647;
  t10733 = 0.4e1 / 0.9e1 * t1795 * t2341 * t4359;
  t10735 = t872 * t874 * t4298;
  t10738 = t897 * t899 * t4317;
  t10741 = 0.11e2 / 0.27e2 * t1573 * t4308;
  t10742 = t10707 / 0.3e1 + t10712 / 0.3e1 + t10715 / 0.6e1 + t10720 / 0.6e1 + 0.2e1 / 0.9e1 * t10723 + t10727 + t10730 + t10733 + 0.2e1 / 0.9e1 * t10735 + 0.2e1 / 0.9e1 * t10738 - t10741;
  t10745 = t890 * t891 * t4316 * t213;
  t10749 = t890 * t891 * t4286 * t213;
  t10752 = t872 * t874 * t4302;
  t10754 = t863 * t4303;
  t10757 = t2409 * t1643 / 0.162e3;
  t10759 = t2414 * t4308 / 0.27e2;
  t10761 = 0.26e2 / 0.81e2 * t2446 * t1643;
  t10764 = 0.26e2 / 0.81e2 * t325 * t2441 * t1647;
  t10765 = t863 * t4299;
  t10770 = t2428 * t2429 * t1646 * t627 / 0.27e2;
  t10773 = 0.2e1 / 0.27e2 * t2435 * t2437 * t4291;
  t10774 = t10745 / 0.9e1 + t10749 / 0.9e1 + 0.2e1 / 0.9e1 * t10752 + t10754 / 0.18e2 + t10757 + t10759 + t10761 + t10764 + t10765 / 0.18e2 + t10770 + t10773;
  t10778 = 0.4e1 / 0.9e1 * t940 * t2267 * t1604;
  t10780 = t201 * t4392 * t932;
  t10784 = 0.8e1 / 0.9e1 * t201 * t4396 * t2274;
  t10787 = 0.28e2 / 0.27e2 * t195 * t870 * t1604;
  t10790 = 0.28e2 / 0.27e2 * t201 * t1608 * t2007;
  t10793 = t195 * t196 * t16 * t4280;
  t10796 = t201 * t184 * t4280 * t203;
  t10798 = t940 * t907 * t4385;
  t10802 = t2282 * t1552 * t1604 / 0.27e2;
  t10805 = t201 * t575 * t1639 * t949;
  t10810 = 0.2e1 / 0.9e1 * t201 * t2064 * t551 * t2291;
  t10811 = -t10778 - 0.4e1 / 0.3e1 * t10780 - t10784 + t10787 + t10790 + t10793 + t10796 + t10798 / 0.3e1 + t10802 + 0.2e1 / 0.3e1 * t10805 + t10810;
  t10813 = t195 * t928 * t4385;
  t10816 = 0.8e1 / 0.9e1 * t2313 * t4322;
  t10819 = t756 * t757 * t1639 * params->d;
  t10822 = t2322 * t4322 / 0.9e1;
  t10826 = 0.2e1 / 0.9e1 * t2326 * t2048 * t551 * t213;
  t10828 = 0.5e1 / 0.27e2 * t2034 * t4283;
  t10830 = t2044 * t4283 / 0.54e2;
  t10832 = t955 * t956 * t4287;
  t10836 = t2050 * t956 * t4291 / 0.27e2;
  t10839 = 0.2e1 / 0.27e2 * t2055 * t2056 * t1647;
  t10841 = t955 * t956 * t4317;
  t10843 = -0.4e1 / 0.3e1 * t10813 - t10816 + 0.2e1 / 0.3e1 * t10819 + t10822 + t10826 - t10828 + t10830 + t10832 / 0.9e1 + t10836 + t10839 + t10841 / 0.9e1;
  tv4rho3sigma2 = 0.3e1 * t10480 + t161 * (t10598 + t10636 + t10671 + t10703 + t10742 + t10774 + t10811 + t10843);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 2] += tv4rho3sigma2;

  t10849 = 0.2e1 * params->a * t4578;
  t10850 = 0.176e3 / 0.9e1 * t9842;
  t10851 = 0.8e1 / 0.3e1 * t9876;
  t10853 = t401 * t3891 / 0.16e2;
  t10859 = t242 * t4422 / 0.16e2;
  t10863 = t71 * t3887 * t392;
  t10867 = t71 * t1467 * t994 / 0.16e2;
  t10874 = t1008 * t1481 / 0.288e3;
  t10877 = t401 * t3907;
  t10880 = t401 * t3911 / 0.288e3;
  t10881 = -t10850 + t10851 + t9879 + t10853 + t401 * t3897 / 0.32e2 + t620 * t1679 / 0.32e2 + t10859 + t242 * t4425 / 0.16e2 + t10863 / 0.32e2 + t10867 + t71 * t495 * t2534 / 0.32e2 + t2555 * t500 / 0.576e3 + t10874 + t1008 * t1488 / 0.288e3 + t10877 / 0.576e3 + t10880;
  t10887 = t242 * t4436 / 0.288e3;
  t10891 = t71 * t3906 * t420;
  t10895 = t71 * t1480 * t1050 / 0.288e3;
  t10902 = t1008 * t1468 / 0.16e2;
  t10905 = t401 * t3888;
  t10907 = t29 * t2501;
  t10938 = 0.176e3 / 0.27e2 * t2666 - 0.32e2 / 0.9e1 * t2726 + 0.2e1 / 0.3e1 * t2729 - t2712 * t78 * t58 / 0.4e1 + 0.4e1 / 0.3e1 * t1105 * t251 * t58 - t4464 * t232 / 0.2e1 - 0.22e2 / 0.9e1 * t449 * t644 * t58 + 0.4e1 / 0.3e1 * t4467 * t232 - t1688 * t607 / 0.4e1 - t3863 * t392 / 0.4e1 + 0.4e1 / 0.3e1 * t3866 * t392 - t1493 * t994 / 0.2e1 - 0.22e2 / 0.9e1 * t3871 * t392 + 0.4e1 / 0.3e1 * t1496 * t994 - t504 * t2534 / 0.4e1;
  t10942 = 0.16e2 / 0.3e1 * t208 * t1130;
  t10943 = t582 * t384;
  t10944 = 0.88e2 / 0.9e1 * t10943;
  t10947 = t401 * t3917 / 0.576e3 + t620 * t1684 / 0.576e3 + t10887 + t242 * t4439 / 0.288e3 + t10891 / 0.576e3 + t10895 + t71 * t499 * t2633 / 0.576e3 + t2555 * t496 / 0.32e2 + t10902 + t1008 * t1475 / 0.16e2 + t10905 / 0.32e2 - t10907 - t70 * t10938 / 0.8e1 + t10942 - t10944 - t9884 / 0.108e3 - t9887 / 0.108e3;
  t10964 = 0.11e2 / 0.36e2 * t9896 + 0.11e2 / 0.648e3 * t9907 - t9915 / 0.6e1 - t9921 / 0.6e1 + t9928 / 0.576e3 + t9934 / 0.288e3 + t9936 / 0.288e3 + t9943 + t9945 / 0.288e3 + t9948 / 0.576e3 + t9958 / 0.32e2 + t9963 / 0.16e2 + t9965 / 0.16e2 + t9972 + t9974 / 0.16e2 + t9977 / 0.32e2 - t9983 / 0.6e1;
  t10972 = t71 * t3932 * t420 / 0.108e3;
  t10989 = t401 * t3923 / 0.6e1;
  t10996 = t71 * t3922 * t392 / 0.6e1;
  t11003 = t401 * t3933 / 0.108e3;
  t11004 = -t9990 / 0.108e3 - t401 * t3914 / 0.108e3 - t242 * t4450 / 0.108e3 - t10972 - t71 * t1484 * t1050 / 0.108e3 + 0.11e2 / 0.36e2 * t401 * t3927 + 0.11e2 / 0.36e2 * t71 * t3926 * t392 + 0.11e2 / 0.648e3 * t401 * t3937 + 0.11e2 / 0.648e3 * t71 * t3936 * t420 - t1008 * t1472 / 0.6e1 - t10989 - t401 * t3894 / 0.6e1 - t242 * t4445 / 0.6e1 - t10996 - t71 * t1471 * t994 / 0.6e1 - t1008 * t1485 / 0.108e3 - t11003;
  t11010 = t789 * t792 * t4499;
  t11052 = -t9789 - 0.77e2 / 0.54e2 * t2849 + 0.7e1 / 0.9e1 * t2863 - 0.7e1 / 0.48e2 * t2866 + t177 * t78 * t516 / 0.24e2 - t1785 * t146 / 0.8e1 - 0.2e1 / 0.9e1 * t587 * t358 + t587 * t361 / 0.12e2 + 0.11e2 / 0.9e1 * t469 * t644 * t516 - 0.2e1 / 0.3e1 * t4536 * t1536 + t1704 * t4048 / 0.8e1 + t4035 * t1707 / 0.8e1 - 0.2e1 / 0.3e1 * t4038 * t1707 + t1530 * t4545 / 0.4e1 + 0.11e2 / 0.9e1 * t4043 * t1707 - 0.2e1 / 0.3e1 * t1533 * t4545 + t515 * t70 * t2534 / 0.8e1;
  t11058 = t789 * t792 * t4490;
  t11068 = t2804 * t519;
  t11071 = 0.2e1 / 0.9e1 * t334 * t336 * t11068;
  t11076 = t1137 * t1539;
  t11079 = 0.2e1 / 0.9e1 * t334 * t336 * t11076;
  t11080 = t776 * t1710;
  t11083 = 0.2e1 / 0.9e1 * t334 * t336 * t11080;
  t11084 = t318 * t4548;
  t11087 = 0.2e1 / 0.9e1 * t334 * t336 * t11084;
  t11089 = t334 * t849 * t4490;
  t11094 = t130 * t137 * t2917 * t519 / 0.9e1;
  t11097 = t130 * t137 * t2940 * t519;
  t11101 = t130 * t137 * t762 * t1710;
  t11103 = t21 * t24 * (t10881 + t10947 + t10964 + t11004) + 0.2e1 / 0.27e2 * t11010 + t130 * t137 * t805 * t1710 / 0.6e1 + t130 * t137 * t345 * t4548 / 0.3e1 + t130 * t137 * t138 * t11052 / 0.6e1 + 0.2e1 / 0.27e2 * t11058 + t130 * t137 * t2795 * t519 / 0.6e1 + t130 * t137 * t1197 * t1539 / 0.3e1 + t11071 + t130 * t137 * t462 * t4051 / 0.6e1 + t11079 + t11083 + t11087 - 0.7e1 / 0.27e2 * t11089 - t11094 + 0.2e1 / 0.27e2 * t11097 + 0.2e1 / 0.27e2 * t11101;
  t11107 = t130 * t137 * t796 * t1710 / 0.9e1;
  t11111 = t130 * t137 * t340 * t4548 / 0.9e1;
  t11115 = t130 * t137 * t1187 * t1539 / 0.9e1;
  t11117 = t334 * t849 * t4499;
  t11120 = t768 * t312 * t1697;
  t11124 = t768 * t125 * t4568 * params->d;
  t11132 = -t11107 - t11111 - t11115 - 0.7e1 / 0.27e2 * t11117 + 0.4e1 / 0.9e1 * t11120 + 0.4e1 / 0.9e1 * t11124 + t9717 / 0.9e1 + 0.4e1 / 0.27e2 * t9720 + t9724 - t9727 / 0.18e2 - t9731 / 0.9e1 + 0.8e1 / 0.9e1 * t9734 + t9737 + t9740 + 0.8e1 / 0.9e1 * t9743 + t9746 + t9750;
  t11143 = t872 * t874 * t4490;
  t11146 = t897 * t899 * t4495;
  t11150 = t315 * t317 * t11076 / 0.9e1;
  t11155 = t325 * t326 * t379 * t1539 * params->d / 0.9e1;
  t11156 = t9754 / 0.9e1 + 0.4e1 / 0.27e2 * t9758 + 0.4e1 / 0.27e2 * t9762 - t9765 - t9767 - 0.14e2 / 0.27e2 * t9769 - 0.14e2 / 0.27e2 * t9772 - t9776 - t9816 / 0.18e2 + t9830 - t9834 + 0.2e1 / 0.9e1 * t9837 + 0.4e1 / 0.27e2 * t9840 + 0.2e1 / 0.27e2 * t11143 + 0.2e1 / 0.27e2 * t11146 + t11150 + t11155;
  t11158 = t872 * t874 * t4499;
  t11161 = t897 * t899 * t4486;
  t11164 = t325 * t903 * t4486;
  t11166 = t909 * t4491;
  t11169 = t325 * t903 * t4495;
  t11171 = t863 * t4491;
  t11175 = t315 * t317 * t11080 / 0.9e1;
  t11180 = t325 * t326 * t180 * t1710 * params->d / 0.9e1;
  t11183 = t315 * t317 * t11084 / 0.9e1;
  t11188 = t325 * t326 * t12 * t4548 * params->d / 0.9e1;
  t11191 = t890 * t891 * t4485 * t213;
  t11195 = t315 * t317 * t11068 / 0.9e1;
  t11200 = t325 * t326 * t1007 * t519 * params->d / 0.9e1;
  t11204 = 0.2e1 / 0.27e2 * t11158 + 0.2e1 / 0.27e2 * t11161 - t11164 / 0.9e1 - t11166 / 0.9e1 - t11169 / 0.9e1 + t11171 / 0.54e2 + t11175 + t11180 + t11183 + t11188 + t11191 / 0.27e2 + t11195 + t11200 + 0.8e1 / 0.9e1 * t9998 + t10001 - 0.16e2 / 0.9e1 * t10003 - t10006 + 0.2e1 / 0.3e1 * t10009;
  t11207 = t863 * t4500;
  t11211 = t890 * t891 * t4494 * t213;
  t11213 = t909 * t4500;
  t11221 = t10013 + t11207 / 0.54e2 + t11211 / 0.27e2 - t11213 / 0.9e1 + t10016 - t10018 + t10020 + t10023 - 0.2e1 / 0.9e1 * t10025 - t10029 - t10031 - 0.2e1 / 0.9e1 * t10033 - t10037 - 0.2e1 / 0.9e1 * t10041 - 0.2e1 / 0.9e1 * t10043 + t10048 / 0.18e2 + t10053 / 0.9e1;
  t11234 = 0.2e1 / 0.27e2 * t10057 + t10062 / 0.18e2 + 0.2e1 / 0.27e2 * t10066 + 0.4e1 / 0.27e2 * t10069 + t10072 + t10074 + t10077 + t10080 / 0.18e2 + t10083 / 0.9e1 + t10085 / 0.27e2 + 0.4e1 / 0.27e2 * t10088 + t10091 / 0.18e2 + t10093 / 0.27e2 + 0.4e1 / 0.27e2 * t10096 + 0.4e1 / 0.27e2 * t10099 + t10103 + t10107;
  t11238 = t201 * t575 * t1696 * t949;
  t11243 = 0.2e1 / 0.3e1 * t195 * t196 * t16 * t4482;
  t11247 = 0.2e1 / 0.3e1 * t201 * t184 * t4482 * t203;
  t11249 = t940 * t907 * t4564;
  t11252 = t195 * t928 * t4564;
  t11255 = t201 * t4568 * t932;
  t11262 = t10110 + 0.2e1 / 0.9e1 * t11238 + t11243 + t11247 + t11249 / 0.9e1 - 0.4e1 / 0.9e1 * t11252 - 0.4e1 / 0.9e1 * t11255 + t10115 + t10118 - 0.8e1 / 0.9e1 * t10120 - t10124 + t10127 / 0.3e1 + 0.2e1 / 0.9e1 * t10129 + t10133 + t10136 / 0.3e1 + 0.4e1 / 0.9e1 * t10139 + t10144;
  t11265 = t955 * t956 * t4495;
  t11268 = t955 * t956 * t4486;
  t11273 = t756 * t757 * t1696 * params->d;
  t11278 = t190 * t968 * t1697;
  t11282 = 0.4e1 / 0.3e1 * t190 * t191 * t4483;
  t11284 = t963 * t964 * t1697;
  t11286 = -0.8e1 / 0.9e1 * t10146 - t10151 + t11265 / 0.27e2 + t11268 / 0.27e2 - t10153 + 0.4e1 / 0.9e1 * t10156 + t10159 + t10163 + 0.2e1 / 0.9e1 * t11273 - t10165 + t10168 + t10170 + t10173 + 0.2e1 / 0.27e2 * t10175 + 0.2e1 / 0.27e2 * t10178 - 0.8e1 / 0.9e1 * t11278 + t11282 + 0.4e1 / 0.9e1 * t11284;
  tv4rho3sigma3 = t9713 + t10849 + t161 * (t11103 + t11132 + t11156 + t11204 + t11221 + t11234 + t11262 + t11286);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 3] += tv4rho3sigma3;

  t11292 = 0.2e1 * params->a * t4630;
  t11294 = t4130 * t312 * t4617;
  t11299 = t4130 * t125 * t184 * t384 * params->d;
  t11301 = t4121 * t4591;
  t11306 = t325 * t137 * t1827 * t379 * params->d;
  t11311 = 0.7e1 / 0.27e2 * t1573 * t316 * t137 * t1007;
  t11312 = t4144 * t4591;
  t11316 = t4149 * t873 * t4150 * t379;
  t11322 = 0.7e1 / 0.27e2 * t325 * t137 * t1570 * t1007 * params->d;
  t11326 = t890 * t137 * t1935 * t379 * t213;
  t11328 = t1137 * params->d;
  t11330 = t897 * t4115 * t11328;
  t11335 = 0.4e1 / 0.3e1 * t195 * t1552 * t16 * t1130;
  t11339 = 0.4e1 / 0.3e1 * t201 * t1557 * t1130 * params->d;
  t11340 = -0.8e1 / 0.9e1 * t11294 - 0.8e1 / 0.9e1 * t11299 - 0.77e2 / 0.81e2 * t11301 - 0.77e2 / 0.81e2 * t11306 + t11311 + 0.7e1 / 0.162e3 * t11312 + 0.14e2 / 0.81e2 * t11316 + t11322 + 0.7e1 / 0.81e2 * t11326 + 0.14e2 / 0.81e2 * t11330 - t11335 - t11339;
  t11342 = t195 * t2357 * t4602;
  t11345 = t201 * t4169 * t4606;
  t11348 = t940 * t4119 * t4602;
  t11352 = t201 * t4184 * t384 * t213;
  t11355 = 0.4e2 / 0.9e1 * t11342 + 0.4e2 / 0.9e1 * t11345 - 0.2e1 / 0.9e1 * t11348 - 0.4e1 / 0.9e1 * t11352 - t10191 + t10195 + t10197 + 0.28e2 / 0.81e2 * t10200 + t10208 + t10214 - t10219 + t10222;
  t11362 = t10227 - t10231 + 0.14e2 / 0.81e2 * t10235 + t10241 - t10245 - t10252 + 0.7e1 / 0.54e2 * t10255 + 0.7e1 / 0.81e2 * t10257 + 0.28e2 / 0.81e2 * t10261 + t10266 + t10271 - 0.16e2 / 0.9e1 * t10273;
  t11368 = t4103 * t317 * t11328;
  t11374 = -t10276 - t10279 - 0.16e2 / 0.9e1 * t10283 - 0.154e3 / 0.81e2 * t10285 - t10289 - 0.154e3 / 0.81e2 * t10293 + t10302 + 0.7e1 / 0.54e2 * t10306 + 0.7e1 / 0.81e2 * t11368 + 0.28e2 / 0.81e2 * t10310 + 0.28e2 / 0.3e1 * t10314 + 0.16e3 / 0.9e1 * t10317 - 0.4e1 / 0.3e1 * t10321;
  t11381 = t10326 - 0.322e3 / 0.81e2 * t10329 - t10335 - t10341 + t10346 - t10351 + t10359 - 0.7e1 / 0.6e1 * t10362 - 0.16e2 / 0.9e1 * t10369 - t10374 + 0.7e1 / 0.27e2 * t10377 + t10382;
  t11387 = -0.352e3 / 0.9e1 * t10384 + 0.14e2 / 0.81e2 * t10387 + t10392 + t10397 - t10400 + t10405 - t10409 - t10415 + t10419 - 0.2e1 / 0.3e1 * t10422 - 0.2e1 / 0.3e1 * t10426 - 0.4e1 / 0.9e1 * t10429;
  t11394 = t4109 * t757 * t4606;
  t11396 = -t10433 - 0.8e1 / 0.9e1 * t10436 + 0.8e2 / 0.9e1 * t10439 + t10443 + 0.8e2 / 0.9e1 * t10445 - t10450 - t10453 + t10457 - 0.8e1 / 0.9e1 * t10459 - t10464 - t10469 - 0.4e1 / 0.9e1 * t11394;
  t11399 = 0.32e2 / 0.3e1 * t201 * t1562 * t1130;
  t11401 = t201 * t4097 * t384;
  t11409 = t529 * t18 * t4194 * t379;
  t11413 = t529 * t4216 * t4219 * t379;
  t11416 = t190 * t4199 * t4617;
  t11419 = t4208 * t964 * t4617;
  t11428 = 0.14e2 / 0.27e2 * t529 * t1583 * t1584 * t1007;
  t11432 = 0.7e1 / 0.3e1 * t529 * t18 * t1589 * t1007;
  t11435 = t529 * t1583 * t4189 * t379;
  t11440 = 0.8e1 / 0.3e1 * t190 * t1547 * t24 * t1130;
  t11441 = t11399 - 0.176e3 / 0.9e1 * t11401 - 0.2e1 * t201 * t525 * t2501 + 0.16e2 / 0.3e1 * t10471 + 0.14e2 / 0.3e1 * t11409 + 0.14e2 / 0.81e2 * t11413 + 0.8e2 / 0.9e1 * t11416 - 0.8e1 / 0.9e1 * t11419 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t2492 + t11428 - t11432 - 0.161e3 / 0.81e2 * t11435 - t11440;
  tv4rho3sigma4 = t10185 + t11292 + t161 * (t11340 + t11355 + t11362 + t11374 + t11381 + t11387 + t11396 + t11441);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 4] += tv4rho3sigma4;

  t11447 = 0.2e1 * params->a * t4800;
  t11451 = t130 * t137 * t340 * t4756 / 0.9e1;
  t11453 = t334 * t849 * t4716;
  t11456 = t768 * t312 * t1758;
  t11460 = t768 * t125 * t4790 * params->d;
  t11466 = t2804 * t559;
  t11469 = 0.2e1 / 0.9e1 * t334 * t336 * t11466;
  t11474 = t1137 * t1669;
  t11477 = 0.2e1 / 0.9e1 * t334 * t336 * t11474;
  t11479 = t789 * t792 * t4707;
  t11481 = t776 * t1775;
  t11484 = 0.2e1 / 0.9e1 * t334 * t336 * t11481;
  t11510 = -t9789 + 0.7e1 / 0.18e2 * t2876 - 0.7e1 / 0.48e2 * t2883 - t177 * t85 * t556 / 0.24e2 + t1785 * t152 / 0.8e1 - t587 * t368 / 0.12e2 + t1766 * t4331 / 0.8e1 - t835 * t407 * t556 / 0.3e1 - 0.2e1 / 0.3e1 * t4746 * t1666 - t1769 * t4331 / 0.3e1 + t4326 * t1772 / 0.8e1 + t1663 * t4753 / 0.4e1 + t555 * t70 * t2549 / 0.8e1;
  t11515 = t318 * t4756;
  t11518 = 0.2e1 / 0.9e1 * t334 * t336 * t11515;
  t11520 = t789 * t792 * t4716;
  t11536 = t130 * t137 * t2940 * t559;
  t11538 = -t11451 - 0.7e1 / 0.27e2 * t11453 + 0.4e1 / 0.9e1 * t11456 + 0.4e1 / 0.9e1 * t11460 + t130 * t137 * t1197 * t1669 / 0.3e1 + t11469 + t130 * t137 * t462 * t4334 / 0.6e1 + t11477 + 0.2e1 / 0.27e2 * t11479 + t11484 + t130 * t137 * t138 * t11510 / 0.6e1 + t11518 + 0.2e1 / 0.27e2 * t11520 + t130 * t137 * t2795 * t559 / 0.6e1 + t130 * t137 * t805 * t1775 / 0.6e1 + t130 * t137 * t345 * t4756 / 0.3e1 + 0.2e1 / 0.27e2 * t11536;
  t11540 = t334 * t849 * t4707;
  t11544 = t130 * t137 * t762 * t1775;
  t11549 = t130 * t137 * t2917 * t559 / 0.9e1;
  t11553 = t130 * t137 * t1187 * t1669 / 0.9e1;
  t11557 = t130 * t137 * t796 * t1775 / 0.9e1;
  t11561 = 0.2e1 / 0.3e1 * t195 * t196 * t16 * t4704;
  t11565 = 0.2e1 / 0.3e1 * t201 * t184 * t4704 * t203;
  t11567 = t940 * t907 * t4786;
  t11571 = t201 * t575 * t1757 * t949;
  t11574 = t195 * t928 * t4786;
  t11577 = t201 * t4790 * t932;
  t11582 = -0.7e1 / 0.27e2 * t11540 + 0.2e1 / 0.27e2 * t11544 - t11549 - t11553 - t11557 + t11561 + t11565 + t11567 / 0.9e1 + 0.2e1 / 0.9e1 * t11571 - 0.4e1 / 0.9e1 * t11574 - 0.4e1 / 0.9e1 * t11577 + t10568 / 0.9e1 - t10573 + t10576 - t10579 + 0.4e1 / 0.27e2 * t10582 - t10586 / 0.18e2;
  t11594 = 0.4e1 / 0.27e2 * t10590 + 0.4e1 / 0.27e2 * t10593 + t10597 + 0.8e1 / 0.9e1 * t10600 + t10603 + t10606 + 0.8e1 / 0.9e1 * t10609 + t10612 + t10616 + 0.4e1 / 0.27e2 * t10618 + t10630 / 0.9e1 + 0.2e1 / 0.9e1 * t10634 - t10639 - t10641 - t10644 / 0.18e2 - t10648 / 0.9e1 - 0.14e2 / 0.27e2 * t10651;
  t11600 = t325 * t326 * t379 * t1669 * params->d / 0.9e1;
  t11603 = t315 * t317 * t11481 / 0.9e1;
  t11608 = t325 * t326 * t180 * t1775 * params->d / 0.9e1;
  t11611 = t315 * t317 * t11515 / 0.9e1;
  t11616 = t325 * t326 * t12 * t4756 * params->d / 0.9e1;
  t11619 = t890 * t891 * t4711 * t213;
  t11623 = t890 * t891 * t4720 * t213;
  t11625 = t909 * t4708;
  t11628 = t325 * t903 * t4712;
  t11631 = t872 * t874 * t4707;
  t11634 = t897 * t899 * t4712;
  t11636 = t909 * t4717;
  t11639 = t325 * t903 * t4721;
  t11641 = t863 * t4717;
  t11644 = t872 * t874 * t4716;
  t11647 = t897 * t899 * t4721;
  t11651 = t315 * t317 * t11466 / 0.9e1;
  t11652 = -0.14e2 / 0.27e2 * t10654 + t11600 + t11603 + t11608 + t11611 + t11616 + t11619 / 0.27e2 + t11623 / 0.27e2 - t11625 / 0.9e1 - t11628 / 0.9e1 + 0.2e1 / 0.27e2 * t11631 + 0.2e1 / 0.27e2 * t11634 - t11636 / 0.9e1 - t11639 / 0.9e1 + t11641 / 0.54e2 + 0.2e1 / 0.27e2 * t11644 + 0.2e1 / 0.27e2 * t11647 + t11651;
  t11659 = t325 * t326 * t1007 * t559 * params->d / 0.9e1;
  t11662 = t315 * t317 * t11474 / 0.9e1;
  t11663 = t863 * t4708;
  t11673 = t11659 + t11662 + t11663 / 0.54e2 + 0.2e1 / 0.3e1 * t10661 + 0.8e1 / 0.9e1 * t10664 + t10668 + t10670 - 0.16e2 / 0.9e1 * t10673 - t10676 - 0.2e1 / 0.9e1 * t10677 - 0.2e1 / 0.9e1 * t10680 - t10683 - t10686 - t10689 - 0.2e1 / 0.9e1 * t10690 - 0.2e1 / 0.9e1 * t10693 + t10696 / 0.18e2;
  t11686 = t10701 / 0.18e2 + t10707 / 0.9e1 + t10712 / 0.9e1 + t10715 / 0.18e2 + t10720 / 0.18e2 + 0.4e1 / 0.27e2 * t10723 + t10727 + t10730 + t10733 + 0.4e1 / 0.27e2 * t10735 + 0.4e1 / 0.27e2 * t10738 - t10741 + 0.2e1 / 0.27e2 * t10745 + 0.2e1 / 0.27e2 * t10749 + 0.4e1 / 0.27e2 * t10752 + t10754 / 0.27e2 + t10757;
  t11694 = t10759 + t10761 + t10764 + t10765 / 0.27e2 + t10770 + t10773 - t10778 - 0.8e1 / 0.9e1 * t10780 - t10784 + t10787 + t10790 + t10793 / 0.3e1 + t10796 / 0.3e1 + 0.2e1 / 0.9e1 * t10798 + t10802 + 0.4e1 / 0.9e1 * t10805 + t10810;
  t11697 = t955 * t956 * t4721;
  t11700 = t955 * t956 * t4712;
  t11724 = -0.16e2 / 0.9e1 * t2692 + 0.2e1 / 0.3e1 * t2699 - t2679 * t85 * t65 / 0.4e1 - t4686 * t237 / 0.2e1 - t1746 * t615 / 0.4e1 + 0.2e1 / 0.3e1 * t715 * t407 * t65 + 0.4e1 / 0.3e1 * t4691 * t237 + 0.2e1 / 0.3e1 * t1749 * t615 - t4270 * t396 / 0.4e1 - t1631 * t1002 / 0.2e1 - t545 * t2549 / 0.4e1;
  t11734 = -t10850 + t10851 + t9879 - t10907 - t70 * t11724 / 0.8e1 + t10487 / 0.32e2 + t10491 / 0.16e2 + t10493 / 0.16e2 + t10500 + t10503 / 0.16e2 + t10506 / 0.32e2 + t10513 / 0.576e3 + t10517 / 0.288e3;
  t11738 = t401 * t4260;
  t11741 = t401 * t4263 / 0.288e3;
  t11747 = t242 * t4666 / 0.108e3;
  t11752 = t71 * t665 * t407 * t101;
  t11756 = t71 * t4665 * t276 / 0.108e3;
  t11757 = t10519 / 0.288e3 + t10526 + t10528 / 0.288e3 + t10531 / 0.576e3 + t10942 - t10944 + t11738 / 0.576e3 + t11741 + t401 * t4266 / 0.576e3 - t620 * t1738 / 0.216e3 - t11747 - t242 * t4669 / 0.108e3 - t11752 / 0.216e3 - t11756;
  t11765 = t242 * t4674 / 0.288e3;
  t11769 = t71 * t4259 * t426;
  t11773 = t71 * t1623 * t1060 / 0.288e3;
  t11780 = t1008 * t1615 / 0.16e2;
  t11783 = t401 * t4244;
  t11786 = t401 * t4247 / 0.16e2;
  t11791 = -t71 * t1737 * t688 / 0.216e3 + t620 * t1741 / 0.576e3 + t11765 + t242 * t4677 / 0.288e3 + t11769 / 0.576e3 + t11773 + t71 * t540 * t2648 / 0.576e3 + t2555 * t537 / 0.32e2 + t11780 + t1008 * t1618 / 0.16e2 + t11783 / 0.32e2 + t11786 + t401 * t4250 / 0.32e2 - t620 * t1729 / 0.12e2;
  t11793 = t242 * t4642 / 0.6e1;
  t11798 = t71 * t635 * t407 * t65;
  t11802 = t71 * t4641 * t237 / 0.6e1;
  t11809 = t242 * t4650 / 0.16e2;
  t11813 = t71 * t4243 * t396;
  t11817 = t71 * t1614 * t1002 / 0.16e2;
  t11824 = t1008 * t1624 / 0.288e3;
  t11827 = -t11793 - t242 * t4645 / 0.6e1 - t11798 / 0.12e2 - t11802 - t71 * t1728 * t615 / 0.12e2 + t620 * t1732 / 0.32e2 + t11809 + t242 * t4653 / 0.16e2 + t11813 / 0.32e2 + t11817 + t71 * t536 * t2549 / 0.32e2 + t2555 * t541 / 0.576e3 + t11824 + t1008 * t1627 / 0.288e3;
  t11835 = t756 * t757 * t1757 * params->d;
  t11840 = t190 * t968 * t1758;
  t11844 = 0.4e1 / 0.3e1 * t190 * t191 * t4705;
  t11846 = t963 * t964 * t1758;
  t11848 = -0.8e1 / 0.9e1 * t10813 + t11697 / 0.27e2 + t11700 / 0.27e2 + t21 * t24 * (t11734 + t11757 + t11791 + t11827) - t10816 + 0.4e1 / 0.9e1 * t10819 + t10822 + t10826 + 0.2e1 / 0.9e1 * t11835 - t10828 + t10830 + 0.2e1 / 0.27e2 * t10832 + t10836 + t10839 + 0.2e1 / 0.27e2 * t10841 - 0.8e1 / 0.9e1 * t11840 + t11844 + 0.4e1 / 0.9e1 * t11846;
  tv4rho3sigma5 = t10480 + t11447 + t161 * (t11538 + t11582 + t11594 + t11652 + t11673 + t11686 + t11694 + t11848);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 5] += tv4rho3sigma5;

  t11853 = params->a * t4872;
  t11854 = t3377 * t519;
  t11856 = t315 * t317 * t11854;
  t11861 = t325 * t326 * t1264 * t519 * params->d;
  t11863 = t1137 * t1710;
  t11865 = t315 * t317 * t11863;
  t11870 = t325 * t326 * t379 * t1710 * params->d;
  t11872 = t318 * t4858;
  t11874 = t315 * t317 * t11872;
  t11879 = t325 * t326 * t12 * t4858 * params->d;
  t11883 = t195 * t196 * t16 * t4834;
  t11887 = t201 * t184 * t4834 * t203;
  t11893 = t11856 / 0.18e2 + t11861 / 0.18e2 + t11865 / 0.9e1 + t11870 / 0.9e1 + t11874 / 0.18e2 + t11879 / 0.18e2 + t11883 / 0.3e1 + t11887 / 0.3e1 + 0.4e1 / 0.27e2 * t11010 + 0.4e1 / 0.27e2 * t11058 + t11071 + t11079 + t11083 + t11087 - 0.14e2 / 0.27e2 * t11089 - t11094 + 0.4e1 / 0.27e2 * t11097;
  t11903 = 0.4e1 / 0.27e2 * t11101 - t11107 - t11111 - t11115 - 0.14e2 / 0.27e2 * t11117 + 0.8e1 / 0.9e1 * t11120 + 0.8e1 / 0.9e1 * t11124 + 0.2e1 / 0.27e2 * t9720 + t9724 + 0.4e1 / 0.9e1 * t9734 + t9737 + t9740 + 0.4e1 / 0.9e1 * t9743 + t9746 + t9750 + 0.2e1 / 0.27e2 * t9758 + 0.2e1 / 0.27e2 * t9762;
  t11915 = -t9765 - t9767 - 0.7e1 / 0.27e2 * t9769 - 0.7e1 / 0.27e2 * t9772 - t9776 + t9830 - t9834 + 0.2e1 / 0.27e2 * t9840 + 0.4e1 / 0.27e2 * t11143 + 0.4e1 / 0.27e2 * t11146 + t11150 + t11155 + 0.4e1 / 0.27e2 * t11158 + 0.4e1 / 0.27e2 * t11161 - 0.2e1 / 0.9e1 * t11164 - 0.2e1 / 0.9e1 * t11166 - 0.2e1 / 0.9e1 * t11169;
  t11918 = 0.88e2 / 0.9e1 * t9842;
  t11922 = -t11918 + t9879 + t10853 + t10859 + t10863 / 0.16e2 + t10867 + t10874 + t10877 / 0.288e3 + t10880 + t10887 + t10891 / 0.288e3 + t10895 + t10902;
  t11924 = t208 * t1402;
  t11925 = 0.8e1 / 0.3e1 * t11924;
  t11926 = t29 * t3239;
  t11949 = -0.16e2 / 0.9e1 * t3207 + 0.2e1 / 0.3e1 * t3200 - t3175 * t78 * t58 / 0.4e1 + 0.2e1 / 0.3e1 * t1431 * t251 * t58 - t4824 * t232 / 0.4e1 - t4464 * t392 / 0.2e1 + 0.4e1 / 0.3e1 * t4467 * t392 - t1688 * t994 / 0.2e1 - t1493 * t1283 / 0.4e1 + 0.2e1 / 0.3e1 * t1496 * t1283 - t504 * t3199 / 0.4e1;
  t11952 = 0.176e3 / 0.9e1 * t10943;
  t11969 = t10905 / 0.16e2 + t11925 - t11926 - t70 * t11949 / 0.8e1 + t10942 - t11952 - t9884 / 0.216e3 - t9921 / 0.12e2 - t401 * t4445 / 0.6e1 - t71 * t1471 * t1283 / 0.12e2 - t1365 * t1485 / 0.216e3 - t401 * t4450 / 0.108e3 - t71 * t1484 * t1382 / 0.216e3 - t1365 * t1472 / 0.12e2;
  t11977 = t401 * t4436;
  t11984 = t71 * t1480 * t1382;
  t11991 = t1365 * t1468;
  t11993 = t9934 / 0.576e3 + t9943 + t9945 / 0.576e3 + t9963 / 0.32e2 + t9972 + t9974 / 0.32e2 + t1008 * t1684 / 0.288e3 + t11977 / 0.288e3 + t401 * t4439 / 0.288e3 + t242 * t4820 / 0.576e3 + t11984 / 0.576e3 + t71 * t499 * t3258 / 0.576e3 + t3279 * t496 / 0.32e2 + t11991 / 0.32e2;
  t11998 = t401 * t4422;
  t12005 = t71 * t1467 * t1283;
  t12012 = t1365 * t1481;
  t12016 = t1365 * t1475 / 0.32e2 + t1008 * t1679 / 0.16e2 + t11998 / 0.16e2 + t401 * t4425 / 0.16e2 + t242 * t4811 / 0.32e2 + t12005 / 0.32e2 + t71 * t495 * t3199 / 0.32e2 + t3279 * t500 / 0.576e3 + t12012 / 0.576e3 + t1365 * t1488 / 0.576e3 - t10972 - t10989 - t10996 - t11003;
  t12026 = t11171 / 0.27e2 + t11175 + t11180 + t11183 + t11188 + 0.2e1 / 0.27e2 * t11191 + t11195 + t11200 + t21 * t24 * (t11922 + t11969 + t11993 + t12016) + 0.4e1 / 0.9e1 * t9998 + t10001 - 0.8e1 / 0.9e1 * t10003 - t10006 + t10013 + t11207 / 0.27e2 + 0.2e1 / 0.27e2 * t11211 - 0.2e1 / 0.9e1 * t11213 + t10016;
  t12037 = -t10018 + t10020 + t10023 - t10025 / 0.9e1 - t10029 - t10031 - t10033 / 0.9e1 - t10037 - t10041 / 0.9e1 - t10043 / 0.9e1 + t10057 / 0.27e2 + t10066 / 0.27e2 + 0.2e1 / 0.27e2 * t10069 + t10072 + t10074 + t10077 + t10085 / 0.54e2;
  t12047 = 0.2e1 / 0.27e2 * t10088 + t10093 / 0.54e2 + 0.2e1 / 0.27e2 * t10096 + 0.2e1 / 0.27e2 * t10099 + t10103 + t10107 + t10110 + 0.4e1 / 0.9e1 * t11238 + t11243 + t11247 + 0.2e1 / 0.9e1 * t11249 - 0.8e1 / 0.9e1 * t11252 - 0.8e1 / 0.9e1 * t11255 + t10115 + t10118 - 0.4e1 / 0.9e1 * t10120 - t10124;
  t12083 = -t9789 + 0.7e1 / 0.18e2 * t3421 - 0.7e1 / 0.48e2 * t3424 + t3405 * t78 * t516 / 0.8e1 - t1305 * t251 * t516 / 0.3e1 + t4850 * t1536 / 0.8e1 + t587 * t473 / 0.12e2 - 0.2e1 / 0.3e1 * t4536 * t1707 + t1704 * t4545 / 0.4e1 + t1530 * t4855 / 0.8e1 - t1533 * t4855 / 0.3e1 + t515 * t70 * t3199 / 0.8e1;
  t12089 = t334 * t336 * t11872;
  t12095 = t10129 / 0.9e1 + t10133 + 0.2e1 / 0.9e1 * t10139 + t10144 - 0.4e1 / 0.9e1 * t10146 - t10151 + 0.2e1 / 0.27e2 * t11265 + 0.2e1 / 0.27e2 * t11268 - t10153 + 0.2e1 / 0.9e1 * t10156 + t10159 + t10163 + 0.4e1 / 0.9e1 * t11273 + t130 * t137 * t345 * t4858 / 0.6e1 + t130 * t137 * t138 * t12083 / 0.6e1 + t12089 / 0.9e1 + t130 * t137 * t3368 * t519 / 0.6e1;
  t12101 = t334 * t336 * t11854;
  t12112 = t334 * t336 * t11863;
  t12116 = t130 * t137 * t3467 * t519;
  t12120 = t130 * t137 * t1187 * t1710;
  t12124 = t130 * t137 * t340 * t4858;
  t12131 = t190 * t191 * t4835;
  t12133 = t130 * t137 * t1265 * t1539 / 0.6e1 + t12101 / 0.9e1 + t130 * t137 * t1197 * t1710 / 0.3e1 + t130 * t137 * t462 * t4548 / 0.3e1 + 0.2e1 / 0.9e1 * t12112 - t12116 / 0.18e2 - t12120 / 0.9e1 - t12124 / 0.18e2 - t10165 + t10168 + t10170 + t10173 + t10175 / 0.27e2 + t10178 / 0.27e2 - 0.16e2 / 0.9e1 * t11278 + t11282 + 0.8e1 / 0.9e1 * t11284 + 0.2e1 / 0.3e1 * t12131;
  tv4rho3sigma6 = t10849 + t11853 + t161 * (t11893 + t11903 + t11915 + t12026 + t12037 + t12047 + t12095 + t12133);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 6] += tv4rho3sigma6;

  t12138 = params->a * t4892;
  t12149 = t201 * t1557 * t1402 * params->d;
  t12153 = t195 * t1552 * t16 * t1402;
  t12155 = -0.16e2 / 0.9e1 * t11294 - 0.16e2 / 0.9e1 * t11299 - 0.154e3 / 0.81e2 * t11301 - 0.154e3 / 0.81e2 * t11306 + t11311 + 0.7e1 / 0.81e2 * t11312 + 0.28e2 / 0.81e2 * t11316 + t11322 + 0.14e2 / 0.81e2 * t11326 + 0.28e2 / 0.81e2 * t11330 - 0.2e1 / 0.3e1 * t12149 - 0.2e1 / 0.3e1 * t12153;
  t12161 = -t11335 - t11339 + 0.8e2 / 0.9e1 * t11342 + 0.8e2 / 0.9e1 * t11345 - 0.4e1 / 0.9e1 * t11348 - 0.8e1 / 0.9e1 * t11352 - t10191 + t10195 + t10197 + 0.14e2 / 0.81e2 * t10200 + t10208 + t10214;
  t12166 = -t10219 + t10222 + t10227 - t10231 + 0.7e1 / 0.81e2 * t10235 + t10241 - t10245 - t10252 + 0.7e1 / 0.162e3 * t10257 + 0.14e2 / 0.81e2 * t10261 + t10266 + t10271;
  t12175 = -0.8e1 / 0.9e1 * t10273 - t10276 - t10279 - 0.8e1 / 0.9e1 * t10283 - 0.77e2 / 0.81e2 * t10285 - t10289 - 0.77e2 / 0.81e2 * t10293 + t10302 + 0.14e2 / 0.81e2 * t11368 + 0.14e2 / 0.81e2 * t10310 + 0.14e2 / 0.3e1 * t10314 + 0.8e2 / 0.9e1 * t10317 + t10326;
  t12182 = -0.161e3 / 0.81e2 * t10329 - t10335 - t10341 + t10346 - t10351 + t10359 - 0.8e1 / 0.9e1 * t10369 - t10374 + t10382 - 0.176e3 / 0.9e1 * t10384 + 0.7e1 / 0.81e2 * t10387 + t10392;
  t12187 = t10397 - t10400 + t10405 - t10409 - t10415 + t10419 - 0.2e1 / 0.9e1 * t10429 - t10433 - 0.4e1 / 0.9e1 * t10436 + 0.4e2 / 0.9e1 * t10439 + t10443 + 0.4e2 / 0.9e1 * t10445;
  t12193 = t201 * t1562 * t1402;
  t12200 = t1573 * t316 * t137 * t1264;
  t12202 = -t10450 - t10453 + t10457 - 0.4e1 / 0.9e1 * t10459 - t10464 - t10469 - 0.8e1 / 0.9e1 * t11394 + t11399 - 0.352e3 / 0.9e1 * t11401 + 0.16e2 / 0.3e1 * t12193 - 0.2e1 * t201 * t525 * t3239 + 0.7e1 / 0.54e2 * t12200;
  t12206 = t325 * t137 * t1570 * t1264 * params->d;
  t12215 = t529 * t18 * t1589 * t1264;
  t12223 = t529 * t1583 * t1584 * t1264;
  t12227 = t190 * t1547 * t24 * t1402;
  t12229 = 0.7e1 / 0.54e2 * t12206 + 0.28e2 / 0.3e1 * t11409 + 0.28e2 / 0.81e2 * t11413 + 0.16e3 / 0.9e1 * t11416 - 0.16e2 / 0.9e1 * t11419 + t11428 - t11432 - 0.322e3 / 0.81e2 * t11435 - t11440 - 0.7e1 / 0.6e1 * t12215 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t3095 + 0.7e1 / 0.27e2 * t12223 - 0.4e1 / 0.3e1 * t12227;
  tv4rho3sigma7 = t11292 + t12138 + t161 * (t12155 + t12161 + t12166 + t12175 + t12182 + t12187 + t12202 + t12229);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 7] += tv4rho3sigma7;

  t12234 = params->a * t5004;
  t12245 = t201 * t184 * t4992 * t203;
  t12247 = -t11451 - 0.14e2 / 0.27e2 * t11453 + 0.8e1 / 0.9e1 * t11456 + 0.8e1 / 0.9e1 * t11460 + t11469 + t11477 + 0.4e1 / 0.27e2 * t11479 + t11484 + t11518 + 0.4e1 / 0.27e2 * t11520 + 0.4e1 / 0.27e2 * t11536 - 0.14e2 / 0.27e2 * t11540 + 0.4e1 / 0.27e2 * t11544 - t11549 - t11553 - t11557 + t12245 / 0.3e1;
  t12250 = t195 * t196 * t16 * t4992;
  t12260 = t12250 / 0.3e1 + t11561 + t11565 + 0.2e1 / 0.9e1 * t11567 + 0.4e1 / 0.9e1 * t11571 - 0.8e1 / 0.9e1 * t11574 - 0.8e1 / 0.9e1 * t11577 - t10573 + t10576 - t10579 + 0.2e1 / 0.27e2 * t10582 + 0.2e1 / 0.27e2 * t10590 + 0.2e1 / 0.27e2 * t10593 + t10597 + 0.4e1 / 0.9e1 * t10600 + t10603 + t10606;
  t12270 = 0.4e1 / 0.9e1 * t10609 + t10612 + t10616 + 0.2e1 / 0.27e2 * t10618 - t10639 - t10641 - 0.7e1 / 0.27e2 * t10651 - 0.7e1 / 0.27e2 * t10654 + t11600 + t11603 + t11608 + t11611 + t11616 + 0.2e1 / 0.27e2 * t11619 + 0.2e1 / 0.27e2 * t11623 - 0.2e1 / 0.9e1 * t11625 - 0.2e1 / 0.9e1 * t11628;
  t12283 = 0.4e1 / 0.27e2 * t11631 + 0.4e1 / 0.27e2 * t11634 - 0.2e1 / 0.9e1 * t11636 - 0.2e1 / 0.9e1 * t11639 + t11641 / 0.27e2 + 0.4e1 / 0.27e2 * t11644 + 0.4e1 / 0.27e2 * t11647 + t11651 + t11659 + t11662 + t11663 / 0.27e2 + 0.4e1 / 0.9e1 * t10664 + t10668 + t10670 - 0.8e1 / 0.9e1 * t10673 - t10676 - t10677 / 0.9e1 - t10680 / 0.9e1;
  t12295 = -t10683 - t10686 - t10689 - t10690 / 0.9e1 - t10693 / 0.9e1 + 0.2e1 / 0.27e2 * t10723 + t10727 + t10730 + t10733 + 0.2e1 / 0.27e2 * t10735 + 0.2e1 / 0.27e2 * t10738 - t10741 + t10745 / 0.27e2 + t10749 / 0.27e2 + 0.2e1 / 0.27e2 * t10752 + t10754 / 0.54e2 + t10757;
  t12302 = t10759 + t10761 + t10764 + t10765 / 0.54e2 + t10770 + t10773 - t10778 - 0.4e1 / 0.9e1 * t10780 - t10784 + t10787 + t10790 + t10798 / 0.9e1 + t10802 + 0.2e1 / 0.9e1 * t10805 + t10810 - 0.4e1 / 0.9e1 * t10813 + 0.2e1 / 0.27e2 * t11697;
  t12341 = -t9789 - 0.77e2 / 0.54e2 * t3444 + 0.7e1 / 0.9e1 * t3449 - 0.7e1 / 0.48e2 * t3454 + t3428 * t85 * t556 / 0.8e1 + t4902 * t1666 / 0.8e1 + 0.2e1 / 0.9e1 * t587 * t481 - 0.2e1 / 0.3e1 * t4905 * t1666 - t587 * t484 / 0.12e2 + t1766 * t4753 / 0.4e1 + 0.11e2 / 0.9e1 * t364 * t1287 * t556 + 0.11e2 / 0.9e1 * t4910 * t1666 - 0.2e1 / 0.3e1 * t4746 * t1772 - 0.2e1 / 0.3e1 * t1769 * t4753 + t1663 * t4915 / 0.8e1 + t555 * t70 * t3163 / 0.8e1;
  t12346 = t318 * t4918;
  t12348 = t334 * t336 * t12346;
  t12358 = t3377 * t559;
  t12360 = t334 * t336 * t12358;
  t12370 = t1137 * t1775;
  t12372 = t334 * t336 * t12370;
  t12376 = t130 * t137 * t340 * t4918;
  t12380 = t130 * t137 * t3467 * t559;
  t12382 = 0.2e1 / 0.27e2 * t11700 - t10816 + 0.2e1 / 0.9e1 * t10819 + t10822 + t10826 + 0.4e1 / 0.9e1 * t11835 + t130 * t137 * t345 * t4918 / 0.6e1 + t130 * t137 * t138 * t12341 / 0.6e1 + t12348 / 0.9e1 + t130 * t137 * t3368 * t559 / 0.6e1 + t130 * t137 * t1265 * t1669 / 0.6e1 + t12360 / 0.9e1 + t130 * t137 * t1197 * t1775 / 0.3e1 + t130 * t137 * t462 * t4756 / 0.3e1 + 0.2e1 / 0.9e1 * t12372 - t12376 / 0.18e2 - t12380 / 0.18e2;
  t12385 = t130 * t137 * t1187 * t1775;
  t12390 = t325 * t326 * t379 * t1775 * params->d;
  t12393 = t315 * t317 * t12346;
  t12398 = t325 * t326 * t12 * t4918 * params->d;
  t12401 = t315 * t317 * t12358;
  t12406 = t325 * t326 * t1264 * t559 * params->d;
  t12409 = t315 * t317 * t12370;
  t12443 = 0.176e3 / 0.27e2 * t3141 - 0.32e2 / 0.9e1 * t3146 + 0.2e1 / 0.3e1 * t3164 - t3125 * t85 * t65 / 0.4e1 - t4940 * t237 / 0.4e1 + 0.4e1 / 0.3e1 * t1083 * t407 * t65 + 0.4e1 / 0.3e1 * t4943 * t237 - t4686 * t396 / 0.2e1 - t1746 * t1002 / 0.2e1 - 0.22e2 / 0.9e1 * t287 * t1287 * t65 - 0.22e2 / 0.9e1 * t4948 * t237 + 0.4e1 / 0.3e1 * t4691 * t396 + 0.4e1 / 0.3e1 * t1749 * t1002 - t1631 * t1300 / 0.4e1 - t545 * t3163 / 0.4e1;
  t12451 = -t11918 + t9879 - t70 * t12443 / 0.8e1 + t11925 - t11926 + t10491 / 0.32e2 + t10500 + t10503 / 0.32e2 + t10517 / 0.576e3 + t10526 + t10528 / 0.576e3 + t10942 - t11952 + t11738 / 0.288e3 + t11741 - t11747;
  t12458 = t71 * t1623 * t1393;
  t12463 = -t11752 / 0.108e3 - t11756 + t11765 + t11769 / 0.288e3 + t11773 + t11780 + t11783 / 0.16e2 + t11786 - t11793 - t11798 / 0.6e1 - t11802 + t11809 + t11813 / 0.16e2 + t11817 + t11824 + t12458 / 0.576e3 + t71 * t540 * t3273 / 0.576e3;
  t12467 = t401 * t4642;
  t12475 = t71 * t245 * t1287 * t65;
  t12482 = t401 * t4666;
  t12490 = t71 * t264 * t1287 * t101;
  t12497 = t1365 * t1615;
  t12503 = t401 * t4650;
  t12505 = -t1008 * t1729 / 0.6e1 - t12467 / 0.6e1 - t401 * t4645 / 0.6e1 + 0.11e2 / 0.36e2 * t242 * t4961 + 0.11e2 / 0.36e2 * t12475 + 0.11e2 / 0.36e2 * t71 * t4960 * t237 - t1008 * t1738 / 0.108e3 - t12482 / 0.108e3 - t401 * t4669 / 0.108e3 + 0.11e2 / 0.648e3 * t242 * t4968 + 0.11e2 / 0.648e3 * t12490 + 0.11e2 / 0.648e3 * t71 * t4967 * t276 + t3279 * t537 / 0.32e2 + t12497 / 0.32e2 + t1365 * t1618 / 0.32e2 + t1008 * t1732 / 0.16e2 + t12503 / 0.16e2;
  t12511 = t71 * t4641 * t396;
  t12519 = t71 * t1614 * t1300;
  t12526 = t1365 * t1624;
  t12532 = t401 * t4674;
  t12539 = t71 * t4665 * t426;
  t12546 = t401 * t4653 / 0.16e2 - t242 * t4975 / 0.6e1 - t12511 / 0.6e1 - t71 * t1728 * t1002 / 0.6e1 + t242 * t4978 / 0.32e2 + t12519 / 0.32e2 + t71 * t536 * t3163 / 0.32e2 + t3279 * t541 / 0.576e3 + t12526 / 0.576e3 + t1365 * t1627 / 0.576e3 + t1008 * t1741 / 0.288e3 + t12532 / 0.288e3 + t401 * t4677 / 0.288e3 - t242 * t4985 / 0.108e3 - t12539 / 0.108e3 - t71 * t1737 * t1060 / 0.108e3 + t242 * t4988 / 0.576e3;
  t12554 = t190 * t191 * t4993;
  t12556 = -t12385 / 0.9e1 + t12390 / 0.9e1 + t12393 / 0.18e2 + t12398 / 0.18e2 + t12401 / 0.18e2 + t12406 / 0.18e2 + t12409 / 0.9e1 - t10828 + t10830 + t10832 / 0.27e2 + t10836 + t10839 + t10841 / 0.27e2 + t21 * t24 * (t12451 + t12463 + t12505 + t12546) - 0.16e2 / 0.9e1 * t11840 + t11844 + 0.8e1 / 0.9e1 * t11846 + 0.2e1 / 0.3e1 * t12554;
  tv4rho3sigma8 = t11447 + t12234 + t161 * (t12247 + t12260 + t12270 + t12283 + t12295 + t12302 + t12382 + t12556);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 8] += tv4rho3sigma8;

  t12571 = t11856 / 0.6e1 + t11861 / 0.6e1 + t11865 / 0.3e1 + t11870 / 0.3e1 + t11874 / 0.6e1 + t11879 / 0.6e1 + t11883 + t11887 + 0.2e1 / 0.9e1 * t11010 + 0.2e1 / 0.9e1 * t11058 - 0.7e1 / 0.9e1 * t11089;
  t12577 = 0.2e1 / 0.9e1 * t11097 + 0.2e1 / 0.9e1 * t11101 - 0.7e1 / 0.9e1 * t11117 + 0.4e1 / 0.3e1 * t11120 + 0.4e1 / 0.3e1 * t11124 + t9724 + t9737 + t9740 + t9746 + t9750 - t9765;
  t12586 = -t9767 - t9776 + t9830 - t9834 + 0.2e1 / 0.9e1 * t11143 + 0.2e1 / 0.9e1 * t11146 + 0.2e1 / 0.9e1 * t11158 + 0.2e1 / 0.9e1 * t11161 - t11164 / 0.3e1 - t11166 / 0.3e1 - t11169 / 0.3e1;
  t12592 = t11171 / 0.18e2 + t11191 / 0.9e1 + t10001 - t10006 + t10013 + t11207 / 0.18e2 + t11211 / 0.9e1 - t11213 / 0.3e1 + t10016 - t10018 + t10020;
  t12596 = t10023 - t10029 - t10031 - t10037 + t10072 + t10074 + t10077 + t10103 + t10107 + t10110 + 0.2e1 / 0.3e1 * t11238;
  t12602 = t11249 / 0.3e1 - 0.4e1 / 0.3e1 * t11252 - 0.4e1 / 0.3e1 * t11255 + t10115 + t10118 - t10124 + t10133 + t10144 - t10151 + t11265 / 0.9e1 + t11268 / 0.9e1;
  t12604 = t29 * t3721;
  t12622 = 0.8e1 * t11924;
  t12632 = -t12604 - t70 * (0.2e1 / 0.3e1 * t3711 - t3703 * t78 * t58 / 0.4e1 - 0.3e1 / 0.4e1 * t4824 * t392 - 0.3e1 / 0.4e1 * t1688 * t1283 - t504 * t3590 / 0.4e1) / 0.8e1 + t9879 + 0.3e1 / 0.32e2 * t10863 + t10877 / 0.192e3 + t10891 / 0.192e3 + 0.3e1 / 0.32e2 * t10905 + t12622 + t3605 * t496 / 0.32e2 + 0.3e1 / 0.32e2 * t1365 * t1679 + 0.3e1 / 0.32e2 * t401 * t4811 + t71 * t499 * t3641 / 0.576e3;
  t12633 = 0.88e2 / 0.3e1 * t10943;
  t12649 = -t12633 + t9943 + t9972 + t11977 / 0.96e2 + t11984 / 0.192e3 + 0.3e1 / 0.32e2 * t11991 + 0.3e1 / 0.16e2 * t11998 + 0.3e1 / 0.32e2 * t12005 + t12012 / 0.192e3 + t71 * t495 * t3590 / 0.32e2 + t3605 * t500 / 0.576e3 + t1365 * t1684 / 0.192e3 + t401 * t4820 / 0.192e3;
  t12684 = t21 * t24 * (t12632 + t12649) + t130 * t137 * t138 * (-t9789 - 0.7e1 / 0.48e2 * t3791 + t3585 * t78 * t516 / 0.8e1 + 0.3e1 / 0.8e1 * t4850 * t1707 + 0.3e1 / 0.8e1 * t1704 * t4855 + t515 * t70 * t3590 / 0.8e1) / 0.6e1 + t130 * t137 * t3764 * t519 / 0.6e1 + t130 * t137 * t1265 * t1710 / 0.2e1 + t130 * t137 * t462 * t4858 / 0.2e1 - t10153 + t10159 + t10163 + 0.2e1 / 0.3e1 * t11273 + t12089 / 0.3e1 + t12101 / 0.3e1;
  t12692 = 0.2e1 / 0.3e1 * t12112 - t12116 / 0.6e1 - t12120 / 0.3e1 - t12124 / 0.6e1 - t10165 + t10168 + t10170 + t10173 - 0.8e1 / 0.3e1 * t11278 + 0.4e1 / 0.3e1 * t11284 + 0.2e1 * t12131;
  tv4rho3sigma9 = 0.3e1 * t11853 + t161 * (t12571 + t12577 + t12586 + t12592 + t12596 + t12602 + t12684 + t12692);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 9] += tv4rho3sigma9;

  t12715 = -0.2e1 * t201 * t525 * t3721 - 0.8e1 / 0.3e1 * t11294 - 0.8e1 / 0.3e1 * t11299 - 0.77e2 / 0.27e2 * t11301 - 0.77e2 / 0.27e2 * t11306 + 0.7e1 / 0.54e2 * t11312 + 0.14e2 / 0.27e2 * t11316 + 0.7e1 / 0.27e2 * t11326 + 0.14e2 / 0.27e2 * t11330 - 0.2e1 * t12149 - 0.2e1 * t12153 + 0.4e2 / 0.3e1 * t11342 + 0.4e2 / 0.3e1 * t11345 - 0.2e1 / 0.3e1 * t11348 - 0.4e1 / 0.3e1 * t11352 - t10191 + t10195;
  t12717 = t10197 + t10208 + t10214 - t10219 + t10222 + t10227 - t10231 + t10241 - t10245 - t10252 + t10266 + t10271 - t10276 - t10279 - t10289 + t10302 + 0.7e1 / 0.27e2 * t11368 + t10326;
  t12723 = -t10335 - t10341 + t10346 - t10351 + t10359 - t10374 + 0.7e1 / 0.18e2 * t529 * t18 * t530 * t3568 + t10382 + t10392 + t10397 - t10400 + t10405 - t10409 - t10415 + t10419 - t10433 + t10443;
  t12737 = -t10450 - t10453 + t10457 - t10464 - t10469 - 0.4e1 / 0.3e1 * t11394 - 0.176e3 / 0.3e1 * t11401 + 0.16e2 * t12193 + 0.7e1 / 0.18e2 * t12200 + 0.7e1 / 0.18e2 * t12206 + 0.14e2 * t11409 + 0.14e2 / 0.27e2 * t11413 + 0.8e2 / 0.3e1 * t11416 - 0.8e1 / 0.3e1 * t11419 - 0.161e3 / 0.27e2 * t11435 - 0.7e1 / 0.2e1 * t12215 + 0.7e1 / 0.9e1 * t12223 - 0.4e1 * t12227;
  tv4rho3sigma10 = 0.3e1 * t12138 + t161 * (t12715 + t12717 + t12723 + t12737);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 10] += tv4rho3sigma10;

  t12770 = -0.2464e4 / 0.81e2 * t3666 + 0.176e3 / 0.9e1 * t3689 - 0.16e2 / 0.3e1 * t3692 + 0.2e1 / 0.3e1 * t3695 - t3679 * t85 * t65 / 0.4e1 + 0.2e1 * t1411 * t407 * t65 - 0.3e1 / 0.4e1 * t4940 * t396 - 0.22e2 / 0.3e1 * t437 * t1287 * t65 + 0.4e1 * t4943 * t396 - 0.3e1 / 0.4e1 * t1746 * t1300 + 0.308e3 / 0.27e2 * t109 * t3615 * t65 - 0.22e2 / 0.3e1 * t4948 * t396 + 0.2e1 * t1749 * t1300 - t545 * t3600 / 0.4e1;
  t12789 = -t12604 + t9879 + t12622 - t70 * t12770 / 0.8e1 + t3605 * t541 / 0.576e3 + t1365 * t1741 / 0.192e3 + t401 * t4988 / 0.192e3 - t71 * t1737 * t1393 / 0.72e2 + t71 * t540 * t3656 / 0.576e3 - t1365 * t1729 / 0.4e1 - t401 * t4975 / 0.2e1;
  t12818 = 0.11e2 / 0.12e2 * t71 * t4960 * t396 - t1365 * t1738 / 0.72e2 - t401 * t4985 / 0.36e2 + 0.11e2 / 0.216e3 * t71 * t4967 * t426 + t3605 * t537 / 0.32e2 + 0.3e1 / 0.32e2 * t1365 * t1732 + 0.3e1 / 0.32e2 * t401 * t4978 - t71 * t1728 * t1300 / 0.4e1 + t71 * t536 * t3600 / 0.32e2 + 0.11e2 / 0.12e2 * t401 * t4961 - 0.77e2 / 0.54e2 * t71 * t73 * t3615 * t65;
  t12832 = 0.11e2 / 0.216e3 * t401 * t4968 - 0.77e2 / 0.972e3 * t71 * t92 * t3615 * t101 + t10500 + t10526 - t12633 + t11738 / 0.192e3 - t11752 / 0.72e2 + t11769 / 0.192e3 + 0.3e1 / 0.32e2 * t11783 - t11798 / 0.4e1 + 0.3e1 / 0.32e2 * t11813;
  t12845 = t12458 / 0.192e3 - t12467 / 0.2e1 + 0.11e2 / 0.12e2 * t12475 - t12482 / 0.36e2 + 0.11e2 / 0.216e3 * t12490 + 0.3e1 / 0.32e2 * t12497 + 0.3e1 / 0.16e2 * t12503 - t12511 / 0.2e1 + 0.3e1 / 0.32e2 * t12519 + t12526 / 0.192e3 + t12532 / 0.96e2 - t12539 / 0.36e2;
  t12858 = t21 * t24 * (t12789 + t12818 + t12832 + t12845) - 0.7e1 / 0.9e1 * t11453 + 0.4e1 / 0.3e1 * t11456 + 0.4e1 / 0.3e1 * t11460 + 0.2e1 / 0.9e1 * t11479 + 0.2e1 / 0.9e1 * t11520 + 0.2e1 / 0.9e1 * t11536 - 0.7e1 / 0.9e1 * t11540 + 0.2e1 / 0.9e1 * t11544 + t12245 + t12250;
  t12863 = t11567 / 0.3e1 + 0.2e1 / 0.3e1 * t11571 - 0.4e1 / 0.3e1 * t11574 - 0.4e1 / 0.3e1 * t11577 - t10573 + t10576 - t10579 + t10597 + t10603 + t10606 + t10612;
  t12873 = t10616 - t10639 - t10641 + t11619 / 0.9e1 + t11623 / 0.9e1 - t11625 / 0.3e1 - t11628 / 0.3e1 + 0.2e1 / 0.9e1 * t11631 + 0.2e1 / 0.9e1 * t11634 - t11636 / 0.3e1 - t11639 / 0.3e1;
  t12878 = t11641 / 0.18e2 + 0.2e1 / 0.9e1 * t11644 + 0.2e1 / 0.9e1 * t11647 + t11663 / 0.18e2 + t10668 + t10670 - t10676 - t10683 - t10686 - t10689 + t10727;
  t12881 = t10730 + t10733 - t10741 + t10757 + t10759 + t10761 + t10764 + t10770 + t10773 - t10778 - t10784;
  t12911 = t3794 * t85 * t556 / 0.8e1 + 0.3e1 / 0.8e1 * t4902 * t1772 - 0.2e1 * t4905 * t1772 + 0.3e1 / 0.8e1 * t1766 * t4915 + 0.11e2 / 0.3e1 * t4910 * t1772 - t1769 * t4915 + t555 * t70 * t3600 / 0.8e1 - t1314 * t407 * t556 + 0.11e2 / 0.3e1 * t476 * t1287 * t556 - 0.154e3 / 0.27e2 * t149 * t3615 * t556 - t9789 + 0.539e3 / 0.81e2 * t3781 - 0.77e2 / 0.18e2 * t3804 + 0.7e1 / 0.6e1 * t3807 - 0.7e1 / 0.48e2 * t3809;
  t12928 = t10787 + t10790 + t10802 + t10810 + t11697 / 0.9e1 + t11700 / 0.9e1 + t130 * t137 * t138 * t12911 / 0.6e1 + t130 * t137 * t3764 * t559 / 0.6e1 + t130 * t137 * t1265 * t1775 / 0.2e1 + t130 * t137 * t462 * t4918 / 0.2e1 - t10816;
  t12939 = t10822 + t10826 + 0.2e1 / 0.3e1 * t11835 + t12348 / 0.3e1 + t12360 / 0.3e1 + 0.2e1 / 0.3e1 * t12372 - t12376 / 0.6e1 - t12380 / 0.6e1 - t12385 / 0.3e1 + t12390 / 0.3e1 + t12393 / 0.6e1;
  t12947 = t12398 / 0.6e1 + t12401 / 0.6e1 + t12406 / 0.6e1 + t12409 / 0.3e1 - t10828 + t10830 + t10836 + t10839 - 0.8e1 / 0.3e1 * t11840 + 0.4e1 / 0.3e1 * t11846 + 0.2e1 * t12554;
  tv4rho3sigma11 = 0.3e1 * t12234 + t161 * (t12858 + t12863 + t12873 + t12878 + t12881 + t12928 + t12939 + t12947);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 11] += tv4rho3sigma11;

  tv4rho2sigma20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rho2sigma21 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 1] += tv4rho2sigma21;

  tv4rho2sigma22 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 2] += tv4rho2sigma22;

  tv4rho2sigma23 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 3] += tv4rho2sigma23;

  tv4rho2sigma24 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 4] += tv4rho2sigma24;

  tv4rho2sigma25 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 5] += tv4rho2sigma25;

  tv4rho2sigma26 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 6] += tv4rho2sigma26;

  tv4rho2sigma27 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 7] += tv4rho2sigma27;

  tv4rho2sigma28 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 8] += tv4rho2sigma28;

  tv4rho2sigma29 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 9] += tv4rho2sigma29;

  tv4rho2sigma210 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 10] += tv4rho2sigma210;

  tv4rho2sigma211 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 11] += tv4rho2sigma211;

  tv4rho2sigma212 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 12] += tv4rho2sigma212;

  tv4rho2sigma213 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 13] += tv4rho2sigma213;

  tv4rho2sigma214 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 14] += tv4rho2sigma214;

  tv4rho2sigma215 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 15] += tv4rho2sigma215;

  tv4rho2sigma216 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 16] += tv4rho2sigma216;

  tv4rho2sigma217 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 17] += tv4rho2sigma217;

  tv4rhosigma30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4rhosigma31 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 1] += tv4rhosigma31;

  tv4rhosigma32 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 2] += tv4rhosigma32;

  tv4rhosigma33 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 3] += tv4rhosigma33;

  tv4rhosigma34 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 4] += tv4rhosigma34;

  tv4rhosigma35 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 5] += tv4rhosigma35;

  tv4rhosigma36 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 6] += tv4rhosigma36;

  tv4rhosigma37 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 7] += tv4rhosigma37;

  tv4rhosigma38 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 8] += tv4rhosigma38;

  tv4rhosigma39 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 9] += tv4rhosigma39;

  tv4rhosigma310 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 10] += tv4rhosigma310;

  tv4rhosigma311 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 11] += tv4rhosigma311;

  tv4rhosigma312 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 12] += tv4rhosigma312;

  tv4rhosigma313 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 13] += tv4rhosigma313;

  tv4rhosigma314 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 14] += tv4rhosigma314;

  tv4rhosigma315 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 15] += tv4rhosigma315;

  tv4rhosigma316 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 16] += tv4rhosigma316;

  tv4rhosigma317 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 17] += tv4rhosigma317;

  tv4rhosigma318 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 18] += tv4rhosigma318;

  tv4rhosigma319 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 19] += tv4rhosigma319;

  tv4sigma40 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

  tv4sigma41 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 1] += tv4sigma41;

  tv4sigma42 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 2] += tv4sigma42;

  tv4sigma43 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 3] += tv4sigma43;

  tv4sigma44 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 4] += tv4sigma44;

  tv4sigma45 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 5] += tv4sigma45;

  tv4sigma46 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 6] += tv4sigma46;

  tv4sigma47 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 7] += tv4sigma47;

  tv4sigma48 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 8] += tv4sigma48;

  tv4sigma49 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 9] += tv4sigma49;

  tv4sigma410 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 10] += tv4sigma410;

  tv4sigma411 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 11] += tv4sigma411;

  tv4sigma412 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 12] += tv4sigma412;

  tv4sigma413 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 13] += tv4sigma413;

  tv4sigma414 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 14] += tv4sigma414;

}

#endif


#ifndef XC_DONT_COMPILE_EXC
GPU_DEVICE_FUNCTION static inline void
func_exc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t7, t8, t10, t12, t13;
  double t15, t16, t17, t18, t20, t21, t23, t24;
  double t26, t28, t29, t30, t31, t32, t34, t35;
  double t36, t37, t39, t43, t44, t45, t48, t49;
  double t52, t53, t56, t57, t58, t61, t62, t64;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t79, t81, t83, t84, t85, t86, tzk0;

  gga_c_lypr_params *params;

  assert(p->params != NULL);
  params = (gga_c_lypr_params * )(p->params);

  t2 = POW_1_3(rho[0]);
  t3 = 0.1e1 / t2;
  t5 = erfc(params->m1 * params->omega * t3);
  t7 = params->d * t3 + 0.1e1;
  t8 = 0.1e1 / t7;
  t10 = params->m2 * params->omega;
  t12 = erfc(t10 * t3);
  t13 = t12 * params->b;
  t15 = exp(-params->c * t3);
  t16 = t15 * t8;
  t17 = rho[0] * rho[0];
  t18 = t2 * t2;
  t20 = 0.1e1 / t18 / t17;
  t21 = sigma[0] * t20;
  t23 = params->d * t8 + params->c;
  t24 = t23 * t3;
  t26 = -0.1e1 / 0.72e2 - 0.7e1 / 0.72e2 * t24;
  t28 = M_CBRT3;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t34 = 0.1e1 <= p->zeta_threshold;
  t35 = p->zeta_threshold * p->zeta_threshold;
  t36 = POW_1_3(p->zeta_threshold);
  t37 = t36 * t36;
  t39 = my_piecewise3(t34, t37 * t35, 1);
  t43 = 0.5e1 / 0.2e1 - t24 / 0.18e2;
  t44 = t43 * sigma[0];
  t45 = t20 * t39;
  t48 = t24 - 0.11e2;
  t49 = t48 * sigma[0];
  t52 = my_piecewise3(t34, t37 * t35 * p->zeta_threshold, 1);
  t53 = t20 * t52;
  t56 = M_CBRT2;
  t57 = t56 * t56;
  t58 = sigma[0] * t57;
  t61 = my_piecewise3(t34, t35, 1);
  t62 = t61 * sigma[0];
  t64 = t57 * t20 * t39;
  t70 = -t21 * t26 - 0.3e1 / 0.1e2 * t29 * t32 * t39 + t44 * t45 / 0.8e1 + t49 * t53 / 0.144e3 - t56 * (0.4e1 / 0.3e1 * t58 * t45 - t62 * t64 / 0.2e1) / 0.8e1;
  t71 = t16 * t70;
  t73 = params->b * t15;
  t74 = sqrt(M_PI);
  t75 = 0.1e1 / t74;
  t76 = t8 * t75;
  t77 = t73 * t76;
  t78 = params->m2 * params->m2;
  t79 = params->omega * params->omega;
  t81 = 0.1e1 / t18;
  t83 = exp(-t78 * t79 * t81);
  t84 = t17 * rho[0];
  t85 = 0.1e1 / t84;
  t86 = t83 * t85;
  tzk0 = params->a * (-t5 * t8 + t13 * t71 + 0.7e1 / 0.36e2 * t77 * t10 * t86 * sigma[0]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

}

#endif


#ifndef XC_DONT_COMPILE_VXC
GPU_DEVICE_FUNCTION static inline void
func_vxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t7, t8, t10, t12, t13;
  double t15, t16, t17, t18, t20, t21, t23, t24;
  double t26, t28, t29, t30, t31, t32, t34, t35;
  double t36, t37, t39, t43, t44, t45, t48, t49;
  double t52, t53, t56, t57, t58, t61, t62, t64;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t79, t81, t83, t84, t85, t86, tzk0;

  double t92, t93, t96, t98, t100, t105, t106, t107;
  double t108, t111, t112, t113, t117, t118, t119, t123;
  double t124, t129, t130, t133, t134, t139, t140, t142;
  double t143, t146, t150, t151, t154, t160, t166, t167;
  double t169, t170, t172, t173, t176, t177, t179, t182;
  double t184, t190, t191, t192, t194, t195, t200, t201;
  double t206, tvrho0, t216, t222, t223, t228, tvsigma0;

  gga_c_lypr_params *params;

  assert(p->params != NULL);
  params = (gga_c_lypr_params * )(p->params);

  t2 = POW_1_3(rho[0]);
  t3 = 0.1e1 / t2;
  t5 = erfc(params->m1 * params->omega * t3);
  t7 = params->d * t3 + 0.1e1;
  t8 = 0.1e1 / t7;
  t10 = params->m2 * params->omega;
  t12 = erfc(t10 * t3);
  t13 = t12 * params->b;
  t15 = exp(-params->c * t3);
  t16 = t15 * t8;
  t17 = rho[0] * rho[0];
  t18 = t2 * t2;
  t20 = 0.1e1 / t18 / t17;
  t21 = sigma[0] * t20;
  t23 = params->d * t8 + params->c;
  t24 = t23 * t3;
  t26 = -0.1e1 / 0.72e2 - 0.7e1 / 0.72e2 * t24;
  t28 = M_CBRT3;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t34 = 0.1e1 <= p->zeta_threshold;
  t35 = p->zeta_threshold * p->zeta_threshold;
  t36 = POW_1_3(p->zeta_threshold);
  t37 = t36 * t36;
  t39 = my_piecewise3(t34, t37 * t35, 1);
  t43 = 0.5e1 / 0.2e1 - t24 / 0.18e2;
  t44 = t43 * sigma[0];
  t45 = t20 * t39;
  t48 = t24 - 0.11e2;
  t49 = t48 * sigma[0];
  t52 = my_piecewise3(t34, t37 * t35 * p->zeta_threshold, 1);
  t53 = t20 * t52;
  t56 = M_CBRT2;
  t57 = t56 * t56;
  t58 = sigma[0] * t57;
  t61 = my_piecewise3(t34, t35, 1);
  t62 = t61 * sigma[0];
  t64 = t57 * t20 * t39;
  t70 = -t21 * t26 - 0.3e1 / 0.1e2 * t29 * t32 * t39 + t44 * t45 / 0.8e1 + t49 * t53 / 0.144e3 - t56 * (0.4e1 / 0.3e1 * t58 * t45 - t62 * t64 / 0.2e1) / 0.8e1;
  t71 = t16 * t70;
  t73 = params->b * t15;
  t74 = sqrt(M_PI);
  t75 = 0.1e1 / t74;
  t76 = t8 * t75;
  t77 = t73 * t76;
  t78 = params->m2 * params->m2;
  t79 = params->omega * params->omega;
  t81 = 0.1e1 / t18;
  t83 = exp(-t78 * t79 * t81);
  t84 = t17 * rho[0];
  t85 = 0.1e1 / t84;
  t86 = t83 * t85;
  tzk0 = params->a * (-t5 * t8 + t13 * t71 + 0.7e1 / 0.36e2 * t77 * t10 * t86 * sigma[0]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t92 = rho[0] * params->a;
  t93 = params->m1 * params->m1;
  t96 = exp(-t93 * t79 * t81);
  t98 = t75 * t96 * params->m1;
  t100 = 0.1e1 / t2 / rho[0];
  t105 = t7 * t7;
  t106 = 0.1e1 / t105;
  t107 = t5 * t106;
  t108 = params->d * t100;
  t111 = t75 * t83;
  t112 = t111 * t10;
  t113 = t100 * params->b;
  t117 = t13 * params->c;
  t118 = t100 * t15;
  t119 = t8 * t70;
  t123 = t13 * t15;
  t124 = t106 * t70;
  t129 = 0.1e1 / t18 / t84;
  t130 = sigma[0] * t129;
  t133 = params->d * params->d;
  t134 = t133 * t106;
  t139 = -t134 / t18 / rho[0] + t23 * t100;
  t140 = 0.7e1 / 0.216e3 * t139;
  t142 = t139 / 0.54e2;
  t143 = t142 * sigma[0];
  t146 = t129 * t39;
  t150 = -t139 / 0.3e1;
  t151 = t150 * sigma[0];
  t154 = t129 * t52;
  t160 = t57 * t129 * t39;
  t166 = 0.8e1 / 0.3e1 * t130 * t26 - t21 * t140 + t143 * t45 / 0.8e1 - t44 * t146 / 0.3e1 + t151 * t53 / 0.144e3 - t49 * t154 / 0.54e2 - t56 * (-0.32e2 / 0.9e1 * t58 * t146 + 0.4e1 / 0.3e1 * t62 * t160) / 0.8e1;
  t167 = t16 * t166;
  t169 = params->b * params->c;
  t170 = t17 * t17;
  t172 = 0.1e1 / t2 / t170;
  t173 = t172 * t15;
  t176 = t75 * params->m2;
  t177 = params->omega * t83;
  t179 = t176 * t177 * sigma[0];
  t182 = t106 * t75;
  t184 = t73 * t182 * params->m2;
  t190 = t78 * params->m2;
  t191 = t79 * params->omega;
  t192 = t190 * t191;
  t194 = 0.1e1 / t18 / t170;
  t195 = t194 * t83;
  t200 = 0.1e1 / t170;
  t201 = t83 * t200;
  t206 = -0.2e1 / 0.3e1 * t98 * params->omega * t100 * t8 - t107 * t108 / 0.3e1 + 0.2e1 / 0.3e1 * t112 * t113 * t71 + t117 * t118 * t119 / 0.3e1 + t123 * t124 * t108 / 0.3e1 + t13 * t167 + 0.7e1 / 0.108e3 * t169 * t173 * t8 * t179 + 0.7e1 / 0.108e3 * t184 * t177 * t172 * sigma[0] * params->d + 0.7e1 / 0.54e2 * t77 * t192 * t195 * sigma[0] - 0.7e1 / 0.12e2 * t77 * t10 * t201 * sigma[0];
  tvrho0 = t92 * t206 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t216 = t61 * t57;
  t222 = -t20 * t26 + t43 * t20 * t39 / 0.8e1 + t48 * t20 * t52 / 0.144e3 - t56 * (0.4e1 / 0.3e1 * t64 - t216 * t45 / 0.2e1) / 0.8e1;
  t223 = t16 * t222;
  t228 = t13 * t223 + 0.7e1 / 0.36e2 * t77 * t10 * t86;
  tvsigma0 = t92 * t228;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

}

#endif


#ifndef XC_DONT_COMPILE_FXC
GPU_DEVICE_FUNCTION static inline void
func_fxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t7, t8, t10, t12, t13;
  double t15, t16, t17, t18, t20, t21, t23, t24;
  double t26, t28, t29, t30, t31, t32, t34, t35;
  double t36, t37, t39, t43, t44, t45, t48, t49;
  double t52, t53, t56, t57, t58, t61, t62, t64;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t79, t81, t83, t84, t85, t86, tzk0;

  double t92, t93, t96, t98, t100, t105, t106, t107;
  double t108, t111, t112, t113, t117, t118, t119, t123;
  double t124, t129, t130, t133, t134, t139, t140, t142;
  double t143, t146, t150, t151, t154, t160, t166, t167;
  double t169, t170, t172, t173, t176, t177, t179, t182;
  double t184, t190, t191, t192, t194, t195, t200, t201;
  double t206, tvrho0, t216, t222, t223, t228, tvsigma0;

  double t231, t236, t238, t239, t240, t242, t245, t246;
  double t248, t253, t254, t259, t265, t266, t271, t277;
  double t283, t284, t287, t288, t290, t293, t295, t296;
  double t307, t308, t311, t312, t315, t316, t318, t319;
  double t324, t325, t326, t329, t330, t332, t335, t337;
  double t338, t344, t346, t347, t351, t355, t360, t364;
  double t368, t369, t370, t374, t378, t379, t383, t392;
  double t394, t399, t403, t408, t409, t418, t419, t420;
  double t423, t424, t425, t426, t427, t429, t430, t436;
  double t437, t438, t441, t442, tv2rho20, t448, t452, t477;
  double t478, t482, t485, t497, tv2rhosigma0, tv2sigma20;

  gga_c_lypr_params *params;

  assert(p->params != NULL);
  params = (gga_c_lypr_params * )(p->params);

  t2 = POW_1_3(rho[0]);
  t3 = 0.1e1 / t2;
  t5 = erfc(params->m1 * params->omega * t3);
  t7 = params->d * t3 + 0.1e1;
  t8 = 0.1e1 / t7;
  t10 = params->m2 * params->omega;
  t12 = erfc(t10 * t3);
  t13 = t12 * params->b;
  t15 = exp(-params->c * t3);
  t16 = t15 * t8;
  t17 = rho[0] * rho[0];
  t18 = t2 * t2;
  t20 = 0.1e1 / t18 / t17;
  t21 = sigma[0] * t20;
  t23 = params->d * t8 + params->c;
  t24 = t23 * t3;
  t26 = -0.1e1 / 0.72e2 - 0.7e1 / 0.72e2 * t24;
  t28 = M_CBRT3;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t34 = 0.1e1 <= p->zeta_threshold;
  t35 = p->zeta_threshold * p->zeta_threshold;
  t36 = POW_1_3(p->zeta_threshold);
  t37 = t36 * t36;
  t39 = my_piecewise3(t34, t37 * t35, 1);
  t43 = 0.5e1 / 0.2e1 - t24 / 0.18e2;
  t44 = t43 * sigma[0];
  t45 = t20 * t39;
  t48 = t24 - 0.11e2;
  t49 = t48 * sigma[0];
  t52 = my_piecewise3(t34, t37 * t35 * p->zeta_threshold, 1);
  t53 = t20 * t52;
  t56 = M_CBRT2;
  t57 = t56 * t56;
  t58 = sigma[0] * t57;
  t61 = my_piecewise3(t34, t35, 1);
  t62 = t61 * sigma[0];
  t64 = t57 * t20 * t39;
  t70 = -t21 * t26 - 0.3e1 / 0.1e2 * t29 * t32 * t39 + t44 * t45 / 0.8e1 + t49 * t53 / 0.144e3 - t56 * (0.4e1 / 0.3e1 * t58 * t45 - t62 * t64 / 0.2e1) / 0.8e1;
  t71 = t16 * t70;
  t73 = params->b * t15;
  t74 = sqrt(M_PI);
  t75 = 0.1e1 / t74;
  t76 = t8 * t75;
  t77 = t73 * t76;
  t78 = params->m2 * params->m2;
  t79 = params->omega * params->omega;
  t81 = 0.1e1 / t18;
  t83 = exp(-t78 * t79 * t81);
  t84 = t17 * rho[0];
  t85 = 0.1e1 / t84;
  t86 = t83 * t85;
  tzk0 = params->a * (-t5 * t8 + t13 * t71 + 0.7e1 / 0.36e2 * t77 * t10 * t86 * sigma[0]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t92 = rho[0] * params->a;
  t93 = params->m1 * params->m1;
  t96 = exp(-t93 * t79 * t81);
  t98 = t75 * t96 * params->m1;
  t100 = 0.1e1 / t2 / rho[0];
  t105 = t7 * t7;
  t106 = 0.1e1 / t105;
  t107 = t5 * t106;
  t108 = params->d * t100;
  t111 = t75 * t83;
  t112 = t111 * t10;
  t113 = t100 * params->b;
  t117 = t13 * params->c;
  t118 = t100 * t15;
  t119 = t8 * t70;
  t123 = t13 * t15;
  t124 = t106 * t70;
  t129 = 0.1e1 / t18 / t84;
  t130 = sigma[0] * t129;
  t133 = params->d * params->d;
  t134 = t133 * t106;
  t139 = -t134 / t18 / rho[0] + t23 * t100;
  t140 = 0.7e1 / 0.216e3 * t139;
  t142 = t139 / 0.54e2;
  t143 = t142 * sigma[0];
  t146 = t129 * t39;
  t150 = -t139 / 0.3e1;
  t151 = t150 * sigma[0];
  t154 = t129 * t52;
  t160 = t57 * t129 * t39;
  t166 = 0.8e1 / 0.3e1 * t130 * t26 - t21 * t140 + t143 * t45 / 0.8e1 - t44 * t146 / 0.3e1 + t151 * t53 / 0.144e3 - t49 * t154 / 0.54e2 - t56 * (-0.32e2 / 0.9e1 * t58 * t146 + 0.4e1 / 0.3e1 * t62 * t160) / 0.8e1;
  t167 = t16 * t166;
  t169 = params->b * params->c;
  t170 = t17 * t17;
  t172 = 0.1e1 / t2 / t170;
  t173 = t172 * t15;
  t176 = t75 * params->m2;
  t177 = params->omega * t83;
  t179 = t176 * t177 * sigma[0];
  t182 = t106 * t75;
  t184 = t73 * t182 * params->m2;
  t190 = t78 * params->m2;
  t191 = t79 * params->omega;
  t192 = t190 * t191;
  t194 = 0.1e1 / t18 / t170;
  t195 = t194 * t83;
  t200 = 0.1e1 / t170;
  t201 = t83 * t200;
  t206 = -0.2e1 / 0.3e1 * t98 * params->omega * t100 * t8 - t107 * t108 / 0.3e1 + 0.2e1 / 0.3e1 * t112 * t113 * t71 + t117 * t118 * t119 / 0.3e1 + t123 * t124 * t108 / 0.3e1 + t13 * t167 + 0.7e1 / 0.108e3 * t169 * t173 * t8 * t179 + 0.7e1 / 0.108e3 * t184 * t177 * t172 * sigma[0] * params->d + 0.7e1 / 0.54e2 * t77 * t192 * t195 * sigma[0] - 0.7e1 / 0.12e2 * t77 * t10 * t201 * sigma[0];
  tvrho0 = t92 * t206 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t216 = t61 * t57;
  t222 = -t20 * t26 + t43 * t20 * t39 / 0.8e1 + t48 * t20 * t52 / 0.144e3 - t56 * (0.4e1 / 0.3e1 * t64 - t216 * t45 / 0.2e1) / 0.8e1;
  t223 = t16 * t222;
  t228 = t13 * t223 + 0.7e1 / 0.36e2 * t77 * t10 * t86;
  tvsigma0 = t92 * t228;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t231 = sigma[0] * t194;
  t236 = t133 * params->d;
  t238 = 0.1e1 / t105 / t7;
  t239 = t236 * t238;
  t240 = t239 * t85;
  t242 = t134 * t20;
  t245 = 0.1e1 / t2 / t17;
  t246 = t23 * t245;
  t248 = -0.7e1 / 0.324e3 * t240 + 0.7e1 / 0.108e3 * t242 - 0.7e1 / 0.162e3 * t246;
  t253 = -t240 / 0.81e2 + t242 / 0.27e2 - 0.2e1 / 0.81e2 * t246;
  t254 = t253 * sigma[0];
  t259 = t194 * t39;
  t265 = 0.2e1 / 0.9e1 * t240 - 0.2e1 / 0.3e1 * t242 + 0.4e1 / 0.9e1 * t246;
  t266 = t265 * sigma[0];
  t271 = t194 * t52;
  t277 = t57 * t194 * t39;
  t283 = -0.88e2 / 0.9e1 * t231 * t26 + 0.16e2 / 0.3e1 * t130 * t140 - t21 * t248 + t254 * t45 / 0.8e1 - 0.2e1 / 0.3e1 * t143 * t146 + 0.11e2 / 0.9e1 * t44 * t259 + t266 * t53 / 0.144e3 - t151 * t154 / 0.27e2 + 0.11e2 / 0.162e3 * t49 * t271 - t56 * (0.352e3 / 0.27e2 * t58 * t259 - 0.44e2 / 0.9e1 * t62 * t277) / 0.8e1;
  t284 = t16 * t283;
  t287 = t13 * params->c * t20;
  t288 = t15 * t106;
  t290 = t288 * t70 * params->d;
  t293 = t170 * rho[0];
  t295 = 0.1e1 / t2 / t293;
  t296 = t295 * t15;
  t307 = t111 * t10 * t20;
  t308 = t169 * t71;
  t311 = t124 * params->d;
  t312 = t73 * t311;
  t315 = params->c * params->c;
  t316 = params->b * t315;
  t318 = 0.1e1 / t18 / t293;
  t319 = t318 * t15;
  t324 = t170 * t17;
  t325 = 0.1e1 / t324;
  t326 = t325 * t15;
  t329 = t75 * t190;
  t330 = t191 * t83;
  t332 = t329 * t330 * sigma[0];
  t335 = t238 * t75;
  t337 = t73 * t335 * params->m2;
  t338 = t318 * sigma[0];
  t344 = t73 * t182 * t190;
  t346 = t83 * sigma[0];
  t347 = t346 * params->d;
  t351 = params->d * t245;
  t355 = t245 * t15;
  t360 = t106 * params->d;
  t364 = t8 * t166;
  t368 = t13 * t284 + 0.2e1 / 0.9e1 * t287 * t290 - 0.77e2 / 0.162e3 * t169 * t296 * t8 * t179 - 0.77e2 / 0.162e3 * t184 * t177 * t295 * sigma[0] * params->d + 0.4e1 / 0.9e1 * t307 * t308 + 0.4e1 / 0.9e1 * t307 * t312 + 0.7e1 / 0.324e3 * t316 * t319 * t8 * t179 + 0.7e1 / 0.81e2 * t169 * t326 * t8 * t332 + 0.7e1 / 0.162e3 * t337 * t177 * t338 * t133 + 0.7e1 / 0.81e2 * t344 * t191 * t325 * t347 - 0.4e1 / 0.9e1 * t123 * t124 * t351 - 0.4e1 / 0.9e1 * t117 * t355 * t119 - 0.4e1 / 0.9e1 * t98 * params->omega * t20 * t360 + 0.2e1 / 0.3e1 * t117 * t118 * t364;
  t369 = t13 * t315;
  t370 = t20 * t15;
  t374 = t106 * t166;
  t378 = t238 * t70;
  t379 = t133 * t20;
  t383 = t5 * t238;
  t392 = t93 * params->m1;
  t394 = t75 * t392 * t191;
  t399 = t245 * params->b;
  t403 = t318 * t83;
  t408 = 0.1e1 / t293;
  t409 = t83 * t408;
  t418 = t329 * t191 * t85;
  t419 = t83 * params->b;
  t420 = t419 * t71;
  t423 = t78 * t78;
  t424 = t423 * params->m2;
  t425 = t79 * t79;
  t426 = t425 * params->omega;
  t427 = t424 * t426;
  t429 = 0.1e1 / t2 / t324;
  t430 = t429 * t83;
  t436 = t169 * t319 * t106;
  t437 = t176 * params->omega;
  t438 = t437 * t347;
  t441 = t369 * t370 * t119 / 0.9e1 + 0.2e1 / 0.3e1 * t123 * t374 * t108 + 0.2e1 / 0.9e1 * t123 * t378 * t379 - 0.2e1 / 0.9e1 * t383 * t379 + 0.4e1 / 0.9e1 * t107 * t351 + 0.8e1 / 0.9e1 * t98 * params->omega * t245 * t8 - 0.4e1 / 0.9e1 * t394 * t85 * t96 * t8 - 0.8e1 / 0.9e1 * t112 * t399 * t71 - 0.161e3 / 0.162e3 * t77 * t192 * t403 * sigma[0] + 0.7e1 / 0.3e1 * t77 * t10 * t409 * sigma[0] + 0.4e1 / 0.3e1 * t112 * t113 * t167 + 0.4e1 / 0.9e1 * t418 * t420 + 0.7e1 / 0.81e2 * t77 * t427 * t430 * sigma[0] + 0.7e1 / 0.162e3 * t436 * t438;
  t442 = t368 + t441;
  tv2rho20 = 0.2e1 * params->a * t206 + t92 * t442;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t448 = t8 * t222;
  t452 = t106 * t222;
  t477 = 0.8e1 / 0.3e1 * t129 * t26 - t20 * t140 + t142 * t20 * t39 / 0.8e1 - t43 * t129 * t39 / 0.3e1 + t150 * t20 * t52 / 0.144e3 - t48 * t129 * t52 / 0.54e2 - t56 * (-0.32e2 / 0.9e1 * t160 + 0.4e1 / 0.3e1 * t216 * t146) / 0.8e1;
  t478 = t16 * t477;
  t482 = t76 * t10 * t83;
  t485 = t73 * t182;
  t497 = 0.2e1 / 0.3e1 * t112 * t113 * t223 + t117 * t118 * t448 / 0.3e1 + t123 * t452 * t108 / 0.3e1 + t13 * t478 + 0.7e1 / 0.108e3 * t169 * t173 * t482 + 0.7e1 / 0.108e3 * t485 * t10 * t83 * t172 * params->d + 0.7e1 / 0.54e2 * t77 * t192 * t195 - 0.7e1 / 0.12e2 * t77 * t10 * t201;
  tv2rhosigma0 = params->a * t228 + t92 * t497;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2sigma20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

}

#endif


#ifndef XC_DONT_COMPILE_KXC
GPU_DEVICE_FUNCTION static inline void
func_kxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t7, t8, t10, t12, t13;
  double t15, t16, t17, t18, t20, t21, t23, t24;
  double t26, t28, t29, t30, t31, t32, t34, t35;
  double t36, t37, t39, t43, t44, t45, t48, t49;
  double t52, t53, t56, t57, t58, t61, t62, t64;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t79, t81, t83, t84, t85, t86, tzk0;

  double t92, t93, t96, t98, t100, t105, t106, t107;
  double t108, t111, t112, t113, t117, t118, t119, t123;
  double t124, t129, t130, t133, t134, t139, t140, t142;
  double t143, t146, t150, t151, t154, t160, t166, t167;
  double t169, t170, t172, t173, t176, t177, t179, t182;
  double t184, t190, t191, t192, t194, t195, t200, t201;
  double t206, tvrho0, t216, t222, t223, t228, tvsigma0;

  double t231, t236, t238, t239, t240, t242, t245, t246;
  double t248, t253, t254, t259, t265, t266, t271, t277;
  double t283, t284, t287, t288, t290, t293, t295, t296;
  double t307, t308, t311, t312, t315, t316, t318, t319;
  double t324, t325, t326, t329, t330, t332, t335, t337;
  double t338, t344, t346, t347, t351, t355, t360, t364;
  double t368, t369, t370, t374, t378, t379, t383, t392;
  double t394, t399, t403, t408, t409, t418, t419, t420;
  double t423, t424, t425, t426, t427, t429, t430, t436;
  double t437, t438, t441, t442, tv2rho20, t448, t452, t477;
  double t478, t482, t485, t497, tv2rhosigma0, tv2sigma20;

  double t502, t503, t514, t517, t528, t529, t530, t531;
  double t532, t534, t536, t538, t540, t546, t547, t553;
  double t560, t561, t568, t574, t580, t581, t584, t585;
  double t587, t591, t595, t599, t608, t609, t614, t615;
  double t621, t626, t629, t631, t632, t635, t636, t639;
  double t640, t645, t650, t651, t652, t653, t658, t659;
  double t660, t665, t666, t667, t669, t672, t675, t677;
  double t684, t686, t691, t696, t701, t712, t714, t721;
  double t732, t733, t737, t741, t742, t749, t757, t760;
  double t764, t770, t771, t774, t778, t783, t795, t798;
  double t803, t807, t810, t811, t812, t813, t814, t815;
  double t821, t825, t829, t830, t834, t835, t836, t839;
  double t840, t843, t845, tv3rho30, t853, t862, t869, t873;
  double t880, t883, t884, t887, t892, t903, t911, t914;
  double t958, t959, t961, t962, tv3rho2sigma0, tv3rhosigma20, tv3sigma30;

  gga_c_lypr_params *params;

  assert(p->params != NULL);
  params = (gga_c_lypr_params * )(p->params);

  t2 = POW_1_3(rho[0]);
  t3 = 0.1e1 / t2;
  t5 = erfc(params->m1 * params->omega * t3);
  t7 = params->d * t3 + 0.1e1;
  t8 = 0.1e1 / t7;
  t10 = params->m2 * params->omega;
  t12 = erfc(t10 * t3);
  t13 = t12 * params->b;
  t15 = exp(-params->c * t3);
  t16 = t15 * t8;
  t17 = rho[0] * rho[0];
  t18 = t2 * t2;
  t20 = 0.1e1 / t18 / t17;
  t21 = sigma[0] * t20;
  t23 = params->d * t8 + params->c;
  t24 = t23 * t3;
  t26 = -0.1e1 / 0.72e2 - 0.7e1 / 0.72e2 * t24;
  t28 = M_CBRT3;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t34 = 0.1e1 <= p->zeta_threshold;
  t35 = p->zeta_threshold * p->zeta_threshold;
  t36 = POW_1_3(p->zeta_threshold);
  t37 = t36 * t36;
  t39 = my_piecewise3(t34, t37 * t35, 1);
  t43 = 0.5e1 / 0.2e1 - t24 / 0.18e2;
  t44 = t43 * sigma[0];
  t45 = t20 * t39;
  t48 = t24 - 0.11e2;
  t49 = t48 * sigma[0];
  t52 = my_piecewise3(t34, t37 * t35 * p->zeta_threshold, 1);
  t53 = t20 * t52;
  t56 = M_CBRT2;
  t57 = t56 * t56;
  t58 = sigma[0] * t57;
  t61 = my_piecewise3(t34, t35, 1);
  t62 = t61 * sigma[0];
  t64 = t57 * t20 * t39;
  t70 = -t21 * t26 - 0.3e1 / 0.1e2 * t29 * t32 * t39 + t44 * t45 / 0.8e1 + t49 * t53 / 0.144e3 - t56 * (0.4e1 / 0.3e1 * t58 * t45 - t62 * t64 / 0.2e1) / 0.8e1;
  t71 = t16 * t70;
  t73 = params->b * t15;
  t74 = sqrt(M_PI);
  t75 = 0.1e1 / t74;
  t76 = t8 * t75;
  t77 = t73 * t76;
  t78 = params->m2 * params->m2;
  t79 = params->omega * params->omega;
  t81 = 0.1e1 / t18;
  t83 = exp(-t78 * t79 * t81);
  t84 = t17 * rho[0];
  t85 = 0.1e1 / t84;
  t86 = t83 * t85;
  tzk0 = params->a * (-t5 * t8 + t13 * t71 + 0.7e1 / 0.36e2 * t77 * t10 * t86 * sigma[0]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t92 = rho[0] * params->a;
  t93 = params->m1 * params->m1;
  t96 = exp(-t93 * t79 * t81);
  t98 = t75 * t96 * params->m1;
  t100 = 0.1e1 / t2 / rho[0];
  t105 = t7 * t7;
  t106 = 0.1e1 / t105;
  t107 = t5 * t106;
  t108 = params->d * t100;
  t111 = t75 * t83;
  t112 = t111 * t10;
  t113 = t100 * params->b;
  t117 = t13 * params->c;
  t118 = t100 * t15;
  t119 = t8 * t70;
  t123 = t13 * t15;
  t124 = t106 * t70;
  t129 = 0.1e1 / t18 / t84;
  t130 = sigma[0] * t129;
  t133 = params->d * params->d;
  t134 = t133 * t106;
  t139 = -t134 / t18 / rho[0] + t23 * t100;
  t140 = 0.7e1 / 0.216e3 * t139;
  t142 = t139 / 0.54e2;
  t143 = t142 * sigma[0];
  t146 = t129 * t39;
  t150 = -t139 / 0.3e1;
  t151 = t150 * sigma[0];
  t154 = t129 * t52;
  t160 = t57 * t129 * t39;
  t166 = 0.8e1 / 0.3e1 * t130 * t26 - t21 * t140 + t143 * t45 / 0.8e1 - t44 * t146 / 0.3e1 + t151 * t53 / 0.144e3 - t49 * t154 / 0.54e2 - t56 * (-0.32e2 / 0.9e1 * t58 * t146 + 0.4e1 / 0.3e1 * t62 * t160) / 0.8e1;
  t167 = t16 * t166;
  t169 = params->b * params->c;
  t170 = t17 * t17;
  t172 = 0.1e1 / t2 / t170;
  t173 = t172 * t15;
  t176 = t75 * params->m2;
  t177 = params->omega * t83;
  t179 = t176 * t177 * sigma[0];
  t182 = t106 * t75;
  t184 = t73 * t182 * params->m2;
  t190 = t78 * params->m2;
  t191 = t79 * params->omega;
  t192 = t190 * t191;
  t194 = 0.1e1 / t18 / t170;
  t195 = t194 * t83;
  t200 = 0.1e1 / t170;
  t201 = t83 * t200;
  t206 = -0.2e1 / 0.3e1 * t98 * params->omega * t100 * t8 - t107 * t108 / 0.3e1 + 0.2e1 / 0.3e1 * t112 * t113 * t71 + t117 * t118 * t119 / 0.3e1 + t123 * t124 * t108 / 0.3e1 + t13 * t167 + 0.7e1 / 0.108e3 * t169 * t173 * t8 * t179 + 0.7e1 / 0.108e3 * t184 * t177 * t172 * sigma[0] * params->d + 0.7e1 / 0.54e2 * t77 * t192 * t195 * sigma[0] - 0.7e1 / 0.12e2 * t77 * t10 * t201 * sigma[0];
  tvrho0 = t92 * t206 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t216 = t61 * t57;
  t222 = -t20 * t26 + t43 * t20 * t39 / 0.8e1 + t48 * t20 * t52 / 0.144e3 - t56 * (0.4e1 / 0.3e1 * t64 - t216 * t45 / 0.2e1) / 0.8e1;
  t223 = t16 * t222;
  t228 = t13 * t223 + 0.7e1 / 0.36e2 * t77 * t10 * t86;
  tvsigma0 = t92 * t228;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t231 = sigma[0] * t194;
  t236 = t133 * params->d;
  t238 = 0.1e1 / t105 / t7;
  t239 = t236 * t238;
  t240 = t239 * t85;
  t242 = t134 * t20;
  t245 = 0.1e1 / t2 / t17;
  t246 = t23 * t245;
  t248 = -0.7e1 / 0.324e3 * t240 + 0.7e1 / 0.108e3 * t242 - 0.7e1 / 0.162e3 * t246;
  t253 = -t240 / 0.81e2 + t242 / 0.27e2 - 0.2e1 / 0.81e2 * t246;
  t254 = t253 * sigma[0];
  t259 = t194 * t39;
  t265 = 0.2e1 / 0.9e1 * t240 - 0.2e1 / 0.3e1 * t242 + 0.4e1 / 0.9e1 * t246;
  t266 = t265 * sigma[0];
  t271 = t194 * t52;
  t277 = t57 * t194 * t39;
  t283 = -0.88e2 / 0.9e1 * t231 * t26 + 0.16e2 / 0.3e1 * t130 * t140 - t21 * t248 + t254 * t45 / 0.8e1 - 0.2e1 / 0.3e1 * t143 * t146 + 0.11e2 / 0.9e1 * t44 * t259 + t266 * t53 / 0.144e3 - t151 * t154 / 0.27e2 + 0.11e2 / 0.162e3 * t49 * t271 - t56 * (0.352e3 / 0.27e2 * t58 * t259 - 0.44e2 / 0.9e1 * t62 * t277) / 0.8e1;
  t284 = t16 * t283;
  t287 = t13 * params->c * t20;
  t288 = t15 * t106;
  t290 = t288 * t70 * params->d;
  t293 = t170 * rho[0];
  t295 = 0.1e1 / t2 / t293;
  t296 = t295 * t15;
  t307 = t111 * t10 * t20;
  t308 = t169 * t71;
  t311 = t124 * params->d;
  t312 = t73 * t311;
  t315 = params->c * params->c;
  t316 = params->b * t315;
  t318 = 0.1e1 / t18 / t293;
  t319 = t318 * t15;
  t324 = t170 * t17;
  t325 = 0.1e1 / t324;
  t326 = t325 * t15;
  t329 = t75 * t190;
  t330 = t191 * t83;
  t332 = t329 * t330 * sigma[0];
  t335 = t238 * t75;
  t337 = t73 * t335 * params->m2;
  t338 = t318 * sigma[0];
  t344 = t73 * t182 * t190;
  t346 = t83 * sigma[0];
  t347 = t346 * params->d;
  t351 = params->d * t245;
  t355 = t245 * t15;
  t360 = t106 * params->d;
  t364 = t8 * t166;
  t368 = t13 * t284 + 0.2e1 / 0.9e1 * t287 * t290 - 0.77e2 / 0.162e3 * t169 * t296 * t8 * t179 - 0.77e2 / 0.162e3 * t184 * t177 * t295 * sigma[0] * params->d + 0.4e1 / 0.9e1 * t307 * t308 + 0.4e1 / 0.9e1 * t307 * t312 + 0.7e1 / 0.324e3 * t316 * t319 * t8 * t179 + 0.7e1 / 0.81e2 * t169 * t326 * t8 * t332 + 0.7e1 / 0.162e3 * t337 * t177 * t338 * t133 + 0.7e1 / 0.81e2 * t344 * t191 * t325 * t347 - 0.4e1 / 0.9e1 * t123 * t124 * t351 - 0.4e1 / 0.9e1 * t117 * t355 * t119 - 0.4e1 / 0.9e1 * t98 * params->omega * t20 * t360 + 0.2e1 / 0.3e1 * t117 * t118 * t364;
  t369 = t13 * t315;
  t370 = t20 * t15;
  t374 = t106 * t166;
  t378 = t238 * t70;
  t379 = t133 * t20;
  t383 = t5 * t238;
  t392 = t93 * params->m1;
  t394 = t75 * t392 * t191;
  t399 = t245 * params->b;
  t403 = t318 * t83;
  t408 = 0.1e1 / t293;
  t409 = t83 * t408;
  t418 = t329 * t191 * t85;
  t419 = t83 * params->b;
  t420 = t419 * t71;
  t423 = t78 * t78;
  t424 = t423 * params->m2;
  t425 = t79 * t79;
  t426 = t425 * params->omega;
  t427 = t424 * t426;
  t429 = 0.1e1 / t2 / t324;
  t430 = t429 * t83;
  t436 = t169 * t319 * t106;
  t437 = t176 * params->omega;
  t438 = t437 * t347;
  t441 = t369 * t370 * t119 / 0.9e1 + 0.2e1 / 0.3e1 * t123 * t374 * t108 + 0.2e1 / 0.9e1 * t123 * t378 * t379 - 0.2e1 / 0.9e1 * t383 * t379 + 0.4e1 / 0.9e1 * t107 * t351 + 0.8e1 / 0.9e1 * t98 * params->omega * t245 * t8 - 0.4e1 / 0.9e1 * t394 * t85 * t96 * t8 - 0.8e1 / 0.9e1 * t112 * t399 * t71 - 0.161e3 / 0.162e3 * t77 * t192 * t403 * sigma[0] + 0.7e1 / 0.3e1 * t77 * t10 * t409 * sigma[0] + 0.4e1 / 0.3e1 * t112 * t113 * t167 + 0.4e1 / 0.9e1 * t418 * t420 + 0.7e1 / 0.81e2 * t77 * t427 * t430 * sigma[0] + 0.7e1 / 0.162e3 * t436 * t438;
  t442 = t368 + t441;
  tv2rho20 = 0.2e1 * params->a * t206 + t92 * t442;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t448 = t8 * t222;
  t452 = t106 * t222;
  t477 = 0.8e1 / 0.3e1 * t129 * t26 - t20 * t140 + t142 * t20 * t39 / 0.8e1 - t43 * t129 * t39 / 0.3e1 + t150 * t20 * t52 / 0.144e3 - t48 * t129 * t52 / 0.54e2 - t56 * (-0.32e2 / 0.9e1 * t160 + 0.4e1 / 0.3e1 * t216 * t146) / 0.8e1;
  t478 = t16 * t477;
  t482 = t76 * t10 * t83;
  t485 = t73 * t182;
  t497 = 0.2e1 / 0.3e1 * t112 * t113 * t223 + t117 * t118 * t448 / 0.3e1 + t123 * t452 * t108 / 0.3e1 + t13 * t478 + 0.7e1 / 0.108e3 * t169 * t173 * t482 + 0.7e1 / 0.108e3 * t485 * t10 * t83 * t172 * params->d + 0.7e1 / 0.54e2 * t77 * t192 * t195 - 0.7e1 / 0.12e2 * t77 * t10 * t201;
  tv2rhosigma0 = params->a * t228 + t92 * t497;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2sigma20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t502 = 0.1e1 / t2 / t84;
  t503 = params->d * t502;
  t514 = t93 * t93;
  t517 = t75 * t514 * params->m1 * t426;
  t528 = t133 * t133;
  t529 = t105 * t105;
  t530 = 0.1e1 / t529;
  t531 = t528 * t530;
  t532 = t531 * t172;
  t534 = t239 * t200;
  t536 = t134 * t129;
  t538 = t23 * t502;
  t540 = -0.7e1 / 0.324e3 * t532 + 0.35e2 / 0.324e3 * t534 - 0.91e2 / 0.486e3 * t536 + 0.49e2 / 0.486e3 * t538;
  t546 = -t532 / 0.81e2 + 0.5e1 / 0.81e2 * t534 - 0.26e2 / 0.243e3 * t536 + 0.14e2 / 0.243e3 * t538;
  t547 = t546 * sigma[0];
  t553 = t318 * t39;
  t560 = 0.2e1 / 0.9e1 * t532 - 0.1e2 / 0.9e1 * t534 + 0.52e2 / 0.27e2 * t536 - 0.28e2 / 0.27e2 * t538;
  t561 = t560 * sigma[0];
  t568 = t318 * t52;
  t574 = t57 * t318 * t39;
  t580 = 0.1232e4 / 0.27e2 * t338 * t26 - 0.88e2 / 0.3e1 * t231 * t140 + 0.8e1 * t130 * t248 - t21 * t540 + t547 * t45 / 0.8e1 - t254 * t146 + 0.11e2 / 0.3e1 * t143 * t259 - 0.154e3 / 0.27e2 * t44 * t553 + t561 * t53 / 0.144e3 - t266 * t154 / 0.18e2 + 0.11e2 / 0.54e2 * t151 * t271 - 0.77e2 / 0.243e3 * t49 * t568 - t56 * (-0.4928e4 / 0.81e2 * t58 * t553 + 0.616e3 / 0.27e2 * t62 * t574) / 0.8e1;
  t581 = t16 * t580;
  t584 = t13 * params->c * t200;
  t585 = t15 * t238;
  t587 = t585 * t70 * t133;
  t591 = t13 * params->c * t129;
  t595 = t288 * t166 * params->d;
  t599 = t13 * t315 * t200;
  t608 = 0.1e1 / t18 / t324;
  t609 = t608 * sigma[0];
  t614 = t170 * t84;
  t615 = 0.1e1 / t614;
  t621 = t111 * t10 * t129;
  t626 = t169 * t167;
  t629 = -0.28e2 / 0.27e2 * t107 * t503 - 0.56e2 / 0.27e2 * t98 * params->omega * t502 * t8 + 0.52e2 / 0.27e2 * t394 * t200 * t96 * t8 - 0.8e1 / 0.27e2 * t517 * t194 * t96 * t8 + t13 * t581 + 0.2e1 / 0.9e1 * t584 * t587 - 0.8e1 / 0.9e1 * t591 * t290 + 0.2e1 / 0.3e1 * t287 * t595 + t599 * t290 / 0.9e1 + 0.805e3 / 0.243e3 * t184 * t177 * t429 * sigma[0] * params->d - 0.91e2 / 0.162e3 * t337 * t177 * t609 * t133 - 0.7e1 / 0.6e1 * t344 * t191 * t615 * t347 - 0.16e2 / 0.9e1 * t621 * t312 - 0.16e2 / 0.9e1 * t621 * t308 + 0.4e1 / 0.3e1 * t307 * t626;
  t631 = t111 * t10 * t200;
  t632 = t316 * t71;
  t635 = t374 * params->d;
  t636 = t73 * t635;
  t639 = t378 * t133;
  t640 = t73 * t639;
  t645 = t329 * t191 * t172 * t83;
  t650 = t315 * params->c;
  t651 = params->b * t650;
  t652 = t615 * t15;
  t653 = t652 * t8;
  t658 = 0.1e1 / t2 / t614;
  t659 = t658 * t15;
  t660 = t659 * t8;
  t665 = 0.1e1 / t18 / t614;
  t666 = t665 * t15;
  t667 = t666 * t8;
  t669 = t75 * t424;
  t672 = t669 * t426 * t83 * sigma[0];
  t675 = t530 * t75;
  t677 = t73 * t675 * params->m2;
  t684 = t73 * t335 * t190;
  t686 = t346 * t133;
  t691 = t73 * t182 * t424;
  t696 = t429 * t15;
  t701 = t608 * t15;
  t712 = 0.2e1 / 0.9e1 * t631 * t632 + 0.4e1 / 0.3e1 * t307 * t636 + 0.4e1 / 0.9e1 * t631 * t640 + 0.4e1 / 0.9e1 * t645 * t308 + 0.4e1 / 0.9e1 * t645 * t312 + 0.7e1 / 0.972e3 * t651 * t653 * t179 + 0.7e1 / 0.162e3 * t316 * t660 * t332 + 0.7e1 / 0.81e2 * t169 * t667 * t672 + 0.7e1 / 0.162e3 * t677 * t177 * t615 * sigma[0] * t236 + 0.7e1 / 0.81e2 * t684 * t191 * t658 * t686 + 0.7e1 / 0.81e2 * t691 * t426 * t665 * t347 + 0.805e3 / 0.243e3 * t169 * t696 * t8 * t179 - 0.91e2 / 0.324e3 * t316 * t701 * t8 * t179 - 0.7e1 / 0.6e1 * t169 * t653 * t332 - 0.4e1 / 0.3e1 * t123 * t374 * t351;
  t714 = t133 * t129;
  t721 = t129 * t15;
  t732 = t13 * t650;
  t733 = t200 * t15;
  t737 = t238 * t166;
  t741 = t530 * t70;
  t742 = t236 * t200;
  t749 = t502 * t15;
  t757 = t8 * t283;
  t760 = t106 * t283;
  t764 = t238 * t133;
  t770 = -0.8e1 / 0.9e1 * t123 * t378 * t714 - 0.4e1 / 0.3e1 * t117 * t355 * t364 - 0.4e1 / 0.9e1 * t369 * t721 * t119 - 0.4e1 / 0.9e1 * t394 * t172 * t96 * t360 + t369 * t370 * t364 / 0.3e1 + t732 * t733 * t119 / 0.27e2 + 0.2e1 / 0.3e1 * t123 * t737 * t379 + 0.2e1 / 0.9e1 * t123 * t741 * t742 + 0.28e2 / 0.27e2 * t123 * t124 * t503 + 0.28e2 / 0.27e2 * t117 * t749 * t119 + 0.16e2 / 0.9e1 * t98 * params->omega * t129 * t360 + t117 * t118 * t757 + t123 * t760 * t108 - 0.4e1 / 0.9e1 * t98 * params->omega * t200 * t764 + 0.8e1 / 0.9e1 * t383 * t714;
  t771 = t5 * t530;
  t774 = t502 * params->b;
  t778 = t608 * t83;
  t783 = t83 * t325;
  t795 = t329 * t191 * t200;
  t798 = t658 * t83;
  t803 = t419 * t167;
  t807 = t669 * t426 * t194;
  t810 = t423 * t190;
  t811 = t425 * t191;
  t812 = t810 * t811;
  t813 = t170 * t170;
  t814 = 0.1e1 / t813;
  t815 = t814 * t83;
  t821 = t169 * t701 * t106;
  t825 = t316 * t652 * t106;
  t829 = t169 * t652 * t238;
  t830 = t437 * t686;
  t834 = t169 * t659 * t106;
  t835 = t329 * t191;
  t836 = t835 * t347;
  t839 = t169 * t15;
  t840 = t839 * t311;
  t843 = -0.2e1 / 0.9e1 * t771 * t742 + 0.56e2 / 0.27e2 * t112 * t774 * t71 + 0.3493e4 / 0.486e3 * t77 * t192 * t778 * sigma[0] - 0.35e2 / 0.3e1 * t77 * t10 * t783 * sigma[0] + 0.2e1 * t112 * t113 * t284 - 0.8e1 / 0.3e1 * t112 * t399 * t167 - 0.52e2 / 0.27e2 * t795 * t420 - 0.98e2 / 0.81e2 * t77 * t427 * t798 * sigma[0] + 0.4e1 / 0.3e1 * t418 * t803 + 0.8e1 / 0.27e2 * t807 * t420 + 0.14e2 / 0.243e3 * t77 * t812 * t815 * sigma[0] - 0.91e2 / 0.162e3 * t821 * t438 + 0.7e1 / 0.324e3 * t825 * t438 + 0.7e1 / 0.162e3 * t829 * t830 + 0.7e1 / 0.81e2 * t834 * t836 + 0.4e1 / 0.9e1 * t631 * t840;
  t845 = t629 + t712 + t770 + t843;
  tv3rho30 = 0.3e1 * params->a * t442 + t92 * t845;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t853 = t288 * t222 * params->d;
  t862 = t8 * t477;
  t869 = t106 * t477;
  t873 = t238 * t222;
  t880 = t169 * t223;
  t883 = t452 * params->d;
  t884 = t73 * t883;
  t887 = -0.4e1 / 0.9e1 * t117 * t355 * t448 + 0.2e1 / 0.9e1 * t287 * t853 - 0.4e1 / 0.9e1 * t123 * t452 * t351 + 0.7e1 / 0.81e2 * t77 * t427 * t430 + 0.2e1 / 0.3e1 * t117 * t118 * t862 + t369 * t370 * t448 / 0.9e1 + 0.2e1 / 0.3e1 * t123 * t869 * t108 + 0.2e1 / 0.9e1 * t123 * t873 * t379 - 0.8e1 / 0.9e1 * t112 * t399 * t223 + 0.4e1 / 0.9e1 * t307 * t880 + 0.4e1 / 0.9e1 * t307 * t884;
  t892 = t176 * t177 * params->d;
  t903 = t419 * t223;
  t911 = t76 * t192 * t83;
  t914 = t73 * t335;
  t958 = -0.88e2 / 0.9e1 * t194 * t26 + 0.16e2 / 0.3e1 * t129 * t140 - t20 * t248 + t253 * t20 * t39 / 0.8e1 - 0.2e1 / 0.3e1 * t142 * t129 * t39 + 0.11e2 / 0.9e1 * t43 * t194 * t39 + t265 * t20 * t52 / 0.144e3 - t150 * t129 * t52 / 0.27e2 + 0.11e2 / 0.162e3 * t48 * t194 * t52 - t56 * (0.352e3 / 0.27e2 * t277 - 0.44e2 / 0.9e1 * t216 * t259) / 0.8e1;
  t959 = t16 * t958;
  t961 = -0.77e2 / 0.162e3 * t169 * t296 * t482 + 0.7e1 / 0.162e3 * t436 * t892 - 0.77e2 / 0.162e3 * t485 * t10 * t83 * t295 * params->d + 0.4e1 / 0.3e1 * t112 * t113 * t478 + 0.4e1 / 0.9e1 * t418 * t903 + 0.7e1 / 0.324e3 * t316 * t319 * t482 + 0.7e1 / 0.81e2 * t169 * t326 * t911 + 0.7e1 / 0.162e3 * t914 * t10 * t403 * t133 + 0.7e1 / 0.81e2 * t485 * t192 * t783 * params->d - 0.161e3 / 0.162e3 * t77 * t192 * t403 + 0.7e1 / 0.3e1 * t77 * t10 * t409 + t13 * t959;
  t962 = t887 + t961;
  tv3rho2sigma0 = 0.2e1 * params->a * t497 + t92 * t962;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3sigma30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

}

#endif


#ifndef XC_DONT_COMPILE_LXC
GPU_DEVICE_FUNCTION static inline void
func_lxc_unpol(const xc_func_type *p, size_t ip, const double *rho, const double *sigma, xc_gga_out_params *out)
{
  double t2, t3, t5, t7, t8, t10, t12, t13;
  double t15, t16, t17, t18, t20, t21, t23, t24;
  double t26, t28, t29, t30, t31, t32, t34, t35;
  double t36, t37, t39, t43, t44, t45, t48, t49;
  double t52, t53, t56, t57, t58, t61, t62, t64;
  double t70, t71, t73, t74, t75, t76, t77, t78;
  double t79, t81, t83, t84, t85, t86, tzk0;

  double t92, t93, t96, t98, t100, t105, t106, t107;
  double t108, t111, t112, t113, t117, t118, t119, t123;
  double t124, t129, t130, t133, t134, t139, t140, t142;
  double t143, t146, t150, t151, t154, t160, t166, t167;
  double t169, t170, t172, t173, t176, t177, t179, t182;
  double t184, t190, t191, t192, t194, t195, t200, t201;
  double t206, tvrho0, t216, t222, t223, t228, tvsigma0;

  double t231, t236, t238, t239, t240, t242, t245, t246;
  double t248, t253, t254, t259, t265, t266, t271, t277;
  double t283, t284, t287, t288, t290, t293, t295, t296;
  double t307, t308, t311, t312, t315, t316, t318, t319;
  double t324, t325, t326, t329, t330, t332, t335, t337;
  double t338, t344, t346, t347, t351, t355, t360, t364;
  double t368, t369, t370, t374, t378, t379, t383, t392;
  double t394, t399, t403, t408, t409, t418, t419, t420;
  double t423, t424, t425, t426, t427, t429, t430, t436;
  double t437, t438, t441, t442, tv2rho20, t448, t452, t477;
  double t478, t482, t485, t497, tv2rhosigma0, tv2sigma20;

  double t502, t503, t514, t517, t528, t529, t530, t531;
  double t532, t534, t536, t538, t540, t546, t547, t553;
  double t560, t561, t568, t574, t580, t581, t584, t585;
  double t587, t591, t595, t599, t608, t609, t614, t615;
  double t621, t626, t629, t631, t632, t635, t636, t639;
  double t640, t645, t650, t651, t652, t653, t658, t659;
  double t660, t665, t666, t667, t669, t672, t675, t677;
  double t684, t686, t691, t696, t701, t712, t714, t721;
  double t732, t733, t737, t741, t742, t749, t757, t760;
  double t764, t770, t771, t774, t778, t783, t795, t798;
  double t803, t807, t810, t811, t812, t813, t814, t815;
  double t821, t825, t829, t830, t834, t835, t836, t839;
  double t840, t843, t845, tv3rho30, t853, t862, t869, t873;
  double t880, t883, t884, t887, t892, t903, t911, t914;
  double t958, t959, t961, t962, tv3rho2sigma0, tv3rhosigma20, tv3sigma30;

  double t972, t973, t981, t986, t988, t1004, t1020, t1022;
  double t1024, t1026, t1028, t1030, t1067, t1070, t1074, t1077;
  double t1080, t1091, t1095, t1144, t1151, t1155, t1172, t1173;
  double t1178, t1193, t1200, t1205, t1221, t1222, t1223, t1228;
  double t1229, t1230, t1249, t1256, t1264, t1267, t1273, t1293;
  double t1339, t1393, t1412, t1417, t1447, t1468, t1505, tv4rho40;
  double t1554, t1598, t1636, t1673, t1715, tv4rho3sigma0, tv4rho2sigma20, tv4rhosigma30;
  double tv4sigma40;

  gga_c_lypr_params *params;

  assert(p->params != NULL);
  params = (gga_c_lypr_params * )(p->params);

  t2 = POW_1_3(rho[0]);
  t3 = 0.1e1 / t2;
  t5 = erfc(params->m1 * params->omega * t3);
  t7 = params->d * t3 + 0.1e1;
  t8 = 0.1e1 / t7;
  t10 = params->m2 * params->omega;
  t12 = erfc(t10 * t3);
  t13 = t12 * params->b;
  t15 = exp(-params->c * t3);
  t16 = t15 * t8;
  t17 = rho[0] * rho[0];
  t18 = t2 * t2;
  t20 = 0.1e1 / t18 / t17;
  t21 = sigma[0] * t20;
  t23 = params->d * t8 + params->c;
  t24 = t23 * t3;
  t26 = -0.1e1 / 0.72e2 - 0.7e1 / 0.72e2 * t24;
  t28 = M_CBRT3;
  t29 = t28 * t28;
  t30 = M_PI * M_PI;
  t31 = POW_1_3(t30);
  t32 = t31 * t31;
  t34 = 0.1e1 <= p->zeta_threshold;
  t35 = p->zeta_threshold * p->zeta_threshold;
  t36 = POW_1_3(p->zeta_threshold);
  t37 = t36 * t36;
  t39 = my_piecewise3(t34, t37 * t35, 1);
  t43 = 0.5e1 / 0.2e1 - t24 / 0.18e2;
  t44 = t43 * sigma[0];
  t45 = t20 * t39;
  t48 = t24 - 0.11e2;
  t49 = t48 * sigma[0];
  t52 = my_piecewise3(t34, t37 * t35 * p->zeta_threshold, 1);
  t53 = t20 * t52;
  t56 = M_CBRT2;
  t57 = t56 * t56;
  t58 = sigma[0] * t57;
  t61 = my_piecewise3(t34, t35, 1);
  t62 = t61 * sigma[0];
  t64 = t57 * t20 * t39;
  t70 = -t21 * t26 - 0.3e1 / 0.1e2 * t29 * t32 * t39 + t44 * t45 / 0.8e1 + t49 * t53 / 0.144e3 - t56 * (0.4e1 / 0.3e1 * t58 * t45 - t62 * t64 / 0.2e1) / 0.8e1;
  t71 = t16 * t70;
  t73 = params->b * t15;
  t74 = sqrt(M_PI);
  t75 = 0.1e1 / t74;
  t76 = t8 * t75;
  t77 = t73 * t76;
  t78 = params->m2 * params->m2;
  t79 = params->omega * params->omega;
  t81 = 0.1e1 / t18;
  t83 = exp(-t78 * t79 * t81);
  t84 = t17 * rho[0];
  t85 = 0.1e1 / t84;
  t86 = t83 * t85;
  tzk0 = params->a * (-t5 * t8 + t13 * t71 + 0.7e1 / 0.36e2 * t77 * t10 * t86 * sigma[0]);

  if(out->zk != NULL && (p->info->flags & XC_FLAGS_HAVE_EXC))
    out->zk[ip*p->dim.zk + 0] += tzk0;

  t92 = rho[0] * params->a;
  t93 = params->m1 * params->m1;
  t96 = exp(-t93 * t79 * t81);
  t98 = t75 * t96 * params->m1;
  t100 = 0.1e1 / t2 / rho[0];
  t105 = t7 * t7;
  t106 = 0.1e1 / t105;
  t107 = t5 * t106;
  t108 = params->d * t100;
  t111 = t75 * t83;
  t112 = t111 * t10;
  t113 = t100 * params->b;
  t117 = t13 * params->c;
  t118 = t100 * t15;
  t119 = t8 * t70;
  t123 = t13 * t15;
  t124 = t106 * t70;
  t129 = 0.1e1 / t18 / t84;
  t130 = sigma[0] * t129;
  t133 = params->d * params->d;
  t134 = t133 * t106;
  t139 = -t134 / t18 / rho[0] + t23 * t100;
  t140 = 0.7e1 / 0.216e3 * t139;
  t142 = t139 / 0.54e2;
  t143 = t142 * sigma[0];
  t146 = t129 * t39;
  t150 = -t139 / 0.3e1;
  t151 = t150 * sigma[0];
  t154 = t129 * t52;
  t160 = t57 * t129 * t39;
  t166 = 0.8e1 / 0.3e1 * t130 * t26 - t21 * t140 + t143 * t45 / 0.8e1 - t44 * t146 / 0.3e1 + t151 * t53 / 0.144e3 - t49 * t154 / 0.54e2 - t56 * (-0.32e2 / 0.9e1 * t58 * t146 + 0.4e1 / 0.3e1 * t62 * t160) / 0.8e1;
  t167 = t16 * t166;
  t169 = params->b * params->c;
  t170 = t17 * t17;
  t172 = 0.1e1 / t2 / t170;
  t173 = t172 * t15;
  t176 = t75 * params->m2;
  t177 = params->omega * t83;
  t179 = t176 * t177 * sigma[0];
  t182 = t106 * t75;
  t184 = t73 * t182 * params->m2;
  t190 = t78 * params->m2;
  t191 = t79 * params->omega;
  t192 = t190 * t191;
  t194 = 0.1e1 / t18 / t170;
  t195 = t194 * t83;
  t200 = 0.1e1 / t170;
  t201 = t83 * t200;
  t206 = -0.2e1 / 0.3e1 * t98 * params->omega * t100 * t8 - t107 * t108 / 0.3e1 + 0.2e1 / 0.3e1 * t112 * t113 * t71 + t117 * t118 * t119 / 0.3e1 + t123 * t124 * t108 / 0.3e1 + t13 * t167 + 0.7e1 / 0.108e3 * t169 * t173 * t8 * t179 + 0.7e1 / 0.108e3 * t184 * t177 * t172 * sigma[0] * params->d + 0.7e1 / 0.54e2 * t77 * t192 * t195 * sigma[0] - 0.7e1 / 0.12e2 * t77 * t10 * t201 * sigma[0];
  tvrho0 = t92 * t206 + tzk0;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vrho[ip*p->dim.vrho + 0] += tvrho0;

  t216 = t61 * t57;
  t222 = -t20 * t26 + t43 * t20 * t39 / 0.8e1 + t48 * t20 * t52 / 0.144e3 - t56 * (0.4e1 / 0.3e1 * t64 - t216 * t45 / 0.2e1) / 0.8e1;
  t223 = t16 * t222;
  t228 = t13 * t223 + 0.7e1 / 0.36e2 * t77 * t10 * t86;
  tvsigma0 = t92 * t228;

  if(out->vrho != NULL && (p->info->flags & XC_FLAGS_HAVE_VXC))
    out->vsigma[ip*p->dim.vsigma + 0] += tvsigma0;

  t231 = sigma[0] * t194;
  t236 = t133 * params->d;
  t238 = 0.1e1 / t105 / t7;
  t239 = t236 * t238;
  t240 = t239 * t85;
  t242 = t134 * t20;
  t245 = 0.1e1 / t2 / t17;
  t246 = t23 * t245;
  t248 = -0.7e1 / 0.324e3 * t240 + 0.7e1 / 0.108e3 * t242 - 0.7e1 / 0.162e3 * t246;
  t253 = -t240 / 0.81e2 + t242 / 0.27e2 - 0.2e1 / 0.81e2 * t246;
  t254 = t253 * sigma[0];
  t259 = t194 * t39;
  t265 = 0.2e1 / 0.9e1 * t240 - 0.2e1 / 0.3e1 * t242 + 0.4e1 / 0.9e1 * t246;
  t266 = t265 * sigma[0];
  t271 = t194 * t52;
  t277 = t57 * t194 * t39;
  t283 = -0.88e2 / 0.9e1 * t231 * t26 + 0.16e2 / 0.3e1 * t130 * t140 - t21 * t248 + t254 * t45 / 0.8e1 - 0.2e1 / 0.3e1 * t143 * t146 + 0.11e2 / 0.9e1 * t44 * t259 + t266 * t53 / 0.144e3 - t151 * t154 / 0.27e2 + 0.11e2 / 0.162e3 * t49 * t271 - t56 * (0.352e3 / 0.27e2 * t58 * t259 - 0.44e2 / 0.9e1 * t62 * t277) / 0.8e1;
  t284 = t16 * t283;
  t287 = t13 * params->c * t20;
  t288 = t15 * t106;
  t290 = t288 * t70 * params->d;
  t293 = t170 * rho[0];
  t295 = 0.1e1 / t2 / t293;
  t296 = t295 * t15;
  t307 = t111 * t10 * t20;
  t308 = t169 * t71;
  t311 = t124 * params->d;
  t312 = t73 * t311;
  t315 = params->c * params->c;
  t316 = params->b * t315;
  t318 = 0.1e1 / t18 / t293;
  t319 = t318 * t15;
  t324 = t170 * t17;
  t325 = 0.1e1 / t324;
  t326 = t325 * t15;
  t329 = t75 * t190;
  t330 = t191 * t83;
  t332 = t329 * t330 * sigma[0];
  t335 = t238 * t75;
  t337 = t73 * t335 * params->m2;
  t338 = t318 * sigma[0];
  t344 = t73 * t182 * t190;
  t346 = t83 * sigma[0];
  t347 = t346 * params->d;
  t351 = params->d * t245;
  t355 = t245 * t15;
  t360 = t106 * params->d;
  t364 = t8 * t166;
  t368 = t13 * t284 + 0.2e1 / 0.9e1 * t287 * t290 - 0.77e2 / 0.162e3 * t169 * t296 * t8 * t179 - 0.77e2 / 0.162e3 * t184 * t177 * t295 * sigma[0] * params->d + 0.4e1 / 0.9e1 * t307 * t308 + 0.4e1 / 0.9e1 * t307 * t312 + 0.7e1 / 0.324e3 * t316 * t319 * t8 * t179 + 0.7e1 / 0.81e2 * t169 * t326 * t8 * t332 + 0.7e1 / 0.162e3 * t337 * t177 * t338 * t133 + 0.7e1 / 0.81e2 * t344 * t191 * t325 * t347 - 0.4e1 / 0.9e1 * t123 * t124 * t351 - 0.4e1 / 0.9e1 * t117 * t355 * t119 - 0.4e1 / 0.9e1 * t98 * params->omega * t20 * t360 + 0.2e1 / 0.3e1 * t117 * t118 * t364;
  t369 = t13 * t315;
  t370 = t20 * t15;
  t374 = t106 * t166;
  t378 = t238 * t70;
  t379 = t133 * t20;
  t383 = t5 * t238;
  t392 = t93 * params->m1;
  t394 = t75 * t392 * t191;
  t399 = t245 * params->b;
  t403 = t318 * t83;
  t408 = 0.1e1 / t293;
  t409 = t83 * t408;
  t418 = t329 * t191 * t85;
  t419 = t83 * params->b;
  t420 = t419 * t71;
  t423 = t78 * t78;
  t424 = t423 * params->m2;
  t425 = t79 * t79;
  t426 = t425 * params->omega;
  t427 = t424 * t426;
  t429 = 0.1e1 / t2 / t324;
  t430 = t429 * t83;
  t436 = t169 * t319 * t106;
  t437 = t176 * params->omega;
  t438 = t437 * t347;
  t441 = t369 * t370 * t119 / 0.9e1 + 0.2e1 / 0.3e1 * t123 * t374 * t108 + 0.2e1 / 0.9e1 * t123 * t378 * t379 - 0.2e1 / 0.9e1 * t383 * t379 + 0.4e1 / 0.9e1 * t107 * t351 + 0.8e1 / 0.9e1 * t98 * params->omega * t245 * t8 - 0.4e1 / 0.9e1 * t394 * t85 * t96 * t8 - 0.8e1 / 0.9e1 * t112 * t399 * t71 - 0.161e3 / 0.162e3 * t77 * t192 * t403 * sigma[0] + 0.7e1 / 0.3e1 * t77 * t10 * t409 * sigma[0] + 0.4e1 / 0.3e1 * t112 * t113 * t167 + 0.4e1 / 0.9e1 * t418 * t420 + 0.7e1 / 0.81e2 * t77 * t427 * t430 * sigma[0] + 0.7e1 / 0.162e3 * t436 * t438;
  t442 = t368 + t441;
  tv2rho20 = 0.2e1 * params->a * t206 + t92 * t442;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rho2[ip*p->dim.v2rho2 + 0] += tv2rho20;

  t448 = t8 * t222;
  t452 = t106 * t222;
  t477 = 0.8e1 / 0.3e1 * t129 * t26 - t20 * t140 + t142 * t20 * t39 / 0.8e1 - t43 * t129 * t39 / 0.3e1 + t150 * t20 * t52 / 0.144e3 - t48 * t129 * t52 / 0.54e2 - t56 * (-0.32e2 / 0.9e1 * t160 + 0.4e1 / 0.3e1 * t216 * t146) / 0.8e1;
  t478 = t16 * t477;
  t482 = t76 * t10 * t83;
  t485 = t73 * t182;
  t497 = 0.2e1 / 0.3e1 * t112 * t113 * t223 + t117 * t118 * t448 / 0.3e1 + t123 * t452 * t108 / 0.3e1 + t13 * t478 + 0.7e1 / 0.108e3 * t169 * t173 * t482 + 0.7e1 / 0.108e3 * t485 * t10 * t83 * t172 * params->d + 0.7e1 / 0.54e2 * t77 * t192 * t195 - 0.7e1 / 0.12e2 * t77 * t10 * t201;
  tv2rhosigma0 = params->a * t228 + t92 * t497;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2rhosigma[ip*p->dim.v2rhosigma + 0] += tv2rhosigma0;

  tv2sigma20 = 0.e0;

  if(out->v2rho2 != NULL && (p->info->flags & XC_FLAGS_HAVE_FXC))
    out->v2sigma2[ip*p->dim.v2sigma2 + 0] += tv2sigma20;

  t502 = 0.1e1 / t2 / t84;
  t503 = params->d * t502;
  t514 = t93 * t93;
  t517 = t75 * t514 * params->m1 * t426;
  t528 = t133 * t133;
  t529 = t105 * t105;
  t530 = 0.1e1 / t529;
  t531 = t528 * t530;
  t532 = t531 * t172;
  t534 = t239 * t200;
  t536 = t134 * t129;
  t538 = t23 * t502;
  t540 = -0.7e1 / 0.324e3 * t532 + 0.35e2 / 0.324e3 * t534 - 0.91e2 / 0.486e3 * t536 + 0.49e2 / 0.486e3 * t538;
  t546 = -t532 / 0.81e2 + 0.5e1 / 0.81e2 * t534 - 0.26e2 / 0.243e3 * t536 + 0.14e2 / 0.243e3 * t538;
  t547 = t546 * sigma[0];
  t553 = t318 * t39;
  t560 = 0.2e1 / 0.9e1 * t532 - 0.1e2 / 0.9e1 * t534 + 0.52e2 / 0.27e2 * t536 - 0.28e2 / 0.27e2 * t538;
  t561 = t560 * sigma[0];
  t568 = t318 * t52;
  t574 = t57 * t318 * t39;
  t580 = 0.1232e4 / 0.27e2 * t338 * t26 - 0.88e2 / 0.3e1 * t231 * t140 + 0.8e1 * t130 * t248 - t21 * t540 + t547 * t45 / 0.8e1 - t254 * t146 + 0.11e2 / 0.3e1 * t143 * t259 - 0.154e3 / 0.27e2 * t44 * t553 + t561 * t53 / 0.144e3 - t266 * t154 / 0.18e2 + 0.11e2 / 0.54e2 * t151 * t271 - 0.77e2 / 0.243e3 * t49 * t568 - t56 * (-0.4928e4 / 0.81e2 * t58 * t553 + 0.616e3 / 0.27e2 * t62 * t574) / 0.8e1;
  t581 = t16 * t580;
  t584 = t13 * params->c * t200;
  t585 = t15 * t238;
  t587 = t585 * t70 * t133;
  t591 = t13 * params->c * t129;
  t595 = t288 * t166 * params->d;
  t599 = t13 * t315 * t200;
  t608 = 0.1e1 / t18 / t324;
  t609 = t608 * sigma[0];
  t614 = t170 * t84;
  t615 = 0.1e1 / t614;
  t621 = t111 * t10 * t129;
  t626 = t169 * t167;
  t629 = -0.28e2 / 0.27e2 * t107 * t503 - 0.56e2 / 0.27e2 * t98 * params->omega * t502 * t8 + 0.52e2 / 0.27e2 * t394 * t200 * t96 * t8 - 0.8e1 / 0.27e2 * t517 * t194 * t96 * t8 + t13 * t581 + 0.2e1 / 0.9e1 * t584 * t587 - 0.8e1 / 0.9e1 * t591 * t290 + 0.2e1 / 0.3e1 * t287 * t595 + t599 * t290 / 0.9e1 + 0.805e3 / 0.243e3 * t184 * t177 * t429 * sigma[0] * params->d - 0.91e2 / 0.162e3 * t337 * t177 * t609 * t133 - 0.7e1 / 0.6e1 * t344 * t191 * t615 * t347 - 0.16e2 / 0.9e1 * t621 * t312 - 0.16e2 / 0.9e1 * t621 * t308 + 0.4e1 / 0.3e1 * t307 * t626;
  t631 = t111 * t10 * t200;
  t632 = t316 * t71;
  t635 = t374 * params->d;
  t636 = t73 * t635;
  t639 = t378 * t133;
  t640 = t73 * t639;
  t645 = t329 * t191 * t172 * t83;
  t650 = t315 * params->c;
  t651 = params->b * t650;
  t652 = t615 * t15;
  t653 = t652 * t8;
  t658 = 0.1e1 / t2 / t614;
  t659 = t658 * t15;
  t660 = t659 * t8;
  t665 = 0.1e1 / t18 / t614;
  t666 = t665 * t15;
  t667 = t666 * t8;
  t669 = t75 * t424;
  t672 = t669 * t426 * t83 * sigma[0];
  t675 = t530 * t75;
  t677 = t73 * t675 * params->m2;
  t684 = t73 * t335 * t190;
  t686 = t346 * t133;
  t691 = t73 * t182 * t424;
  t696 = t429 * t15;
  t701 = t608 * t15;
  t712 = 0.2e1 / 0.9e1 * t631 * t632 + 0.4e1 / 0.3e1 * t307 * t636 + 0.4e1 / 0.9e1 * t631 * t640 + 0.4e1 / 0.9e1 * t645 * t308 + 0.4e1 / 0.9e1 * t645 * t312 + 0.7e1 / 0.972e3 * t651 * t653 * t179 + 0.7e1 / 0.162e3 * t316 * t660 * t332 + 0.7e1 / 0.81e2 * t169 * t667 * t672 + 0.7e1 / 0.162e3 * t677 * t177 * t615 * sigma[0] * t236 + 0.7e1 / 0.81e2 * t684 * t191 * t658 * t686 + 0.7e1 / 0.81e2 * t691 * t426 * t665 * t347 + 0.805e3 / 0.243e3 * t169 * t696 * t8 * t179 - 0.91e2 / 0.324e3 * t316 * t701 * t8 * t179 - 0.7e1 / 0.6e1 * t169 * t653 * t332 - 0.4e1 / 0.3e1 * t123 * t374 * t351;
  t714 = t133 * t129;
  t721 = t129 * t15;
  t732 = t13 * t650;
  t733 = t200 * t15;
  t737 = t238 * t166;
  t741 = t530 * t70;
  t742 = t236 * t200;
  t749 = t502 * t15;
  t757 = t8 * t283;
  t760 = t106 * t283;
  t764 = t238 * t133;
  t770 = -0.8e1 / 0.9e1 * t123 * t378 * t714 - 0.4e1 / 0.3e1 * t117 * t355 * t364 - 0.4e1 / 0.9e1 * t369 * t721 * t119 - 0.4e1 / 0.9e1 * t394 * t172 * t96 * t360 + t369 * t370 * t364 / 0.3e1 + t732 * t733 * t119 / 0.27e2 + 0.2e1 / 0.3e1 * t123 * t737 * t379 + 0.2e1 / 0.9e1 * t123 * t741 * t742 + 0.28e2 / 0.27e2 * t123 * t124 * t503 + 0.28e2 / 0.27e2 * t117 * t749 * t119 + 0.16e2 / 0.9e1 * t98 * params->omega * t129 * t360 + t117 * t118 * t757 + t123 * t760 * t108 - 0.4e1 / 0.9e1 * t98 * params->omega * t200 * t764 + 0.8e1 / 0.9e1 * t383 * t714;
  t771 = t5 * t530;
  t774 = t502 * params->b;
  t778 = t608 * t83;
  t783 = t83 * t325;
  t795 = t329 * t191 * t200;
  t798 = t658 * t83;
  t803 = t419 * t167;
  t807 = t669 * t426 * t194;
  t810 = t423 * t190;
  t811 = t425 * t191;
  t812 = t810 * t811;
  t813 = t170 * t170;
  t814 = 0.1e1 / t813;
  t815 = t814 * t83;
  t821 = t169 * t701 * t106;
  t825 = t316 * t652 * t106;
  t829 = t169 * t652 * t238;
  t830 = t437 * t686;
  t834 = t169 * t659 * t106;
  t835 = t329 * t191;
  t836 = t835 * t347;
  t839 = t169 * t15;
  t840 = t839 * t311;
  t843 = -0.2e1 / 0.9e1 * t771 * t742 + 0.56e2 / 0.27e2 * t112 * t774 * t71 + 0.3493e4 / 0.486e3 * t77 * t192 * t778 * sigma[0] - 0.35e2 / 0.3e1 * t77 * t10 * t783 * sigma[0] + 0.2e1 * t112 * t113 * t284 - 0.8e1 / 0.3e1 * t112 * t399 * t167 - 0.52e2 / 0.27e2 * t795 * t420 - 0.98e2 / 0.81e2 * t77 * t427 * t798 * sigma[0] + 0.4e1 / 0.3e1 * t418 * t803 + 0.8e1 / 0.27e2 * t807 * t420 + 0.14e2 / 0.243e3 * t77 * t812 * t815 * sigma[0] - 0.91e2 / 0.162e3 * t821 * t438 + 0.7e1 / 0.324e3 * t825 * t438 + 0.7e1 / 0.162e3 * t829 * t830 + 0.7e1 / 0.81e2 * t834 * t836 + 0.4e1 / 0.9e1 * t631 * t840;
  t845 = t629 + t712 + t770 + t843;
  tv3rho30 = 0.3e1 * params->a * t442 + t92 * t845;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho3[ip*p->dim.v3rho3 + 0] += tv3rho30;

  t853 = t288 * t222 * params->d;
  t862 = t8 * t477;
  t869 = t106 * t477;
  t873 = t238 * t222;
  t880 = t169 * t223;
  t883 = t452 * params->d;
  t884 = t73 * t883;
  t887 = -0.4e1 / 0.9e1 * t117 * t355 * t448 + 0.2e1 / 0.9e1 * t287 * t853 - 0.4e1 / 0.9e1 * t123 * t452 * t351 + 0.7e1 / 0.81e2 * t77 * t427 * t430 + 0.2e1 / 0.3e1 * t117 * t118 * t862 + t369 * t370 * t448 / 0.9e1 + 0.2e1 / 0.3e1 * t123 * t869 * t108 + 0.2e1 / 0.9e1 * t123 * t873 * t379 - 0.8e1 / 0.9e1 * t112 * t399 * t223 + 0.4e1 / 0.9e1 * t307 * t880 + 0.4e1 / 0.9e1 * t307 * t884;
  t892 = t176 * t177 * params->d;
  t903 = t419 * t223;
  t911 = t76 * t192 * t83;
  t914 = t73 * t335;
  t958 = -0.88e2 / 0.9e1 * t194 * t26 + 0.16e2 / 0.3e1 * t129 * t140 - t20 * t248 + t253 * t20 * t39 / 0.8e1 - 0.2e1 / 0.3e1 * t142 * t129 * t39 + 0.11e2 / 0.9e1 * t43 * t194 * t39 + t265 * t20 * t52 / 0.144e3 - t150 * t129 * t52 / 0.27e2 + 0.11e2 / 0.162e3 * t48 * t194 * t52 - t56 * (0.352e3 / 0.27e2 * t277 - 0.44e2 / 0.9e1 * t216 * t259) / 0.8e1;
  t959 = t16 * t958;
  t961 = -0.77e2 / 0.162e3 * t169 * t296 * t482 + 0.7e1 / 0.162e3 * t436 * t892 - 0.77e2 / 0.162e3 * t485 * t10 * t83 * t295 * params->d + 0.4e1 / 0.3e1 * t112 * t113 * t478 + 0.4e1 / 0.9e1 * t418 * t903 + 0.7e1 / 0.324e3 * t316 * t319 * t482 + 0.7e1 / 0.81e2 * t169 * t326 * t911 + 0.7e1 / 0.162e3 * t914 * t10 * t403 * t133 + 0.7e1 / 0.81e2 * t485 * t192 * t783 * params->d - 0.161e3 / 0.162e3 * t77 * t192 * t403 + 0.7e1 / 0.3e1 * t77 * t10 * t409 + t13 * t959;
  t962 = t887 + t961;
  tv3rho2sigma0 = 0.2e1 * params->a * t497 + t92 * t962;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rho2sigma[ip*p->dim.v3rho2sigma + 0] += tv3rho2sigma0;

  tv3rhosigma20 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3rhosigma2[ip*p->dim.v3rhosigma2 + 0] += tv3rhosigma20;

  tv3sigma30 = 0.e0;

  if(out->v3rho3 != NULL && (p->info->flags & XC_FLAGS_HAVE_KXC))
    out->v3sigma3[ip*p->dim.v3sigma3 + 0] += tv3sigma30;

  t972 = t813 * rho[0];
  t973 = 0.1e1 / t972;
  t981 = t75 * t810;
  t986 = t423 * t423;
  t988 = t425 * t425;
  t1004 = t608 * t39;
  t1020 = 0.1e1 / t529 / t7;
  t1022 = t528 * params->d * t1020 * t318;
  t1024 = t531 * t295;
  t1026 = t239 * t408;
  t1028 = t134 * t194;
  t1030 = t23 * t172;
  t1067 = -0.4e1 / 0.3e1 * t547 * t146 + 0.22e2 / 0.3e1 * t254 * t259 - 0.616e3 / 0.27e2 * t143 * t553 + 0.2618e4 / 0.81e2 * t44 * t1004 - 0.2e1 / 0.27e2 * t561 * t154 + 0.11e2 / 0.27e2 * t266 * t271 - 0.308e3 / 0.243e3 * t151 * t568 + 0.1309e4 / 0.729e3 * t49 * t608 * t52 - 0.20944e5 / 0.81e2 * t609 * t26 + (-0.4e1 / 0.243e3 * t1022 + 0.28e2 / 0.243e3 * t1024 - 0.232e3 / 0.729e3 * t1026 + 0.1e3 / 0.243e3 * t1028 - 0.14e3 / 0.729e3 * t1030) * sigma[0] * t45 / 0.8e1 + (0.8e1 / 0.27e2 * t1022 - 0.56e2 / 0.27e2 * t1024 + 0.464e3 / 0.81e2 * t1026 - 0.2e3 / 0.27e2 * t1028 + 0.28e3 / 0.81e2 * t1030) * sigma[0] * t53 / 0.144e3 + 0.4928e4 / 0.27e2 * t338 * t140 - 0.176e3 / 0.3e1 * t231 * t248 + 0.32e2 / 0.3e1 * t130 * t540 - t21 * (-0.7e1 / 0.243e3 * t1022 + 0.49e2 / 0.243e3 * t1024 - 0.406e3 / 0.729e3 * t1026 + 0.175e3 / 0.243e3 * t1028 - 0.245e3 / 0.729e3 * t1030) - t56 * (0.83776e5 / 0.243e3 * t58 * t1004 - 0.10472e5 / 0.81e2 * t62 * t57 * t608 * t39) / 0.8e1;
  t1070 = t236 * t408;
  t1074 = t528 * t295;
  t1077 = t133 * t194;
  t1080 = params->d * t172;
  t1091 = t318 * t96;
  t1095 = -0.208e3 / 0.27e2 * t795 * t803 - 0.8e1 / 0.3e1 * t669 * t426 * t318 * t420 - 0.308e3 / 0.243e3 * t77 * t812 * t973 * t83 * sigma[0] + 0.32e2 / 0.27e2 * t807 * t803 + 0.16e2 / 0.81e2 * t981 * t811 * t429 * t420 + 0.28e2 / 0.729e3 * t77 * t986 * params->m2 * t988 * params->omega / t18 / t972 * t83 * sigma[0] + t13 * t16 * t1067 + 0.16e2 / 0.9e1 * t771 * t1070 - 0.8e1 / 0.27e2 * t5 * t1020 * t1074 - 0.32e3 / 0.81e2 * t383 * t1077 + 0.28e3 / 0.81e2 * t107 * t1080 + 0.56e3 / 0.81e2 * t98 * params->omega * t172 * t8 - 0.736e3 / 0.81e2 * t394 * t408 * t96 * t8 + 0.8e1 / 0.3e1 * t517 * t1091 * t8;
  t1144 = t329 * t191 * t318 * t83;
  t1151 = -0.16e2 / 0.81e2 * t75 * t514 * t392 * t811 * t429 * t96 * t8 + 0.32e3 / 0.81e2 * t13 * params->c * t194 * t290 - 0.32e2 / 0.9e1 * t591 * t595 - 0.8e1 / 0.9e1 * t13 * t315 * t408 * t290 - 0.16e2 / 0.9e1 * t13 * params->c * t408 * t587 + 0.4e1 / 0.3e1 * t287 * t288 * t283 * params->d + 0.4e1 / 0.9e1 * t599 * t595 + 0.8e1 / 0.9e1 * t584 * t585 * t166 * t133 + 0.4e1 / 0.81e2 * t13 * t650 * t295 * t290 + 0.4e1 / 0.27e2 * t13 * t315 * t295 * t587 + 0.8e1 / 0.27e2 * t13 * params->c * t295 * t15 * t530 * t70 * t236 + 0.8e1 / 0.27e2 * t1144 * t632 + 0.16e2 / 0.9e1 * t645 * t636 + 0.16e2 / 0.27e2 * t1144 * t640;
  t1155 = t669 * t426 * t325 * t83;
  t1172 = t814 * t15;
  t1173 = t1172 * t8;
  t1178 = t111 * t10 * t194;
  t1193 = t111 * t10 * t408;
  t1200 = 0.32e2 / 0.81e2 * t1155 * t308 + 0.32e2 / 0.81e2 * t1155 * t312 - 0.1813e5 / 0.729e3 * t169 * t660 * t179 + 0.434e4 / 0.729e3 * t337 * t177 * t665 * sigma[0] * t133 + 0.931e4 / 0.729e3 * t344 * t191 * t814 * t347 + 0.931e4 / 0.729e3 * t169 * t1173 * t332 + 0.64e3 / 0.81e2 * t1178 * t312 + 0.64e3 / 0.81e2 * t1178 * t308 + 0.8e1 / 0.3e1 * t307 * t169 * t284 + 0.8e1 / 0.3e1 * t307 * t73 * t760 * params->d - 0.64e2 / 0.9e1 * t621 * t636 - 0.32e2 / 0.9e1 * t1193 * t640 - 0.64e2 / 0.9e1 * t621 * t626 - 0.16e2 / 0.9e1 * t1193 * t632;
  t1205 = t111 * t10 * t295;
  t1221 = 0.1e1 / t2 / t813;
  t1222 = t1221 * t15;
  t1223 = t1222 * t8;
  t1228 = 0.1e1 / t18 / t813;
  t1229 = t1228 * t15;
  t1230 = t1229 * t8;
  t1249 = t329 * t191 * t295 * t83;
  t1256 = t315 * t315;
  t1264 = 0.8e1 / 0.9e1 * t631 * t316 * t167 + 0.8e1 / 0.81e2 * t1205 * t651 * t71 + 0.16e2 / 0.9e1 * t631 * t73 * t737 * t133 + 0.16e2 / 0.27e2 * t1205 * t73 * t741 * t236 - 0.35e2 / 0.243e3 * t651 * t1173 * t179 - 0.217e3 / 0.243e3 * t316 * t1223 * t332 - 0.448e3 / 0.243e3 * t169 * t1230 * t672 - 0.7e2 / 0.81e2 * t677 * t177 * t814 * sigma[0] * t236 - 0.434e3 / 0.243e3 * t684 * t191 * t1221 * t686 - 0.448e3 / 0.243e3 * t691 * t426 * t1228 * t347 - 0.304e3 / 0.81e2 * t1249 * t312 - 0.304e3 / 0.81e2 * t1249 * t308 + 0.16e2 / 0.9e1 * t645 * t626 + 0.7e1 / 0.2916e4 * params->b * t1256 * t1223 * t179 + 0.14e2 / 0.729e3 * t651 * t1230 * t332;
  t1267 = t973 * t15;
  t1273 = 0.1e1 / t2 / t972;
  t1293 = t346 * t236;
  t1339 = 0.14e2 / 0.243e3 * t316 * t1267 * t8 * t672 + 0.56e2 / 0.729e3 * t169 * t1273 * t15 * t8 * t981 * t811 * t83 * sigma[0] + 0.14e2 / 0.243e3 * t73 * t1020 * t75 * params->m2 * t177 * t1221 * sigma[0] * t528 + 0.28e2 / 0.243e3 * t73 * t675 * t190 * t191 * t1228 * t1293 + 0.28e2 / 0.243e3 * t73 * t335 * t424 * t426 * t973 * t686 + 0.56e2 / 0.729e3 * t73 * t182 * t810 * t811 * t1273 * t347 - 0.1813e5 / 0.729e3 * t184 * t177 * t658 * sigma[0] * params->d + 0.217e4 / 0.729e3 * t316 * t667 * t179 - 0.16e2 / 0.27e2 * t98 * params->omega * t295 * t530 * t236 + 0.112e3 / 0.27e2 * t123 * t374 * t503 + 0.32e3 / 0.81e2 * t123 * t378 * t1077 + 0.112e3 / 0.27e2 * t117 * t749 * t364 + 0.16e3 / 0.81e2 * t369 * t194 * t15 * t119 + 0.304e3 / 0.81e2 * t394 * t295 * t96 * t360;
  t1393 = 0.4e1 / 0.3e1 * t117 * t118 * t8 * t580 + 0.2e1 / 0.3e1 * t369 * t370 * t757 + 0.4e1 / 0.3e1 * t123 * t106 * t580 * t108 + 0.4e1 / 0.3e1 * t123 * t238 * t283 * t379 - 0.16e2 / 0.27e2 * t394 * t1091 * t764 - 0.32e2 / 0.9e1 * t123 * t737 * t714 - 0.16e2 / 0.9e1 * t123 * t741 * t1070 - 0.16e2 / 0.9e1 * t369 * t721 * t364 - 0.8e1 / 0.27e2 * t732 * t408 * t15 * t119 - 0.32e2 / 0.81e2 * t517 * t325 * t96 * t360 + 0.4e1 / 0.27e2 * t732 * t733 * t364 + t13 * t1256 * t296 * t119 / 0.81e2 + 0.8e1 / 0.9e1 * t123 * t530 * t166 * t742 + 0.8e1 / 0.27e2 * t123 * t1020 * t70 * t1074 - 0.28e3 / 0.81e2 * t123 * t124 * t1080;
  t1412 = t665 * t83;
  t1417 = t83 * t615;
  t1447 = -0.28e3 / 0.81e2 * t117 * t173 * t119 - 0.64e3 / 0.81e2 * t98 * params->omega * t194 * t360 - 0.8e1 / 0.3e1 * t117 * t355 * t757 - 0.8e1 / 0.3e1 * t123 * t760 * t351 + 0.32e2 / 0.9e1 * t98 * params->omega * t408 * t764 - 0.406e5 / 0.729e3 * t77 * t192 * t1412 * sigma[0] + 0.7e2 * t77 * t10 * t1417 * sigma[0] - 0.16e2 / 0.3e1 * t112 * t399 * t284 - 0.56e3 / 0.81e2 * t112 * t172 * params->b * t71 + 0.224e3 / 0.27e2 * t112 * t774 * t167 + 0.736e3 / 0.81e2 * t329 * t191 * t408 * t420 + 0.9961e4 / 0.729e3 * t77 * t427 * t1221 * t83 * sigma[0] + 0.8e1 / 0.3e1 * t112 * t113 * t581 + 0.8e1 / 0.3e1 * t418 * t419 * t284;
  t1468 = t1222 * t106;
  t1505 = 0.434e4 / 0.729e3 * t169 * t666 * t106 * t438 - 0.32e2 / 0.9e1 * t1193 * t840 + 0.16e2 / 0.9e1 * t631 * t839 * t635 + 0.8e1 / 0.27e2 * t1205 * t316 * t15 * t311 + 0.16e2 / 0.27e2 * t1205 * t839 * t639 - 0.35e2 / 0.81e2 * t316 * t1172 * t106 * t438 - 0.434e3 / 0.243e3 * t169 * t1468 * t836 - 0.7e2 / 0.81e2 * t169 * t1172 * t238 * t830 + 0.16e2 / 0.27e2 * t1144 * t840 + 0.7e1 / 0.729e3 * t651 * t1468 * t438 + 0.14e2 / 0.243e3 * t316 * t1229 * t106 * t836 + 0.28e2 / 0.243e3 * t169 * t1267 * t106 * t669 * t426 * t347 + 0.14e2 / 0.243e3 * t169 * t1222 * t530 * t437 * t1293 + 0.28e2 / 0.243e3 * t169 * t1229 * t238 * t835 * t686 + 0.7e1 / 0.243e3 * t316 * t1222 * t238 * t830;
  tv4rho40 = 0.4e1 * params->a * t845 + t92 * (t1095 + t1151 + t1200 + t1264 + t1339 + t1393 + t1447 + t1505);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho4[ip*p->dim.v4rho4 + 0] += tv4rho40;

  t1554 = -0.8e1 / 0.9e1 * t591 * t853 + 0.2e1 / 0.3e1 * t287 * t288 * t477 * params->d + t599 * t853 / 0.9e1 + 0.2e1 / 0.9e1 * t584 * t585 * t222 * t133 + 0.14e2 / 0.243e3 * t77 * t812 * t815 - 0.98e2 / 0.81e2 * t77 * t427 * t798 + 0.3493e4 / 0.486e3 * t77 * t192 * t778 - 0.35e2 / 0.3e1 * t77 * t10 * t783 + 0.805e3 / 0.243e3 * t485 * t10 * t430 * params->d + 0.7e1 / 0.81e2 * t169 * t666 * t76 * t427 * t83 + 0.7e1 / 0.81e2 * t485 * t427 * t1412 * params->d - 0.8e1 / 0.3e1 * t112 * t399 * t478 - 0.52e2 / 0.27e2 * t795 * t903;
  t1598 = -0.91e2 / 0.324e3 * t316 * t701 * t482 - 0.7e1 / 0.6e1 * t169 * t652 * t911 - 0.91e2 / 0.162e3 * t914 * t10 * t778 * t133 - 0.7e1 / 0.6e1 * t485 * t192 * t1417 * params->d + 0.2e1 * t112 * t113 * t959 + 0.4e1 / 0.3e1 * t418 * t419 * t478 + 0.8e1 / 0.27e2 * t807 * t903 + 0.7e1 / 0.972e3 * t651 * t652 * t482 + 0.7e1 / 0.162e3 * t316 * t659 * t911 + 0.7e1 / 0.162e3 * t73 * t675 * t10 * t1417 * t236 + 0.7e1 / 0.81e2 * t914 * t192 * t798 * t133 + 0.56e2 / 0.27e2 * t112 * t774 * t223 + 0.805e3 / 0.243e3 * t169 * t696 * t482;
  t1636 = 0.1232e4 / 0.27e2 * t318 * t26 - 0.88e2 / 0.3e1 * t194 * t140 + 0.8e1 * t129 * t248 - t20 * t540 + t546 * t20 * t39 / 0.8e1 - t253 * t129 * t39 + 0.11e2 / 0.3e1 * t142 * t194 * t39 - 0.154e3 / 0.27e2 * t43 * t318 * t39 + t560 * t20 * t52 / 0.144e3 - t265 * t129 * t52 / 0.18e2 + 0.11e2 / 0.54e2 * t150 * t194 * t52 - 0.77e2 / 0.243e3 * t48 * t318 * t52 - t56 * (-0.4928e4 / 0.81e2 * t574 + 0.616e3 / 0.27e2 * t216 * t553) / 0.8e1;
  t1673 = t13 * t16 * t1636 + 0.7e1 / 0.162e3 * t829 * t176 * t177 * t133 + 0.7e1 / 0.81e2 * t834 * t329 * t330 * params->d - 0.16e2 / 0.9e1 * t621 * t880 - 0.16e2 / 0.9e1 * t621 * t884 + 0.4e1 / 0.3e1 * t307 * t169 * t478 + 0.2e1 / 0.9e1 * t631 * t316 * t223 + 0.4e1 / 0.3e1 * t307 * t73 * t869 * params->d + 0.4e1 / 0.9e1 * t631 * t73 * t873 * t133 + 0.4e1 / 0.9e1 * t645 * t880 + 0.4e1 / 0.9e1 * t645 * t884 - 0.91e2 / 0.162e3 * t821 * t892 + 0.7e1 / 0.324e3 * t825 * t892;
  t1715 = t732 * t733 * t448 / 0.27e2 + t123 * t106 * t958 * t108 + 0.2e1 / 0.3e1 * t123 * t238 * t477 * t379 + 0.2e1 / 0.9e1 * t123 * t530 * t222 * t742 + 0.28e2 / 0.27e2 * t117 * t749 * t448 + 0.28e2 / 0.27e2 * t123 * t452 * t503 - 0.4e1 / 0.3e1 * t117 * t355 * t862 - 0.4e1 / 0.9e1 * t369 * t721 * t448 - 0.4e1 / 0.3e1 * t123 * t869 * t351 - 0.8e1 / 0.9e1 * t123 * t873 * t714 + t117 * t118 * t8 * t958 + t369 * t370 * t862 / 0.3e1 + 0.4e1 / 0.9e1 * t631 * t839 * t883;
  tv4rho3sigma0 = 0.3e1 * params->a * t962 + t92 * (t1554 + t1598 + t1673 + t1715);

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho3sigma[ip*p->dim.v4rho3sigma + 0] += tv4rho3sigma0;

  tv4rho2sigma20 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rho2sigma2[ip*p->dim.v4rho2sigma2 + 0] += tv4rho2sigma20;

  tv4rhosigma30 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4rhosigma3[ip*p->dim.v4rhosigma3 + 0] += tv4rhosigma30;

  tv4sigma40 = 0.e0;

  if(out->v4rho4 != NULL && (p->info->flags & XC_FLAGS_HAVE_LXC))
    out->v4sigma4[ip*p->dim.v4sigma4 + 0] += tv4sigma40;

}

#endif

